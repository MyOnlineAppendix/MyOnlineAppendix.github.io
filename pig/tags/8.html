<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.TestLoadStoreFuncLifeCycle </h4><pre class="type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadStoreFunc() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=Storage.resetData(pigServer.getPigContext());
  data.set("foo",tuple("a"),tuple("b"),tuple("c"));
  pigServer.registerQuery("A = LOAD 'foo' USING " + TestLoadStoreFuncLifeCycle.class.getName() + "$Loader();\n"+ "STORE A INTO 'bar' USING "+ TestLoadStoreFuncLifeCycle.class.getName()+ "$Storer();");
  List<Tuple> out=data.get("bar");
  assertEquals("a",out.get(0).get(0));
  assertEquals("b",out.get(1).get(0));
  assertEquals("c",out.get(2).get(0));
  assertTrue("loader instanciation count increasing: " + Loader.count,Loader.count <= 3);
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    assertTrue("storer instanciation count increasing: " + Storer.count,Storer.count == 6);
    return;
  }
 else {
    assertTrue("storer instanciation count increasing: " + Storer.count,Storer.count <= (org.apache.pig.impl.util.Utils.isHadoop2() ? 5 : 4));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloPigCluster </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  loadTestData();
  final String loadFlights="flights = LOAD 'accumulo://flights?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String loadAirports="airports = LOAD 'accumulo://airports?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String joinQuery="joined = JOIN flights BY column_map#'origin', airports BY column_map#'code';";
  pig.registerQuery(loadFlights);
  pig.registerQuery(loadAirports);
  pig.registerQuery(joinQuery);
  Iterator<Tuple> it=pig.openIterator("joined");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Assert.assertEquals(4,t.size());
    Object o=t.get(1);
    Map<String,String> airport=null, flight=null;
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data1=(Map<String,String>)o;
    Assert.assertTrue(!data1.isEmpty());
    if (data1.containsKey("origin")) {
      flight=data1;
    }
 else     if (data1.containsKey("code")) {
      airport=data1;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    o=t.get(3);
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data2=(Map<String,String>)o;
    Assert.assertTrue(!data2.isEmpty());
    if (null == flight && data2.containsKey("origin")) {
      flight=data2;
    }
 else     if (null == airport && data2.containsKey("code")) {
      airport=data2;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    Assert.assertTrue(null != airport && null != flight);
    Assert.assertEquals(airport.get("code"),flight.get("origin"));
    i++;
  }
  Assert.assertEquals(6,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.hbase.TestHBaseStorageFiltering </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescriptorsAndPrefix() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:a cf1:b cf2:foo*");
  List<Filter> childFilters=assertFilterList(filter,FilterList.Operator.MUST_PASS_ALL,1);
  List<Filter> groupFilters=assertFilterList(childFilters.get(0),FilterList.Operator.MUST_PASS_ONE,2);
  List<Filter> firstFilters=assertFilterList(groupFilters.get(0),FilterList.Operator.MUST_PASS_ALL,2);
  FamilyFilter firstFamilyFilter=assertFamilyFilter(firstFilters.get(0),CompareFilter.CompareOp.EQUAL);
  List<Filter> secondFilters=assertFilterList(groupFilters.get(1),FilterList.Operator.MUST_PASS_ALL,2);
  FamilyFilter secondFamilyFilter=assertFamilyFilter(secondFilters.get(0),CompareFilter.CompareOp.EQUAL);
  Filter cf1ColumnList;
  Filter cf2ColumnList;
  if (Bytes.toString(firstFamilyFilter.getComparator().getValue()).equals("cf1")) {
    assertEquals("cf2",Bytes.toString(secondFamilyFilter.getComparator().getValue()));
    cf1ColumnList=firstFilters.get(1);
    cf2ColumnList=secondFilters.get(1);
  }
 else {
    assertEquals("cf1",Bytes.toString(secondFamilyFilter.getComparator().getValue()));
    assertEquals("cf2",Bytes.toString(firstFamilyFilter.getComparator().getValue()));
    cf1ColumnList=secondFilters.get(1);
    cf2ColumnList=firstFilters.get(1);
  }
  List<Filter> c1ColumnFilters=assertFilterList(cf1ColumnList,FilterList.Operator.MUST_PASS_ONE,2);
  assertQualifierFilter(c1ColumnFilters.get(0),CompareFilter.CompareOp.EQUAL,"a");
  assertQualifierFilter(c1ColumnFilters.get(1),CompareFilter.CompareOp.EQUAL,"b");
  List<Filter> c2ColumnFilters=assertFilterList(cf2ColumnList,FilterList.Operator.MUST_PASS_ONE,1);
  assertPrefixFilter(c2ColumnFilters.get(0),"foo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.mock.TestMockStorage </h4><pre class="type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMockStoreUnion() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  data.set("input2",tuple("d"),tuple("e"),tuple("f"));
  pigServer.registerQuery("A = LOAD 'input1' USING mock.Storage();");
  pigServer.registerQuery("B = LOAD 'input2' USING mock.Storage();");
  pigServer.registerQuery("C = UNION A, B;");
  pigServer.registerQuery("STORE C INTO 'output' USING mock.Storage();");
  List<Tuple> out=data.get("output");
  assertEquals(out + " size",6,out.size());
  Set<String> set=new HashSet<String>();
  for (  Tuple tuple : out) {
    if (!set.add((String)tuple.get(0))) {
      fail(tuple.get(0) + " is present twice in " + out);
    }
  }
  assertTrue(set + " contains a",set.contains("a"));
  assertTrue(set + " contains b",set.contains("b"));
  assertTrue(set + " contains c",set.contains("c"));
  assertTrue(set + " contains d",set.contains("d"));
  assertTrue(set + " contains e",set.contains("e"));
  assertTrue(set + " contains f",set.contains("f"));
}

</code></pre>

<br>
<pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testBadUsage2() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input",tuple("a"),tuple("b"),tuple("c"));
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD 'input' USING mock.Storage();" + "B = LOAD 'input' USING mock.Storage();" + "STORE A INTO 'output' USING mock.Storage();"+ "STORE B INTO 'output' USING mock.Storage();");
  List<ExecJob> results=pigServer.executeBatch();
  boolean failed=false;
  for (  ExecJob execJob : results) {
    if (execJob.getStatus() == JOB_STATUS.FAILED) {
      failed=true;
      break;
    }
  }
  if (Util.getLocalTestMode().toString().equals("TEZ_LOCAL")) {
    assertFalse("job should have success in tez_local mode since we have two vertex, each for a single store",failed);
    return;
  }
  assertTrue("job should have failed for storing twice in the same location",failed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.newplan.logical.relational.TestLocationInPhysicalPlan </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  File input=File.createTempFile("test","input");
  input.deleteOnExit();
  File output=File.createTempFile("test","output");
  output.delete();
  Util.createLocalInputFile(input.getAbsolutePath(),new String[]{"1,2,3","1,1,3","1,1,1","3,1,1","1,2,1"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(input.getAbsolutePath()) + "' using PigStorage();\n"+ "B = GROUP A BY $0;\n"+ "A = FOREACH B GENERATE COUNT(A);\n"+ "STORE A INTO '"+ Util.encodeEscape(output.getAbsolutePath())+ "';");
  ExecJob job=pigServer.executeBatch().get(0);
  List<OriginalLocation> originalLocations=job.getPOStore().getOriginalLocations();
  Assert.assertEquals(1,originalLocations.size());
  OriginalLocation originalLocation=originalLocations.get(0);
  Assert.assertEquals(4,originalLocation.getLine());
  Assert.assertEquals(0,originalLocation.getOffset());
  Assert.assertEquals("A",originalLocation.getAlias());
  JobStats jStats=(JobStats)job.getStatistics().getJobGraph().getSinks().get(0);
  if (Util.getLocalTestMode().toString().equals("TEZ_LOCAL")) {
    Assert.assertEquals("A[1,4],A[3,4],B[2,4]",jStats.getAliasLocation());
  }
 else {
    Assert.assertEquals("M: A[1,4],A[3,4],B[2,4] C: A[3,4],B[2,4] R: A[3,4]",jStats.getAliasLocation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelationAliasInNestedForeachWhereUnspecified() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> values=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    values.add(tuple(i % 3 == 0 ? null : "a","b"));
  }
  data.set("foo",values);
  pigServer.registerQuery("raw_data = load 'foo' using mock.Storage() as (field_a:chararray, field_b:chararray);");
  pigServer.registerQuery("records = foreach raw_data {" + "  generated_field = (field_a is null ? '-' : field_b);" + "  GENERATE"+ "    field_a,"+ "    field_b,"+ "    generated_field; }");
  pigServer.registerQuery("use_records = foreach records generate generated_field, CONCAT(generated_field,generated_field);");
  Schema expectedSchema=Utils.getSchemaFromString("field_a:chararray, field_b:chararray, generated_field:chararray");
  assertEquals(expectedSchema,pigServer.dumpSchema("records"));
  for (Iterator<Tuple> it=pigServer.openIterator("records"); it.hasNext(); ) {
    Tuple t=it.next();
    String a=(String)t.get(0);
    String b=(String)t.get(1);
    assertEquals("b",b);
    if (a == null) {
      assertEquals("-",t.get(2));
    }
 else {
      assertEquals("a",a);
      assertEquals(b,t.get(2));
    }
  }
  for (Iterator<Tuple> it=pigServer.openIterator("use_records"); it.hasNext(); ) {
    Tuple t=it.next();
    String x=(String)t.get(0);
    assertEquals(x + x,t.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParserUtils </h4><pre class="type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetHDFSServers() throws Exception {
  Properties props=new Properties();
  props.setProperty("fs.default.name","hdfs://nn1:8020/tmp");
  PigContext pc=new PigContext(ExecType.LOCAL,props);
  QueryParserUtils.setHdfsServers("hdfs:///tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("/tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("hdfs://nn1/tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("hdfs://nn1:8020/tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("hftp://nn1/tmp",pc);
  assertEquals("hftp://nn1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("hftp://nn1:50070/tmp",pc);
  assertEquals("hftp://nn1,hftp://nn1:50070",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("hftp://nn1:50070/tmp",pc);
  assertEquals("hftp://nn1,hftp://nn1:50070",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  props.remove(MRConfiguration.JOB_HDFS_SERVERS);
  QueryParserUtils.setHdfsServers("har:///tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("har://hdfs-nn1:8020/tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  QueryParserUtils.setHdfsServers("har://hdfs-nn1/tmp",pc);
  assertEquals("hdfs://nn1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  props.remove(MRConfiguration.JOB_HDFS_SERVERS);
  QueryParserUtils.setHdfsServers("hello://nn1/tmp",pc);
  assertEquals(null,props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  if (org.apache.pig.impl.util.Utils.isHadoop23() || org.apache.pig.impl.util.Utils.isHadoop2()) {
    props.remove(MRConfiguration.JOB_HDFS_SERVERS);
    QueryParserUtils.setHdfsServers("webhdfs://nn1/tmp",pc);
    assertEquals("webhdfs://nn1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("webhdfs://nn1:50070/tmp",pc);
    assertEquals("webhdfs://nn1,webhdfs://nn1:50070",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("har://webhdfs-nn1:50070/tmp",pc);
    assertEquals("webhdfs://nn1,webhdfs://nn1:50070",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("har://webhdfs-nn2:50070/tmp",pc);
    assertEquals("webhdfs://nn1,webhdfs://nn1:50070,webhdfs://nn2:50070",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    props.remove(MRConfiguration.JOB_HDFS_SERVERS);
    QueryParserUtils.setHdfsServers("har://webhdfs-nn1/tmp",pc);
    assertEquals("webhdfs://nn1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    props.remove(MRConfiguration.JOB_HDFS_SERVERS);
    QueryParserUtils.setHdfsServers("viewfs:/tmp",pc);
    assertEquals("viewfs://",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("viewfs:///tmp",pc);
    assertEquals("viewfs://",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("viewfs://cluster1/tmp",pc);
    assertEquals("viewfs://,viewfs://cluster1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    props.remove(MRConfiguration.JOB_HDFS_SERVERS);
    QueryParserUtils.setHdfsServers("har://viewfs/tmp",pc);
    assertEquals("viewfs://",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
    QueryParserUtils.setHdfsServers("har://viewfs-cluster1/tmp",pc);
    assertEquals("viewfs://,viewfs://cluster1",props.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestUnionOnSchemaSetter </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeCompatibleSchema() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:int); " + "B = load 'y' as ( u:int, v:long, w:long); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc + 1,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:int, z:long); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nodeCount=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nodeCount + 2,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:int, w:bytearray); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc + 1,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:long, w:bytearray); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc,plan.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestOver </h4><pre class="type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeadWithRowsAheadDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(6);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  t.set(5,99);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertEquals(new Integer(99),to.get(0));
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThreeBeforeAndAfter() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,1);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"sum(int)");
  t.set(2,3);
  t.set(3,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int sum=1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
switch (sum++) {
case 1:
case 10:
      assertEquals(new Long(4),to.get(0));
    break;
case 2:
case 9:
  assertEquals(new Long(5),to.get(0));
break;
case 3:
case 8:
assertEquals(new Long(6),to.get(0));
break;
case 4:
case 5:
case 6:
case 7:
assertEquals(new Long(7),to.get(0));
break;
default :
throw new RuntimeException("We shouldn't be here, sum is " + sum);
}
}
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagWithRowsBehindNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadWithRowsAheadNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLagWithRowsBehindDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(6);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  t.set(5,99);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertEquals(new Integer(99),to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNtileFour() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,r.nextInt(100));
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"ntile");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,4);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=0;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 3)     assertEquals(1,to.get(0));
 else     if (count < 5)     assertEquals(2,to.get(0));
 else     if (count < 8)     assertEquals(3,to.get(0));
 else     assertEquals(4,to.get(0));
    count++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestAllLoader </h4><pre class="type-11 type-8 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  Configuration hadoopConf=new Configuration();
  FileSystem.setDefaultUri(hadoopConf,LocalFileSystem.getDefaultUri(hadoopConf));
  if (baseDir == null) {
    configuration=new Properties();
    configuration.setProperty(LoadFuncHelper.FILE_EXTENSION_LOADERS,extensionLoaders);
    baseDir=new File("build/test/testAllLoader");
    if (baseDir.exists()) {
      FileUtil.fullyDelete(baseDir);
    }
    assertTrue(baseDir.mkdirs());
    createSimpleDir();
    createDatePartitionDir();
    createLogicPartitionDir();
    createTaggedLogicPartitionDir();
    createFileByContentDir();
    server=new PigServer(ExecType.LOCAL,configuration);
    server.setBatchOn();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestLoadFuncHelper </h4><pre class="type-11 type-8 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  if (baseDir == null) {
    PigServer pig=new PigServer(ExecType.LOCAL);
    configuration=new Configuration(false);
    configuration.set(LoadFuncHelper.FILE_EXTENSION_LOADERS,extensionLoaders);
    helper=new LoadFuncHelper(configuration);
    baseDir=new File("build/test/testLoadFuncHelper");
    if (baseDir.exists()) {
      FileUtil.fullyDelete(baseDir);
    }
    assertTrue(baseDir.mkdirs());
    testFile=new File(baseDir,"testFile.txt");
    FileWriter writer=new FileWriter(testFile);
    try {
      for (int i=0; i < 100; i++) {
        writer.append("test test\n");
      }
    }
  finally {
      writer.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestSequenceFileLoader </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsNocast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      System.err.println("expect:---: " + EXPECTED[tupleCount][0]);
      assertEquals(EXPECTED[tupleCount][0],tuple.get(0).toString());
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1).toString());
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsStringCast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key:long, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      assertEquals(Long.parseLong(EXPECTED[tupleCount][0]),tuple.get(0));
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1));
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema3() throws IOException {
  Schema complexType[]={Schema.createRecord(new ArrayList<Schema.Field>()),Schema.createArray(Schema.create(Schema.Type.INT)),Schema.createMap(Schema.create(Schema.Type.INT)),Schema.createUnion(new ArrayList<Schema>()),Schema.createFixed("fixed",null,null,1)};
  for (int i=0; i < complexType.length; i++) {
    Schema x=complexType[i];
    for (int j=0; j < complexType.length; j++) {
      Schema y=complexType[j];
      if (i != j) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x,y);
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x.getType() + " with "+ y.getType(),e.getMessage());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema2() throws IOException {
  Schema.Type primitiveType[]={Schema.Type.NULL,Schema.Type.BOOLEAN,Schema.Type.BYTES,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.ENUM,Schema.Type.STRING};
  Schema.Type expectedType[][]={{Schema.Type.NULL,null,null,null,null,null,null,null,null},{null,Schema.Type.BOOLEAN,null,null,null,null,null,null,null},{null,null,Schema.Type.BYTES,null,null,null,null,null,null},{null,null,null,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.LONG,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.ENUM,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING}};
  List<String> enumSymbols=new ArrayList<String>();
  enumSymbols.add("sym1");
  enumSymbols.add("sym2");
  Schema enumSchema=Schema.createEnum("enum",null,null,enumSymbols);
  for (int i=0; i < primitiveType.length; i++) {
    Schema.Type x=primitiveType[i];
    for (int j=0; j < primitiveType.length; j++) {
      Schema.Type y=primitiveType[j];
      if (expectedType[i][j] == null) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x + " with "+ y,e.getMessage());
        }
      }
 else {
        Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
        assertEquals(expectedType[i][j],z.getType());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, SUM(A.v), COUNT(A.v), MIN(A.v), MAX(A.v);");
  HashMap<Integer,Double[]> expected=new HashMap<Integer,Double[]>();
  expected.put(100,new Double[]{15.0,5.0,1.0,5.0});
  expected.put(200,new Double[]{6.3,3.0,1.1,3.1});
  expected.put(300,new Double[]{3.3,1.0,3.3,3.3});
  expected.put(400,new Double[]{null,0.0,null,null});
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Double[] v=expected.get((Integer)t.get(0));
    for (int i=0; i < v.length; i++) {
      if (v[i] != null) {
        assertEquals(v[i].doubleValue(),((Number)t.get(i + 1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(i + 1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltinAvg() throws IOException {
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,3.0);
  expected.put(200,2.1);
  expected.put(300,3.3);
  expected.put(400,null);
  String[] types={"double","float","int","long"};
  for (int i=0; i < types.length; i++) {
    if (i > 1) {
      expected.put(200,2.0);
      expected.put(300,3.0);
    }
    pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:"+ types[i]+ ");");
    pigServer.registerQuery("C = group A by id;");
    pigServer.registerQuery("D = foreach C generate group, AVG(A.v);");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      Double v=expected.get((Integer)t.get(0));
      if (v != null) {
        assertEquals(v.doubleValue(),((Number)t.get(1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(1));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAdd </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE,DataType.BIGINTEGER,DataType.BIGDECIMAL};
  System.out.println("Testing Add operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 + inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 + inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 + inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 + inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEval </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.out.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          nonNullCnt--;
          ps.println(j % 10 + ":");
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEvalLocal </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.err.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          nonNullCnt--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAssert </h4><pre class="type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Verify that ASSERT operator works
 * @throws Exception
 */
@Test public void testNegative() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("ASSERT A BY i > 1 , 'i should be greater than 1';");
  try {
    pigServer.openIterator("A");
  }
 catch (  FrontendException fe) {
    if (pigServer.getPigContext().getExecType().toString().startsWith("TEZ")) {
      Assert.assertTrue(fe.getCause().getMessage().contains("Assertion violated: i should be greater than 1"));
    }
 else {
      Assert.assertTrue(fe.getCause().getMessage().contains("Job terminated with anomalous status FAILED"));
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Verify that ASSERT operator works. Disable fetch for this testcase.
 * @throws Exception
 */
@Test public void testNegativeWithoutFetch() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("ASSERT A BY i > 1 , 'i should be greater than 1';");
  try {
    pigServer.openIterator("A");
  }
 catch (  FrontendException fe) {
    if (pigServer.getPigContext().getExecType().toString().startsWith("TEZ")) {
      Assert.assertTrue(fe.getCause().getMessage().contains("Assertion violated: i should be greater than 1"));
    }
 else {
      Assert.assertTrue(fe.getCause().getMessage().contains("Job terminated with anomalous status FAILED"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBoolean </h4><pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndNull() throws ExecException {
  setupAnd();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrNull() throws ExecException {
  setupOr();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMFinal() throws Exception {
  String[] sumTypes={"SUMFinal","DoubleSumFinal","LongSumFinal","IntSumFinal","FloatSumFinal","BigDecimalSumFinal","BigIntegerSumFinal"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called once - so initial is called
 * and then Intermediate and then final is called
 * @throws Exception
 */
@Test public void testAggSingleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag intermediateInputBg1=bagFactory.newDefaultBag();
      DataBag intermediateInputBg2=bagFactory.newDefaultBag();
      int i=0;
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        if (i < bg.size() / 2) {
          intermediateInputBg1.add((Tuple)aggInitial.exec(initialInputTuple));
        }
 else {
          intermediateInputBg2.add((Tuple)aggInitial.exec(initialInputTuple));
        }
        i++;
      }
      EvalFunc<?> avgIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      Tuple intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg1);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg2);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for single combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSUM() throws Exception {
  String[] sumTypes={"SUM","DoubleSum","LongSum","IntSum","FloatSum","BigDecimalSum","BigIntegerSum"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType == "Integer" || inputType == "Long") {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
    assertNull(sum.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGIntermediate() throws Exception {
  String[] avgTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    String inputType=getInputType(avgTypes[k]);
    Tuple tup=inputMap.get(inputType);
    DataBag bag=(DataBag)tup.get(0);
    DataBag bg=bagFactory.newDefaultBag();
    for (    Tuple t : bag) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (inputType == "BigDecimal") {
        newTuple.set(1,BigDecimal.ONE);
      }
 else       if (inputType == "BigInteger") {
        newTuple.set(1,BigInteger.ONE);
      }
 else {
        newTuple.set(1,new Long(1));
      }
      bg.add(newTuple);
    }
    Tuple intermediateInput=tupleFactory.newTuple();
    intermediateInput.append(bg);
    Object output=avg.exec(intermediateInput);
    if (inputType == "Long" || inputType == "Integer" || inputType == "IntegerAsLong") {
      Long l=(Long)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ l+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,getExpected(avgTypes[k]),l);
    }
 else     if (inputType == "BigDecimal") {
      BigDecimal f1=(BigDecimal)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),f1.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f1=(BigInteger)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigInteger)getExpected(avgTypes[k])).toString(),f1.toString());
    }
 else {
      Double f1=(Double)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,(Double)getExpected(avgTypes[k]),f1,0.00001);
    }
    if (inputType == "BigDecimal") {
      BigDecimal f2=(BigDecimal)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f2=(BigInteger)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toString());
    }
 else {
      Long f2=(Long)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 11",11,f2.longValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMIntermed() throws Exception {
  String[] sumTypes={"SUMIntermediate","DoubleSumIntermediate","LongSumIntermediate","IntSumIntermediate","FloatSumIntermediate","BigDecimalSumIntermediate","BigIntegerSumIntermediate"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ ((Tuple)output).get(0)+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)((Tuple)output).get(0),(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal") {
      assertEquals(msg,((BigDecimal)((Tuple)output).get(0)).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
    }
 else     if (inputType == "BigInteger") {
      assertEquals(msg,((BigInteger)((Tuple)output).get(0)).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
    }
 else {
      assertEquals(msg,(Double)((Tuple)output).get(0),(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGFinal() throws Exception {
  String[] avgTypes={"AVGFinal","DoubleAvgFinal","LongAvgFinal","IntAvgFinal","FloatAvgFinal","BigDecimalAvgFinal","BigIntegerAvgFinal"};
  String[] avgIntermediateTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    EvalFunc<?> avgIntermediate=evalFuncMap.get(avgIntermediateTypes[k]);
    DataBag bg=(DataBag)tup.get(0);
    DataBag bg1=bagFactory.newDefaultBag();
    DataBag bg2=bagFactory.newDefaultBag();
    int i=0;
    for (    Tuple t : bg) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (t.get(0) == null) {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ZERO);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ZERO);
        }
 else {
          newTuple.set(1,new Long(0));
        }
      }
 else {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ONE);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ONE);
        }
 else {
          newTuple.set(1,new Long(1));
        }
      }
      if (i < 5) {
        bg1.add(newTuple);
      }
 else {
        bg2.add(newTuple);
      }
      i++;
    }
    Tuple intermediateInput1=tupleFactory.newTuple();
    intermediateInput1.append(bg1);
    Object output1=avgIntermediate.exec(intermediateInput1);
    Tuple intermediateInput2=tupleFactory.newTuple();
    intermediateInput2.append(bg2);
    Object output2=avgIntermediate.exec(intermediateInput2);
    DataBag bag=Util.createBag(new Tuple[]{(Tuple)output1,(Tuple)output2});
    Tuple finalTuple=TupleFactory.getInstance().newTuple(1);
    finalTuple.set(0,bag);
    Object output=avg.exec(finalTuple);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
    }
 else {
      assertEquals(msg,(Double)getExpected(avgTypes[k]),(Double)output,0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is not called - so initial is called
 * and then final is called
 * @throws Exception
 */
@Test public void testAggNoCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Final")) {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
 else {
        continue;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> avgInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        finalInputBg.add((Tuple)avgInitial.exec(initialInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for no combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called more than once - so initial is called
 * and then Intermediate called couple of times and then final is called
 * @throws Exception
 */
@Test public void testAggMultipleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag[] mapIntermediateInputBgs=new DataBag[4];
      for (int i=0; i < mapIntermediateInputBgs.length; i++) {
        mapIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      Iterator<Tuple> it=bg.iterator();
      for (int i=0; i < 4; i++) {
        for (int j=0; j < bg.size() / 4; j++) {
          DataBag initialInputBg=bagFactory.newDefaultBag();
          initialInputBg.add(it.next());
          Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
          mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
        }
        if (i == 3) {
          while (it.hasNext()) {
            DataBag initialInputBg=bagFactory.newDefaultBag();
            initialInputBg.add(it.next());
            Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
            mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
          }
        }
      }
      EvalFunc<?> aggIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag[] reduceIntermediateInputBgs=new DataBag[2];
      for (int i=0; i < reduceIntermediateInputBgs.length; i++) {
        reduceIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      for (int i=0; i < 4; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(mapIntermediateInputBgs[i]);
        if (i < 2) {
          reduceIntermediateInputBgs[0].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
 else {
          reduceIntermediateInputBgs[1].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
      }
      DataBag finalInputBag=bagFactory.newDefaultBag();
      for (int i=0; i < 2; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(reduceIntermediateInputBgs[i]);
        finalInputBag.add((Tuple)aggIntermediate.exec(intermediateInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBag);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for multiple combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAVG() throws Exception {
  String[] avgTypes={"AVG","DoubleAvg","LongAvg","IntAvg","FloatAvg","BigDecimalAvg","BigIntegerAvg"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    Object output=avg.exec(tup);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(avgTypes[k])).toPlainString());
    }
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(avgTypes[k]),0.00001);
    }
    assertNull(avg.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCharArrayToNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArrayToIntAndLongScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Long> map=new HashMap<Integer,Long>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      long value=rand.nextInt(100);
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input2.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.INTEGER,DataType.LONG};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input2.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.LONG) {
          Long expected=map.get(key);
          if (value != null) {
            Long actual=Long.parseLong(value);
            assertEquals(expected,actual);
          }
 else {
            assertEquals(expected,null);
          }
        }
        if (type == DataType.INTEGER) {
          Integer expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).intValue();
          }
          if (value != null) {
            Integer actual=Integer.parseInt(value);
            assertEquals(expected,actual);
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input2.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArray2FloatAndDoubleScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Double> map=new HashMap<Integer,Double>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      double value=rand.nextDouble() * 100;
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input1.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.DOUBLE,DataType.FLOAT};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input1.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.DOUBLE) {
          Double expected=map.get(key);
          if (value != null) {
            assertEquals(expected,(Double)Double.parseDouble(value));
          }
 else {
            assertNull(expected);
          }
        }
        if (type == DataType.FLOAT) {
          Float expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).floatValue();
          }
          if (value != null) {
            assertEquals(expected,(Float)Float.parseFloat(value));
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input1.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCast() throws ExecException {
  POCast cast=new POCast(newOperatorKey(),-1);
  POProject proj=new POProject(newOperatorKey(),-1,0);
  proj.setResultType(DataType.CHARARRAY);
  List<PhysicalOperator> inputs=new ArrayList<PhysicalOperator>();
  inputs.add(proj);
  cast.setInputs(inputs);
  String[] items={"12.0","-13.2","0.1f","1.3e2","zjf",MaxDouble.toString(),MinDouble.toString()};
  Double[] doubleExpected={12.0,-13.2,0.1,1.3e2,null,MaxDouble,MinDouble};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Double actual=(Double)cast.getNextDouble().result;
    if (doubleExpected[i] != null) {
      assertEquals(doubleExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"12.0","-13.2","0.1f","1.3e2",MaxFloat.toString(),MinFloat.toString(),"zjf"};
  Float[] floatExpected={12.0f,-13.2f,0.1f,1.3e2f,MaxFloat,MinFloat,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Float actual=(Float)cast.getNextFloat().result;
    if (floatExpected[i] != null) {
      assertEquals(floatExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxLong.toString(),MinLong.toString(),"df1.2"};
  Long[] longExpected={1L,-1L,12L,12L,MaxLong,MinLong,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Long actual=(Long)cast.getNextLong().result;
    if (longExpected[i] != null) {
      assertEquals(longExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxInteger.toString(),MinInteger.toString(),"ff4332"};
  Integer[] intExpected={1,-1,12,12,MaxInteger,MinInteger,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Integer actual=(Integer)cast.getNextInteger().result;
    if (intExpected[i] != null) {
      assertEquals(intExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCommit </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckin1() throws Exception {
  Tuple expected1=mTf.newTuple(2);
  Tuple expected2=mTf.newTuple(2);
  expected1.set(0,"independent");
  expected1.set(1,50.0);
  expected2.set(0,"democrat");
  expected2.set(1,125.5);
  File studentFile=Util.createInputFile("tmp","student",new String[]{"joe smith:18:3.5","amy brown:25:2.5","jim fox:20:4.0","leo fu:55:3.0"});
  File voterFile=Util.createInputFile("tmp","voter",new String[]{"amy brown,25,democrat,25.50","amy brown,25,democrat,100","jim fox,20,independent,50.0"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(studentFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(':') as (name, age, gpa);");
  pigServer.registerQuery("b = load '" + Util.encodeEscape(voterFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(',') as (name, age, registration, contributions);");
  pigServer.registerQuery("c = filter a by age < 50;");
  pigServer.registerQuery("d = filter b by age < 50;");
  pigServer.registerQuery("e = cogroup c by (name, age), d by (name, age);");
  pigServer.registerQuery("f = foreach @ generate flatten(c), flatten(d);");
  pigServer.registerQuery("g = group @ by registration;");
  pigServer.registerQuery("h = foreach @ generate (chararray)group, SUM(f.d::contributions);");
  pigServer.registerQuery("i = order @ by $1;");
  Iterator<Tuple> iter=pigServer.openIterator("i");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    count++;
    if (count == 1) {
      assertEquals(t.get(0),expected1.get(0));
      assertEquals(t.get(1),expected1.get(1));
    }
 else     if (count == 2) {
      assertEquals(t.get(0),expected2.get(0));
      assertEquals(t.get(1),expected2.get(1));
    }
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCubeOperator </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testDescribe() throws IOException {
  String query="a = load 'input' USING mock.Storage() as (a1:chararray,b1:chararray,c1:long); " + "b = cube a by cube(a1,b1);";
  Util.registerMultiLineQuery(pigServer,query);
  Schema sch=pigServer.dumpSchema("b");
  for (  String alias : sch.getAliases()) {
    if (alias.compareTo("cube") == 0) {
      assertTrue(alias.contains("cube"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBagAccess </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagStoreLoad() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"a\tid1","a\tid2","a\tid3","b\tid4","b\tid5","b\tid6"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (s:chararray, id:chararray);");
  pigServer.registerQuery("b = group a by s;");
  Class[] loadStoreClasses=new Class[]{BinStorage.class,PigStorage.class};
  for (int i=0; i < loadStoreClasses.length; i++) {
    String output="TestDataBagAccess-testBagStoreLoad-" + loadStoreClasses[i].getName() + ".txt";
    pigServer.deleteFile(output);
    pigServer.store("b",output,loadStoreClasses[i].getName());
    pigServer.registerQuery("c = load '" + output + "' using "+ loadStoreClasses[i].getName()+ "() AS "+ "(gp: chararray, bg:bag { t: tuple (sReLoaded: chararray, idReLoaded: chararray)});;");
    Iterator<Tuple> it=pigServer.openIterator("c");
    MultiMap<Object,Object> results=new MultiMap<Object,Object>();
    results.put("a","id1");
    results.put("a","id2");
    results.put("a","id3");
    results.put("b","id4");
    results.put("b","id5");
    results.put("b","id6");
    int j=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      Object groupKey=t.get(0);
      DataBag groupBag=(DataBag)t.get(1);
      Iterator<Tuple> bgIt=groupBag.iterator();
      int k=0;
      while (bgIt.hasNext()) {
        HashMap<Object,Boolean> seen=new HashMap<Object,Boolean>();
        Tuple bgt=bgIt.next();
        assertTrue(bgt.get(0).equals(groupKey));
        Collection values=results.get(groupKey);
        assertTrue(values.contains(bgt.get(1)));
        if (seen.containsKey(bgt.get(1)))         fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate value ("+ bgt.get(1)+ ")");
 else         seen.put(bgt.get(1),true);
        k++;
      }
      assertEquals(3,k);
      j++;
    }
    assertEquals(results.keySet().size(),j);
    pigServer.registerQuery("d = foreach c generate gp, flatten(bg);");
    List<Tuple> resultTuples=new ArrayList<Tuple>();
    resultTuples.add(Util.createTuple(new String[]{"a","a","id1"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id2"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id3"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id4"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id5"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id6"}));
    it=pigServer.openIterator("d");
    j=0;
    HashMap<Tuple,Boolean> seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("e = foreach d generate gp, sReLoaded, idReLoaded;");
    it=pigServer.openIterator("e");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("f = foreach d generate $0, $1, $2;");
    it=pigServer.openIterator("f");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDivide </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing DIVIDE operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(resba.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(resba.returnStatus,POStatus.STATUS_ERR);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(ress.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(ress.returnStatus,POStatus.STATUS_ERR);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 / inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
lt.setValue(inpd1);
rt.setValue(0.0);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 / inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
lt.setValue(inpf1);
rt.setValue(0.0f);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 / inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
lt.setValue(inpi1);
rt.setValue(0);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 / inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
lt.setValue(inpl1);
rt.setValue(0l);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEmptyInputDir </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'merge';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewedJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join B by $0, A by $0 using 'skewed';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFRJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'repl';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimit() throws Exception {
  int LOOP_COUNT=20;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = limit A 5;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    iter.next();
    ++numIdentity;
  }
  Assert.assertEquals(5,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMapUDF() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate (double)mymap#'double' as d, (long)mymap#'long' + (float)mymap#'float' as float_sum, CONCAT((chararray) mymap#'string', ' World!'), mymap#'int' * 10, (bag{tuple()}) mymap#'bag' as mybag, (tuple()) mymap#'tuple' as mytuple, (map[])mymap#'map' as mapInMap, mymap#'dba' as dba;" + "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(1.0,(Double)t.get(0),0.01);
    Assert.assertEquals(2.0,(Float)t.get(1),0.01);
    Assert.assertTrue(((String)t.get(2)).equals("Hello World!"));
    Assert.assertEquals(new Integer(10),(Integer)t.get(3));
    Assert.assertEquals(1,((DataBag)t.get(4)).size());
    Assert.assertEquals(4,((Tuple)t.get(5)).size());
    Assert.assertEquals(2,((Map<String,Object>)t.get(6)).size());
    Assert.assertEquals(DataByteArray.class,t.get(7).getClass());
    Assert.assertEquals(8,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT * LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanWithExpressionAssignment() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = " + Identity.class.getName() + "(*);"+ "C5 = COUNT(C2);"+ "C6 = SUM(C2.$1);"+ "C7 = "+ TitleNGrams.class.getName()+ "(C3);"+ "C8 = MAX(C3.$1);"+ "generate (int)group, C4, C5, C6, C7, C8, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=Util.createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=Util.createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigContext) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigContext) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlan() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "generate (int)group," + Identity.class.getName() + "(*), COUNT(C2), SUM(C2.$1),"+ TitleNGrams.class.getName()+ "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSortDesc() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num desc parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MAX_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum <= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSort() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MIN_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum >= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFwithStarInput() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "generate " + Identity.class.getName() + "(*);"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    Tuple t=(Tuple)tuple.get(0);
    Assert.assertEquals(DataByteArray.class,t.get(0).getClass());
    int group=Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
    Assert.assertEquals(numIdentity,group);
    Assert.assertTrue(t.get(1) instanceof DataBag);
    DataBag bag=(DataBag)t.get(1);
    Assert.assertEquals(10,bag.size());
    Assert.assertEquals(2,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigServer.getPigContext()) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin2 </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSoftLinkDoesNotCreateUnnecessaryConcatJob() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A all;"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = group C by x;"+ "E = group D all;"+ "F = FOREACH E generate B.$0;"+ "Z = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "Y = FOREACH E generate F.$0;"+ "STORE Y into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      fail("Somehow concatjob was created even though there is no large or multiple inputs.");
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSoftLinkDependencyWithMultipleScalarReferences() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A by x parallel "+ FILE_MERGE_THRESHOLD+ ";"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = FOREACH C generate B.$0;"+ "STORE D into '/tmp/output1';"+ "E = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "F = FOREACH E generate B.$0;"+ "STORE F into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  assertEquals("Unexpected number of mapreduce job. Missing concat job?",4,mrplan.size());
  MapReduceOper concatMRop=null;
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      concatMRop=mrOp;
      break;
    }
  }
  if (concatMRop == null) {
    fail("Cannot find concat job.");
  }
  assertEquals("Missing dependency for concatjob",2,mrplan.getSuccessors(concatMRop).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate ($1 >= " + LOOP_COUNT + "-10?'1':'0');";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    if (first == 1)     count++;
 else     assertTrue(first == 0);
  }
  assertEquals("expected count of 10",10,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorage </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that -noWAL actually disables the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testNoWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A,"-noWAL");
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertFalse(put.getWriteToWAL());
    Assert.assertFalse(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that without -noWAL, the WAL is enabled the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testWIthWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A);
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertNotEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertNotEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertTrue(put.getWriteToWAL());
    Assert.assertTrue(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInfixArithmetic </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 + $1, $1;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first + first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivide() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 / $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(1.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiply() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 * $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first * first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 - $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(0.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobControlCompiler </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that no duplicate jars are added to distributed cache, which might cause conflicts
 * and tests with both symlinked and normal jar specification
 */
@Test public void testNoDuplicateJarsInDistributedCache() throws Exception {
  final PigServer pigServer=new PigServer(ExecType.MAPREDUCE);
  PigContext pigContext=pigServer.getPigContext();
  pigContext.connect();
  Configuration conf=new Configuration();
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf-0.jar#udf.jar")),conf,FileSystem.get(conf));
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf1.jar#diffname.jar")),conf,FileSystem.get(conf));
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf2.jar")),conf,FileSystem.get(conf));
  createAndAddResource("udf.jar",pigContext);
  createAndAddResource("udf1.jar",pigContext);
  createAndAddResource("udf2.jar",pigContext);
  createAndAddResource("another.jar",pigContext);
  final JobConf jobConf=compileTestJob(pigContext,conf);
  URI[] cacheURIs=DistributedCache.getCacheFiles(jobConf);
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(jobConf);
  System.out.println("cache.files= " + Arrays.toString(cacheURIs));
  System.out.println("classpath.files= " + Arrays.toString(fileClassPaths));
  if (HadoopShims.isHadoopYARN()) {
    Assert.assertEquals("size 9 for " + Arrays.toString(cacheURIs),9,Arrays.asList(StringUtils.join(cacheURIs,",").split(",")).size());
    Assert.assertEquals("size 9 for " + Arrays.toString(fileClassPaths),9,Arrays.asList(StringUtils.join(fileClassPaths,",").split(",")).size());
  }
 else {
    Assert.assertEquals("size 12 for " + Arrays.toString(cacheURIs),12,Arrays.asList(StringUtils.join(cacheURIs,",").split(",")).size());
    Assert.assertEquals("size 12 for " + Arrays.toString(fileClassPaths),12,Arrays.asList(StringUtils.join(fileClassPaths,",").split(",")).size());
  }
  Map<String,Integer> occurrences=new HashMap<String,Integer>();
  for (  URI cacheURI : cacheURIs) {
    Integer val=occurrences.get(cacheURI.toString());
    val=(val == null) ? 1 : ++val;
    occurrences.put(cacheURI.toString(),val);
  }
  if (HadoopShims.isHadoopYARN()) {
    Assert.assertEquals(9,occurrences.size());
  }
 else {
    Assert.assertEquals(10,occurrences.size());
  }
  for (  String file : occurrences.keySet()) {
    if (!HadoopShims.isHadoopYARN() && (file.endsWith("udf.jar") || file.endsWith("udf2.jar"))) {
      Assert.assertEquals("Two occurrences for " + file,2,(int)occurrences.get(file));
    }
 else {
      Assert.assertEquals("One occurrence for " + file,1,(int)occurrences.get(file));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobSubmission </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSort() throws Throwable {
  String query="a = load 'input';" + "b = order a by $0 parallel 100;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isGlobalSort()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSkewJoin() throws Throwable {
  String query="a = load 'input';" + "b = load 'input';" + "c = join a by $0, b by $0 using 'skewed' parallel 100;"+ "store c into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isSkewedJoin()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFullOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 full outer, b by $0;";
    }
 else {
      script+="c = join a by $0 full, b by $0;";
    }
    script+="d = order c by $1, $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 full outer, b by $0;";
      }
 else {
        script+="c = join a by $0 full, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRightOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 right outer, b by $0;";
    }
 else {
      script+="c = join a by $0 right, b by $0;";
    }
    script+="d = order c by $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 right outer, b by $0;";
      }
 else {
        script+="c = join a by $0 right, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeftOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 left outer, b by $0;";
    }
 else {
      script+="c = join a by $0 left, b by $0;";
    }
    script+="d = order c by $1;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 left outer, b by $0;";
      }
 else {
        script+="c = join a by $0 left, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogToPhyCompiler </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplit() throws Exception {
  String query="split (load 'a') into x if $0 < '7', y if $0 > '7';" + "store x into 'output';";
  String goldenFile="test/org/apache/pig/test/data/GoldenFiles/Split1.gld";
  String compiledPlan=compilePlan(query,goldenFile,false);
  FileInputStream fis1=new FileInputStream(goldenFile);
  FileInputStream fis2=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/Split2.gld");
  byte[] b1=new byte[MAX_SIZE];
  byte[] b2=new byte[MAX_SIZE];
  int len=fis1.read(b1);
  int test=fis2.read(b2);
  String goldenPlan1=new String(b1,0,len);
  String goldenPlan2=new String(b2,0,len);
  goldenPlan1=Util.standardizeNewline(goldenPlan1);
  goldenPlan1=removedUnaffectingChanges(goldenPlan1);
  goldenPlan2=Util.standardizeNewline(goldenPlan2);
  goldenPlan2=removedUnaffectingChanges(goldenPlan2);
  System.out.println();
  System.out.println(compiledPlan);
  System.out.println("-------------testSplit");
  if (compiledPlan.compareTo(goldenPlan1) == 0 || compiledPlan.compareTo(goldenPlan2) == 0) {
  }
 else {
    System.out.println("Expected plan1=");
    System.out.println(goldenPlan1);
    System.out.println("Expected plan2=");
    System.out.println(goldenPlan1);
    System.out.println("Actual plan=");
    System.out.println(compiledPlan);
    System.out.println("**END**");
    fail("Plan not match");
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIsNull() throws Exception {
  String query="split (load 'a') into x if $0 IS NULL, y if $0 IS NOT NULL;" + "store x into 'output';";
  LogicalPlan plan=buildPlan(query);
  PhysicalPlan pp=buildPhysicalPlan(plan);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  pp.explain(baos);
  baos.write((int)'\n');
  String compiledPlan=baos.toString();
  compiledPlan=removedUnaffectingChanges(compiledPlan);
  if (generate) {
    FileOutputStream fos=new FileOutputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld");
    fos.write(baos.toByteArray());
  }
  FileInputStream fis1=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld");
  FileInputStream fis2=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull2.gld");
  byte[] b1=new byte[MAX_SIZE];
  byte[] b2=new byte[MAX_SIZE];
  int len=fis1.read(b1);
  int test=fis2.read(b2);
  String goldenPlan1=new String(b1,0,len);
  String goldenPlan2=new String(b2,0,len);
  goldenPlan1=Util.standardizeNewline(goldenPlan1);
  goldenPlan1=removedUnaffectingChanges(goldenPlan1);
  goldenPlan2=Util.standardizeNewline(goldenPlan2);
  goldenPlan2=removedUnaffectingChanges(goldenPlan2);
  System.out.println();
  System.out.println(compiledPlan);
  System.out.println("-------------testIsNull");
  if (compiledPlan.compareTo(goldenPlan1) == 0 || compiledPlan.compareTo(goldenPlan2) == 0) {
  }
 else {
    System.out.println("Expected plan1=");
    System.out.println(goldenPlan1);
    System.out.println("Expected plan2=");
    System.out.println(goldenPlan1);
    System.out.println("Actual plan=");
    System.out.println(compiledPlan);
    System.out.println("**END**");
    fail("Plan not match");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogicalPlanBuilder </h4><pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that parallel is parsed correctly Bug 831714 - fixed
 */
@Test public void testQuery18() throws Exception {
  String query="store (FOREACH (group (load 'a') ALL PARALLEL 16) generate group ) into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator root=lp.getSources().get(0);
  List<Operator> listOp=lp.getSuccessors(root);
  Operator lo=listOp.get(0);
  if (lo instanceof LOCogroup) {
    Assert.assertEquals(16,((LOCogroup)lo).getRequestedParallelism());
  }
 else {
    Assert.fail("Error: Unexpected Parse Tree output");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMod </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Mod operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 % inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 % inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiply </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Multiply operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 * inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 * inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 * inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 * inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-13 type-7 type-8 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDistinct() throws Exception {
  String testQuery="a = load 'd.txt' as (id, v1, v2);" + "b = load 'd.txt' as (id, v1, v2);" + "c = distinct a;"+ "d = union b, c;"+ "e = foreach d generate id, v1;"+ "store e into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(testQuery);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Operator o=iter.next();
    LogicalRelationalOperator lro=(LogicalRelationalOperator)o;
    if (lro == null || lro.getAlias() == null)     continue;
    if (lro.getAlias().equals("d")) {
      assertNotNull(lro.getSchema());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReverseDependencyOrderWalkerTree() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(jane,jill);
  SillyVisitor v=new SillyVisitor(plan,new ReverseDependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("jilljanebobjoefred") && !s.equals("jilljanebobfredjoe") && !s.equals("jillbobjoefredjane")&& !s.equals("jillbobjoejanefred")&& !s.equals("jillbobfredjoejane")&& !s.equals("jillbobfredjanejoe")&& !s.equals("jillbobjanejoefred")&& !s.equals("jillbobjanefredjoe")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDependencyOrderWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new DependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredjoebobjanejill") && !s.equals("joefredbobjanejill") && !s.equals("fredjoebobjilljane")&& !s.equals("joefredbobjilljane")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDepthFirstWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new DepthFirstWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredbobjilljanejoe") && !s.equals("joebobjilljanefred")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReverseDependencyOrderWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new ReverseDependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("jilljanebobjoefred") && !s.equals("jilljanebobfredjoe") && !s.equals("janejillbobjoefred")&& !s.equals("janejillbobfredjoe")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDependencyOrderWalkerTree() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(jane,jill);
  SillyVisitor v=new SillyVisitor(plan,new DependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredjoebobjanejill") && !s.equals("joefredbobjanejill") && !s.equals("janefredjoebobjill")&& !s.equals("janejoefredbobjill")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOBinCond </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondLongWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.LONG);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.LONG,new Long(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Long value=null;
    if (t.get(0) != null) {
      value=(Long)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDoubleWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DOUBLE);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DOUBLE,new Double(1.0));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Double value=null;
    if (t.get(0) != null) {
      value=(Double)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondIntWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.INTEGER);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.INTEGER,new Integer(1));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Integer value=null;
    Integer result;
    if (t.get(0) != null) {
      value=(Integer)t.get(0);
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
 else {
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
    int actual;
    if (value != null) {
      int expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDateTimeWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DATETIME);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DATETIME,new DateTime(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    DateTime value=null;
    if (t.get(0) != null) {
      value=(DateTime)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=value.equals(new DateTime(1L)) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOCast </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringToOther() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.CHARARRAY);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append((new Boolean(r.nextBoolean())).toString());
    plan.attachInput(t);
    String str=(String)t.get(0);
    Boolean b=null;
    if (str.equalsIgnoreCase("true")) {
      b=Boolean.TRUE;
    }
 else     if (str.equalsIgnoreCase("false")) {
      b=Boolean.FALSE;
    }
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
    t=tf.newTuple();
    t.append("neither true nor false");
    plan.attachInput(t);
    res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(null,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Integer(r.nextInt())).toString());
    plan.attachInput(t);
    Integer i=Integer.valueOf(((String)t.get(0)));
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Float(r.nextFloat())).toString());
    plan.attachInput(t);
    Float i=Float.valueOf(((String)t.get(0)));
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Long(r.nextLong())).toString());
    plan.attachInput(t);
    Long i=Long.valueOf(((String)t.get(0)));
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Double(r.nextDouble())).toString());
    plan.attachInput(t);
    Double i=Double.valueOf(((String)t.get(0)));
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new DateTime(r.nextLong())).toString());
    plan.attachInput(t);
    DateTime i=new DateTime(t.get(0));
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i.getMillis(),((DateTime)res.result).getMillis());
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i.getMillis(),((DateTime)res.result).getMillis());
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    String str=(String)t.get(0);
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((String)t.get(0)).getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBooleanToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextBoolean());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=(Boolean)t.get(0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Boolean)t.get(0)) ? Integer.valueOf(1) : Integer.valueOf(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Boolean)t.get(0)) ? Long.valueOf(1L) : Long.valueOf(0L);
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Boolean)t.get(0)) ? Float.valueOf(1.0F) : Float.valueOf(0.0F);
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Boolean)t.get(0)) ? Double.valueOf(1.0D) : Double.valueOf(0.0D);
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Boolean)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Boolean)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BAG);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataBag b=(DataBag)t.get(0);
    Result res=op.getNextDataBag();
    assertEquals(b,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:float)}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Float);
        assertTrue(((Float)(expectedBagTuple.get(1))).floatValue() == (Float)(convertedBagTuple.get(1)));
      }
    }
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Integer);
        assertTrue(((Integer)(expectedBagTuple.get(1))) == (Integer)(convertedBagTuple.get(1)));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloatToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0F : r.nextFloat());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.FLOAT);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Float)t.get(0)) != 0.0F);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Float)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Float)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Float)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Float)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Float)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Float)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Float)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float result=(Float)op.getNextFloat().result;
      assertEquals(null,result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0L : r.nextLong());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.LONG);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Long)t.get(0)) != 0L);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Long)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Long)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Long)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Long)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(t.get(0));
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Long)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Long)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0 : r.nextInt());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.INTEGER);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf((Integer)t.get(0) != 0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=(Integer)t.get(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Integer)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Integer)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Integer)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Integer)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Integer)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Integer)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0D : r.nextDouble());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DOUBLE);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Double)t.get(0)) != 0.0D);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Double)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Double)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Double)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Double)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Double)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Double)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Double)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testByteArrayToOther() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BYTEARRAY);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Boolean(r.nextBoolean())).toString().getBytes()));
    plan.attachInput(t);
    String str=((DataByteArray)t.get(0)).toString();
    Boolean b=null;
    if (str.equalsIgnoreCase("true")) {
      b=Boolean.TRUE;
    }
 else     if (str.equalsIgnoreCase("false")) {
      b=Boolean.FALSE;
    }
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Integer(r.nextInt())).toString().getBytes()));
    plan.attachInput(t);
    Integer i=Integer.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Float(r.nextFloat())).toString().getBytes()));
    plan.attachInput(t);
    Float i=Float.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Long(r.nextLong())).toString().getBytes()));
    plan.attachInput(t);
    Long i=Long.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Double(r.nextDouble())).toString().getBytes()));
    plan.attachInput(t);
    Double i=Double.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new DateTime(r.nextLong())).toString().getBytes()));
    plan.attachInput(t);
    DateTime i=new DateTime(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    String str=((DataByteArray)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    DataByteArray dba=(DataByteArray)t.get(0);
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextMap();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextTuple();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testByteArrayToOtherNoCast() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan plan=constructPlan(op);
  TupleFactory tf=TupleFactory.getInstance();
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Boolean input=new Boolean(r.nextBoolean());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
    t=tf.newTuple();
    t.append("neither true nor false");
    plan.attachInput(t);
    res=newOp.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(null,res.result);
    }
  }
{
    Tuple t=tf.newTuple();
    Integer input=new Integer(r.nextInt());
    t.append(input);
    plan.attachInput(t);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Float input=new Float(r.nextFloat());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Long input=new Long(r.nextLong());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Double input=new Double(r.nextDouble());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    DateTime input=new DateTime(r.nextLong());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Tuple input=GenRandomData.genRandSmallTuple("test",1);
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    DataBag input=GenRandomData.genRandSmallTupDataBag(r,10,100);
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDataBag();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Map<String,Object> input=new HashMap<String,Object>();
    input.put("key1","value1");
    input.put("key2","value2");
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextMap();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateTimeToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? new DateTime(0L) : new DateTime(r.nextLong()));
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DATETIME);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=null;
    Result res=op.getNextBoolean();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=new Long(((DateTime)t.get(0)).getMillis()).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=new Float(Long.valueOf(((DateTime)t.get(0)).getMillis()).floatValue());
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=new Long(((DateTime)t.get(0)).getMillis());
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=new Double(Long.valueOf(((DateTime)t.get(0)).getMillis()).doubleValue());
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=(DateTime)t.get(0);
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((DateTime)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((DateTime)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullToOther() throws PlanException, ExecException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=TupleFactory.getInstance().newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Boolean result=(Boolean)op.getNextBoolean().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.INTEGER);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.FLOAT);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DOUBLE);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double result=(Double)op.getNextDouble().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DATETIME);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      DateTime result=(DateTime)op.getNextDateTime().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.CHARARRAY);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      String result=(String)op.getNextString().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.BYTEARRAY);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Integer(r.nextInt())).toString().getBytes()));
    plan.attachInput(t);
    if (t.get(0) == null) {
      DataByteArray result=(DataByteArray)op.getNextString().result;
      assertEquals(null,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValueTypesChanged() throws IOException {
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    if (i % 6 == 0)     t.append(r.nextBoolean());
    if (i % 6 == 1)     t.append(r.nextInt());
    if (i % 6 == 2)     t.append(r.nextLong());
    if (i % 6 == 3)     t.append(r.nextDouble());
    if (i % 6 == 4)     t.append(r.nextFloat());
    if (i % 6 == 5)     t.append(r.nextLong());
    bag.add(t);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    planToTestBACasts.attachInput(t);
    Object toCast=t.get(0);
    Boolean b=DataType.toBoolean(toCast);
    Result res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    Integer i=DataType.toInteger(toCast);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    Long l=DataType.toLong(toCast);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    Float f=DataType.toFloat(toCast);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    Double d=DataType.toDouble(toCast);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    if (!(toCast instanceof Boolean)) {
      DateTime dt=DataType.toDateTime(toCast);
      res=opWithInputTypeAsBA.getNextDateTime();
      if (res.returnStatus == POStatus.STATUS_OK) {
        assertEquals(dt,res.result);
      }
    }
    String s=DataType.toString(toCast);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(s,res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPONegative </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegLongAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Long output=(Long)pn.getNextLong().result;
      assertNull(output);
    }
 else {
      Long expected=-(Long)t.get(0);
      long output=(Long)pn.getNextLong().result;
      assertEquals(expected.longValue(),output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegIntAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.INTEGER);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.INTEGER);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer output=(Integer)pn.getNextInteger().result;
      assertNull(output);
    }
 else {
      Integer expected=-(Integer)t.get(0);
      Integer output=(Integer)pn.getNextInteger().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegFloatAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float output=(Float)pn.getNextFloat().result;
      assertNull(output);
    }
 else {
      Float expected=-(Float)t.get(0);
      Float output=(Float)pn.getNextFloat().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegDoubleAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextDouble());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.DOUBLE);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.DOUBLE);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double output=(Double)pn.getNextDouble().result;
      assertNull(output);
    }
 else {
      Double expected=-(Double)t.get(0);
      Double output=(Double)pn.getNextDouble().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscaping() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputEscape.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult2.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMacroDef() throws Exception {
  log.info("Starting test testMacroDef() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input6.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult6.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileComboDuplicate() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFileDuplicates.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdnameAsParamDeclare() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputCmdnameAsParamDeclare.pig","sh \\$cmd.sh \\$date","\\$cmd.bat \\$date",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPigParamNotResolved() throws Exception {
  log.info("Starting test testPigParamNotResolved()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input3.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Undefined parameter : 4")) {
      fail("Pig supported parameter $4 should not have been resolved.");
    }
  }
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSameParamInMultipleFiles() throws Exception {
  log.info("Starting test testSameParamInMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile3.txt",basedir + "/ConfFile2.txt",basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamCurlySyntax() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input7.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult7.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParam() throws Exception {
  log.info("Starting test testCmdlineParam() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamPriortoDeclare() throws Exception {
  log.info("Starting test testCmdlineParamPriortoDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"param='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultCmdLnPriorDeclare.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionInFuncArgs() throws Exception {
  log.info("Starting test testSubstitutionInFuncArgs()");
  final String queryString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": $debug,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"$name\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  final String expectedString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": 5,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"TestRecord\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(queryString.getBytes("UTF-8"))));
  pigOStream=new FileWriter(basedir + "/output26.pig");
  String[] arg={"debug = '5'","name = 'TestRecord'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output26.pig");
  InputStream expected=new ByteArrayInputStream(expectedString.getBytes("UTF-8"));
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(expected));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareDefaultComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDefault.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexVals() throws Exception {
  log.info("Starting test testComplexVals() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input5.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"loadfile = /user/pig/tests/data/singlefile/textdoc.txt"};
  String[] argFiles={basedir + "/ConfFileComplexVal.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult3.txt");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithDollarSign() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDollarSign.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"filter=\"($0 == 'x') and ($1 == 'y')\""};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDollarSign.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommentWithParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputComment.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultComment.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamWithInlineCmd() throws Exception {
  log.info("Starting test testCmdlineParamWithInlineCmd() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=`perl -e \"print qq@20080228\\n20070101@\" | head -n 1`"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleCmdlineParam() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='092487'","date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand() throws Exception {
  log.info("Starting test testShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/input4.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDefault.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParamsFromMultipleFiles() throws Exception {
  log.info("Starting test testFileParamsFromMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt",basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinValue() throws Exception {
  log.info("Starting test  testSubstitutionWithinValue()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputSubstitutionWithinValue.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsinSingleLine() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstituteWithinLiteral() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParam() throws Exception {
  log.info("Starting test  testFileParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeclareScope() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleDeclares.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultMulDecs.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoVars() throws Exception {
  log.info("Starting test testNoVars() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputNoVars.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/inputNoVars.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinShellCommand() throws Exception {
  log.info("Starting test testSubstitutionWithinShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputSubstitutionWithinShellCommand.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsFromSingleFile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileSameParamMultipleTimes.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigRunner </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = limit B 1;");
  w.println("dump C;");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.toString().startsWith("tez")) {
      assertEquals(1,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),1);
    }
 else {
      assertEquals(2,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),2);
    }
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    if (execType.equals("tez")) {
      assertEquals(outputs.get(0).getNumberRecords(),5);
      assertEquals(outputs.get(1).getNumberRecords(),2);
    }
 else {
      for (      OutputStats outstats : outputs) {
        assertEquals(-1,outstats.getNumberRecords());
      }
    }
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(1,inputs.size());
    InputStats instats=inputs.get(0);
    assertEquals(5,instats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 < 0;");
  w1.println("store A into '" + OUTPUT_FILE + "';");
  w1.println("store B into 'output2';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("output2")) {
        assertEquals(0,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"output2");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void streamNegativeTest() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ temporarily as it hangs",Util.isMapredExecType(cluster.getExecType()));
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate 1;");
  w.println("C = foreach A generate 0/0;");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.println("store C into '" + OUTPUT_FILE_2 + "';");
  w.println("D = load '" + OUTPUT_FILE_2 + "';");
  w.println("E = stream D through `false`;");
  w.println("store E into 'ee';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    if (execType.equals("tez")) {
      assertTrue(stats.getReturnCode() == ReturnCode.FAILURE);
      assertTrue(stats.getJobGraph().size() == 1);
      JobStats job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        assertTrue(!output.isSuccessful());
      }
    }
 else {
      assertTrue(stats.getReturnCode() == ReturnCode.PARTIAL_FAILURE);
      assertTrue(stats.getJobGraph().size() == 2);
      JobStats job=(JobStats)stats.getJobGraph().getSources().get(0);
      assertTrue(job.isSuccessful());
      job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        if (output.getName().equals("ee")) {
          assertTrue(!output.isSuccessful());
        }
 else {
          assertTrue(output.isSuccessful());
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    final int numOfRecords=5;
    final int numOfCharsPerRecord=6;
    assertEquals(numOfRecords,stats.getRecordWritten());
    assertEquals(numOfRecords * numOfCharsPerRecord,stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(3,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.close();
  Util.copyFromLocalToCluster(cluster,"myinputfile","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '1.txt' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("1.txt")) {
        assertEquals(0,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    if (execType.equals("tez")) {
      assertEquals(5,inputs.get(0).getNumberRecords());
      assertEquals(5,inputs.get(1).getNumberRecords());
    }
 else {
      for (      InputStats instats : inputs) {
        assertEquals(-1,instats.getNumberRecords());
      }
    }
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(1,outputs.size());
    OutputStats outstats=outputs.get(0);
    assertEquals(9,outstats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void MQDepJobFailedTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (name:chararray, a1:int, a2:int);");
  w.println("store A into '" + OUTPUT_FILE_2 + "';");
  w.println("B = FOREACH A GENERATE org.apache.pig.test.utils.UPPER(name);");
  w.println("C= order B by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    Iterator<JobStats> iter=stats.getJobGraph().iterator();
    while (iter.hasNext()) {
      JobStats js=iter.next();
      if (execType.equals("tez")) {
        assertEquals(js.getState().name(),"FAILED");
      }
 else {
        if (js.getState().name().equals("FAILED")) {
          List<Operator> ops=stats.getJobGraph().getSuccessors(js);
          for (          Operator op : ops) {
            assertEquals(((JobStats)op).getState().toString(),"UNKNOWN");
          }
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorLogFile2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate StringSize(a0);");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-M","-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    Properties props=stats.getPigProperties();
    if (props != null) {
      String logfile=props.getProperty("pig.logfile");
      File f=new File(logfile);
      assertTrue(f.exists());
    }
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetHadoopCounters() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    String TASK_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.TaskCounter" : MRPigStatsUtil.TASK_COUNTER_GROUP;
    String FS_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.FileSystemCounter" : MRPigStatsUtil.FS_COUNTER_GROUP;
    if (execType.equals("tez")) {
      Counters counter=((JobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("INPUT_RECORDS_PROCESSED").getValue());
      assertEquals(2,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(7,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("OUTPUT_RECORDS").getValue());
      assertEquals(20,counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      assertEquals(new File(INPUT_FILE).length(),counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
 else {
      Counters counter=((MRJobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_INPUT_RECORDS).getValue());
      assertEquals(3,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_OUTPUT_RECORDS).getValue());
      assertEquals(2,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(0,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_OUTPUT_RECORDS).getValue());
      assertEquals(20,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      if (Util.isHadoop203plus())       return;
      assertEquals(30,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest3() throws Exception {
  final String INPUT_FILE_2="input2";
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE_2));
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  Util.copyFromLocalToCluster(cluster,INPUT_FILE_2,INPUT_FILE_2);
  new File(INPUT_FILE_2).delete();
  w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("A1 = load '" + INPUT_FILE_2 + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = filter A by a1 <=5;");
  w.println("D = join C by a0, B by a0, A1 by a0 using 'replicated';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.println("store D into '" + OUTPUT_FILE_2 + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(3,stats.getJobGraph().size());
    }
 else {
      assertEquals(1,stats.getJobGraph().size());
    }
    final int numOfRecords1=3;
    final int numOfRecords2=4;
    final int numOfBytesWritten1=18;
    final int numOfBytesWritten2=72;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals(numOfBytesWritten1 + numOfBytesWritten2,stats.getBytesWritten());
    List<String> outputNames=new ArrayList<String>(stats.getOutputNames());
    assertTrue(outputNames.size() == 2);
    Collections.sort(outputNames);
    assertEquals(OUTPUT_FILE,outputNames.get(0));
    assertEquals(OUTPUT_FILE_2,outputNames.get(1));
    assertEquals(3,stats.getNumberRecords(OUTPUT_FILE));
    assertEquals(4,stats.getNumberRecords(OUTPUT_FILE_2));
    List<InputStats> inputStats=new ArrayList<InputStats>(stats.getInputStats());
    assertTrue(inputStats.size() == 2);
    Collections.sort(inputStats,new Comparator<InputStats>(){
      @Override public int compare(      InputStats o1,      InputStats o2){
        return o1.getLocation().compareTo(o2.getLocation());
      }
    }
);
    assertEquals(5,inputStats.get(0).getNumberRecords());
    assertEquals(3,inputStats.get(1).getNumberRecords());
    if (!Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(30,inputStats.get(0).getBytes());
      assertEquals(18,inputStats.get(1).getBytes());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,INPUT_FILE_2);
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest2() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(stats.getJobGraph().size(),1);
    final int numOfRecords1=2;
    final int numOfRecords2=2;
    final int numOfCharsPerRecord1=6;
    final int numOfCharsPerRecord2=4;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals((numOfRecords1 * numOfCharsPerRecord1) + (numOfRecords2 * numOfCharsPerRecord2),stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(2,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C,D,E",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("tmp/output")) {
        assertEquals(2,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void orderByTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = order A by a0;");
  w.println("C = limit B 2;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,PIG_FILE};
  try {
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.equals("tez")) {
      assertEquals(stats.getJobGraph().size(),1);
      assertEquals(stats.getJobGraph().getSources().get(0).getPlan().size(),5);
    }
 else {
      assertEquals(stats.getJobGraph().size(),4);
    }
    assertTrue(stats.getJobGraph().getSinks().size() == 1);
    assertTrue(stats.getJobGraph().getSources().size() == 1);
    JobStats js=(JobStats)stats.getJobGraph().getSinks().get(0);
    assertEquals(OUTPUT_FILE,js.getOutputs().get(0).getName());
    assertEquals(2,js.getOutputs().get(0).getNumberRecords());
    assertEquals(12,js.getOutputs().get(0).getBytes());
    assertEquals(OUTPUT_FILE,stats.getOutputNames().get(0));
    assertEquals(2,stats.getRecordWritten());
    assertEquals(12,stats.getBytesWritten());
    if (execType.equals("tez")) {
      assertEquals("A,B",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
    }
 else {
      assertEquals("A",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
      assertEquals("B",((JobStats)stats.getJobGraph().getPredecessors(js).get(0)).getAlias());
      assertEquals("B",js.getAlias());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.close();
  String samefilename="tmp/input";
  Util.copyFromLocalToCluster(cluster,"myinputfile",samefilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + samefilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("tmp/input")) {
        assertEquals(2,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-7 type-8 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonExistingSecondDirectoryInSkewJoin() throws Exception {
  String script="exists = LOAD 'test/org/apache/pig/test/data/InputFiles/jsTst1.txt' AS (x:chararray, a:long);" + "missing = LOAD '/non/existing/directory' AS (a:long);" + "missing = FOREACH ( GROUP missing BY a ) GENERATE $0 AS a, COUNT_STAR($1);"+ "joined = JOIN exists BY a, missing BY a USING 'skewed';"+ "STORE joined INTO '/tmp/test_out.tsv';";
  PigServer pig=new PigServer(Util.getLocalTestMode());
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
      fail("Expect front exception");
    }
 catch (    Exception ex) {
      Throwable excp=ex;
      assertTrue(excp instanceof FrontendException);
      excp=excp.getCause();
      assertTrue(excp instanceof VisitorException);
      excp=excp.getCause();
      assertTrue(excp instanceof ExecException);
      excp=excp.getCause();
      assertTrue(excp instanceof InvalidInputException);
    }
  }
 else {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
    }
 catch (    Exception ex) {
      fail("Unexpected exception: " + ex);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRelationToExprProject </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterCount1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        filter_notone = filter test by (col2!=1);"+ "        generate group as col1, COUNT(filter_one) as cnt_one, COUNT(filter_notone) as cnt_notone;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Tuple[] expected=new DefaultTuple[2];
  expected[0]=(Tuple)Util.getPigConstant("(1,1L,1L)");
  expected[1]=(Tuple)Util.getPigConstant("(2,2L,0L)");
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertTrue(expected[j].equals(results[j]));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate filter_one;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("({(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("({(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(new Integer(1),occurences);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate group, filter_one;};";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("(1,{(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("(2,{(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(new Integer(3));
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(Integer.valueOf(1),occurences);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSampleOptimizer </h4><pre class="type-13 type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEndToEnd() throws Exception {
  PigServer pigServer=new PigServer(pc);
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(3);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' using PigStorage() AS (num:int);");
  pigServer.registerQuery("B = order A by num desc;");
  Iterator<Tuple> result=pigServer.openIterator("B");
  Integer prevNum=null;
  while (result.hasNext()) {
    Integer curNum=(Integer)result.next().get(0);
    if (null != prevNum)     assertTrue(curNum.compareTo(prevNum) <= 0);
    prevNum=curNum;
  }
  tmpFile.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplitCombine </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(700,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(800,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),3);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(800,pigSplit.getLength(0));
    }
 else     if (index == 1) {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(700,pigSplit.getLength(0));
    }
 else {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(600,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),2);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test7() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(300,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(3,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(600,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else     if (idx == 1) {
      Assert.assertEquals(3,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(300,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(100,pigSplit.getLength(0));
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test6() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(300,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(3,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(600,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else     if (idx == 1) {
      Assert.assertEquals(3,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(300,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(100,pigSplit.getLength(0));
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test5() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,false,conf);
  Assert.assertEquals(3,result.size());
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
    }
 else     if (index == 1) {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test4() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l4","l5"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(2,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(100,pigSplit.getLength(1));
    }
 else {
      Assert.assertEquals(4,len);
      Assert.assertEquals(500,pigSplit.getLength(0));
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(200,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
      Assert.assertEquals(100,pigSplit.getLength(3));
    }
    idx++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplitIndex </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplitIndex() throws Exception {
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputDir.toString()) + "' using "+ SplitSensitiveLoadFunc.class.getName()+ "();");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  boolean file1exist=false, file2exist=false;
  Tuple t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  if (!file1exist || !file2exist)   Assert.fail();
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplitIndexNoCombine() throws Exception {
  pigServer.getPigContext().getProperties().setProperty("pig.splitCombination","false");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputDir.toString()) + "' using "+ SplitSensitiveLoadFunc.class.getName()+ "();");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  boolean file1exist=false, file2exist=false;
  Tuple t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  if (!file1exist || !file2exist)   Assert.fail();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSubtract </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Subtract operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 - inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 - inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 - inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 - inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-8 type-9 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitUncompressed() throws Exception {
  resetLog(InterStorage.class);
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
  assertTrue(checkLogFileMessage(new String[]{"Pig Internal storage in use"}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-11 type-8 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  pig=new ToolsPigServer(cluster.getExecType(),cluster.getProperties());
  stdOutRedirectedFile=new File("stdout.redirected");
  if (!stdOutRedirectedFile.createNewFile())   fail("Unable to create input files");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeCheckingFail4() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20D);
  ConstantExpression constant3=new ConstantExpression(plan,"123");
  DivideExpression div1=new DivideExpression(plan,constant1,constant2);
  CastExpression cast1=new CastExpression(plan,constant3,createFS(DataType.BYTEARRAY));
  NotEqualExpression notequal1=new NotEqualExpression(plan,div1,cast1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    fail("Error during type checking");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFContext </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFContext() throws Exception {
  File a=Util.createInputFile("inp1","txt",new String[]{"dumb"});
  File b=Util.createInputFile("inp2","txt",new String[]{"dumber"});
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] statement={"A = LOAD '" + Util.encodeEscape(a.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('joe');","B = LOAD '" + Util.encodeEscape(b.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('jane');","C = union A, B;","D = FOREACH C GENERATE $0, $1, org.apache.pig.test.utils.UDFContextTestEvalFunc($0), " + "org.apache.pig.test.utils.UDFContextTestEvalFunc2($0);"};
  File tmpFile=File.createTempFile("temp_jira_851",".pig");
  FileWriter writer=new FileWriter(tmpFile);
  for (  String line : statement) {
    writer.write(line + "\n");
  }
  writer.close();
  pig.registerScript(tmpFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("D");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    if ("dumb".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"joe");
    }
 else     if ("dumber".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"jane");
    }
    assertEquals(Integer.valueOf(tuple.get(2).toString()),new Integer(5));
    assertEquals(tuple.get(3).toString(),"five");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnion </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaMergeWithBag() throws Exception {
  File f1=Util.createInputFile("tmp","input1.txt",new String[]{"dummy"});
  File f2=Util.createInputFile("tmp","input2.txt",new String[]{"dummy"});
  Util.registerMultiLineQuery(pigServer,"a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "';"+ "b = load '"+ Util.encodeEscape(f2.getAbsolutePath())+ "';"+ "c = foreach a generate 1, {(1, 'str1')};"+ "d = foreach b generate 2, {(2, 'str2')};"+ "e = union c,d;"+ "");
  Iterator<Tuple> it=pigServer.openIterator("e");
  Object[] expected=new Object[]{Util.getPigConstant("(1, {(1, 'str1')})"),Util.getPigConstant("(2, {(2, 'str2')})")};
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertEquals(expected[j],results[j]);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
