<h3><span class=" glyphicon glyphicon-tag"/>&nbspPublicFieldVerifier</h3><kbd>Verifies values related to public fields.</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.impl.streaming.TestPigStreamingUDF </h4><pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__nullString() throws IOException {
  byte[] input="|-_|_".getBytes();
  FieldSchema schema=new FieldSchema("",DataType.CHARARRAY);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Tuple expectedOutput=tf.newTuple(1);
  expectedOutput.set(0,null);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(expectedOutput,out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__nestedTuple() throws IOException {
  byte[] input="|(_|(_sammy|,_oes|)_|,_1234|,_sam|)_|_".getBytes();
  FieldSchema f1Inner=new FieldSchema("",DataType.CHARARRAY);
  FieldSchema f2Inner=new FieldSchema("",DataType.CHARARRAY);
  List<FieldSchema> fslInner=new ArrayList<FieldSchema>();
  fslInner.add(f1Inner);
  fslInner.add(f2Inner);
  Schema schemaInner=new Schema(fslInner);
  FieldSchema f1=new FieldSchema("",schemaInner,DataType.TUPLE);
  FieldSchema f2=new FieldSchema("",DataType.INTEGER);
  FieldSchema f3=new FieldSchema("",DataType.CHARARRAY);
  List<FieldSchema> fsl=new ArrayList<FieldSchema>();
  fsl.add(f1);
  fsl.add(f2);
  fsl.add(f3);
  Schema schema=new Schema(fsl);
  FieldSchema fs=new FieldSchema("",schema,DataType.TUPLE);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Tuple expectedOutputInner=tf.newTuple(2);
  expectedOutputInner.set(0,"sammy");
  expectedOutputInner.set(1,"oes");
  Tuple expectedOutput=tf.newTuple(3);
  expectedOutput.set(0,expectedOutputInner);
  expectedOutput.set(1,1234);
  expectedOutput.set(2,"sam");
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__multifieldTuple() throws IOException {
  byte[] input="|(_1234|,_sam|)_|_".getBytes();
  FieldSchema f1=new FieldSchema("",DataType.INTEGER);
  FieldSchema f2=new FieldSchema("",DataType.CHARARRAY);
  List<FieldSchema> fsl=new ArrayList<FieldSchema>();
  fsl.add(f1);
  fsl.add(f2);
  Schema schema=new Schema(fsl);
  FieldSchema fs=new FieldSchema("",schema,DataType.TUPLE);
  Tuple expectedOutput=tf.newTuple(2);
  expectedOutput.set(0,1234);
  expectedOutput.set(1,"sam");
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__bug() throws Exception {
  byte[] input="|(_|-_|,_32|,_987654321098765432|,_987654321098765432|)_|_".getBytes();
  FieldSchema f1=new FieldSchema("",DataType.CHARARRAY);
  FieldSchema f2=new FieldSchema("",DataType.INTEGER);
  FieldSchema f3=new FieldSchema("",DataType.LONG);
  FieldSchema f4=new FieldSchema("",DataType.LONG);
  List<FieldSchema> fsl=new ArrayList<FieldSchema>();
  fsl.add(f1);
  fsl.add(f2);
  fsl.add(f3);
  fsl.add(f4);
  Schema schema=new Schema(fsl);
  FieldSchema fs=new FieldSchema("",schema,DataType.TUPLE);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Tuple expectedOutput1=tf.newTuple(4);
  expectedOutput1.set(0,null);
  expectedOutput1.set(1,32);
  expectedOutput1.set(2,987654321098765432L);
  expectedOutput1.set(3,987654321098765432L);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput1),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__datetime() throws IOException {
  String dateString="2013-08-22T09:22:08.784004";
  byte[] input=(dateString + "|_").getBytes();
  FieldSchema schema=new FieldSchema("",DataType.DATETIME);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(ToDate.extractDateTime(dateString)),out);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__bag() throws IOException {
  byte[] input="|{_|(_A|,_1|)_|,_|(_B|,_2|)_|}_|_".getBytes();
  FieldSchema f1Inner=new FieldSchema("",DataType.CHARARRAY);
  FieldSchema f2Inner=new FieldSchema("",DataType.INTEGER);
  List<FieldSchema> fslInner=new ArrayList<FieldSchema>();
  fslInner.add(f1Inner);
  fslInner.add(f2Inner);
  Schema schemaInner=new Schema(fslInner);
  FieldSchema fsInner=new FieldSchema("",schemaInner,DataType.TUPLE);
  List<FieldSchema> fsl=new ArrayList<FieldSchema>();
  fsl.add(fsInner);
  Schema schema=new Schema(fsl);
  FieldSchema fs=new FieldSchema("",schema,DataType.BAG);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Tuple expectedOutputInner1=tf.newTuple(2);
  expectedOutputInner1.set(0,"A");
  expectedOutputInner1.set(1,1);
  Tuple expectedOutputInner2=tf.newTuple(2);
  expectedOutputInner2.set(0,"B");
  expectedOutputInner2.set(1,2);
  List<Tuple> tuples=new ArrayList<Tuple>();
  tuples.add(expectedOutputInner1);
  tuples.add(expectedOutputInner2);
  DataBag expectedOutput=DefaultBagFactory.getInstance().newDefaultBag(tuples);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__string() throws IOException {
  byte[] input="1234|_".getBytes();
  FieldSchema schema=new FieldSchema("",DataType.CHARARRAY);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple("1234"),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__boolean() throws IOException {
  byte[] input="true|_".getBytes();
  FieldSchema schema=new FieldSchema("",DataType.BOOLEAN);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(Boolean.TRUE),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__map() throws IOException {
  byte[] input="|[_A#B|,_C#D|]_|_".getBytes();
  FieldSchema fs=new FieldSchema("",DataType.MAP);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Map<String,String> expectedOutput=new TreeMap<String,String>();
  expectedOutput.put("A","B");
  expectedOutput.put("C","D");
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__newline() throws IOException {
  byte[] input="12\n34\n|_".getBytes();
  FieldSchema schema=new FieldSchema("",DataType.CHARARRAY);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Tuple out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple("12\n34\n"),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__emptyMap() throws IOException {
  byte[] input="|[_|]_|_".getBytes();
  FieldSchema fs=new FieldSchema("",DataType.MAP);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Map<String,String> expectedOutput=new TreeMap<String,String>();
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__emptyString() throws IOException {
  byte[] input="|_".getBytes();
  FieldSchema schema=new FieldSchema("",DataType.CHARARRAY);
  PigStreamingUDF sp=new PigStreamingUDF(schema);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(""),out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called once - so initial is called
 * and then Intermediate and then final is called
 * @throws Exception
 */
@Test public void testAggSingleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag intermediateInputBg1=bagFactory.newDefaultBag();
      DataBag intermediateInputBg2=bagFactory.newDefaultBag();
      int i=0;
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        if (i < bg.size() / 2) {
          intermediateInputBg1.add((Tuple)aggInitial.exec(initialInputTuple));
        }
 else {
          intermediateInputBg2.add((Tuple)aggInitial.exec(initialInputTuple));
        }
        i++;
      }
      EvalFunc<?> avgIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      Tuple intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg1);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg2);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for single combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCOUNT() throws Exception {
  Integer input[]={1,2,3,4,5,6,7,8,9,10,null};
  long expected=input.length - 1;
  EvalFunc<Long> count=new COUNT();
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  Long output=count.exec(tup);
  assertTrue(output == expected);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSFPig() throws Exception {
  Util.resetStateForExecModeSwitch();
  PigServer mrPigServer=new PigServer(cluster.getExecType(),properties);
  String inputStr="amy\tbob\tcharlene\tdavid\terin\tfrank";
  Util.createInputFile(cluster,"testSFPig-input.txt",new String[]{inputStr});
  DataByteArray[] input={new DataByteArray("amy"),new DataByteArray("bob"),new DataByteArray("charlene"),new DataByteArray("david"),new DataByteArray("erin"),new DataByteArray("frank")};
  Tuple f1=Util.loadTuple(TupleFactory.getInstance().newTuple(input.length),input);
  String outputLocation="testSFPig-output.txt";
  String query="a = load 'testSFPig-input.txt';" + "store a into '" + outputLocation + "';";
  mrPigServer.setBatchOn();
  Util.registerMultiLineQuery(mrPigServer,query);
  mrPigServer.executeBatch();
  LoadFunc lfunc=new ReadToEndLoader(new PigStorage(),ConfigurationUtil.toConfiguration(cluster.getProperties()),outputLocation,0);
  Tuple f2=lfunc.getNext();
  Util.deleteFile(cluster,"testSFPig-input.txt");
  Util.deleteFile(cluster,outputLocation);
  assertEquals(f1,f2);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is not called - so initial is called
 * and then final is called
 * @throws Exception
 */
@Test public void testAggNoCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Final")) {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
 else {
        continue;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> avgInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        finalInputBg.add((Tuple)avgInitial.exec(initialInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for no combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCOUNT_STAR() throws Exception {
  Integer input[]={1,2,3,4,5,6,7,8,9,10,null};
  long expected=input.length;
  EvalFunc<Long> count=new COUNT_STAR();
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  Long output=count.exec(tup);
  assertTrue(output == expected);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called more than once - so initial is called
 * and then Intermediate called couple of times and then final is called
 * @throws Exception
 */
@Test public void testAggMultipleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag[] mapIntermediateInputBgs=new DataBag[4];
      for (int i=0; i < mapIntermediateInputBgs.length; i++) {
        mapIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      Iterator<Tuple> it=bg.iterator();
      for (int i=0; i < 4; i++) {
        for (int j=0; j < bg.size() / 4; j++) {
          DataBag initialInputBg=bagFactory.newDefaultBag();
          initialInputBg.add(it.next());
          Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
          mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
        }
        if (i == 3) {
          while (it.hasNext()) {
            DataBag initialInputBg=bagFactory.newDefaultBag();
            initialInputBg.add(it.next());
            Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
            mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
          }
        }
      }
      EvalFunc<?> aggIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag[] reduceIntermediateInputBgs=new DataBag[2];
      for (int i=0; i < reduceIntermediateInputBgs.length; i++) {
        reduceIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      for (int i=0; i < 4; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(mapIntermediateInputBgs[i]);
        if (i < 2) {
          reduceIntermediateInputBgs[0].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
 else {
          reduceIntermediateInputBgs[1].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
      }
      DataBag finalInputBag=bagFactory.newDefaultBag();
      for (int i=0; i < 2; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(reduceIntermediateInputBgs[i]);
        finalInputBag.add((Tuple)aggIntermediate.exec(intermediateInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBag);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for multiple combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConstExpr </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataByteArray() throws ExecException {
  DataByteArray inp=GenRandomData.genRandDBA(r);
  ce.setValue(inp);
  Result resba=ce.getNextDataByteArray();
  DataByteArray ret=(DataByteArray)resba.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resba=ce.getNextDataByteArray();
  ret=(DataByteArray)resba.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException {
  Tuple inp=GenRandomData.genRandSmallBagTuple(r,10,100);
  ce.setValue(inp);
  Result rest=ce.getNextTuple();
  Tuple ret=(Tuple)rest.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  rest=ce.getNextTuple();
  ret=(Tuple)rest.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextInteger() throws ExecException {
  Integer inp=r.nextInt();
  ce.setValue(inp);
  Result resi=ce.getNextInteger();
  Integer ret=(Integer)resi.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resi=ce.getNextInteger();
  ret=(Integer)resi.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextLong() throws ExecException {
  Long inp=r.nextLong();
  ce.setValue(inp);
  Result resl=ce.getNextLong();
  Long ret=(Long)resl.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resl=ce.getNextLong();
  ret=(Long)resl.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDouble() throws ExecException {
  Double inp=r.nextDouble();
  ce.setValue(inp);
  Result resd=ce.getNextDouble();
  Double ret=(Double)resd.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resd=ce.getNextDouble();
  ret=(Double)resd.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextFloat() throws ExecException {
  Float inp=r.nextFloat();
  ce.setValue(inp);
  Result resf=ce.getNextFloat();
  Float ret=(Float)resf.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resf=ce.getNextFloat();
  ret=(Float)resf.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextString() throws ExecException {
  String inp=GenRandomData.genRandString(r);
  ce.setValue(inp);
  Result ress=ce.getNextString();
  String ret=(String)ress.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  ress=ce.getNextString();
  ret=(String)ress.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextMap() throws ExecException {
  Map<String,Object> inp=GenRandomData.genRandMap(r,10);
  ce.setValue(inp);
  Result resm=ce.getNextMap();
  Map<Integer,String> ret=(Map)resm.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resm=ce.getNextMap();
  ret=(Map)resm.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextBoolean() throws ExecException {
  Boolean inp=r.nextBoolean();
  ce.setValue(inp);
  Result res=ce.getNextBoolean();
  Boolean ret=(Boolean)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextBoolean();
  ret=(Boolean)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataBag() throws ExecException {
  DataBag inp=GenRandomData.genRandSmallTupDataBag(r,10,100);
  ce.setValue(inp);
  Result res=ce.getNextDataBag();
  DataBag ret=(DataBag)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextDataBag();
  ret=(DataBag)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTuple() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  int arity=5;
  int[] input1={1,2,3,4,5};
  String[] input2={"1","2","3","4","5"};
  String[] input3={"1","2","3","4","5","6"};
  Tuple f1=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f2=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f3=tf.newTuple(arity);
  assertEquals(arity,f1.size());
  assertEquals(f1,f2);
  f2=Util.loadTuple(tf.newTuple(input3.length),input3);
  assertFalse(f1.equals(f2));
  int[] input4={1,2,3};
  int[] input5={4,5};
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  f2=Util.loadFlatTuple(tf.newTuple(input4.length),input4);
  assertTrue(f1.compareTo(f2) > 0);
  assertFalse(f1.compareTo(f2) < 0);
  int[] input6={1,2,3,4,6};
  f2=Util.loadFlatTuple(tf.newTuple(input6.length),input6);
  assertTrue(f1.compareTo(f2) < 0);
  assertFalse(f1.compareTo(f2) > 0);
  String expected="1:2:3:4:5";
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  assertTrue(expected.equals(f1.toDelimitedString(":")));
  PipedOutputStream pos=new PipedOutputStream();
  DataOutputStream dos=new DataOutputStream(pos);
  PipedInputStream pis=new PipedInputStream(pos);
  DataInputStream dis=new DataInputStream(pis);
  f1.write(dos);
  f1.write(dos);
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilter </h4><pre class="type-13 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testGetNextTuple() throws Exception {
  pass.attachInput(t);
  Result res=pass.getNextTuple();
  assertEquals(t,res.result);
  fail.attachInput(t);
  res=fail.getNextTuple();
  assertEquals(res.returnStatus,POStatus.STATUS_EOP);
  for (int i=0; i < nullFlags.length; i++) {
    int count=0;
    setUpProjFil(nullFlags[i]);
    while (true) {
      res=projFil.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_EOP)       break;
      count++;
      assertEquals(POStatus.STATUS_OK,res.returnStatus);
      Tuple output=(Tuple)res.result;
      assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",true,TestHelper.bagContains(inp,output));
      assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",true,(Integer)((Tuple)res.result).get(1) > 50);
    }
    assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",getExpCount(inp),count);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEach </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException, IOException {
  int size=0;
  for (Result res=fe.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=fe.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    assertTrue(TestHelper.bagContains(projDB,t));
    ++size;
  }
  assertEquals(size,db.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocalRearrange </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple1() throws ExecException, PlanException {
  setUp1();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    String key=(String)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(1,val.size());
    Tuple actualVal=new DefaultTuple();
    actualVal.append(key);
    actualVal.append(val.get(0));
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    assertTrue(TestHelper.bagContains(db,actualVal));
    String inpKey=(String)actualVal.get(0);
    assertEquals(0,inpKey.compareTo((String)t.get(1)));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple2() throws ExecException, PlanException {
  setUp2();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    Tuple key=(Tuple)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(0,val.size());
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    val=key;
    assertTrue(TestHelper.bagContains(db,val));
    Tuple inpKey=TupleFactory.getInstance().newTuple(2);
    inpKey.set(0,val.get(0));
    inpKey.set(1,val.get(1));
    assertEquals(inpKey,(Tuple)t.get(1));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRCompiler </h4><pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSchemaInStoreForDistinctLimit() throws Exception {
  String query="a = load 'input1' as (a : int,b :float ,c : int);" + "b  = distinct a;" + "c = limit b 10;"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper secondMrOper=mrPlan.getLeaves().get(0);
  POStore store=(POStore)secondMrOper.reducePlan.getLeaves().get(0);
  assertEquals("compare load and store schema",store.getSchema(),Utils.getSchemaFromString("a : int,b :float ,c : int"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testStorerLimit() throws Exception {
  String query="a = load 'input1';" + "b = limit a 10;" + "store b into 'output' using " + PigStorageNoDefCtor.class.getName() + "(',');";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  LimitAdjuster la=new LimitAdjuster(mrPlan,pc);
  la.visit();
  la.adjust();
  MapReduceOper firstMrOper=mrPlan.getRoots().get(0);
  POStore store=(POStore)firstMrOper.reducePlan.getLeaves().get(0);
  assertEquals(store.getStoreFunc().getClass().getName(),"org.apache.pig.impl.io.InterStorage");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testMergeJoin() throws Exception {
  String query="a = load '/tmp/input1';" + "b = load '/tmp/input2';" + "c = join a by $0, b by $0 using 'merge';"+ "store c into '/tmp/output1';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MRCompiler comp=new MRCompiler(pp,pc);
  comp.compile();
  MROperPlan mrp=comp.getMRPlan();
  assertTrue(mrp.size() == 2);
  MapReduceOper mrOp0=mrp.getRoots().get(0);
  assertTrue(mrOp0.mapPlan.size() == 2);
  PhysicalOperator load0=mrOp0.mapPlan.getRoots().get(0);
  MergeJoinIndexer func=(MergeJoinIndexer)PigContext.instantiateFuncFromSpec(((POLoad)load0).getLFile().getFuncSpec());
  Field lrField=MergeJoinIndexer.class.getDeclaredField("lr");
  lrField.setAccessible(true);
  POLocalRearrange lr=(POLocalRearrange)lrField.get(func);
  List<PhysicalPlan> innerPlans=lr.getPlans();
  PhysicalOperator localrearrange0=mrOp0.mapPlan.getSuccessors(load0).get(0);
  assertTrue(localrearrange0 instanceof POLocalRearrange);
  assertTrue(mrOp0.reducePlan.size() == 3);
  PhysicalOperator pack0=mrOp0.reducePlan.getRoots().get(0);
  assertTrue(pack0 instanceof POPackage);
  PhysicalOperator foreach0=mrOp0.reducePlan.getSuccessors(pack0).get(0);
  assertTrue(foreach0 instanceof POForEach);
  PhysicalOperator store0=mrOp0.reducePlan.getSuccessors(foreach0).get(0);
  assertTrue(store0 instanceof POStore);
  assertTrue(innerPlans.size() == 1);
  PhysicalPlan innerPlan=innerPlans.get(0);
  assertTrue(innerPlan.size() == 1);
  PhysicalOperator project=innerPlan.getRoots().get(0);
  assertTrue(project instanceof POProject);
  assertTrue(((POProject)project).getColumn() == 0);
  MapReduceOper mrOp1=mrp.getSuccessors(mrOp0).get(0);
  assertTrue(mrOp1.mapPlan.size() == 3);
  PhysicalOperator load1=mrOp1.mapPlan.getRoots().get(0);
  assertTrue(load1 instanceof POLoad);
  PhysicalOperator mergejoin1=mrOp1.mapPlan.getSuccessors(load1).get(0);
  assertTrue(mergejoin1 instanceof POMergeJoin);
  PhysicalOperator store1=mrOp1.mapPlan.getSuccessors(mergejoin1).get(0);
  assertTrue(store1 instanceof POStore);
  assertTrue(mrOp1.reducePlan.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testFetchOptimizerSideEffect() throws Exception {
  String query="in1 = LOAD 'data.txt' AS (ident:chararray);" + "in2 = LOAD 'data.txt' AS (ident:chararray);" + "in3 = LOAD 'data.txt';"+ "joined = JOIN in1 BY ident LEFT OUTER, in2 BY ident;"+ "store joined into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mp=Util.buildMRPlan(pp,pc);
  FetchOptimizer.isPlanFetchable(pc,pp);
  MapReduceOper op=mp.getLeaves().get(0);
  PhysicalOperator store=op.reducePlan.getLeaves().get(0);
  POForEach foreach=(POForEach)op.reducePlan.getPredecessors(store).get(0);
  PhysicalOperator project=foreach.getInputPlans().get(0).getRoots().get(0);
  Field parentPlan=PhysicalOperator.class.getDeclaredField("parentPlan");
  parentPlan.setAccessible(true);
  assertTrue(parentPlan.get(project) == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryCompiler </h4><pre class="type-7 type-9 type-6 type-4 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemovalCollapseSplit(){
  System.out.println("===== multi-query unnecessary stores collapse split =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,1,6);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,11);
    MROperPlan mp=checkMRPlan(pp,1,1,2);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemoval(){
  System.out.println("===== multi-query unnecessary stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output3';");
    myPig.registerQuery("f = load '/tmp/output2';");
    myPig.registerQuery("g = group f by $0;");
    myPig.registerQuery("store g into '/tmp/output4';");
    LogicalPlan lp=checkLogicalPlan(1,2,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,20);
    MROperPlan mp=checkMRPlan(pp,1,2,3);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    MapReduceOper mo3=mp.getLeaves().get(1);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,2);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo3.mapPlan,1,1,2);
    checkPhysicalPlan(mo3.reducePlan,1,1,2);
    leaf=mo3.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFilterRemoval(){
  System.out.println("===== multi-query empty filters =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid>0;");
    myPig.registerQuery("c = filter a by uid>5;");
    myPig.registerQuery("d = filter c by uid<10;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("store b into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,10);
    MROperPlan mp=checkMRPlan(pp,1,1,1);
    MapReduceOper mo=mp.getRoots().get(0);
    checkPhysicalPlan(mo.mapPlan,1,1,4);
    PhysicalOperator leaf=mo.mapPlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,3);
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOCast </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BAG);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataBag b=(DataBag)t.get(0);
    Result res=op.getNextDataBag();
    assertEquals(b,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:float)}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Float);
        assertTrue(((Float)(expectedBagTuple.get(1))).floatValue() == (Float)(convertedBagTuple.get(1)));
      }
    }
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Integer);
        assertTrue(((Integer)(expectedBagTuple.get(1))) == (Integer)(convertedBagTuple.get(1)));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOGenerate </h4><pre class="type-13 type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testJoin() throws Exception {
  ExpressionOperator prj1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  ExpressionOperator prj2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  prj1.setResultType(DataType.BAG);
  prj2.setResultType(DataType.BAG);
  List<Boolean> toBeFlattened=new LinkedList<Boolean>();
  toBeFlattened.add(true);
  toBeFlattened.add(true);
  PhysicalPlan plan1=new PhysicalPlan();
  plan1.add(prj1);
  PhysicalPlan plan2=new PhysicalPlan();
  plan2.add(prj2);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  inputs.add(plan1);
  inputs.add(plan2);
  PhysicalOperator poGen=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toBeFlattened);
  for (  Tuple t : cogroup) {
    poGen.attachInput(t);
    Result output=poGen.getNextTuple();
    while (output.result != null && output.returnStatus != POStatus.STATUS_EOP) {
      Tuple tObtained=(Tuple)output.result;
      assertTrue(tObtained.get(0).toString().equals(tObtained.get(2).toString()));
      output=poGen.getNextTuple();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigContext </h4><pre class="type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings("deprecation") @Test public void testScriptFiles() throws Exception {
  PigContext pc=new PigContext(Util.getLocalTestMode(),getProperties());
  final int n=pc.scriptFiles.size();
  pc.addScriptFile("test/path-1824");
  assertEquals("test" + File.separator + "path-1824",pc.getScriptFiles().get("test/path-1824").toString());
  assertEquals("script files should not be populated",n,pc.scriptFiles.size());
  pc.addScriptFile("path-1824","test/path-1824");
  assertEquals("test" + File.separator + "path-1824",pc.getScriptFiles().get("path-1824").toString());
  assertEquals("script files should not be populated",n,pc.scriptFiles.size());
  pc.addScriptFile("path-1824","test/some/other/path-1824");
  assertEquals("test" + File.separator + "some"+ File.separator+ "other"+ File.separator+ "path-1824",pc.getScriptFiles().get("path-1824").toString());
  assertEquals("script files should not be populated",n,pc.scriptFiles.size());
  pc.getScriptFiles().remove("path-1824");
  pc.getScriptFiles().remove("test/path-1824");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPlanGeneration </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBagInnerPlan() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A { B1 = filter u by $1==0; generate B1;};" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertNull(tupleFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testStoreAlias() throws Exception {
  String query="A = load 'data' as (a0, a1);" + "B = filter A by a0 > 1;" + "store B into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  assertEquals("B",loStore.getAlias());
  PhysicalPlan pp=Util.buildPhysicalPlanFromNewLP(lp,pc);
  POStore poStore=(POStore)pp.getLeaves().get(0);
  assertEquals("B",poStore.getAlias());
  MROperPlan mrp=Util.buildMRPlanWithOptimizer(pp,pc);
  MapReduceOper mrOper=mrp.getLeaves().get(0);
  poStore=(POStore)mrOper.mapPlan.getLeaves().get(0);
  assertEquals("B",poStore.getAlias());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testEmptyBagDereference() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A generate u.$100;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertEquals(1,tupleFieldSchema.schema.size());
  assertEquals(DataType.BYTEARRAY,tupleFieldSchema.schema.getField(0).type);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSampleOptimizer </h4><pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerNotFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + "B = group A by $0;" + " C = order B by $0;"+ "store C into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + " B = order A by $0;" + "store B into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(2,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServerRegister() throws Exception {
  Util.createLocalInputFile("testRegisterScripts.jar",new String[]{"mary had a little lamb"});
  Util.createInputFile(cluster,"input1",new String[]{"abc:123","def:456","ghi:789"});
  File scriptFile=Util.createFile(new String[]{"register 'testRegisterScripts.jar';","a = load 'input1' using " + PigStorage.class.getName() + "(':');","b = foreach a generate $0;","store b into '/bla1';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServer() throws Exception {
  Util.createInputFile(cluster,"input",new String[]{"abc\t123","def\t456","ghi\t789"});
  File scriptFile=Util.createFile(new String[]{"a = load 'input' using " + PigStorage.class.getName() + "('\t');","b = foreach a generate $0;","store b into '/bla';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezJobControlCompiler </h4><pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismDefaultParallelism() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  pc.defaultParallel=5;
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name;"+ "store b into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),5);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorFilterFlatten() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = group b by name;"+ "d = foreach c generate group, flatten(b.gpa);"+ "e = group d by group;"+ "store e into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorSplitBranch() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = filter a by age>50;"+ "store b into 'o1';"+ "d = group c by name;"+ "store d into 'o2';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  Collections.sort(leaves);
  TezOperator leafOper=leaves.get(1);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorHashJoin() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = load '5' using "+ ArbitarySplitsLoader.class.getName()+ "() as (name:chararray, course:chararray);"+ "c = join a by name, b by name;"+ "store c into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),15);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun2() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = group a by x;"+ "c = foreach b generate group, a;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(1,root.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(1,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root.getOutputVertices().get(0),leaf);
  assertEquals(root,leaf.getInputVertices().get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun3() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = load '"+ input2+ "' as (x:int, z:int);"+ "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(2,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root0=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  Vertex root1=compiledPlan.second.getVertex(roots.get(1).getOperatorKey().toString());
  assertNotNull(root0);
  assertNotNull(root1);
  assertEquals(0,root0.getInputVertices().size());
  assertEquals(1,root1.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(2,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root0.getOutputVertices().get(0),leaf);
  assertEquals(root1.getOutputVertices().get(0),leaf);
  assertTrue(leaf.getInputVertices().contains(root0));
  assertTrue(leaf.getInputVertices().contains(root1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = filter a by x > 0;"+ "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(0,root.getOutputVertices().size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorOrderBy() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '2' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name parallel 3;"+ "c = foreach b generate group as name, AVG(a.age) as age;"+ "d = order c by age;"+ "store d into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator sortOper=compiledPlan.first.getLeaves().get(0);
  Vertex sortVertex=compiledPlan.second.getVertex(sortOper.getOperatorKey().toString());
  assertEquals(sortVertex.getParallelism(),-1);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
