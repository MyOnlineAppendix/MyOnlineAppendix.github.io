<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.TestMain </h4><pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun_setsErrorThrowableOnPigStats(){
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testRun_setsErrorThrowableOnPigStats";
    outputFile=File.createTempFile(filename,".out");
    outputFile.delete();
    File scriptFile=File.createTempFile(filename,".pig");
    BufferedWriter bw=new BufferedWriter(new FileWriter(scriptFile));
    bw.write("a = load 'test/org/apache/pig/test/data/passwd';\n");
    bw.write("b = group a by $0\n");
    bw.write("c = foreach b generate group, COUNT(a) as cnt;\n");
    bw.write("store c into 'out'\n");
    bw.close();
    Main.run(new String[]{"-x","local",scriptFile.getAbsolutePath()},null);
    PigStats stats=PigStats.get();
    Throwable t=stats.getErrorThrowable();
    assertTrue(t instanceof FrontendException);
    FrontendException fe=(FrontendException)t;
    SourceLocation sl=fe.getSourceLocation();
    assertEquals(2,sl.line());
    assertEquals(15,sl.offset());
    Throwable cause=fe.getCause();
    assertTrue(cause instanceof ParserException);
  }
 catch (  Exception e) {
    log.error("Encountered exception",e);
    fail("Encountered Exception");
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun_setsErrorThrowableForParamSubstitution(){
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testRun_setsErrorThrowableForParamSubstitution";
    outputFile=File.createTempFile(filename,".out");
    outputFile.delete();
    File scriptFile=File.createTempFile(filename,".pig");
    BufferedWriter bw=new BufferedWriter(new FileWriter(scriptFile));
    bw.write("a = load '$NOEXIST';\n");
    bw.write("b = group a by $0\n");
    bw.write("c = foreach b generate group, COUNT(a) as cnt;\n");
    bw.write("store c into 'out'\n");
    bw.close();
    Main.run(new String[]{"-x","local",scriptFile.getAbsolutePath()},null);
    PigStats stats=PigStats.get();
    Throwable t=stats.getErrorThrowable();
    assertTrue(t instanceof IOException);
    Throwable cause=t.getCause();
    assertTrue(cause instanceof ParameterSubstitutionException);
    ParameterSubstitutionException pse=(ParameterSubstitutionException)cause;
    assertTrue(pse.getMessage().contains("NOEXIST"));
  }
 catch (  Exception e) {
    log.error("Encountered exception",e);
    fail("Encountered Exception");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloPigCluster </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  loadTestData();
  final String loadFlights="flights = LOAD 'accumulo://flights?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String loadAirports="airports = LOAD 'accumulo://airports?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String joinQuery="joined = JOIN flights BY column_map#'origin', airports BY column_map#'code';";
  pig.registerQuery(loadFlights);
  pig.registerQuery(loadAirports);
  pig.registerQuery(joinQuery);
  Iterator<Tuple> it=pig.openIterator("joined");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Assert.assertEquals(4,t.size());
    Object o=t.get(1);
    Map<String,String> airport=null, flight=null;
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data1=(Map<String,String>)o;
    Assert.assertTrue(!data1.isEmpty());
    if (data1.containsKey("origin")) {
      flight=data1;
    }
 else     if (data1.containsKey("code")) {
      airport=data1;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    o=t.get(3);
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data2=(Map<String,String>)o;
    Assert.assertTrue(!data2.isEmpty());
    if (null == flight && data2.containsKey("origin")) {
      flight=data2;
    }
 else     if (null == airport && data2.containsKey("code")) {
      airport=data2;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    Assert.assertTrue(null != airport && null != flight);
    Assert.assertEquals(airport.get("code"),flight.get("origin"));
    i++;
  }
  Assert.assertEquals(6,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestSUBTRACT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldThrowAnIOExceptionAsInputDoesNotHaveTwoElements(){
  Tuple input=TupleFactory.getInstance().newTuple(1);
  try {
    input.set(0,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("SUBTRACT expected two inputs but received 1 inputs.",e.getMessage());
  }
  input=TupleFactory.getInstance().newTuple(3);
  try {
    input.set(0,bag());
    input.set(1,bag());
    input.set(2,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("SUBTRACT expected two inputs but received 3 inputs.",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldThrowAnIOExceptionAsInputDoesNotContainDataBagOnly(){
  Tuple input=TupleFactory.getInstance().newTuple(2);
  try {
    input.set(0,"2012/05/05");
    input.set(1,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("Expecting input to be DataBag only but was 'String'",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.mock.TestMockStorage </h4><pre class="type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMockStoreUnion() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  data.set("input2",tuple("d"),tuple("e"),tuple("f"));
  pigServer.registerQuery("A = LOAD 'input1' USING mock.Storage();");
  pigServer.registerQuery("B = LOAD 'input2' USING mock.Storage();");
  pigServer.registerQuery("C = UNION A, B;");
  pigServer.registerQuery("STORE C INTO 'output' USING mock.Storage();");
  List<Tuple> out=data.get("output");
  assertEquals(out + " size",6,out.size());
  Set<String> set=new HashSet<String>();
  for (  Tuple tuple : out) {
    if (!set.add((String)tuple.get(0))) {
      fail(tuple.get(0) + " is present twice in " + out);
    }
  }
  assertTrue(set + " contains a",set.contains("a"));
  assertTrue(set + " contains b",set.contains("b"));
  assertTrue(set + " contains c",set.contains("c"));
  assertTrue(set + " contains d",set.contains("d"));
  assertTrue(set + " contains e",set.contains("e"));
  assertTrue(set + " contains f",set.contains("f"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadUsage1() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  try {
    data.set("input1",tuple("d"),tuple("e"),tuple("f"));
    fail("should have thrown an exception for setting twice the same input");
  }
 catch (  RuntimeException e) {
    assertEquals("Can not set location input1 twice",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestAstValidator </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate if alias name duplication is caught.
 */
@Test public void tesNegative1() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x' as ( u:int, v:long, u:chararray, w:bytearray );");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof DuplicatedSchemaAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate if alias name duplication is caught. Slightly more complicated than above test case.
 */
@Test public void tesNegative2() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x' as ( u:int, v:long, w:tuple( w:long, u:chararray, w:bytearray) );");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof DuplicatedSchemaAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative3() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x'; C = limit B 100;");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof UndefinedAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestColumnAliasConversion </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidNestedProjection() throws Exception {
  String query="A = load 'x' as (field);" + "B = foreach A {" + "  C = LIMIT invalidName 1;"+ "  generate C.foo;"+ "};";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    System.out.println(ex.getMessage());
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNegative1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, $3), v, w; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  ParserValidationException ex) {
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNegative4() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.z, v, w; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  ParserValidationException ex) {
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNegative3() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, y), v, x; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNegative2() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, y), v, $5; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNegative5() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x';" + "B = foreach A generate u, $1; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestErrorHandling </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative8() throws IOException {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );\n" + "B = foreach A { S = c * 2; T = limit S 100; generate T; };\n" + "store B into 'y';";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 37"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative9() throws IOException {
  pig.registerQuery("a = load 'temp' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  try {
    pig.registerQuery("c = foreach b { " + " c1 = foreach a { " + " c11 = filter a by a1 > 0; "+ " generate c11; "+ " } "+ " generate c1; "+ " }\n");
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    Assert.assertTrue(msg.contains("line 5, column 32"));
    Assert.assertTrue(msg.contains("mismatched input '{' expecting GENERATE"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative6(){
  String query="A = load 'x';\n" + "B = load 'y' as ( u : int, v : chararray );\n" + "C = foreach A generate B.w, $0;\n"+ "D = store C into 'output';\n";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 3, column 23"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative7() throws IOException {
  String query="A = load 'x';\n" + "store A into 'fs2you://output';\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 2, column 0"));
    Assert.assertTrue(ex.getCause().getMessage().contains("No FileSystem for scheme: fs2you"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative4() throws IOException {
  String query="A = load 'x' as ( u:int, v:chararray );\n" + "C = foreach A generate u + v;";
  try {
    pig.registerQuery(query);
  }
 catch (  TypeCheckerException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 2, column 25"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative13() throws IOException {
  String query="A = load 'x' as (u:int, v);\n" + "B = load 'y';\n" + "C = join A by u, B by w;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(!msg.contains("null"));
    Assert.assertTrue(msg.contains("Projected field [w] does not exist."));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative5() throws IOException {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );\n" + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );\n" + "c = cogroup a by *, b by * ;\n"+ "d = foreach c generate group, flatten($1), flatten($2);\n"+ "e = foreach d generate group + 1, field1 + 1, field4 + 2.0;";
  try {
    pig.registerQuery(query);
  }
 catch (  TypeCheckerException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 5, column 29"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative12() throws IOException {
  String query="A = loadd 'x' as (name, age, gpa);\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertFalse(msg.contains("file null"));
    Assert.assertTrue(msg.contains("Syntax error, unexpected symbol at or near 'A'"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative2(){
  String query="A = load 'x' as ( u:int, v:long, w );\n" + "B = foreach A generate $5;";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 23"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative14() throws IOException {
  String query="A = load 'x'; \n" + "B = union A, A;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(msg.contains("Pig does not accept same alias as input for"));
    Assert.assertTrue(msg.contains("UNION"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative11() throws IOException {
  String query="A = load ^ 'x' as (name, age, gpa);\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertFalse(msg.contains("file null"));
    Assert.assertTrue(msg.contains("Unexpected character"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative1(){
  String query="A = load 'x' as ( u:int, v:long, u:chararray, w:bytearray );";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 1, column 33"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative3() throws IOException {
  String query="A = load 'x';\n" + "C = limit B 100;";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 10"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative15() throws IOException {
  String query="A = load 'x' as (a0, a1); \n" + "B = join A by a0, A by a1;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(msg.contains("Pig does not accept same alias as input for"));
    Assert.assertTrue(msg.contains("JOIN"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative10() throws IOException {
  String query="A = load 'x' as (u :int, v: chararray);\n" + "B = load 'y';\n" + "C = union onschema A, B;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 3, column 4"));
    Assert.assertTrue(ex.getMessage().contains("UNION ONSCHEMA cannot be used with relations that have null schema"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryLexer </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2() throws IOException {
  String query="A = load 'input' using PigStorage(';');" + "B = foreach ^ A generate string.concatsep( ';', $1, $2 );";
  CharStream input=new QueryParserStringStream(query,null);
  QueryLexer lexer=new QueryLexer(input);
  Token token;
  try {
    while ((token=lexer.nextToken()).getType() != Token.EOF) {
      if (token.getChannel() == Token.HIDDEN_CHANNEL)       continue;
      if (token.getText().equals(";")) {
        System.out.println(token.getText());
      }
 else {
        System.out.print(token.getText() + "(" + token.getType()+ ") ");
      }
    }
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Unexpected character"));
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDependentNullAlias() throws IOException, RecognitionException {
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  try {
    pigServer.registerQuery("F = limit F 20;store F into 'out';");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Unrecognized alias F"));
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestScalarVisitor </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.w, $0; "+ "D = store C into 'output';";
  try {
    visit(query);
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof InvalidScalarProjectionException);
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestSchemaAliasVisitor </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative3() throws RecognitionException, ParsingFailureException, IOException {
  String query="a = load '1.txt' as (a0:int, a0:int);" + "store a into 'output';";
  try {
    validate(query);
  }
 catch (  RecognitionException ex) {
    Assert.assertTrue(ex.toString().contains("Duplicated alias in schema"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = foreach A generate $0, v, $0; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    Assert.assertTrue(ex.getMessage().contains("Duplicate schema alias"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative2() throws RecognitionException, ParsingFailureException, IOException {
  String query="a = load '1.txt' as (a0:int, a1:int);" + "b = foreach a generate a0, a1 as a0;" + "c = store b into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    Assert.assertTrue(ex.getMessage().contains("Duplicate schema alias"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.datetime.truncate.TestTruncateDateTime </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Parsing ISO date with a time zone but no time will throw an exception.
 * @throws Exception
 */
@Test public void testParseDateTime_noTime_UTC() throws ExecException {
  Tuple t1=TupleFactory.getInstance().newTuple(1);
  t1.set(0,"2010-04-15Z");
  try {
    ISOHelper.parseDateTime(t1);
    fail("ISO date with a time zone but no time should not be parsable.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.decode.TestDecode </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBin() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(8);
  t1.set(0,new Integer(19));
  t1.set(1,"infant");
  t1.set(2,new Integer(5));
  t1.set(3,"young");
  t1.set(4,new Integer(20));
  t1.set(5,"normal");
  t1.set(6,new Integer(60));
  t1.set(7,"old");
  Tuple t2=TupleFactory.getInstance().newTuple(8);
  t2.set(0,new Double(1.78));
  t2.set(1,"S");
  t2.set(2,new Double(1.70));
  t2.set(3,"M");
  t2.set(4,new Double(1.80));
  t2.set(5,"L");
  t2.set(6,new Double(1.90));
  t2.set(7,"XL");
  Tuple t3=TupleFactory.getInstance().newTuple(8);
  t3.set(0,null);
  t3.set(1,"S");
  t3.set(2,new Double(1.70));
  t3.set(3,"M");
  t3.set(4,new Double(1.80));
  t3.set(5,"L");
  t3.set(6,new Double(1.90));
  t3.set(7,"XL");
  Tuple t4=TupleFactory.getInstance().newTuple(8);
  t4.set(0,new Double(1.78));
  t4.set(1,null);
  t4.set(2,new Double(1.70));
  t3.set(3,"M");
  t3.set(4,new Double(1.80));
  t3.set(5,"L");
  t3.set(6,new Double(1.90));
  t4.set(7,"XL");
  Bin func=new Bin();
  String r=func.exec(t1);
  assertTrue(r.equals("young"));
  r=func.exec(t2);
  assertTrue(r.equals("M"));
  r=func.exec(t3);
  assertTrue(r == null);
  try {
    r=func.exec(t4);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("Bin : Encounter null in the input"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(7);
  t1.set(0,false);
  t1.set(1,"s&a");
  t1.set(2,false);
  t1.set(3,"a");
  t1.set(4,true);
  t1.set(5,"s");
  t1.set(6,"n");
  Tuple t2=TupleFactory.getInstance().newTuple(7);
  t2.set(0,null);
  t2.set(1,"s&a");
  t2.set(2,false);
  t2.set(3,"a");
  t2.set(4,true);
  t2.set(5,"s");
  t2.set(6,"n");
  Tuple t3=TupleFactory.getInstance().newTuple(7);
  t3.set(0,false);
  t3.set(1,"s&a");
  t3.set(2,null);
  t3.set(3,"a");
  t3.set(4,true);
  t3.set(5,"s");
  t3.set(6,"n");
  BinCond func=new BinCond();
  String r=func.exec(t1);
  assertTrue(r.equals("s"));
  r=func.exec(t2);
  assertTrue(r == null);
  try {
    r=func.exec(t3);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("BinCond : Encounter null in the input"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecode() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(6);
  t1.set(0,new Integer(1));
  t1.set(1,0);
  t1.set(2,"Sales");
  t1.set(3,1);
  t1.set(4,"Engineering");
  t1.set(5,"Other");
  Tuple t2=TupleFactory.getInstance().newTuple(6);
  t2.set(0,new Integer(3));
  t2.set(1,0);
  t2.set(2,"Sales");
  t2.set(3,1);
  t2.set(4,"Engineering");
  t2.set(5,"Other");
  Tuple t3=TupleFactory.getInstance().newTuple(6);
  t3.set(0,null);
  t3.set(1,0);
  t3.set(2,"Sales");
  t3.set(3,1);
  t3.set(4,"Engineering");
  t3.set(5,"Other");
  Tuple t4=TupleFactory.getInstance().newTuple(6);
  t4.set(0,new Integer(1));
  t4.set(1,null);
  t4.set(2,"Sales");
  t4.set(3,1);
  t4.set(4,"Engineering");
  t4.set(5,"Other");
  Decode func=new Decode();
  String r=func.exec(t1);
  assertTrue(r.equals("Engineering"));
  r=func.exec(t2);
  assertTrue(r.equals("Other"));
  r=func.exec(t3);
  assertTrue(r == null);
  try {
    r=func.exec(t4);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("Decode : Encounter null in the input"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorage </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithData() throws IOException {
  String output=outbasedir + "testRecursiveWithData";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'data', '"+ Util.encodeEscape(testRecursiveRecordInUnion)+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("could not instantiate 'org.apache.pig.piggybank.storage.avro.AvroStorage'"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  String output=outbasedir + "testGenericUnion";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testGenericUnionFile) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("Cannot get schema"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithSchemaFile() throws IOException {
  String output=outbasedir + "testRecursiveWithSchemaFile";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema_file', '"+ Util.encodeEscape(testRecursiveRecordInUnionSchema)+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("could not instantiate 'org.apache.pig.piggybank.storage.avro.AvroStorage'"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithSchemaCheck() throws IOException {
  String output=outbasedir + "testRecursiveWithSchemaCheck";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'schema', '"+ recursiveRecordInUnion+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("bytearray is not compatible with avro"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlob6() throws IOException {
  String output=outbasedir + "testGlob6";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testNoMatchedFiles) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  JobCreationException e) {
    assertEquals(e.getMessage(),"Internal error creating job configuration.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema8() throws IOException {
  Schema x, y, z;
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,1);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.FIXED,z.getType());
  assertEquals(x.getFixedSize(),z.getFixedSize());
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,2);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Cannot merge FIXED types with different sizes"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPaths() throws IOException {
  final String basedir="file://" + System.getProperty("user.dir");
  final String tempdir=Long.toString(System.currentTimeMillis());
  final String nonexistentpath=basedir + "/" + tempdir+ "/this_path_does_not_exist";
  String locationStr=null;
  Set<Path> paths;
  Configuration conf=new Configuration();
  locationStr=basedir;
  paths=AvroStorageUtils.getPaths(locationStr,conf,true);
  assertFalse(paths.isEmpty());
  locationStr=nonexistentpath;
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  locationStr=basedir + "/{}";
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  paths=AvroStorageUtils.getPaths(locationStr,conf,false);
  assertTrue(paths.isEmpty());
  locationStr=basedir + "/{1,";
  try {
    AvroStorageUtils.getPaths(locationStr,conf,true);
    Assert.fail("Negative test to test illegal file pattern. Should not be succeeding!");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Illegal file pattern"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema6() throws IOException {
  Schema x, y, z;
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.MAP,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getValueType().getType());
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getValueType().getType() + " with "+ y.getValueType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema5() throws IOException {
  Schema x, y, z;
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.ARRAY,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getElementType().getType());
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getElementType().getType() + " with "+ y.getElementType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema3() throws IOException {
  Schema complexType[]={Schema.createRecord(new ArrayList<Schema.Field>()),Schema.createArray(Schema.create(Schema.Type.INT)),Schema.createMap(Schema.create(Schema.Type.INT)),Schema.createUnion(new ArrayList<Schema>()),Schema.createFixed("fixed",null,null,1)};
  for (int i=0; i < complexType.length; i++) {
    Schema x=complexType[i];
    for (int j=0; j < complexType.length; j++) {
      Schema y=complexType[j];
      if (i != j) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x,y);
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x.getType() + " with "+ y.getType(),e.getMessage());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema4() throws IOException {
  Schema x, y, z;
  List<Schema.Field> fields1=new ArrayList<Schema.Field>();
  fields1.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields1);
  List<Schema.Field> fields2=new ArrayList<Schema.Field>();
  fields2.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  y=Schema.createRecord(fields2);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  List<Schema.Field> fields3=new ArrayList<Schema.Field>();
  fields3.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields3);
  List<Schema.Field> fields4=new ArrayList<Schema.Field>();
  fields4.add(new Schema.Field("f1",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields4);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.DOUBLE,z.getField("f1").schema().getType());
  List<Schema.Field> fields5=new ArrayList<Schema.Field>();
  fields5.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields5);
  List<Schema.Field> fields6=new ArrayList<Schema.Field>();
  fields6.add(new Schema.Field("f1",Schema.create(Schema.Type.BOOLEAN),null,null));
  y=Schema.createRecord(fields6);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getField("f1").schema().getType() + " with "+ y.getField("f1").schema().getType(),e.getMessage());
  }
  List<Schema.Field> fields7=new ArrayList<Schema.Field>();
  fields7.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields7);
  List<Schema.Field> fields8=new ArrayList<Schema.Field>();
  fields8.add(new Schema.Field("f2",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields8);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size() + y.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  assertEquals(Schema.Type.DOUBLE,z.getField("f2").schema().getType());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  final String str1="[ \"string\", \"int\", \"boolean\"  ]";
  Schema s=Schema.parse(str1);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str2="[ \"string\", \"int\", \"null\"  ]";
  s=Schema.parse(str2);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str3="[ \"string\", \"null\"  ]";
  s=Schema.parse(str3);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  Schema realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str4="{\"type\": \"array\", \"items\": " + str2 + "}";
  s=Schema.parse(str4);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  try {
    realSchema=AvroStorageUtils.getAcceptedType(s);
    fail("\"Should throw a runtime exception when trying to get accepted type from a unacceptable union");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Cannot call this function on a unacceptable union"));
  }
  final String str5=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"null\", \"int\"] } ] }";
  s=Schema.parse(str5);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  final String str6=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"string\", \"int\"] } ] }";
  s=Schema.parse(str6);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str7="[ \"string\"  ]";
  s=Schema.parse(str7);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str8="[  ]";
  s=Schema.parse(str8);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertNull(realSchema);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema2() throws IOException {
  Schema.Type primitiveType[]={Schema.Type.NULL,Schema.Type.BOOLEAN,Schema.Type.BYTES,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.ENUM,Schema.Type.STRING};
  Schema.Type expectedType[][]={{Schema.Type.NULL,null,null,null,null,null,null,null,null},{null,Schema.Type.BOOLEAN,null,null,null,null,null,null,null},{null,null,Schema.Type.BYTES,null,null,null,null,null,null},{null,null,null,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.LONG,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.ENUM,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING}};
  List<String> enumSymbols=new ArrayList<String>();
  enumSymbols.add("sym1");
  enumSymbols.add("sym2");
  Schema enumSchema=Schema.createEnum("enum",null,null,enumSymbols);
  for (int i=0; i < primitiveType.length; i++) {
    Schema.Type x=primitiveType[i];
    for (int j=0; j < primitiveType.length; j++) {
      Schema.Type y=primitiveType[j];
      if (expectedType[i][j] == null) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x + " with "+ y,e.getMessage());
        }
      }
 else {
        Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
        assertEquals(expectedType[i][j],z.getType());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumBasic() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,1);
  expected.put(300,3);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.BagCount(A);");
  try {
    iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
    fail("accumulator should not be called.");
  }
 catch (  IOException e) {
  }
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("C = cogroup A by id, B by id;");
  pigServer.registerQuery("D = foreach C generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.AccumulatorBagCount(B);");
  HashMap<Integer,String> expected2=new HashMap<Integer,String>();
  expected2.put(100,"2,2");
  expected2.put(200,"1,1");
  expected2.put(300,"3,3");
  expected2.put(400,"1,1");
  iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected2.get((Integer)t.get(0)),t.get(1).toString() + "," + t.get(2).toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBlackAndWhitelistValidator </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPreprocessorCommands2() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"dEfaUlt");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("set io.sort.mb 1000;").append("%Default input 'foo';").append("A = LOAD '$input' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(RuntimeException.class,e,"DEFAULT command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPreprocessorCommand3() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"Define");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("set io.sort.mb 1000;").append("DEFINE UrlDecode InvokeForString('java.net.URLDecoder.decode', 'String String');  ").append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"Error during parsing. DEFINE command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRun() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"run");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("run evil.pig;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"RUN command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExplain() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"explain");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("EXPLAIN B;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"EXPLAIN command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExec() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"exec");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("exec evil.pig;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"EXEC command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test listStatus fails if its disallowed via the blacklist
 */
@Test public void testBlacklistCmdWithPigServer() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"ls");
    PigServer pigServer=new PigServer(ctx);
    pigServer.listPaths("foo");
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"LS command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests {@link BlackAndWhitelistValidator}. The logical plan generated
 * contains a filter, and the test must throw a {@link FrontendException} as
 * we set "filter" in the blacklist
 * @throws Exception
 */
@Test public void testValidator() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"filter");
    LogicalPlan plan=generateLogicalPlan("foo","bar",ctx.getDfs());
    LogicalRelationalNodeValidator executor=new BlackAndWhitelistValidator(ctx,plan);
    executor.validate();
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"filter is disabled. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImport() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"import");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("import 'piggybank.jar';").append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("run evil.pig;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"Error during parsing. IMPORT command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * If there is a conflict between blacklist and whitelist contents, the
 * validator or filter must throw an {@link IllegalStateException}.
 * @throws Exception
 */
@Test public void testBlackAndWhitelist() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_WHITELIST,"load, store, filter");
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"filter");
    LogicalPlan plan=generateLogicalPlan("foo","bar",ctx.getDfs());
    LogicalRelationalNodeValidator executor=new BlackAndWhitelistValidator(ctx,plan);
    executor.validate();
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(IllegalStateException.class,e,"Conflict between whitelist and blacklist. 'filter' appears in both.");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWhitelist2() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_WHITELIST,"load, store");
    LogicalPlan plan=generateLogicalPlan("foo","bar",ctx.getDfs());
    LogicalRelationalNodeValidator executor=new BlackAndWhitelistValidator(ctx,plan);
    executor.validate();
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"filter is disabled. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests the blacklist filter. We blacklist "set" and make sure this test
 * throws a {@link FrontendException}
 * @throws Exception
 */
@Test public void testBlacklist() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"set");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("set io.sort.mb 1000;").append("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(FrontendException.class,e,"SET command is not permitted. ");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * A few commands such as DECLARE, DEFAULT go via{@link PreprocessorContext}. This step basically parses commands and
 * substitutes parameters. The parameters can be evaluated using shell
 * commands, which need to validated if specified in the white or blacklist.
 * This test handles that scenario
 * @throws Exception
 */
@Test public void testPreprocessorCommands() throws Exception {
  try {
    ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"dEclAre");
    PigServer pigServer=new PigServer(ctx);
    Data data=resetData(pigServer);
    data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
    StringBuilder script=new StringBuilder();
    script.append("set io.sort.mb 1000;").append("%declare X `echo`; ").append("%default input 'foo';").append("A = LOAD '$input' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);").append("B = order A by f1,f2,f3 DESC;").append("STORE B INTO 'bar' USING mock.Storage();");
    pigServer.registerScript(IOUtils.toInputStream(script));
    fail();
  }
 catch (  Exception e) {
    Util.assertExceptionAndMessage(RuntimeException.class,e,"DECLARE command is not permitted. ");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidArgumentType() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT('data');");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with an argument of type chararray.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidNumberOfArguments_WithoutInputSchema() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0, $1.$0);");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with couple of arguments.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithInputSchema_Two() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithNullTuplesInInput_CaseTwo() throws Exception {
  String[] inputData=new String[]{"1 2 3 4\n","\n","a b c d\n","\n","r s t u"};
  File file=Util.createInputFile("tmp","CountTest.txt",inputData);
  String inputFileName=file.getAbsolutePath();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFileName) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    file.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithoutInputSchema_Two() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidNumberOfArguments_WithInputSchema() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0, $1.$0);");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with couple of arguments.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithInputSchema_One() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithNullTuplesInInput_CaseOne() throws Exception {
  String inputFileName="CountTest.txt";
  String[] inputData=new String[]{"1 2 3 4\n","\n","a b c d\n","\n","r s t u"};
  File inputFile=Util.createInputFile("tmp",inputFileName,inputData);
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCount_ValidNumberOfArguments_WithoutInputSchema_One() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0);");
    assertValidCount();
  }
 catch (  TypeCheckerException e) {
    Assert.fail("Query is in accordance with schema, still it failed to execute");
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCase </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when case expression is missing,
 * and when branches do not contain conditional expressions.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingCaseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE " + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingWhenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN   THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingElseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE "+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingThenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN "+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCmdLineParser </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AssertionError.class) public void testDoubleRegisterShort(){
  String[] args={"a","b","c"};
  CmdLineParser p=new CmdLineParser(args);
  try {
    p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
    p.registerOpt('a',"beta",CmdLineParser.ValueExpected.NOT_ACCEPTED);
    fail("Should have thrown an AssertionError");
  }
 catch (  AssertionError e) {
    assertEquals(e.getMessage(),"CmdLineParser:  You have already registered option a");
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCollectedGroup </h4><pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByStar() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by * using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by *;");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForMultipleInputs() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("C = group A by id, B by id using 'collected';");
    pigServer.openIterator("C");
    Assert.fail("Pig doesn't support multi-input collected group.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for single input";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForByExpression() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("B = group A by id*grade using 'collected';");
    pigServer.openIterator("B");
    Assert.fail("Pig doesn't support collected group by expression.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for columns or star projection";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForGroupAll() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("B = group A all using 'collected';");
    pigServer.openIterator("B");
    Assert.fail("Pig doesn't support collected group all.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for columns or star projection";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupWithMergeJoin() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("C = join A by id, B by id using 'merge';");
      pigServer.registerQuery("D = group C by A::id using 'collected';");
      pigServer.registerQuery("E = foreach D generate group, COUNT(C);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("F = join A by id, B by id;");
      pigServer.registerQuery("G = group F by A::id;");
      pigServer.registerQuery("H = foreach G generate group, COUNT(F);");
      Iterator<Tuple> iter=pigServer.openIterator("H");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByOneColumn() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by id using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by id;");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByMultipleColumns() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by (id, name) using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by (id, name);");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonCollectableLoader() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, grade);"+ "B = group A by id using 'collected';";
  PigContext pc=new PigContext(cluster.getExecType(),cluster.getProperties());
  pc.connect();
  try {
    Util.buildMRPlan(Util.buildPp(pigServer,query),pc);
    Assert.fail("Must throw MRCompiler Exception");
  }
 catch (  Exception e) {
    Assert.assertTrue(e instanceof MRCompilerException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCubeOperator </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCubeDuplicateDimensions() throws IOException {
  String query="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate x as type,y as location, z as number;" + "c = cube b by cube($0..$1,$0..$1);"+ "d = foreach c generate flatten(group), COUNT_STAR(cube) as count, SUM(cube.number) as total;"+ "store d into 'output' using mock.Storage();";
  try {
    Util.registerMultiLineQuery(pigServer,query);
    pigServer.openIterator("d");
  }
 catch (  FrontendException e) {
    return;
  }
  Assert.fail("Expected to throw an exception when duplicate dimensions are detected!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCustomPartitioner </h4><pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerDistinct() throws Exception {
  String[] input={"1\t1","2\t1","1\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerDistinct",input);
  String outputDir="tmp_testCustomPartitionerDistinct";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerDistinct' as (a0:int, a1:int);");
  pigServer.registerQuery("B = distinct A PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerDistinct");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerParseJoins() throws Exception {
  String[] input={"1\t3","1\t2"};
  Util.createInputFile(cluster,"table_testCustomPartitionerParseJoins",input);
  try {
    pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerParseJoins' as (a0:int, a1:int);");
    pigServer.registerQuery("B = ORDER A by $0;");
    pigServer.registerQuery("skewed = JOIN A by $0, B by $0 USING 'skewed' PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner;");
    Assert.fail("Skewed join cannot accept a custom partitioner");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getMessage().contains("Custom Partitioner is not supported for skewed join"));
  }
  pigServer.registerQuery("hash = JOIN A by $0, B by $0 USING 'hash' PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner;");
  Iterator<Tuple> iter=pigServer.openIterator("hash");
  List<String> expected=new ArrayList<String>();
  expected.add("(1,3,1,2)");
  expected.add("(1,3,1,3)");
  expected.add("(1,2,1,2)");
  expected.add("(1,2,1,3)");
  Collections.sort(expected);
  List<String> actual=new ArrayList<String>();
  while (iter.hasNext()) {
    actual.add(iter.next().toString());
  }
  Collections.sort(actual);
  Assert.assertEquals(expected,actual);
  Util.deleteFile(cluster,"table_testCustomPartitionerParseJoins");
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerGroups() throws Exception {
  String[] input={"1\t1","2\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerGroups",input);
  String outputDir="tmp_testCustomPartitionerGroup";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerGroups' as (a0:int, a1:int);");
  pigServer.registerQuery("B = group A by $0 PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerGroups");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBagAccess </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagStoreLoad() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"a\tid1","a\tid2","a\tid3","b\tid4","b\tid5","b\tid6"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (s:chararray, id:chararray);");
  pigServer.registerQuery("b = group a by s;");
  Class[] loadStoreClasses=new Class[]{BinStorage.class,PigStorage.class};
  for (int i=0; i < loadStoreClasses.length; i++) {
    String output="TestDataBagAccess-testBagStoreLoad-" + loadStoreClasses[i].getName() + ".txt";
    pigServer.deleteFile(output);
    pigServer.store("b",output,loadStoreClasses[i].getName());
    pigServer.registerQuery("c = load '" + output + "' using "+ loadStoreClasses[i].getName()+ "() AS "+ "(gp: chararray, bg:bag { t: tuple (sReLoaded: chararray, idReLoaded: chararray)});;");
    Iterator<Tuple> it=pigServer.openIterator("c");
    MultiMap<Object,Object> results=new MultiMap<Object,Object>();
    results.put("a","id1");
    results.put("a","id2");
    results.put("a","id3");
    results.put("b","id4");
    results.put("b","id5");
    results.put("b","id6");
    int j=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      Object groupKey=t.get(0);
      DataBag groupBag=(DataBag)t.get(1);
      Iterator<Tuple> bgIt=groupBag.iterator();
      int k=0;
      while (bgIt.hasNext()) {
        HashMap<Object,Boolean> seen=new HashMap<Object,Boolean>();
        Tuple bgt=bgIt.next();
        assertTrue(bgt.get(0).equals(groupKey));
        Collection values=results.get(groupKey);
        assertTrue(values.contains(bgt.get(1)));
        if (seen.containsKey(bgt.get(1)))         fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate value ("+ bgt.get(1)+ ")");
 else         seen.put(bgt.get(1),true);
        k++;
      }
      assertEquals(3,k);
      j++;
    }
    assertEquals(results.keySet().size(),j);
    pigServer.registerQuery("d = foreach c generate gp, flatten(bg);");
    List<Tuple> resultTuples=new ArrayList<Tuple>();
    resultTuples.add(Util.createTuple(new String[]{"a","a","id1"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id2"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id3"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id4"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id5"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id6"}));
    it=pigServer.openIterator("d");
    j=0;
    HashMap<Tuple,Boolean> seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("e = foreach d generate gp, sReLoaded, idReLoaded;");
    it=pigServer.openIterator("e");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("f = foreach d generate $0, $1, $2;");
    it=pigServer.openIterator("f");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testDetermineFieldSchemaErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.determineFieldSchema(list);
    fail("Error expected.");
  }
 catch (  ExecException ee) {
    assertEquals(1073,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimit() throws Exception {
  int LOOP_COUNT=20;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = limit A 5;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    iter.next();
    ++numIdentity;
  }
  Assert.assertEquals(5,numIdentity);
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMapUDFfail() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate mymap#'dba' * 10;" + "};";
  pigServer.registerQuery(query);
  try {
    pigServer.openIterator("C");
    Assert.fail("Error expected.");
  }
 catch (  Exception e) {
    e.getMessage().contains("Cannot determine");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMapUDF() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate (double)mymap#'double' as d, (long)mymap#'long' + (float)mymap#'float' as float_sum, CONCAT((chararray) mymap#'string', ' World!'), mymap#'int' * 10, (bag{tuple()}) mymap#'bag' as mybag, (tuple()) mymap#'tuple' as mytuple, (map[])mymap#'map' as mapInMap, mymap#'dba' as dba;" + "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(1.0,(Double)t.get(0),0.01);
    Assert.assertEquals(2.0,(Float)t.get(1),0.01);
    Assert.assertTrue(((String)t.get(2)).equals("Hello World!"));
    Assert.assertEquals(new Integer(10),(Integer)t.get(3));
    Assert.assertEquals(1,((DataBag)t.get(4)).size());
    Assert.assertEquals(4,((Tuple)t.get(5)).size());
    Assert.assertEquals(2,((Map<String,Object>)t.get(6)).size());
    Assert.assertEquals(DataByteArray.class,t.get(7).getClass());
    Assert.assertEquals(8,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT * LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanWithExpressionAssignment() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = " + Identity.class.getName() + "(*);"+ "C5 = COUNT(C2);"+ "C6 = SUM(C2.$1);"+ "C7 = "+ TitleNGrams.class.getName()+ "(C3);"+ "C8 = MAX(C3.$1);"+ "generate (int)group, C4, C5, C6, C7, C8, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=Util.createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=Util.createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigContext) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigContext) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlan() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "generate (int)group," + Identity.class.getName() + "(*), COUNT(C2), SUM(C2.$1),"+ TitleNGrams.class.getName()+ "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMergeSchemaErrorMessage() throws IOException {
  try {
    pigServer.registerQuery("a = load '1.txt' as (a0, a1, a2);");
    pigServer.registerQuery("b = group a by (a0, a1);");
    pigServer.registerQuery("c = foreach b generate flatten(group) as c0;");
    pigServer.openIterator("c");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Util.checkStrContainsSubStr(pe.getMessage(),"Incompatible schema");
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBinStorageByteCast() throws Exception {
  String[] input1={"1\t2\t3"};
  Util.createInputFile(cluster,"table_testBinStorageByteCast",input1);
  pigServer.registerQuery("a = load 'table_testBinStorageByteCast' as (a0, a1, a2);");
  pigServer.store("a","table_testBinStorageByteCast.temp",BinStorage.class.getName());
  pigServer.registerQuery("a = load 'table_testBinStorageByteCast.temp' using BinStorage() as (a0, a1, a2);");
  pigServer.registerQuery("b = foreach a generate (long)a0;");
  try {
    pigServer.openIterator("b");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSortDesc() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num desc parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MAX_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum <= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingTwoBag(){
  try {
    pigServer.registerQuery("a = load '1.txt' as (name:chararray, age:int, gpa:double);");
    pigServer.registerQuery("b = group a by name;");
    pigServer.registerQuery("c = foreach b generate group, SUM(a.age*a.gpa);");
    pigServer.openIterator("c");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getErrorCode() == 1039);
    Assert.assertTrue(pe.getMessage().contains("incompatible types"));
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSort() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MIN_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum >= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonStandardDataWithoutFetch() throws Exception {
  Properties props=pigServer.getPigContext().getProperties();
  props.setProperty(PigConfiguration.PIG_OPT_FETCH,"false");
  String[] input1={"0"};
  try {
    Util.createInputFile(cluster,"table_testNonStandardDataWithoutFetch",input1);
    pigServer.registerQuery("a = load 'table_testNonStandardDataWithoutFetch' as (a0);");
    pigServer.registerQuery("b = foreach a generate " + UDFWithNonStandardType.class.getName() + "(a0);");
    try {
      pigServer.openIterator("b");
      Assert.fail();
    }
 catch (    Exception e) {
      Assert.assertTrue(e.getMessage().contains(ArrayList.class.getName()));
    }
  }
  finally {
    props.setProperty(PigConfiguration.PIG_OPT_FETCH,"true");
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonStandardData() throws Exception {
  String[] input1={"0"};
  Util.createInputFile(cluster,"table_testNonStandardData",input1);
  pigServer.registerQuery("a = load 'table_testNonStandardData' as (a0);");
  pigServer.registerQuery("b = foreach a generate " + UDFWithNonStandardType.class.getName() + "(a0);");
  try {
    pigServer.openIterator("b");
    Assert.fail();
  }
 catch (  Exception e) {
    Throwable cause=e.getCause().getCause() == null ? e.getCause() : e.getCause().getCause();
    String message=cause.getMessage();
    Assert.assertTrue(message.contains(ArrayList.class.getName()));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFwithStarInput() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "generate " + Identity.class.getName() + "(*);"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    Tuple t=(Tuple)tuple.get(0);
    Assert.assertEquals(DataByteArray.class,t.get(0).getClass());
    int group=Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
    Assert.assertEquals(numIdentity,group);
    Assert.assertTrue(t.get(1) instanceof DataBag);
    DataBag bag=(DataBag)t.get(1);
    Assert.assertEquals(10,bag.size());
    Assert.assertEquals(2,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigServer.getPigContext()) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin2 </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTooBigReplicatedFile() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_DIR + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("C = group B all parallel 5;");
  pigServer.registerQuery("C = foreach C generate MAX(B.x) as x;");
  pigServer.registerQuery("D = join A by x, B by x, C by x using 'repl';");
{
    try {
      pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_JOIN_REPLICATED_MAX_BYTES,String.valueOf(16));
      pigServer.openIterator("D");
      Assert.fail();
    }
 catch (    FrontendException e) {
      assertEquals("Internal error. Distributed cache could" + " not be set up for the replicated files",e.getCause().getCause().getCause().getMessage());
    }
    pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_JOIN_REPLICATED_MAX_BYTES,String.valueOf(17));
    pigServer.openIterator("D");
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSoftLinkDoesNotCreateUnnecessaryConcatJob() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A all;"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = group C by x;"+ "E = group D all;"+ "F = FOREACH E generate B.$0;"+ "Z = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "Y = FOREACH E generate F.$0;"+ "STORE Y into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      fail("Somehow concatjob was created even though there is no large or multiple inputs.");
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSoftLinkDependencyWithMultipleScalarReferences() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A by x parallel "+ FILE_MERGE_THRESHOLD+ ";"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = FOREACH C generate B.$0;"+ "STORE D into '/tmp/output1';"+ "E = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "F = FOREACH E generate B.$0;"+ "STORE F into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  assertEquals("Unexpected number of mapreduce job. Missing concat job?",4,mrplan.size());
  MapReduceOper concatMRop=null;
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      concatMRop=mrOp;
      break;
    }
  }
  if (concatMRop == null) {
    fail("Cannot find concat job.");
  }
  assertEquals("Missing dependency for concatjob",2,mrplan.getSuccessors(concatMRop).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlan </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInnerOrderByAliasReuse() throws IOException, ParserException {
  String INPUT_FILE="test-innerorderbyaliasreuse.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("1\t4");
  w.println("1\t3");
  w.println("2\t3");
  w.println("2\t4");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("A = load '" + INPUT_FILE + "' as (v1:int, v2:int);");
    pig.registerQuery("B = group A by v1;");
    pig.registerQuery("C = foreach B { X = A; X = order X by v2 asc; " + "generate flatten(X); };");
    Iterator<Tuple> iter=pig.openIterator("C");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,3)","(1,4)","(2,3)","(2,4)"});
    Util.checkQueryOutputsAfterSort(iter,expectedResults);
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlgebricFuncWithoutGroupBy() throws IOException, ParserException {
  String INPUT_FILE="test-sum.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\t{(1),(2),(3)}");
  w.println("20\t{(4),(5),(6),(7)}");
  w.println("30\t{(8),(9)}");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("a = load '" + INPUT_FILE + "' "+ "as (id:int, g:bag{t:tuple(u:int)});");
    pig.registerQuery("b = foreach a generate id, SUM(g);");
    Iterator<Tuple> iter=pig.openIterator("b");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,6L)","(20,22L)","(30,17L)"});
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
    }
    assertEquals(expectedResults.size(),counter);
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInnerDistinct() throws IOException, ParserException {
  String INPUT_FILE="test-distinct.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\t89");
  w.println("20\t78");
  w.println("10\t68");
  w.println("10\t89");
  w.println("20\t92");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("A = load '" + INPUT_FILE + "' as (age:int, gpa:int);");
    pig.registerQuery("B = group A by age;");
    pig.registerQuery("C = foreach B { D = A.gpa; E = distinct D; " + "generate group, MIN(E); };");
    Iterator<Tuple> iter=pig.openIterator("C");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,68)","(20,78)"});
    Util.checkQueryOutputsAfterSort(iter,expectedResults);
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColInAlias() throws Exception {
  pig.getPigContext().getProperties().setProperty("pig.exec.nosecondarykey","true");
  String INPUT_FILE="test-multi-alias.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\tnrai01\t01");
  w.println("20\tnrai02\t02");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("A = load '" + INPUT_FILE + "' "+ "as (a:int, b:chararray, c:int);");
    pig.registerQuery("B = GROUP A BY (a, b);");
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
      pig.registerQuery("C = FOREACH B { bg = A.($1,$2); GENERATE group, bg; } ;");
      Iterator<Tuple> iter1=pig.openIterator("C");
      while (iter1.hasNext()) {
        dbfrj.add(iter1.next());
      }
    }
{
      pig.registerQuery("D = FOREACH B { GENERATE group, A.($1,$2);};");
      Iterator<Tuple> iter2=pig.openIterator("D");
      while (iter2.hasNext()) {
        dbshj.add(iter2.next());
      }
    }
    Assert.assertEquals(dbfrj.size(),dbshj.size());
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGrunt </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagSchemaFail() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'as (b: bag{t:(i: int, c:chararray, f: float)});\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  try {
    grunt.exec();
    fail("Test case is supposed to fail.");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("<line 1, column 62>  mismatched input ';' expecting RIGHT_PAREN"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorLineNumber() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="A = load 'x' as ( u:int, v:chararray );\n" + "sh ls\n" + "B = foreach A generate u , v; C = distinct 'xxx';\n"+ "store C into 'y';";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  try {
    grunt.exec();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("<line 3, column 42>  Syntax error, unexpected symbol at or near ''xxx''"));
    return;
  }
  fail("Test case is supposed to fail.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand(){
  try {
    PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
    PigContext context=server.getPigContext();
    String strRemoveFile="rm";
    String strRemoveDir="rmdir";
    if (Util.WINDOWS) {
      strRemoveFile="del";
      strRemoveDir="rd";
    }
    String strCmd="sh mkdir test_shell_tmp;";
    ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
    InputStreamReader reader=new InputStreamReader(cmd);
    Grunt grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertTrue(new File("test_shell_tmp").exists());
    strCmd="sh " + strRemoveDir + " test_shell_tmp;";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("test_shell_tmp").exists());
    strCmd="sh echo hello world > tempShFileToTestShCommand";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    BufferedReader fileReader=null;
    fileReader=new BufferedReader(new FileReader("tempShFileToTestShCommand"));
    assertTrue(fileReader.readLine().trim().equals("hello world"));
    fileReader.close();
    strCmd="sh " + strRemoveFile + " tempShFileToTestShCommand";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("tempShFileToTestShCommand").exists());
    if (Util.WINDOWS) {
      strCmd="sh echo foo > TouchedFileInsideGrunt_61 && dir /B | findstr TouchedFileInsideGrunt_61 > fileContainingTouchedFileInsideGruntShell_71";
    }
 else {
      strCmd="sh touch TouchedFileInsideGrunt_61 && ls | grep TouchedFileInsideGrunt_61 > fileContainingTouchedFileInsideGruntShell_71";
    }
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    fileReader=new BufferedReader(new FileReader("fileContainingTouchedFileInsideGruntShell_71"));
    assertTrue(fileReader.readLine().trim().equals("TouchedFileInsideGrunt_61"));
    fileReader.close();
    strCmd="sh " + strRemoveFile + " fileContainingTouchedFileInsideGruntShell_71";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("fileContainingTouchedFileInsideGruntShell_71").exists());
    strCmd="sh " + strRemoveFile + " TouchedFileInsideGrunt_61";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("TouchedFileInsideGrunt_61").exists());
  }
 catch (  ExecException e) {
    e.printStackTrace();
    fail();
  }
catch (  Throwable e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestIn </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that IN operator throws FrontendException when no operand is given.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingRhsOperand() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FILTER A BY i IN ();");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown since no rhs operand is given to IN.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputMiniClusterFileValidator </h4><pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test that Input output file validation catches the case
 * where the output file exists when using{@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test(expected=PigException.class) public void testPigServerStoreNeg() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    Util.createInputFile(pig.getPigContext(),output,data);
    try {
      pig.registerQuery("a = load '" + input + "';");
      pig.store("a",output);
      fail("Expected exception to be caught");
    }
 catch (    Exception e) {
      assertEquals(6000,LogUtils.getPigException(e).getErrorCode());
      throw e;
    }
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMapReduceModeInputNegative2() throws Throwable {
  String inputfile=createHadoopTempFile(ctx);
  String outputfile=createHadoopTempFile(ctx);
  LogicalPlan plan=genNewLoadStorePlan(inputfile,outputfile,ctx.getDfs());
  InputOutputFileValidatorVisitor executor=new InputOutputFileValidatorVisitor(plan,ctx);
  try {
    executor.visit();
    fail("Excepted to fail.");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInstantiateFunc </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstantiate5() throws Throwable {
  try {
    PigContext.instantiateFuncFromSpec(TEST_CLASS2 + "('a','b','c')");
    fail("expect error here");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstantiate4() throws Throwable {
  try {
    PigContext.instantiateFuncFromSpec(TEST_CLASS2);
    fail("expect error here");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocalRearrange </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig1194(){
  String INPUT_FILE="data.txt";
  try {
    PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
    w.println("10\t2\t3");
    w.println("10\t4\t5");
    w.println("20\t3000\t2");
    w.println("20\t4000\t3");
    w.println("20\t3\t");
    w.println("21\t4\t");
    w.println("22\t5\t");
    w.close();
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    Util.resetStateForExecModeSwitch();
    PigServer myPig=new PigServer(cluster.getExecType(),cluster.getProperties());
    myPig.registerQuery("data = load '" + INPUT_FILE + "' as (a0, a1, a2);");
    myPig.registerQuery("grp = GROUP data BY (((double) a2)/((double) a1) > .001 OR a0 < 11 ? a0 : 0);");
    myPig.registerQuery("res = FOREACH grp GENERATE group, SUM(data.a1), SUM(data.a2);");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(0,7000.0,5.0)","(10,6.0,8.0)","(null,12.0,null)"});
    Iterator<Tuple> iter=myPig.openIterator("res");
    Util.checkQueryOutputsAfterSort(iter,expectedResults);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
 finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogToPhyCompiler </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplit() throws Exception {
  String query="split (load 'a') into x if $0 < '7', y if $0 > '7';" + "store x into 'output';";
  String goldenFile="test/org/apache/pig/test/data/GoldenFiles/Split1.gld";
  String compiledPlan=compilePlan(query,goldenFile,false);
  FileInputStream fis1=new FileInputStream(goldenFile);
  FileInputStream fis2=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/Split2.gld");
  byte[] b1=new byte[MAX_SIZE];
  byte[] b2=new byte[MAX_SIZE];
  int len=fis1.read(b1);
  int test=fis2.read(b2);
  String goldenPlan1=new String(b1,0,len);
  String goldenPlan2=new String(b2,0,len);
  goldenPlan1=Util.standardizeNewline(goldenPlan1);
  goldenPlan1=removedUnaffectingChanges(goldenPlan1);
  goldenPlan2=Util.standardizeNewline(goldenPlan2);
  goldenPlan2=removedUnaffectingChanges(goldenPlan2);
  System.out.println();
  System.out.println(compiledPlan);
  System.out.println("-------------testSplit");
  if (compiledPlan.compareTo(goldenPlan1) == 0 || compiledPlan.compareTo(goldenPlan2) == 0) {
  }
 else {
    System.out.println("Expected plan1=");
    System.out.println(goldenPlan1);
    System.out.println("Expected plan2=");
    System.out.println(goldenPlan1);
    System.out.println("Actual plan=");
    System.out.println(compiledPlan);
    System.out.println("**END**");
    fail("Plan not match");
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIsNull() throws Exception {
  String query="split (load 'a') into x if $0 IS NULL, y if $0 IS NOT NULL;" + "store x into 'output';";
  LogicalPlan plan=buildPlan(query);
  PhysicalPlan pp=buildPhysicalPlan(plan);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  pp.explain(baos);
  baos.write((int)'\n');
  String compiledPlan=baos.toString();
  compiledPlan=removedUnaffectingChanges(compiledPlan);
  if (generate) {
    FileOutputStream fos=new FileOutputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld");
    fos.write(baos.toByteArray());
  }
  FileInputStream fis1=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull1.gld");
  FileInputStream fis2=new FileInputStream("test/org/apache/pig/test/data/GoldenFiles/IsNull2.gld");
  byte[] b1=new byte[MAX_SIZE];
  byte[] b2=new byte[MAX_SIZE];
  int len=fis1.read(b1);
  int test=fis2.read(b2);
  String goldenPlan1=new String(b1,0,len);
  String goldenPlan2=new String(b2,0,len);
  goldenPlan1=Util.standardizeNewline(goldenPlan1);
  goldenPlan1=removedUnaffectingChanges(goldenPlan1);
  goldenPlan2=Util.standardizeNewline(goldenPlan2);
  goldenPlan2=removedUnaffectingChanges(goldenPlan2);
  System.out.println();
  System.out.println(compiledPlan);
  System.out.println("-------------testIsNull");
  if (compiledPlan.compareTo(goldenPlan1) == 0 || compiledPlan.compareTo(goldenPlan2) == 0) {
  }
 else {
    System.out.println("Expected plan1=");
    System.out.println(goldenPlan1);
    System.out.println("Expected plan2=");
    System.out.println(goldenPlan1);
    System.out.println("Actual plan=");
    System.out.println(compiledPlan);
    System.out.println("**END**");
    fail("Plan not match");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogicalPlanBuilder </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail64() throws Exception {
  String query="foreach (load 'myfile' as (col1, col2 : bag{age: int})) generate col1 ;";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("query should fail");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that parallel is parsed correctly Bug 831714 - fixed
 */
@Test public void testQuery18() throws Exception {
  String query="store (FOREACH (group (load 'a') ALL PARALLEL 16) generate group ) into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator root=lp.getSources().get(0);
  List<Operator> listOp=lp.getSuccessors(root);
  Operator lo=listOp.get(0);
  if (lo instanceof LOCogroup) {
    Assert.assertEquals(16,((LOCogroup)lo).getRequestedParallelism());
  }
 else {
    Assert.fail("Error: Unexpected Parse Tree output");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail81() throws Exception {
  String q="a = load 'input1' using PigStorage() as (name, age, gpa);";
  try {
    buildPlan(q + "split a into b if name lt 'f', c if (name ge 'f' and name le 'h'), d if name gt 'h';");
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuery110Fail() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = load 'two';" + "c = cogroup a by $0, b by *;";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("Cogroup/Group by '*' or 'x..' (range of columns to the end) is only allowed " + "if the input has a schema"));
    return;
  }
  Assert.fail("Test case should fail.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail43() throws Exception {
  String q="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);";
  try {
    String query=q + "c = cogroup a by (name, age), b by (height);";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail1() throws Exception {
  String query=" foreach (group (A = load 'a') by $1) generate A.'1' ;";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail3() throws Exception {
  String query="A = generate DISTINCT foreach (load 'a');";
  try {
    LogicalPlan lp=buildPlan(query);
    System.out.println(lp.toString());
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail41() throws Exception {
  try {
    buildPlan("a = load 'a';" + "b = a as (host,url);");
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail68() throws Exception {
  String q=" a = load 'input1' as (name, age, gpa);";
  try {
    buildPlan(q + " b = foreach a generate {(16 L, 4.0e-2, 'hello'), (0.5f, 'another tuple', 12L, {()})};");
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("query should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail37() throws Exception {
  String query="A = load 'a'; asdasdas";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail2() throws Exception {
  String query="foreach group (load 'a') by $1 generate $1.* ;";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail4() throws Exception {
  String query="A = generate [ORDER BY $0][$3, $4] foreach (load 'a');";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail67() throws Exception {
  String q=" a = load 'input1' as (name, age, gpa);" + " b = foreach a generate age, age * 10L, gpa/0.2f, {16, 4.0e-2, 'hello'};";
  try {
    buildPlan(q);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("query should fail");
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testQueryFail5() throws Exception {
  String query="A = generate " + TestApplyFunc.class.getName() + "($2.*) foreach (load 'a');";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingSemicolon() throws Exception {
  try {
    String query="A = load '1.txt' \n" + "B = load '2.txt' as (b0:int, b1:int);\n" + "C = union A, B;\n"+ "store C into 'output';";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("mismatched input 'B' expecting SEMI_COLON"));
    return;
  }
  Assert.fail("An exception was expected but did not occur");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapSideCogroup </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "D = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = cogroup A by id, B by id, D by id using 'merge';"+ "store C into 'output';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    Operator op=lp.getSinks().get(0);
    LOCogroup cogrp=(LOCogroup)lp.getPredecessors(op).get(0);
    assertEquals(LOCogroup.GROUPTYPE.MERGE,cogrp.getGroupType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoin </h4><pre class="type-7 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoinFailure2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
  pigServer.registerQuery("C = GROUP B by id;");
  pigServer.registerQuery("D = join A by id, C by $0 using 'merge';");
  try {
    pigServer.openIterator("D");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1103,pe.getErrorCode());
    return;
  }
  Assert.fail("Should fail to compile");
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin3Way() throws IOException {
  try {
    pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
    pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("D = join A by id, B by id, C by id using 'merge';");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getMessage().contains("Merge join can only be applied for 2-way joins"));
    return;
  }
  Assert.fail("Should throw exception, do not support 3 way join");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoinOuter </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = join A by id left, B by id using 'merge';"+ "store C into 'out';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    LOStore store=(LOStore)lp.getSinks().get(0);
    LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
    assertEquals(LOJoin.JOINTYPE.MERGE,join.getJoinType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POForEach);
    assertEquals(1,phyOp.getInputs().size());
    assertTrue(phyOp.getInputs().get(0) instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryCompiler </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig983(){
  System.out.println("===== multi-query Jira Pig-983 =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5;");
    myPig.registerQuery("d = join b by uname, c by uname;");
    myPig.registerQuery("e = group d by b::gid;");
    myPig.registerQuery("e1 = foreach e generate group, COUNT(d.b::uid);");
    myPig.registerQuery("store e1 into '/tmp/output1';");
    myPig.registerQuery("f = group d by c::gid;");
    myPig.registerQuery("f1 = foreach f generate group, SUM(d.c::uid);");
    myPig.registerQuery("store f1 into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,16);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,25);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithIntermediateStores(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("store a into '/tmp/output1';");
    myPig.registerQuery("b = load '/tmp/output1' using PigStorage(':'); ");
    myPig.registerQuery("store b into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,1,4);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,5);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSplitInReduce(){
  System.out.println("===== multi-query with split in reduce =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("d = foreach c generate group, COUNT(b.uid);");
    myPig.registerQuery("store d into '/tmp/output1';");
    myPig.registerQuery("e = filter d by $1 > 5;");
    myPig.registerQuery("store e into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,10);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,13);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryPhase3WithoutCombiner(){
  System.out.println("===== multi-query phase 3 without combiner =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
    myPig.registerQuery("d = filter a by uid >= 10;");
    myPig.registerQuery("b1 = group b by gid;");
    myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid) + SUM(b.uid);");
    myPig.registerQuery("b3 = filter b2 by $1 > 5;");
    myPig.registerQuery("store b3 into '/tmp/output1';");
    myPig.registerQuery("c1 = group c by gid;");
    myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid) - COUNT(c.uid);");
    myPig.registerQuery("store c2 into '/tmp/output2';");
    myPig.registerQuery("d1 = group d by gid;");
    myPig.registerQuery("d2 = foreach d1 generate group, MAX(d.uid) - MIN(d.uid);");
    myPig.registerQuery("store d2 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,25);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithDescribe(){
  System.out.println("===== multi-query with describe =====");
  try {
    String script="a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "describe b;"+ "store b into '/tmp/output1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryWithCustomPartitioner(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("l = FILTER a BY uname == 'foo';");
    myPig.registerQuery("b = GROUP a BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c = FOREACH b GENERATE FLATTEN(a) PARALLEL 3;");
    myPig.registerQuery("STORE c INTO 'output1';");
    myPig.registerQuery("STORE l INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,12);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig920(){
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by gid >= 5;");
    myPig.registerQuery("d = cogroup c by $0, b by $0;");
    myPig.registerQuery("e = foreach d generate group, COUNT(c), COUNT(b);");
    myPig.registerQuery("store e into '/tmp/output1';");
    LogicalPlan lp=checkLogicalPlan(1,1,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,13);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithFJ(){
  System.out.println("===== multi-query with FJ =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("c = filter a by uid > 5;");
    myPig.registerQuery("store c into '/tmp/output1';");
    myPig.registerQuery("d = filter b by gid > 10;");
    myPig.registerQuery("store d into '/tmp/output2';");
    myPig.registerQuery("e = join c by gid, d by gid using 'repl';");
    myPig.registerQuery("store e into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(2,3,14);
    PhysicalPlan pp=checkPhysicalPlan(lp,2,3,16);
    checkMRPlan(pp,2,1,3);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSplitInReduceAndReduceSplitees(){
  System.out.println("===== multi-query with split in reduce and reduce splitees =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("d = foreach c generate group, COUNT(b.uid);");
    myPig.registerQuery("e = filter d by $1 > 5;");
    myPig.registerQuery("e1 = group e by $1;");
    myPig.registerQuery("e2 = foreach e1 generate group, SUM(e.$0);");
    myPig.registerQuery("store e2 into '/tmp/output1';");
    myPig.registerQuery("f = filter d by $1 < 5;");
    myPig.registerQuery("f1 = group f by $1;");
    myPig.registerQuery("f2 = foreach f1 generate group, COUNT(f.$0);");
    myPig.registerQuery("store f2 into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,15);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,22);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryPhase3StreamingInReducer(){
  System.out.println("===== multi-query phase 3 with streaming in reducer =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("A = load 'passwd';");
    myPig.registerQuery("Split A into A1 if $2 > 5, A2 if $2 >= 5;");
    myPig.registerQuery("Split A1 into A3 if $0 > 'm', A4 if $0 >= 'm';");
    myPig.registerQuery("B = group A3 by $2;");
    myPig.registerQuery("C = foreach B generate flatten(A3);");
    myPig.registerQuery("D = stream B through `cat`;");
    myPig.registerQuery("store D into '/tmp/output1';");
    myPig.registerQuery("E = group A4 by $2;");
    myPig.registerQuery("F = foreach E generate group, COUNT(A4);");
    myPig.registerQuery("store F into '/tmp/output2';");
    myPig.registerQuery("G = group A1 by $2;");
    myPig.registerQuery("H = foreach G generate group, COUNT(A1);");
    myPig.registerQuery("store H into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,24);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithDemoCase(){
  System.out.println("===== multi-query with demo case 2 =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = foreach a generate uname, uid, gid;");
    myPig.registerQuery("c = filter b by uid < 5;");
    myPig.registerQuery("d = filter c by gid >= 5;");
    myPig.registerQuery("store d into '/tmp/output1';");
    myPig.registerQuery("e = filter b by uid >= 5;");
    myPig.registerQuery("store e into '/tmp/output2';");
    myPig.registerQuery("f = filter c by gid < 5;");
    myPig.registerQuery("g = group f by uname;");
    myPig.registerQuery("h = foreach g generate group, COUNT(f.uid);");
    myPig.registerQuery("store h into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,17);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,19);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithExplicitSplitAndOrderByAndSideFiles(){
  System.out.println("===== multi-query with explicit split, orderby and side files  =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("split a into a1 if uid > 500, a2 if gid > 500;");
    myPig.registerQuery("b1 = distinct a1;");
    myPig.registerQuery("b2 = order a2 by uname;");
    myPig.registerQuery("store b1 into '/tmp/output1';");
    myPig.registerQuery("store b2 into '/tmp/output2';");
    myPig.registerQuery("c = cogroup b1 by uname, b2 by uname;");
    myPig.registerQuery("d = foreach c generate flatten(group), flatten($1), flatten($2);");
    myPig.registerQuery("store d into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,17);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,21);
    checkMRPlan(pp,1,1,4);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryDoNotMergeMRwithDifferentPartitioners(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b1 = FILTER a BY gid != 0;");
    myPig.registerQuery("b2 = FILTER a BY uid > 100;");
    myPig.registerQuery("c1 = GROUP b1 BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c2 = GROUP b2 BY uname PARALLEL 3;");
    myPig.registerQuery("STORE c1 INTO 'output1';");
    myPig.registerQuery("STORE c2 INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,10);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,15);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop;
    mrop=mrp.getRoots().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner() == null);
    mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemovalCollapseSplit(){
  System.out.println("===== multi-query unnecessary stores collapse split =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,1,6);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,11);
    MROperPlan mp=checkMRPlan(pp,1,1,2);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithTwoLoads(){
  System.out.println("===== multi-query with two loads =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = load 'passwd2' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("c = filter a by uid > 5;");
    myPig.registerQuery("d = filter b by uid > 10;");
    myPig.registerQuery("store c into '/tmp/output1';");
    myPig.registerQuery("store d into '/tmp/output2';");
    myPig.registerQuery("e = cogroup c by uid, d by uid;");
    myPig.registerQuery("store e into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(2,3,14);
    PhysicalPlan pp=checkPhysicalPlan(lp,2,3,19);
    checkMRPlan(pp,2,1,3);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoadStoreLoop(){
  try {
    String script="a = load 'dummy'; b = filter a by $0 == 1; store b into 'dummy';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    myPig.getPigContext().inExplain=true;
    parser.parseStopOnError();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithTwoStores(){
  System.out.println("===== multi-query with 2 stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("store c into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,8);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,11);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithIllustrate(){
  System.out.println("===== multi-query with illustrate =====");
  try {
    String script="a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "illustrate b;"+ "store b into '/tmp/output1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryPhase3WithDifferentMapDataTypes(){
  System.out.println("===== multi-query phase 3 with different map datatypes =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
    myPig.registerQuery("d = filter a by uid >= 10;");
    myPig.registerQuery("b1 = group b by gid parallel 2;");
    myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
    myPig.registerQuery("b3 = filter b2 by $1 > 5;");
    myPig.registerQuery("store b3 into '/tmp/output1';");
    myPig.registerQuery("c1 = group c by $1 parallel 3;");
    myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
    myPig.registerQuery("store c2 into '/tmp/output2';");
    myPig.registerQuery("d1 = group d by $1 parallel 4;");
    myPig.registerQuery("d2 = foreach d1 generate group, COUNT(d.uid);");
    myPig.registerQuery("store d2 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,25);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithPigMixL12(){
  System.out.println("===== multi-query with PigMix L12 =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname, passwd, uid, gid);");
    myPig.registerQuery("b = foreach a generate uname, passwd, uid, gid;");
    myPig.registerQuery("split b into c1 if uid > 5, c2 if uid <= 5 ;");
    myPig.registerQuery("split c1 into d1 if gid < 5, d2 if gid >= 5;");
    myPig.registerQuery("e = group d1 by uname;");
    myPig.registerQuery("e1 = foreach e generate group, MAX(d1.uid);");
    myPig.registerQuery("store e1 into '/tmp/output1';");
    myPig.registerQuery("f = group c2 by uname;");
    myPig.registerQuery("f1 = foreach f generate group, SUM(c2.gid);");
    myPig.registerQuery("store f1 into '/tmp/output2';");
    myPig.registerQuery("g = group d2 by uname;");
    myPig.registerQuery("g1 = foreach g generate group, COUNT(d2);");
    myPig.registerQuery("store g1 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,17);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,23);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSplitInReduceAndReduceSpliteesAndMore(){
  System.out.println("===== multi-query with split in reduce and reduce splitees and more =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid > 500;");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("d = foreach c generate group, COUNT(b.uid);");
    myPig.registerQuery("e = filter d by $1 > 5;");
    myPig.registerQuery("e1 = group e by $1;");
    myPig.registerQuery("e2 = foreach e1 generate group, SUM(e.$0);");
    myPig.registerQuery("e3 = filter e2 by $1 > 10;");
    myPig.registerQuery("e4 = group e3 by $1;");
    myPig.registerQuery("e5 = foreach e4 generate group, SUM(e3.$0);");
    myPig.registerQuery("store e5 into '/tmp/output1';");
    myPig.registerQuery("f = filter d by $1 < 5;");
    myPig.registerQuery("f1 = group f by $1;");
    myPig.registerQuery("f2 = foreach f1 generate group, COUNT(f.$0);");
    myPig.registerQuery("f3 = filter f2 by $1 < 100;");
    myPig.registerQuery("f4 = group f3 by $1;");
    myPig.registerQuery("f5 = foreach f4 generate group, COUNT(f3.$0);");
    myPig.registerQuery("store f5 into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,21);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,32);
    checkMRPlan(pp,1,2,4);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryPhase3BaseCase(){
  System.out.println("===== multi-query phase 3 base case =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
    myPig.registerQuery("d = filter a by uid >= 10;");
    myPig.registerQuery("b1 = group b by gid;");
    myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
    myPig.registerQuery("b3 = filter b2 by $1 > 5;");
    myPig.registerQuery("store b3 into '/tmp/output1';");
    myPig.registerQuery("c1 = group c by gid;");
    myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
    myPig.registerQuery("store c2 into '/tmp/output2';");
    myPig.registerQuery("d1 = group d by gid;");
    myPig.registerQuery("d2 = foreach d1 generate group, AVG(d.uid);");
    myPig.registerQuery("store d2 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,25);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig1060(){
  String INPUT_FILE="pig-1060.txt";
  try {
    PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
    w.println("apple\t2");
    w.println("apple\t12");
    w.println("orange\t3");
    w.println("orange\t23");
    w.println("strawberry\t10");
    w.println("strawberry\t34");
    w.close();
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    myPig.setBatchOn();
    myPig.registerQuery("data = load '" + INPUT_FILE + "' as (name:chararray, gid:int);");
    myPig.registerQuery("f1 = filter data by gid < 5;");
    myPig.registerQuery("g1 = group f1 by name;");
    myPig.registerQuery("p1 = foreach g1 generate group, COUNT(f1.gid);");
    myPig.registerQuery("store p1 into '/tmp/output1';");
    myPig.registerQuery("f2 = filter data by gid > 5;");
    myPig.registerQuery("g2 = group f2 by name;");
    myPig.registerQuery("p2 = foreach g2 generate group, COUNT(f2.gid);");
    myPig.registerQuery("store p2 into '/tmp/output2';");
    myPig.registerQuery("f3 = filter f2 by gid > 10;");
    myPig.registerQuery("g3 = group f3 by name;");
    myPig.registerQuery("p3 = foreach g3 generate group, COUNT(f3.gid);");
    myPig.registerQuery("store p3 into '/tmp/output3';");
    myPig.registerQuery("f4 = filter f3 by gid < 20;");
    myPig.registerQuery("g4 = group f4 by name;");
    myPig.registerQuery("p4 = foreach g4 generate group, COUNT(f4.gid);");
    myPig.registerQuery("store p4 into '/tmp/output4';");
    LogicalPlan lp=checkLogicalPlan(1,4,26);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,4,35);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
 finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEmptyExecute(){
  System.out.println("==== empty execute ====");
  try {
    myPig.setBatchOn();
    myPig.executeBatch();
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryPhase3WithMixedCombiner(){
  System.out.println("===== multi-query phase 3 with mixed combiner =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
    myPig.registerQuery("d = filter a by uid >= 10;");
    myPig.registerQuery("b1 = group b by gid;");
    myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
    myPig.registerQuery("b3 = filter b2 by $1 > 5;");
    myPig.registerQuery("store b3 into '/tmp/output1';");
    myPig.registerQuery("c1 = group c by gid;");
    myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
    myPig.registerQuery("store c2 into '/tmp/output2';");
    myPig.registerQuery("d1 = group d by gid;");
    myPig.registerQuery("d2 = foreach d1 generate group, d.uname, MAX(d.uid) - MIN(d.uid);");
    myPig.registerQuery("store d2 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,25);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithCoGroup(){
  System.out.println("===== multi-query with CoGroup =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname, passwd, uid, gid);");
    myPig.registerQuery("store a into '/tmp/output1' using BinStorage();");
    myPig.registerQuery("b = load '/tmp/output1' using BinStorage() as (uname, passwd, uid, gid);");
    myPig.registerQuery("c = load 'passwd2' " + "using PigStorage(':') as (uname, passwd, uid, gid);");
    myPig.registerQuery("d = cogroup b by (uname, uid) inner, c by (uname, uid) inner;");
    myPig.registerQuery("e = foreach d generate flatten(b), flatten(c);");
    myPig.registerQuery("store e into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(2,1,7);
    PhysicalPlan pp=checkPhysicalPlan(lp,2,1,11);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemoval(){
  System.out.println("===== multi-query unnecessary stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output3';");
    myPig.registerQuery("f = load '/tmp/output2';");
    myPig.registerQuery("g = group f by $0;");
    myPig.registerQuery("store g into '/tmp/output4';");
    LogicalPlan lp=checkLogicalPlan(1,2,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,20);
    MROperPlan mp=checkMRPlan(pp,1,2,3);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    MapReduceOper mo3=mp.getLeaves().get(1);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,2);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo3.mapPlan,1,1,2);
    checkPhysicalPlan(mo3.reducePlan,1,1,2);
    leaf=mo3.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSplitInReduceAndReduceSplitee(){
  System.out.println("===== multi-query with split in reduce and reduce splitee =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("d = foreach c generate group, COUNT(b.uid);");
    myPig.registerQuery("store d into '/tmp/output1';");
    myPig.registerQuery("e = filter d by $1 > 5;");
    myPig.registerQuery("f = group e by $1;");
    myPig.registerQuery("g = foreach f generate group, SUM(e.$0);");
    myPig.registerQuery("store g into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,12);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,17);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFilterRemoval(){
  System.out.println("===== multi-query empty filters =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid>0;");
    myPig.registerQuery("c = filter a by uid>5;");
    myPig.registerQuery("d = filter c by uid<10;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("store b into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,10);
    MROperPlan mp=checkMRPlan(pp,1,1,1);
    MapReduceOper mo=mp.getRoots().get(0);
    checkPhysicalPlan(mo.mapPlan,1,1,4);
    PhysicalOperator leaf=mo.mapPlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,3);
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig1438(){
  String INPUT_FILE="abc";
  try {
    myPig.setBatchOn();
    myPig.registerQuery("A = load '" + INPUT_FILE + "' as (col1:int, col2:int, col3:int);");
    myPig.registerQuery("B1 = foreach A generate col1, col2;");
    myPig.registerQuery("B2 = foreach A generate col2, col3;");
    myPig.registerQuery("C1 = distinct B1;");
    myPig.registerQuery("C2 = group B2 by (col2, col3);");
    myPig.registerQuery("D1 = foreach C1 generate col1, col2;");
    myPig.registerQuery("D2 = foreach C2 generate B2.col2, B2.col3;");
    myPig.registerQuery("store D1 into '/tmp/output1';");
    myPig.registerQuery("store D2 into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,12);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,15);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreOrder(){
  System.out.println("===== multi-query store order =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd';");
    myPig.registerQuery("store a into '/tmp/output1' using BinStorage();");
    myPig.registerQuery("a = load '/tmp/output1';");
    myPig.registerQuery("store a into '/tmp/output2';");
    myPig.registerQuery("a = load '/tmp/output1';");
    myPig.registerQuery("store a into '/tmp/output3';");
    myPig.registerQuery("a = load '/tmp/output2' using BinStorage();");
    myPig.registerQuery("store a into '/tmp/output4';");
    myPig.registerQuery("a = load '/tmp/output2';");
    myPig.registerQuery("b = load '/tmp/output1';");
    myPig.registerQuery("c = cogroup a by $0, b by $0;");
    myPig.registerQuery("store c into '/tmp/output5';");
    LogicalPlan lp=checkLogicalPlan(1,3,12);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,15);
    MROperPlan mp=checkMRPlan(pp,1,3,5);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output5"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSingleMapReduceSplittee(){
  System.out.println("===== multi-query with single map reduce splittee =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname, passwd, uid, gid);");
    myPig.registerQuery("b = foreach a generate uname, uid, gid;");
    myPig.registerQuery("split b into c1 if uid > 5, c2 if uid <= 5 ;");
    myPig.registerQuery("f = group c2 by uname;");
    myPig.registerQuery("f1 = foreach f generate group, SUM(c2.gid);");
    myPig.registerQuery("store f1 into '/tmp/output1';");
    LogicalPlan lp=checkLogicalPlan(1,1,7);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,9);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithDump(){
  System.out.println("===== multi-query with dump =====");
  try {
    String script="a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "dump b;"+ "store b into '/tmp/output1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithImplicitSplitAndSideFiles(){
  System.out.println("===== multi-query with implicit split and side files  =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid > 500;");
    myPig.registerQuery("c = filter a by gid > 500;");
    myPig.registerQuery("store c into '/tmp/output1';");
    myPig.registerQuery("d = cogroup b by uname, c by uname;");
    myPig.registerQuery("e = foreach d generate flatten(c), flatten(b);");
    myPig.registerQuery("store e into '/tmp/output2';");
    myPig.registerQuery("f = filter e by b::uid < 1000;");
    myPig.registerQuery("store f into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,22);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithThreeStores(){
  System.out.println("===== multi-query with 3 stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = filter b by uid > 10;");
    myPig.registerQuery("store c into '/tmp/output2';");
    myPig.registerQuery("d = filter c by uid > 15;");
    myPig.registerQuery("store d into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,14);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryJiraPig920_1(){
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by gid >= 5;");
    myPig.registerQuery("d = filter a by uid >= 5;");
    myPig.registerQuery("e = filter a by gid < 5;");
    myPig.registerQuery("f = cogroup c by $0, b by $0;");
    myPig.registerQuery("f1 = foreach f generate group, COUNT(c), COUNT(b);");
    myPig.registerQuery("store f1 into '/tmp/output1';");
    myPig.registerQuery("g = cogroup d by $0, e by $0;");
    myPig.registerQuery("g1 = foreach g generate group, COUNT(d), COUNT(e);");
    myPig.registerQuery("store g1 into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,16);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,23);
    checkMRPlan(pp,2,2,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithSplitInMapAndReduceSplitees(){
  System.out.println("===== multi-query with split in map and reduce splitees =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b = filter a by uid < 5;");
    myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
    myPig.registerQuery("d = filter a by uid >= 10;");
    myPig.registerQuery("b1 = group b by gid;");
    myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
    myPig.registerQuery("b3 = filter b2 by $1 > 5;");
    myPig.registerQuery("store b3 into '/tmp/output1';");
    myPig.registerQuery("c1 = group c by $1;");
    myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
    myPig.registerQuery("store c2 into '/tmp/output2';");
    myPig.registerQuery("d1 = group d by $1;");
    myPig.registerQuery("d2 = foreach d1 generate group, COUNT(d.uid);");
    myPig.registerQuery("store d2 into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,18);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,25);
    checkMRPlan(pp,1,1,1);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithTwoLoadsAndTwoStores(){
  System.out.println("===== multi-query with two loads and two stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = load 'passwd2' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("c = filter a by uid > 5;");
    myPig.registerQuery("d = filter b by uid > 10;");
    myPig.registerQuery("e = cogroup c by uid, d by uid;");
    myPig.registerQuery("f = foreach e generate flatten(c), flatten(d);");
    myPig.registerQuery("g = group f by d::gid;");
    myPig.registerQuery("h = filter f by c::gid > 5;");
    myPig.registerQuery("store g into '/tmp/output1';");
    myPig.registerQuery("store h into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(2,2,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,2,2,20);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithExplain(){
  System.out.println("===== multi-query with explain =====");
  try {
    String script="a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "explain b;"+ "store b into '/tmp/output1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithExplicitSplitAndSideFiles(){
  System.out.println("===== multi-query with explicit split and side files =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("split a into b if uid > 500, c if uid <= 500;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store c into '/tmp/output2';");
    myPig.registerQuery("e = cogroup b by gid, c by gid;");
    myPig.registerQuery("d = foreach e generate flatten(c), flatten(b);");
    myPig.registerQuery("store d into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,15);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,19);
    checkMRPlan(pp,1,1,2);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiQueryWithNoStore2(){
  System.out.println("===== multi-query with no store (2) =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("group b by gid;");
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPruneSubTreeForEach() throws Exception {
  String query="a =load 'd.txt' as (id, v1);" + "b = group a by id;" + "c = foreach b { d = a.v1; "+ " e = distinct d; "+ " generate group, e; };"+ "f = foreach c generate group ;"+ "store f into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  try {
    optimizer.optimize();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Unexpected Exception: " + e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReverseDependencyOrderWalkerTree() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(jane,jill);
  SillyVisitor v=new SillyVisitor(plan,new ReverseDependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("jilljanebobjoefred") && !s.equals("jilljanebobfredjoe") && !s.equals("jillbobjoefredjane")&& !s.equals("jillbobjoejanefred")&& !s.equals("jillbobfredjoejane")&& !s.equals("jillbobfredjanejoe")&& !s.equals("jillbobjanejoefred")&& !s.equals("jillbobjanefredjoe")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDependencyOrderWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new DependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredjoebobjanejill") && !s.equals("joefredbobjanejill") && !s.equals("fredjoebobjilljane")&& !s.equals("joefredbobjilljane")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDepthFirstWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new DepthFirstWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredbobjilljanejoe") && !s.equals("joebobjilljanefred")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReverseDependencyOrderWalkerGraph() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(bob,jane);
  SillyVisitor v=new SillyVisitor(plan,new ReverseDependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("jilljanebobjoefred") && !s.equals("jilljanebobfredjoe") && !s.equals("janejillbobjoefred")&& !s.equals("janejillbobfredjoe")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDependencyOrderWalkerTree() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jill);
  plan.connect(jane,jill);
  SillyVisitor v=new SillyVisitor(plan,new DependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  if (!s.equals("fredjoebobjanejill") && !s.equals("joefredbobjanejill") && !s.equals("janefredjoebobjill")&& !s.equals("janejoefredbobjill")) {
    System.out.println("Invalid order " + s);
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscaping() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputEscape.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult2.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUndefinedParam() throws Exception {
  log.info("Starting test testUndefinedParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
    fail("Should have thrown an Undefined parameter exception");
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Undefined parameter : param");
  }
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMacroDef() throws Exception {
  log.info("Starting test testMacroDef() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input6.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult6.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileComboDuplicate() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFileDuplicates.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdnameAsParamDeclare() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputCmdnameAsParamDeclare.pig","sh \\$cmd.sh \\$date","\\$cmd.bat \\$date",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPigParamNotResolved() throws Exception {
  log.info("Starting test testPigParamNotResolved()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input3.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  }
 catch (  RuntimeException e) {
    if (e.getMessage().equals("Undefined parameter : 4")) {
      fail("Pig supported parameter $4 should not have been resolved.");
    }
  }
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSameParamInMultipleFiles() throws Exception {
  log.info("Starting test testSameParamInMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile3.txt",basedir + "/ConfFile2.txt",basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamCurlySyntax() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input7.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult7.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParam() throws Exception {
  log.info("Starting test testCmdlineParam() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamPriortoDeclare() throws Exception {
  log.info("Starting test testCmdlineParamPriortoDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"param='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultCmdLnPriorDeclare.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionInFuncArgs() throws Exception {
  log.info("Starting test testSubstitutionInFuncArgs()");
  final String queryString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": $debug,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"$name\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  final String expectedString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": 5,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"TestRecord\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(queryString.getBytes("UTF-8"))));
  pigOStream=new FileWriter(basedir + "/output26.pig");
  String[] arg={"debug = '5'","name = 'TestRecord'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output26.pig");
  InputStream expected=new ByteArrayInputStream(expectedString.getBytes("UTF-8"));
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(expected));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareDefaultComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDefault.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexVals() throws Exception {
  log.info("Starting test testComplexVals() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input5.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"loadfile = /user/pig/tests/data/singlefile/textdoc.txt"};
  String[] argFiles={basedir + "/ConfFileComplexVal.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult3.txt");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithDollarSign() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDollarSign.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"filter=\"($0 == 'x') and ($1 == 'y')\""};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDollarSign.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommentWithParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputComment.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultComment.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamWithInlineCmd() throws Exception {
  log.info("Starting test testCmdlineParamWithInlineCmd() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=`perl -e \"print qq@20080228\\n20070101@\" | head -n 1`"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleCmdlineParam() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='092487'","date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand() throws Exception {
  log.info("Starting test testShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/input4.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDefault.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParamsFromMultipleFiles() throws Exception {
  log.info("Starting test testFileParamsFromMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt",basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidLineinConfigfile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileWithInvalidLines.txt"};
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
    fail("Should have thrown an exception");
  }
 catch (  ParseException e) {
    assertTrue(e.getMessage().startsWith("Encountered \" <IDENTIFIER> \"is \"\" at line 2, column 6."));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinValue() throws Exception {
  log.info("Starting test  testSubstitutionWithinValue()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputSubstitutionWithinValue.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsinSingleLine() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstituteWithinLiteral() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParam() throws Exception {
  log.info("Starting test  testFileParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeclareScope() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleDeclares.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultMulDecs.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoVars() throws Exception {
  log.info("Starting test testNoVars() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputNoVars.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/inputNoVars.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinShellCommand() throws Exception {
  log.info("Starting test testSubstitutionWithinShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputSubstitutionWithinShellCommand.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsFromSingleFile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileSameParamMultipleTimes.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeForeachFail() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = foreach a generate field1 + 10;");
  try {
    pig.dumpSchema("c");
    fail("Error expected");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Unable to describe schema for alias c"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void test1() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.setValidateEachStatement(true);
  pig.registerQuery("A = load 'x' as (u, v);");
  try {
    pig.registerQuery("B = foreach A generate $2;");
    fail("Query is supposed to fail.");
  }
 catch (  FrontendException ex) {
    String msg="Out of bound access. " + "Trying to access non-existent column: 2";
    Util.checkMessageInException(ex,msg);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-7 type-8 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonExistingSecondDirectoryInSkewJoin() throws Exception {
  String script="exists = LOAD 'test/org/apache/pig/test/data/InputFiles/jsTst1.txt' AS (x:chararray, a:long);" + "missing = LOAD '/non/existing/directory' AS (a:long);" + "missing = FOREACH ( GROUP missing BY a ) GENERATE $0 AS a, COUNT_STAR($1);"+ "joined = JOIN exists BY a, missing BY a USING 'skewed';"+ "STORE joined INTO '/tmp/test_out.tsv';";
  PigServer pig=new PigServer(Util.getLocalTestMode());
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
      fail("Expect front exception");
    }
 catch (    Exception ex) {
      Throwable excp=ex;
      assertTrue(excp instanceof FrontendException);
      excp=excp.getCause();
      assertTrue(excp instanceof VisitorException);
      excp=excp.getCause();
      assertTrue(excp instanceof ExecException);
      excp=excp.getCause();
      assertTrue(excp instanceof InvalidInputException);
    }
  }
 else {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
    }
 catch (    Exception ex) {
      fail("Unexpected exception: " + ex);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStats </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPigStatsGetList() throws Exception {
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testPigStatsGetList";
    outputFile=File.createTempFile(filename,".out");
    String filePath=outputFile.getAbsolutePath();
    outputFile.delete();
    PigServer pigServer=new PigServer(Util.getLocalTestMode());
    pigServer.registerQuery("a = load 'test/org/apache/pig/test/data/passwd';");
    pigServer.registerQuery("b = group a by $0;");
    pigServer.registerQuery("c = foreach b generate group, COUNT(a) as cnt;");
    pigServer.registerQuery("d = group c by cnt;");
    pigServer.registerQuery("e = foreach d generate group;");
    ExecJob job=pigServer.store("e",filePath);
    checkPigStats(job);
  }
 catch (  IOException e) {
    LOG.error("IOException while creating file ",e);
    fail("Encountered IOException");
  }
 finally {
    if (outputFile != null) {
      deleteDirectory(outputFile);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesWritten_JIRA_1027() throws Exception {
  File outputFile=null;
  try {
    String fileName=this.getClass().getName() + "_" + "testBytesWritten_JIRA_1027";
    outputFile=File.createTempFile(fileName,".out");
    String filePath=outputFile.getAbsolutePath();
    outputFile.delete();
    PigServer pig=new PigServer(Util.getLocalTestMode());
    pig.registerQuery("A = load 'test/org/apache/pig/test/data/passwd';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    File dataFile=Util.getFirstPartFile(outputFile);
    assertEquals(dataFile.length(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    if (outputFile != null) {
      deleteDirectory(outputFile);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStatsMR </h4><pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testBytesWritten_JIRA_1027() throws Exception {
  FileLocalizer.setInitialized(false);
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  try {
    String filePath="/tmp/" + this.getClass().getName() + "_"+ "testBytesWritten_JIRA_1027";
    PigServer pig=new PigServer(cluster.getExecType(),cluster.getProperties());
    String inputFile="test/org/apache/pig/test/data/passwd";
    Util.copyFromLocalToCluster(cluster,inputFile,inputFile);
    pig.registerQuery("A = load '" + inputFile + "';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    Path dataFile=Util.getFirstPartFile(new Path(filePath));
    FileStatus fs=cluster.getFileSystem().getFileStatus(dataFile);
    assertEquals(fs.getLen(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    FileLocalizer.setInitialized(false);
    cluster.shutDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageNoSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t', '-schema') "+ "as (f1:chararray, f2:int);";
  try {
    pig.registerQuery(query);
    pig.dumpSchema("a");
  }
 catch (  FrontendException ex) {
    assertEquals(ex.toString(),1000,ex.getErrorCode());
    return;
  }
  fail("no exception caught");
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockBoundary() throws ExecException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  Properties properties=cluster.getProperties();
  Properties props=new Properties();
  for (  Entry<Object,Object> entry : properties.entrySet()) {
    props.put(entry.getKey(),entry.getValue());
  }
  props.setProperty(MRConfiguration.MAX_SPLIT_SIZE,"20");
  Util.resetStateForExecModeSwitch();
  PigServer pigServer=new PigServer(cluster.getExecType(),props);
  String[] inputs={"abcdefgh1","abcdefgh2","abcdefgh3","abcdefgh4","abcdefgh5","abcdefgh6","abcdefgh7","abcdefgh8","abcdefgh9"};
  String[] expected={"(abcdefgh1)","(abcdefgh2)","(abcdefgh3)","(abcdefgh4)","(abcdefgh5)","(abcdefgh6)","(abcdefgh7)","(abcdefgh8)","(abcdefgh9)"};
  System.setProperty("pig.overrideBlockSize","20");
  String INPUT_FILE="tmp.txt";
  try {
    PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
    for (    String s : inputs) {
      w.println(s);
    }
    w.close();
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pigServer.registerQuery("a = load '" + INPUT_FILE + "';");
    Iterator<Tuple> iter=pigServer.openIterator("a");
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expected[counter++].toString(),iter.next().toString());
    }
    assertEquals(expected.length,counter);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
 finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
    cluster.shutDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRelationToExprProject </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterCount1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        filter_notone = filter test by (col2!=1);"+ "        generate group as col1, COUNT(filter_one) as cnt_one, COUNT(filter_notone) as cnt_notone;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Tuple[] expected=new DefaultTuple[2];
  expected[0]=(Tuple)Util.getPigConstant("(1,1L,1L)");
  expected[1]=(Tuple)Util.getPigConstant("(2,2L,0L)");
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertTrue(expected[j].equals(results[j]));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate filter_one;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("({(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("({(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(new Integer(1),occurences);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate group, filter_one;};";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("(1,{(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("(2,{(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(new Integer(3));
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(Integer.valueOf(1),occurences);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: bag without tuple field
 */
@Test public void testResourceSchemaWithInvalidPigSchema2() throws FrontendException {
  String[] aliases={"f1"};
  byte[] types={DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: multiple fields for a bag
 */
@Test public void testResourceSchemaWithInvalidPigSchema() throws FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliases </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testScalarErrMultipleRowsInInput() throws Exception {
  Util.resetStateForExecModeSwitch();
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] input={"1\t5","2\t10","3\t20"};
  String INPUT_FILE="table_testScalarAliasesMulRows";
  Util.createInputFile(cluster,INPUT_FILE,input);
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (a0: long, a1: double);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (b0: long, b1: double);");
  pigServer.registerQuery("C = foreach A generate $0, B.$0;");
  try {
    pigServer.openIterator("C");
    fail("exception expected - scalar input has multiple rows");
  }
 catch (  IOException pe) {
    Util.checkStrContainsSubStr(pe.getCause().getMessage(),"Scalar has more than one row in the output");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliasesLocal </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScalarAliasesGrammarNegative() throws Exception {
  String[] input={"1\t5","2\t10","3\t20"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarAliasesGrammar";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  try {
    pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0: long, a1: double);");
    pigServer.registerQuery("B = group A all;");
    pigServer.registerQuery("C = foreach B generate COUNT(A);");
    pigServer.registerQuery("Y = foreach A generate C;");
    pigServer.openIterator("Y");
    fail("Scalar projections are only supported");
  }
 catch (  IOException pe) {
    assertTrue(pe.getMessage().contains("Invalid scalar projection: C"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType1() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:long, c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:bytearray, c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(b11:double, b12:(b121:int)), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMergeMismatchType3(){
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",DataType.CHARARRAY));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",DataType.DOUBLE));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema1=new Schema(innerList1);
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.MAP));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.MAP));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  try {
    Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,false);
    fail("Expect error here!");
  }
 catch (  SchemaMergeException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParserException.class) public void testGetStringFromSchemaNegative() throws Exception {
  String schemaString="a:int b:long";
  Utils.getSchemaFromString(schemaString);
  fail("The schema string is invalid, so parsing should fail!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSkewedJoin </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSkewedJoinNullKeys() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE5 + "' as (id,name);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' as (id,name);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("C = join A by id, B by id using 'skewed';");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
  }
 catch (  Exception e) {
    System.out.println(e.getMessage());
    e.printStackTrace();
    fail("Should support null keys in skewed join");
  }
  return;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplitIndex </h4><pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplitIndex() throws Exception {
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputDir.toString()) + "' using "+ SplitSensitiveLoadFunc.class.getName()+ "();");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  boolean file1exist=false, file2exist=false;
  Tuple t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  if (!file1exist || !file2exist)   Assert.fail();
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSplitIndexNoCombine() throws Exception {
  pigServer.getPigContext().getProperties().setProperty("pig.splitCombination","false");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputDir.toString()) + "' using "+ SplitSensitiveLoadFunc.class.getName()+ "();");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  boolean file1exist=false, file2exist=false;
  Tuple t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  t=iter.next();
  if (t.get(2).toString().endsWith("/1"))   file1exist=true;
  if (t.get(2).toString().endsWith("/2"))   file2exist=true;
  if (!file1exist || !file2exist)   Assert.fail();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStore </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidation() throws Exception {
  String outputFileName="test-output.txt";
  try {
    String query="a = load '" + inputFileName + "' as (c:chararray, "+ "i:int,d:double);"+ "store a into '"+ outputFileName+ "' using "+ "PigStorage();";
    org.apache.pig.newplan.logical.relational.LogicalPlan lp=Util.buildLp(ps,query);
  }
 catch (  PlanValidationException e) {
    fail("Store validation test failed.");
  }
 finally {
    Util.deleteFile(ps.getPigContext(),outputFileName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreaming </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMultipleInput() throws IOException {
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command1=Util.createInputFile("script","pl",script);
  String query="define CMD1 `perl " + command1.getName() + " foo` "+ "ship ('"+ Util.encodeEscape(command1.toString())+ "') "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "output(stdout using "+ PigStreaming.class.getName()+ "(',')) "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();";
  try {
    pigServer.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String expectedMsg="pig script failed to validate: Duplicated command option";
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains(expectedMsg));
    return;
  }
  Assert.fail("Testcase is supposed to fail.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-8 type-9 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitUncompressed() throws Exception {
  resetLog(InterStorage.class);
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
  assertTrue(checkLogFileMessage(new String[]{"Pig Internal storage in use"}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-11 type-8 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  pig=new ToolsPigServer(cluster.getExecType(),cluster.getProperties());
  stdOutRedirectedFile=new File("stdout.redirected");
  if (!stdOutRedirectedFile.createNewFile())   fail("Unable to create input files");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTuple </h4><pre class="type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleFormat(){
  try {
    Tuple tuple=mTupleFactory.newTuple(7);
    tuple.set(0,12);
    Map<String,String> map=new HashMap<String,String>();
    map.put("pig","scalability");
    tuple.set(1,map);
    tuple.set(2,null);
    tuple.set(3,12L);
    tuple.set(4,1.2F);
    Tuple innerTuple=mTupleFactory.newTuple(1);
    innerTuple.set(0,"innerTuple");
    tuple.set(5,innerTuple);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(innerTuple);
    tuple.set(6,bag);
    assertEquals("(12,[pig#scalability],,12,1.2,(innerTuple),{(innerTuple)})",TupleFormat.format(tuple));
  }
 catch (  ExecException e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSortWithInnerPlan3() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1",DataType.BYTEARRAY));
    fsList1.add(new FieldSchema("field2",DataType.INTEGER));
    inputSchema1=new Schema(fsList1);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema((inputSchema1)));
  ;
  LOSort sort1=new LOSort(plan);
  LogicalExpressionPlan innerPlan1=new LogicalExpressionPlan();
  ProjectExpression project11=new ProjectExpression(innerPlan1,0,0,sort1);
  ProjectExpression project12=new ProjectExpression(innerPlan1,0,1,sort1);
  MultiplyExpression mul1=new MultiplyExpression(innerPlan1,project11,project12);
  LogicalExpressionPlan innerPlan2=new LogicalExpressionPlan();
  ProjectExpression project21=new ProjectExpression(innerPlan2,0,0,sort1);
  ConstantExpression const21=new ConstantExpression(innerPlan2,"26");
  ModExpression mod21=new ModExpression(innerPlan2,project21,const21);
  List<LogicalExpressionPlan> innerPlans=new ArrayList<LogicalExpressionPlan>();
  innerPlans.add(innerPlan1);
  innerPlans.add(innerPlan2);
  List<Boolean> ascList=new ArrayList<Boolean>();
  ascList.add(true);
  ascList.add(true);
  sort1.setAscendingCols(ascList);
  sort1.setSortColPlans(innerPlans);
  plan.add(load1);
  plan.add(sort1);
  plan.connect(load1,sort1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  try {
    typeChecker.visit();
    fail("Error expected");
  }
 catch (  Exception t) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Error expected");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeCheckingFail11() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant0=new ConstantExpression(plan,new DateTime(0L));
  ConstantExpression constant1=new ConstantExpression(plan,new String("1970-01-01T00:00:00.000Z"));
  CastExpression cast1=new CastExpression(plan,constant1,createFS(DataType.CHARARRAY));
  EqualExpression eq1=new EqualExpression(plan,constant0,cast1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new Exception("Error during type checking");
  }
}

</code></pre>

<br>
<pre class="type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeCheckingFail4() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20D);
  ConstantExpression constant3=new ConstantExpression(plan,"123");
  DivideExpression div1=new DivideExpression(plan,constant1,constant2);
  CastExpression cast1=new CastExpression(plan,constant3,createFS(DataType.BYTEARRAY));
  NotEqualExpression notequal1=new NotEqualExpression(plan,div1,cast1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    fail("Error during type checking");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeCheckingFail10() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20L);
  ConstantExpression constant3=new ConstantExpression(plan,"true");
  GreaterThanExpression gt1=new GreaterThanExpression(plan,constant1,constant2);
  CastExpression cast1=new CastExpression(plan,constant3,createFS(DataType.BYTEARRAY));
  EqualExpression equal1=new EqualExpression(plan,gt1,cast1);
  NotEqualExpression nq1=new NotEqualExpression(plan,gt1,cast1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new Exception("Error during type checking");
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBincond() throws Throwable {
  String query="a= load 'a' as (name: chararray, age: int, gpa: float);" + "b = group a by name;" + "c = foreach b generate (IsEmpty(a) ? " + TestBinCondFieldSchema.class.getName() + "(*): a);";
  LOForEach foreach=getForeachFromPlan(query);
  Schema.FieldSchema charFs=new FieldSchema(null,DataType.CHARARRAY);
  Schema.FieldSchema intFs=new FieldSchema(null,DataType.INTEGER);
  Schema.FieldSchema floatFs=new FieldSchema(null,DataType.FLOAT);
  Schema tupleSchema=new Schema();
  tupleSchema.add(charFs);
  tupleSchema.add(intFs);
  tupleSchema.add(floatFs);
  Schema.FieldSchema bagFs=null;
  Schema bagSchema=new Schema();
  bagSchema.add(new FieldSchema(null,tupleSchema,DataType.TUPLE));
  try {
    bagFs=new Schema.FieldSchema(null,bagSchema,DataType.BAG);
  }
 catch (  FrontendException fee) {
    fail("Did not expect an error");
  }
  Schema expectedSchema=new Schema(bagFs);
  Schema foreachSch=org.apache.pig.newplan.logical.Util.translateSchema(foreach.getSchema());
  assertTrue(Schema.equals(foreachSch,expectedSchema,false,true));
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeCheckingFail1() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20D);
  ConstantExpression constant3=new ConstantExpression(plan,"123");
  AddExpression add1=new AddExpression(plan,constant1,constant2);
  CastExpression cast1=new CastExpression(plan,constant3,createFS(DataType.BYTEARRAY));
  MultiplyExpression mul1=new MultiplyExpression(plan,add1,cast1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new Exception("Error during type checking");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testForEachGenerate2() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  LOLoad load1=genDummyLOLoadNewLP(plan);
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1a",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2a",DataType.LONG));
    inputSchema1=new Schema(fsList1);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema((inputSchema1)));
  ;
  LogicalPlan innerRelPlan=new LogicalPlan();
  LOForEach foreach1=new LOForEach(plan);
  foreach1.setInnerPlan(innerRelPlan);
  LOGenerate loGen=new LOGenerate(innerRelPlan);
  innerRelPlan.add(loGen);
  LOInnerLoad innerLoad1=new LOInnerLoad(innerRelPlan,foreach1,0);
  innerRelPlan.add(innerLoad1);
  innerRelPlan.connect(innerLoad1,loGen);
  LogicalExpressionPlan innerPlan1=new LogicalExpressionPlan();
  ProjectExpression project11=new ProjectExpression(innerPlan1,0,0,loGen);
  ConstantExpression const11=new ConstantExpression(innerPlan1,"26F");
  SubtractExpression subtract11=new SubtractExpression(innerPlan1,project11,const11);
  LogicalExpressionPlan innerPlan2=new LogicalExpressionPlan();
  innerLoad1=new LOInnerLoad(innerRelPlan,foreach1,0);
  innerRelPlan.add(innerLoad1);
  innerRelPlan.connect(innerLoad1,loGen);
  ProjectExpression project21=new ProjectExpression(innerPlan2,1,0,loGen);
  innerLoad1=new LOInnerLoad(innerRelPlan,foreach1,0);
  innerRelPlan.add(innerLoad1);
  innerRelPlan.connect(innerLoad1,loGen);
  ProjectExpression project22=new ProjectExpression(innerPlan2,2,1,loGen);
  AddExpression add21=new AddExpression(innerPlan2,project21,project22);
  ArrayList<LogicalExpressionPlan> generatePlans=new ArrayList<LogicalExpressionPlan>();
  generatePlans.add(innerPlan1);
  generatePlans.add(innerPlan2);
  boolean[] flattens={true,false};
  loGen.setFlattenFlags(flattens);
  loGen.setOutputPlans(generatePlans);
  plan.add(load1);
  plan.add(foreach1);
  plan.connect(load1,foreach1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  try {
    typeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Expect error");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCogroupStarLineageFail() throws Throwable {
  String query="a = load 'a' using PigStorage('x') as (field1, field2: float, field3: chararray );" + "b = load 'b' using PigStorage('x') as (field4, field5, field6: chararray );" + "c = cogroup a by *, b by *;"+ "d = foreach c generate group, flatten($1), flatten($2);"+ "e = foreach d generate group + 1, field1 + 1, field4 + 2.0;";
  LogicalPlan plan=generateLogicalPlan(query);
  new ColumnAliasConversionVisitor(plan).visit();
  CompilationMessageCollector collector=new CompilationMessageCollector();
  try {
    TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
    typeChecker.visit();
    fail("exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Expect error");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeChecking6() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,"10");
  ConstantExpression constant2=new ConstantExpression(plan,20L);
  AddExpression add1=new AddExpression(plan,constant1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  LogicalRelationalOperator dummyRelOp=createDummyRelOpWithAlias();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,dummyRelOp);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
    String msg="In alias dummy, incompatible types in " + "Add Operator left hand side:chararray right hand side:long";
    checkMessageInException(pve,msg);
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Error expected");
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExpressionTypeChecking7() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20D);
  ConstantExpression constant3=new ConstantExpression(plan,123L);
  GreaterThanExpression gt1=new GreaterThanExpression(plan,constant1,constant2);
  EqualExpression equal1=new EqualExpression(plan,gt1,constant3);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  LogicalRelationalOperator dummyRelOp=createDummyRelOpWithAlias();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,dummyRelOp);
  try {
    expTypeChecker.visit();
    fail("Exception expected");
  }
 catch (  TypeCheckerException pve) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Error expected");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnion </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaMergeWithBag() throws Exception {
  File f1=Util.createInputFile("tmp","input1.txt",new String[]{"dummy"});
  File f2=Util.createInputFile("tmp","input2.txt",new String[]{"dummy"});
  Util.registerMultiLineQuery(pigServer,"a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "';"+ "b = load '"+ Util.encodeEscape(f2.getAbsolutePath())+ "';"+ "c = foreach a generate 1, {(1, 'str1')};"+ "d = foreach b generate 2, {(2, 'str2')};"+ "e = union c,d;"+ "");
  Iterator<Tuple> it=pigServer.openIterator("e");
  Object[] expected=new Object[]{Util.getPigConstant("(1, {(1, 'str1')})"),Util.getPigConstant("(2, {(2, 'str2')})")};
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertEquals(expected[j],results[j]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.pigunit.TestPigTest </h4><pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSpecificOrderOutput() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] reorderedExpectedOutput={"(twitter,7)","(yahoo,25)","(facebook,15)"};
  try {
    test.assertOutput(reorderedExpectedOutput);
    fail("assertOutput should fail when the records are unordered.");
  }
 catch (  ComparisonFailure e) {
  }
}

</code></pre>

<br>
<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSpecificOrderOutputForAlias() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] reorderedExpectedOutput={"(twitter,7)","(yahoo,25)","(facebook,15)"};
  try {
    test.assertOutput("queries_limit",reorderedExpectedOutput);
    fail("assertOutput should fail when the records are unordered.");
  }
 catch (  ComparisonFailure e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tools.grunt.TestGruntParser </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessRemove() throws IOException {
  File tmpFile=File.createTempFile("TestGruntParser","testProcessRemove");
  String dummyScript="";
  parser=new GruntParser(new ByteArrayInputStream(dummyScript.getBytes()),pig);
  parser.processRemove(tmpFile.getAbsolutePath(),"");
  assertFalse(tmpFile.exists());
  try {
    parser.processRemove(tmpFile.getAbsolutePath(),"");
    fail("processRemove should throw exception when deleting missing file.");
  }
 catch (  IOException e) {
  }
  parser.processRemove(tmpFile.getAbsolutePath(),"force");
  tmpFile=File.createTempFile("TestGruntParser","testProcessRemove");
  parser.setExplainState(new ExplainState("","","",false,""));
  parser.processRemove(tmpFile.getAbsolutePath(),"force");
  assertTrue(tmpFile.exists());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
