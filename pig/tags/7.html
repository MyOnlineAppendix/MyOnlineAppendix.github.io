<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.TestLoadFuncWrapper </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyLoadFunc loadFunc=new DummyLoadFunc();
  MockWrapper wrapper=new MockWrapper(loadFunc);
  wrapper.relativeToAbsolutePath(null,null);
  assertEquals("relativeToAbsolutePath",loadFunc.getLastMethodCalled());
  wrapper.setLocation(null,null);
  assertEquals("setLocation",loadFunc.getLastMethodCalled());
  wrapper.getInputFormat();
  assertEquals("getInputFormat",loadFunc.getLastMethodCalled());
  wrapper.getLoadCaster();
  assertEquals("getLoadCaster",loadFunc.getLastMethodCalled());
  wrapper.prepareToRead(null,null);
  assertEquals("prepareToRead",loadFunc.getLastMethodCalled());
  wrapper.getNext();
  assertEquals("getNext",loadFunc.getLastMethodCalled());
  wrapper.setUDFContextSignature(null);
  assertEquals("setUDFContextSignature",loadFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    loadFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestMain </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testlog4jConf() throws Exception {
  Properties properties=Main.log4jConfAsProperties(null);
  assertTrue(properties.isEmpty());
  properties=Main.log4jConfAsProperties("");
  assertTrue(properties.isEmpty());
  properties=Main.log4jConfAsProperties("non-existing-" + System.currentTimeMillis());
  assertTrue(properties.isEmpty());
  File tmpFile=File.createTempFile("pig-log4jconf",".properties",new File("build/test/classes"));
  tmpFile.deleteOnExit();
  Files.write("A=B",tmpFile,Charset.forName("UTF-8"));
  properties=Main.log4jConfAsProperties(tmpFile.getName());
  assertEquals("B",properties.getProperty("A"));
  properties=Main.log4jConfAsProperties(tmpFile.getAbsolutePath());
  assertEquals("B",properties.getProperty("A"));
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun_setsErrorThrowableForParamSubstitution(){
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testRun_setsErrorThrowableForParamSubstitution";
    outputFile=File.createTempFile(filename,".out");
    outputFile.delete();
    File scriptFile=File.createTempFile(filename,".pig");
    BufferedWriter bw=new BufferedWriter(new FileWriter(scriptFile));
    bw.write("a = load '$NOEXIST';\n");
    bw.write("b = group a by $0\n");
    bw.write("c = foreach b generate group, COUNT(a) as cnt;\n");
    bw.write("store c into 'out'\n");
    bw.close();
    Main.run(new String[]{"-x","local",scriptFile.getAbsolutePath()},null);
    PigStats stats=PigStats.get();
    Throwable t=stats.getErrorThrowable();
    assertTrue(t instanceof IOException);
    Throwable cause=t.getCause();
    assertTrue(cause instanceof ParameterSubstitutionException);
    ParameterSubstitutionException pse=(ParameterSubstitutionException)cause;
    assertTrue(pse.getMessage().contains("NOEXIST"));
  }
 catch (  Exception e) {
    log.error("Encountered exception",e);
    fail("Encountered Exception");
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomListener(){
  Properties p=new Properties();
  p.setProperty(Main.PROGRESS_NOTIFICATION_LISTENER_KEY,TestNotificationListener2.class.getName());
  TestNotificationListener2 listener=(TestNotificationListener2)Main.makeListener(p);
  assertEquals(TestNotificationListener2.class,Main.makeListener(p).getClass());
  assertFalse(listener.hadArgs);
  p.setProperty(Main.PROGRESS_NOTIFICATION_LISTENER_ARG_KEY,"foo");
  listener=(TestNotificationListener2)Main.makeListener(p);
  assertEquals(TestNotificationListener2.class,Main.makeListener(p).getClass());
  assertTrue(listener.hadArgs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestStoreFuncWrapper </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyStoreFunc storeFunc=new DummyStoreFunc();
  MockWrapper wrapper=new MockWrapper(storeFunc);
  wrapper.relToAbsPathForStoreLocation(null,null);
  assertEquals("relToAbsPathForStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.getOutputFormat();
  assertEquals("getOutputFormat",storeFunc.getLastMethodCalled());
  wrapper.setStoreLocation(null,null);
  assertEquals("setStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.checkSchema(null);
  assertEquals("checkSchema",storeFunc.getLastMethodCalled());
  wrapper.prepareToWrite(null);
  assertEquals("prepareToWrite",storeFunc.getLastMethodCalled());
  wrapper.putNext(null);
  assertEquals("putNext",storeFunc.getLastMethodCalled());
  wrapper.setStoreFuncUDFContextSignature(null);
  assertEquals("setStoreFuncUDFContextSignature",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnSuccess(null,null);
  assertEquals("cleanupOnSuccess",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnFailure(null,null);
  assertEquals("cleanupOnFailure",storeFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    storeFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloPigCluster </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  loadTestData();
  final String loadFlights="flights = LOAD 'accumulo://flights?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String loadAirports="airports = LOAD 'accumulo://airports?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String joinQuery="joined = JOIN flights BY column_map#'origin', airports BY column_map#'code';";
  pig.registerQuery(loadFlights);
  pig.registerQuery(loadAirports);
  pig.registerQuery(joinQuery);
  Iterator<Tuple> it=pig.openIterator("joined");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Assert.assertEquals(4,t.size());
    Object o=t.get(1);
    Map<String,String> airport=null, flight=null;
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data1=(Map<String,String>)o;
    Assert.assertTrue(!data1.isEmpty());
    if (data1.containsKey("origin")) {
      flight=data1;
    }
 else     if (data1.containsKey("code")) {
      airport=data1;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    o=t.get(3);
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data2=(Map<String,String>)o;
    Assert.assertTrue(!data2.isEmpty());
    if (null == flight && data2.containsKey("origin")) {
      flight=data2;
    }
 else     if (null == airport && data2.containsKey("code")) {
      airport=data2;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    Assert.assertTrue(null != airport && null != flight);
    Assert.assertEquals(airport.get("code"),flight.get("origin"));
    i++;
  }
  Assert.assertEquals(6,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorage </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteIgnoredExtraColumns() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,"value2");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value1".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleScalars() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col3,col5");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1",""));
  keys.add(new Key("1","col3",""));
  keys.add(new Key("1","col5",""));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value3".getBytes()));
  values.add(new Value("value5".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(4,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  Assert.assertEquals("value1",t.get(1).toString());
  Assert.assertEquals("value3",t.get(2).toString());
  Assert.assertEquals("value5",t.get(3).toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithMixedColumns() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col1:qual,col2:qual,col2");
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,"value2");
  t.set(3,"value3");
  t.set(4,"value4");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col1".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value1".getBytes()));
  colUpdate=colUpdates.get(1);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col1".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value2".getBytes()));
  colUpdate=colUpdates.get(2);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col2".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value3".getBytes()));
  colUpdate=colUpdates.get(3);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col2".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value4".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadSingleKey() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage();
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","","col1"));
  values.add(new Value("value1".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put(":col1",new DataByteArray("value1"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleColumnsNoColfamAggregate() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage();
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1","cq1"));
  keys.add(new Key("1","col1","cq2"));
  keys.add(new Key("1","col1","cq3"));
  keys.add(new Key("1","col2","cq1"));
  keys.add(new Key("1","col3","cq1"));
  keys.add(new Key("1","col3","cq2"));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  values.add(new Value("value3".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put("col1:cq1",new DataByteArray("value1"));
  map.put("col1:cq2",new DataByteArray("value2"));
  map.put("col1:cq3",new DataByteArray("value3"));
  map.put("col2:cq1",new DataByteArray("value1"));
  map.put("col3:cq1",new DataByteArray("value1"));
  map.put("col3:cq2",new DataByteArray("value2"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithColumn() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteIgnoredExtraMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMultipleColumnsWithNonExpandedMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col2");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(2,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
  update=colUpdates.get(1);
  Assert.assertEquals("col2",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertArrayEquals(storage.objToBytes(map,DataType.MAP),update.getValue());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleColumnsEmptyString() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1","cq1"));
  keys.add(new Key("1","col1","cq2"));
  keys.add(new Key("1","col1","cq3"));
  keys.add(new Key("1","col2","cq1"));
  keys.add(new Key("1","col3","cq1"));
  keys.add(new Key("1","col3","cq2"));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  values.add(new Value("value3".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put("col1:cq1",new DataByteArray("value1"));
  map.put("col1:cq2",new DataByteArray("value2"));
  map.put("col1:cq3",new DataByteArray("value3"));
  map.put("col2:cq1",new DataByteArray("value1"));
  map.put("col3:cq1",new DataByteArray("value1"));
  map.put("col3:cq2",new DataByteArray("value2"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithColumnQual() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:qual");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value".getBytes()));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMultipleColumnsWithExpandedMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col2:");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(5,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col2","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col2","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col2","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col2","mapcol4"),"mapval4");
  for (int i=1; i < 5; i++) {
    update=colUpdates.get(i);
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnsortedColumnList() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("z,a");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","a",""));
  keys.add(new Key("1","z",""));
  values.add(new Value("a".getBytes()));
  values.add(new Value("z".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(3,t.size());
  Assert.assertEquals("z",t.get(1).toString());
  Assert.assertEquals("a",t.get(2).toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadSingleColumn() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage();
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1","cq1"));
  keys.add(new Key("1","col1","cq2"));
  keys.add(new Key("1","col1","cq3"));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  values.add(new Value("value3".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put("col1:cq1",new DataByteArray("value1"));
  map.put("col1:cq2",new DataByteArray("value2"));
  map.put("col1:cq3",new DataByteArray("value3"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleColumnsAggregateColfamsAsterisk() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("*");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1","cq1"));
  keys.add(new Key("1","col1","cq2"));
  keys.add(new Key("1","col1","cq3"));
  keys.add(new Key("1","col2","cq1"));
  keys.add(new Key("1","col3","cq1"));
  keys.add(new Key("1","col3","cq2"));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  values.add(new Value("value3".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put("col1:cq1",new DataByteArray("value1"));
  map.put("col1:cq2",new DataByteArray("value2"));
  map.put("col1:cq3",new DataByteArray("value3"));
  map.put("col2:cq1",new DataByteArray("value1"));
  map.put("col3:cq1",new DataByteArray("value1"));
  map.put("col3:cq2",new DataByteArray("value2"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamColQualPrefix() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:qual_*");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","qual_mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","qual_mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","qual_mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","qual_mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue(expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamWithColon() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleColumnsAggregateColfamsAsteriskEmptyColfam() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("*");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","col1",""));
  keys.add(new Key("1","col2",""));
  keys.add(new Key("1","col3",""));
  values.add(new Value("value1".getBytes()));
  values.add(new Value("value2".getBytes()));
  values.add(new Value("value3".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("1",t.get(0).toString());
  InternalMap map=new InternalMap();
  map.put("col1",new DataByteArray("value1"));
  map.put("col2",new DataByteArray("value2"));
  map.put("col3",new DataByteArray("value3"));
  Assert.assertEquals(map,t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamWithColonAsterisk() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:*");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleScalarsAndMaps() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("z,r:,m:2,b:");
  List<Key> keys=Lists.newArrayList();
  List<Value> values=Lists.newArrayList();
  keys.add(new Key("1","a","1"));
  keys.add(new Key("1","b","1"));
  keys.add(new Key("1","b","2"));
  keys.add(new Key("1","f","1"));
  keys.add(new Key("1","f","2"));
  keys.add(new Key("1","m","1"));
  keys.add(new Key("1","m","2"));
  keys.add(new Key("1","r","1"));
  keys.add(new Key("1","r","2"));
  keys.add(new Key("1","r","3"));
  keys.add(new Key("1","z",""));
  values.add(new Value("a1".getBytes()));
  values.add(new Value("b1".getBytes()));
  values.add(new Value("b2".getBytes()));
  values.add(new Value("f1".getBytes()));
  values.add(new Value("f2".getBytes()));
  values.add(new Value("m1".getBytes()));
  values.add(new Value("m2".getBytes()));
  values.add(new Value("r1".getBytes()));
  values.add(new Value("r2".getBytes()));
  values.add(new Value("r3".getBytes()));
  values.add(new Value("z1".getBytes()));
  Key k=new Key("1");
  Value v=WholeRowIterator.encodeRow(keys,values);
  Tuple t=storage.getTuple(k,v);
  Assert.assertEquals(5,t.size());
  Assert.assertEquals(new DataByteArray("z1".getBytes()),t.get(1));
  HashMap<String,DataByteArray> rMap=new HashMap<String,DataByteArray>();
  rMap.put("r:1",new DataByteArray("r1".getBytes()));
  rMap.put("r:2",new DataByteArray("r2".getBytes()));
  rMap.put("r:3",new DataByteArray("r3".getBytes()));
  Assert.assertEquals(rMap,t.get(2));
  Assert.assertEquals(new DataByteArray("m2".getBytes()),t.get(3));
  HashMap<String,DataByteArray> bMap=new HashMap<String,DataByteArray>();
  bMap.put("b:1",new DataByteArray("b1".getBytes()));
  bMap.put("b:2",new DataByteArray("b2".getBytes()));
  Assert.assertEquals(bMap,t.get(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.TestInputSizeReducerEstimator </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInputSizeFromFs() throws Exception {
  long size=2L * 1024 * 1024* 1024;
  POLoad load1=createPOLoadWithSize(size,new PigStorage());
  POLoad load2=createPOLoadWithSize(size,new PigStorageWithStatistics());
  Assert.assertEquals(size,InputSizeReducerEstimator.getTotalInputFileSize(CONF,Lists.newArrayList(load1),new org.apache.hadoop.mapreduce.Job(CONF)));
  Assert.assertEquals(size,InputSizeReducerEstimator.getTotalInputFileSize(CONF,Lists.newArrayList(load2),new org.apache.hadoop.mapreduce.Job(CONF)));
  Assert.assertEquals(size * 2,InputSizeReducerEstimator.getTotalInputFileSize(CONF,Lists.newArrayList(load1,load2),new org.apache.hadoop.mapreduce.Job(CONF)));
  load1.setLFile(new FileSpec("hbase://users",null));
  Assert.assertEquals(0,InputSizeReducerEstimator.getTotalInputFileSize(CONF,Collections.singletonList(load1),new org.apache.hadoop.mapreduce.Job(CONF)));
  Assert.assertEquals(size,InputSizeReducerEstimator.getTotalInputFileSize(CONF,Lists.newArrayList(load1,load2),new org.apache.hadoop.mapreduce.Job(CONF)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.TestPigBytesRawComparator </h4><pre class="type-13 type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayAlphabeticalOrderingByLength() throws Exception {
  for (int i=BinInterSedes.UNSIGNED_BYTE_MAX - 3; i < BinInterSedes.UNSIGNED_BYTE_MAX + 3; i++) {
    DataByteArray dba1=createRepeatedByteArray((byte)'2',i);
    DataByteArray dba2=createRepeatedByteArray((byte)'2',i + 1);
    assertTrue("ByteArray order changed at UNSIGNED_BYTE_MAX boundary",compareTwoObjectsAsNullableBytesWritables(dba1,dba2) < 0);
  }
  for (int i=BinInterSedes.UNSIGNED_SHORT_MAX - 3; i < BinInterSedes.UNSIGNED_SHORT_MAX + 3; i++) {
    DataByteArray dba1=createRepeatedByteArray((byte)'2',i);
    DataByteArray dba2=createRepeatedByteArray((byte)'2',i + 1);
    assertTrue("ByteArray order changed at UNSIGNED_SHORT_MAX boundary",compareTwoObjectsAsNullableBytesWritables(dba1,dba2) < 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.hbase.TestHBaseStorageFiltering </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnGroups() throws Exception {
  List<HBaseStorage.ColumnInfo> columnInfoList=getHBaseColumnInfo("cf1:a cf1:b cf2:foo*","");
  Map<String,List<HBaseStorage.ColumnInfo>> groupMap=HBaseStorage.groupByFamily(columnInfoList);
  assertEquals(2,groupMap.size());
  List<HBaseStorage.ColumnInfo> cf1List=groupMap.get("cf1");
  assertNotNull(cf1List);
  assertEquals(2,cf1List.size());
  assertColumnInfo(cf1List.get(0),"cf1","a",null);
  assertColumnInfo(cf1List.get(1),"cf1","b",null);
  List<HBaseStorage.ColumnInfo> cf2List=groupMap.get("cf2");
  assertNotNull(cf2List);
  assertEquals(1,cf2List.size());
  assertColumnInfo(cf2List.get(0),"cf2",null,"foo");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescriptorsAndPrefix() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:a cf1:b cf2:foo*");
  List<Filter> childFilters=assertFilterList(filter,FilterList.Operator.MUST_PASS_ALL,1);
  List<Filter> groupFilters=assertFilterList(childFilters.get(0),FilterList.Operator.MUST_PASS_ONE,2);
  List<Filter> firstFilters=assertFilterList(groupFilters.get(0),FilterList.Operator.MUST_PASS_ALL,2);
  FamilyFilter firstFamilyFilter=assertFamilyFilter(firstFilters.get(0),CompareFilter.CompareOp.EQUAL);
  List<Filter> secondFilters=assertFilterList(groupFilters.get(1),FilterList.Operator.MUST_PASS_ALL,2);
  FamilyFilter secondFamilyFilter=assertFamilyFilter(secondFilters.get(0),CompareFilter.CompareOp.EQUAL);
  Filter cf1ColumnList;
  Filter cf2ColumnList;
  if (Bytes.toString(firstFamilyFilter.getComparator().getValue()).equals("cf1")) {
    assertEquals("cf2",Bytes.toString(secondFamilyFilter.getComparator().getValue()));
    cf1ColumnList=firstFilters.get(1);
    cf2ColumnList=secondFilters.get(1);
  }
 else {
    assertEquals("cf1",Bytes.toString(secondFamilyFilter.getComparator().getValue()));
    assertEquals("cf2",Bytes.toString(firstFamilyFilter.getComparator().getValue()));
    cf1ColumnList=secondFilters.get(1);
    cf2ColumnList=firstFilters.get(1);
  }
  List<Filter> c1ColumnFilters=assertFilterList(cf1ColumnList,FilterList.Operator.MUST_PASS_ONE,2);
  assertQualifierFilter(c1ColumnFilters.get(0),CompareFilter.CompareOp.EQUAL,"a");
  assertQualifierFilter(c1ColumnFilters.get(1),CompareFilter.CompareOp.EQUAL,"b");
  List<Filter> c2ColumnFilters=assertFilterList(cf2ColumnList,FilterList.Operator.MUST_PASS_ONE,1);
  assertPrefixFilter(c2ColumnFilters.get(0),"foo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestAvroStorage </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRetrieveDataFromMap() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServerLocal);
  Map<String,String> mapv1=new HashMap<String,String>();
  mapv1.put("key1","v11");
  mapv1.put("key2","v12");
  Map<String,String> mapv2=new HashMap<String,String>();
  mapv2.put("key1","v21");
  mapv2.put("key2","v22");
  data.set("testMap","maps:map[chararray]",tuple(mapv1),tuple(mapv2));
  String schemaDescription=new String("{" + "\"type\": \"record\"," + "\"name\": \"record\","+ "\"fields\" : ["+ "{\"name\" : \"maps\", \"type\" :{\"type\" : \"map\", \"values\" : \"string\"}}"+ "]"+ "}");
  pigServerLocal.registerQuery("A = LOAD 'testMap' USING mock.Storage();");
  pigServerLocal.registerQuery("STORE A INTO '" + createOutputName() + "' USING AvroStorage('"+ schemaDescription+ "');");
  pigServerLocal.registerQuery("B = LOAD '" + createOutputName() + "' USING AvroStorage();");
  pigServerLocal.registerQuery("C = FOREACH B generate maps#'key1';");
  pigServerLocal.registerQuery("STORE C INTO 'out' USING mock.Storage();");
  List<Tuple> out=data.get("out");
  assertEquals(tuple("v11"),out.get(0));
  assertEquals(tuple("v21"),out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testCompareToOfBagWrapper() throws Exception {
  final String check=basedir + "data/avro/uncompressed/arraysAsOutputByPig.avro";
  Set<GenericData.Record> records=getExpected(check);
  assertEquals(3,records.size());
  AvroBagWrapper size0=null;
  AvroBagWrapper size1=null;
  AvroBagWrapper size5=null;
  for (  GenericData.Record record : records) {
    AvroTupleWrapper tw=new AvroTupleWrapper<GenericData.Record>(record);
    if (((AvroBagWrapper)tw.get(0)).size() == 0) {
      size0=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 1) {
      size1=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 5) {
      size5=(AvroBagWrapper)tw.get(0);
    }
  }
  assertEquals(0,size0.size());
  assertEquals(1,size1.size());
  assertEquals(5,size5.size());
  assertTrue(size0.compareTo(size0) == 0);
  assertTrue(size0.compareTo(size1) < 0);
  assertTrue(size0.compareTo(size5) < 0);
  assertTrue(size1.compareTo(size0) > 0);
  assertTrue(size1.compareTo(size5) > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestCurrentTime </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllCurrentTimeSame() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> justSomeRows=Lists.newArrayList();
  for (int i=0; i < 1000; i++) {
    justSomeRows.add(tuple(i));
  }
  data.set("justSomeRows",justSomeRows);
  pigServer.registerQuery("A = load 'justSomeRows' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate CurrentTime();");
  pigServer.registerQuery("C = foreach (group B by $0) generate COUNT($1);");
  Iterator<Tuple> it=pigServer.openIterator("C");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals(1000L,t.get(0));
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestInvokerGenerator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcat() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> inputs=ImmutableSet.of(tuple("a"),tuple("b"),tuple("c"));
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : inputs) {
    String str=(String)t.get(0);
    expected.add(tuple(str.concat(str)));
  }
  data.set("foo",Utils.getSchemaFromString("x:chararray"),inputs);
  pigServer.registerQuery("define concat InvokerGenerator('java.lang.String','concat','String');");
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate concat($0, $0);");
  pigServer.registerQuery("store b into 'bar' using mock.Storage();");
  List<Tuple> results=data.get("bar");
  assertEquals(expected.size(),results.size());
  for (  Tuple t : results) {
    assertTrue(expected.remove(t));
  }
  assertEquals(0,expected.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueOf() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> inputs=Sets.newHashSet();
  while (inputs.size() < 1000) {
    inputs.add(tuple(Integer.toString(r.nextInt())));
  }
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : inputs) {
    String str=(String)t.get(0);
    expected.add(tuple(Integer.valueOf(str)));
  }
  data.set("foo",Utils.getSchemaFromString("x:chararray"),inputs);
  pigServer.registerQuery("define valueOf InvokerGenerator('java.lang.Integer','valueOf','String');");
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate valueOf($0);");
  pigServer.registerQuery("store b into 'bar' using mock.Storage();");
  List<Tuple> results=data.get("bar");
  assertEquals(expected.size(),results.size());
  for (  Tuple t : results) {
    assertTrue(expected.remove(t));
  }
  assertEquals(0,expected.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJoinWithPruning() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "orc-file-11-format.orc'"+ " using OrcStorage();");
  pigServer.registerQuery("B = foreach A generate int1, string1;");
  pigServer.registerQuery("C = order B by int1;");
  pigServer.registerQuery("D = limit C 10;");
  pigServer.registerQuery("E = load '" + INPUT1 + "' as (e0:int, e1:chararray);");
  pigServer.registerQuery("F = join D by int1, E by e0;");
  Iterator<Tuple> iter=pigServer.openIterator("F");
  int count=0;
  Tuple t=null;
  while (iter.hasNext()) {
    t=iter.next();
    assertEquals(t.size(),4);
    count++;
  }
  assertEquals(count,10);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadStoreMoreDataType() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "orc-file-11-format.orc'"+ " using OrcStorage();");
  pigServer.registerQuery("B = foreach A generate boolean1..double1, '' as bytes1, string1..;");
  pigServer.store("B",OUTPUT4,"OrcStorage");
  fs.delete(new Path(OUTPUT4,"_SUCCESS"),true);
  pigServer.registerQuery("A = load '" + OUTPUT4 + "' using OrcStorage();");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  Tuple t=iter.next();
  assertTrue(t.toString().startsWith("(false,1,1024,65536,9223372036854775807,1.0,-15.0," + ",hi,({(1,bye),(2,sigh)}),{(3,good),(4,bad)},[],"));
  assertTrue(t.get(12).toString().matches("2000-03-12T15:00:00.000.*"));
  assertTrue(t.toString().endsWith(",12345678.6547456)"));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharVarchar() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "charvarchar.orc'"+ " using OrcStorage();");
  Schema schema=pigServer.dumpSchema("A");
  assertEquals(schema.size(),4);
  assertEquals(schema.getField(0).type,DataType.CHARARRAY);
  assertEquals(schema.getField(1).type,DataType.CHARARRAY);
  Iterator<Tuple> iter=pigServer.openIterator("A");
  int count=0;
  Tuple t=null;
  while (iter.hasNext()) {
    t=iter.next();
    assertEquals(t.size(),4);
    assertTrue(t.get(0) instanceof String);
    assertTrue(t.get(1) instanceof String);
    assertEquals(((String)t.get(1)).length(),20);
    count++;
  }
  assertEquals(count,10000);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiStore() throws Exception {
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + INPUT1 + "' as (a0:int, a1:chararray);");
  pigServer.registerQuery("B = order A by a0;");
  pigServer.registerQuery("store B into '" + OUTPUT2 + "' using OrcStorage();");
  pigServer.registerQuery("store B into '" + OUTPUT3 + "' using OrcStorage('-c SNAPPY');");
  pigServer.executeBatch();
  Path outputFilePath=Util.getFirstPartFile(new Path(OUTPUT2));
  Reader reader=OrcFile.createReader(fs,outputFilePath);
  assertEquals(reader.getNumberOfRows(),2);
  assertEquals(reader.getCompression(),CompressionKind.ZLIB);
  Path outputFilePath2=Util.getFirstPartFile(new Path(OUTPUT3));
  reader=OrcFile.createReader(fs,outputFilePath2);
  assertEquals(reader.getNumberOfRows(),2);
  assertEquals(reader.getCompression(),CompressionKind.SNAPPY);
  verifyData(outputFilePath,outputFilePath2,fs,2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleStore() throws Exception {
  pigServer.registerQuery("A = load '" + INPUT1 + "' as (a0:int, a1:chararray);");
  pigServer.store("A",OUTPUT1,"OrcStorage");
  Reader reader=OrcFile.createReader(fs,Util.getFirstPartFile(new Path(OUTPUT1)));
  assertEquals(reader.getNumberOfRows(),2);
  RecordReader rows=reader.rows(null);
  Object row=rows.next(null);
  StructObjectInspector soi=(StructObjectInspector)reader.getObjectInspector();
  IntWritable intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  Text text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),65536);
  assertEquals(text.toString(),"world");
  row=rows.next(null);
  intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),1);
  assertEquals(text.toString(),"hello");
  fs.delete(new Path(OUTPUT1,"_SUCCESS"),true);
  pigServer.registerQuery("A = load '" + OUTPUT1 + "' using OrcStorage();");
  Schema s=pigServer.dumpSchema("A");
  assertEquals(s.toString(),"{a0: int,a1: chararray}");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  Tuple t=iter.next();
  assertEquals(t.size(),2);
  assertEquals(t.get(0),65536);
  assertEquals(t.get(1),"world");
  t=iter.next();
  assertEquals(t.size(),2);
  assertEquals(t.get(0),1);
  assertEquals(t.get(1),"hello");
  assertFalse(iter.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStoragePushdown </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMatchesExpr() throws Exception {
  String q=query + "b = filter a by name matches 'foo*';" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("name"));
  Assert.assertNull(expr);
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
  q=query + "b = filter a by name matches 'foo*' and srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by srcid == 10 and name matches 'foo*';" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by name matches 'foo*' or srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  Assert.assertNull(expr);
  sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInExpression() throws Exception {
  String q=query + "b = filter a by srcid == 10 or srcid == 11;" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "leaf-1 = (EQUALS srcid 11)\n" + "expr = (or leaf-0 leaf-1)",sarg.toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAndOr() throws Exception {
  String q=query + "b = filter a by (srcid > 10 or dstid <= 5) and name == 'foo' and mrkt is null;" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid","dstid","name","mrkt"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (LESS_THAN_EQUALS srcid 10)\n" + "leaf-1 = (LESS_THAN_EQUALS dstid 5)\n" + "leaf-2 = (EQUALS name foo)\n"+ "leaf-3 = (IS_NULL mrkt)\n"+ "expr = (and (or (not leaf-0) leaf-1) leaf-2 leaf-3)",sarg.toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnSupportedFields() throws Exception {
  String q=query + "b = filter a by srcid == 10 and browser#'type' == 'IE';" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBetweenExpression() throws Exception {
  String q=query + "b = filter a by srcid > 10 or srcid < 20;" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (LESS_THAN_EQUALS srcid 10)\n" + "leaf-1 = (LESS_THAN srcid 20)\n" + "expr = (or (not leaf-0) leaf-1)",sarg.toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimple() throws Exception {
  String q=query + "b = filter a by srcid == 10;" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNot() throws Exception {
  String q=query + "b = filter a by srcid != 10 and mrkt is not null;" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("srcid","dstid","name","mrkt"));
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "leaf-1 = (IS_NULL mrkt)\n" + "expr = (and (not leaf-0) (not leaf-1))",sarg.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestTOMAP </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTOMAP_Bad_BagOfPairs() throws Exception {
  Storage.Data data=resetData(pigServer);
  data.set("foo",tuple("a","b"),tuple("c"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = GROUP A ALL;");
  pigServer.registerQuery("C = FOREACH B GENERATE TOMAP(A);");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(0,out.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTOMAP_Tuple() throws Exception {
  Storage.Data data=resetData(pigServer);
  data.set("foo",tuple("a","b","c","d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() as (a0:chararray, a1:chararray, a2:chararray, a3:chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE TOMAP($0, $1, $2, $3);");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  assertEquals(pigServer.dumpSchema("B").toString(),"{map[chararray]}");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple(map("c","d","a","b")),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTOMAP_Bad_Tuple() throws Exception {
  Storage.Data data=resetData(pigServer);
  data.set("foo",tuple("a","b","c"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE TOMAP($0, $1, $2);");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(0,out.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTOMAP_BagOfPairs() throws Exception {
  Storage.Data data=resetData(pigServer);
  data.set("foo",tuple("a","b"),tuple("c","d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() as (a0:chararray, a1:chararray);");
  pigServer.registerQuery("B = GROUP A ALL;");
  pigServer.registerQuery("C = FOREACH B GENERATE TOMAP(A);");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  assertEquals(pigServer.dumpSchema("C").toString(),"{map[chararray]}");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple(map("a","b","c","d")),out.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestUtf8StorageConverter </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleTypes() throws Exception {
  Utf8StorageConverter converter=new Utf8StorageConverter();
  String schemaString="a:int, b:long, c:float, d:double, e:chararray, f:bytearray, g:boolean, h:biginteger, i:bigdecimal, j:datetime";
  String dataString="(1,2,3.0,4.0,five,6,true,12345678901234567890,1234567890.0987654321,2007-04-05T14:30Z)";
  ResourceSchema.ResourceFieldSchema rfs=new ResourceFieldSchema(new FieldSchema("schema",Utils.getSchemaFromString(schemaString)));
  Tuple result=converter.bytesToTuple(dataString.getBytes(),rfs);
  assertEquals(10,result.size());
  assertEquals(new Integer(1),result.get(0));
  assertEquals(new Long(2L),result.get(1));
  assertEquals(new Float(3.0f),result.get(2));
  assertEquals(new Double(4.0),result.get(3));
  assertEquals("five",result.get(4));
  assertEquals(new DataByteArray(new byte[]{(byte)'6'}),result.get(5));
  assertEquals(new Boolean(true),result.get(6));
  assertEquals(new BigInteger("12345678901234567890"),result.get(7));
  assertEquals(new BigDecimal("1234567890.0987654321"),result.get(8));
  assertEquals(new DateTime("2007-04-05T14:30Z",DateTimeZone.UTC),result.get(9));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.mock.TestMockStorage </h4><pre class="type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMockStoreUnion() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  data.set("input2",tuple("d"),tuple("e"),tuple("f"));
  pigServer.registerQuery("A = LOAD 'input1' USING mock.Storage();");
  pigServer.registerQuery("B = LOAD 'input2' USING mock.Storage();");
  pigServer.registerQuery("C = UNION A, B;");
  pigServer.registerQuery("STORE C INTO 'output' USING mock.Storage();");
  List<Tuple> out=data.get("output");
  assertEquals(out + " size",6,out.size());
  Set<String> set=new HashSet<String>();
  for (  Tuple tuple : out) {
    if (!set.add((String)tuple.get(0))) {
      fail(tuple.get(0) + " is present twice in " + out);
    }
  }
  assertTrue(set + " contains a",set.contains("a"));
  assertTrue(set + " contains b",set.contains("b"));
  assertTrue(set + " contains c",set.contains("c"));
  assertTrue(set + " contains d",set.contains("d"));
  assertTrue(set + " contains e",set.contains("e"));
  assertTrue(set + " contains f",set.contains("f"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMockSchema() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","blah:chararray",tuple("a"),tuple("b"),tuple("c"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE blah as a, blah as b;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  assertEquals(schema("a:chararray,b:chararray"),data.getSchema("bar"));
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a","a"),out.get(0));
  assertEquals(tuple("b","b"),out.get(1));
  assertEquals(tuple("c","c"),out.get(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMockStoreAndLoad() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple("a"),tuple("b"),tuple("c"),tuple(map("d","e","f","g")),tuple(bag(tuple("h"),tuple("i"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("STORE A INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a"),out.get(0));
  assertEquals(tuple("b"),out.get(1));
  assertEquals(tuple("c"),out.get(2));
  assertEquals(tuple(map("f","g","d","e")),out.get(3));
  assertEquals(tuple(bag(tuple("h"),tuple("i"))),out.get(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.data.TestSchemaTuple </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testCompileAndResolve() throws Exception {
  Schema udfSchema=Utils.getSchemaFromString("a:int");
  boolean isAppendable=false;
  GenContext context=GenContext.UDF;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:long");
  isAppendable=true;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:chararray,(a:chararray)");
  isAppendable=false;
  context=GenContext.FOREACH;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:int,(a:int,(a:int,(a:int,(a:int,(a:int,(a:int))))))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("((a:int,b:int),(a:int,b:int),(a:int,b:int)),((a:int,b:int),(a:int,b:int),(a:int,b:int))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=true;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, b:bag{(int,int,int)}");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, m:map[(int,int,int)]");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=new Schema();
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=new Schema(new FieldSchema(null,DataType.BAG));
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  SchemaTupleFrontend.copyAllGeneratedToDistributedCache(pigContext,conf);
  SchemaTupleBackend.initialize(conf,pigContext);
  udfSchema=Utils.getSchemaFromString("a:int");
  isAppendable=false;
  context=GenContext.UDF;
  SchemaTupleFactory tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  context=GenContext.MERGE_JOIN;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:long");
  context=GenContext.UDF;
  isAppendable=true;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:chararray,(a:chararray)");
  isAppendable=false;
  context=GenContext.FOREACH;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("(a:chararray)");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:int,(a:int,(a:int,(a:int,(a:int,(a:int,(a:int))))))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("((a:int,b:int),(a:int,b:int),(a:int,b:int)),((a:int,b:int),(a:int,b:int),(a:int,b:int))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=true;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, b:bag{(int,int,int)}");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, m:map[(int,int,int)]");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=new Schema();
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  isAppendable=false;
  udfSchema=new Schema(new FieldSchema(null,DataType.BAG));
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.builtin.TestStreamingUDF </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'c:chararray\')","def py_func(one,two):","   return one + two"};
  Util.createLocalInputFile("pyfile.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(2);
  t0.set(0,"field10");
  t0.set(1,"field11");
  Tuple t1=tf.newTuple(2);
  t1.set(0,"field20");
  t1.set(1,"field21");
  data.set("testTuples","c1:chararray,c2:chararray",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'pyfile.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("A = LOAD 'testTuples' USING mock.Storage();");
  pigServerLocal.registerQuery("B = FOREACH A generate pf.py_func(c1, c2);");
  pigServerLocal.registerQuery("STORE B INTO 'out' USING mock.Storage();");
  Tuple expected0=tf.newTuple("field10field11");
  Tuple expected1=tf.newTuple("field20field21");
  List<Tuple> out=data.get("out");
  assertEquals(expected0,out.get(0));
  assertEquals(expected1,out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF__withDateTime() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'d:datetime\')","def py_func(dt):","   return dt"};
  Util.createLocalInputFile("pyfile_dt.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(new DateTime());
  Tuple t1=tf.newTuple(new DateTime());
  data.set("testDateTuples","d:datetime",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'pyfile_dt.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("A = LOAD 'testDateTuples' USING mock.Storage();");
  pigServerLocal.registerQuery("B = FOREACH A generate pf.py_func(d);");
  pigServerLocal.registerQuery("STORE B INTO 'date_out' USING mock.Storage();");
  List<Tuple> out=data.get("date_out");
  assertEquals(t0,out.get(0));
  assertEquals(t1,out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF__allTypes() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"# -*- coding: utf-8 -*-","from pig_util import outputSchema","import sys","","@outputSchema('tuple_output:tuple(nully:chararray, inty:int, longy:long, floaty:float, doubly:double, chararrayy:chararray, utf_chararray_basic_string:chararray, utf_chararray_unicode:chararray, bytearrayy:bytearray)')","def get_tuple_output():","    result = (None, 32, 1000000099990000L, 32.0, 3200.1234678509, 'Some String', 'Hello\\u2026Hello', u'Hello\\u2026Hello', b'Some Byte Array')","    return result","","@outputSchema('tuple_output:tuple(nully:chararray, inty:int, longy:long, floaty:float, doubly:double, chararrayy:chararray, utf_chararray_basic_string:chararray, utf_chararray_unicode:chararray, bytearrayy:bytearray)')","def crazy_tuple_identity(ct):","    print ct","    return ct","","@outputSchema('mappy:map[]')","def add_map():","    return {u'Weird\\u2026Name' : u'Weird \\u2026 Value',","            'SomeNum'          : 32,","            'Simple Name'      : 'Simple Value' }","","","@outputSchema('silly:chararray')","def silly(silly_word):","    print silly_word.encode('utf-8')","    return silly_word","","","@outputSchema('final_output:bag{t:tuple(user_id:chararray,age:int,tuple_output:tuple(nully:chararray,inty:int,longy:long,floaty:float,doubly:double,chararrayy:chararray,utf_chararray_basic_string:chararray,utf_chararray_unicode:chararray,bytearrayy:bytearray),mappy:map[],silly:chararray)}')","def bag_identity(bag):","    return bag"};
  Util.createLocalInputFile("allfile.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(2);
  t0.set(0,"user1");
  t0.set(1,10);
  Tuple t1=tf.newTuple(2);
  t1.set(0,"user2");
  t1.set(1,11);
  data.set("userTuples","user_id:chararray,age:int",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'allfile.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("users = LOAD 'userTuples' USING mock.Storage();");
  pigServerLocal.registerQuery("crazy_tuple = FOREACH users GENERATE user_id, age, pf.get_tuple_output();");
  pigServerLocal.registerQuery("crazy_tuple_fun = FOREACH crazy_tuple GENERATE user_id, age, pf.crazy_tuple_identity(tuple_output);");
  pigServerLocal.registerQuery("crazy_tuple_with_map = FOREACH crazy_tuple_fun GENERATE user_id, age, tuple_output, pf.add_map(), pf.silly('\u2026');");
  pigServerLocal.registerQuery("crazy_group = GROUP crazy_tuple_with_map BY (age);");
  pigServerLocal.registerQuery("out = FOREACH crazy_group GENERATE group, pf.bag_identity(crazy_tuple_with_map);");
  pigServerLocal.registerQuery("STORE out INTO 'all_out' USING mock.Storage();");
  List<Tuple> out=data.get("all_out");
  DataBag bag=(DataBag)out.get(0).get(1);
  assertEquals(1,bag.size());
  Tuple innerTuple=bag.iterator().next();
  assertEquals(5,innerTuple.size());
  assertEquals("Hello\\u2026Hello",((Tuple)innerTuple.get(2)).get(6));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPythonUDF_withBytearrayAndBytes_onCluster() throws Exception {
  pigServerMapReduce=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] pythonScript={"from pig_util import outputSchema","import os","@outputSchema('f:bytearray')","def foo(bar):","    return bytearray(os.urandom(1000))"};
  Util.createLocalInputFile("pyfilewBaB.py",pythonScript);
  String[] input={"field1"};
  Util.createLocalInputFile("testTupleBaB",input);
  Util.copyFromLocalToCluster(cluster,"testTupleBaB","testTupleBaB");
  pigServerMapReduce.registerQuery("REGISTER 'pyfilewBaB.py' USING streaming_python AS pf;");
  pigServerMapReduce.registerQuery("A = LOAD 'testTupleBaB' as (b:chararray);");
  pigServerMapReduce.registerQuery("B = FOREACH A generate pf.foo(b);");
  Iterator<Tuple> iter=pigServerMapReduce.openIterator("B");
  assertTrue(iter.hasNext());
  Object result=iter.next().get(0);
  assertTrue(result instanceof DataByteArray);
  assertEquals(1000,((DataByteArray)result).size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF__withBigInteger() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'biout:biginteger\')","def py_func(bi):","   return bi"};
  Util.createLocalInputFile("pyfile_bi.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(new BigInteger("123456789012345678901234567890"));
  Tuple t1=tf.newTuple(new BigInteger("9123456789012345678901234567890"));
  data.set("testBiTuples","bi:biginteger",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'pyfile_bi.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("A = LOAD 'testBiTuples' USING mock.Storage();");
  pigServerLocal.registerQuery("B = FOREACH A generate pf.py_func(bi);");
  pigServerLocal.registerQuery("STORE B INTO 'bi_out' USING mock.Storage();");
  List<Tuple> out=data.get("bi_out");
  assertEquals(t0,out.get(0));
  assertEquals(t1,out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF__withBigDecimal() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'bdout:bigdecimal\')","def py_func(bd):","   return bd"};
  Util.createLocalInputFile("pyfile_bd.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(new BigDecimal("123456789012345678901234567890.12345"));
  Tuple t1=tf.newTuple(new BigDecimal("9123456789012345678901234567890.12345"));
  data.set("testBdTuples","bd:bigdecimal",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'pyfile_bd.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("A = LOAD 'testBdTuples' USING mock.Storage();");
  pigServerLocal.registerQuery("B = FOREACH A generate pf.py_func(bd);");
  pigServerLocal.registerQuery("STORE B INTO 'bd_out' USING mock.Storage();");
  List<Tuple> out=data.get("bd_out");
  Float e0=((BigDecimal)t0.get(0)).floatValue();
  Float e1=((BigDecimal)t1.get(0)).floatValue();
  assertEquals(e0,((BigDecimal)out.get(0).get(0)).floatValue(),0.1);
  assertEquals(e1,((BigDecimal)out.get(1).get(0)).floatValue(),0.1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPythonUDF_onCluster() throws Exception {
  pigServerMapReduce=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'c:chararray\')","def py_func(one,two):","   return one + two"};
  Util.createLocalInputFile("pyfile_mr.py",pythonScript);
  String[] input={"field10\tfield11","field20\tfield21"};
  Util.createLocalInputFile("input_mr",input);
  Util.copyFromLocalToCluster(cluster,"input_mr","input_mr");
  pigServerMapReduce.registerQuery("REGISTER 'pyfile_mr.py' USING streaming_python AS pf;");
  pigServerMapReduce.registerQuery("A = LOAD 'input_mr' as (c1:chararray, c2:chararray);");
  pigServerMapReduce.registerQuery("B = FOREACH A generate pf.py_func(c1, c2);");
  Iterator<Tuple> iter=pigServerMapReduce.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple actual0=iter.next();
  assertTrue(iter.hasNext());
  Tuple actual1=iter.next();
  Tuple expected0=tf.newTuple("field10field11");
  Tuple expected1=tf.newTuple("field20field21");
  assertEquals(expected0,actual0);
  assertEquals(expected1,actual1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPythonUDF_withNewline() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'c:chararray\')","def py_func(one,two):","   return '%s\\n%s' % (one,two)"};
  Util.createLocalInputFile("pyfileNL.py",pythonScript);
  Data data=resetData(pigServerLocal);
  Tuple t0=tf.newTuple(2);
  t0.set(0,"field10");
  t0.set(1,"field11");
  Tuple t1=tf.newTuple(2);
  t1.set(0,"field20");
  t1.set(1,"field21");
  data.set("testTuplesNL","c1:chararray,c2:chararray",t0,t1);
  pigServerLocal.registerQuery("REGISTER 'pyfileNL.py' USING streaming_python AS pf;");
  pigServerLocal.registerQuery("A = LOAD 'testTuplesNL' USING mock.Storage();");
  pigServerLocal.registerQuery("B = FOREACH A generate pf.py_func(c1, c2);");
  pigServerLocal.registerQuery("STORE B INTO 'outNL' USING mock.Storage();");
  Tuple expected0=tf.newTuple("field10\nfield11");
  Tuple expected1=tf.newTuple("field20\nfield21");
  List<Tuple> out=data.get("outNL");
  assertEquals(expected0,out.get(0));
  assertEquals(expected1,out.get(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.streaming.TestPigStreamingUDF </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__datetime() throws IOException {
  DateTime dt=new DateTime();
  Tuple t=tf.newTuple(1);
  t.set(0,dt);
  byte[] expectedOutput=("T" + ISODateTimeFormat.dateTime().print(dt) + "|_\n").getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDeserialize__bag() throws IOException {
  byte[] input="|{_|(_A|,_1|)_|,_|(_B|,_2|)_|}_|_".getBytes();
  FieldSchema f1Inner=new FieldSchema("",DataType.CHARARRAY);
  FieldSchema f2Inner=new FieldSchema("",DataType.INTEGER);
  List<FieldSchema> fslInner=new ArrayList<FieldSchema>();
  fslInner.add(f1Inner);
  fslInner.add(f2Inner);
  Schema schemaInner=new Schema(fslInner);
  FieldSchema fsInner=new FieldSchema("",schemaInner,DataType.TUPLE);
  List<FieldSchema> fsl=new ArrayList<FieldSchema>();
  fsl.add(fsInner);
  Schema schema=new Schema(fsl);
  FieldSchema fs=new FieldSchema("",schema,DataType.BAG);
  PigStreamingUDF sp=new PigStreamingUDF(fs);
  Tuple expectedOutputInner1=tf.newTuple(2);
  expectedOutputInner1.set(0,"A");
  expectedOutputInner1.set(1,1);
  Tuple expectedOutputInner2=tf.newTuple(2);
  expectedOutputInner2.set(0,"B");
  expectedOutputInner2.set(1,2);
  List<Tuple> tuples=new ArrayList<Tuple>();
  tuples.add(expectedOutputInner1);
  tuples.add(expectedOutputInner2);
  DataBag expectedOutput=DefaultBagFactory.getInstance().newDefaultBag(tuples);
  Object out=sp.deserialize(input,0,input.length);
  Assert.assertEquals(tf.newTuple(expectedOutput),out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.streaming.TestStreamingUtil </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddJobConfToEnv(){
  StringBuilder streamingEnv=null;
  Configuration conf=new Configuration();
  Map<String,String> all=Maps.newHashMap();
  for (int i=0; i < 10000; i++) {
    String key=RandomStringUtils.randomAlphanumeric(10);
    String value=RandomStringUtils.randomAlphanumeric(10);
    all.put(key,value);
  }
  Map<String,String> toInclude=Maps.newHashMap();
  for (  Map.Entry<String,String> entry : all.entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    conf.set(key,value);
    if (r.nextDouble() < .5) {
      toInclude.put(key,value);
      if (streamingEnv == null) {
        streamingEnv=new StringBuilder();
      }
 else {
        streamingEnv.append(",");
      }
      streamingEnv.append(key);
    }
  }
  conf.set(PIG_STREAMING_ENVIRONMENT,streamingEnv.toString());
  Map<String,String> env=new HashMap<String,String>();
  StreamingUtil.addJobConfToEnvironment(conf,env);
  for (  Map.Entry<String,String> entry : env.entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    String value2=toInclude.remove(key);
    assertEquals("Key [" + key + "] should be set in environment",value,value2);
  }
  assertTrue("There should be no remaining pairs in the included map",toInclude.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.newplan.logical.optimizer.TestImplicitSplitOnTuple </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitterOnTuple() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=Storage.resetData(pigServer);
  data.set("input",tuple("1","1001","101"),tuple("1","1002","103"),tuple("1","1003","102"),tuple("1","1004","102"),tuple("2","1005","101"),tuple("2","1003","101"),tuple("2","1002","123"),tuple("3","1042","101"),tuple("3","1005","101"),tuple("3","1002","133"));
  pigServer.registerQuery("inp = LOAD 'input' USING mock.Storage() AS (memberId:long, shopId:long, score:int);" + "tuplified = FOREACH inp GENERATE (memberId, shopId) AS tuplify, score;" + "D1 = FOREACH tuplified GENERATE tuplify.memberId as memberId, tuplify.shopId as shopId, score AS score;"+ "D2 = FOREACH tuplified GENERATE tuplify.memberId as memberId, tuplify.shopId as shopId, score AS score;"+ "J = JOIN D1 By shopId, D2 by shopId;"+ "K = FOREACH J GENERATE D1::memberId AS member_id1, D2::memberId AS member_id2, D1::shopId as shop;"+ "L = ORDER K by shop, member_id1, member_id2;"+ "STORE L into 'output' using mock.Storage;");
  List<Tuple> list=data.get("output");
  assertEquals("list: " + list,20,list.size());
  assertEquals("(1,1,1001)",list.get(0).toString());
  assertEquals("(1,1,1002)",list.get(1).toString());
  assertEquals("(1,2,1002)",list.get(2).toString());
  assertEquals("(1,3,1002)",list.get(3).toString());
  assertEquals("(2,1,1002)",list.get(4).toString());
  assertEquals("(2,2,1002)",list.get(5).toString());
  assertEquals("(2,3,1002)",list.get(6).toString());
  assertEquals("(3,1,1002)",list.get(7).toString());
  assertEquals("(3,2,1002)",list.get(8).toString());
  assertEquals("(3,3,1002)",list.get(9).toString());
  assertEquals("(1,1,1003)",list.get(10).toString());
  assertEquals("(1,2,1003)",list.get(11).toString());
  assertEquals("(2,1,1003)",list.get(12).toString());
  assertEquals("(2,2,1003)",list.get(13).toString());
  assertEquals("(1,1,1004)",list.get(14).toString());
  assertEquals("(2,2,1005)",list.get(15).toString());
  assertEquals("(2,3,1005)",list.get(16).toString());
  assertEquals("(3,2,1005)",list.get(17).toString());
  assertEquals("(3,3,1005)",list.get(18).toString());
  assertEquals("(3,3,1042)",list.get(19).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.newplan.logical.optimizer.TestSchemaResetter </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSchemaResetterExec() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=Storage.resetData(pigServer);
  data.set("input",tuple(tuple("1","2")),tuple(tuple("2","3")),tuple(tuple("2","4")));
  pigServer.registerQuery("A = LOAD 'input' USING mock.Storage() AS (group:tuple(uid, dst_id));" + "edges_both = FOREACH A GENERATE" + "    group.uid AS src_id,"+ "    group.dst_id AS dst_id;"+ "both_counts = GROUP edges_both BY src_id;"+ "both_counts = FOREACH both_counts GENERATE"+ "    group AS src_id, SIZE(edges_both) AS size_both;"+ "edges_bq = FOREACH A GENERATE"+ "    group.uid AS src_id,"+ "    group.dst_id AS dst_id;"+ "bq_counts = GROUP edges_bq BY src_id;"+ "bq_counts = FOREACH bq_counts GENERATE"+ "    group AS src_id, SIZE(edges_bq) AS size_bq;"+ "per_user_set_sizes = JOIN bq_counts BY src_id LEFT OUTER, both_counts BY src_id;"+ "store per_user_set_sizes into 'output' USING mock.Storage();");
  List<Tuple> list=data.get("output");
  Collections.sort(list);
  assertEquals("list: " + list,2,list.size());
  assertEquals("(1,1,1,1)",list.get(0).toString());
  assertEquals("(2,2,2,2)",list.get(1).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.newplan.logical.relational.TestLocationInPhysicalPlan </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  File input=File.createTempFile("test","input");
  input.deleteOnExit();
  File output=File.createTempFile("test","output");
  output.delete();
  Util.createLocalInputFile(input.getAbsolutePath(),new String[]{"1,2,3","1,1,3","1,1,1","3,1,1","1,2,1"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(input.getAbsolutePath()) + "' using PigStorage();\n"+ "B = GROUP A BY $0;\n"+ "A = FOREACH B GENERATE COUNT(A);\n"+ "STORE A INTO '"+ Util.encodeEscape(output.getAbsolutePath())+ "';");
  ExecJob job=pigServer.executeBatch().get(0);
  List<OriginalLocation> originalLocations=job.getPOStore().getOriginalLocations();
  Assert.assertEquals(1,originalLocations.size());
  OriginalLocation originalLocation=originalLocations.get(0);
  Assert.assertEquals(4,originalLocation.getLine());
  Assert.assertEquals(0,originalLocation.getOffset());
  Assert.assertEquals("A",originalLocation.getAlias());
  JobStats jStats=(JobStats)job.getStatistics().getJobGraph().getSinks().get(0);
  if (Util.getLocalTestMode().toString().equals("TEZ_LOCAL")) {
    Assert.assertEquals("A[1,4],A[3,4],B[2,4]",jStats.getAliasLocation());
  }
 else {
    Assert.assertEquals("M: A[1,4],A[3,4],B[2,4] C: A[3,4],B[2,4] R: A[3,4]",jStats.getAliasLocation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestAstValidator </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify if default data type is inserted.
 */
@Test public void testDefaultDataTypeInsertion() throws IOException, RecognitionException {
  CharStream input=new QueryParserFileStream("test/org/apache/pig/parser/TestDefaultDataTypeInserter.pig");
  QueryLexer lex=new QueryLexer(input);
  CommonTokenStream tokens=new CommonTokenStream(lex);
  QueryParser parser=QueryParserUtils.createParser(tokens);
  QueryParser.query_return result=parser.query();
  Tree ast=(Tree)result.getTree();
  System.out.println(ast.toStringTree());
  TreePrinter.printTree((CommonTree)ast,0);
  CommonTreeNodeStream nodes=new CommonTreeNodeStream(ast);
  AstValidator walker=new AstValidator(nodes);
  AstValidator.query_return newResult=walker.query();
  Assert.assertEquals(0,walker.getNumberOfSyntaxErrors());
  ast=(Tree)newResult.getTree();
  validateDataTypePresent((CommonTree)ast);
  TreePrinter.printTree((CommonTree)ast,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelationAliasInNestedForeachWhereUnspecified() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> values=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    values.add(tuple(i % 3 == 0 ? null : "a","b"));
  }
  data.set("foo",values);
  pigServer.registerQuery("raw_data = load 'foo' using mock.Storage() as (field_a:chararray, field_b:chararray);");
  pigServer.registerQuery("records = foreach raw_data {" + "  generated_field = (field_a is null ? '-' : field_b);" + "  GENERATE"+ "    field_a,"+ "    field_b,"+ "    generated_field; }");
  pigServer.registerQuery("use_records = foreach records generate generated_field, CONCAT(generated_field,generated_field);");
  Schema expectedSchema=Utils.getSchemaFromString("field_a:chararray, field_b:chararray, generated_field:chararray");
  assertEquals(expectedSchema,pigServer.dumpSchema("records"));
  for (Iterator<Tuple> it=pigServer.openIterator("records"); it.hasNext(); ) {
    Tuple t=it.next();
    String a=(String)t.get(0);
    String b=(String)t.get(1);
    assertEquals("b",b);
    if (a == null) {
      assertEquals("-",t.get(2));
    }
 else {
      assertEquals("a",a);
      assertEquals(b,t.get(2));
    }
  }
  for (Iterator<Tuple> it=pigServer.openIterator("use_records"); it.hasNext(); ) {
    Tuple t=it.next();
    String x=(String)t.get(0);
    assertEquals(x + x,t.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNagative7() throws IOException {
  File f1=new File("myscript.pig");
  f1.deleteOnExit();
  FileWriter fw1=new FileWriter(f1);
  fw1.append("A = loadd '1.txt';");
  fw1.close();
  String[] args={"-x","local","-c","myscript.pig"};
  PigStats stats=PigRunner.run(args,null);
  Assert.assertFalse(stats.isSuccessful());
  String expected="<file myscript.pig, line 1, column 0>";
  String msg=stats.getErrorMessage();
  Assert.assertFalse(msg == null);
  Assert.assertTrue(msg.startsWith(expected));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testBagType() throws IOException, RecognitionException {
  String query="a = load '1.txt' as ( u : bag{}, v : bag{tuple(x, y)} );" + "b = load '2.x' as ( t : {}, u : {(r,s)}, v : bag{ T : tuple( x, y ) }, w : bag{(z1, z2)} );" + "c = load '3.x' as p : int;";
  int errorCount=parse(query);
  Assert.assertTrue(errorCount == 0);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFlatten() throws IOException, RecognitionException {
  String query="a = load '1.txt' as ( u, v, w : int );" + "b = foreach a generate * as ( x, y, z ), flatten( u ) as ( r, s ), flatten( v ) as d, w + 5 as e:int;";
  int errorCount=parse(query);
  Assert.assertTrue(errorCount == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestScalarVisitor </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3() throws Exception, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:tuple(x:int, y:chararray), v:long, w:bytearray);\n" + "B = load 'y';\n" + "C = foreach B generate $0, A.u.x;\n"+ "D = store C into 'output';";
  LogicalPlan plan=visit(query);
  Assert.assertEquals(2,plan.getSources().size());
  Assert.assertEquals(2,plan.getSinks().size());
  System.out.println("New Logical Plan after scalar processing: " + plan);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.v, $0; "+ "D = store C into 'output';";
  LogicalPlan plan=visit(query);
  Assert.assertEquals(2,plan.getSources().size());
  Assert.assertEquals(2,plan.getSinks().size());
  System.out.println("New Logical Plan after scalar processing: " + plan);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.$1, $0; "+ "D = store C into 'output';";
  LogicalPlan plan=visit(query);
  Assert.assertEquals(2,plan.getSources().size());
  Assert.assertEquals(2,plan.getSinks().size());
  System.out.println("New Logical Plan after scalar processing: " + plan);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestUnionOnSchemaSetter </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeCompatibleSchema() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:int); " + "B = load 'y' as ( u:int, v:long, w:long); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc + 1,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:int, z:long); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nodeCount=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nodeCount + 2,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:int, w:bytearray); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc + 1,plan.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3() throws FrontendException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = load 'y' as ( u:int, v:long, w:bytearray); " + "C = union onschema A, B; "+ "D = store C into 'output';";
  LogicalPlan plan=generateLogicalPlan(query);
  if (plan != null) {
    int nc=plan.size();
    UnionOnSchemaSetter visitor=new UnionOnSchemaSetter(plan);
    visitor.visit();
    System.out.println("Plan after setter: " + plan.toString());
    Assert.assertEquals(nc,plan.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestOver </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDenseRankWithMultiKey() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  t.set(2,"a");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  t.set(2,"b");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,2);
  t.set(1,r.nextInt(100));
  t.set(2,"b");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t.set(2,"b");
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  t.set(2,"c");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  t.set(2,"c");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,7);
  t.set(1,r.nextInt(100));
  t.set(2,"z");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(6);
  t.set(0,inbag);
  t.set(1,"dense_rank");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,0);
  t.set(5,2);
  DataBag outbag=func.exec(t);
  assertEquals(7,outbag.size());
  Iterator<Tuple> iter=outbag.iterator();
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(2,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
  t=iter.next();
  assertEquals(5,t.get(0));
  t=iter.next();
  assertEquals(5,t.get(0));
  t=iter.next();
  assertEquals(6,t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPercentRankWithRepeatValues() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,2);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,7);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"percent_rank");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,0);
  DataBag outbag=func.exec(t);
  assertEquals(7,outbag.size());
  Iterator<Tuple> iter=outbag.iterator();
  t=iter.next();
  assertEquals(0.0,t.get(0));
  t=iter.next();
  assertEquals(0.0,t.get(0));
  t=iter.next();
  assertEquals(0.3333333333333333,t.get(0));
  t=iter.next();
  assertEquals(0.5,t.get(0));
  t=iter.next();
  assertEquals(0.5,t.get(0));
  t=iter.next();
  assertEquals(0.5,t.get(0));
  t=iter.next();
  assertEquals(1.0,t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRankWithRepeatValues() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,2);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,7);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"rank");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,0);
  DataBag outbag=func.exec(t);
  assertEquals(7,outbag.size());
  Iterator<Tuple> iter=outbag.iterator();
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
  t=iter.next();
  assertEquals(7,t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDenseRankWithRepeatValues() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,2);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(2);
  t.set(0,7);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"dense_rank");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,0);
  DataBag outbag=func.exec(t);
  assertEquals(7,outbag.size());
  Iterator<Tuple> iter=outbag.iterator();
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(2,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRankWithMultiKey() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  Random r=new Random();
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  t.set(2,"a");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,null);
  t.set(1,r.nextInt(100));
  t.set(2,"b");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,2);
  t.set(1,r.nextInt(100));
  t.set(2,"b");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  inbag.add(t);
  t.set(2,"b");
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  t.set(2,"c");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,5);
  t.set(1,r.nextInt(100));
  t.set(2,"c");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(3);
  t.set(0,7);
  t.set(1,r.nextInt(100));
  t.set(2,"z");
  inbag.add(t);
  t=TupleFactory.getInstance().newTuple(6);
  t.set(0,inbag);
  t.set(1,"rank");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,0);
  t.set(5,2);
  DataBag outbag=func.exec(t);
  assertEquals(7,outbag.size());
  Iterator<Tuple> iter=outbag.iterator();
  t=iter.next();
  assertEquals(1,t.get(0));
  t=iter.next();
  assertEquals(2,t.get(0));
  t=iter.next();
  assertEquals(3,t.get(0));
  t=iter.next();
  assertEquals(4,t.get(0));
  t=iter.next();
  assertEquals(5,t.get(0));
  t=iter.next();
  assertEquals(5,t.get(0));
  t=iter.next();
  assertEquals(7,t.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestStitch </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleInput() throws Exception {
  Stitch func=new Stitch();
  DataBag b1=BagFactory.getInstance().newDefaultBag();
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append("a");
  t.append("b");
  b1.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append("c");
  t.append("d");
  b1.add(t);
  DataBag b2=BagFactory.getInstance().newDefaultBag();
  t=TupleFactory.getInstance().newTuple();
  t.append("1");
  t.append("2");
  b2.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append("3");
  t.append("4");
  b2.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append(b1);
  t.append(b2);
  DataBag out=func.exec(t);
  assertEquals(2,out.size());
  Iterator<Tuple> iter=out.iterator();
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("a",t.get(0));
  assertEquals("b",t.get(1));
  assertEquals("1",t.get(2));
  assertEquals("2",t.get(3));
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("c",t.get(0));
  assertEquals("d",t.get(1));
  assertEquals("3",t.get(2));
  assertEquals("4",t.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSecondShort() throws Exception {
  Stitch func=new Stitch();
  DataBag b1=BagFactory.getInstance().newDefaultBag();
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append("a");
  t.append("b");
  b1.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append("c");
  t.append("d");
  b1.add(t);
  DataBag b2=BagFactory.getInstance().newDefaultBag();
  t=TupleFactory.getInstance().newTuple();
  t.append("1");
  t.append("2");
  b2.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append(b1);
  t.append(b2);
  DataBag out=func.exec(t);
  assertEquals(2,out.size());
  Iterator<Tuple> iter=out.iterator();
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("a",t.get(0));
  assertEquals("b",t.get(1));
  assertEquals("1",t.get(2));
  assertEquals("2",t.get(3));
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("c",t.get(0));
  assertEquals("d",t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFirstShort() throws Exception {
  Stitch func=new Stitch();
  DataBag b1=BagFactory.getInstance().newDefaultBag();
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append("a");
  t.append("b");
  b1.add(t);
  DataBag b2=BagFactory.getInstance().newDefaultBag();
  t=TupleFactory.getInstance().newTuple();
  t.append("1");
  t.append("2");
  b2.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append("3");
  t.append("4");
  b2.add(t);
  t=TupleFactory.getInstance().newTuple();
  t.append(b1);
  t.append(b2);
  DataBag out=func.exec(t);
  assertEquals(1,out.size());
  Iterator<Tuple> iter=out.iterator();
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("a",t.get(0));
  assertEquals("b",t.get(1));
  assertEquals("1",t.get(2));
  assertEquals("2",t.get(3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.TestEvalString </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLASTINDEXOF() throws Exception {
  LASTINDEXOF func=new LASTINDEXOF();
  List l=new LinkedList();
  l.add("Hello World!");
  l.add("o");
  Tuple input=DefaultTupleFactory.getInstance().newTuple(l);
  Integer output=func.exec(input);
  assertTrue(output.intValue() == 7);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testREPLACE() throws Exception {
  REPLACE func=new REPLACE();
  List l=new LinkedList();
  l.add("Hello World!");
  l.add("o");
  l.add("a");
  String expected="Hella Warld!";
  Tuple input=DefaultTupleFactory.getInstance().newTuple(l);
  String output=func.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testINDEXOF() throws Exception {
  INDEXOF func=new INDEXOF();
  List l=new LinkedList();
  l.add("Hello World!");
  l.add("o");
  Tuple input=DefaultTupleFactory.getInstance().newTuple(l);
  Integer output=func.exec(input);
  assertTrue(output.intValue() == 4);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSUBSTRING() throws Exception {
  SUBSTRING func=new SUBSTRING();
  List l=new LinkedList();
  l.add("Hello World!");
  l.add(1);
  l.add(5);
  String expected="ello";
  Tuple input=DefaultTupleFactory.getInstance().newTuple(l);
  String output=func.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLOWER() throws Exception {
  LOWER func=new LOWER();
  String in="Hello World!";
  String expected="hello world!";
  Tuple input=DefaultTupleFactory.getInstance().newTuple(in);
  String output=func.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUPPER() throws Exception {
  UPPER func=new UPPER();
  String in="Hello World!";
  String expected="HELLO WORLD!";
  Tuple input=DefaultTupleFactory.getInstance().newTuple(in);
  String output=func.exec(input);
  assertTrue(output.equals(expected));
  String in2=null;
  Tuple input2=DefaultTupleFactory.getInstance().newTuple(in2);
  assertEquals("upper null value",null,func.exec(input2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestLookupInFiles </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLookupInFiles() throws Exception {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile));
  ps1.println("one");
  ps1.println("notexist");
  ps1.println("three");
  ps1.close();
  File lookupFile1=File.createTempFile("lookup",".txt");
  PrintStream lps1=new PrintStream(new FileOutputStream(lookupFile1));
  lps1.println("one");
  lps1.println("two");
  lps1.println("three");
  lps1.close();
  File lookupFile2=File.createTempFile("lookup","txt");
  PrintStream lps2=new PrintStream(new FileOutputStream(lookupFile2));
  lps2.println("one");
  lps2.println("ten");
  lps2.println("eleven");
  lps2.close();
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pigServer.getPigContext().getProperties()));
  fs.copyFromLocalFile(new Path(lookupFile1.toString()),new Path("lookup1"));
  fs.copyFromLocalFile(new Path(lookupFile1.toString()),new Path("lookup2"));
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (key:chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE org.apache.pig.piggybank.evaluation.string.LookupInFiles(key, 'lookup1', 'lookup2');");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  int r=(Integer)iter.next().get(0);
  assertTrue(r == 1);
  r=(Integer)iter.next().get(0);
  assertTrue(r == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestReplaceMulti </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testReplaceMultiUDF() throws Exception {
  Tuple input;
  String output;
  String inputStr="Hello World!";
  String expected="Halloo_Woorld";
  List list=new LinkedList();
  EvalFunc<String> strFunc=new REPLACE_MULTI();
  list.add(inputStr);
  Map<String,String> map=new HashMap<String,String>();
  map.put(" ","_");
  map.put("e","a");
  map.put("!","");
  map.put("o","oo");
  list.add(map);
  input=TupleFactory.getInstance().newTuple(list);
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDF() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE REPLACE_MULTI(name, [' '#'_','e'#'a','o'#'oo','!'#'']);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals("Halloo_Woorld",t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSearchReplacementMapNullToReplaceMultiUDF() throws Exception {
  Tuple input;
  String output;
  String inputStr="Hello World!";
  String expected="Hello World!";
  List list=new LinkedList();
  EvalFunc<String> strFunc=new REPLACE_MULTI();
  list.add(inputStr);
  Map<String,String> map=null;
  list.add(map);
  input=TupleFactory.getInstance().newTuple(list);
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDFNullParameters() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE org.apache.pig.piggybank.evaluation.string.REPLACE_MULTI(NULL, NULL);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNullSourceStringToReplaceMultiUDF() throws Exception {
  Tuple input;
  String output;
  String inputStr=null;
  List list=new LinkedList();
  EvalFunc<String> strFunc=new REPLACE_MULTI();
  list.add(inputStr);
  Map<String,String> map=new HashMap<String,String>();
  list.add(map);
  input=TupleFactory.getInstance().newTuple(list);
  output=strFunc.exec(input);
  assertNull(output);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDFNullMap() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE REPLACE_MULTI(name, NULL);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals(inputStr,t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyMapToReplaceMultiUDF() throws Exception {
  Tuple input;
  String output;
  String inputStr="Hello World!";
  String expected="Hello World!";
  List list=new LinkedList();
  EvalFunc<String> strFunc=new REPLACE_MULTI();
  list.add(inputStr);
  Map<String,String> map=new HashMap<String,String>();
  list.add(map);
  input=TupleFactory.getInstance().newTuple(list);
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestHostExtractor </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTests() throws Exception {
  HostExtractor hostExtractor=new HostExtractor();
  int testCount=0;
  Tuple input=DefaultTupleFactory.getInstance().newTuple(1);
  for (  String key : tests.keySet()) {
    input.set(0,key);
    String expected=tests.get(key);
    String output=hostExtractor.exec(input);
    assertEquals(expected,output);
    testCount++;
  }
  assertEquals(tests.size(),testCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestSearchEngineExtractor </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTests() throws Exception {
  SearchEngineExtractor searchEngineExtractor=new SearchEngineExtractor();
  int testCount=0;
  Tuple input=DefaultTupleFactory.getInstance().newTuple(1);
  for (  String key : tests.keySet()) {
    String expected=tests.get(key);
    assertNotNull(expected);
    assertTrue(expected.length() > 0);
    input.set(0,key);
    assertEquals(expected,searchEngineExtractor.exec(input));
    testCount++;
  }
  assertEquals(tests.size(),testCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestSearchTermExtractor </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTests() throws Exception {
  SearchTermExtractor searchTermExtractor=new SearchTermExtractor();
  int testCount=0;
  Tuple input=DefaultTupleFactory.getInstance().newTuple(1);
  for (  String key : tests.keySet()) {
    String expected=tests.get(key);
    input.set(0,key);
    assertEquals(expected,searchTermExtractor.exec(input));
    testCount++;
  }
  assertEquals(tests.size(),testCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.xml.XPathAllTest </h4><pre class="type-7 type-6 type-4 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testCacheBenefit() throws Exception {
  final XPathAll xpath=new XPathAll();
  final Tuple tuple=TupleFactory.getInstance().newTuple(3);
  tuple.set(2,true);
  final long withCache=timeTheUDF(tuple,xpath);
  tuple.set(2,false);
  final long withOutCache=timeTheUDF(tuple,xpath);
  System.out.println(withCache + "\t" + withOutCache);
  assertTrue(withCache < withOutCache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.xml.XPathTest </h4><pre class="type-7 type-6 type-4 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testCacheBenefit() throws Exception {
  final XPath xpath=new XPath();
  final Tuple tuple=TupleFactory.getInstance().newTuple(3);
  tuple.set(2,true);
  final long withCache=timeTheUDF(tuple,xpath);
  tuple.set(2,false);
  final long withOutCache=timeTheUDF(tuple,xpath);
  System.out.println(withCache + "\t" + withOutCache);
  assertTrue(withCache < withOutCache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestAllLoader </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can filter by a logic partition based on a range, in this
 * case block<=2
 * @throws IOException
 */
@Test public void testLogicPartitionFilter() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(logicPartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('block<=2')"+ " as (q:float, p:float);");
  server.registerQuery("r = FOREACH a GENERATE q, p;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(2,t.size());
  }
  assertEquals(fileRecords * 2 * fileTypes.length,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can extract only the partition column
 * @throws IOException
 */
@Test public void testLogicPartitionPartitionColumnExtract() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(logicPartitionDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (q:float, p:float, block:chararray);");
  server.registerQuery("r = foreach a generate block;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  Map<String,AtomicInteger> partitionCount=new HashMap<String,AtomicInteger>();
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(1,t.size());
    String key=t.get(0).toString();
    AtomicInteger ati=partitionCount.get(key);
    if (ati == null) {
      ati=new AtomicInteger(1);
      partitionCount.put(key,ati);
    }
 else {
      ati.incrementAndGet();
    }
  }
  for (  AtomicInteger ati : partitionCount.values()) {
    assertEquals(fileRecords * fileTypes.length,ati.get());
  }
  assertEquals(fileRecords * logicPartitions.length * fileTypes.length,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can filter a date partitioned directory by a date range
 * @throws IOException
 */
@Test public void testDateParitionFilterWithAsSchema() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('daydate >= \"2010-11-02\" and daydate <= \"2010-11-04\"') AS (q:float, p:float, daydate:chararray); ");
  server.registerQuery("r = FOREACH a GENERATE $0;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(1,t.size());
  }
  readRecordsFromLoader(server,"a",fileRecords * 3 * fileTypes.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can filter a date partitioned directory by a date range
 * @throws IOException
 */
@Test public void testDateParitionFilterWithoutSchema() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('daydate >= \"2010-11-02\" and daydate <= \"2010-11-04\"'); ");
  server.registerQuery("r = FOREACH a GENERATE $0;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    float f=Float.valueOf(t.get(0).toString());
    assertTrue(f < 1L);
    assertEquals(1,t.size());
  }
  readRecordsFromLoader(server,"a",fileRecords * 3 * fileTypes.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestCSVExcelStorage </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void storeComplexTypes() throws IOException, ParseException {
  String input="csv_excel_complex_input";
  String schema="a:(b:int,c:int),d:(e:int,f:(g:int,h:int)),i:{j:(k:int,l:int)},m:{n:(o:int,p:{q:(r:int,s:int)})},t:[int],u:[[int]]";
  String output="csv_excel_complex_output";
  Util.createLocalInputFile(dataDir + input,new String[]{"(1,2)|(1,(2,3))|{(1,2),(3,4)}|{(1,{(2,3),(4,5)}),(6,{(7,8),(9,0)})}|[a#1,b#2]|[a#[b#1,c#2],d#[e#3,f#4]]","(1,)|(1,(2,))|{(1,),(3,)}|{(1,{(,3),(,5)}),(6,{(7,),(9,)})}|[a#,b#2]|[a#[b#,c#2],d#]"});
  pig.registerQuery("data = load '" + dataDir + input+ "' "+ "using PigStorage('|')"+ "AS ("+ schema+ ");");
  pig.store("data",dataDir + output,"org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE', 'UNIX', 'SKIP_OUTPUT_HEADER')");
  pig.registerQuery("data = load '" + dataDir + output+ "' "+ "using TextLoader() as (line: chararray);");
  Iterator<Tuple> data=pig.openIterator("data");
  String[] expected={"(\"(1,2)\",\"(1,(2,3))\",\"{(1,2),(3,4)}\",\"{(1,{(2,3),(4,5)}),(6,{(7,8),(9,0)})}\",\"{b=2, a=1}\",\"{d={f=4, e=3}, a={b=1, c=2}}\")","(\"(1,)\",\"(1,(2,))\",\"{(1,),(3,)}\",\"{(1,{(,3),(,5)}),(6,{(7,),(9,)})}\",\"{b=2, a=null}\",\"{d=null, a={b=null, c=2}}\")"};
  String[] expectedJDK8={"(\"(1,2)\",\"(1,(2,3))\",\"{(1,2),(3,4)}\",\"{(1,{(2,3),(4,5)}),(6,{(7,8),(9,0)})}\",\"{a=1, b=2}\",\"{a={b=1, c=2}, d={e=3, f=4}}\")","(\"(1,)\",\"(1,(2,))\",\"{(1,),(3,)}\",\"{(1,{(,3),(,5)}),(6,{(7,),(9,)})}\",\"{a=null, b=2}\",\"{a={b=null, c=2}, d=null}\")"};
  String actual=StringUtils.join(data,"\n");
  Assert.assertTrue("Failed to match. Output was " + actual,StringUtils.join(expected,"\n").equals(actual) || StringUtils.join(expectedJDK8,"\n").equals(actual));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void storeCR() throws IOException {
  ArrayList<Tuple> inputTuples=new ArrayList<Tuple>();
  inputTuples.add(Storage.tuple(1,"text","a line\rand another line to write"));
  String expected="1,text,\"a line\rand another line to write\"\n";
  String expectedNoMultiline="1,text,a line\rand another line to write\n";
  Data data=Storage.resetData(pig);
  data.set("inputTuples",inputTuples);
  String testOut=dataDir + "csv_cr_quoted_output_yes_multiline";
  String script="A = load 'inputTuples' USING mock.Storage() as (f1:int, f2:chararray, f3:chararray);" + "STORE A INTO '" + testOut + "' USING "+ "org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE', 'UNIX');";
  Util.registerMultiLineQuery(pig,script);
  FileInputStream resultFile=new FileInputStream(testOut + "/part-m-00000");
  byte[] actualBytes=new byte[resultFile.available()];
  resultFile.read(actualBytes);
  resultFile.close();
  String actual=new String(actualBytes);
  Assert.assertEquals(expected,actual);
  testOut=dataDir + "csv_cr_quoted_output_no_multiline";
  script="A = load 'inputTuples' USING mock.Storage() as (f1:int, f2:chararray, f3:chararray);" + "STORE A INTO '" + testOut + "' USING "+ "org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'NO_MULTILINE', 'UNIX');";
  Util.registerMultiLineQuery(pig,script);
  resultFile=new FileInputStream(testOut + "/part-m-00000");
  actualBytes=new byte[resultFile.available()];
  resultFile.read(actualBytes);
  resultFile.close();
  actual=new String(actualBytes);
  Assert.assertEquals(expectedNoMultiline,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestHadoopJobHistoryLoader </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testHadoopJHLoader() throws Exception {
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.registerQuery("a = load '" + INPUT_DIR + "' using org.apache.pig.piggybank.storage.HadoopJobHistoryLoader() "+ "as (j:map[], m:map[], r:map[]);");
  Iterator<Tuple> iter=pig.openIterator("a");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Map<String,Object> job=(Map<String,Object>)t.get(0);
  assertEquals("3eb62180-5473-4301-aa22-467bd685d466",(String)job.get("PIG_SCRIPT_ID"));
  assertEquals("job_201004271216_9998",(String)job.get("JOBID"));
  assertEquals("job_201004271216_9995",(String)job.get("PIG_JOB_PARENTS"));
  assertEquals("0.8.0-dev",(String)job.get("PIG_VERSION"));
  assertEquals("0.20.2",(String)job.get("HADOOP_VERSION"));
  assertEquals("d",(String)job.get("PIG_JOB_ALIAS"));
  assertEquals("PigLatin:Test.pig",job.get("JOBNAME"));
  assertEquals("ORDER_BY",(String)job.get("PIG_JOB_FEATURE"));
  assertEquals("1",(String)job.get("TOTAL_MAPS"));
  assertEquals("1",(String)job.get("TOTAL_REDUCES"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestHiveColumnarLoader </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYearMonthDayHourPartitionedFilesWithProjection() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(yearMonthDayHourPartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("f = FILTER a by year=='2010';");
  server.registerQuery("b = foreach f generate f1,f2;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(2,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(240,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYearMonthDayHourPartitionedFilesWithProjectionAndPartitionColumns() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(yearMonthDayHourPartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("f = FILTER a by year=='2010';");
  server.registerQuery("r = foreach f generate year, f2, f3, month, day, hour;");
  server.registerQuery("b = ORDER r BY year, month, day, hour;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    System.out.println("Tuple: " + t);
    assertEquals(6,t.size());
    count++;
  }
  System.out.println("Count: " + count);
  Assert.assertEquals(240,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingMultipleNonPartitionedFiles() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedDir=simpleDataDir.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedDir) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = foreach a generate f1;");
  Iterator<Tuple> result=server.openIterator("b");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleDirFileCount * simpleRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingSingleFile() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = foreach a generate f1;");
  Iterator<Tuple> result=server.openIterator("b");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1DayDatePartitionedFilesWithProjection() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string'" + ", '" + startingDate + ":"+ startingDate+ "')";
  System.out.println(funcSpecString);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = FOREACH a GENERATE f2 as p;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(50,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumerOfColumnsWhenDatePartitionedFiles() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string'" + ", '" + startingDate + ":"+ endingDate+ "')";
  System.out.println(funcSpecString);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  Iterator<Tuple> result=server.openIterator("a");
  Tuple t=null;
  while ((t=result.next()) != null) {
    Assert.assertEquals(4,t.size());
    count++;
  }
  Assert.assertEquals(datePartitionedRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingSingleFileNoProjections() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ funcSpecString+ ";");
  Iterator<Tuple> result=server.openIterator("a");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(3,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleRowCount,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestHiveColumnarStorage </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShouldStoreRowInHiveFormat() throws IOException, InterruptedException, SerDeException {
  String loadString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String storeString="org.apache.pig.piggybank.storage.HiveColumnarStorage()";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  File outputFile=new File("testhiveColumnarStore");
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ loadString+ ";");
  server.store("a",outputFile.getAbsolutePath(),storeString);
  Path outputPath=new Path(outputFile.getAbsolutePath() + "/part-m-00000.rc");
  ColumnarStruct struct=readRow(outputFile,outputPath,"f1 string,f2 string,f3 string");
  assertEquals(3,struct.getFieldsAsList().size());
  Object o=struct.getField(0);
  assertEquals(LazyString.class,o.getClass());
  o=struct.getField(1);
  assertEquals(LazyString.class,o.getClass());
  o=struct.getField(2);
  assertEquals(LazyString.class,o.getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShouldStoreMapAsHiveMap() throws IOException, InterruptedException, SerDeException {
  String loadString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String storeString="org.apache.pig.piggybank.storage.HiveColumnarStorage()";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  File outputFile=new File("testhiveColumnarStore");
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ loadString+ ";");
  server.registerQuery("b = FOREACH a GENERATE f1, TOMAP(f2,f3);");
  server.store("b",outputFile.getAbsolutePath(),storeString);
  Path outputPath=new Path(outputFile.getAbsolutePath() + "/part-m-00000.rc");
  ColumnarStruct struct=readRow(outputFile,outputPath,"f1 string,f2 map<string,string>");
  assertEquals(2,struct.getFieldsAsList().size());
  Object o=struct.getField(0);
  assertEquals(LazyString.class,o.getClass());
  o=struct.getField(1);
  assertEquals(LazyMap.class,o.getClass());
  LazyMap arr=(LazyMap)o;
  Map<Object,Object> values=arr.getMap();
  for (  Entry<Object,Object> entry : values.entrySet()) {
    assertEquals(LazyString.class,entry.getKey().getClass());
    assertEquals(LazyString.class,entry.getValue().getClass());
    String keyStr=((LazyString)entry.getKey()).getWritableObject().toString();
    assertEquals("Sample value",keyStr);
    String valueStr=((LazyString)entry.getValue()).getWritableObject().toString();
    assertEquals("Sample value",valueStr);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShouldStoreTupleAsHiveArray() throws IOException, InterruptedException, SerDeException {
  String loadString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String storeString="org.apache.pig.piggybank.storage.HiveColumnarStorage()";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  File outputFile=new File("testhiveColumnarStore");
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ loadString+ ";");
  server.registerQuery("b = FOREACH a GENERATE f1, TOTUPLE(f2,f3);");
  server.store("b",outputFile.getAbsolutePath(),storeString);
  Path outputPath=new Path(outputFile.getAbsolutePath() + "/part-m-00000.rc");
  ColumnarStruct struct=readRow(outputFile,outputPath,"f1 string,f2 array<string>");
  assertEquals(2,struct.getFieldsAsList().size());
  Object o=struct.getField(0);
  assertEquals(LazyString.class,o.getClass());
  o=struct.getField(1);
  assertEquals(LazyArray.class,o.getClass());
  LazyArray arr=(LazyArray)o;
  List values=arr.getList();
  for (  Object value : values) {
    assertEquals(LazyString.class,value.getClass());
    String valueStr=((LazyString)value).getWritableObject().toString();
    assertEquals("Sample value",valueStr);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShouldStoreBagAsHiveArray() throws IOException, InterruptedException, SerDeException {
  String loadString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String storeString="org.apache.pig.piggybank.storage.HiveColumnarStorage()";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  File outputFile=new File("testhiveColumnarStore");
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ loadString+ ";");
  server.registerQuery("b = FOREACH a GENERATE f1, TOBAG(f2,f3);");
  server.store("b",outputFile.getAbsolutePath(),storeString);
  Path outputPath=new Path(outputFile.getAbsolutePath() + "/part-m-00000.rc");
  ColumnarStruct struct=readRow(outputFile,outputPath,"f1 string,f2 array<string>");
  assertEquals(2,struct.getFieldsAsList().size());
  Object o=struct.getField(0);
  assertEquals(LazyString.class,o.getClass());
  o=struct.getField(1);
  assertEquals(LazyArray.class,o.getClass());
  LazyArray arr=(LazyArray)o;
  List values=arr.getList();
  for (  Object value : values) {
    assertEquals(LazyString.class,value.getClass());
    String valueStr=((LazyString)value).getWritableObject().toString();
    assertEquals("Sample value",valueStr);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestLoadFuncHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunctionSingleArg() throws IOException {
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath());
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFirstFile() throws IOException {
  Path path=helper.determineFirstFile(baseDir.getAbsolutePath());
  assertNotNull(path);
  assertEquals(new Path(testFile.getAbsolutePath()).toUri().toString(),path.toUri().toURL().getFile());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunction() throws IOException {
  Path firstFile=helper.determineFirstFile(baseDir.getAbsolutePath());
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath(),firstFile);
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestLogFormatLoader </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLogFormatLoader() throws Exception {
  final String logformat="%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" \"%{Cookie}i\"";
  final String testLine="2001:980:91c0:1:8d31:a232:25e5:85d - - [05/Sep/2010:11:27:50 +0200] " + "\"GET /b/ss/advbolprod2/1/H.22.1/s73176445413647?AQB=1&pccr=true&vidn=27F07A1B85012045-403" + "&&ndh=1&t=19%2F5%2F2012%2023%3A51%3A27%202%20-120&ce=UTF-8&ns=bol&pageName=%2Fnl%2Fp%2Ffissler-"+ "speciaal-pannen-grillpan-28-x-28-cm%2F9200000002876066%2F&g=http%3A%2F%2Fwww.bol.com%2Fnl%2Fp%2F"+ "fissler-speciaal-pannen-grillpan-28-x-28-cm%2F9200000002876066%2F%3Fpromo%3Dkoken-pannen_303_hs-"+ "koken-pannen-afj-120601_B3_product_1_9200000002876066%26bltg.pg_nm%3Dkoken-pannen%26bltg.slt_id%3D"+ "303%26bltg.slt_nm%3Dhs-koken-pannen-afj-120601%26bltg.slt_p&r=http%3A%2F%2Fwww.bol.com%2Fnl%2Fm%2F"+ "koken-tafelen%2Fkoken-pannen%2FN%2F11766%2Findex.html%3Fblabla%3Dblablawashere&cc=EUR&ch=D%3Dv3&"+ "server=ps316&events=prodView%2Cevent1%2Cevent2%2Cevent31&products=%3B9200000002876066%3B%3B%3B%3B"+ "evar3%3Dkth%7Cevar8%3D9200000002876066_Fissler%20Speciaal%20Pannen%20-%20Grillpan%20-%2028%20x%2028"+ "%20cm%7Cevar35%3D170%7Cevar47%3DKTH%7Cevar9%3DNew%7Cevar40%3Dno%20reviews%2C%3B%3B%3B%3Bevent31%3D423"+ "&c1=catalog%3Akth%3Aproduct-detail&v1=D%3Dc1&h1=catalog%2Fkth%2Fproduct-detail&h2=D%3DpageName&v3=kth"+ "&l3=endeca_001-mensen_default%2Cendeca_exact-boeken_default%2Cendeca_verschijningsjaar_default%2C"+ "endeca_hardgoodscategoriesyn_default%2Cendeca_searchrank-hadoop_default%2Cendeca_genre_default%2C"+ "endeca_uitvoering_default&v4=ps316&v6=koken-pannen_303_hs-koken-pannen-afj-120601_B3_product_1_"+ "9200000002876066&v10=Tu%2023%3A30&v12=logged%20in&v13=New&c25=niet%20ssl&c26=3631&"+ "c30=1.2.3.4.1323208998208762&v31=2000285551&c45=20120619235127&c46=20120501%204.3.4.1&"+ "c47=D%3Ds_vi&c49=%2Fnl%2Fcatalog%2Fproduct-detail.jsp&c50=%2Fnl%2Fcatalog%2Fproduct-detail.jsp&"+ "v51=www.bol.com&s=1280x800&c=24&j=1.7&v=N&k=Y&bw=1280&bh=272&p=Shockwave%20Flash%3B&AQE=1 "+ "HTTP/1.1\" 200 23617 \"http://www.google.nl/imgres?imgurl=http://daniel_en_sander.basjes.nl/"+ "fotos/geboorte-kaartje/geboortekaartje-binnenkant.jpg&imgrefurl=http://daniel_en_sander.basjes.nl/"+ "fotos/geboorte-kaartje&usg=__LDxRMkacRs6yLluLcIrwoFsXY6o=&h=521&w=1024&sz=41&hl=nl&start=13&zoom=1"+ "&um=1&itbs=1&tbnid=Sqml3uGbjoyBYM:&tbnh=76&tbnw=150&prev=/images%3Fq%3Dbinnenkant%2Bgeboortekaartje"+ "%26um%3D1%26hl%3Dnl%26sa%3DN%26biw%3D1882%26bih%3D1014%26tbs%3Disch:1\" "+ "\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_4; nl-nl) AppleWebKit/533.17.8 (KHTML, like Gecko) "+ "Version/5.0.1 Safari/533.17.8\" \"jquery-ui-theme=Eggplant; BuI=SomeThing; "+ "Apache=127.0.0.1.1351111543699529\"";
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  Storage.Data data=resetData(pigServer);
  ArrayList<String[]> input=new ArrayList<String[]>();
  input.add(new String[]{testLine});
  String filename=TestHelper.createTempFile(input," ");
  filename=filename.replace("\\","\\\\");
  pigServer.registerQuery("Clicks = " + "    LOAD '" + filename + "' "+ "    USING org.apache.pig.piggybank.storage.apachelog.LogFormatLoader("+ "            '"+ logformat+ "',"+ "            'IP:connection.client.host',"+ "            'TIME.STAMP:request.receive.time',"+ "       '-map:request.firstline.uri.query.g:HTTP.URI',"+ "            'STRING:request.firstline.uri.query.g.query.promo',"+ "            'STRING:request.firstline.uri.query.g.query.*',"+ "            'STRING:request.firstline.uri.query.s',"+ "       '-map:request.firstline.uri.query.r:HTTP.URI',"+ "            'STRING:request.firstline.uri.query.r.query.blabla',"+ "            'HTTP.COOKIE:request.cookies.bui',"+ "            'HTTP.USERAGENT:request.user-agent'"+ "            )"+ "         AS ("+ "            ConnectionClientHost,"+ "            RequestReceiveTime,"+ "            Promo,"+ "            QueryParams:map[],"+ "            ScreenResolution,"+ "            GoogleQuery,"+ "            BUI,"+ "            RequestUseragent"+ "            );");
  pigServer.registerQuery("STORE Clicks INTO 'Clicks' USING mock.Storage();");
  List<Tuple> out=data.get("Clicks");
  assertEquals(1,out.size());
  Tuple actual=out.get(0);
  Tuple expected=tuple("2001:980:91c0:1:8d31:a232:25e5:85d","[05/Sep/2010:11:27:50 +0200]","koken-pannen_303_hs-koken-pannen-afj-120601_B3_product_1_9200000002876066",map("promo","koken-pannen_303_hs-koken-pannen-afj-120601_B3_product_1_9200000002876066","bltg.pg_nm","koken-pannen","bltg.slt_nm","hs-koken-pannen-afj-120601","bltg.slt_id","303","bltg.slt_p",""),"1280x800","blablawashere","SomeThing","Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_4; nl-nl) AppleWebKit/533.17.8 " + "(KHTML, like Gecko) Version/5.0.1 Safari/533.17.8");
  assertEquals(expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitionHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatusPartitionFilterFound() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionFilterExpression("year<='2010' and month=='01' and day>='01'",PigStorage.class,"2");
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"2");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"2");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListStatusPartitionFilterNotFound() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  Iterator<Map.Entry<String,String>> iter=conf.iterator();
  while (iter.hasNext()) {
    Map.Entry<String,String> entry=iter.next();
    System.out.println(entry.getKey() + ": " + entry.getValue());
  }
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionFilterExpression("year < '2010'",PigStorage.class,"1");
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"1");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"1");
  assertEquals(0,files.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatus() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"3");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"3");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitioner </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeysForEmptyDir() throws Exception {
  File baseDir=createDir(null,"testPathPartitioner-testGetKeys-" + System.currentTimeMillis());
  File partition1=createDir(baseDir,"year=2010");
  File partition2=createDir(partition1,"month=01");
  File emptyPartition=createDir(partition2,"day=01");
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetKeyValues() throws Exception {
  PathPartitioner partitioner=new PathPartitioner();
  Map<String,String> map=partitioner.getPathPartitionKeyValues(partition3.getAbsolutePath().replaceAll("\\\\","/"));
  String[] keys=map.keySet().toArray(new String[]{});
  assertEquals("2010",map.get(keys[0]));
  assertEquals("01",map.get(keys[1]));
  assertEquals("01",map.get(keys[2]));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeys() throws Exception {
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestSequenceFileLoader </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsNocast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      System.err.println("expect:---: " + EXPECTED[tupleCount][0]);
      assertEquals(EXPECTED[tupleCount][0],tuple.get(0).toString());
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1).toString());
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsStringCast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key:long, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      assertEquals(Long.parseLong(EXPECTED[tupleCount][0]),tuple.get(0));
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1));
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadBytesWritable() throws IOException {
  File inputFile=File.createTempFile("test",".txt");
  System.err.println("fileName: " + inputFile.getAbsolutePath());
  Path path=new Path("file:///" + inputFile.getAbsolutePath());
  JobConf conf=new JobConf();
  FileSystem fs=FileSystem.get(path.toUri(),conf);
  IntWritable key=new IntWritable();
  SequenceFile.Writer writer=null;
  try {
    writer=SequenceFile.createWriter(fs,conf,path,key.getClass(),BytesWritable.class);
    int numRecords=3;
    for (int i=0; i < numRecords; i++) {
      key.set(i);
      String val="" + Math.pow(10,(numRecords - i));
      writer.append(key,new BytesWritable(val.getBytes()));
    }
  }
  finally {
    IOUtils.closeStream(writer);
  }
  Data data=resetData(pigServer);
  data.set("expected",tuple(0L,new DataByteArray("1000.0")),tuple(1L,new DataByteArray("100.0")),tuple(2L,new DataByteArray("10.0")));
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key:long, val);");
  pigServer.registerQuery("STORE A into 'actual' USING mock.Storage();");
  assertEquals(data.get("expected"),data.get("actual"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorage </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoadwithNullValues() throws IOException {
  PigSchema2Avro.setTupleIndex(0);
  Data data=resetData(pigServerLocal);
  String output=outbasedir + "testLoadwithNulls";
  deleteDirectory(new File(output));
  String[] queries={" A = load '" + testLoadwithNullValues + "' USING "+ " org.apache.pig.piggybank.storage.avro.AvroStorage(); "," B = order A by name;"," store B into '" + output + "' USING mock.Storage();"};
  testAvroStorage(queries);
  List<Tuple> out=data.get(output);
  assertEquals(out + " size",4,out.size());
  assertEquals(schema("name:chararray,age:int,gpa:double"),data.getSchema(output));
  assertEquals(tuple((String)null),out.get(0));
  assertEquals(tuple((String)null),out.get(1));
  assertEquals(tuple("calvin ellison",24,0.71),out.get(2));
  assertEquals(tuple("wendy johnson",60,0.07),out.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleSchemasWithDefaultValue() throws IOException {
  Data data=resetData(pigServerLocal);
  String output=outbasedir + "testMultipleSchemasWithDefaultValue";
  deleteDirectory(new File(output));
  String expected=basedir + "expected_testMultipleSchemasWithDefaultValue.avro";
  String[] queries={" a = LOAD '" + testMultipleSchemasWithDefaultValue + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('multiple_schemas');"," b = foreach a generate name,age,dept,office,lastname,salary;"," c = filter b by age < 40 ;"," d = order c by  name;"," STORE d INTO '" + output + "' using mock.Storage();"};
  testAvroStorage(queries);
  List<Tuple> out=data.get(output);
  assertEquals(out + " size",5,out.size());
  assertEquals(schema("name: chararray,age: int,dept: chararray,office: chararray,lastname: chararray,salary: int"),data.getSchema(output));
  assertEquals(tuple("Asmya",34,"PQ","OU","LNU",0),out.get(0));
  assertEquals(tuple("Baljit",23,"RS","OU","LNU",0),out.get(1));
  assertEquals(tuple("Milo",30,"DH","OU","LNU",0),out.get(2));
  assertEquals(tuple("Mumbai",20,"Applied Math","UAH","Indians",4468),out.get(3));
  assertEquals(tuple("Rajsathan",20,"Biochemistry","Stanford","Royals",1378),out.get(4));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleLoadStore() throws Exception {
  PigSchema2Avro.setTupleIndex(0);
  Data data=resetData(pigServerLocal);
  data.set("foo",tuple(1,2,3),tuple(4,5,6),tuple(7,8,9));
  data.set("bar",tuple("a","b","c"),tuple("d","e","f"),tuple("g","h","i"));
  String output=outbasedir + "testMultipleLoadStore";
  deleteDirectory(new File(output));
  String[] storeQuery={"A = LOAD 'foo' USING " + "mock.Storage() as (a1:int, a2:int, a3:int);","B = LOAD 'bar' USING " + "mock.Storage() as (b1:chararray, b2:chararray, b3:chararray);","STORE A into '" + output + "/A' USING "+ "org.apache.pig.piggybank.storage.avro.AvroStorage();","STORE B into '" + output + "/B' USING "+ "org.apache.pig.piggybank.storage.avro.AvroStorage();"};
  testAvroStorage(storeQuery);
  String[] loadQuery={"C = LOAD '" + output + "/A' USING "+ "org.apache.pig.piggybank.storage.avro.AvroStorage();","D = LOAD '" + output + "/B' USING "+ "org.apache.pig.piggybank.storage.avro.AvroStorage();","STORE C into 'foo-actual' USING mock.Storage();","STORE D into 'bar-actual' USING mock.Storage();"};
  testAvroStorage(loadQuery);
  assertEquals(data.get("foo"),data.get("foo-actual"));
  assertEquals(data.get("bar"),data.get("bar-actual"));
  assertEquals("{a1: int,a2: int,a3: int}",data.getSchema("foo-actual").toString());
  assertEquals("{b1: chararray,b2: chararray,b3: chararray}",data.getSchema("bar-actual").toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema8() throws IOException {
  Schema x, y, z;
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,1);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.FIXED,z.getType());
  assertEquals(x.getFixedSize(),z.getFixedSize());
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,2);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Cannot merge FIXED types with different sizes"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPaths() throws IOException {
  final String basedir="file://" + System.getProperty("user.dir");
  final String tempdir=Long.toString(System.currentTimeMillis());
  final String nonexistentpath=basedir + "/" + tempdir+ "/this_path_does_not_exist";
  String locationStr=null;
  Set<Path> paths;
  Configuration conf=new Configuration();
  locationStr=basedir;
  paths=AvroStorageUtils.getPaths(locationStr,conf,true);
  assertFalse(paths.isEmpty());
  locationStr=nonexistentpath;
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  locationStr=basedir + "/{}";
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  paths=AvroStorageUtils.getPaths(locationStr,conf,false);
  assertTrue(paths.isEmpty());
  locationStr=basedir + "/{1,";
  try {
    AvroStorageUtils.getPaths(locationStr,conf,true);
    Assert.fail("Negative test to test illegal file pattern. Should not be succeeding!");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Illegal file pattern"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema7() throws IOException {
  Schema x, y, z;
  List<Schema> types1=new ArrayList<Schema>();
  types1.add(Schema.create(Schema.Type.INT));
  List<Schema> types2=new ArrayList<Schema>();
  types2.add(Schema.create(Schema.Type.DOUBLE));
  x=Schema.createUnion(types1);
  y=Schema.createUnion(types2);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.UNION,z.getType());
  assertTrue(z.getTypes().contains(types1.get(0)));
  assertTrue(z.getTypes().contains(types2.get(0)));
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema6() throws IOException {
  Schema x, y, z;
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.MAP,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getValueType().getType());
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getValueType().getType() + " with "+ y.getValueType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema5() throws IOException {
  Schema x, y, z;
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.ARRAY,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getElementType().getType());
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getElementType().getType() + " with "+ y.getElementType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema3() throws IOException {
  Schema complexType[]={Schema.createRecord(new ArrayList<Schema.Field>()),Schema.createArray(Schema.create(Schema.Type.INT)),Schema.createMap(Schema.create(Schema.Type.INT)),Schema.createUnion(new ArrayList<Schema>()),Schema.createFixed("fixed",null,null,1)};
  for (int i=0; i < complexType.length; i++) {
    Schema x=complexType[i];
    for (int j=0; j < complexType.length; j++) {
      Schema y=complexType[j];
      if (i != j) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x,y);
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x.getType() + " with "+ y.getType(),e.getMessage());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema4() throws IOException {
  Schema x, y, z;
  List<Schema.Field> fields1=new ArrayList<Schema.Field>();
  fields1.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields1);
  List<Schema.Field> fields2=new ArrayList<Schema.Field>();
  fields2.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  y=Schema.createRecord(fields2);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  List<Schema.Field> fields3=new ArrayList<Schema.Field>();
  fields3.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields3);
  List<Schema.Field> fields4=new ArrayList<Schema.Field>();
  fields4.add(new Schema.Field("f1",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields4);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.DOUBLE,z.getField("f1").schema().getType());
  List<Schema.Field> fields5=new ArrayList<Schema.Field>();
  fields5.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields5);
  List<Schema.Field> fields6=new ArrayList<Schema.Field>();
  fields6.add(new Schema.Field("f1",Schema.create(Schema.Type.BOOLEAN),null,null));
  y=Schema.createRecord(fields6);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getField("f1").schema().getType() + " with "+ y.getField("f1").schema().getType(),e.getMessage());
  }
  List<Schema.Field> fields7=new ArrayList<Schema.Field>();
  fields7.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields7);
  List<Schema.Field> fields8=new ArrayList<Schema.Field>();
  fields8.add(new Schema.Field("f2",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields8);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size() + y.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  assertEquals(Schema.Type.DOUBLE,z.getField("f2").schema().getType());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  final String str1="[ \"string\", \"int\", \"boolean\"  ]";
  Schema s=Schema.parse(str1);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str2="[ \"string\", \"int\", \"null\"  ]";
  s=Schema.parse(str2);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str3="[ \"string\", \"null\"  ]";
  s=Schema.parse(str3);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  Schema realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str4="{\"type\": \"array\", \"items\": " + str2 + "}";
  s=Schema.parse(str4);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  try {
    realSchema=AvroStorageUtils.getAcceptedType(s);
    fail("\"Should throw a runtime exception when trying to get accepted type from a unacceptable union");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Cannot call this function on a unacceptable union"));
  }
  final String str5=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"null\", \"int\"] } ] }";
  s=Schema.parse(str5);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  final String str6=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"string\", \"int\"] } ] }";
  s=Schema.parse(str6);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str7="[ \"string\"  ]";
  s=Schema.parse(str7);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str8="[  ]";
  s=Schema.parse(str8);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertNull(realSchema);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema2() throws IOException {
  Schema.Type primitiveType[]={Schema.Type.NULL,Schema.Type.BOOLEAN,Schema.Type.BYTES,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.ENUM,Schema.Type.STRING};
  Schema.Type expectedType[][]={{Schema.Type.NULL,null,null,null,null,null,null,null,null},{null,Schema.Type.BOOLEAN,null,null,null,null,null,null,null},{null,null,Schema.Type.BYTES,null,null,null,null,null,null},{null,null,null,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.LONG,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.ENUM,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING}};
  List<String> enumSymbols=new ArrayList<String>();
  enumSymbols.add("sym1");
  enumSymbols.add("sym2");
  Schema enumSchema=Schema.createEnum("enum",null,null,enumSymbols);
  for (int i=0; i < primitiveType.length; i++) {
    Schema.Type x=primitiveType[i];
    for (int j=0; j < primitiveType.length; j++) {
      Schema.Type y=primitiveType[j];
      if (expectedType[i][j] == null) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x + " with "+ y,e.getMessage());
        }
      }
 else {
        Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
        assertEquals(expectedType[i][j],z.getType());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithOr() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>3 or " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<2)?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithAdd() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A)+1.0;");
{
    HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
    expected.put(100,3.0);
    expected.put(200,2.0);
    expected.put(300,4.0);
    expected.put(400,2.0);
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Double)t.get(1));
    }
  }
{
    pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A)+org.apache.pig.test.utils.AccumulatorBagCount(A);");
    HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
    expected.put(100,4);
    expected.put(200,2);
    expected.put(300,6);
    expected.put(400,2);
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMod() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A) % 2;");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,1);
  expected.put(300,1);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, SUM(A.v), COUNT(A.v), MIN(A.v), MAX(A.v);");
  HashMap<Integer,Double[]> expected=new HashMap<Integer,Double[]>();
  expected.put(100,new Double[]{15.0,5.0,1.0,5.0});
  expected.put(200,new Double[]{6.3,3.0,1.1,3.1});
  expected.put(300,new Double[]{3.3,1.0,3.3,3.3});
  expected.put(400,new Double[]{null,0.0,null,null});
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Double[] v=expected.get((Integer)t.get(0));
    for (int i=0; i < v.length; i++) {
      if (v[i] != null) {
        assertEquals(v[i].doubleValue(),((Number)t.get(i + 1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(i + 1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltinAvg() throws IOException {
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,3.0);
  expected.put(200,2.1);
  expected.put(300,3.3);
  expected.put(400,null);
  String[] types={"double","float","int","long"};
  for (int i=0; i < types.length; i++) {
    if (i > 1) {
      expected.put(200,2.0);
      expected.put(300,3.0);
    }
    pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:"+ types[i]+ ");");
    pigServer.registerQuery("C = group A by id;");
    pigServer.registerQuery("D = foreach C generate group, AVG(A.v);");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      Double v=expected.get((Integer)t.get(0));
      if (v != null) {
        assertEquals(v.doubleValue(),((Number)t.get(1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithRegexp() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "(((chararray)org.apache.pig.test.utils.AccumulatorBagCount(A)) matches '1*' ?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithDistinct() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, f);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B { D = distinct A;" + "generate group, org.apache.pig.test.utils.AccumulatorBagCount(D)+1;};");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,2);
  expected.put(300,3);
  expected.put(400,2);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  int count=0;
  while (iter.hasNext()) {
    count++;
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  assertEquals(4,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinCondCheck() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("data1"));
  w.println("1\t11");
  w.println("2\t15");
  w.close();
  Util.copyFromLocalToCluster(cluster,"data1","data1");
  w=new PrintWriter(new FileWriter("data2"));
  w.println("1\t10");
  w.println("4\t11");
  w.println("5\t10");
  w.close();
  Util.copyFromLocalToCluster(cluster,"data2","data2");
  pigServer.registerQuery("A = load 'data1' as (x:int, y:int);");
  pigServer.registerQuery("B = load 'data2' as (x:int, z:int);");
  pigServer.registerQuery("C = cogroup A by x, B by x;");
  pigServer.registerQuery("D = foreach C generate group," + "SUM((IsEmpty(A.y) ? {(0)} : A.y)) + SUM((IsEmpty(B.z) ? {(0)} : B.z));");
  HashMap<Integer,Long> expected=new HashMap<Integer,Long>();
  expected.put(1,21l);
  expected.put(2,15l);
  expected.put(4,11l);
  expected.put(5,10l);
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Long)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithAnd() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>1 and " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<3)?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,1);
  expected.put(300,1);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMap() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE4 + "' as (id, url);");
  pigServer.registerQuery("B = group A by (id, url);");
  pigServer.registerQuery("C = foreach B generate COUNT(A)," + "org.apache.pig.test.utils.URLPARSE(group.url)#'url';");
  HashMap<Integer,String> expected=new HashMap<Integer,String>();
  expected.put(2,"http://ibm.com");
  expected.put(1,"http://yahoo.com");
  expected.put(1,"http://sun.com");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Long)t.get(0)),(String)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumBasic() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,1);
  expected.put(300,3);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.BagCount(A);");
  try {
    iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
    fail("accumulator should not be called.");
  }
 catch (  IOException e) {
  }
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("C = cogroup A by id, B by id;");
  pigServer.registerQuery("D = foreach C generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.AccumulatorBagCount(B);");
  HashMap<Integer,String> expected2=new HashMap<Integer,String>();
  expected2.put(100,"2,2");
  expected2.put(200,"1,1");
  expected2.put(300,"3,3");
  expected2.put(400,"1,1");
  iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected2.get((Integer)t.get(0)),t.get(1).toString() + "," + t.get(2).toString());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithSort() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, f);");
  pigServer.registerQuery("B = foreach A generate id, f, id as t;");
  pigServer.registerQuery("C = group B by id;");
  pigServer.registerQuery("D = foreach C { E = order B by f; F = E.f;" + "generate group, org.apache.pig.test.utils.AccumulativeSumBag(F);};");
  HashMap<Integer,String> expected=new HashMap<Integer,String>();
  expected.put(100,"(apple)(apple)");
  expected.put(200,"(orange)");
  expected.put(300,"(pear)(pear)(strawberry)");
  expected.put(400,"(apple)");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  int count=0;
  while (iter.hasNext()) {
    count++;
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(String)t.get(1));
  }
  assertEquals(4,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithNegative() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  -org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,-2);
  expected.put(200,-1);
  expected.put(300,-3);
  expected.put(400,-1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithIsNull() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((chararray)org.apache.pig.test.utils.AccumulativeSumBag(A) is null?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,0);
  expected.put(300,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMinus() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group, " + " org.apache.pig.test.utils.AccumulatorBagCount(A)*3.0-org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,4.0);
  expected.put(200,2.0);
  expected.put(300,6.0);
  expected.put(400,2.0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Double)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithDivide() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A)/2;");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAdd </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE,DataType.BIGINTEGER,DataType.BIGDECIMAL};
  System.out.println("Testing Add operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 + inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 + inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 + inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 + inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEval </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.out.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          nonNullCnt--;
          ps.println(j % 10 + ":");
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate group, COUNT($1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(1));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupReorderCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1), group ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleCount() throws Exception {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testSimpleCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid =  foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1);";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEvalLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupReorderCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1), group ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.err.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleCount() throws Exception {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testSimpleCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid =  foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1);";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate group, COUNT($1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(1));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          nonNullCnt--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAssert </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that ASSERT operator works
 * @throws Exception
 */
@Test public void testPositive() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("ASSERT A BY i > 0;");
  pigServer.registerQuery("STORE A INTO 'bar' USING mock.Storage();");
  pigServer.executeBatch();
  List<Tuple> out=data.get("bar");
  assertEquals(3,out.size());
  assertEquals(tuple(1),out.get(0));
  assertEquals(tuple(2),out.get(1));
  assertEquals(tuple(3),out.get(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that ASSERT operator works in a Pig script
 * See PIG-3670
 * @throws Exception
 */
@Test public void testInScript() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  StringBuffer query=new StringBuffer();
  query.append("A = LOAD 'foo' USING mock.Storage() AS (i:int);\n");
  query.append("ASSERT A BY i > 0;\n");
  query.append("STORE A INTO 'bar' USING mock.Storage();");
  InputStream is=new ByteArrayInputStream(query.toString().getBytes());
  pigServer.registerScript(is);
  List<Tuple> out=data.get("bar");
  assertEquals(3,out.size());
  assertEquals(tuple(1),out.get(0));
  assertEquals(tuple(2),out.get(1));
  assertEquals(tuple(3),out.get(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBZip </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the end-to-end writing and reading of a BZip file using absolute path with a trailing /.
 */
@Test public void testBzipInPig2() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  File in=folder.newFile("junit-in.bz2");
  File out=folder.newFile("junit-out.bz2");
  out.delete();
  String clusterOutput=Util.removeColon(out.getAbsolutePath());
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
  for (int i=1; i < 100; i++) {
    StringBuffer sb=new StringBuffer();
    sb.append(i).append("\n").append(-i).append("\n");
    byte bytes[]=sb.toString().getBytes();
    cos.write(bytes);
  }
  cos.close();
  pig.registerQuery("AA = load '" + Util.generateURI(in.getAbsolutePath(),pig.getPigContext()) + "';");
  pig.registerQuery("A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);");
  pig.registerQuery("store A into '" + Util.encodeEscape(clusterOutput) + "/';");
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pig.getPigContext().getProperties()));
  FileStatus[] outputFiles=fs.listStatus(new Path(clusterOutput),Util.getSuccessMarkerPathFilter());
  FSDataInputStream is=fs.open(outputFiles[0].getPath());
  CBZip2InputStream cis=new CBZip2InputStream(is,-1,out.length());
  assertEquals(100,cis.read(new byte[100]));
  cis.close();
  pig.registerQuery("B = load '" + Util.encodeEscape(clusterOutput) + "';");
  Iterator<Tuple> i=pig.openIterator("B");
  HashMap<Integer,Integer> map=new HashMap<Integer,Integer>();
  while (i.hasNext()) {
    Integer val=DataType.toInteger(i.next().get(0));
    map.put(val,val);
  }
  assertEquals(new Integer(99),new Integer(map.keySet().size()));
  for (int j=1; j < 100; j++) {
    assertEquals(new Integer(j),map.get(j));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the end-to-end writing and reading of a BZip file.
 */
@Test public void testBzipInPig() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  File in=folder.newFile("junit-in.bz2");
  File out=folder.newFile("junit-out.bz2");
  out.delete();
  String clusterOutput=Util.removeColon(out.getAbsolutePath());
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
  for (int i=1; i < 100; i++) {
    StringBuffer sb=new StringBuffer();
    sb.append(i).append("\n").append(-i).append("\n");
    byte bytes[]=sb.toString().getBytes();
    cos.write(bytes);
  }
  cos.close();
  pig.registerQuery("AA = load '" + Util.generateURI(in.getAbsolutePath(),pig.getPigContext()) + "';");
  pig.registerQuery("A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);");
  pig.registerQuery("store A into '" + Util.encodeEscape(clusterOutput) + "';");
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pig.getPigContext().getProperties()));
  FileStatus[] outputFiles=fs.listStatus(new Path(clusterOutput),Util.getSuccessMarkerPathFilter());
  FSDataInputStream is=fs.open(outputFiles[0].getPath());
  CBZip2InputStream cis=new CBZip2InputStream(is,-1,out.length());
  assertEquals(100,cis.read(new byte[100]));
  cis.close();
  pig.registerQuery("B = load '" + Util.encodeEscape(clusterOutput) + "';");
  Iterator<Tuple> i=pig.openIterator("B");
  HashMap<Integer,Integer> map=new HashMap<Integer,Integer>();
  while (i.hasNext()) {
    Integer val=DataType.toInteger(i.next().get(0));
    map.put(val,val);
  }
  assertEquals(new Integer(99),new Integer(map.keySet().size()));
  for (int j=1; j < 100; j++) {
    assertEquals(new Integer(j),map.get(j));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that Pig's Bzip2TextInputFormat throws an IOException when the input files to be loaded are actually
 * a result of concatenating 2 or more bz2 files. It should not silently ignore part
 * of the input data.  When, hadoop's TextInpuFormat is used(PIG-3251), it should
 * successfully read this concatenated bzip file to the end.
 */
@Test public void testBZ2Concatenation() throws Exception {
  String[] inputData1=new String[]{"1\ta","2\taa"};
  String[] inputData2=new String[]{"1\tb","2\tbb"};
  String[] inputDataMerged=new String[]{"1\ta","2\taa","1\tb","2\tbb"};
  File in1=folder.newFile("junit-in1.bz2");
  String compressedInputFileName1=in1.getAbsolutePath();
  File in2=folder.newFile("junit-in2.bz2");
  String compressedInputFileName2=in2.getAbsolutePath();
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputDataMerged);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in1));
    for (int i=0; i < inputData1.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData1[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    CBZip2OutputStream cos2=new CBZip2OutputStream(new FileOutputStream(in2));
    for (int i=0; i < inputData2.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData2[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos2.write(bytes);
    }
    cos2.close();
    catInto(compressedInputFileName2,compressedInputFileName1);
    Util.copyFromLocalToCluster(cluster,compressedInputFileName1,compressedInputFileName1);
    String script="a = load '" + Util.encodeEscape(unCompressedInputFileName) + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(compressedInputFileName1) + "';";
    pig.registerQuery(script);
    try {
      Iterator<Tuple> it2=pig.openIterator("a");
      while (it1.hasNext()) {
        Tuple t1=it1.next();
        Tuple t2=it2.next();
        assertEquals(t1,t2);
      }
      assertFalse(it2.hasNext());
      assertEquals("IOException should be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"true");
    }
 catch (    IOException e) {
      assertEquals("IOException should only be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"false");
    }
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the end-to-end writing and reading of an empty BZip file.
 */
@Test public void testEmptyBzipInPig() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  File in=folder.newFile("junit-in.tmp");
  File out=folder.newFile("junit-out.bz2");
  out.delete();
  String clusterOutputFilePath=Util.removeColon(out.getAbsolutePath());
  FileOutputStream fos=new FileOutputStream(in);
  fos.write("55\n".getBytes());
  fos.close();
  System.out.println(in.getAbsolutePath());
  pig.registerQuery("AA = load '" + Util.generateURI(in.getAbsolutePath(),pig.getPigContext()) + "';");
  pig.registerQuery("A=foreach (group (filter AA by $0 < '0') all) generate flatten($1);");
  pig.registerQuery("store A into '" + Util.encodeEscape(clusterOutputFilePath) + "';");
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pig.getPigContext().getProperties()));
  FileStatus[] outputFiles=fs.listStatus(new Path(clusterOutputFilePath),Util.getSuccessMarkerPathFilter());
  FSDataInputStream is=fs.open(outputFiles[0].getPath());
  CBZip2InputStream cis=new CBZip2InputStream(is,-1,out.length());
  assertEquals(-1,cis.read(new byte[100]));
  cis.close();
  pig.registerQuery("B = load '" + Util.encodeEscape(clusterOutputFilePath) + "';");
  pig.openIterator("B");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the writing and reading of an empty BZip file.
 */
@Test public void testEmptyBzip() throws Exception {
  File tmp=folder.newFile("junit.tmp");
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(tmp));
  cos.close();
  assertNotSame(0,tmp.length());
  FileSystem fs=FileSystem.getLocal(new Configuration(false));
  CBZip2InputStream cis=new CBZip2InputStream(fs.open(new Path(tmp.getAbsolutePath())),-1,tmp.length());
  assertEquals(-1,cis.read(new byte[100]));
  cis.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testInnerStreamGetsClosed() throws Exception {
  File tmp=folder.newFile("junit.tmp");
  CloseAwareOutputStream out=new CloseAwareOutputStream(new FileOutputStream(tmp));
  CBZip2OutputStream cos=new CBZip2OutputStream(out);
  assertFalse(out.isClosed());
  cos.close();
  assertTrue(out.isClosed());
  FileSystem fs=FileSystem.getLocal(new Configuration(false));
  Path path=new Path(tmp.getAbsolutePath());
  CloseAwareFSDataInputStream in=new CloseAwareFSDataInputStream(fs.open(path));
  CBZip2InputStream cis=new CBZip2InputStream(in,-1,tmp.length());
  assertFalse(in.isClosed());
  cis.close();
  assertTrue(in.isClosed());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that '\n', '\r' and '\r\n' are treated as record delims when using
 * bzip just like they are when using uncompressed text
 */
@Test public void testRecordDelims() throws Exception {
  String[] inputData=new String[]{"1\t2\r3\t4","5\t6\r","7\t8","9\t10\r"};
  File in=folder.newFile("junit-in.bz2");
  String compressedInputFileName=in.getAbsolutePath();
  String clusterCompressedFilePath=Util.removeColon(compressedInputFileName);
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputData);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
    for (int i=0; i < inputData.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    Util.copyFromLocalToCluster(cluster,compressedInputFileName,clusterCompressedFilePath);
    String script="a = load '" + unCompressedInputFileName + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(clusterCompressedFilePath) + "';";
    pig.registerQuery(script);
    Iterator<Tuple> it2=pig.openIterator("a");
    while (it1.hasNext()) {
      Tuple t1=it1.next();
      Tuple t2=it2.next();
      assertEquals(t1,t2);
    }
    assertFalse(it2.hasNext());
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
    Util.deleteFile(cluster,clusterCompressedFilePath);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBestFitCast </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast10() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y:long, z);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayCast7() throws IOException, ExecException {
  boolean exceptionCaused=false;
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y, y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    exceptionCaused=true;
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertTrue(msg.contains("Could not infer the matching function"));
  }
  assertTrue(exceptionCaused);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test6() throws Exception {
  Util.createInputFile(cluster,"test6",new String[]{"abc"});
  pigServer.registerQuery("A = LOAD 'test6';");
  pigServer.registerQuery("B = FOREACH A GENERATE " + UDF2.class.getName() + "($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  Tuple t=iter.next();
  assertEquals("ABC",t.get(0));
  Util.deleteFile(cluster,"test6");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast8() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast13() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayCast5() throws IOException, ExecException {
  boolean exceptionCaused=false;
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y, y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    exceptionCaused=true;
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertTrue(msg.contains("Multiple matching functions"));
    assertTrue(msg.contains("({float,double,long}, {float,long,double})"));
  }
  assertTrue(exceptionCaused);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayCast12() throws IOException, ExecException {
  boolean exceptionCaused=false;
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y, z:int);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y, y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    exceptionCaused=true;
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertTrue(msg.contains("Multiple matching functions"));
    assertTrue(msg.contains("({float,double,long}, {float,long,double}"));
  }
  assertTrue(exceptionCaused);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayCast6() throws IOException, ExecException {
  boolean exceptionCaused=false;
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y, y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    exceptionCaused=true;
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertTrue(msg.contains("Multiple matching functions"));
    assertTrue(msg.contains("({float,double,long}, {float,long,double})"));
  }
  assertTrue(exceptionCaused);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast11() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Long);
  assertEquals(new Long(210),(Long)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "((float)y,(float)y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast15() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof DataByteArray);
    byte[] expected=Integer.toString(cnt + 1).getBytes();
    byte[] actual=((DataByteArray)((Tuple)t.get(0)).get(0)).get();
    assertEquals(expected.length,actual.length);
    for (int i=0; i < expected.length; i++) {
      assertEquals(expected[i],actual[i]);
    }
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast3() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x, y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:float);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast14() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast4() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws Exception {
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(y,y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertEquals(true,msg.contains("as multiple or none of them fit"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Long);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Double);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayCast1() throws IOException {
  boolean exceptionCaused=false;
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:float, y);");
    pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    exceptionCaused=true;
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertTrue(msg.contains("Multiple matching functions"));
    assertTrue(msg.contains("{float,double}, {float,long}"));
  }
  assertTrue(exceptionCaused);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test5() throws Exception {
  try {
    pigServer.registerQuery("A = LOAD '" + inputFile + "';");
    pigServer.registerQuery("B = FOREACH A generate $0, " + UDF1.class.getName() + "($1,$1);");
    pigServer.openIterator("B");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    String msg=(pe == null ? e.getMessage() : pe.getMessage());
    assertEquals(true,msg.contains("Multiple matching functions"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast9() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:double, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast2() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test4() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Long);
  assertEquals(new Long(210),(Long)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast16() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof Integer);
    assertEquals(new Integer(cnt + 1),(Integer)((Tuple)t.get(0)).get(0));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptEmptyBagForBagToStringUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag()));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple(""),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptrForBagToStringUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a"),tuple("b"),tuple("c"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  pigServer.registerQuery("C = FOREACH A GENERATE BagToString(myBag, '==') as myBag;");
  pigServer.registerQuery("STORE C INTO 'baz' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(schema("myBag:chararray"),data.getSchema("bar"));
  assertEquals(tuple("a_b_c"),out.get(0));
  out=data.get("baz");
  assertEquals(tuple("a==b==c"),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptMultipleElmementsPerTupleForBagToStringUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a","b"),tuple("c","d"),tuple("e","f"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  pigServer.registerQuery("C = FOREACH A GENERATE BagToString(myBag, '^') as myBag;");
  pigServer.registerQuery("STORE C INTO 'baz' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a_b_c_d_e_f"),out.get(0));
  out=data.get("baz");
  assertEquals(tuple("a^b^c^d^e^f"),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptMultipleElmementsPerTupleForBagTupleUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a","b"),tuple("c","d"),tuple("e","f"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a","b","c","d","e","f"),out.get(0).get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptEmptyBagForBagToTupleUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag()));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple(),out.get(0).get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedDataElementsForBagToTupleUDF() throws Exception {
  DataBag inputBag=buildBagWithNestedTupleAndBag();
  BagToTuple udf=new BagToTuple();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,inputBag);
  Tuple outputTuple=udf.exec(udfInput);
  Iterator<Tuple> inputBagIterator=inputBag.iterator();
  Tuple firstTuple=inputBagIterator.next();
  for (int i=0; i < firstTuple.size(); i++) {
    assertEquals(firstTuple.get(i),outputTuple.get(i));
  }
  Tuple secondTuple=inputBagIterator.next();
  for (int i=0; i < secondTuple.size(); i++) {
    assertEquals(secondTuple.get(i),outputTuple.get(firstTuple.size() + i));
  }
  int startIndex=firstTuple.size() + secondTuple.size();
  Tuple thirdTuple=inputBagIterator.next();
  for (int i=0; i < thirdTuple.size(); i++) {
    assertEquals(thirdTuple.get(i),outputTuple.get(startIndex + i));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptNestedTupleForBagToStringUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  Tuple nestedTuple=tuple(bag(tuple("c"),tuple("d")));
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a"),tuple("b"),nestedTuple,tuple("e"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToString(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a_b_{(c),(d)}_e"),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptNestedTupleForBagToTupleDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  Tuple nestedTuple=tuple(bag(tuple("c"),tuple("d")));
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a"),tuple("b"),nestedTuple,tuple("e"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a","b",bag(tuple("c"),tuple("d")),"e"),out.get(0).get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptForBagToTupleUDF() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:chararray)}",tuple(bag(tuple("a"),tuple("b"),tuple("c"))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  assertEquals(schema("myBag:(l:chararray)"),data.getSchema("bar"));
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a","b","c"),out.get(0).get(0));
  data=resetData(pigServer);
  data.set("foo","myBag:bag{t:(l:long)}",tuple(bag(tuple(1),tuple(2),tuple(3))));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE BagToTuple(myBag) as myBag;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  out=data.get("bar");
  assertEquals(tuple(1,2,3),out.get(0).get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStatsFunc() throws Exception {
  COV cov=new COV("a","b");
  DataBag dBag=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,1.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,8.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,7.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,8.0);
  dBag.add(tup1);
  DataBag dBag1=DefaultBagFactory.getInstance().newDefaultBag();
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,3.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,3.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag1.add(tup1);
  Tuple input=TupleFactory.getInstance().newTuple(2);
  input.set(0,dBag);
  input.set(1,dBag1);
  DataBag output=cov.exec(input);
  Iterator<Tuple> it=output.iterator();
  Tuple ans=it.next();
  assertEquals(ans.get(0),"a");
  assertEquals(ans.get(1),"b");
  assertEquals(1.11111,(Double)ans.get(2),0.0005);
  COR cor=new COR("a","b");
  dBag=DefaultBagFactory.getInstance().newDefaultBag();
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,1.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,8.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,7.0);
  dBag.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,8.0);
  dBag.add(tup1);
  dBag1=DefaultBagFactory.getInstance().newDefaultBag();
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,3.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,3.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,2.0);
  dBag1.add(tup1);
  tup1=TupleFactory.getInstance().newTuple(1);
  tup1.set(0,4.0);
  dBag1.add(tup1);
  input=TupleFactory.getInstance().newTuple(2);
  input.set(0,dBag);
  input.set(1,dBag1);
  output=cor.exec(input);
  it=output.iterator();
  ans=it.next();
  assertEquals(ans.get(0),"a");
  assertEquals(ans.get(1),"b");
  assertEquals(0.582222509739582,(Double)ans.get(2),0.0005);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMAX() throws Exception {
  String[] maxTypes={"MAX","LongMax","IntMax","FloatMax","BigDecimalMax","BigIntegerMax","StringMax","DateTimeMax"};
  for (int k=0; k < maxTypes.length; k++) {
    EvalFunc<?> max=evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=max.exec(tup);
    String msg="[Testing " + maxTypes[k] + " on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),output);
    assertNull(max.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTOKENIZE() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple(1);
  t1.set(0,"123 456\"789");
  Tuple t2=tf.newTuple(1);
  t2.set(0,null);
  Tuple t3=tf.newTuple(0);
  TOKENIZE f=new TOKENIZE();
  DataBag b=f.exec(t1);
  assertTrue(b.size() == 3);
  Iterator<Tuple> i=b.iterator();
  Tuple rt=i.next();
  assertTrue(rt.get(0).equals("123"));
  rt=i.next();
  assertTrue(rt.get(0).equals("456"));
  rt=i.next();
  assertTrue(rt.get(0).equals("789"));
  Tuple t4=tf.newTuple(2);
  t4.set(0,"123|456|78\"9");
  t4.set(1,"|");
  b=f.exec(t4);
  assertTrue(b.size() == 3);
  i=b.iterator();
  rt=i.next();
  assertTrue(rt.get(0).equals("123"));
  rt=i.next();
  assertTrue(rt.get(0).equals("456"));
  rt=i.next();
  assertTrue(rt.get(0).equals("78\"9"));
  b=f.exec(t2);
  assertTrue(b == null);
  b=f.exec(t3);
  assertTrue(b == null);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMFinal() throws Exception {
  String[] sumTypes={"SUMFinal","DoubleSumFinal","LongSumFinal","IntSumFinal","FloatSumFinal","BigDecimalSumFinal","BigIntegerSumFinal"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * End-to-end testing of the CONCAT() builtin function for vararg parameters
 * @throws Exception
 */
@Test public void testComplexMultiCONCAT() throws Exception {
  String input="vararg_concat_test_jira_3444.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',CONCAT('c','d')));");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', 'b', 'c', 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b','c'), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',Null), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMIN() throws Exception {
  String[] minTypes={"MIN","LongMin","IntMin","FloatMin","BigDecimalMin","BigIntegerMin","StringMin","DateTimeMin"};
  for (int k=0; k < minTypes.length; k++) {
    EvalFunc<?> min=evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=min.exec(tup);
    String msg="[Testing " + minTypes[k] + " on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),output);
    assertNull(min.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called once - so initial is called
 * and then Intermediate and then final is called
 * @throws Exception
 */
@Test public void testAggSingleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag intermediateInputBg1=bagFactory.newDefaultBag();
      DataBag intermediateInputBg2=bagFactory.newDefaultBag();
      int i=0;
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        if (i < bg.size() / 2) {
          intermediateInputBg1.add((Tuple)aggInitial.exec(initialInputTuple));
        }
 else {
          intermediateInputBg2.add((Tuple)aggInitial.exec(initialInputTuple));
        }
        i++;
      }
      EvalFunc<?> avgIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      Tuple intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg1);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg2);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for single combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testValueSet() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","apache");
  Tuple input=TupleFactory.getInstance().newTuple(m);
  VALUESET valueSet=new VALUESET();
  DataBag result=valueSet.exec(input);
  assertEquals(result.size(),2);
  Iterator<Tuple> i=result.iterator();
  List resultList=new ArrayList<String>();
  while (i.hasNext()) {
    resultList.add(i.next().get(0));
  }
  Collections.sort(resultList);
  assertEquals(resultList.get(0),"apache");
  assertEquals(resultList.get(1),"hadoop");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSUM() throws Exception {
  String[] sumTypes={"SUM","DoubleSum","LongSum","IntSum","FloatSum","BigDecimalSum","BigIntegerSum"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType == "Integer" || inputType == "Long") {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
    assertNull(sum.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSPRINTF() throws Exception {
  String fmt="%2$10s <%1$-6s< %2$,10d >%1$7s> %2$8x %3$10.3f";
  String s1="meep";
  Integer ii=665568;
  Float ff=993.14159265f;
  String exp="    665568 <meep  <    665,568 >   meep>    a27e0    993.142";
  Tuple ts;
  String res;
  EvalFunc<String> sprinter=new SPRINTF();
  ts=TupleFactory.getInstance().newTuple(5);
  ts.set(0,fmt);
  ts.set(1,s1);
  ts.set(2,ii);
  ts.set(3,ff);
  ts.set(4,(long)(ii * 1000000L));
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(2,665568l);
  ts.set(3,993.14159265d);
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(3,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts.set(3,ff);
  ts.set(0,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts=TupleFactory.getInstance().newTuple(1);
  ts.set(0,"meep!");
  res=sprinter.exec(ts);
  assertEquals("meep!",res);
  String input="vararg_sprintf_test_jira_3939.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate SPRINTF('%6s|%-8s|%2$,+12d %2$8x', 'yay', 665568);");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("   yay|665568  |    +665,568    a27e0",t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGIntermediate() throws Exception {
  String[] avgTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    String inputType=getInputType(avgTypes[k]);
    Tuple tup=inputMap.get(inputType);
    DataBag bag=(DataBag)tup.get(0);
    DataBag bg=bagFactory.newDefaultBag();
    for (    Tuple t : bag) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (inputType == "BigDecimal") {
        newTuple.set(1,BigDecimal.ONE);
      }
 else       if (inputType == "BigInteger") {
        newTuple.set(1,BigInteger.ONE);
      }
 else {
        newTuple.set(1,new Long(1));
      }
      bg.add(newTuple);
    }
    Tuple intermediateInput=tupleFactory.newTuple();
    intermediateInput.append(bg);
    Object output=avg.exec(intermediateInput);
    if (inputType == "Long" || inputType == "Integer" || inputType == "IntegerAsLong") {
      Long l=(Long)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ l+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,getExpected(avgTypes[k]),l);
    }
 else     if (inputType == "BigDecimal") {
      BigDecimal f1=(BigDecimal)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),f1.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f1=(BigInteger)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigInteger)getExpected(avgTypes[k])).toString(),f1.toString());
    }
 else {
      Double f1=(Double)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,(Double)getExpected(avgTypes[k]),f1,0.00001);
    }
    if (inputType == "BigDecimal") {
      BigDecimal f2=(BigDecimal)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f2=(BigInteger)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toString());
    }
 else {
      Long f2=(Long)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 11",11,f2.longValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCOUNT_STARFinal() throws Exception {
  long input[]={23,38,39};
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  EvalFunc<Long> count=new COUNT_STAR.Final();
  Long output=count.exec(tup);
  assertEquals("Expected count to be 100",100,output.longValue());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCOUNT() throws Exception {
  Integer input[]={1,2,3,4,5,6,7,8,9,10,null};
  long expected=input.length - 1;
  EvalFunc<Long> count=new COUNT();
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  Long output=count.exec(tup);
  assertTrue(output == expected);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDistinct() throws Exception {
  Integer[] inp=new Integer[]{1,2,3,1,4,5,3};
  DataBag inputBag=Util.createBagOfOneColumn(inp);
  EvalFunc<Tuple> initial=new Distinct.Initial();
  DataBag intermedInputBg1=bagFactory.newDefaultBag();
  DataBag intermedInputBg2=bagFactory.newDefaultBag();
  int i=0;
  for (  Tuple t : inputBag) {
    Tuple initialOutput=initial.exec(tupleFactory.newTuple(t));
    if (i < inp.length / 2) {
      intermedInputBg1.add(initialOutput);
    }
 else {
      intermedInputBg2.add(initialOutput);
    }
    i++;
  }
  EvalFunc<Tuple> intermed=new Distinct.Intermediate();
  DataBag finalInputBg=bagFactory.newDefaultBag();
  finalInputBg.add(intermed.exec(tupleFactory.newTuple(intermedInputBg1)));
  finalInputBg.add(intermed.exec(tupleFactory.newTuple(intermedInputBg2)));
  EvalFunc<DataBag> fin=new Distinct.Final();
  DataBag result=fin.exec(tupleFactory.newTuple(finalInputBg));
  Integer[] exp=new Integer[]{1,2,3,4,5};
  DataBag expectedBag=Util.createBagOfOneColumn(exp);
  assertEquals(expectedBag,result);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeySet() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","code");
  Tuple input=TupleFactory.getInstance().newTuple(m);
  KEYSET keySet=new KEYSET();
  DataBag result=keySet.exec(input);
  Iterator<Tuple> i=result.iterator();
  assertEquals(result.size(),m.size());
  while (i.hasNext()) {
    Tuple t=i.next();
    assertTrue(m.containsKey((String)t.get(0)));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringUDFs() throws Exception {
  String inputStr="amy smith ";
  File inputFile=Util.createInputFile("tmp","testStrUDFsIn.txt",new String[]{inputStr});
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (name: chararray);");
  pigServer.registerQuery("B = foreach @ generate SUBSTRING(name, 0, 3), " + "INDEXOF(name, 'a'), INDEXOF(name, 'a', 3), LAST_INDEX_OF(name, 'a'), REPLACE(name, 'a', 'b'), " + "STRSPLIT(name), STRSPLIT(name, ' '), STRSPLIT(name, ' ', 0), STRSPLITTOBAG(name), STRSPLITTOBAG(name,' ')"+ ", STRSPLITTOBAG(name,' ',0), TRIM(name);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  Tuple expected=Util.buildTuple("amy","smith");
  DataBag expectedBag=Util.createBag(new Tuple[]{Util.buildTuple("amy"),Util.buildTuple("smith")});
  assertTrue(!it.hasNext());
  assertEquals(12,t.size());
  assertEquals("amy",t.get(0));
  assertEquals(0,t.get(1));
  assertEquals(-1,t.get(2));
  assertEquals(0,t.get(3));
  assertEquals("bmy smith ",t.get(4));
  assertEquals(expected,t.get(5));
  assertEquals(expected,t.get(6));
  assertEquals(expected,t.get(7));
  assertEquals(expectedBag,t.get(8));
  assertEquals(expectedBag,t.get(9));
  assertEquals(expectedBag,t.get(10));
  assertEquals("amy smith",t.get(11));
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (name);");
  pigServer.registerQuery("B = foreach @ generate SUBSTRING(name, 0, 3), " + "LAST_INDEX_OF(name, 'a'), REPLACE(name, 'a', 'b'), TRIM(name);");
  it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  t=it.next();
  assertTrue(!it.hasNext());
  assertEquals(4,t.size());
  assertEquals("amy",t.get(0));
  assertEquals(0,t.get(1));
  assertEquals("bmy smith ",t.get(2));
  assertEquals("amy smith",t.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSFPig() throws Exception {
  Util.resetStateForExecModeSwitch();
  PigServer mrPigServer=new PigServer(cluster.getExecType(),properties);
  String inputStr="amy\tbob\tcharlene\tdavid\terin\tfrank";
  Util.createInputFile(cluster,"testSFPig-input.txt",new String[]{inputStr});
  DataByteArray[] input={new DataByteArray("amy"),new DataByteArray("bob"),new DataByteArray("charlene"),new DataByteArray("david"),new DataByteArray("erin"),new DataByteArray("frank")};
  Tuple f1=Util.loadTuple(TupleFactory.getInstance().newTuple(input.length),input);
  String outputLocation="testSFPig-output.txt";
  String query="a = load 'testSFPig-input.txt';" + "store a into '" + outputLocation + "';";
  mrPigServer.setBatchOn();
  Util.registerMultiLineQuery(mrPigServer,query);
  mrPigServer.executeBatch();
  LoadFunc lfunc=new ReadToEndLoader(new PigStorage(),ConfigurationUtil.toConfiguration(cluster.getProperties()),outputLocation,0);
  Tuple f2=lfunc.getNext();
  Util.deleteFile(cluster,"testSFPig-input.txt");
  Util.deleteFile(cluster,outputLocation);
  assertEquals(f1,f2);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMIntermed() throws Exception {
  String[] sumTypes={"SUMIntermediate","DoubleSumIntermediate","LongSumIntermediate","IntSumIntermediate","FloatSumIntermediate","BigDecimalSumIntermediate","BigIntegerSumIntermediate"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ ((Tuple)output).get(0)+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)((Tuple)output).get(0),(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal") {
      assertEquals(msg,((BigDecimal)((Tuple)output).get(0)).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
    }
 else     if (inputType == "BigInteger") {
      assertEquals(msg,((BigInteger)((Tuple)output).get(0)).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
    }
 else {
      assertEquals(msg,(Double)((Tuple)output).get(0),(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDistinctProgressNonAlgebraic() throws Exception {
  int inputSize=2002;
  Integer[] inp=new Integer[inputSize];
  for (int i=0; i < inputSize; i+=2) {
    inp[i]=i / 2;
    inp[i + 1]=i / 2;
  }
  DataBag inputBag=Util.createBagOfOneColumn(inp);
  EvalFunc<DataBag> distinct=new Distinct();
  DataBag result=distinct.exec(tupleFactory.newTuple(inputBag));
  Integer[] exp=new Integer[inputSize / 2];
  for (int j=0; j < inputSize / 2; ++j) {
    exp[j]=j;
  }
  DataBag expectedBag=Util.createBagOfOneColumn(exp);
  assertEquals(expectedBag,result);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGFinal() throws Exception {
  String[] avgTypes={"AVGFinal","DoubleAvgFinal","LongAvgFinal","IntAvgFinal","FloatAvgFinal","BigDecimalAvgFinal","BigIntegerAvgFinal"};
  String[] avgIntermediateTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    EvalFunc<?> avgIntermediate=evalFuncMap.get(avgIntermediateTypes[k]);
    DataBag bg=(DataBag)tup.get(0);
    DataBag bg1=bagFactory.newDefaultBag();
    DataBag bg2=bagFactory.newDefaultBag();
    int i=0;
    for (    Tuple t : bg) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (t.get(0) == null) {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ZERO);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ZERO);
        }
 else {
          newTuple.set(1,new Long(0));
        }
      }
 else {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ONE);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ONE);
        }
 else {
          newTuple.set(1,new Long(1));
        }
      }
      if (i < 5) {
        bg1.add(newTuple);
      }
 else {
        bg2.add(newTuple);
      }
      i++;
    }
    Tuple intermediateInput1=tupleFactory.newTuple();
    intermediateInput1.append(bg1);
    Object output1=avgIntermediate.exec(intermediateInput1);
    Tuple intermediateInput2=tupleFactory.newTuple();
    intermediateInput2.append(bg2);
    Object output2=avgIntermediate.exec(intermediateInput2);
    DataBag bag=Util.createBag(new Tuple[]{(Tuple)output1,(Tuple)output2});
    Tuple finalTuple=TupleFactory.getInstance().newTuple(1);
    finalTuple.set(0,bag);
    Object output=avg.exec(finalTuple);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
    }
 else {
      assertEquals(msg,(Double)getExpected(avgTypes[k]),(Double)output,0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is not called - so initial is called
 * and then final is called
 * @throws Exception
 */
@Test public void testAggNoCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Final")) {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
 else {
        continue;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> avgInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        finalInputBg.add((Tuple)avgInitial.exec(initialInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for no combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMathFuncs() throws Exception {
  Random generator=new Random();
  generator.setSeed(System.currentTimeMillis());
  Double delta=0.1;
  String[] mathFuncs={"SIN","SINH","ASIN","COS","COSH","ACOS","TAN","TANH","ATAN","LOG","LOG10","SQRT","CEIL","EXP","FLOOR","CBRT"};
  String udfPackage="org.apache.pig.builtin.";
  EvalFunc<Double> evalFunc;
  Tuple tup;
  Double input, actual, expected;
  Method mathMethod;
  String msg;
  for (  String func : mathFuncs) {
    evalFunc=(EvalFunc<Double>)Class.forName(udfPackage + func).newInstance();
    tup=TupleFactory.getInstance().newTuple(1);
    input=generator.nextDouble();
    tup.set(0,input);
    mathMethod=Math.class.getDeclaredMethod(func.toLowerCase(),double.class);
    actual=evalFunc.exec(tup);
    expected=(Double)mathMethod.invoke(null,input);
    msg="[Testing " + func + " on input: "+ input+ " ( (actual) "+ actual+ " == "+ expected+ " (expected) )]";
    assertEquals(msg,actual,expected,delta);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testROUND() throws Exception {
  Double dbl=0.987654321d;
  Float flt=0.987654321f;
  EvalFunc<Long> rounder=new ROUND();
  Tuple tup=TupleFactory.getInstance().newTuple(1);
  long expected, lng_out;
  tup.set(0,dbl);
  expected=Math.round(dbl);
  lng_out=rounder.exec(tup);
  assertEquals(expected,lng_out);
  tup.set(0,flt);
  expected=Math.round(flt);
  lng_out=rounder.exec(tup);
  assertEquals(expected,lng_out);
  tup.set(0,4.6d);
  assertEquals(5l,lng_out=rounder.exec(tup));
  tup.set(0,2.4d);
  assertEquals(2l,lng_out=rounder.exec(tup));
  tup.set(0,1.0d);
  assertEquals(1l,lng_out=rounder.exec(tup));
  tup.set(0,-1.0d);
  assertEquals(-1l,lng_out=rounder.exec(tup));
  tup.set(0,-2.4d);
  assertEquals(-2l,lng_out=rounder.exec(tup));
  tup.set(0,-4.6d);
  assertEquals(-5l,lng_out=rounder.exec(tup));
  tup.set(0,3.5d);
  assertEquals(4l,lng_out=rounder.exec(tup));
  tup.set(0,-3.5d);
  assertEquals(-3l,lng_out=rounder.exec(tup));
  tup.set(0,2.5d);
  assertEquals(3l,lng_out=rounder.exec(tup));
  tup.set(0,-2.5d);
  assertEquals(-2l,lng_out=rounder.exec(tup));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInverseMap() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","pig");
  m.put("integer",new Integer(100));
  m.put("floating",new Float(100.012));
  m.put("long",new Long(10000000000000l));
  m.put("boolean",true);
  Tuple input=TupleFactory.getInstance().newTuple(m);
  INVERSEMAP inverseMap=new INVERSEMAP();
  Map inverse=inverseMap.exec(input);
  assertEquals(inverse.size(),7);
  assertTrue(inverse.containsKey("apache"));
  assertTrue(inverse.containsKey("hadoop"));
  assertTrue(inverse.containsKey("pig"));
  assertTrue(inverse.containsKey("100"));
  assertTrue(inverse.containsKey("true"));
  assertTrue(inverse.containsKey("100.012"));
  m.clear();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","apache");
  input.set(0,m);
  inverse=inverseMap.exec(input);
  assertEquals(inverse.size(),2);
  assertTrue(inverse.containsKey("apache"));
  assertTrue(inverse.containsKey("hadoop"));
  DataBag bag=(DataBag)inverse.get("apache");
  List resultList=new ArrayList<String>();
  Iterator<Tuple> i=bag.iterator();
  while (i.hasNext()) {
    Tuple t=i.next();
    resultList.add(t.get(0));
  }
  Collections.sort(resultList);
  assertEquals((String)resultList.get(0),"open");
  assertEquals((String)resultList.get(1),"source");
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testCOUNTBagNullCheck() throws Exception {
  DataBag b=null;
  Tuple t=TupleFactory.getInstance().newTuple(b);
  EvalFunc<Long> count=new COUNT();
  assertNull(count.exec(t));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringFuncs() throws Exception {
  String inputStr="Hello World!";
  String inputStrLower="hello world!";
  String inputStrUpper="HELLO WORLD!";
  String inputStrCamel="hello World!";
  String inputStroWitha="Hella Warld!";
  String inputStrSpaceRight="Hello World!   ";
  String inputStrSpaceLeft="   Hello World!";
  String inputStrSpaceBoth="   Hello World!   ";
  List l=new LinkedList();
  l.add(inputStr);
  l.add("o");
  String expected=null;
  Tuple input;
  String output;
  Integer intOutput;
  EvalFunc<String> strFunc;
  EvalFunc<Integer> intFunc;
  strFunc=new LCFIRST();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrCamel;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new UCFIRST();
  input=TupleFactory.getInstance().newTuple(inputStrCamel);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  intFunc=new LAST_INDEX_OF();
  input=TupleFactory.getInstance().newTuple(l);
  intOutput=intFunc.exec(input);
  assertTrue(intOutput.intValue() == 7);
  intFunc=new INDEXOF();
  input=TupleFactory.getInstance().newTuple(l);
  intOutput=intFunc.exec(input);
  assertTrue(intOutput.intValue() == 4);
  strFunc=new UPPER();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrUpper;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new LOWER();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrLower;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new REPLACE();
  l.clear();
  l.add(inputStr);
  l.add("o");
  l.add("a");
  input=TupleFactory.getInstance().newTuple(l);
  expected=inputStroWitha;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new SUBSTRING();
  l.clear();
  l.add(inputStr);
  l.add(1);
  l.add(5);
  input=TupleFactory.getInstance().newTuple(l);
  expected="ello";
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new TRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceBoth);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new LTRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceLeft);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new RTRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceRight);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  STRSPLIT splitter=new STRSPLIT();
  Tuple test1=TupleFactory.getInstance().newTuple(1);
  Tuple test2=TupleFactory.getInstance().newTuple(2);
  Tuple test3=TupleFactory.getInstance().newTuple(3);
  test2.set(0,"foo");
  test2.set(1,":");
  Tuple splits=splitter.exec(test2);
  assertEquals("no matches should return tuple with original string",1,splits.size());
  assertEquals("no matches should return tuple with original string","foo",splits.get(0));
  test1.set(0,"f ooo bar");
  splits=splitter.exec(test1);
  assertEquals("split on default value ",3,splits.size());
  assertEquals("f",splits.get(0));
  assertEquals("ooo",splits.get(1));
  assertEquals("bar",splits.get(2));
  test1.set(0,"foo bar  ");
  splits=splitter.exec(test1);
  assertEquals("whitespace trimmed if no length arg",2,splits.size());
  test3.set(0,"foo bar   ");
  test3.set(1,"\\s");
  test3.set(2,10);
  splits=splitter.exec(test3);
  assertEquals("length forces empty string matches on end",5,splits.size());
  test3.set(0,"foo:bar:baz");
  test3.set(1,":");
  test3.set(2,2);
  splits=splitter.exec(test3);
  assertEquals(2,splits.size());
  assertEquals("foo",splits.get(0));
  assertEquals("bar:baz",splits.get(1));
  Tuple t1=TupleFactory.getInstance().newTuple(3);
  t1.set(0,"/search/iy/term1/test");
  t1.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t1.set(2,1);
  Tuple t2=TupleFactory.getInstance().newTuple(3);
  t2.set(0,"/search/iy/term1/test");
  t2.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t2.set(2,2);
  Tuple t3=TupleFactory.getInstance().newTuple(3);
  t3.set(0,null);
  t3.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t3.set(2,2);
  Tuple t4=tupleFactory.newTuple(3);
  t4.set(0,"this is a match");
  t4.set(1,"this is a (.+?)");
  t4.set(2,1);
  REGEX_EXTRACT func=new REGEX_EXTRACT();
  String r=func.exec(t1);
  assertTrue(r.equals("term1"));
  r=func.exec(t2);
  assertTrue(r == null);
  r=func.exec(t3);
  assertTrue(r == null);
  r=func.exec(t4);
  assertEquals("m",r);
  func=new REGEX_EXTRACT("true");
  r=func.exec(t4);
  assertEquals("match",r);
  String matchRegex="^(.+)\\b\\s+is a\\s+\\b(.+)$";
  TupleFactory tupleFactory=TupleFactory.getInstance();
  Tuple te1=tupleFactory.newTuple(2);
  te1.set(0,"this is a match");
  te1.set(1,matchRegex);
  Tuple te2=tupleFactory.newTuple(2);
  te2.set(0,"no match");
  te2.set(1,matchRegex);
  Tuple te3=tupleFactory.newTuple(2);
  te3.set(0,null);
  te3.set(1,matchRegex);
  REGEX_EXTRACT_ALL funce=new REGEX_EXTRACT_ALL();
  Tuple re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("this",re.get(0));
  assertEquals("match",re.get(1));
  re=funce.exec(te2);
  assertTrue(re == null);
  re=funce.exec(te3);
  assertTrue(re == null);
  matchRegex="(.+?)(.+?)";
  tupleFactory=TupleFactory.getInstance();
  te1=tupleFactory.newTuple(2);
  te1.set(0,"this is a match");
  te1.set(1,matchRegex);
  funce=new REGEX_EXTRACT_ALL();
  re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("t",re.get(0));
  assertEquals("his is a match",re.get(1));
  funce=new REGEX_EXTRACT_ALL("false");
  re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("t",re.get(0));
  assertEquals("h",re.get(1));
  re=funce.exec(te2);
  assertTrue(re == null);
  re=funce.exec(te3);
  assertTrue(re == null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCOUNT_STAR() throws Exception {
  Integer input[]={1,2,3,4,5,6,7,8,9,10,null};
  long expected=input.length;
  EvalFunc<Long> count=new COUNT_STAR();
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  Long output=count.exec(tup);
  assertTrue(output == expected);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called more than once - so initial is called
 * and then Intermediate called couple of times and then final is called
 * @throws Exception
 */
@Test public void testAggMultipleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag[] mapIntermediateInputBgs=new DataBag[4];
      for (int i=0; i < mapIntermediateInputBgs.length; i++) {
        mapIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      Iterator<Tuple> it=bg.iterator();
      for (int i=0; i < 4; i++) {
        for (int j=0; j < bg.size() / 4; j++) {
          DataBag initialInputBg=bagFactory.newDefaultBag();
          initialInputBg.add(it.next());
          Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
          mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
        }
        if (i == 3) {
          while (it.hasNext()) {
            DataBag initialInputBg=bagFactory.newDefaultBag();
            initialInputBg.add(it.next());
            Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
            mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
          }
        }
      }
      EvalFunc<?> aggIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag[] reduceIntermediateInputBgs=new DataBag[2];
      for (int i=0; i < reduceIntermediateInputBgs.length; i++) {
        reduceIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      for (int i=0; i < 4; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(mapIntermediateInputBgs[i]);
        if (i < 2) {
          reduceIntermediateInputBgs[0].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
 else {
          reduceIntermediateInputBgs[1].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
      }
      DataBag finalInputBag=bagFactory.newDefaultBag();
      for (int i=0; i < 2; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(reduceIntermediateInputBgs[i]);
        finalInputBag.add((Tuple)aggIntermediate.exec(intermediateInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBag);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for multiple combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testValueList() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","apache");
  Tuple input=TupleFactory.getInstance().newTuple(m);
  VALUELIST valueList=new VALUELIST();
  DataBag result=valueList.exec(input);
  assertEquals(result.size(),3);
  Iterator<Tuple> i=result.iterator();
  List resultList=new ArrayList();
  while (i.hasNext()) {
    Tuple t=i.next();
    resultList.add(t.get(0));
  }
  Collections.sort(resultList);
  assertEquals((String)resultList.get(0),"apache");
  assertEquals((String)resultList.get(1),"apache");
  assertEquals((String)resultList.get(2),"hadoop");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleSize() throws Exception {
  String inputFileName="TupleSizeIn.txt";
  String[] inputData=new String[]{"Don't call my name, don't call my name, Alejandro","I'm not your babe, I'm not your babe, Fernando","Don't wanna kiss, don't wanna touch","Just smoke my cigarette and hush","Don't call my name, don't call my name, Roberto"};
  File inputFile=Util.createInputFile("tmp",inputFileName,inputData);
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS value:chararray;");
  pigServer.registerQuery("=> foreach @ generate STRSPLIT(value, ' ') AS values;");
  pigServer.registerQuery("C = foreach @ generate values, SIZE(values) as cnt;");
  Iterator<Tuple> it=pigServer.openIterator("C");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals("Testing SIZE(<Tuple>): ",new Long(new StringTokenizer(inputData[i]).countTokens()),t.get(1));
    i++;
  }
  inputFile.delete();
  assertTrue(!it.hasNext());
  assertTrue(i == inputData.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAVG() throws Exception {
  String[] avgTypes={"AVG","DoubleAvg","LongAvg","IntAvg","FloatAvg","BigDecimalAvg","BigIntegerAvg"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    Object output=avg.exec(tup);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(avgTypes[k])).toPlainString());
    }
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(avgTypes[k]),0.00001);
    }
    assertNull(avg.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCOUNTFinal() throws Exception {
  long input[]={23,38,39};
  Tuple tup=Util.loadNestTuple(TupleFactory.getInstance().newTuple(1),input);
  EvalFunc<Long> count=new COUNT.Final();
  Long output=count.exec(tup);
  assertEquals("Expected count to be 100",100,output.longValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCase </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that CASE statement works when expressions contain dereference operators.
 * @throws Exception
 */
@Test public void testWithDereferenceOperator() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple("a","x",1),tuple("a","y",1),tuple("b","x",2),tuple("b","y",2),tuple("c","x",3),tuple("c","y",3));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (c1:chararray, c2:chararray, i:int);");
  pigServer.registerQuery("B = GROUP A BY (c1, i);");
  pigServer.registerQuery("C = FOREACH B GENERATE group.i, (" + "  CASE group.i % 3" + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ "), A.(c1, c2);");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(3,out.size());
  assertEquals(tuple(1,"3n+1",bag(tuple("a","x"),tuple("a","y"))),out.get(0));
  assertEquals(tuple(2,"3n+2",bag(tuple("b","x"),tuple("b","y"))),out.get(1));
  assertEquals(tuple(3,"3n",bag(tuple("c","x"),tuple("c","y"))),out.get(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that conditional CASE statement with else branch works correctly.
 * @throws Exception
 */
@Test public void testConditionalWithElse() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5),tuple(6),tuple(7));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE i, (" + "  CASE " + "    WHEN i % 4 == 0 THEN '4n'"+ "    WHEN i % 4 == 1 THEN '4n+1'"+ "    WHEN i % 4 == 2 THEN '4n+2'"+ "    ELSE                 '4n+3'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(7,out.size());
  assertEquals(tuple(1,"4n+1"),out.get(0));
  assertEquals(tuple(2,"4n+2"),out.get(1));
  assertEquals(tuple(3,"4n+3"),out.get(2));
  assertEquals(tuple(4,"4n"),out.get(3));
  assertEquals(tuple(5,"4n+1"),out.get(4));
  assertEquals(tuple(6,"4n+2"),out.get(5));
  assertEquals(tuple(7,"4n+3"),out.get(6));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that CASE statement with else branch works correctly.
 * @throws Exception
 */
@Test public void testWithElseBranch() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5),tuple(6),tuple(7));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE i, (" + "  CASE i % 4" + "    WHEN 0 THEN '4n'"+ "    WHEN 1 THEN '4n+1'"+ "    WHEN 2 THEN '4n+2'"+ "    ELSE        '4n+3'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(7,out.size());
  assertEquals(tuple(1,"4n+1"),out.get(0));
  assertEquals(tuple(2,"4n+2"),out.get(1));
  assertEquals(tuple(3,"4n+3"),out.get(2));
  assertEquals(tuple(4,"4n"),out.get(3));
  assertEquals(tuple(5,"4n+1"),out.get(4));
  assertEquals(tuple(6,"4n+2"),out.get(5));
  assertEquals(tuple(7,"4n+3"),out.get(6));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that CASE statement preserves the order of conditions.
 * @throws Exception
 */
@Test public void testOrderOfConditions() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(5),tuple(10),tuple(15),tuple(20),tuple(25),tuple(30));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE i, (" + "  CASE " + "    WHEN i > 20 THEN '> 20'"+ "    WHEN i > 10 THEN '> 10'"+ "    ELSE             '> 0'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(7,out.size());
  assertEquals(tuple(1,"> 0"),out.get(0));
  assertEquals(tuple(5,"> 0"),out.get(1));
  assertEquals(tuple(10,"> 0"),out.get(2));
  assertEquals(tuple(15,"> 10"),out.get(3));
  assertEquals(tuple(20,"> 10"),out.get(4));
  assertEquals(tuple(25,"> 20"),out.get(5));
  assertEquals(tuple(30,"> 20"),out.get(6));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that CASE statement without else branch works correctly.
 * @throws Exception
 */
@Test public void testNoElseBranch() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5),tuple(6),tuple(7));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE i, (" + "  CASE i % 5" + "    WHEN 0 THEN '5n'"+ "    WHEN 1 THEN '5n+1'"+ "    WHEN 2 THEN '5n+2'"+ "    WHEN 3 THEN '5n+3'"+ "  END"+ ") AS s;");
  pigServer.registerQuery("C = FILTER B BY s IS NOT NULL;");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(6,out.size());
  assertEquals(tuple(1,"5n+1"),out.get(0));
  assertEquals(tuple(2,"5n+2"),out.get(1));
  assertEquals(tuple(3,"5n+3"),out.get(2));
  assertEquals(tuple(5,"5n"),out.get(3));
  assertEquals(tuple(6,"5n+1"),out.get(4));
  assertEquals(tuple(7,"5n+2"),out.get(5));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that conditional CASE statement without else branch works correctly.
 * @throws Exception
 */
@Test public void testConditionalWithNoElse() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5),tuple(6),tuple(7));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE i, (" + "  CASE " + "    WHEN i % 5 == 0 THEN '5n'"+ "    WHEN i % 5 == 1 THEN '5n+1'"+ "    WHEN i % 5 == 2 THEN '5n+2'"+ "    WHEN i % 5 == 3 THEN '5n+3'"+ "  END"+ ") AS s;");
  pigServer.registerQuery("C = FILTER B BY s IS NOT NULL;");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(6,out.size());
  assertEquals(tuple(1,"5n+1"),out.get(0));
  assertEquals(tuple(2,"5n+2"),out.get(1));
  assertEquals(tuple(3,"5n+3"),out.get(2));
  assertEquals(tuple(5,"5n"),out.get(3));
  assertEquals(tuple(6,"5n+1"),out.get(4));
  assertEquals(tuple(7,"5n+2"),out.get(5));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCharArrayToNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArrayToIntAndLongScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Long> map=new HashMap<Integer,Long>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      long value=rand.nextInt(100);
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input2.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.INTEGER,DataType.LONG};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input2.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.LONG) {
          Long expected=map.get(key);
          if (value != null) {
            Long actual=Long.parseLong(value);
            assertEquals(expected,actual);
          }
 else {
            assertEquals(expected,null);
          }
        }
        if (type == DataType.INTEGER) {
          Integer expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).intValue();
          }
          if (value != null) {
            Integer actual=Integer.parseInt(value);
            assertEquals(expected,actual);
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input2.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArray2FloatAndDoubleScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Double> map=new HashMap<Integer,Double>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      double value=rand.nextDouble() * 100;
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input1.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.DOUBLE,DataType.FLOAT};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input1.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.DOUBLE) {
          Double expected=map.get(key);
          if (value != null) {
            assertEquals(expected,(Double)Double.parseDouble(value));
          }
 else {
            assertNull(expected);
          }
        }
        if (type == DataType.FLOAT) {
          Float expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).floatValue();
          }
          if (value != null) {
            assertEquals(expected,(Float)Float.parseFloat(value));
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input1.txt");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCollectedGroup </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCollectedGrpSpecifiedInSingleQuotes2() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, grade);"+ "B = group A all using 'regular';"+ "Store B into 'y';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  LOStore store=(LOStore)lp.getSinks().get(0);
  LOCogroup grp=(LOCogroup)lp.getPredecessors(store).get(0);
  Assert.assertEquals(LOCogroup.GROUPTYPE.REGULAR,grp.getGroupType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCollectedGrpSpecifiedInSingleQuotes1() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, grade);"+ "B = group A by id using 'collected';"+ "Store B into 'y';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  LOStore store=(LOStore)lp.getSinks().get(0);
  LOCogroup grp=(LOCogroup)lp.getPredecessors(store).get(0);
  Assert.assertEquals(LOCogroup.GROUPTYPE.COLLECTED,grp.getGroupType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCombiner </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctAggs1() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctAggs1Input.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctAggs1Input.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        x = distinct a.age;" + "        y = distinct a.gpa;"+ "        z = distinct a;"+ "        generate group, COUNT(x), SUM(x.age), SUM(y.gpa), SUM(a.age), "+ "                       SUM(a.gpa), COUNT(z.age), COUNT(z), SUM(z.age);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertTrue(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1",3L,57L,5.2,75L,9.4,3L,3L,57L});
  results.put("pig2",new Object[]{"pig2",1L,24L,7.8,48L,7.8,2L,2L,48L});
  results.put("pig5",new Object[]{"pig5",1L,45L,2.4,45L,2.4,1L,1L,45L});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctAggs1Input.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"forEachNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'forEachNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = a.age;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"forEachNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiCombinerUse() throws Exception {
  String[] input=new String[500 * 1024];
  for (int i=0; i < input.length; i++) {
    if (i % 2 == 0) {
      input[i]=Integer.toString(1);
    }
 else {
      input[i]=Integer.toString(0);
    }
  }
  Util.createInputFile(cluster,"MultiCombinerUseInput.txt",input);
  String oldValue=properties.getProperty("io.sort.mb");
  properties.setProperty("io.sort.mb","1");
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.getPigContext().getProperties().setProperty(MRConfiguration.CHILD_JAVA_OPTS,"-Xmx1024m");
  pigServer.registerQuery("a = load 'MultiCombinerUseInput.txt' as (x:int);");
  pigServer.registerQuery("b = group a all;");
  pigServer.registerQuery("c = foreach b generate COUNT(a), SUM(a.$0), " + "MIN(a.$0), MAX(a.$0), AVG(a.$0), ((double)SUM(a.$0))/COUNT(a.$0)," + " COUNT(a.$0) + SUM(a.$0) +  MAX(a.$0);");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertTrue(baos.toString().matches("(?si).*combine plan.*"));
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  assertEquals(512000L,t.get(0));
  assertEquals(256000L,t.get(1));
  assertEquals(0,t.get(2));
  assertEquals(1,t.get(3));
  assertEquals(0.5,t.get(4));
  assertEquals(0.5,t.get(5));
  assertEquals(512000L + 256000L + 1,t.get(6));
  assertFalse(it.hasNext());
  Util.deleteFile(cluster,"MultiCombinerUseInput.txt");
  if (oldValue == null) {
    properties.remove("io.sort.mb");
  }
 else {
    properties.setProperty("io.sort.mb",oldValue);
  }
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = distinct a;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCommit </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckin1() throws Exception {
  Tuple expected1=mTf.newTuple(2);
  Tuple expected2=mTf.newTuple(2);
  expected1.set(0,"independent");
  expected1.set(1,50.0);
  expected2.set(0,"democrat");
  expected2.set(1,125.5);
  File studentFile=Util.createInputFile("tmp","student",new String[]{"joe smith:18:3.5","amy brown:25:2.5","jim fox:20:4.0","leo fu:55:3.0"});
  File voterFile=Util.createInputFile("tmp","voter",new String[]{"amy brown,25,democrat,25.50","amy brown,25,democrat,100","jim fox,20,independent,50.0"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(studentFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(':') as (name, age, gpa);");
  pigServer.registerQuery("b = load '" + Util.encodeEscape(voterFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(',') as (name, age, registration, contributions);");
  pigServer.registerQuery("c = filter a by age < 50;");
  pigServer.registerQuery("d = filter b by age < 50;");
  pigServer.registerQuery("e = cogroup c by (name, age), d by (name, age);");
  pigServer.registerQuery("f = foreach @ generate flatten(c), flatten(d);");
  pigServer.registerQuery("g = group @ by registration;");
  pigServer.registerQuery("h = foreach @ generate (chararray)group, SUM(f.d::contributions);");
  pigServer.registerQuery("i = order @ by $1;");
  Iterator<Tuple> iter=pigServer.openIterator("i");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    count++;
    if (count == 1) {
      assertEquals(t.get(0),expected1.get(0));
      assertEquals(t.get(1),expected1.get(1));
    }
 else     if (count == 2) {
      assertEquals(t.get(0),expected2.get(0));
      assertEquals(t.get(1),expected2.get(1));
    }
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConstExpr </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataByteArray() throws ExecException {
  DataByteArray inp=GenRandomData.genRandDBA(r);
  ce.setValue(inp);
  Result resba=ce.getNextDataByteArray();
  DataByteArray ret=(DataByteArray)resba.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resba=ce.getNextDataByteArray();
  ret=(DataByteArray)resba.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException {
  Tuple inp=GenRandomData.genRandSmallBagTuple(r,10,100);
  ce.setValue(inp);
  Result rest=ce.getNextTuple();
  Tuple ret=(Tuple)rest.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  rest=ce.getNextTuple();
  ret=(Tuple)rest.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextInteger() throws ExecException {
  Integer inp=r.nextInt();
  ce.setValue(inp);
  Result resi=ce.getNextInteger();
  Integer ret=(Integer)resi.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resi=ce.getNextInteger();
  ret=(Integer)resi.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextLong() throws ExecException {
  Long inp=r.nextLong();
  ce.setValue(inp);
  Result resl=ce.getNextLong();
  Long ret=(Long)resl.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resl=ce.getNextLong();
  ret=(Long)resl.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDouble() throws ExecException {
  Double inp=r.nextDouble();
  ce.setValue(inp);
  Result resd=ce.getNextDouble();
  Double ret=(Double)resd.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resd=ce.getNextDouble();
  ret=(Double)resd.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextFloat() throws ExecException {
  Float inp=r.nextFloat();
  ce.setValue(inp);
  Result resf=ce.getNextFloat();
  Float ret=(Float)resf.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resf=ce.getNextFloat();
  ret=(Float)resf.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextString() throws ExecException {
  String inp=GenRandomData.genRandString(r);
  ce.setValue(inp);
  Result ress=ce.getNextString();
  String ret=(String)ress.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  ress=ce.getNextString();
  ret=(String)ress.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextMap() throws ExecException {
  Map<String,Object> inp=GenRandomData.genRandMap(r,10);
  ce.setValue(inp);
  Result resm=ce.getNextMap();
  Map<Integer,String> ret=(Map)resm.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resm=ce.getNextMap();
  ret=(Map)resm.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextBoolean() throws ExecException {
  Boolean inp=r.nextBoolean();
  ce.setValue(inp);
  Result res=ce.getNextBoolean();
  Boolean ret=(Boolean)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextBoolean();
  ret=(Boolean)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataBag() throws ExecException {
  DataBag inp=GenRandomData.genRandSmallTupDataBag(r,10,100);
  ce.setValue(inp);
  Result res=ce.getNextDataBag();
  DataBag ret=(DataBag)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextDataBag();
  ret=(DataBag)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConversions </h4><pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOverflow() throws IOException, ParserException {
  Schema schema;
  ResourceFieldSchema rfs;
  Tuple tuple, convertedTuple;
  tuple=TupleFactory.getInstance().newTuple(1);
  schema=Utils.getSchemaFromString("t:tuple(a:int)");
  rfs=new ResourceSchema(schema).getFields()[0];
  tuple.set(0,Integer.valueOf(Integer.MAX_VALUE).longValue() + 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MIN_VALUE).longValue() - 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MAX_VALUE).doubleValue() + 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MIN_VALUE).doubleValue() - 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  schema=Utils.getSchemaFromString("t:tuple(a:long)");
  rfs=new ResourceSchema(schema).getFields()[0];
  tuple.set(0,Long.valueOf(Long.MAX_VALUE).doubleValue() + 10000);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to long: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Long.valueOf(Long.MIN_VALUE).doubleValue() - 10000);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to long: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIntegerToBytes() throws IOException {
  Integer i=r.nextInt();
  assertTrue(DataType.equalByteArrays(i.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(i)));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDoubleToBytes() throws IOException {
  Double d=r.nextDouble();
  assertTrue(DataType.equalByteArrays(d.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(d)));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBytesToMap() throws IOException {
  ResourceFieldSchema fs=GenRandomData.getRandMapFieldSchema();
  for (int i=0; i < MAX; i++) {
    Map<String,Object> m=GenRandomData.genRandMap(r,5);
    String expectedMapString=DataType.mapToString(m);
    Map<String,Object> convertedMap=ps.getLoadCaster().bytesToMap(expectedMapString.getBytes(),fs);
    assertTrue(TestHelper.mapEquals(m,convertedMap));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBoolean() throws IOException {
  String[] a={"true","True","TRUE","false","False","FALSE"};
  Boolean[] b={Boolean.TRUE,Boolean.TRUE,Boolean.TRUE,Boolean.FALSE,Boolean.FALSE,Boolean.FALSE};
  for (int i=0; i < b.length; ++i) {
    byte[] bytes=a[i].getBytes();
    assertEquals(b[i],ps.getLoadCaster().bytesToBoolean(bytes));
  }
  a=new String[]{"neither true nor false"};
  for (  String s : a) {
    byte[] bytes=s.getBytes();
    Boolean bool=ps.getLoadCaster().bytesToBoolean(bytes);
    assertNull(bool);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCharArrayToBytes() throws IOException {
  String s=GenRandomData.genRandString(r);
  assertTrue(s.equals(new String(((Utf8StorageConverter)ps.getLoadCaster()).toBytes(s))));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToTupleWithConversion() throws IOException {
  for (int i=0; i < 100; i++) {
    Tuple t=GenRandomData.genMixedTupleToConvert(r);
    ResourceFieldSchema fs=GenRandomData.getMixedTupleToConvertFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertTrue(convertedTuple.get(0) instanceof String);
    assertEquals(convertedTuple.get(0),((Integer)t.get(0)).toString());
    assertTrue(convertedTuple.get(1) instanceof Long);
    Integer origValue1=(Integer)t.get(1);
    assertEquals(convertedTuple.get(1),Long.valueOf(origValue1.longValue()));
    assertNull(convertedTuple.get(2));
    assertTrue(convertedTuple.get(3) instanceof Double);
    Float origValue3=(Float)t.get(3);
    assertEquals(((Double)convertedTuple.get(3)).doubleValue(),origValue3.doubleValue(),0.01);
    assertTrue(convertedTuple.get(4) instanceof Float);
    Double origValue4=(Double)t.get(4);
    assertEquals((Float)convertedTuple.get(4),origValue4.floatValue(),0.01);
    assertTrue(convertedTuple.get(5) instanceof String);
    assertEquals(convertedTuple.get(5),t.get(5));
    assertNull(convertedTuple.get(6));
    assertNull(convertedTuple.get(7));
    assertNull(convertedTuple.get(8));
    assertTrue(convertedTuple.get(9) instanceof Boolean);
    String origValue9=(String)t.get(9);
    assertEquals(Boolean.valueOf(origValue9),convertedTuple.get(9));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBytesToTuple() throws IOException {
  for (int i=0; i < MAX; i++) {
    Tuple t=GenRandomData.genRandSmallBagTextTuple(r,1,100);
    ResourceFieldSchema fs=GenRandomData.getSmallBagTextTupleFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertEquals(t,convertedTuple);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBytesToBag() throws IOException {
  ResourceFieldSchema fs=GenRandomData.getFullTupTextDataBagFieldSchema();
  for (int i=0; i < MAX; i++) {
    DataBag b=GenRandomData.genRandFullTupTextDataBag(r,5,100);
    DataBag convertedBag=ps.getLoadCaster().bytesToBag(b.toString().getBytes(),fs);
    assertTrue(b.equals(convertedBag));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToLong() throws IOException {
  String[] a={"1703598819951657279 "," 999888123L  "," 1234 "," 1234","1234 ","1","-2345","123456789012345678","1.1","-23.45","21345345","3422342",""};
  Long[] la={1703598819951657279L,999888123L,1234L,1234L,1234L,1L,-2345L,123456789012345678L,1L,-23L,21345345L,3422342L};
  for (int i=0; i < la.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(la[i],ps.getLoadCaster().bytesToLong(b));
  }
  a=new String[]{"This is a long","1.0e1000","","    "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Long l=ps.getLoadCaster().bytesToLong(b);
    assertNull(l);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLongToBytes() throws IOException {
  Long l=r.nextLong();
  assertTrue(DataType.equalByteArrays(l.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(l)));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToComplexTypeMisc() throws IOException, ParserException {
  String s="(a,b";
  Schema schema=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Tuple t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
  s="{(a,b}";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  DataBag b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="{(a,b)";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="[ab]";
  schema=Utils.getSchemaFromString("m:map[chararray]");
  rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#b";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  Map.Entry<String,Object> entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertNull(entry.getValue());
  s="[#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#}";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#)";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertTrue(m.isEmpty());
  s="(a,b)";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertEquals(2,t.size());
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  s="[a#(1,2,3)]";
  schema=Utils.getSchemaFromString("m:map[]");
  rfs=new ResourceSchema(schema).getFields()[0];
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertTrue(entry.getValue() instanceof DataByteArray);
  assertEquals("(1,2,3)",entry.getValue().toString());
  s="(a,b,(123,456,{(1,2,3)}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertTrue(t.size() == 3);
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  assertTrue(t.get(2) instanceof DataByteArray);
  assertEquals("(123,456,{(1,2,3)})",t.get(2).toString());
  s="(a,b,(123,456,{(1,2,3}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToInteger() throws IOException {
  String[] a={"1234 "," 4321"," 12345 ","1","-2345","1234567","1.1","-23.45",""};
  Integer[] ia={1234,4321,12345,1,-2345,1234567,1,-23};
  for (int i=0; i < ia.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(ia[i],ps.getLoadCaster().bytesToInteger(b));
  }
  a=new String[]{"1234567890123456","This is an int","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Integer i=ps.getLoadCaster().bytesToInteger(b);
    assertNull(i);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFloatToBytes() throws IOException {
  Float f=r.nextFloat();
  assertTrue(DataType.equalByteArrays(f.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(f)));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testTupleToBytes() throws IOException {
  Tuple t=GenRandomData.genRandSmallBagTextTuple(r,1,100);
  assertTrue(DataType.equalByteArrays(t.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(t)));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBagWithConversion() throws IOException {
  DataBag b=GenRandomData.genFloatDataBag(r,5,100);
  ResourceFieldSchema fs=GenRandomData.getFloatDataBagFieldSchema(5);
  DataBag convertedBag=ps.getLoadCaster().bytesToBag(b.toString().getBytes(),fs);
  Iterator<Tuple> iter1=b.iterator();
  Iterator<Tuple> iter2=convertedBag.iterator();
  for (int i=0; i < 100; i++) {
    Tuple t1=(Tuple)iter1.next();
    assertTrue(iter2.hasNext());
    Tuple t2=(Tuple)iter2.next();
    for (int j=0; j < 5; j++) {
      assertTrue(t2.get(j) instanceof Integer);
      Integer expectedValue=((Float)t1.get(j)).intValue();
      assertEquals(expectedValue,t2.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMapToBytes() throws IOException {
  Map<String,Object> m=GenRandomData.genRandMap(r,5);
  assertTrue(DataType.equalByteArrays(DataType.mapToString(m).getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(m)));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testBagToBytes() throws IOException {
  DataBag b=GenRandomData.genRandFullTupTextDataBag(r,5,100);
  assertTrue(DataType.equalByteArrays(b.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(b)));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToFloat() throws IOException {
  String[] a={"1","-2.345","12.12334567","1.02e-2",".23344","23.1234567897","12312.33","002312.33","1.02e-2",""};
  Float[] f={1f,-2.345f,12.12334567f,1.02e-2f,.23344f,23.1234567f,12312.33f,2312.33f,1.02e-2f};
  for (int j=0; j < f.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(f[j],ps.getLoadCaster().bytesToFloat(b));
  }
  a=new String[]{"1a.1","23.1234567a890123456","This is a float","","  "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Float fl=ps.getLoadCaster().bytesToFloat(b);
    assertNull(fl);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToDouble() throws IOException {
  String[] a={"1","-2.345","12.12334567890123456","1.02e12","-.23344",""};
  Double[] d={1.0,-2.345,12.12334567890123456,1.02e12,-.23344};
  for (int j=0; j < d.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(d[j],ps.getLoadCaster().bytesToDouble(b));
  }
  a=new String[]{"-0x1.1","-23a.45","This is a double","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Double dl=ps.getLoadCaster().bytesToDouble(b);
    assertNull(dl);
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBytesToChar() throws IOException {
  String[] a={"1","-2345","text","hello\nworld",""};
  for (  String s : a) {
    byte[] b=s.getBytes();
    assertEquals(s,ps.getLoadCaster().bytesToCharArray(b));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDateTimeToBytes() throws IOException {
  DateTime dt=new DateTime(r.nextLong());
  assertTrue(DataType.equalByteArrays(dt.toString().getBytes(),((Utf8StorageConverter)ps.getLoadCaster()).toBytes(dt)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCounters </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapOnlyBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    if (t > 50)     count++;
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = foreach b generate $0 - 50;");
  ExecJob job=pigServer.store("c","output_map_only","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output_map_only",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output_map_only"),true);
  System.out.println("============================================");
  System.out.println("Test case Map Only");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(count,js.getMapOutputRecords());
    assertEquals(0,js.getReduceInputRecords());
    assertEquals(0,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapReduceOnly() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group;");
  ExecJob job=pigServer.store("c","output");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(MAX,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryStores() throws Exception {
  int[] nums=new int[100];
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    nums[t]++;
  }
  pw.close();
  int groups=0;
  for (  int i : nums) {
    if (i > 0)     groups++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 >= 50;");
  pigServer.registerQuery("c = group b by $0;");
  pigServer.registerQuery("d = foreach c generate group;");
  pigServer.registerQuery("e = filter a by $0 < 50;");
  pigServer.registerQuery("f = group e by $0;");
  pigServer.registerQuery("g = foreach f generate group;");
  pigServer.registerQuery("store d into '/tmp/outout1';");
  pigServer.registerQuery("store g into '/tmp/outout2';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats stats=jobs.get(0).getStatistics();
  assertTrue(stats.getOutputLocations().size() == 2);
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout1"),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout2"),true);
  MRJobStats js=(MRJobStats)stats.getJobGraph().getSinks().get(0);
  Map<String,Long> entry=js.getMultiStoreCounters();
  long counter=0;
  for (  Long val : entry.values()) {
    counter+=val;
  }
  assertEquals(groups,counter);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapReduceOnlyBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group;");
  ExecJob job=pigServer.store("c","output","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(MAX,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapOnly() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    if (t > 50)     count++;
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = foreach b generate $0 - 50;");
  ExecJob job=pigServer.store("c","output_map_only");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output_map_only",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output_map_only"),true);
  System.out.println("============================================");
  System.out.println("Test case Map Only");
  System.out.println("============================================");
  JobGraph jg=pigStats.getJobGraph();
  Iterator<JobStats> iter=jg.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(count,js.getMapOutputRecords());
    assertEquals(0,js.getReduceInputRecords());
    assertEquals(0,js.getReduceOutputRecords());
    System.out.println("Hdfs bytes written : " + js.getHdfsBytesWritten());
    assertEquals(filesize,js.getHdfsBytesWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapOnlyMultiQueryStores() throws Exception {
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = filter a by $0 <= 50;");
  pigServer.registerQuery("store b into '/tmp/outout1';");
  pigServer.registerQuery("store c into '/tmp/outout2';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats stats=jobs.get(0).getStatistics();
  assertTrue(stats.getOutputLocations().size() == 2);
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout1"),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout2"),true);
  MRJobStats js=(MRJobStats)stats.getJobGraph().getSinks().get(0);
  Map<String,Long> entry=js.getMultiStoreCounters();
  long counter=0;
  for (  Long val : entry.values()) {
    counter+=val;
  }
  assertEquals(MAX,counter);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapCombineReduceBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group, SUM(a.$1);");
  ExecJob job=pigServer.store("c","output","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapCombineReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(count,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapCombineReduce() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group, SUM(a.$1);");
  ExecJob job=pigServer.store("c","output");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapCombineReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(count,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCustomPartitioner </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCustomPartitionerCross() throws Exception {
  String[] input={"1\t3","1\t2"};
  Util.createInputFile(cluster,"table_testCustomPartitionerCross",input);
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerCross' as (a0:int, a1:int);");
  pigServer.registerQuery("B = ORDER A by $0;");
  pigServer.registerQuery("C = cross A , B PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t;
  Collection<String> results=new HashSet<String>();
  results.add("(1,3,1,2)");
  results.add("(1,3,1,3)");
  results.add("(1,2,1,2)");
  results.add("(1,2,1,3)");
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.size() == 4);
  Assert.assertTrue(results.contains(t.toString()));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.size() == 4);
  Assert.assertTrue(results.contains(t.toString()));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.size() == 4);
  Assert.assertTrue(results.contains(t.toString()));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.size() == 4);
  Assert.assertTrue(results.contains(t.toString()));
  Util.deleteFile(cluster,"table_testCustomPartitionerCross");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBag </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  assertEquals("Size of distinct data bag is incorrect",rightAnswer.size(),b.size());
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTypedTupleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSpillCustomTuple() throws Exception {
  DataBag bag=new DefaultDataBag();
  Tuple t=new MyCustomTuple();
  t.append(1);
  t.append("hello");
  bag.add(t);
  bag.spill();
  Iterator<Tuple> iter=bag.iterator();
  Tuple t2=iter.next();
  assertTrue(t2.equals(t));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedFirstSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 373; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 321; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBagAccess </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagConstantFlatten1() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"sampledata\tnot_used"});
  pigServer.registerQuery("A = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate {(('p1-t1-e1', 'p1-t1-e2'),('p1-t2-e1', 'p1-t2-e2'))," + "(('p2-t1-e1', 'p2-t1-e2'), ('p2-t2-e1', 'p2-t2-e2'))};");
  pigServer.registerQuery("C = foreach B generate $0 as pairbag : { pair: ( t1: (e1, e2), t2: (e1, e2) ) };");
  pigServer.registerQuery("D = foreach C generate FLATTEN(pairbag);");
  pigServer.registerQuery("E = foreach D generate t1.e2 as t1e2, t2.e1 as t2e1;");
  Iterator<Tuple> it=pigServer.openIterator("E");
  Tuple t=it.next();
  assertEquals("p1-t1-e2",t.get(0));
  assertEquals("p1-t2-e1",t.get(1));
  t=it.next();
  assertEquals("p2-t1-e2",t.get(0));
  assertEquals("p2-t2-e1",t.get(1));
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonSpillableDataBag() throws Exception {
  String[][] tupleContents=new String[][]{{"a","b"},{"c","d"},{"e","f"}};
  NonSpillableDataBag bg=new NonSpillableDataBag();
  for (int i=0; i < tupleContents.length; i++) {
    bg.add(Util.createTuple(tupleContents[i]));
  }
  Iterator<Tuple> it=bg.iterator();
  int j=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals(Util.createTuple(tupleContents[j]),t);
    j++;
  }
  assertEquals(tupleContents.length,j);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBagConstantFlatten2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"somestring\t10\t{(a,10),(b,20)}"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (str:chararray, intval:int, bg:bag{t:tuple(s:chararray, i:int)});");
  pigServer.registerQuery("b = foreach a generate str, intval, flatten(bg);");
  pigServer.registerQuery("c = foreach b generate str, intval, s, i;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  int i=0;
  Object[][] results=new Object[][]{{"somestring",new Integer(10),"a",new Integer(10)},{"somestring",new Integer(10),"b",new Integer(20)}};
  Class[] resultClasses=new Class[]{String.class,Integer.class,String.class,Integer.class};
  while (it.hasNext()) {
    Tuple t=it.next();
    for (int j=0; j < resultClasses.length; j++) {
      assertEquals(results[i][j],t.get(j));
      assertEquals(resultClasses[j],t.get(j).getClass());
    }
    i++;
  }
  assertEquals(results.length,i);
  pigServer.registerQuery("c = foreach b generate str, intval, bg::s, bg::i;");
  it=pigServer.openIterator("c");
  i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    for (int j=0; j < resultClasses.length; j++) {
      assertEquals(results[i][j],t.get(j));
      assertEquals(resultClasses[j],t.get(j).getClass());
    }
    i++;
  }
  assertEquals(results.length,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagStoreLoad() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"a\tid1","a\tid2","a\tid3","b\tid4","b\tid5","b\tid6"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (s:chararray, id:chararray);");
  pigServer.registerQuery("b = group a by s;");
  Class[] loadStoreClasses=new Class[]{BinStorage.class,PigStorage.class};
  for (int i=0; i < loadStoreClasses.length; i++) {
    String output="TestDataBagAccess-testBagStoreLoad-" + loadStoreClasses[i].getName() + ".txt";
    pigServer.deleteFile(output);
    pigServer.store("b",output,loadStoreClasses[i].getName());
    pigServer.registerQuery("c = load '" + output + "' using "+ loadStoreClasses[i].getName()+ "() AS "+ "(gp: chararray, bg:bag { t: tuple (sReLoaded: chararray, idReLoaded: chararray)});;");
    Iterator<Tuple> it=pigServer.openIterator("c");
    MultiMap<Object,Object> results=new MultiMap<Object,Object>();
    results.put("a","id1");
    results.put("a","id2");
    results.put("a","id3");
    results.put("b","id4");
    results.put("b","id5");
    results.put("b","id6");
    int j=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      Object groupKey=t.get(0);
      DataBag groupBag=(DataBag)t.get(1);
      Iterator<Tuple> bgIt=groupBag.iterator();
      int k=0;
      while (bgIt.hasNext()) {
        HashMap<Object,Boolean> seen=new HashMap<Object,Boolean>();
        Tuple bgt=bgIt.next();
        assertTrue(bgt.get(0).equals(groupKey));
        Collection values=results.get(groupKey);
        assertTrue(values.contains(bgt.get(1)));
        if (seen.containsKey(bgt.get(1)))         fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate value ("+ bgt.get(1)+ ")");
 else         seen.put(bgt.get(1),true);
        k++;
      }
      assertEquals(3,k);
      j++;
    }
    assertEquals(results.keySet().size(),j);
    pigServer.registerQuery("d = foreach c generate gp, flatten(bg);");
    List<Tuple> resultTuples=new ArrayList<Tuple>();
    resultTuples.add(Util.createTuple(new String[]{"a","a","id1"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id2"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id3"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id4"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id5"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id6"}));
    it=pigServer.openIterator("d");
    j=0;
    HashMap<Tuple,Boolean> seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("e = foreach d generate gp, sReLoaded, idReLoaded;");
    it=pigServer.openIterator("e");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("f = foreach d generate $0, $1, $2;");
    it=pigServer.openIterator("f");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBagConstantAccess() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"sampledata\tnot_used"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("b = foreach a generate {(16, 4.0e-2, 'hello', -101)} as mybag:{t:(i: int, d: double, c: chararray, e : int)};");
  pigServer.registerQuery("c = foreach b generate mybag.i, mybag.d, mybag.c, mybag.e;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  Object[] results=new Object[]{new Integer(16),new Double(4.0e-2),"hello",new Integer(-101)};
  Class[] resultClasses=new Class[]{Integer.class,Double.class,String.class,Integer.class};
  assertEquals(results.length,t.size());
  for (int i=0; i < results.length; i++) {
    DataBag bag=(DataBag)t.get(i);
    assertEquals(results[i],bag.iterator().next().get(0));
    assertEquals(resultClasses[i],bag.iterator().next().get(0).getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=giveMeOneOfEach();
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  for (int i=0; i < 2; i++) {
    Tuple after=tf.newTuple();
    after.readFields(in);
    Object o=after.get(0);
    assertTrue("isa Tuple",o instanceof Tuple);
    Tuple t3=(Tuple)o;
    o=t3.get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(3),(Integer)o);
    o=t3.get(1);
    assertTrue("isa Float",o instanceof Float);
    assertEquals(new Float(3.0),(Float)o);
    o=after.get(1);
    assertTrue("isa Bag",o instanceof DataBag);
    DataBag b=(DataBag)o;
    Iterator<Tuple> j=b.iterator();
    Tuple[] ts=new Tuple[2];
    assertTrue("first tuple in bag",j.hasNext());
    ts[0]=j.next();
    assertTrue("second tuple in bag",j.hasNext());
    ts[1]=j.next();
    o=ts[0].get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(4),(Integer)o);
    o=ts[1].get(0);
    assertTrue("isa String",o instanceof String);
    assertEquals("mary had a little lamb",(String)o);
    o=after.get(2);
    assertTrue("isa Map",o instanceof Map);
    Map<String,Object> m=(Map<String,Object>)o;
    assertEquals("world",(String)m.get("hello"));
    assertEquals("all",(String)m.get("goodbye"));
    assertNull(m.get("fred"));
    o=after.get(3);
    assertTrue("isa Integer",o instanceof Integer);
    Integer ii=(Integer)o;
    assertEquals(new Integer(42),ii);
    o=after.get(4);
    assertTrue("isa Long",o instanceof Long);
    Long l=(Long)o;
    assertEquals(new Long(5000000000L),l);
    o=after.get(5);
    assertTrue("isa Float",o instanceof Float);
    Float f=(Float)o;
    assertEquals(new Float(3.141592654),f);
    o=after.get(6);
    assertTrue("isa Double",o instanceof Double);
    Double d=(Double)o;
    assertEquals(new Double(2.99792458e8),d);
    o=after.get(7);
    assertTrue("isa Boolean",o instanceof Boolean);
    Boolean bool=(Boolean)o;
    assertTrue(bool);
    o=after.get(8);
    assertTrue("isa DataByteArray",o instanceof DataByteArray);
    DataByteArray ba=(DataByteArray)o;
    assertEquals(new DataByteArray("hello"),ba);
    o=after.get(9);
    assertTrue("isa String",o instanceof String);
    String s=(String)o;
    assertEquals("goodbye",s);
  }
  file.delete();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTuple() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  int arity=5;
  int[] input1={1,2,3,4,5};
  String[] input2={"1","2","3","4","5"};
  String[] input3={"1","2","3","4","5","6"};
  Tuple f1=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f2=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f3=tf.newTuple(arity);
  assertEquals(arity,f1.size());
  assertEquals(f1,f2);
  f2=Util.loadTuple(tf.newTuple(input3.length),input3);
  assertFalse(f1.equals(f2));
  int[] input4={1,2,3};
  int[] input5={4,5};
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  f2=Util.loadFlatTuple(tf.newTuple(input4.length),input4);
  assertTrue(f1.compareTo(f2) > 0);
  assertFalse(f1.compareTo(f2) < 0);
  int[] input6={1,2,3,4,6};
  f2=Util.loadFlatTuple(tf.newTuple(input6.length),input6);
  assertTrue(f1.compareTo(f2) < 0);
  assertFalse(f1.compareTo(f2) > 0);
  String expected="1:2:3:4:5";
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  assertTrue(expected.equals(f1.toDelimitedString(":")));
  PipedOutputStream pos=new PipedOutputStream();
  DataOutputStream dos=new DataOutputStream(pos);
  PipedInputStream pis=new PipedInputStream(pos);
  DataInputStream dis=new DataInputStream(pis);
  f1.write(dos);
  f1.write(dos);
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDefaultDateTimeZone </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalExecution() throws Exception {
  Iterator<Tuple> expectedItr=generateExpectedResults(DateTimeZone.forOffsetMillis(DateTimeZone.forID("+08:00").getOffset(null)));
  Properties config=new Properties();
  config.setProperty("pig.datetime.default.tz","+08:00");
  PigServer pig=new PigServer(Util.getLocalTestMode(),config);
  pig.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' as (test:datetime);");
  pig.registerQuery("b = filter a by test < ToDate('1970-01-04T00:00:00.000');");
  Iterator<Tuple> actualItr=pig.openIterator("b");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDST() throws Exception {
  String defaultDTZ="America/New_York";
  Properties config=new Properties();
  config.setProperty("pig.datetime.default.tz",defaultDTZ);
  PigServer pig=new PigServer(Util.getLocalTestMode(),config);
  pig.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' as (test:datetime);");
  pig.registerQuery("b = filter a by test > ToDate('2014-01-01T00:00:00.000');");
  pig.registerQuery("c = foreach b generate ToString(test, 'Z') as tz;");
  Iterator<Tuple> actualItr=pig.openIterator("c");
  Tuple est=actualItr.next();
  assertEquals(Util.buildTuple("-0500"),est);
  Tuple edt=actualItr.next();
  assertEquals(Util.buildTuple("-0400"),edt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDivide </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing DIVIDE operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(resdb.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(resb.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(resba.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(resba.returnStatus,POStatus.STATUS_ERR);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(ress.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(ress.returnStatus,POStatus.STATUS_ERR);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 / inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
lt.setValue(inpd1);
rt.setValue(0.0);
resd=op.getNextDouble();
assertEquals(null,(Double)resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 / inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
lt.setValue(inpf1);
rt.setValue(0.0f);
resf=op.getNextFloat();
assertEquals(null,(Float)resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 / inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
lt.setValue(inpi1);
rt.setValue(0);
resi=op.getNextInteger();
assertEquals(null,(Integer)resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 / inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
lt.setValue(inpl1);
rt.setValue(0l);
resl=op.getNextLong();
assertEquals(null,(Long)resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(resdt.returnStatus,POStatus.STATUS_ERR);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEmptyInputDir </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'merge';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeftOuterJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (x:int);");
  w.println("B = load '" + EMPTY_DIR + "' as (x:int);");
  w.println("C = join B by $0 left outer, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(0,stats.getNumberRecords(OUTPUT_FILE));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRightOuterJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "' as (x:int);");
  w.println("C = join B by $0 right outer, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(2,stats.getNumberRecords(OUTPUT_FILE));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewedJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join B by $0, A by $0 using 'skewed';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegularJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join B by $0, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFRJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'repl';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUtf8Dump() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"wendyξ"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray);");
  Iterator<Tuple> it=pigServer.openIterator("a");
  Tuple t=it.next();
  Assert.assertEquals("wendyξ",t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoadCtorArgs() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"hello:world"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using org.apache.pig.test.PigStorageNoDefCtor(':');");
  pigServer.registerQuery("b = foreach a generate (chararray)$0, (chararray)$1;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals("hello",t.get(0));
  Assert.assertEquals("world",t.get(1));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupWithInputFromGroup() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2","pigtester\t15\t1.2","pigtester2\t10\t1.2","pigtester3\t10\t1.2","pigtester3\t20\t1.2","pigtester3\t30\t1.2"});
  Map<String,Pair<Long,Long>> resultMap=new HashMap<String,Pair<Long,Long>>();
  resultMap.put("pigtester",new Pair<Long,Long>(25L,2L));
  resultMap.put("pigtester2",new Pair<Long,Long>(10L,1L));
  resultMap.put("pigtester3",new Pair<Long,Long>(60L,3L));
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("d = cogroup b by group, c by name;");
  pigServer.registerQuery("e = foreach d generate flatten(group), SUM(c.age), COUNT(c.name);");
  Iterator<Tuple> it=pigServer.openIterator("e");
  for (int i=0; i < resultMap.size(); i++) {
    Tuple t=it.next();
    Assert.assertEquals(true,resultMap.containsKey(t.get(0)));
    Pair<Long,Long> output=resultMap.get(t.get(0));
    Assert.assertEquals(output.first,t.get(1));
    Assert.assertEquals(output.second,t.get(2));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookup() throws Exception {
  DataBag b=BagFactory.getInstance().newDefaultBag();
  Map<String,Object> colors=new HashMap<String,Object>();
  colors.put("apple","red");
  colors.put("orange","orange");
  Map<String,Object> weights=new HashMap<String,Object>();
  weights.put("apple","0.1");
  weights.put("orange","0.3");
  Tuple t=mTf.newTuple();
  t.append(colors);
  t.append(weights);
  b.add(t);
  File tmpFile=File.createTempFile("tmp","");
  tmpFile.delete();
  String fileName=Util.removeColon(tmpFile.getAbsolutePath());
  PigFile f=new PigFile(fileName);
  f.store(b,new FuncSpec(BinStorage.class.getCanonicalName()),pigServer.getPigContext());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(fileName) + "' using BinStorage();");
  pigServer.registerQuery("b = foreach a generate $0#'apple',flatten($1#'orange');");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  t=iter.next();
  Assert.assertEquals(t.get(0).toString(),"red");
  Assert.assertEquals(0.3d,DataType.toDouble(t.get(1)).doubleValue(),0.0d);
  Assert.assertFalse(iter.hasNext());
  Util.deleteFile(cluster,fileName);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupAfterDistinct() throws Exception {
  String[] input1={"abc","abc","def","def","def","abc","def","ghi"};
  String[] input2={"ghi	4","rst	12344","uvw	1","xyz	4141"};
  Util.createInputFile(cluster,"table1",input1);
  Util.createInputFile(cluster,"table2",input2);
  pigServer.registerQuery("nonuniqtable1 = LOAD 'table1' AS (f1:chararray);");
  pigServer.registerQuery("table1 = DISTINCT nonuniqtable1;");
  pigServer.registerQuery("table2 = LOAD 'table2' AS (f1:chararray, f2:int);");
  pigServer.registerQuery("temp = COGROUP table1 BY f1 INNER, table2 BY f1;");
  Iterator<Tuple> it=pigServer.openIterator("temp");
  HashMap<String,Tuple> results=new HashMap<String,Tuple>();
  Object[] row=new Object[]{"abc",Util.createBagOfOneColumn(new String[]{"abc"}),mBf.newDefaultBag()};
  results.put("abc",Util.createTuple(row));
  row=new Object[]{"def",Util.createBagOfOneColumn(new String[]{"def"}),mBf.newDefaultBag()};
  results.put("def",Util.createTuple(row));
  Object[] thirdColContents=new Object[]{"ghi",4};
  Tuple t=Util.createTuple(thirdColContents);
  row=new Object[]{"ghi",Util.createBagOfOneColumn(new String[]{"ghi"}),Util.createBag(new Tuple[]{t})};
  results.put("ghi",Util.createTuple(row));
  while (it.hasNext()) {
    Tuple tup=it.next();
    List fields=tup.getAll();
    Tuple expected=results.get((String)fields.get(0));
    int i=0;
    for (    Object field : fields) {
      Assert.assertEquals(expected.get(i++),field);
    }
  }
  Util.deleteFile(cluster,"table1");
  Util.deleteFile(cluster,"table2");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAlgebraicDistinctProgress() throws Exception {
  int inputSize=4004;
  Integer[] inp=new Integer[inputSize];
  String[] inpString=new String[inputSize];
  for (int i=0; i < inputSize; i+=2) {
    inp[i]=i / 2;
    inp[i + 1]=i / 2;
    inpString[i]=new Integer(i / 2).toString();
    inpString[i + 1]=new Integer(i / 2).toString();
  }
  Util.createInputFile(cluster,"table",inpString);
  pigServer.registerQuery("a = LOAD 'table' AS (i:int);");
  pigServer.registerQuery("b = group a ALL;");
  pigServer.registerQuery("c = foreach b {aa = DISTINCT a; generate COUNT(aa);};");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Integer[] exp=new Integer[inputSize / 2];
  for (int j=0; j < inputSize / 2; ++j) {
    exp[j]=j;
  }
  DataBag expectedBag=Util.createBagOfOneColumn(exp);
  while (it.hasNext()) {
    Tuple tup=it.next();
    Long resultBagSize=(Long)tup.get(0);
    Assert.assertTrue(DataType.compare(expectedBag.size(),resultBagSize) == 0);
  }
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=Util.createFile(new String[]{"a:1","b:1","a:1"});
  File f2=Util.createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigContext) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigContext) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=Util.createTempFileDelOnExit("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigContext) + "') "+ "generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMapUDF() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate (double)mymap#'double' as d, (long)mymap#'long' + (float)mymap#'float' as float_sum, CONCAT((chararray) mymap#'string', ' World!'), mymap#'int' * 10, (bag{tuple()}) mymap#'bag' as mybag, (tuple()) mymap#'tuple' as mytuple, (map[])mymap#'map' as mapInMap, mymap#'dba' as dba;" + "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(1.0,(Double)t.get(0),0.01);
    Assert.assertEquals(2.0,(Float)t.get(1),0.01);
    Assert.assertTrue(((String)t.get(2)).equals("Hello World!"));
    Assert.assertEquals(new Integer(10),(Integer)t.get(3));
    Assert.assertEquals(1,((DataBag)t.get(4)).size());
    Assert.assertEquals(4,((Tuple)t.get(5)).size());
    Assert.assertEquals(2,((Map<String,Object>)t.get(6)).size());
    Assert.assertEquals(DataByteArray.class,t.get(7).getClass());
    Assert.assertEquals(8,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT * LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals(1,t.get(1));
  Assert.assertEquals(2,t.get(2));
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  String output="/pig/out/TestEvalPipeline-testBinStorageDetermineSchema";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);","p = load '" + output + "' using BinStorage() "+ "as (b, t2, m);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate COUNT(b), t2.a, t2.b as t2b, m#'key1', m#'key2', b;","q = foreach p generate COUNT(b), t2.$0, t2.$1, m#'key1', m#'key2', b;","q = foreach p generate COUNT($0), $1.$0, $1.$1, $2#'key1', $2#'key2', $0;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    it=pigServer.openIterator("q");
    t=it.next();
    Assert.assertEquals(new Long(2),t.get(0));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1,t.get(1));
    Assert.assertEquals(Integer.class,t.get(2).getClass());
    Assert.assertEquals(2,t.get(2));
    Assert.assertEquals("value1",t.get(3).toString());
    Assert.assertEquals("value2",t.get(4).toString());
    Assert.assertEquals(DefaultDataBag.class,t.get(5).getClass());
    DataBag bg=(DataBag)t.get(5);
    for (Iterator<Tuple> bit=bg.iterator(); bit.hasNext(); ) {
      Tuple bt=bit.next();
      Assert.assertEquals(String.class,bt.get(0).getClass());
      Assert.assertEquals(String.class,bt.get(1).getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  String output="/pig/out/TestEvalPipeline-testBinStorageDetermineSchema2";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (name:chararray, age:int, gpa:double);","p = load '" + output + "' using BinStorage() "+ "as (name, age, gpa);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate name, age, gpa;","q = foreach p generate name, age, gpa;","q = foreach p generate $0, $1, $2;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    Iterator<Tuple> it=pigServer.openIterator("q");
    Tuple t=it.next();
    Assert.assertEquals("pigtester",t.get(0));
    Assert.assertEquals(String.class,t.get(0).getClass());
    Assert.assertEquals(10,t.get(1));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1.2,t.get(2));
    Assert.assertEquals(Double.class,t.get(2).getClass());
  }
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age:long, gpa:float);");
  pigServer.registerQuery("q = foreach p generate name, age, gpa;");
  Iterator<Tuple> it=pigServer.openIterator("q");
  Tuple t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(10L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1.2f,t.get(2));
  Assert.assertEquals(Float.class,t.get(2).getClass());
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age, gpa);");
  pigServer.registerQuery("q = foreach p generate name, age + 1L, (int)gpa;");
  it=pigServer.openIterator("q");
  t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(11L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals(Integer.class,t.get(2).getClass());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanWithExpressionAssignment() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = " + Identity.class.getName() + "(*);"+ "C5 = COUNT(C2);"+ "C6 = SUM(C2.$1);"+ "C7 = "+ TitleNGrams.class.getName()+ "(C3);"+ "C8 = MAX(C3.$1);"+ "generate (int)group, C4, C5, C6, C7, C8, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComplexData() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals("1",t.get(1).toString());
  Assert.assertEquals("2",t.get(2).toString());
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  String output="/pig/out/TestEvalPipeline-testComplexData";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("x = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  pigServer.registerQuery("y = foreach x generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  it=pigServer.openIterator("y");
  t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals("1",t.get(1).toString());
  Assert.assertEquals("2",t.get(2).toString());
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinStorageWithLargeStrings() throws Exception {
  int testSize=100;
  String[] stringArray=new String[testSize];
  Random random=new Random();
  stringArray[0]=GenRandomData.genRandLargeString(random,65534);
  for (int i=1; i < stringArray.length; ++i) {
    if ((i % 25) == 0) {
      stringArray[i]=GenRandomData.genRandLargeString(random,65535 + i);
    }
 else {
      stringArray[i]=GenRandomData.genRandString(random);
    }
  }
  Util.createInputFile(cluster,"table",stringArray);
  pigServer.registerQuery("a = load 'table' using PigStorage() " + "as (c: chararray);");
  String output="/pig/out/TestEvalPipeline-testBinStorageLargeStrings";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("b = load '" + output + "' using BinStorage() "+ "as (c:chararray);");
  pigServer.registerQuery("c = foreach b generate c;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  int counter=0;
  while (it.hasNext()) {
    Tuple tup=it.next();
    String resultString=(String)tup.get(0);
    String expectedString=stringArray[counter];
    Assert.assertTrue(expectedString.equals(resultString));
    ++counter;
  }
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=Util.createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=Util.createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigContext) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigContext) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlan() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "generate (int)group," + Identity.class.getName() + "(*), COUNT(C2), SUM(C2.$1),"+ TitleNGrams.class.getName()+ "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProjectBag() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"f1\tf2\tf3"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' as (x, y, z);");
  pigServer.registerQuery("b = group a by x;");
  pigServer.registerQuery("c = foreach b generate flatten(a.(y, z));");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("f2",t.get(0).toString());
  Assert.assertEquals("f3",t.get(1).toString());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testProjBagInTuple() throws Exception {
  String[] input={"(1,{(one),(two)})"};
  Util.createInputFile(cluster,"table_testProjBagInTuple",input);
  pigServer.registerQuery("a = load 'table_testProjBagInTuple' as (t : tuple(i: int, b1: bag { b_tuple : tuple ( b_str: chararray) }));");
  pigServer.registerQuery("b = foreach a generate t.b1;");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("({(one),(two)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForEachSameOriginColumn3() throws Exception {
  String[] input1={"1\t1\t2","1\t2\t3"};
  Util.createInputFile(cluster,"table_testForEachSameOriginColumn3",input1);
  pigServer.registerQuery("a = load 'table_testForEachSameOriginColumn3' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("b = group a by a0;");
  pigServer.registerQuery("c = foreach b generate flatten(a.(a1,a2)) as (b0, b1), flatten(a.(a1,a2)) as (b2, b3);");
  pigServer.registerQuery("d = filter c by b0>b2;");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("(2,3,1,2)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWrappingUnknownKey1() throws Exception {
  String[] input1={"1"};
  Util.createInputFile(cluster,"table_testWrappingUnknownKey1",input1);
  pigServer.registerQuery("a = load 'table_testWrappingUnknownKey1' as (a0);");
  pigServer.registerQuery("b = foreach a generate a0, " + MapGenerate.class.getName() + "(*) as m:map[];");
  pigServer.registerQuery("c = foreach b generate a0, m#'key' as key;");
  pigServer.registerQuery("d = group c by key;");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.toString().equals("(1,{(1,1)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageWithCtrlChars() throws Exception {
  String[] inputData={"hello\u0001world","good\u0001morning","nice\u0001day"};
  Util.createInputFile(cluster,"testPigStorageWithCtrlCharsInput.txt",inputData);
  String script="a = load 'testPigStorageWithCtrlCharsInput.txt' using PigStorage('\u0001');" + "b = foreach a generate $0, CONCAT($0, '\u0005'), $1; " + "store b into 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001');"+ "c = load 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001') as (f1:chararray, f2:chararray, f3:chararray);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  HashMap<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("hello",(Tuple)Util.getPigConstant("('hello','hello\u0005','world')"));
  expectedResults.put("good",(Tuple)Util.getPigConstant("('good','good\u0005','morning')"));
  expectedResults.put("nice",(Tuple)Util.getPigConstant("('nice','nice\u0005','day')"));
  HashMap<String,Boolean> seen=new HashMap<String,Boolean>();
  int numRows=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String firstCol=(String)t.get(0);
    Assert.assertFalse(seen.containsKey(firstCol));
    seen.put(firstCol,true);
    Assert.assertEquals(expectedResults.get(firstCol),t);
    numRows++;
  }
  Assert.assertEquals(3,numRows);
  Util.deleteFile(cluster,"testPigStorageWithCtrlCharsInput.txt");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateReferenceInnerPlan() throws Exception {
  String[] input1={"1\t1\t1"};
  String[] input2={"1\t1","2\t2"};
  Util.createInputFile(cluster,"table_testDuplicateReferenceInnerPlan1",input1);
  Util.createInputFile(cluster,"table_testDuplicateReferenceInnerPlan2",input2);
  pigServer.registerQuery("a = load 'table_testDuplicateReferenceInnerPlan1' as (a0, a1, a2);");
  pigServer.registerQuery("b = load 'table_testDuplicateReferenceInnerPlan2' as (b0, b1);");
  pigServer.registerQuery("c = join a by a0, b by b0;");
  pigServer.registerQuery("d = foreach c {d0 = a::a1;d1 = a::a2;generate ((d0 is not null)? d0 : d1);};");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(1)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSortDesc() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num desc parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MAX_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum <= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWrappingUnknownKey2() throws Exception {
  String[] input1={"1"};
  Util.createInputFile(cluster,"table_testWrappingUnknownKey2",input1);
  pigServer.registerQuery("a = load 'table_testWrappingUnknownKey2' as (a0);");
  pigServer.registerQuery("b = foreach a generate a0, " + MapGenerate.class.getName() + "(*) as m:map[];");
  pigServer.registerQuery("c = foreach b generate a0, m#'key' as key;");
  pigServer.registerQuery("d = order c by key;");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.toString().equals("(1,1)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLOGenerateSchema() throws Exception {
  String[] input1={"1\t2\t{(1)}"};
  Util.createInputFile(cluster,"table_testLOGenerateSchema",input1);
  pigServer.registerQuery("a = load 'table_testLOGenerateSchema' as (a0:int, a1, a2:bag{});");
  pigServer.registerQuery("b = foreach a generate a0 as b0, a1 as b1, flatten(a2) as b2:int;");
  pigServer.registerQuery("c = filter b by b0==1;");
  pigServer.registerQuery("d = foreach c generate b0+1, b2;");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(2,1)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadWithDifferentSchema() throws Exception {
  String[] input1={"hello\thello\t(hello)\t[key#value]"};
  Util.createInputFile(cluster,"table_testLoadWithDifferentSchema1",input1);
  pigServer.registerQuery("a = load 'table_testLoadWithDifferentSchema1' as (a0:chararray, a1:chararray, a2, a3:map[]);");
  pigServer.store("a","table_testLoadWithDifferentSchema1.bin","org.apache.pig.builtin.BinStorage");
  pigServer.registerQuery("b = load 'table_testLoadWithDifferentSchema1.bin' USING BinStorage('Utf8StorageConverter') AS (b0:chararray, b1:chararray, b2:tuple(), b3:map[]);");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 4);
  Assert.assertTrue(t.toString().equals("(hello,hello,(hello),[key#value])"));
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingTwoBag(){
  try {
    pigServer.registerQuery("a = load '1.txt' as (name:chararray, age:int, gpa:double);");
    pigServer.registerQuery("b = group a by name;");
    pigServer.registerQuery("c = foreach b generate group, SUM(a.age*a.gpa);");
    pigServer.openIterator("c");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getErrorCode() == 1039);
    Assert.assertTrue(pe.getMessage().contains("incompatible types"));
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSort() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MIN_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum >= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNestedOperatorReuse() throws Exception {
  String[] input1={"60000\tdv1\txuaHeartBeat","70000\tdv2\txuaHeartBeat","80000\tdv1\txuaPowerOff","90000\tdv1\txuaPowerOn","110000\tdv2\txuaHeartBeat","120000\tdv2\txuaPowerOff","140000\tdv2\txuaPowerOn","150000\tdv1\txuaHeartBeat","160000\tdv2\txuaHeartBeat","250000\tdv1\txuaHeartBeat","310000\tdv2\txuaPowerOff","360000\tdv1\txuaPowerOn","420000\tdv3\txuaHeartBeat","450000\tdv3\txuaHeartBeat","540000\tdv4\txuaPowerOn","550000\tdv3\txuaHeartBeat","560000\tdv5\txuaHeartBeat"};
  Util.createInputFile(cluster,"table_testNestedOperatorReuse",input1);
  String query="Events = LOAD 'table_testNestedOperatorReuse' AS (eventTime:long, deviceId:chararray, eventName:chararray);" + "Events = FOREACH Events GENERATE eventTime, deviceId, eventName;" + "EventsPerMinute = GROUP Events BY (eventTime / 60000);"+ "EventsPerMinute = FOREACH EventsPerMinute {"+ "  DistinctDevices = DISTINCT Events.deviceId;"+ "  nbDevices = SIZE(DistinctDevices);"+ "  DistinctDevices = FILTER Events BY eventName == 'xuaHeartBeat';"+ "  nbDevicesWatching = SIZE(DistinctDevices);"+ "  GENERATE $0*60000 as timeStamp, nbDevices as nbDevices, nbDevicesWatching as nbDevicesWatching;"+ "}"+ "EventsPerMinute = FILTER EventsPerMinute BY timeStamp >= 0  AND timeStamp < 300000;";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("EventsPerMinute");
  Tuple t=iter.next();
  Assert.assertTrue((Long)t.get(0) == 60000 && (Long)t.get(1) == 2 && (Long)t.get(2) == 3);
  t=iter.next();
  Assert.assertTrue((Long)t.get(0) == 120000 && (Long)t.get(1) == 2 && (Long)t.get(2) == 2);
  t=iter.next();
  Assert.assertTrue((Long)t.get(0) == 240000 && (Long)t.get(1) == 1 && (Long)t.get(2) == 1);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForEachDupColumn() throws Exception {
  String[] input1={"1\t2"};
  String[] input2={"1\t1\t3","2\t4\t2"};
  Util.createInputFile(cluster,"table_testForEachDupColumn1",input1);
  Util.createInputFile(cluster,"table_testForEachDupColumn2",input2);
  pigServer.registerQuery("a = load 'table_testForEachDupColumn1' as (a0, a1:int);");
  pigServer.registerQuery("b = load 'table_testForEachDupColumn2' as (b0, b1:int, b2);");
  pigServer.registerQuery("c = foreach a generate a0, a1, a1 as a2;");
  pigServer.registerQuery("d = union b, c;");
  pigServer.registerQuery("e = foreach d generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("e");
  Map<Object,Object> expected=new HashMap<Object,Object>(3);
  expected.put(1,null);
  expected.put(2,null);
  expected.put(4,null);
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(expected.containsKey(t.get(0)));
  t=iter.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(expected.containsKey(t.get(0)));
  t=iter.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(expected.containsKey(t.get(0)));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDereferenceInnerPlan() throws Exception {
  String[] input1={"1\t2\t3"};
  String[] input2={"1\t1"};
  Util.createInputFile(cluster,"table_testDereferenceInnerPlan1",input1);
  Util.createInputFile(cluster,"table_testDereferenceInnerPlan2",input2);
  pigServer.registerQuery("a = load 'table_testDereferenceInnerPlan1' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("b = load 'table_testDereferenceInnerPlan2' as (b0:int, b1:int);");
  pigServer.registerQuery("c = cogroup a by a0, b by b0;");
  pigServer.registerQuery("d = foreach c generate ((COUNT(a)==0L)?null : a.a0) as d0;");
  pigServer.registerQuery("e = foreach d generate flatten(d0);");
  pigServer.registerQuery("f = group e all;");
  Iterator<Tuple> iter=pigServer.openIterator("f");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(all,{(1)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorageByteArrayCastsSimple() throws IOException {
  String[] input={"asdf\t12\t1.1\t231\t234\t3024123\t3.2492","sa\t1231\t123.4\t12345678\t1234.567\t5081123453\t9.181817","asdff\t1232123\t1.45345\t123456789\t123456789.9\t1234567\t1.234567"};
  Util.createInputFile(cluster,"table_bs_ac",input);
  pigServer.registerQuery("a = load 'table_bs_ac';");
  String output="/pig/out/TestEvalPipeline2_BinStorageByteArrayCasts";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("b = load '" + output + "' using BinStorage('Utf8StorageConverter') "+ "as (name: int, age: int, gpa: float, lage: long, dgpa: double, bi:biginteger, bd:bigdecimal);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple tup=null;
  tup=it.next();
  Assert.assertTrue((Integer)tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 12);
  Assert.assertTrue((Float)tup.get(2) == 1.1F);
  Assert.assertTrue((Long)tup.get(3) == 231L);
  Assert.assertTrue((Double)tup.get(4) == 234.0);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("3024123"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("3.2492"));
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 1231);
  Assert.assertTrue((Float)tup.get(2) == 123.4F);
  Assert.assertTrue((Long)tup.get(3) == 12345678L);
  Assert.assertTrue((Double)tup.get(4) == 1234.567);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("5081123453"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("9.181817"));
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 1232123);
  Assert.assertTrue((Float)tup.get(2) == 1.45345F);
  Assert.assertTrue((Long)tup.get(3) == 123456789L);
  Assert.assertTrue((Double)tup.get(4) == 1.234567899E8);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("1234567"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("1.234567"));
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinStorageByteArrayCastsComplexBag() throws IOException {
  String[] input={"{(asdf)}","{(2344)}","{(2344}","{(323423423423434)}","{(323423423423434L)}","{(asdff)}"};
  Util.createInputFile(cluster,"table_bs_ac_clx",input);
  pigServer.registerQuery("a = load 'table_bs_ac_clx' as (f1);");
  pigServer.registerQuery("b = foreach a generate (bag{tuple(int)})f1;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple tup=null;
  tup=it.next();
  Assert.assertTrue(tup.get(0) != null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) != null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) instanceof DataBag);
  DataBag db=(DataBag)tup.get(0);
  Assert.assertTrue(db.iterator().hasNext());
  Tuple innerTuple=db.iterator().next();
  Assert.assertTrue(innerTuple.get(0) == null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) != null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) != null);
  Util.deleteFile(cluster,"table_bs_ac_clx");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinStorageByteArrayCastsComplexTuple() throws IOException {
  String[] input={"(123)","((123)","(123123123123)","(asdf)"};
  Util.createInputFile(cluster,"table_bs_ac_clxt",input);
  pigServer.registerQuery("a = load 'table_bs_ac_clxt' as (t:tuple(t:tuple(i:int)));");
  Iterator<Tuple> it=pigServer.openIterator("a");
  Tuple tup=null;
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  Util.deleteFile(cluster,"table_bs_ac_clxt");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateInnerAlias() throws Exception {
  String[] input1={"1\t[key1#5]","1\t[key2#5]","2\t[key1#3]"};
  Util.createInputFile(cluster,"table_testDuplicateInnerAlias",input1);
  pigServer.registerQuery("a = load 'table_testDuplicateInnerAlias' as (a0:int, a1:map[]);");
  pigServer.registerQuery("b = filter a by a0==1;");
  pigServer.registerQuery("c = foreach b { b0 = a1#'key1'; generate ((b0 is null or b0 == '')?1:0);};");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Tuple t=iter.next();
  Assert.assertTrue((Integer)t.get(0) == 0);
  t=iter.next();
  Assert.assertTrue((Integer)t.get(0) == 1);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPushUpFilterScalar() throws Exception {
  String[] input1={"jason\t14\t4.7","jack\t18\t4.6"};
  String[] input2={"jason\t14","jack\t18"};
  Util.createInputFile(cluster,"table_PushUpFilterScalar1",input1);
  Util.createInputFile(cluster,"table_PushUpFilterScalar2",input2);
  pigServer.registerQuery("A = load 'table_PushUpFilterScalar1' as (name, age, gpa);");
  pigServer.registerQuery("B = load 'table_PushUpFilterScalar2' as (name, age);");
  pigServer.registerQuery("C = filter A by age < 20;");
  pigServer.registerQuery("D = filter B by age < 20;");
  pigServer.registerQuery("simple_scalar = limit D 1;");
  pigServer.registerQuery("E = join C by name, D by name;");
  pigServer.registerQuery("F = filter E by C::age==(int)simple_scalar.age;");
  Iterator<Tuple> iter=pigServer.openIterator("F");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(jason,14,4.7,jason,14)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinCondSchema() throws IOException {
  String[] inputData=new String[]{"hello world\t2"};
  Util.createInputFile(cluster,"table_testSchemaSerialization.txt",inputData);
  pigServer.registerQuery("a = load 'table_testSchemaSerialization.txt' as (a0:chararray, a1:int);");
  pigServer.registerQuery("b = foreach a generate FLATTEN((a1<=1?{('null')}:TOKENIZE(a0)));");
  pigServer.registerQuery("c = foreach b generate UPPER($0);");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  Assert.assertTrue(t.get(0).equals("HELLO"));
  t=it.next();
  Assert.assertTrue(t.get(0).equals("WORLD"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUDFNoSchemaPropagate2() throws Exception {
  String[] input1={"[key#1,key2#2]","[key#2,key2#3]"};
  Util.createInputFile(cluster,"table_testUDFNoSchemaPropagate2",input1);
  pigServer.registerQuery("a = load 'table_testUDFNoSchemaPropagate2' as (a0:map[]);");
  pigServer.registerQuery("b = foreach a generate flatten(" + BagGenerateNoSchema.class.getName() + "(*)) as b0;");
  pigServer.registerQuery("c = foreach b generate IdentityColumn(b0);");
  pigServer.registerQuery("d = foreach c generate $0#'key';");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("(1)"));
  t=iter.next();
  Assert.assertTrue(t.toString().contains("(2)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCastMap() throws Exception {
  String[] input={"([key#1])","([key#2])"};
  Util.createInputFile(cluster,"table_testCastMap",input);
  pigServer.registerQuery("a = load 'table_testCastMap' as (m:map[]);");
  pigServer.registerQuery("b = foreach a generate (map[int])m;");
  pigServer.registerQuery("c = foreach b generate m#'key' + 1;");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Tuple t=iter.next();
  Assert.assertEquals(t.get(0),2);
  t=iter.next();
  Assert.assertEquals(t.get(0),3);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSchemaDataNotMatch() throws Exception {
  String[] input={"0\t1\t2","3\t4","5"};
  Util.createInputFile(cluster,"table_testSchemaDataNotMatch",input);
  pigServer.registerQuery("a = load 'table_testSchemaDataNotMatch' as (a0, a1);");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.get(0).toString().equals("0"));
  Assert.assertTrue(t.get(1).toString().equals("1"));
  t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.get(0).toString().equals("3"));
  Assert.assertTrue(t.get(1).toString().equals("4"));
  t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.get(0).toString().equals("5"));
  Assert.assertTrue(t.get(1) == null);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDereferenceUidBug() throws Exception {
  String[] input1={"0\t0\t{(1,2)}\t1"};
  String[] input2={"0\t0"};
  Util.createInputFile(cluster,"table_testDereferenceUidBug1",input1);
  Util.createInputFile(cluster,"table_testDereferenceUidBug2",input2);
  pigServer.registerQuery("a = load 'table_testDereferenceUidBug1' as (a0:int, a1:int, a2:{t:(i0:int, i1:int)}, a3:int);");
  pigServer.registerQuery("b = foreach a generate a0, a1, a0+a1 as sum, a2.i0 as a2, a3;");
  pigServer.registerQuery("c = filter b by sum==0;");
  pigServer.registerQuery("d = load 'table_testDereferenceUidBug2' as (d0:int, d1:int);");
  pigServer.registerQuery("e = join c by a0, d by d0;");
  pigServer.registerQuery("f = foreach e generate c::a2;");
  Iterator<Tuple> iter=pigServer.openIterator("f");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("({(1)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testProjectNullSchema() throws Exception {
  String[] input={"0\t1"};
  Util.createInputFile(cluster,"table_testProjectNullSchema",input);
  pigServer.registerQuery("a = load 'table_testProjectNullSchema';");
  pigServer.registerQuery("b = foreach a generate ASIN($0), $1;");
  pigServer.registerQuery("c = order b by $0;");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("(0.0,1)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBagDereferenceInMiddle1() throws Exception {
  String[] input1={"foo@apache#44"};
  Util.createInputFile(cluster,"table_testBagDereferenceInMiddle1",input1);
  pigServer.registerQuery("a = load 'table_testBagDereferenceInMiddle1' as (a0:chararray);");
  pigServer.registerQuery("b = foreach a generate UPPER(REGEX_EXTRACT_ALL(a0, '.*@(.*)#.*').$0);");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0).equals("APACHE"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWrappingUnknownKey3() throws Exception {
  String[] input1={"1\t2","2\t3"};
  String[] input2={"1"};
  Util.createInputFile(cluster,"table_testWrappingUnknownKey3_1",input1);
  Util.createInputFile(cluster,"table_testWrappingUnknownKey3_2",input2);
  pigServer.registerQuery("a = load 'table_testWrappingUnknownKey3_1' as (a0:chararray, a1:chararray);");
  pigServer.registerQuery("b = load 'table_testWrappingUnknownKey3_2' as (b0:chararray);");
  pigServer.registerQuery("c = union a, b;");
  pigServer.registerQuery("d = order c by $0;");
  Collection<String> results=new HashSet<String>();
  results.add("(1,2)");
  results.add("(1)");
  results.add("(2,3)");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(results.contains(t.toString()));
  t=iter.next();
  Assert.assertTrue(results.contains(t.toString()));
  t=iter.next();
  Assert.assertTrue(results.contains(t.toString()));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForEachSameOriginColumn1() throws Exception {
  String[] input1={"1\t2","1\t3","2\t4","2\t5"};
  String[] input2={"1\tone","2\ttwo"};
  Util.createInputFile(cluster,"table_testForEachSameOriginColumn1_1",input1);
  Util.createInputFile(cluster,"table_testForEachSameOriginColumn1_2",input2);
  pigServer.registerQuery("A = load 'table_testForEachSameOriginColumn1_1' AS (a0:int, a1:int);");
  pigServer.registerQuery("B = load 'table_testForEachSameOriginColumn1_2' AS (b0:int, b1:chararray);");
  pigServer.registerQuery("C = join A by a0, B by b0;");
  pigServer.registerQuery("D = foreach B generate b0 as d0, b1 as d1;");
  pigServer.registerQuery("E = join C by a1, D by d0;");
  pigServer.registerQuery("F = foreach E generate b1, d1;");
  Iterator<Tuple> iter=pigServer.openIterator("F");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 2);
  Assert.assertTrue(t.get(0).equals("one"));
  Assert.assertTrue(t.get(1).equals("two"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnionOnSchemaUidGeneration() throws Exception {
  String[] input1={"100,101,102,103,104,105","110,111,112,113,114,115"};
  String[] input2={"200,201,202,203,204,205","210,211,212,213,214,215"};
  String[] input0={"200,201,202,203,204,205","210,211,212,213,214,215"};
  Util.createInputFile(cluster,"table_testUnionOnSchemaUidGeneration1",input1);
  Util.createInputFile(cluster,"table_testUnionOnSchemaUidGeneration2",input2);
  Util.createInputFile(cluster,"table_testUnionOnSchemaUidGeneration0",input0);
  pigServer.registerQuery("A = load 'table_testUnionOnSchemaUidGeneration1' using PigStorage(',')  as (f1:int,f2:int,f3:int,f4:long,f5:double);");
  pigServer.registerQuery("B = load 'table_testUnionOnSchemaUidGeneration2' using PigStorage(',')  as (f1:int,f2:int,f3:int,f4:long,f5:double);");
  pigServer.registerQuery("C = load 'table_testUnionOnSchemaUidGeneration0' using PigStorage(',')  as (f1:int,f2:int,f3:int);");
  pigServer.registerQuery("U = UNION ONSCHEMA A,B;");
  pigServer.registerQuery("J = join C by (f1,f2,f3) LEFT OUTER, U by (f1,f2,f3);");
  pigServer.registerQuery("Porj = foreach J generate C::f1 as f1 ,C::f2 as f2,C::f3 as f3,U::f4 as f4,U::f5 as f5;");
  pigServer.registerQuery("G = GROUP Porj by (f1,f2,f3,f5);");
  pigServer.registerQuery("Final = foreach G generate SUM(Porj.f4) as total;");
  Iterator<Tuple> iter=pigServer.openIterator("Final");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(203)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(213)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testProjectEmptyBag() throws Exception {
  String[] input={"{(12)}","{(23)}",""};
  Util.createInputFile(cluster,"table_testProjectEmptyBag",input);
  pigServer.registerQuery("A = load 'table_testProjectEmptyBag' as (bg:bag{});");
  pigServer.registerQuery("B = FOREACH A { x = FILTER bg BY $0 == '12'; GENERATE x; };");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("({(12)})"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("({})"));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.toString().equals("({})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUDFNoSchemaPropagate1() throws Exception {
  String[] input1={"[key#1,key2#2]","[key#2,key2#3]"};
  Util.createInputFile(cluster,"table_testUDFNoSchemaPropagate1",input1);
  pigServer.registerQuery("a = load 'table_testUDFNoSchemaPropagate1' as (a0:map[]);");
  pigServer.registerQuery("b = foreach a generate " + BagGenerateNoSchema.class.getName() + "(*) as b0;");
  pigServer.registerQuery("c = foreach b generate flatten(IdentityColumn(b0));");
  pigServer.registerQuery("d = foreach c generate $0#'key';");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("(1)"));
  t=iter.next();
  Assert.assertTrue(t.toString().contains("(2)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLimitAutoReducer() throws Exception {
  String[] input={"1\tA","4\tB","2\tC","3\tD","6\tE","5\tF"};
  Util.createInputFile(cluster,"table_testLimitAutoReducer",input);
  pigServer.getPigContext().getProperties().setProperty("pig.exec.reducers.bytes.per.reducer","16");
  pigServer.registerQuery("A = load 'table_testLimitAutoReducer';");
  pigServer.registerQuery("B = order A by $0;");
  pigServer.registerQuery("C = limit B 2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(1,A)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(2,C)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLimitPOPackageAnnotator() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test1","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("2\t5\t2");
  ps1.close();
  File tmpFile2=Util.createTempFileDelOnExit("test2","txt");
  PrintStream ps2=new PrintStream(new FileOutputStream(tmpFile2));
  ps2.println("1\t1");
  ps2.println("2\t2");
  ps2.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = LOAD '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = LIMIT B 100;");
  pigServer.registerQuery("D = COGROUP C BY b0, A BY a0 PARALLEL 2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(2,{(2,2)},{(2,5,2)})"));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(1,{(1,1)},{(1,2,3)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonStandardData() throws Exception {
  String[] input1={"0"};
  Util.createInputFile(cluster,"table_testNonStandardData",input1);
  pigServer.registerQuery("a = load 'table_testNonStandardData' as (a0);");
  pigServer.registerQuery("b = foreach a generate " + UDFWithNonStandardType.class.getName() + "(a0);");
  try {
    pigServer.openIterator("b");
    Assert.fail();
  }
 catch (  Exception e) {
    Throwable cause=e.getCause().getCause() == null ? e.getCause() : e.getCause().getCause();
    String message=cause.getMessage();
    Assert.assertTrue(message.contains(ArrayList.class.getName()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLocalRearrangeInReducer() throws Exception {
  String[] input1={"1\t1","1\t1","1\t2"};
  String[] input2={"1\t1"};
  Util.createInputFile(cluster,"table_testLocalRearrangeInReducer1",input1);
  Util.createInputFile(cluster,"table_testLocalRearrangeInReducer2",input2);
  pigServer.registerQuery("a = load 'table_testLocalRearrangeInReducer1' as (a0, a1);");
  pigServer.registerQuery("b = distinct a;");
  pigServer.registerQuery("c = load 'table_testLocalRearrangeInReducer2' as (c0, c1);");
  pigServer.registerQuery("d = cogroup b by a0, c by c0;");
  pigServer.registerQuery("e = foreach d { e1 = order c by c1; generate e1;};");
  Iterator<Tuple> iter=pigServer.openIterator("e");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("({(1,1)})"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForEachSameOriginColumn2() throws Exception {
  String[] input1={"{(1,2),(2,3)}"};
  Util.createInputFile(cluster,"table_testForEachSameOriginColumn2",input1);
  pigServer.registerQuery("a = load 'table_testForEachSameOriginColumn2' as (a0:bag{t:tuple(i0:int, i1:int)});");
  pigServer.registerQuery("b = foreach a generate flatten(a0) as (b0, b1), flatten(a0) as (b2, b3);");
  pigServer.registerQuery("c = filter b by b0>b2;");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().contains("(2,3,1,2)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinStorageCommaSeperatedPath() throws Exception {
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"table_simple1",input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD 'table_simple1' as (a0, a1);");
  pigServer.registerQuery("store A into 'table_simple1.bin' using BinStorage();");
  pigServer.registerQuery("store A into 'table_simple2.bin' using BinStorage();");
  pigServer.executeBatch();
  pigServer.registerQuery("A = LOAD 'table_simple1.bin,table_simple2.bin' using BinStorage();");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(1,3)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(2,4)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(3,5)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(1,3)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(2,4)"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(3,5)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUdfInputOrder() throws IOException {
  String[] input={"(123)","((123)","(123123123123)","(asdf)"};
  Util.createInputFile(cluster,"table_udfInp",input);
  pigServer.registerQuery("a = load 'table_udfInp' as (i:int);");
  pigServer.registerQuery("b = foreach a {dec = 'hello'; str1 = " + Identity.class.getName() + "(dec,'abc','def');"+ "generate dec,str1; };");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple tup=null;
  tup=it.next();
  Tuple out=(Tuple)tup.get(1);
  Assert.assertEquals(out.get(0).toString(),"hello");
  Assert.assertEquals(out.get(1).toString(),"abc");
  Assert.assertEquals(out.get(2).toString(),"def");
  Util.deleteFile(cluster,"table_udfInp");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNestedDescSort() throws Exception {
  Util.createInputFile(cluster,"table_testNestedDescSort",new String[]{"3","4"});
  pigServer.registerQuery("A = LOAD 'table_testNestedDescSort' as (a0:int);");
  pigServer.registerQuery("B = group A ALL;");
  pigServer.registerQuery("C = foreach B { D = order A by a0 desc;generate D;};");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("({(4),(3)})"));
  Assert.assertFalse(iter.hasNext());
  Util.deleteFile(cluster,"table_testNestedDescSort");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBagDereferenceInMiddle2() throws Exception {
  String[] input1={"foo apache"};
  Util.createInputFile(cluster,"table_testBagDereferenceInMiddle2",input1);
  pigServer.registerQuery("a = load 'table_testBagDereferenceInMiddle2' as (a0:chararray);");
  pigServer.registerQuery("b = foreach a generate " + MapGenerate.class.getName() + " (STRSPLIT(a0).$0);");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  Tuple t=iter.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.toString().equals("([key#1])"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateLoadFuncSignature() throws Exception {
  String[] input={"0\t1\ta"};
  Util.createInputFile(cluster,"table_testDuplicateLoadFuncSignature",input);
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load 'table_testDuplicateLoadFuncSignature' as (a0, a1, a2);");
  pigServer.registerQuery("b = foreach a generate a0, a1;");
  pigServer.registerQuery("a = load 'table_testDuplicateLoadFuncSignature' as (a0, a1, a2);");
  pigServer.registerQuery("c = foreach a generate a0, a2;");
  pigServer.registerQuery("store b into 'testDuplicateLoadFuncSignatureOutput1';");
  pigServer.registerQuery("store c into 'testDuplicateLoadFuncSignatureOutput2';");
  pigServer.executeBatch();
  pigServer.registerQuery("a = load 'testDuplicateLoadFuncSignatureOutput1';");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(0,1)"));
  Assert.assertFalse(iter.hasNext());
  pigServer.registerQuery("a = load 'testDuplicateLoadFuncSignatureOutput2';");
  iter=pigServer.openIterator("a");
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(0,a)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testProjectNullBag() throws Exception {
  String[] input1={"{(1)}\t2","\t3"};
  HashSet<String> optimizerRules=new HashSet<String>();
  optimizerRules.add("MergeForEach");
  pigServer.getPigContext().getProperties().setProperty(PigImplConstants.PIG_OPTIMIZER_RULES_KEY,ObjectSerializer.serialize(optimizerRules));
  Util.createInputFile(cluster,"table_testProjectNullBag",input1);
  pigServer.registerQuery("a = load 'table_testProjectNullBag' as (a0:bag{}, a1:int);");
  pigServer.registerQuery("b = foreach a generate a0;");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("({(1)})"));
  t=iter.next();
  Assert.assertTrue(t.toString().equals("()"));
  Assert.assertFalse(iter.hasNext());
  pigServer.getPigContext().getProperties().remove(PigImplConstants.PIG_OPTIMIZER_RULES_KEY);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFwithStarInput() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "generate " + Identity.class.getName() + "(*);"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    Tuple t=(Tuple)tuple.get(0);
    Assert.assertEquals(DataByteArray.class,t.get(0).getClass());
    int group=Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
    Assert.assertEquals(numIdentity,group);
    Assert.assertTrue(t.get(1) instanceof DataBag);
    DataBag bag=(DataBag)t.get(1);
    Assert.assertEquals(10,bag.size());
    Assert.assertEquals(2,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  String output="./TestEvalPipeline-testBinStorageDetermineSchema2";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (name:chararray, age:int, gpa:double);","p = load '" + output + "' using BinStorage() "+ "as (name, age, gpa);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate name, age, gpa;","q = foreach p generate name, age, gpa;","q = foreach p generate $0, $1, $2;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    Iterator<Tuple> it=pigServer.openIterator("q");
    Tuple t=it.next();
    Assert.assertEquals("pigtester",t.get(0));
    Assert.assertEquals(String.class,t.get(0).getClass());
    Assert.assertEquals(10,t.get(1));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1.2,t.get(2));
    Assert.assertEquals(Double.class,t.get(2).getClass());
  }
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age:long, gpa:float);");
  pigServer.registerQuery("q = foreach p generate name, age, gpa;");
  Iterator<Tuple> it=pigServer.openIterator("q");
  Tuple t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(10L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1.2f,t.get(2));
  Assert.assertEquals(Float.class,t.get(2).getClass());
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age, gpa);");
  pigServer.registerQuery("q = foreach p generate name, age + 1L, (int)gpa;");
  it=pigServer.openIterator("q");
  t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(11L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals(Integer.class,t.get(2).getClass());
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProjectBag() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"f1\tf2\tf3"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' as (x, y, z);");
  pigServer.registerQuery("b = group a by x;");
  pigServer.registerQuery("c = foreach b generate flatten(a.(y, z));");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  Assert.assertEquals(2,t.size());
  Assert.assertEquals("f2",t.get(0).toString());
  Assert.assertEquals("f3",t.get(1).toString());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals(1,t.get(1));
  Assert.assertEquals(2,t.get(2));
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  String output="./TestEvalPipeline-testBinStorageDetermineSchema";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);","p = load '" + output + "' using BinStorage() "+ "as (b, t2, m);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate COUNT(b), t2.a, t2.b as t2b, m#'key1', m#'key2', b;","q = foreach p generate COUNT(b), t2.$0, t2.$1, m#'key1', m#'key2', b;","q = foreach p generate COUNT($0), $1.$0, $1.$1, $2#'key1', $2#'key2', $0;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    it=pigServer.openIterator("q");
    t=it.next();
    Assert.assertEquals(new Long(2),t.get(0));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1,t.get(1));
    Assert.assertEquals(Integer.class,t.get(2).getClass());
    Assert.assertEquals(2,t.get(2));
    Assert.assertEquals("value1",t.get(3).toString());
    Assert.assertEquals("value2",t.get(4).toString());
    Assert.assertEquals(DefaultDataBag.class,t.get(5).getClass());
    DataBag bg=(DataBag)t.get(5);
    for (Iterator<Tuple> bit=bg.iterator(); bit.hasNext(); ) {
      Tuple bt=bit.next();
      Assert.assertEquals(String.class,bt.get(0).getClass());
      Assert.assertEquals(String.class,bt.get(1).getClass());
    }
  }
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupWithInputFromGroup() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2","pigtester\t15\t1.2","pigtester2\t10\t1.2","pigtester3\t10\t1.2","pigtester3\t20\t1.2","pigtester3\t30\t1.2"});
  Map<String,Pair<Long,Long>> resultMap=new HashMap<String,Pair<Long,Long>>();
  resultMap.put("pigtester",new Pair<Long,Long>(25L,2L));
  resultMap.put("pigtester2",new Pair<Long,Long>(10L,1L));
  resultMap.put("pigtester3",new Pair<Long,Long>(60L,3L));
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("d = cogroup b by group, c by name;");
  pigServer.registerQuery("e = foreach d generate flatten(group), SUM(c.age), COUNT(c.name);");
  Iterator<Tuple> it=pigServer.openIterator("e");
  for (int i=0; i < resultMap.size(); i++) {
    Tuple t=it.next();
    Assert.assertEquals(true,resultMap.containsKey(t.get(0)));
    Pair<Long,Long> output=resultMap.get(t.get(0));
    Assert.assertEquals(output.first,t.get(1));
    Assert.assertEquals(output.second,t.get(2));
  }
}

</code></pre>

<br>
<pre class="type-7 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainInDotGraph() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ since TEZ does not support explain in dot format",!Util.getLocalTestMode().toString().startsWith("TEZ"));
  pigServer.registerQuery("a = load 'voter' using " + PigStorage.class.getName() + "(',') as (name, age, registration, contributions);");
  pigServer.registerQuery("b = filter a by age < 50;");
  pigServer.registerQuery("c = group b by registration;");
  pigServer.registerQuery("d = foreach c generate (chararray)group, SUM(b.contributions);");
  pigServer.registerQuery("e = order d by $1;");
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  pigServer.explain("e","dot",true,true,ps,System.out,null,null);
  ps.close();
  FileInputStream fis1=new FileInputStream("test/org/apache/pig/test/data/DotFiles/explain1.dot");
  byte[] b1=new byte[MAX_SIZE];
  fis1.read(b1);
  String goldenPlan=new String(b1);
  goldenPlan=goldenPlan.trim();
  goldenPlan=goldenPlan.replaceAll("\\d{3,}","");
  FileInputStream fis2=new FileInputStream(tmpFile);
  byte[] b2=new byte[MAX_SIZE];
  fis2.read(b2);
  String realPlan=new String(b2);
  realPlan=realPlan.trim();
  realPlan=realPlan.replaceAll("\\d{3,}","");
  String goldenPlanClean=Util.standardizeNewline(goldenPlan);
  String realPlanClean=Util.standardizeNewline(realPlan);
  System.out.println("-----------golden");
  System.out.println(goldenPlanClean);
  System.out.println("-----------");
  System.out.println(realPlanClean);
  Assert.assertEquals(realPlanClean,goldenPlanClean);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUtf8Dump() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"wendyξ"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray);");
  Iterator<Tuple> it=pigServer.openIterator("a");
  Tuple t=it.next();
  Assert.assertEquals("wendyξ",t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=createFile(new String[]{"a:1","b:1","a:1"});
  File f2=createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoadCtorArgs() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"hello:world"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using org.apache.pig.test.PigStorageNoDefCtor(':');");
  pigServer.registerQuery("b = foreach a generate (chararray)$0, (chararray)$1;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals("hello",t.get(0));
  Assert.assertEquals("world",t.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComplexData() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals("1",t.get(1).toString());
  Assert.assertEquals("2",t.get(2).toString());
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  String output="./TestEvalPipeline-testComplexData";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("x = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);");
  pigServer.registerQuery("y = foreach x generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  it=pigServer.openIterator("y");
  t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals("1",t.get(1).toString());
  Assert.assertEquals("2",t.get(2).toString());
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookup() throws Exception {
  DataBag b=BagFactory.getInstance().newDefaultBag();
  Map<String,Object> colors=new HashMap<String,Object>();
  colors.put("apple","red");
  colors.put("orange","orange");
  Map<String,Object> weights=new HashMap<String,Object>();
  weights.put("apple","0.1");
  weights.put("orange","0.3");
  Tuple t=mTf.newTuple();
  t.append(colors);
  t.append(weights);
  b.add(t);
  File tempF=File.createTempFile("tmp","");
  tempF.delete();
  String fileName=Util.removeColon(tempF.getCanonicalPath());
  PigFile f=new PigFile(fileName);
  f.store(b,new FuncSpec(BinStorage.class.getCanonicalName()),pigServer.getPigContext());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(fileName) + "' using BinStorage();");
  pigServer.registerQuery("b = foreach a generate $0#'apple',flatten($1#'orange');");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  t=iter.next();
  Assert.assertEquals(t.get(0).toString(),"red");
  Assert.assertEquals(DataType.toDouble(t.get(1)),0.3);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigServer.getPigContext()) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigServer.getPigContext()) + "') generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin2 </h4><pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSoftLinkDependencyWithMultipleScalarReferences() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A by x parallel "+ FILE_MERGE_THRESHOLD+ ";"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = FOREACH C generate B.$0;"+ "STORE D into '/tmp/output1';"+ "E = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "F = FOREACH E generate B.$0;"+ "STORE F into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  assertEquals("Unexpected number of mapreduce job. Missing concat job?",4,mrplan.size());
  MapReduceOper concatMRop=null;
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      concatMRop=mrOp;
      break;
    }
  }
  if (concatMRop == null) {
    fail("Cannot find concat job.");
  }
  assertEquals("Missing dependency for concatjob",2,mrplan.getSuccessors(concatMRop).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFetch </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test2() throws Exception {
  Properties properties=pigServer.getPigContext().getProperties();
  properties.setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_CODEC,"gz");
  properties.setProperty(PigConfiguration.PIG_ENABLE_TEMP_FILE_COMPRESSION,"true");
  properties.setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_STORAGE,"tfile");
  String query="A = load '" + Util.encodeEscape(inputFile1.getAbsolutePath()) + "' "+ "using PigStorage(' ') as (a:int, b: "+ "{t:(t1:int,t2:int,t3:int,t4:int,c:chararray)});"+ "C = foreach A {"+ "  temp1 = foreach b generate t1*100 as (key:int), ((t2+t3)*10) as (r:int);"+ "  temp2 = filter temp1 by key < 400;"+ "  temp3 = limit temp2 3;"+ "  temp4 = foreach temp3 generate key-r as (id:int);"+ "  temp5 = limit temp4 4;"+ "  temp6 = filter temp5 by id < 100;"+ "  generate flatten(temp6) as (id:int), a;"+ "};"+ "D = foreach C generate ("+ "  case id % 4"+ "    when 0 then true"+ "    else false"+ "  end"+ ") as (check:boolean);"+ "store D into 'out' using org.apache.pig.impl.io.TFileStorage();";
  LogicalPlan lp=ParserTestingUtils.generateLogicalPlan(query);
  PhysicalPlan pp=((HExecutionEngine)pigServer.getPigContext().getExecutionEngine()).compile(lp,null);
  boolean planFetchable=FetchOptimizer.isPlanFetchable(pigServer.getPigContext(),pp);
  assertFalse(planFetchable);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test1() throws Exception {
  String query="A = load '" + Util.encodeEscape(inputFile1.getAbsolutePath()) + "' "+ "using PigStorage(' ') as (a:int, b: "+ "{t:(t1:int,t2:int,t3:int,t4:int,c:chararray)});"+ "C = foreach A {"+ "  temp1 = foreach b generate t1*100 as (key:int), ((t2+t3)*10) as (r:int);"+ "  temp2 = filter temp1 by key < 400;"+ "  temp3 = limit temp2 3;"+ "  temp4 = foreach temp3 generate key-r as (id:int);"+ "  temp5 = limit temp4 4;"+ "  temp6 = filter temp5 by id < 100;"+ "  generate flatten(temp6) as (id:int), a;"+ "};"+ "D = foreach C generate ("+ "  case id % 4"+ "    when 0 then true"+ "    else false"+ "  end"+ ") as (check:boolean);";
  LogicalPlan lp=ParserTestingUtils.generateLogicalPlan(query);
  PhysicalPlan pp=((HExecutionEngine)pigServer.getPigContext().getExecutionEngine()).compile(lp,null);
  boolean planFetchable=FetchOptimizer.isPlanFetchable(pigServer.getPigContext(),pp);
  assertFalse(planFetchable);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests whether 'pig.job.submitted.timestamp' has been set by FetchLauncher
 * @throws Exception
 */
@Test public void test7() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> justSomeRows=Lists.newArrayListWithCapacity(1);
  justSomeRows.add(tuple(1));
  data.set("justSomeRows",justSomeRows);
  pigServer.registerQuery("A = load 'justSomeRows' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate CurrentTime();");
  Iterator<Tuple> it=pigServer.openIterator("B");
  DateTime received=(DateTime)it.next().get(0);
  assertNotNull(received);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test5() throws Exception {
  File scriptFile=null;
  try {
    String[] script={"A = load '" + Util.encodeEscape(inputFile2.getAbsolutePath()) + "' ","using PigStorage(' ') as (a:int, b:int, c:chararray);","B = group A by a;"};
    scriptFile=Util.createLocalInputFile("testFetchTest5.pig",script);
    pigServer.registerScript(scriptFile.getAbsolutePath());
    pigServer.setBatchOn();
    LogicalPlan lp=TestPigStats.getLogicalPlan(pigServer);
    PhysicalPlan pp=((HExecutionEngine)pigServer.getPigContext().getExecutionEngine()).compile(lp,null);
    boolean planFetchable=FetchOptimizer.isPlanFetchable(pigServer.getPigContext(),pp);
    assertFalse(planFetchable);
  }
  finally {
    if (scriptFile != null) {
      scriptFile.delete();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test4() throws Exception {
  File scriptFile=null;
  try {
    String[] script={"A = load '" + Util.encodeEscape(inputFile2.getAbsolutePath()) + "' ","using PigStorage(' ') as (a:int, b:int, c:chararray);","B = limit A 2;","C = limit A 1;","D = union A,B,C;"};
    scriptFile=Util.createLocalInputFile("testFetchTest4.pig",script);
    pigServer.registerScript(scriptFile.getAbsolutePath());
    pigServer.setBatchOn();
    LogicalPlan lp=TestPigStats.getLogicalPlan(pigServer);
    PhysicalPlan pp=((HExecutionEngine)pigServer.getPigContext().getExecutionEngine()).compile(lp,null);
    boolean planFetchable=FetchOptimizer.isPlanFetchable(pigServer.getPigContext(),pp);
    assertFalse(planFetchable);
  }
  finally {
    if (scriptFile != null) {
      scriptFile.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilter </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    ConstantExpression c2=GenPhyOp.exprConst();
    c2.setValue(new Integer(0));
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,c2,DataType.INTEGER);
    POProject p3=GenPhyOp.exprProject(1);
    ConstantExpression c=GenPhyOp.exprConst();
    c.setValue(new Integer(1));
    EqualToExpr eq=GenPhyOp.compEqualToExpr(p3,c,DataType.INTEGER);
    POAnd and=GenPhyOp.compAndExpr(gt,eq);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(c2);
    ip.add(gt);
    ip.add(p3);
    ip.add(c);
    ip.add(eq);
    ip.add(and);
    ip.connect(p1,gt);
    ip.connect(c2,gt);
    ip.connect(p3,eq);
    ip.connect(c,eq);
    ip.connect(eq,and);
    ip.connect(gt,and);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
    assertEquals(1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue(it.hasNext());
    t=it.next();
    assertEquals(2,t.size());
    assertTrue(t.get(0) instanceof Integer);
    assertTrue(t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals(1,(int)i1);
    assertEquals(1,(int)i2);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    POProject p2=GenPhyOp.exprProject(1);
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,p2,DataType.INTEGER);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(p2);
    ip.add(gt);
    ip.connect(p1,gt);
    ip.connect(p2,gt);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",POStatus.STATUS_EOP,res.returnStatus);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",it.hasNext());
    t=it.next();
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",2,t.size());
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(0) instanceof Integer);
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,(int)i1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",0,(int)i2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpNumeric </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate (($0 < 10 or $0 < 9)?(($1 >= 5 and $1 >= 4) ? 2: 1) : 0);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Integer first=(Integer)t.get(0);
    count+=first;
    assertTrue(first == 1 || first == 2 || first == 0);
  }
  assertEquals("expected count of 15",15,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericLt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + ":" + (double)(i + 1));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (a: double, b:double);");
  String query="A = filter A by ($0 <= $1 and $0 < $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) < 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNumericEq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + ":" + (i - 1));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by ($0 == $1 and $0 <= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertEquals(first,second);
    String sfirst=t.get(0).toString();
    String ssecond=t.get(1).toString();
    assertFalse(sfirst.equals(ssecond));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericGte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else     if (i % 3 == 0) {
      ps.println(i - 1 + ":" + (double)(i));
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by ($0 > $1 or $0 >= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) >= 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericNeq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("1:1");
    }
 else {
      ps.println("2:3");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 != $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertFalse(first.equals(second));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericLte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else     if (i % 3 == 0) {
      ps.println(i - 1 + ":" + (double)(i));
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (a: double, b:double);");
  String query="A = filter A by ($0 <= $1 or $0 < $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) <= 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericGt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (f1: double, f2:double);");
  String query="A = filter A by ($0 > $1 and $0 >= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) > 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate ($1 >= " + LOOP_COUNT + "-10?'1':'0');";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    if (first == 1)     count++;
 else     assertTrue(first == 0);
  }
  assertEquals("expected count of 10",10,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpString </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) > 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) < 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) >= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringNeq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("ab:ab");
    }
 else     if (i % 3 == 0) {
      ps.println("ab:abc");
      expectedCount++;
    }
 else {
      ps.println(":");
      ps.println("ab:");
      ps.println(":ab");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 neq $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertFalse(first.equals(second));
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringEq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("a:" + i);
      ps.println("a:");
      ps.println(":a");
      ps.println(":");
    }
 else {
      ps.println("ab:ab");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 eq $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    count++;
    assertEquals(first,second);
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) <= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterUDF </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterUDF() throws Exception {
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' as (x:int);");
  pigServer.registerQuery("B = filter A by " + MyFilterFunction.class.getName() + "($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,(Integer)t.get(0) > 10);
    ++cnt;
  }
  assertEquals(10,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFusingDefine2() throws Exception {
  File inputFile=createFile(new String[]{"www.paulisageek.com\t4","www.yahoo.com\t12344","google.com\t1","us2.amazon.com\t4141"});
  File filterFile=createFile(new String[]{"12344"});
  pigServer.registerQuery("define FILTER_CRITERION " + FILTERFROMFILE.class.getName() + "('"+ Util.generateURI(filterFile.toString(),pigServer.getPigContext())+ "');");
  pigServer.registerQuery("a = LOAD '" + Util.generateURI(inputFile.toString(),pigServer.getPigContext()) + "' as (url:chararray, numvisits:int);");
  pigServer.registerQuery("b = filter a by FILTER_CRITERION(numvisits) AND FILTER_CRITERION(numvisits);");
  Tuple expectedTuple=tf.newTuple();
  expectedTuple.append(new String("www.yahoo.com"));
  expectedTuple.append(new Integer("12344"));
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.equals(expectedTuple));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFusingDefine() throws Exception {
  File inputFile=createFile(new String[]{"www.paulisageek.com\t4","www.yahoo.com\t12344","google.com\t1","us2.amazon.com\t4141"});
  File filterFile=createFile(new String[]{"12344"});
  pigServer.registerQuery("define FILTER_CRITERION " + FILTERFROMFILE.class.getName() + "('"+ Util.generateURI(filterFile.toString(),pigServer.getPigContext())+ "');");
  pigServer.registerQuery("a = LOAD '" + Util.generateURI(inputFile.toString(),pigServer.getPigContext()) + "' as (url:chararray, numvisits:int);");
  pigServer.registerQuery("b = filter a by FILTER_CRITERION(numvisits);");
  Tuple expectedTuple=tf.newTuple();
  expectedTuple.append(new String("www.yahoo.com"));
  expectedTuple.append(new Integer("12344"));
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.equals(expectedTuple));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFindQuantiles </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFindQuantiles2() throws Exception {
  final int numSamples=30000;
  final int numReducers=3000;
  float sum=getProbVecSum(numSamples,numReducers);
  System.out.println("sum: " + sum);
  assertTrue(sum > (1 - epsilon) && sum < (1 + epsilon));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFindQuantiles() throws Exception {
  final int numSamples=97778;
  final int numReducers=1009;
  float sum=getProbVecSum(numSamples,numReducers);
  System.out.println("sum: " + sum);
  assertTrue(sum > (1 - epsilon) && sum < (1 + epsilon));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlanLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossTwoRelations() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10'),('user1','usa','user1','usa','30'),('user1','usa','user1','china','20')})","({('user2','usa','user2','usa','20'),('user2','usa','user2','usa','20')})","({('user3','singapore','user3','usa','10'),('user3','singapore','user3','singapore','20')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("C = cogroup user by uid, session by uid;");
  pig.registerQuery("D = foreach C {" + "crossed = cross user, session;" + "generate crossed;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossTwoRelationsComplex() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10'),('user1','usa','user1','usa','30')})","({('user2','usa','user2','usa','20')})","({('user3','singapore','user3','singapore','20')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("C = cogroup user by uid, session by uid;");
  pig.registerQuery("D = foreach C {" + "distinct_session = distinct session;" + "crossed = cross user, distinct_session;"+ "filtered = filter crossed by user::region == distinct_session::region;"+ "generate filtered;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossThreeRelations() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10','user1','admin','male'),('user1','usa','user1','usa','30','user1','admin','male'),('user1','usa','user1','china','20','user1','admin','male')})","({('user2','usa','user2','usa','20','user2','guest','male'),('user2','usa','user2','usa','20','user2','guest','male')})","({('user3','singapore','user3','usa','10','user3','user','female'),('user3','singapore','user3','singapore','20','user3','user','female')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("profile = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[2].toString(),pig.getPigContext())) + "' as (uid, role, gender);");
  pig.registerQuery("C = cogroup user by uid, session by uid, profile by uid;");
  pig.registerQuery("D = foreach C {" + "crossed = cross user, session, profile;" + "generate crossed;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFuncSpec </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSpecCtorClassNameNoArgs(){
  String pigStorage=PigStorage.class.getName();
  FuncSpec fs=new FuncSpec(pigStorage + "()");
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof PigStorage);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSpecCtorClassNameWithArgs(){
  String dummy=DummyClass.class.getName();
  FuncSpec fs=new FuncSpec(dummy + "(':')");
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof DummyClass);
  assertEquals((byte)':',((DummyClass)o).delim);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSpecCtorClassName(){
  String pigStorage=PigStorage.class.getName();
  FuncSpec fs=new FuncSpec(pigStorage);
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof PigStorage);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCtorClassNameArgs(){
  String dummy=DummyClass.class.getName();
  String[] args=new String[]{":"};
  FuncSpec fs=new FuncSpec(dummy,args);
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof DummyClass);
  assertEquals((byte)':',((DummyClass)o).delim);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGrunt </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutoShipUDFContainingJar() throws Throwable {
  String FILE_SEPARATOR=System.getProperty("file.separator");
  File tmpDir=File.createTempFile("test","");
  tmpDir.delete();
  tmpDir.mkdir();
  File udfDir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf");
  udfDir.mkdirs();
  String udfSrc=new String("package com.xxx.udf;\n" + "import java.io.IOException;\n" + "import org.apache.pig.EvalFunc;\n"+ "import org.apache.pig.data.Tuple;\n"+ "public class TestUDF extends EvalFunc<Integer>{\n"+ "public Integer exec(Tuple input) throws IOException {\n"+ "return 1;}\n"+ "}");
  JavaCompilerHelper javaCompilerHelper=new JavaCompilerHelper();
  javaCompilerHelper.compile(tmpDir.getAbsolutePath(),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf.TestUDF",udfSrc));
  String jarName="TestUDFJar.jar";
  String jarFile=tmpDir.getAbsolutePath() + FILE_SEPARATOR + jarName;
  int status=Util.executeJavaCommand("jar -cf " + jarFile + " -C "+ tmpDir.getAbsolutePath()+ " "+ "com");
  assertEquals(0,status);
  Util.createInputFile(cluster,"table_testAutoShipUDFContainingJar",new String[]{"1"});
  File scriptFile=Util.createFile(new String[]{"a = load 'table_testAutoShipUDFContainingJar' as (a0:int);" + "b = foreach a generate com.xxx.udf.TestUDF(a0);" + "store b into 'output_testAutoShipUDFContainingJar';"});
  String scriptFileName=scriptFile.getAbsolutePath();
  String execTypeOptions="-x " + cluster.getExecType() + " ";
  String cmd="java -cp " + System.getProperty("java.class.path") + File.pathSeparator+ jarFile+ " org.apache.pig.Main "+ execTypeOptions+ scriptFileName;
  ProcessReturnInfo pri=Util.executeJavaCommandAndReturnInfo(cmd);
  assertEquals(pri.exitCode,0);
  String[] lines=pri.stderrContents.split("\n");
  boolean found=false;
  for (  String line : lines) {
    if (line.matches(".*Added jar .*" + jarName + ".*")) {
      found=true;
    }
 else     if (line.matches(".*Local resource.*" + jarName + ".*")) {
      found=true;
    }
  }
  assertTrue(found);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * verify that grunt commands are ignored in explain -script mode
 */
@Test public void testExplainScript2() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="explain -script " + basedir + "/explainScript.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  String logMessagesFile="TestGrunt-testExplainScript2-stderr.txt";
  Appender fileAppender=new FileAppender(new PatternLayout(),logMessagesFile);
  try {
    org.apache.log4j.LogManager.getRootLogger().addAppender(fileAppender);
    Grunt grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    BufferedReader in=new BufferedReader(new FileReader(logMessagesFile));
    String gruntLoggingContents="";
    String line;
    while ((line=in.readLine()) != null) {
      gruntLoggingContents+=line + "\n";
    }
    in.close();
    String[] cmds=new String[]{"'rm/rmf'","'cp'","'cat'","'cd'","'pwd'","'copyFromLocal'","'copyToLocal'","'describe'","'ls'","'mkdir'","'illustrate'","'run/exec'","'fs'","'aliases'","'mv'","'dump'"};
    for (    String c : cmds) {
      String expected=c + " statement is ignored while processing " + "'explain -script' or '-check'";
      assertTrue("Checking if " + gruntLoggingContents + " contains "+ expected,gruntLoggingContents.contains(expected));
    }
  }
  finally {
    org.apache.log4j.LogManager.getRootLogger().removeAppender(fileAppender);
    new File(logMessagesFile).delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using UTF-8 Plain Text format projecting column c
 * @throws IOException
 */
@Test public void testStoreToHBase_2_with_projection() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    int col_a=Integer.parseInt(new String(getColValue(result,TESTCOLUMN_A)));
    double col_b=Double.parseDouble(new String(getColValue(result,TESTCOLUMN_B)));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that -noWAL actually disables the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testNoWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A,"-noWAL");
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertFalse(put.getWriteToWAL());
    Assert.assertFalse(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreEmptyMap() throws IOException {
  String tableName="emptyMapTest";
  HTable table;
  try {
    deleteAllRows(tableName);
  }
 catch (  Exception e) {
  }
  byte[][] cfs=new byte[2][];
  cfs[0]=Bytes.toBytes("info");
  cfs[1]=Bytes.toBytes("friends");
  try {
    table=util.createTable(Bytes.toBytesBinary(tableName),cfs);
  }
 catch (  Exception e) {
    table=new HTable(conf,Bytes.toBytesBinary(tableName));
  }
  File inputFile=Util.createInputFile("test","tmp",new String[]{"row1;Homer;Morrison;[1#Silvia,2#Stacy]","row2;Sheila;Fletcher;[1#Becky,2#Salvador,3#Lois]","row4;Andre;Morton;[1#Nancy]","row3;Sonja;Webb;[]"});
  pig.registerQuery("source = LOAD '" + Util.generateURI(inputFile.toString(),pig.getPigContext()) + "' USING PigStorage(';')"+ " AS (row:chararray, first_name:chararray, last_name:chararray, friends:map[]);");
  pig.registerQuery("STORE source INTO 'hbase://" + tableName + "' USING"+ " org.apache.pig.backend.hadoop.hbase.HBaseStorage('info:fname info:lname friends:*');");
  Get get=new Get(Bytes.toBytes("row3"));
  Result r=table.get(get);
  Assert.assertEquals(new String(r.getValue(cfs[0],Bytes.toBytes("fname"))),"Sonja");
  Assert.assertEquals(new String(r.getValue(cfs[0],Bytes.toBytes("lname"))),"Webb");
  Assert.assertTrue(r.getFamilyMap(cfs[1]).isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test Load from hbase with maxTimestamp, minTimestamp, timestamp
 */
@Test public void testLoadWithSpecifiedTimestampAndRanges() throws IOException {
  long beforeTimeStamp=System.currentTimeMillis() - 10;
  HTable table=prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  long afterTimeStamp=System.currentTimeMillis() + 10;
  Assert.assertEquals("MaxTimestamp is set before rows added",0,queryWithTimestamp(null,beforeTimeStamp,null));
  Assert.assertEquals("MaxTimestamp is set after rows added",TEST_ROW_COUNT,queryWithTimestamp(null,afterTimeStamp,null));
  Assert.assertEquals("MinTimestamp is set after rows added",0,queryWithTimestamp(afterTimeStamp,null,null));
  Assert.assertEquals("MinTimestamp is set before rows added",TEST_ROW_COUNT,queryWithTimestamp(beforeTimeStamp,null,null));
  Assert.assertEquals("Timestamp range is set around rows added",TEST_ROW_COUNT,queryWithTimestamp(beforeTimeStamp,afterTimeStamp,null));
  Assert.assertEquals("Timestamp range is set after rows added",0,queryWithTimestamp(afterTimeStamp,afterTimeStamp + 10,null));
  Assert.assertEquals("Timestamp range is set before rows added",0,queryWithTimestamp(beforeTimeStamp - 10,beforeTimeStamp,null));
  Assert.assertEquals("Timestamp is set before rows added",0,queryWithTimestamp(null,null,beforeTimeStamp));
  Assert.assertEquals("Timestamp is set after rows added",0,queryWithTimestamp(null,null,afterTimeStamp));
  long specifiedTimestamp=table.get(new Get(Bytes.toBytes("00"))).getColumnLatest(COLUMNFAMILY,Bytes.toBytes("col_a")).getTimestamp();
  Assert.assertTrue("Timestamp is set equals to row 01",queryWithTimestamp(null,null,specifiedTimestamp) > 0);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using UTF-8 Plain Text format, and store it
 * into 'TESTTABLE_2' using UTF-8 Plain Text format projecting column c
 * @throws IOException
 */
@Test public void testStoreToHBase_3_with_projection_no_caster() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  prepareTable(TESTTABLE_2,false,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.UTF8PlainText);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    String col_a=new String(getColValue(result,TESTCOLUMN_A));
    String col_b=new String(getColValue(result,TESTCOLUMN_B));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i + "",col_a);
    Assert.assertEquals(i + 0.0 + "",col_b);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase test including the row key as the first column
 * @throws IOException
 */
@Test public void testLoadFromHBaseWithRowKey() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBaseWithRowKey Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBaseWithRowKey done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_bytearray_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, " + timestamp + "l as timestamp:bytearray, col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with projection.
 */
@Test public void testLoadWithProjection_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE col_a, col_c;");
  Iterator<Tuple> it=pig.openIterator("b");
  int index=0;
  LOG.info("testLoadWithProjection_1 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    int col_a=(Integer)t.get(0);
    String col_c=(String)t.get(1);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals("Text_" + index,col_c);
    Assert.assertEquals(2,t.size());
    index++;
  }
  Assert.assertEquals(100,index);
  LOG.info("testLoadWithProjection_1 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_1' deleting odd row keys
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_delete() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, (boolean)(((int)rowKey) % 2), col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_1,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTombstone true')");
  HTable table=new HTable(conf,TESTTABLE_1);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int count=0;
  for (int i=0; iter.hasNext(); i=i + 2) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
    count++;
  }
  Assert.assertEquals(50,count);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lt and gt (10&lt;key&lt;30) and regex \\d[5]
 */
@Test public void testLoadWithParameters_5() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gt 10 -lt 30 -regex \\\\d[5]') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int[] expectedValues={15,25};
  int count=0;
  int countExpected=2;
  LOG.info("LoadFromHBaseWithParameters_5 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals(expectedValues[count] + "",rowKey);
    Assert.assertEquals(expectedValues[count],Integer.parseInt(col_a));
    Assert.assertEquals((double)expectedValues[count],Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + expectedValues[count],col_c);
    count++;
  }
  Assert.assertEquals(countExpected,count);
  LOG.info("LoadFromHBaseWithParameters_5 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with map parameters and multiple column prefixs
 */
@Test public void testLoadWithMap_3_col_prefix() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_* pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, pig_cf_map:map[], pig_prefix_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=t.get(0).toString();
    Map pig_cf_map=(Map)t.get(1);
    Map pig_prefix_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_prefix_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_prefix_cf_map.size());
    Assert.assertEquals(count,Integer.parseInt(pig_cf_map.get("col_a").toString()));
    Assert.assertEquals(count + 0.0,Double.parseDouble(pig_cf_map.get("col_b").toString()),1e-6);
    Assert.assertEquals("Text_" + count,((DataByteArray)pig_cf_map.get("col_c")).toString());
    Assert.assertEquals(3,pig_cf_map.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, " + timestamp + "l, col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with projection and the default caster.
 */
@Test public void testLoadWithProjection_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.UTF8PlainText);
  pig.registerQuery("b = FOREACH a GENERATE col_a, col_c;");
  Iterator<Tuple> it=pig.openIterator("b");
  int index=0;
  LOG.info("testLoadWithProjection_2 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    int col_a=(Integer)t.get(0);
    String col_c=(String)t.get(1);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals("Text_" + index,col_c);
    Assert.assertEquals(2,t.size());
    index++;
  }
  Assert.assertEquals(100,index);
  LOG.info("testLoadWithProjection_2 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat
 * @throws IOException
 */
@Test public void testStoreToHBase_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  pig.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,"true");
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.store("a","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  pig.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,"false");
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to if HBaseStorage handles different scans in a single MR job.
 * This can happen PIG loads two different aliases (as in a join or
 * union).
 */
@Test public void testHeterogeneousScans() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery(String.format(" b = load 'hbase://%s' using %s('%s %s') as (col_a:int, col_c);",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage",TESTCOLUMN_A,TESTCOLUMN_C));
  pig.registerQuery(" c = join a by col_a, b by col_a; ");
  Iterator<Tuple> it=pig.openIterator("c");
  int index=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    Assert.assertNotNull(t.get(2));
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  Assert.assertEquals(index,TEST_ROW_COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and with a
 * static column in different order
 */
@Test public void testLoadOrderWithFixedAndPrefixedCols() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_* pig:prefixed_col_d"+ "','-loadKey') as (rowKey:chararray, cols:map[], prefixed_col_d:chararray);");
  pig.registerQuery("b = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:prefixed_col_d pig:col_*"+ "','-loadKey') as (rowKey:chararray, prefixed_col_d:chararray, cols:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  Iterator<Tuple> it2=pig.openIterator("b");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext() && it2.hasNext()) {
    Tuple t=it.next();
    Tuple t2=it2.next();
    LOG.info("LoadFromHBase a:" + t);
    LOG.info("LoadFromHBase b:" + t2);
    String rowKey=(String)t.get(0);
    String rowKey2=(String)t2.get(0);
    Assert.assertEquals(rowKey,rowKey2);
    Assert.assertEquals(t.size(),t2.size());
    @SuppressWarnings("rawtypes") Map cols_a=(Map)t.get(1);
    @SuppressWarnings("rawtypes") Map cols_b=(Map)t2.get(2);
    Assert.assertEquals(cols_a.size(),cols_b.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test collected group
 * not much to test here since keys are unique
 * @throws IOException
 */
@Test public void testCollectedGroup() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.HBaseBinary);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("c = group a by rowKey USING 'collected';");
  pig.registerQuery("d = ORDER c BY group;");
  Iterator<Tuple> it=pig.openIterator("d");
  int count=0;
  LOG.info("CollectedGroup Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    int rowCount=0;
    DataBag rows=(DataBag)t.get(1);
    for (Iterator<Tuple> iter=rows.iterator(); iter.hasNext(); ) {
      Tuple row=iter.next();
      int col_a=(Integer)row.get(1);
      double col_b=(Double)row.get(2);
      String col_c=(String)row.get(3);
      Assert.assertEquals(count,col_a);
      Assert.assertEquals(count + 0.0,col_b,1e-6);
      Assert.assertEquals("Text_" + count,col_c);
      rowCount++;
    }
    Assert.assertEquals(1,rowCount);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("CollectedGroup done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters regex [2-3][4-5]
 */
@Test public void testLoadWithParameters_4() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -regex [2-3][4-5]') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int[] expectedValues={24,25,34,35};
  int count=0;
  int countExpected=4;
  LOG.info("LoadFromHBaseWithParameters_4 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals(expectedValues[count] + "",rowKey);
    Assert.assertEquals(expectedValues[count],Integer.parseInt(col_a));
    Assert.assertEquals((double)expectedValues[count],Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + expectedValues[count],col_c);
    count++;
  }
  Assert.assertEquals(countExpected,count);
  LOG.info("LoadFromHBaseWithParameters_4 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using UTF-8 Plain Text format
 * @throws IOException
 */
@Test public void testStoreToHBase_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.store("a",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    int col_a=Integer.parseInt(new String(getColValue(result,TESTCOLUMN_A)));
    double col_b=Double.parseDouble(new String(getColValue(result,TESTCOLUMN_B)));
    String col_c=new String(getColValue(result,TESTCOLUMN_C));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and column prefix
 */
@Test public void testLoadWithMap_2_col_prefix() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=t.get(0).toString();
    Map pig_cf_map=(Map)t.get(1);
    Assert.assertEquals(2,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with map parameters
 */
@Test public void testLoadWithMap_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:"+ "','-loadKey -cacheBlocks true') as (rowKey, col_a, col_b, col_c, pig_cf_map);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Map pig_cf_map=(Map)t.get(4);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertEquals(5,pig_cf_map.size());
    Assert.assertEquals(count,Integer.parseInt(pig_cf_map.get("col_a").toString()));
    Assert.assertEquals(count + 0.0,Double.parseDouble(pig_cf_map.get("col_b").toString()),1e-6);
    Assert.assertEquals("Text_" + count,((DataByteArray)pig_cf_map.get("col_c")).toString());
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters limit
 */
@Test public void testLoadWithParameters_3() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -limit 10') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBaseWithParameters_3 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(10,count);
  LOG.info("LoadFromHBaseWithParameters_3 Starting");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat projecting out column c
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_projection() throws IOException {
  System.getProperties().setProperty("pig.usenewlogicalplan","false");
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "','-caster HBaseBinaryConverter')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_datetime_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, ToDate(" + timestamp + "l), col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and column prefix with a
 * static column
 */
@Test public void testLoadWithFixedAndPrefixedCols() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:sc pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, sc:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=(String)t.get(0);
    String col_a=t.get(1) != null ? t.get(1).toString() : null;
    Map pig_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    Assert.assertEquals(Integer.toString(count),col_a);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase using HBaseBinaryConverter
 */
@Test public void testHBaseBinaryConverter() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  Iterator<Tuple> it=pig.openIterator("a");
  int index=0;
  LOG.info("testHBaseBinaryConverter Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  LOG.info("testHBaseBinaryConverter done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and with a
 * static column
 */
@Test public void testLoadWithFixedAndPrefixedCols2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_a pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, col_a:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=(String)t.get(0);
    String col_a=t.get(1) != null ? t.get(1).toString() : null;
    Map pig_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    Assert.assertEquals(Integer.toString(count),col_a);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test merge inner join with two tables
 * @throws IOException
 */
@Test public void testMergeJoin() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.HBaseBinary);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("b = load 'hbase://" + TESTTABLE_2 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("c = join a by rowKey, b by rowKey USING 'merge';");
  pig.registerQuery("d = ORDER c BY a::rowKey;");
  Iterator<Tuple> it=pig.openIterator("d");
  int count=0;
  LOG.info("MergeJoin Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,col_a);
    Assert.assertEquals(count + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    String rowKey2=(String)t.get(4);
    int col_a2=(Integer)t.get(5);
    double col_b2=(Double)t.get(6);
    String col_c2=(String)t.get(7);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey2);
    Assert.assertEquals(count,col_a2);
    Assert.assertEquals(count + 0.0,col_b2,1e-6);
    Assert.assertEquals("Text_" + count,col_c2);
    count++;
  }
  Assert.assertEquals(count,TEST_ROW_COUNT);
  LOG.info("MergeJoin done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * load from hbase test
 * @throws IOException
 */
@Test public void testLoadFromHBase() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  LOG.info("QUERY: " + "a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Object col_d=t.get(3);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertNull(col_d);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lt and gt (00&lt;key&lt;99)
 */
@Test public void testLoadWithParameters_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gt 00 -lt 99') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  int next=1;
  LOG.info("LoadFromHBaseWithParameters_2 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((next + "").length()) + next,rowKey);
    Assert.assertEquals(next,Integer.parseInt(col_a));
    Assert.assertEquals(next + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + next,col_c);
    count++;
    next++;
  }
  Assert.assertEquals(TEST_ROW_COUNT - 2,count);
  LOG.info("LoadFromHBaseWithParameters_2 Starting");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that without -noWAL, the WAL is enabled the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testWIthWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A);
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertNotEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertNotEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertTrue(put.getWriteToWAL());
    Assert.assertTrue(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lte and gte (01<=key<=98)
 */
@Test public void testLoadWithParameters_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gte 01 -lte 98') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  int next=1;
  LOG.info("LoadFromHBaseWithParameters_1 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((next + "").length()) + next,rowKey);
    Assert.assertEquals(next,Integer.parseInt(col_a));
    Assert.assertEquals(next + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + next,col_c);
    count++;
    next++;
  }
  Assert.assertEquals(TEST_ROW_COUNT - 2,count);
  LOG.info("LoadFromHBaseWithParameters_1 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase test without hbase:// prefix
 * @throws IOException
 */
@Test public void testBackwardsCompatibility() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load '" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "') as (col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("BackwardsCompatibility Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("BackwardsCompatibility done");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorageParams </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Assert that -maxResultsPerColumnFamily actually gets set on Scan
 */
@Test public void testSetsMaxResultsPerColumnFamily() throws Exception {
  Field scanField=HBaseStorage.class.getDeclaredField("scan");
  scanField.setAccessible(true);
  HBaseStorage storageNoMax=new HBaseStorage("","");
  Scan scan=(Scan)scanField.get(storageNoMax);
  Assert.assertEquals(-1,scan.getMaxResultsPerColumnFamily());
  HBaseStorage storageWithMax=new HBaseStorage("","-maxResultsPerColumnFamily 123");
  scan=(Scan)scanField.get(storageWithMax);
  Assert.assertEquals(123,scan.getMaxResultsPerColumnFamily());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestImplicitSplit </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitInCoGroup() throws Exception {
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImplicitSplitInCoGroup2() throws Exception {
  String query="a = load 'file1' using PigStorage(':') as (name:chararray, marks:int);" + "b = load 'file2' using PigStorage(':') as (name:chararray, rank:chararray);" + "c = cogroup a by name, b by name;"+ "d = foreach c generate group, FLATTEN(a.marks) as newmarks;"+ "e = cogroup a by marks, d by newmarks;"+ "f = foreach e generate group, flatten(a), flatten(d);"+ "store f into 'output';";
  org.apache.pig.newplan.logical.relational.LogicalPlan plan=Util.buildLp(pigServer,query);
  printTypeGraph(plan);
  Util.optimizeNewLP(plan);
  String schema="group:int,a::name:chararray,a::marks:int,d::group:chararray,d::newmarks:int";
  LogicalSchema sch=((LogicalRelationalOperator)plan.getSinks().get(0)).getSchema();
  assertTrue(schema.equals(sch.toString(false)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestIn </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that IN operator works with FILTER BY.
 * @throws Exception
 */
@Test public void testWithFilter() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FILTER A BY i IN (1, 2, 3);");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(3,out.size());
  assertEquals(tuple(1),out.get(0));
  assertEquals(tuple(2),out.get(1));
  assertEquals(tuple(3),out.get(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that IN operator works when expressions contain dereference operators.
 * @throws Exception
 */
@Test public void testWithDereferenceOperator() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple("a","x",1),tuple("a","y",2),tuple("b","x",3),tuple("b","y",4),tuple("c","x",5),tuple("c","y",6));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (k1:chararray, k2:chararray, i:int);");
  pigServer.registerQuery("B = GROUP A BY (k1, k2);");
  pigServer.registerQuery("C = FILTER B BY group.k1 IN ('a', 'b') AND group.k2 IN ('x');");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(2,out.size());
  assertEquals(tuple(tuple("a","x"),bag(tuple("a","x",1))),out.get(0));
  assertEquals(tuple(tuple("b","x"),bag(tuple("b","x",3))),out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that IN operator works with SPLIT.
 * @throws Exception
 */
@Test public void testWithSplit() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("SPLIT A INTO B IF i IN (1, 3, 5), C OTHERWISE;");
  pigServer.registerQuery("STORE B INTO 'odd' USING mock.Storage();");
  pigServer.registerQuery("STORE C INTO 'even' USING mock.Storage();");
  List<Tuple> out=data.get("odd");
  assertEquals(3,out.size());
  assertEquals(tuple(1),out.get(0));
  assertEquals(tuple(3),out.get(1));
  assertEquals(tuple(5),out.get(2));
  out=data.get("even");
  assertEquals(2,out.size());
  assertEquals(tuple(2),out.get(0));
  assertEquals(tuple(4),out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify that IN operator works with ? operator.
 * @throws Exception
 */
@Test public void testWithBincond() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (i IN (1, 3, 5) ? 'ODD' : 'EVEN');");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(5,out.size());
  assertEquals(tuple("ODD"),out.get(0));
  assertEquals(tuple("EVEN"),out.get(1));
  assertEquals(tuple("ODD"),out.get(2));
  assertEquals(tuple("EVEN"),out.get(3));
  assertEquals(tuple("ODD"),out.get(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInfixArithmetic </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 + $1, $1;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first + first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivide() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 / $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(1.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiply() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 * $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first * first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 - $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(0.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputFileValidator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testcase to ensure Input output validation allows store to a location
 * that does not exist when using {@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test public void testPigServerStore() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    FileLocalizer.setInitialized(false);
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    pig.registerQuery("a = load '" + input + "';");
    pig.store("a",output);
    pig.registerQuery("b = load '" + output + "';");
    Iterator<Tuple> it=pig.openIterator("b");
    Tuple t=it.next();
    assertEquals("hello",t.get(0).toString());
    assertEquals("world",t.get(1).toString());
    assertFalse(it.hasNext());
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputMiniClusterFileValidator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidationNeg() throws Throwable {
  try {
    pig.setBatchOn();
    pig.registerQuery("A = load 'inputfile' using PigStorage () as (a:int);");
    pig.registerQuery("store A into 'outfile' using " + DummyStorer.class.getName() + ";");
    pig.executeBatch();
    assert false;
  }
 catch (  Exception fe) {
    assertTrue(fe instanceof FrontendException);
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(1115,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Exception from DummyStorer."));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testcase to ensure Input output validation allows store to a location
 * that does not exist when using {@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test public void testPigServerStore() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    FileLocalizer.setInitialized(false);
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    pig.registerQuery("a = load '" + input + "';");
    pig.store("a",output);
    pig.registerQuery("b = load '" + output + "';");
    Iterator<Tuple> it=pig.openIterator("b");
    Tuple t=it.next();
    assertEquals("hello",t.get(0).toString());
    assertEquals("world",t.get(1).toString());
    assertFalse(it.hasNext());
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobControlCompiler </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * specifically tests that REGISTERED jars get added to distributed cache
 * @throws Exception
 */
@Test public void testJarAddedToDistributedCache() throws Exception {
  File tmpFile=File.createTempFile("Some_",".jar");
  tmpFile.deleteOnExit();
  String className=createTestJar(tmpFile);
  final String testUDFFileName=className + ".class";
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE);
  PigContext pigContext=pigServer.getPigContext();
  pigContext.connect();
  pigContext.addJar(tmpFile.getAbsolutePath());
  JobControlCompiler jobControlCompiler=new JobControlCompiler(pigContext,CONF);
  MROperPlan plan=new MROperPlan();
  MapReduceOper mro=new MapReduceOper(new OperatorKey());
  mro.UDFs=new HashSet<String>();
  mro.UDFs.add(className + "()");
  plan.add(mro);
  JobControl jobControl=jobControlCompiler.compile(plan,"test");
  JobConf jobConf=jobControl.getWaitingJobs().get(0).getJobConf();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(jobConf);
  Assert.assertEquals("size for " + Arrays.toString(fileClassPaths),HadoopShims.isHadoopYARN() ? 5 : 6,fileClassPaths.length);
  Path distributedCachePath=fileClassPaths[0];
  Assert.assertEquals("ends with jar name: " + distributedCachePath,distributedCachePath.getName(),tmpFile.getName());
  Assert.assertTrue("starts with /: " + distributedCachePath,distributedCachePath.toString().startsWith("/"));
  Assert.assertTrue("jar pushed to distributed cache should contain testUDF",jarContainsFileNamed(new File(fileClassPaths[0].toUri().getPath()),testUDFFileName));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that no duplicate jars are added to distributed cache, which might cause conflicts
 * and tests with both symlinked and normal jar specification
 */
@Test public void testNoDuplicateJarsInDistributedCache() throws Exception {
  final PigServer pigServer=new PigServer(ExecType.MAPREDUCE);
  PigContext pigContext=pigServer.getPigContext();
  pigContext.connect();
  Configuration conf=new Configuration();
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf-0.jar#udf.jar")),conf,FileSystem.get(conf));
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf1.jar#diffname.jar")),conf,FileSystem.get(conf));
  DistributedCache.addFileToClassPath(new Path(new URI("/lib/udf2.jar")),conf,FileSystem.get(conf));
  createAndAddResource("udf.jar",pigContext);
  createAndAddResource("udf1.jar",pigContext);
  createAndAddResource("udf2.jar",pigContext);
  createAndAddResource("another.jar",pigContext);
  final JobConf jobConf=compileTestJob(pigContext,conf);
  URI[] cacheURIs=DistributedCache.getCacheFiles(jobConf);
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(jobConf);
  System.out.println("cache.files= " + Arrays.toString(cacheURIs));
  System.out.println("classpath.files= " + Arrays.toString(fileClassPaths));
  if (HadoopShims.isHadoopYARN()) {
    Assert.assertEquals("size 9 for " + Arrays.toString(cacheURIs),9,Arrays.asList(StringUtils.join(cacheURIs,",").split(",")).size());
    Assert.assertEquals("size 9 for " + Arrays.toString(fileClassPaths),9,Arrays.asList(StringUtils.join(fileClassPaths,",").split(",")).size());
  }
 else {
    Assert.assertEquals("size 12 for " + Arrays.toString(cacheURIs),12,Arrays.asList(StringUtils.join(cacheURIs,",").split(",")).size());
    Assert.assertEquals("size 12 for " + Arrays.toString(fileClassPaths),12,Arrays.asList(StringUtils.join(fileClassPaths,",").split(",")).size());
  }
  Map<String,Integer> occurrences=new HashMap<String,Integer>();
  for (  URI cacheURI : cacheURIs) {
    Integer val=occurrences.get(cacheURI.toString());
    val=(val == null) ? 1 : ++val;
    occurrences.put(cacheURI.toString(),val);
  }
  if (HadoopShims.isHadoopYARN()) {
    Assert.assertEquals(9,occurrences.size());
  }
 else {
    Assert.assertEquals(10,occurrences.size());
  }
  for (  String file : occurrences.keySet()) {
    if (!HadoopShims.isHadoopYARN() && (file.endsWith("udf.jar") || file.endsWith("udf2.jar"))) {
      Assert.assertEquals("Two occurrences for " + file,2,(int)occurrences.get(file));
    }
 else {
      Assert.assertEquals("One occurrence for " + file,1,(int)occurrences.get(file));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobSubmission </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSort() throws Throwable {
  String query="a = load 'input';" + "b = order a by $0 parallel 100;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isGlobalSort()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-7 type-6 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReducerNumEstimationForOrderBy() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ",Util.isMapredExecType(cluster.getExecType()));
  pc.getProperties().setProperty("pig.exec.reducers.bytes.per.reducer","100");
  pc.getProperties().setProperty("pig.exec.reducers.max","10");
  String query="a = load '/passwd';" + "b = order a by $0;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  Configuration conf=ConfigurationUtil.toConfiguration(pc.getProperties());
  JobControlCompiler jcc=new JobControlCompiler(pc,conf);
  JobControl jobControl=jcc.compile(mrPlan,query);
  assertEquals(2,mrPlan.size());
  Util.assertParallelValues(-1,1,-1,1,jobControl.getWaitingJobs().get(0).getJobConf());
  MapReduceOper sort=mrPlan.getLeaves().get(0);
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  FileLocalizer.create(sort.getQuantFile(),pc);
  jobControl=jcc.compile(mrPlan,query);
  sort=mrPlan.getLeaves().get(0);
  long reducer=Math.min((long)Math.ceil(new File("test/org/apache/pig/test/data/passwd").length() / 100.0),10);
  assertEquals(reducer,sort.getRequestedParallelism());
  Util.assertParallelValues(-1,-1,reducer,reducer,jobControl.getWaitingJobs().get(0).getJobConf());
  query="a = load '/passwd';" + "b = order a by $0 PARALLEL 2;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(2,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  assertEquals(2,sort.getRequestedParallelism());
  query="a = load 'hbase://passwd' using org.apache.pig.backend.hadoop.hbase.HBaseStorage('c:f1 c:f2');" + "b = order a by $0 ;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(2,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  assertEquals(-1,sort.getRequestedParallelism());
  query="a = load '/passwd';" + "b = foreach a generate $0, $1, $2;" + "c = order b by $0;"+ "store c into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(3,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  FileLocalizer.create(sort.getQuantFile(),pc);
  jobControl=jcc.compile(mrPlan,query);
  Util.copyFromLocalToCluster(cluster,"test/org/apache/pig/test/data/passwd",((POLoad)sort.mapPlan.getRoots().get(0)).getLFile().getFileName());
  Util.assertParallelValues(-1,-1,-1,0,jobControl.getWaitingJobs().get(0).getJobConf());
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  jobControl=jcc.compile(mrPlan,query);
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  Util.assertParallelValues(-1,1,-1,1,jobControl.getWaitingJobs().get(0).getJobConf());
  jobControl=jcc.compile(mrPlan,query);
  sort=mrPlan.getLeaves().get(0);
  assertEquals(reducer,sort.getRequestedParallelism());
  Util.assertParallelValues(-1,-1,reducer,reducer,jobControl.getWaitingJobs().get(0).getJobConf());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSkewJoin() throws Throwable {
  String query="a = load 'input';" + "b = load 'input';" + "c = join a by $0, b by $0 using 'skewed' parallel 100;"+ "store c into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isSkewedJoin()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToUri() throws Exception {
  Class<JobControlCompiler> jobControlCompilerClass=JobControlCompiler.class;
  Method toURIMethod=jobControlCompilerClass.getDeclaredMethod("toURI",Path.class);
  toURIMethod.setAccessible(true);
  Path p1=new Path("/tmp/temp-1510081022/tmp-1308657145#pigsample_1889145873_1351808882314");
  URI uri1=(URI)toURIMethod.invoke(null,p1);
  Assert.assertEquals(uri1.toString(),"/tmp/temp-1510081022/tmp-1308657145#pigsample_1889145873_1351808882314");
  Path p2=new Path("C:/Program Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314");
  URI uri2=(URI)toURIMethod.invoke(null,p2);
  Assert.assertTrue(uri2.toString().equals("C:/Program%20Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314") || uri2.toString().equals("/C:/Program%20Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFullOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 full outer, b by $0;";
    }
 else {
      script+="c = join a by $0 full, b by $0;";
    }
    script+="d = order c by $1, $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 full outer, b by $0;";
      }
 else {
        script+="c = join a by $0 full, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinSchema() throws Exception {
  String[] input1={"1\t2","2\t3","3\t4"};
  String[] input2={"1\thello","4\tbye"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  Tuple expectedResult=(Tuple)Util.getPigConstant("(1,2,1,'hello',1,2,1,'hello')");
  String script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (k:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,k,l,a::i as ai,a::j as aj,b::k as bk,b::l as bl;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
  script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (i:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,l,a::i as ai,a::j as aj,b::i as bi,b::l as bl;";
  boolean exceptionThrown=false;
  try {
    Util.registerMultiLineQuery(pigServer,script);
    pigServer.openIterator("d");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    assertEquals(1025,pe.getErrorCode());
    exceptionThrown=true;
  }
  assertTrue(exceptionThrown);
  script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (i:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate a::i as ai1,j,b::i as bi1,l,a::i as ai2,a::j as aj2,b::i as bi3,b::l as bl3;";
  Util.registerMultiLineQuery(pigServer,script);
  it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRightOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 right outer, b by $0;";
    }
 else {
      script+="c = join a by $0 right, b by $0;";
    }
    script+="d = order c by $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 right outer, b by $0;";
      }
 else {
        script+="c = join a by $0 right, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeftOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 left outer, b by $0;";
    }
 else {
      script+="c = join a by $0 left, b by $0;";
    }
    script+="d = order c by $1;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 left outer, b by $0;";
      }
 else {
        script+="c = join a by $0 left, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinLocal </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLiteralsForJoinAlgoSpecification4() throws Exception {
  String query="a = load 'A'; " + "b = load 'B'; " + "c = Join a by $0, b by $0 using 'replicated'; "+ "store c into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator store=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
  assertEquals(JOINTYPE.REPLICATED,join.getJoinType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLiteralsForJoinAlgoSpecification5() throws Exception {
  String query="a = load 'A'; " + "b = load 'B'; " + "c = Join a by $0, b by $0 using 'default'; "+ "store c into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator store=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
  assertEquals(JOINTYPE.HASH,join.getJoinType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLiteralsForJoinAlgoSpecification2() throws Exception {
  String query="a = load 'A'; " + "b = load 'B'; " + "c = Join a by $0, b by $0 using 'hash'; "+ "store c into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator store=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
  assertEquals(JOINTYPE.HASH,join.getJoinType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLiteralsForJoinAlgoSpecification3() throws Exception {
  String query="a = load 'A'; " + "b = load 'B'; " + "c = Join a by $0, b by $0 using 'repl'; "+ "store c into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator store=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
  assertEquals(JOINTYPE.REPLICATED,join.getJoinType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinSchema2() throws Exception {
  String[] input1={"1\t2","2\t3","3\t4"};
  String[] input2={"1\thello","4\tbye"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  Tuple expectedResultCharArray=(Tuple)Util.getPigConstant("('1','2','1','hello','1','2','1','hello')");
  Tuple expectedResult=TupleFactory.getInstance().newTuple();
  for (  Object field : expectedResultCharArray.getAll()) {
    expectedResult.append(new DataByteArray(field.toString()));
  }
  String script="a = load '" + Util.encodeEscape(firstInput) + "' ; "+ "a = foreach a generate $0 as i, $1 as j ;"+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (k, l); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,k,l,a::i as ai,a::j as aj,b::k as bk,b::l as bl;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  Tuple res=it.next();
  assertEquals(expectedResult,res);
  assertFalse(it.hasNext());
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLiteralsForJoinAlgoSpecification1() throws Exception {
  String query="a = load 'A'; " + "b = load 'B'; " + "c = Join a by $0, b by $0 using 'merge';"+ "store c into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator store=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
  assertEquals(JOINTYPE.MERGE,join.getJoinType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJsonLoaderStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonLoaderNull() throws IOException {
  Iterator<Tuple> tuples=loadJson(nullJson);
  int count=0;
  while (tuples.hasNext()) {
    Tuple tuple=tuples.next();
    assertEquals(null,tuple.get(0));
    assertEquals(null,tuple.get(1));
    assertEquals(null,tuple.get(2));
    assertEquals(null,tuple.get(3));
    assertEquals(null,tuple.get(4));
    assertEquals(null,tuple.get(5));
    assertEquals(null,tuple.get(6));
    assertEquals(null,tuple.get(7));
    assertEquals(null,tuple.get(8));
    assertEquals(null,tuple.get(9));
    assertEquals(null,tuple.get(10));
    assertEquals(null,tuple.get(11));
    assertEquals(null,tuple.get(12));
    count++;
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleMapSideStreaming() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"1,2,3;4,5,6,7,8","1,2,3;4,5,6,7,9","1,2,3;4,5,6,7,18"});
  File tempJsonFile=File.createTempFile("json","");
  tempJsonFile.delete();
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage (';') as (ID:chararray,DETAILS:chararray);");
  pigServer.registerQuery("id_details = FOREACH IP GENERATE " + "FLATTEN" + "(STRSPLIT"+ "(ID,',',3)) AS (drop, code, transaction) ,"+ "FLATTEN"+ "(STRSPLIT"+ "(DETAILS,',',5)) AS (lname, fname, date, price, product);");
  pigServer.registerQuery("transactions = FOREACH id_details GENERATE $0 .. ;");
  pigServer.registerQuery("transactionsG = group transactions by code;");
  pigServer.registerQuery("uniqcnt  = foreach transactionsG {" + "sym = transactions.product ;" + "dsym =  distinct sym ;"+ "generate flatten(dsym.product) as f1, COUNT(dsym) as count ;"+ "};");
  pigServer.store("uniqcnt",tempJsonFile.getAbsolutePath(),"JsonStorage");
  Path p=new Path(tempJsonFile.getAbsolutePath());
  FileSystem fs=FileSystem.get(p.toUri(),new Configuration());
  Reader r=new InputStreamReader(fs.open(Util.getFirstPartFile(p)));
  BufferedReader br=new BufferedReader(r);
  String data=br.readLine();
  assertEquals(jsonOutput,data);
  String line=data;
  int count=0;
  while (line != null) {
    line=br.readLine();
    count++;
  }
  assertEquals(3,count);
  br.close();
  tempJsonFile.deleteOnExit();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoaderBigDecimalFormats() throws IOException {
  String bigDecimalJsonFile=createInput(bigDecimalJson);
  pigServer.registerQuery("data = load '" + bigDecimalJsonFile + "' using JsonLoader('a:bigdecimal, b:bigdecimal');");
  Iterator<Tuple> tuples=pigServer.openIterator("data");
  Tuple t=tuples.next();
  assertTrue(t.size() == 2);
  assertTrue(t.get(0) != null);
  assertTrue(t.get(1) != null);
  assertEquals(t.get(0),t.get(1));
  assertTrue(!tuples.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonStorageNull() throws Exception {
  BufferedReader br=storeJson(nullInput);
  String data=br.readLine();
  assertEquals(nullJson,data);
  String line=data;
  int count=0;
  while (line != null) {
    line=br.readLine();
    count++;
  }
  assertEquals(1,count);
  br.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoader() throws IOException {
  Iterator<Tuple> tuples=loadJson(json);
  int count=0;
  while (tuples.hasNext()) {
    Tuple tuple=tuples.next();
    assertEquals(Boolean.class,tuple.get(0).getClass());
    assertEquals(Integer.class,tuple.get(1).getClass());
    assertEquals(Long.class,tuple.get(2).getClass());
    assertEquals(Float.class,tuple.get(3).getClass());
    assertEquals(Double.class,tuple.get(4).getClass());
    assertEquals(DateTime.class,tuple.get(5).getClass());
    assertEquals("2013-01-02T03:04:05.123+03:00",tuple.get(5).toString());
    assertEquals(DataByteArray.class,tuple.get(6).getClass());
    assertEquals(String.class,tuple.get(7).getClass());
    assertEquals(BigInteger.class,tuple.get(8).getClass());
    assertEquals(BigDecimal.class,tuple.get(9).getClass());
    assertTrue(tuple.get(10) instanceof Map);
    assertEquals(String.class,((Map)tuple.get(10)).get("a").getClass());
    assertTrue(tuple.get(11) instanceof Tuple);
    assertEquals(Integer.class,((Tuple)tuple.get(11)).get(0).getClass());
    assertTrue(tuple.get(12) instanceof DataBag);
    DataBag bag=(DataBag)tuple.get(12);
    assertEquals(3,bag.size());
    Iterator<Tuple> bagTuples=bag.iterator();
    while (bagTuples.hasNext()) {
      assertEquals(Integer.class,bagTuples.next().get(0).getClass());
    }
    count++;
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoaderArrays() throws IOException {
  String arraysJsonFile=createInput(arraysJson);
  pigServer.registerQuery("data = load '" + arraysJsonFile + "' using JsonLoader('s:bag{a:tuple(a:chararray)}, i:bag{a:tuple(a:int)}, f:bag{a:tuple(a:double)}');");
  Iterator<Tuple> tuples=pigServer.openIterator("data");
  Tuple t=tuples.next();
  assertTrue(t.size() == 3);
  assertTrue(t.get(0) != null);
  assertTrue(t.get(1) != null);
  assertTrue(t.get(2) != null);
  assertTrue(!tuples.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonStorage() throws Exception {
  BufferedReader br=storeJson(rawInput);
  String data=br.readLine();
  assertEquals(json,data);
  String line=data;
  int count=0;
  while (line != null) {
    line=br.readLine();
    count++;
  }
  assertEquals(1,count);
  br.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonLoaderStorage() throws Exception {
  String pattInputFile=createInput(rawInput);
  String pattJsonFile=getTempOutputPath();
  String pattJson2File=getTempOutputPath();
  pigServer.registerQuery("data = load '" + pattInputFile + "' as ("+ schema+ ");");
  pigServer.registerQuery("store data into '" + pattJsonFile + "' using JsonStorage();");
  pigServer.registerQuery("json = load '" + pattJsonFile + "' using JsonLoader('"+ schema+ "');");
  pigServer.registerQuery("store json into '" + pattJson2File + "' using JsonStorage();");
  Path p=new Path(pattJson2File);
  FileSystem fs=FileSystem.get(p.toUri(),new Configuration());
  Reader r=new InputStreamReader(fs.open(Util.getFirstPartFile(p)));
  BufferedReader br=new BufferedReader(r);
  String data=br.readLine();
  assertEquals(json,data);
  String line=data;
  int count=0;
  while (line != null) {
    line=br.readLine();
    count++;
  }
  assertEquals(1,count);
  br.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoaderBadRow() throws IOException {
  String badJsonFile=createInput(badJson);
  pigServer.registerQuery("data = load '" + badJsonFile + "' using JsonLoader('a:chararray, b:chararray');");
  Iterator<Tuple> tuples=pigServer.openIterator("data");
  Tuple t=tuples.next();
  assertTrue(t.size() == 2);
  assertTrue(t.get(0) != null);
  assertTrue(t.get(1) != null);
  assertTrue(tuples.hasNext());
  t=tuples.next();
  assertTrue(t.size() == 2);
  assertTrue(t.get(0) == null);
  assertTrue(t.get(1) == null);
  assertTrue(tuples.hasNext());
  t=tuples.next();
  assertTrue(t.size() == 2);
  assertTrue(t.get(0) != null);
  assertTrue(t.get(1) != null);
  assertTrue(!tuples.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonStorageLimit() throws Exception {
  String outPath=getTempOutputPath();
  Data data=Storage.resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4));
  pigServer.registerQuery("data = load 'foo' using mock.Storage() as (id:int);");
  pigServer.registerQuery("data = order data by id;");
  pigServer.registerQuery("data = limit data 2;");
  pigServer.registerQuery("store data into '" + outPath + "' using JsonStorage();");
  Path p=new Path(outPath);
  FileSystem fs=FileSystem.get(p.toUri(),new Configuration());
  Reader r=new InputStreamReader(fs.open(Util.getFirstPartFile(p)));
  BufferedReader br=new BufferedReader(r);
  String line=null;
  int count=0;
  while ((line=br.readLine()) != null) {
    count++;
    assertEquals("{\"id\":" + count + "}",line);
  }
  assertEquals(2,count);
  br.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestKeyTypeDiscoveryVisitor </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullJoin() throws Exception {
  String[] inputData=new String[]{"\t7\t8","\t8\t9","1\t20\t30","1\t20\t40"};
  Util.createInputFile(cluster,"a.txt",inputData);
  inputData=new String[]{"7\t2","1\t5","1\t10"};
  Util.createInputFile(cluster,"b.txt",inputData);
  String script="a = load 'a.txt' as (x:int, y:int, z:int);" + "b = load 'b.txt' as (x:int, y:int);" + "b_group = group b by x;"+ "b_sum = foreach b_group generate flatten(group) as x, SUM(b.y) as clicks;"+ "a_group = group a by (x, y);"+ "a_aggs = foreach a_group generate flatten(group) as (x, y), SUM(a.z) as zs;"+ "join_a_b = join b_sum by x, a_aggs by x;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("join_a_b");
  Object[] results=new Object[]{1,15L,1,20,70L};
  Tuple output=it.next();
  assertFalse(it.hasNext());
  assertEquals(results.length,output.size());
  for (int i=0; i < output.size(); i++) {
    assertEquals(results[i],output.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLargeFile </h4><pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOrder() throws Exception {
  System.out.println("Running testOrder...");
  int N=0, Nplus1=0;
  pig.registerQuery("A = load " + fileName + ";");
  pig.registerQuery("B = order A by $0;");
  Iterator<Tuple> B=pig.openIterator("B");
  if (B.hasNext()) {
    N=DataType.toInteger(B.next().get(0));
  }
  while (B.hasNext()) {
    Nplus1=DataType.toInteger(B.next().get(0));
    assertTrue("Expecting Nplus [" + Nplus1 + "] to be greater than or equal to N ["+ N+ "]",Nplus1 >= N);
    N=Nplus1;
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLargeFile() throws Exception {
  System.out.println("Running testLargeFile...");
  pig.registerQuery("A = load " + fileName + ";");
  pig.registerQuery("A = group A by $0;");
  pig.store("A",tmpFile1,"BinStorage()");
  pig.registerQuery("B = foreach A generate group, COUNT($1);");
  Iterator<Tuple> B=pig.openIterator("B");
  while (B.hasNext()) {
    Tuple temp=B.next();
    int index=DataType.toInteger(temp.get(0));
    int value=DataType.toInteger(temp.get(1));
    System.out.println("COUNT [" + index + "] = "+ COUNT[index]+ " B["+ index+ "] = "+ value);
    assertEquals(COUNT[index].intValue(),value);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLineageFindRelVisitor </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testhaveIdenticalCasters() throws Exception {
  LogicalPlan lp=new LogicalPlan();
  Class<LineageFindRelVisitor> lineageFindRelVisitorClass=LineageFindRelVisitor.class;
  Method testMethod=lineageFindRelVisitorClass.getDeclaredMethod("haveIdenticalCasters",FuncSpec.class,FuncSpec.class);
  testMethod.setAccessible(true);
  LineageFindRelVisitor lineageFindRelVisitor=new LineageFindRelVisitor(lp);
  FuncSpec defaultSpec=new FuncSpec("PigStorage",new String[0]);
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,null,null));
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,null,defaultSpec));
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,null));
  Assert.assertTrue("Same loaders are considered equal",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,defaultSpec));
  FuncSpec withDefaultCasterSpec=new FuncSpec("org.apache.pig.test.PigStorageWithStatistics",new String[0]);
  Assert.assertTrue("Different Loaders but same LoadCaster with only default constructor. They should be considered same.",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,withDefaultCasterSpec));
  FuncSpec casterWithExtraConstuctorSpec=new FuncSpec("org.apache.pig.test.TestLineageFindRelVisitor$SillyLoaderWithLoadCasterWithExtraConstructor",new String[0]);
  FuncSpec casterWithExtraConstuctorSpec2=new FuncSpec("org.apache.pig.test.TestLineageFindRelVisitor$SillyLoaderWithLoadCasterWithExtraConstructor2",new String[0]);
  Assert.assertFalse("Different Loader, different LoadCaster are definitely not equal",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,casterWithExtraConstuctorSpec));
  Assert.assertFalse("Even when LoadCaster class matches, we consider them different when they have non-default constructor",(Boolean)testMethod.invoke(lineageFindRelVisitor,casterWithExtraConstuctorSpec,casterWithExtraConstuctorSpec2));
  Assert.assertTrue("Same Loaders should be always equal irrespective of loadcaster constructors",(Boolean)testMethod.invoke(lineageFindRelVisitor,casterWithExtraConstuctorSpec,casterWithExtraConstuctorSpec));
  Assert.assertEquals("Loader should be instantiated at most once.",SillyLoaderWithLoadCasterWithExtraConstructor.counter,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoad </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonDfsLocation() throws Exception {
  String nonDfsUrl="har:///user/foo/f.har";
  String query="a = load '" + nonDfsUrl + "' using PigStorage('\t','-noschema');"+ "store a into 'output';";
  LogicalPlan lp=Util.buildLp(servers[1],query);
  LOLoad load=(LOLoad)lp.getSources().get(0);
  nonDfsUrl=nonDfsUrl.replaceFirst("/$","");
  assertEquals(nonDfsUrl,load.getFileSpec().getFileName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctionsWithNulls() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    if (i % 10 == 0) {
      ps.println("");
    }
 else {
      ps.println(i);
    }
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=(Tuple)it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreFunction() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 10; i++) {
    ps.println(i + "\t" + i);
  }
  ps.close();
  String query="foreach (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') generate $0,$1;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  pig.store("asdf_id","frog",MyStorage.class.getName() + "()");
  InputStream is=FileLocalizer.open("frog",pig.getPigContext());
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  String line;
  int i=0;
  while ((line=br.readLine()) != null) {
    assertEquals(line,Integer.toString(i) + '-' + Integer.toString(i));
    i++;
  }
  br.close();
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefinedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerFunction("foo",new FuncSpec(MyApply.class.getName() + "('foo')"));
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten(foo($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator it=pig.openIterator("asdf_id");
  tmpFile.delete();
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=(Tuple)it.next();
    assertEquals("foo",t.get(0).toString());
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(count,MyStorage.COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal2 </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin1() throws Exception {
  File fp1=File.createTempFile("test1","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t1");
  ps.println("2\t2");
  ps.close();
  File fp2=File.createTempFile("test2","txt");
  ps=new PrintStream(new FileOutputStream(fp2));
  ps.println("1\t1");
  ps.println("2\t2");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "'AS (a0:int, a1:int); ");
  pig.registerQuery("B = load '" + Util.generateURI(fp2.toString(),pig.getPigContext()) + "'AS (b0:int, b1:int); ");
  pig.registerQuery("C = join A by a0, B by b0;");
  Iterator<Tuple> iter=pig.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(Integer.valueOf(1),t.get(0));
  assertEquals(Integer.valueOf(1),t.get(1));
  assertEquals(Integer.valueOf(1),t.get(2));
  assertEquals(Integer.valueOf(1),t.get(3));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(Integer.valueOf(2),t.get(0));
  assertEquals(Integer.valueOf(2),t.get(1));
  assertEquals(Integer.valueOf(2),t.get(2));
  assertEquals(Integer.valueOf(2),t.get(3));
  assertFalse(iter.hasNext());
  fp1.delete();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperatorLocal() throws Exception {
  File fp1=File.createTempFile("opTest","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t2");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "' AS (c1:int, c2:int); ");
  pig.registerQuery("B = filter A by c1 > 0;");
  pig.registerQuery("C = filter B by c1 < 2;");
  pig.registerQuery("D = filter C by c1 >= 0;");
  pig.registerQuery("E = filter D by c1 <= 2;");
  Iterator<Tuple> iter=pig.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(Integer.valueOf(1),t.get(0));
  assertEquals(Integer.valueOf(2),t.get(1));
  assertFalse(iter.hasNext());
  fp1.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogToPhyCompiler </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests that sortInfo is null when there is no order by
 * before the store
 * @throws Exception
 */
@Test public void testSortInfoNoOrderBy1() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = filter a by i > 10;" + "store b into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  assertEquals(null,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests that sortInfo is null when there is no schema for order by
 * before the store
 * @throws Exception
 */
@Test public void testSortInfoNoOrderBySchema() throws Exception {
  String query="a = load 'bla' ;" + "b = order a by $0;" + "store b into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  SortInfo expected=getSortInfo(Arrays.asList(new String[]{null}),Arrays.asList(new Integer[]{0}),Arrays.asList(new SortColInfo.Order[]{SortColInfo.Order.ASCENDING}));
  assertEquals(expected,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests that sortInfo is null when there is an operator other than limit
 * between order by and the store
 * @throws Exception
 */
@Test public void testSortInfoNoOrderBy2() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = order a by i, d;" + "c = distinct b;"+ "store c into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  assertEquals(null,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests sortinfo for the case where order by is ascending on
 * all sort columns
 */
@Test public void testSortInfoAsc() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = order a by i, d;" + "store b into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  SortInfo expected=getSortInfo(Arrays.asList(new String[]{"i","d"}),Arrays.asList(new Integer[]{0,2}),Arrays.asList(new SortColInfo.Order[]{SortColInfo.Order.ASCENDING,SortColInfo.Order.ASCENDING}));
  assertEquals(expected,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests that sortInfo is not null when there is a limit
 * between order by and the store
 * @throws Exception
 */
@Test public void testSortInfoOrderByLimit() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = order a by i, d desc;" + "c = limit b 10;"+ "store c into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  SortInfo expected=getSortInfo(Arrays.asList(new String[]{"i","d"}),Arrays.asList(new Integer[]{0,2}),Arrays.asList(new SortColInfo.Order[]{SortColInfo.Order.ASCENDING,SortColInfo.Order.DESCENDING}));
  assertEquals(expected,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests sortInfo for mixed ascending and descending in order by
 * @throws Exception
 */
@Test public void testSortInfoAscDesc() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = filter a by i > 10;" + "c = order b by i desc, d;"+ "store c into 'foo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  SortInfo expected=getSortInfo(Arrays.asList(new String[]{"i","d"}),Arrays.asList(new Integer[]{0,2}),Arrays.asList(new SortColInfo.Order[]{SortColInfo.Order.DESCENDING,SortColInfo.Order.ASCENDING}));
  assertEquals(expected,si);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * tests that sortInfo is not null when there are multiple store
 * @throws Exception
 */
@Test public void testSortInfoMultipleStore() throws Exception {
  String query="a = load 'bla' as (i:int, n:chararray, d:double);" + "b = order a by i, d desc;" + "store b into '1';"+ "store b into '2';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  SortInfo si0=((POStore)(pp.getLeaves().get(0))).getSortInfo();
  SortInfo si1=((POStore)(pp.getLeaves().get(1))).getSortInfo();
  SortInfo expected=getSortInfo(Arrays.asList(new String[]{"i","d"}),Arrays.asList(new Integer[]{0,2}),Arrays.asList(new SortColInfo.Order[]{SortColInfo.Order.ASCENDING,SortColInfo.Order.DESCENDING}));
  assertEquals(expected,si0);
  assertEquals(expected,si1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogicalPlanBuilder </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyTupConstRecursive1() throws Exception {
  String query="a = foreach (load 'b') generate (());" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(:tuple())"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that parallel is parsed correctly Bug 831714 - fixed
 */
@Test public void testQuery18() throws Exception {
  String query="store (FOREACH (group (load 'a') ALL PARALLEL 16) generate group ) into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator root=lp.getSources().get(0);
  List<Operator> listOp=lp.getSuccessors(root);
  Operator lo=listOp.get(0);
  if (lo instanceof LOCogroup) {
    Assert.assertEquals(16,((LOCogroup)lo).getRequestedParallelism());
  }
 else {
    Assert.fail("Error: Unexpected Parse Tree output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyBagConst() throws Exception {
  String query="a = foreach (load 'b') generate {};" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LOGenerate gen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  LogicalExpressionPlan exprPlan=gen.getOutputPlans().get(0);
  Operator logOp=exprPlan.getSources().get(0);
  Assert.assertTrue(logOp instanceof ConstantExpression);
  ConstantExpression loConst=(ConstantExpression)logOp;
  Assert.assertTrue(loConst.getType() == DataType.BAG);
  Assert.assertTrue(loConst.getValue() instanceof DataBag);
  Assert.assertTrue(loConst.getValue().equals(BagFactory.getInstance().newDefaultBag()));
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":bag{}"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyTupConstRecursive2() throws Exception {
  String query="a = foreach (load 'b') generate ([]);" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(:map)"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoaderSignature() throws Exception {
  String query="a = load '1.txt' using org.apache.pig.test.PigStorageWithSchema() as (a0:int, a1:int);" + "store a into 'output';";
  LogicalPlan plan=buildPlan(query);
  Operator op=plan.getSinks().get(0);
  LOLoad load=(LOLoad)plan.getPredecessors(op).get(0);
  String udfContextSignature=((PigStorageWithSchema)(load).getLoadFunc()).getUDFContextSignature();
  Assert.assertTrue(udfContextSignature,udfContextSignature.matches("a_[0-9]*-[0-9]*"));
  query=" b = load '1.txt' using org.apache.pig.test.PigStorageWithSchema();" + "store b into 'output';";
  plan=buildPlan(query);
  op=plan.getSinks().get(0);
  load=(LOLoad)plan.getPredecessors(op).get(0);
  udfContextSignature=((PigStorageWithSchema)(load).getLoadFunc()).getUDFContextSignature();
  Assert.assertTrue(udfContextSignature,udfContextSignature.matches("b_[0-9]*-[0-9]*"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery117() throws Exception {
  String query="a = load 'one';" + "b = foreach a generate " + Identity.class.getName() + "(*);"+ "store b into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple()"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery86() throws Exception {
  LogicalPlan lp;
  String query="a = load 'myfile' as (name:Chararray, age:Int, gpa:Float);" + "b = group a by (name, age);" + "store b into 'output';";
  lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOCogroup cogroup=(LOCogroup)lp.getPredecessors(store).get(0);
  Schema.FieldSchema nameFs=new Schema.FieldSchema("name",DataType.CHARARRAY);
  Schema.FieldSchema ageFs=new Schema.FieldSchema("age",DataType.INTEGER);
  Schema.FieldSchema gpaFs=new Schema.FieldSchema("gpa",DataType.FLOAT);
  Schema groupSchema=new Schema(nameFs);
  groupSchema.add(ageFs);
  Schema.FieldSchema groupFs=new Schema.FieldSchema("group",groupSchema,DataType.TUPLE);
  Schema loadSchema=new Schema(nameFs);
  loadSchema.add(ageFs);
  loadSchema.add(gpaFs);
  Schema.FieldSchema bagFs=new Schema.FieldSchema("a",loadSchema,DataType.BAG);
  Schema cogroupExpectedSchema=new Schema(groupFs);
  cogroupExpectedSchema.add(bagFs);
  Assert.assertTrue(cogroup.getSchema().toString(false).equals("group:tuple(name:chararray,age:int),a:bag{:tuple(name:chararray,age:int,gpa:float)}"));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuildLoadOpWithDefaultFunc() throws Exception {
  String query="a = load '1.txt';" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  FuncSpec funcSpec=getFirstLoadFuncSpec(lp);
  assertEquals("org.apache.pig.builtin.PigStorage",funcSpec.getClassName());
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_DEFAULT_LOAD_FUNC,"org.apache.pig.test.PigStorageWithSchema");
  query="a = load '1.txt';" + "store a into 'output';";
  lp=buildPlan(query);
  funcSpec=getFirstLoadFuncSpec(lp);
  assertEquals("org.apache.pig.test.PigStorageWithSchema",funcSpec.getClassName());
  pigServer.getPigContext().getProperties().remove(PigConfiguration.PIG_DEFAULT_LOAD_FUNC);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyTupConstRecursive3() throws Exception {
  String query="a = foreach (load 'b') generate ({});" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator op=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(op).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(:bag{})"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery107() throws Exception {
  String query="a = load 'one';" + "b = foreach a generate *;" + "store b into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LOGenerate gen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  LogicalExpressionPlan foreachPlan=gen.getOutputPlans().get(0);
  Assert.assertTrue(checkPlanForProjectStar(foreachPlan));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery106() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = foreach a generate *;" + "store b into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals("name:bytearray,age:bytearray,gpa:bytearray"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery109() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = load 'two' as (first_name, enrol_age, high_school_gpa);" + "c = group a by *, b by *;"+ "store c into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOCogroup cogroup=(LOCogroup)lp.getPredecessors(store).get(0);
  String s=cogroup.getSchema().toString(false);
  Assert.assertTrue(s.equals("group:tuple(name:bytearray,age:bytearray,gpa:bytearray),a:bag{:tuple(name:bytearray,age:bytearray,gpa:bytearray)},b:bag{:tuple(first_name:bytearray,enrol_age:bytearray,high_school_gpa:bytearray)}"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyBagConstRecursive() throws Exception {
  String query="a = foreach (load 'b') generate {()};" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator op=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(op).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":bag{:tuple()}"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery114() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = foreach a generate " + Identity.class.getName() + "(name, age);"+ "store b into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(name:bytearray,age:bytearray)"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTokenizeSchema2() throws Exception {
  String query="a = load 'one' as (f1: chararray, f2: chararray);" + "b = foreach a generate TOKENIZE(f1), TOKENIZE(f2);" + "store b into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  assertEquals(s,"bag_of_tokenTuples_from_f1:bag{tuple_of_tokens:tuple(token:chararray)}" + ",bag_of_tokenTuples_from_f2:bag{tuple_of_tokens:tuple(token:chararray)}");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery108() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = group a by *;" + "store b into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOCogroup cogroup=(LOCogroup)lp.getPredecessors(store).get(0);
  String s=cogroup.getSchema().toString(false);
  Assert.assertTrue(s.equals("group:tuple(name:bytearray,age:bytearray,gpa:bytearray),a:bag{:tuple(name:bytearray,age:bytearray,gpa:bytearray)}"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery87() throws Exception {
  String query="a = load 'myfile';" + "b = group a by $0;" + "c = foreach b {c1 = order $1 by $1; generate flatten(c1); };"+ "store c into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LogicalPlan nestedPlan=foreach.getInnerPlan();
  LOGenerate gen=(LOGenerate)nestedPlan.getSinks().get(0);
  LOSort nestedSort=(LOSort)nestedPlan.getPredecessors(gen).get(0);
  LogicalExpressionPlan sortPlan=nestedSort.getSortColPlans().get(0);
  Assert.assertTrue(sortPlan.getSinks().size() == 1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyTupleConst() throws Exception {
  String query="a = foreach (load 'b') generate ();" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LOGenerate gen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  LogicalExpressionPlan exprPlan=gen.getOutputPlans().get(0);
  Operator logOp=exprPlan.getSources().get(0);
  Assert.assertTrue(logOp instanceof ConstantExpression);
  ConstantExpression loConst=(ConstantExpression)logOp;
  Assert.assertTrue(loConst.getType() == DataType.TUPLE);
  Assert.assertTrue(loConst.getValue() instanceof Tuple);
  Assert.assertTrue(loConst.getValue().equals(TupleFactory.getInstance().newTuple()));
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple()"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTokenizeSchema() throws Exception {
  String query="a = load 'one' as (f1: chararray);" + "b = foreach a generate TOKENIZE(f1);" + "store b into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals("bag_of_tokenTuples_from_f1:bag{tuple_of_tokens:tuple(token:chararray)}"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery95() throws Exception {
  String query="a = load 'myfile' as (name, age, gpa);" + "b = group a by name;" + "c = foreach b {d = order a by $1; generate flatten(d), MAX(a.age) as max_age;};"+ "store c into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LOCogroup cogroup=(LOCogroup)lp.getPredecessors(foreach).get(0);
  String s=cogroup.getSchema().toString(false);
  Assert.assertTrue(s.equals("group:bytearray,a:bag{:tuple(name:bytearray,age:bytearray,gpa:bytearray)}"));
  s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals("d::name:bytearray,d::age:bytearray,d::gpa:bytearray,max_age:double"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery116() throws Exception {
  String query="a = load 'one';" + "b = foreach a generate " + Identity.class.getName() + "($0, $1);"+ "store b into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(:bytearray,:bytearray)"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyMapConst() throws Exception {
  String query="a = foreach (load 'b') generate [];" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LOGenerate gen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  LogicalExpressionPlan exprPlan=gen.getOutputPlans().get(0);
  Operator logOp=exprPlan.getSources().get(0);
  Assert.assertTrue(logOp instanceof ConstantExpression);
  ConstantExpression loConst=(ConstantExpression)logOp;
  Assert.assertTrue(loConst.getType() == DataType.MAP);
  Assert.assertTrue(loConst.getValue() instanceof Map);
  Assert.assertTrue(loConst.getValue().equals(new HashMap<String,Object>()));
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":map"));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuildStoreOpWithDefaultFunc() throws Exception {
  String query="a = load '1.txt';" + "store a into 'output';";
  LogicalPlan lp=buildPlan(query);
  FuncSpec funcSpec=getFirstStoreFuncSpec(lp);
  assertEquals("org.apache.pig.builtin.PigStorage",funcSpec.getClassName());
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_DEFAULT_STORE_FUNC,"org.apache.pig.test.PigStorageWithSchema");
  query="a = load '1.txt';" + "store a into 'output';";
  lp=buildPlan(query);
  funcSpec=getFirstStoreFuncSpec(lp);
  assertEquals("org.apache.pig.test.PigStorageWithSchema",funcSpec.getClassName());
  pigServer.getPigContext().getProperties().remove(PigConfiguration.PIG_DEFAULT_STORE_FUNC);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testQuery115() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = foreach a generate " + Identity.class.getName() + "(*);"+ "store b into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  String s=foreach.getSchema().toString(false);
  Assert.assertTrue(s.equals(":tuple(name:bytearray,age:bytearray,gpa:bytearray)"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRCompiler </h4><pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSchemaInStoreForDistinctLimit() throws Exception {
  String query="a = load 'input1' as (a : int,b :float ,c : int);" + "b  = distinct a;" + "c = limit b 10;"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper secondMrOper=mrPlan.getLeaves().get(0);
  POStore store=(POStore)secondMrOper.reducePlan.getLeaves().get(0);
  assertEquals("compare load and store schema",store.getSchema(),Utils.getSchemaFromString("a : int,b :float ,c : int"));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithIndexableLoadFunc() throws Exception {
  String query="a = load 'input1';" + "b = load 'input2' using " + TestMergeJoin.DummyIndexableLoader.class.getName() + ";"+ "c = join a by $0, b by $0 using 'merge';"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mp=Util.buildMRPlan(pp,pc);
  assertEquals("Checking number of MR Jobs for merge join with " + "IndexableLoadFunc:",1,mp.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCastFuncShipped() throws Exception {
  String query="a = load 'input1' using " + PigStorageNoDefCtor.class.getName() + "('\t') as (a0, a1, a2);"+ "b = group a by a0;"+ "c = foreach b generate flatten(a);"+ "d = order c by a0;"+ "e = foreach d generate a1+a2;"+ "store e into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mp=Util.buildMRPlan(pp,pc);
  MapReduceOper op=mp.getLeaves().get(0);
  assertTrue(op.UDFs.contains(new FuncSpec(PigStorageNoDefCtor.class.getName()) + "('\t')"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUDFInMergedJoin() throws Exception {
  String query="a = load 'input1';" + "b = load 'input2' using " + TestIndexableLoadFunc.class.getName() + "();"+ "c = join a by $0, b by $0 using 'merge';"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  assertTrue(mrOper.UDFs.contains(TestIndexableLoadFunc.class.getName()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testStorerLimit() throws Exception {
  String query="a = load 'input1';" + "b = limit a 10;" + "store b into 'output' using " + PigStorageNoDefCtor.class.getName() + "(',');";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  LimitAdjuster la=new LimitAdjuster(mrPlan,pc);
  la.visit();
  la.adjust();
  MapReduceOper firstMrOper=mrPlan.getRoots().get(0);
  POStore store=(POStore)firstMrOper.reducePlan.getLeaves().get(0);
  assertEquals(store.getStoreFunc().getClass().getName(),"org.apache.pig.impl.io.InterStorage");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testMergeJoin() throws Exception {
  String query="a = load '/tmp/input1';" + "b = load '/tmp/input2';" + "c = join a by $0, b by $0 using 'merge';"+ "store c into '/tmp/output1';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MRCompiler comp=new MRCompiler(pp,pc);
  comp.compile();
  MROperPlan mrp=comp.getMRPlan();
  assertTrue(mrp.size() == 2);
  MapReduceOper mrOp0=mrp.getRoots().get(0);
  assertTrue(mrOp0.mapPlan.size() == 2);
  PhysicalOperator load0=mrOp0.mapPlan.getRoots().get(0);
  MergeJoinIndexer func=(MergeJoinIndexer)PigContext.instantiateFuncFromSpec(((POLoad)load0).getLFile().getFuncSpec());
  Field lrField=MergeJoinIndexer.class.getDeclaredField("lr");
  lrField.setAccessible(true);
  POLocalRearrange lr=(POLocalRearrange)lrField.get(func);
  List<PhysicalPlan> innerPlans=lr.getPlans();
  PhysicalOperator localrearrange0=mrOp0.mapPlan.getSuccessors(load0).get(0);
  assertTrue(localrearrange0 instanceof POLocalRearrange);
  assertTrue(mrOp0.reducePlan.size() == 3);
  PhysicalOperator pack0=mrOp0.reducePlan.getRoots().get(0);
  assertTrue(pack0 instanceof POPackage);
  PhysicalOperator foreach0=mrOp0.reducePlan.getSuccessors(pack0).get(0);
  assertTrue(foreach0 instanceof POForEach);
  PhysicalOperator store0=mrOp0.reducePlan.getSuccessors(foreach0).get(0);
  assertTrue(store0 instanceof POStore);
  assertTrue(innerPlans.size() == 1);
  PhysicalPlan innerPlan=innerPlans.get(0);
  assertTrue(innerPlan.size() == 1);
  PhysicalOperator project=innerPlan.getRoots().get(0);
  assertTrue(project instanceof POProject);
  assertTrue(((POProject)project).getColumn() == 0);
  MapReduceOper mrOp1=mrp.getSuccessors(mrOp0).get(0);
  assertTrue(mrOp1.mapPlan.size() == 3);
  PhysicalOperator load1=mrOp1.mapPlan.getRoots().get(0);
  assertTrue(load1 instanceof POLoad);
  PhysicalOperator mergejoin1=mrOp1.mapPlan.getSuccessors(load1).get(0);
  assertTrue(mergejoin1 instanceof POMergeJoin);
  PhysicalOperator store1=mrOp1.mapPlan.getSuccessors(mergejoin1).get(0);
  assertTrue(store1 instanceof POStore);
  assertTrue(mrOp1.reducePlan.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFInJoin() throws Exception {
  String query="a = load 'input1' using BinStorage();" + "b = load 'input2';" + "c = join a by $0, b by $0;"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  assertEquals(2,mrOper.UDFs.size());
  assertEquals(2,mrOper.UDFs.size());
  assertTrue(mrOper.UDFs.contains("BinStorage"));
  assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUDFInMergedCoGroup() throws Exception {
  String query="a = load 'input1' using " + TestCollectableLoadFunc.class.getName() + "();"+ "b = load 'input2' using "+ TestIndexableLoadFunc.class.getName()+ "();"+ "c = cogroup a by $0, b by $0 using 'merge';"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  assertTrue(mrOper.UDFs.contains(TestCollectableLoadFunc.class.getName()));
  mrOper=mrPlan.getSuccessors(mrOper).get(0);
  assertTrue(mrOper.UDFs.contains(TestCollectableLoadFunc.class.getName()));
  assertTrue(mrOper.UDFs.contains(TestIndexableLoadFunc.class.getName()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testFetchOptimizerSideEffect() throws Exception {
  String query="in1 = LOAD 'data.txt' AS (ident:chararray);" + "in2 = LOAD 'data.txt' AS (ident:chararray);" + "in3 = LOAD 'data.txt';"+ "joined = JOIN in1 BY ident LEFT OUTER, in2 BY ident;"+ "store joined into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mp=Util.buildMRPlan(pp,pc);
  FetchOptimizer.isPlanFetchable(pc,pp);
  MapReduceOper op=mp.getLeaves().get(0);
  PhysicalOperator store=op.reducePlan.getLeaves().get(0);
  POForEach foreach=(POForEach)op.reducePlan.getPredecessors(store).get(0);
  PhysicalOperator project=foreach.getInputPlans().get(0).getRoots().get(0);
  Field parentPlan=PhysicalOperator.class.getDeclaredField("parentPlan");
  parentPlan.setAccessible(true);
  assertTrue(parentPlan.get(project) == null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAdjusterFuncShipped() throws Exception {
  String query="a = load 'input';" + "b = order a by $0 parallel 2;" + "c = limit b 7;"+ "store c into 'output' using " + PigStorageNoDefCtor.class.getName() + "('\t');";
  PhysicalPlan pp=Util.buildPp(pigServerMR,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  LimitAdjuster la=new LimitAdjuster(mrPlan,pc);
  la.visit();
  la.adjust();
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  int count=1;
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(4,count);
  MapReduceOper op=mrPlan.getLeaves().get(0);
  assertTrue(op.UDFs.contains(new FuncSpec(PigStorageNoDefCtor.class.getName()) + "('\t')"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRJobStats </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetOuputSizeUsingNonFileBasedStorage5() throws Exception {
  Configuration conf=new Configuration();
  long size=2L * 1024 * 1024* 1024;
  long outputSize=JobStats.getOutputSize(createPOStoreForFileBasedSystem(size,new PigStorageWithStatistics(),conf),conf);
  assertEquals("The returned output size is expected to be the same as the file size",size,outputSize);
  conf.set(PigStatsOutputSizeReader.OUTPUT_SIZE_READER_UNSUPPORTED,PigStorageWithStatistics.class.getName());
  outputSize=JobStats.getOutputSize(createPOStoreForFileBasedSystem(size,new PigStorageWithStatistics(),conf),conf);
  assertEquals("The default output size reader returns -1 for unsupported store funcs",-1,outputSize);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMedianMapReduceTime() throws Exception {
  JobClient jobClient=Mockito.mock(JobClient.class);
  Mockito.when(jobClient.getMapTaskReports(jobID)).thenReturn(mapTaskReports);
  Mockito.when(jobClient.getReduceTaskReports(jobID)).thenReturn(reduceTaskReports);
  PigStats.JobGraph jobGraph=new PigStats.JobGraph();
  MRJobStats jobStats=createJobStats("JobStatsTest",jobGraph);
  getJobStatsMethod("setId",JobID.class).invoke(jobStats,jobID);
  jobStats.setSuccessful(true);
  getJobStatsMethod("addMapReduceStatistics",Iterator.class,Iterator.class).invoke(jobStats,Arrays.asList(mapTaskReports).iterator(),Arrays.asList(reduceTaskReports).iterator());
  String msg=(String)getJobStatsMethod("getDisplayString").invoke(jobStats);
  System.out.println(JobStats.SUCCESS_HEADER);
  System.out.println(msg);
  assertTrue(msg.startsWith(ASSERT_STRING));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetOuputSizeUsingNonFileBasedStorage1() throws Exception {
  Configuration conf=new Configuration();
  UDFContext.getUDFContext().setClientSystemProps(new Properties());
  long outputSize=JobStats.getOutputSize(createPOStoreForNonFileBasedSystem(new HBaseStorage("colName"),conf),conf);
  assertEquals("The default output size reader returns -1 for a non-file-based uri",-1,outputSize);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoTaskReportProperty() throws IOException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster(MiniGenericCluster.EXECTYPE_MR);
  Properties properties=cluster.getProperties();
  String inputFile="input";
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,inputFile));
  pw.println("100\tapple");
  pw.println("200\torange");
  pw.close();
  properties.setProperty(PigConfiguration.PIG_NO_TASK_REPORT,"false");
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + inputFile + "' as (id:int, fruit:chararray);");
  pigServer.registerQuery("store A into 'task_reports';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats pigStats=jobs.get(0).getStatistics();
  MRJobStats jobStats=(MRJobStats)pigStats.getJobGraph().getJobList().get(0);
  long minMapTime=jobStats.getMinMapTime();
  long maxMapTime=jobStats.getMaxMapTime();
  long avgMapTime=jobStats.getAvgMapTime();
  assertTrue("TaskReports are enabled, so minMapTime shouldn't be -1",minMapTime != -1l);
  assertTrue("TaskReports are enabled, so maxMapTime shouldn't be -1",maxMapTime != -1l);
  assertTrue("TaskReports are enabled, so avgMapTime shouldn't be -1",avgMapTime != -1l);
  properties.setProperty(PigConfiguration.PIG_NO_TASK_REPORT,"true");
  pigServer.registerQuery("B = load '" + inputFile + "' as (id:int, fruit:chararray);");
  pigServer.registerQuery("store B into 'no_task_reports';");
  jobs=pigServer.executeBatch();
  pigStats=jobs.get(0).getStatistics();
  jobStats=(MRJobStats)pigStats.getJobGraph().getJobList().get(0);
  minMapTime=jobStats.getMinMapTime();
  maxMapTime=jobStats.getMaxMapTime();
  avgMapTime=jobStats.getAvgMapTime();
  assertEquals("TaskReports are disabled, so minMapTime should be -1",-1l,minMapTime);
  assertEquals("TaskReports are disabled, so maxMapTime should be -1",-1l,maxMapTime);
  assertEquals("TaskReports are disabled, so avgMapTime should be -1",-1l,avgMapTime);
  cluster.shutDown();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetOuputSizeUsingNonFileBasedStorage2() throws Exception {
  Configuration conf=new Configuration();
  conf.set(PigStatsOutputSizeReader.OUTPUT_SIZE_READER_KEY,DummyOutputSizeReader.class.getName());
  UDFContext.getUDFContext().setClientSystemProps(new Properties());
  long outputSize=JobStats.getOutputSize(createPOStoreForNonFileBasedSystem(new HBaseStorage("colName"),conf),conf);
  assertEquals("The dummy output size reader always returns " + DummyOutputSizeReader.SIZE,DummyOutputSizeReader.SIZE,outputSize);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOneTaskReport() throws Exception {
  TaskReport[] mapTaskReports=new TaskReport[1];
  mapTaskReports[0]=Mockito.mock(TaskReport.class);
  Mockito.when(mapTaskReports[0].getStartTime()).thenReturn(300L * ONE_THOUSAND);
  Mockito.when(mapTaskReports[0].getFinishTime()).thenReturn(400L * ONE_THOUSAND);
  TaskReport[] reduceTaskReports=new TaskReport[1];
  reduceTaskReports[0]=Mockito.mock(TaskReport.class);
  Mockito.when(reduceTaskReports[0].getStartTime()).thenReturn(500L * ONE_THOUSAND);
  Mockito.when(reduceTaskReports[0].getFinishTime()).thenReturn(700L * ONE_THOUSAND);
  PigStats.JobGraph jobGraph=new PigStats.JobGraph();
  MRJobStats jobStats=createJobStats("JobStatsTest",jobGraph);
  getJobStatsMethod("setId",JobID.class).invoke(jobStats,jobID);
  jobStats.setSuccessful(true);
  getJobStatsMethod("addMapReduceStatistics",Iterator.class,Iterator.class).invoke(jobStats,Arrays.asList(mapTaskReports).iterator(),Arrays.asList(reduceTaskReports).iterator());
  String msg=(String)getJobStatsMethod("getDisplayString").invoke(jobStats);
  System.out.println(JobStats.SUCCESS_HEADER);
  System.out.println(msg);
  StringBuilder sb=new StringBuilder();
  sb.append(jobID.toString()).append("\t");
  sb.append(mapTaskReports.length).append("\t");
  sb.append(reduceTaskReports.length).append("\t");
  sb.append("100\t100\t100\t100\t200\t200\t200\t200");
  System.out.println("assert msg: " + sb.toString());
  assertTrue(msg.startsWith(sb.toString()));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetOuputSizeUsingFileBasedStorage() throws Exception {
  Configuration conf=new Configuration();
  long size=2L * 1024 * 1024* 1024;
  long outputSize=JobStats.getOutputSize(createPOStoreForFileBasedSystem(size,new PigStorageWithStatistics(),conf),conf);
  assertEquals("The returned output size is expected to be the same as the file size",size,outputSize);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetOuputSizeUsingNonFileBasedStorage4() throws Exception {
  Configuration conf=new Configuration();
  conf.set(PigStatsOutputSizeReader.OUTPUT_SIZE_READER_KEY,FileBasedOutputSizeReader.class.getName() + "," + DummyOutputSizeReader.class.getName());
  UDFContext.getUDFContext().setClientSystemProps(new Properties());
  long outputSize=JobStats.getOutputSize(createPOStoreForNonFileBasedSystem(new HBaseStorage("colName"),conf),conf);
  assertEquals("The dummy output size reader always returns " + DummyOutputSizeReader.SIZE,DummyOutputSizeReader.SIZE,outputSize);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMacroExpansion </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void parameterSubstitutionTest() throws Exception {
  String macro="define group_and_count (A,C) returns B, D {\n" + "    $B = JOIN $A BY user, $C BY user using 'replicated' partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "    $D = JOIN $A BY $0, $C BY $1 using 'skewed' parallel 5;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma, sigma = group_and_count (alpha,beta);\n"+ "store gamma into '$output1';\n"+ "store sigma into '$output2';\n";
  File f1=new File("myscript.pig");
  f1.deleteOnExit();
  FileWriter fw1=new FileWriter(f1);
  fw1.append(macro).append(script);
  fw1.close();
  String[] args={"-x","local","-p","output1=byuser","-p","output2=byage","-c","myscript.pig"};
  PigStats stats=PigRunner.run(args,null);
  assertTrue(stats.isSuccessful());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapReduce </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctionsWithNulls() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    if (i % 10 == 0) {
      ps.println("");
    }
 else {
      ps.println(i);
    }
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This test checks records that align perfectly on
 * bzip block boundaries and hdfs block boundaries
 */
@Test public void testBZip2Aligned() throws Throwable {
  int offsets[]={219642,219643,219644,552019,552020};
  for (int i=1; i < offsets.length; i++) {
    Properties props=new Properties();
    for (    Entry<Object,Object> entry : cluster.getProperties().entrySet()) {
      props.put(entry.getKey(),entry.getValue());
    }
    props.setProperty(MRConfiguration.MAX_SPLIT_SIZE,Integer.toString(offsets[i]));
    PigContext pigContext=new PigContext(cluster.getExecType(),props);
    PigServer pig=new PigServer(pigContext);
    pig.registerQuery("a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/bzipTest.bz2",pig.getPigContext()) + "';");
    Iterator<Tuple> it=pig.openIterator("a");
    int count=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      String s=t.get(0).toString();
      s=s.substring(0,7);
      assertEquals("Using blocksize " + offsets[i] + " problem with "+ t,count,Integer.parseInt(s,16));
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreFunction() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 10; i++) {
    ps.println(i + "\t" + i);
  }
  ps.close();
  String query="foreach (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') generate $0,$1;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  pig.store("asdf_id","frog",MyStorage.class.getName() + "()");
  InputStream is=FileLocalizer.open("frog",pig.getPigContext());
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  String line;
  int i=0;
  while ((line=br.readLine()) != null) {
    assertEquals(line,Integer.toString(i) + '-' + Integer.toString(i));
    i++;
  }
  br.close();
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefinedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerFunction("foo",new FuncSpec(MyApply.class.getName() + "('foo')"));
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten(foo($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  tmpFile.delete();
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals("foo",t.get(0).toString());
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(count,MyStorage.COUNT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapSideCogroup </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "D = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = cogroup A by id, B by id, D by id using 'merge';"+ "store C into 'output';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    Operator op=lp.getSinks().get(0);
    LOCogroup cogrp=(LOCogroup)lp.getPredecessors(op).get(0);
    assertEquals(LOCogroup.GROUPTYPE.MERGE,cogrp.getGroupType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailure2() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "D = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = cogroup A by id inner, B by id, D by id inner using 'merge';"+ "store C into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator op=lp.getSinks().get(0);
  LOCogroup cogrp=(LOCogroup)lp.getPredecessors(op).get(0);
  assertEquals(LOCogroup.GROUPTYPE.MERGE,cogrp.getGroupType());
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  boolean exceptionCaught=false;
  try {
    Util.buildPp(pigServer,query);
  }
 catch (  FrontendException e) {
    exceptionCaught=true;
  }
  assertTrue(exceptionCaught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeForEachOptimization </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * One output of first foreach was referred more than once in the second foreach
 * @throws Exception 
 */
@Test public void testDuplicateInputs() throws Exception {
  String query="A = load 'file.txt' as (a0:int, a1:double);" + "A1 = foreach A generate (int)a0 as a0, (double)a1 as a1;" + "B = group A1 all;"+ "C = foreach B generate A1;"+ "D = foreach C generate SUM(A1.a0), AVG(A1.a1);"+ "store D into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  Operator store=newLogicalPlan.getSinks().get(0);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  LOForEach foreach1=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach1.getAlias().equals("D"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  LOForEach foreach2=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach2.getAlias().equals("D"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test more complex case where the first for each in the script has inner plan.
 * @throws Exception 
 */
@Test public void testComplex() throws Exception {
  String query="A = load 'file.txt' as (a:int, b, c:bag{t:tuple(c0:int,c1:int)});" + "B = foreach A { S = ORDER c BY $0; generate $0, COUNT(S), SIZE(S); };" + "C = foreach B generate $2+5 as x, $0-$1/2 as y;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  int outputExprCount1=getOutputExprCount(newLogicalPlan);
  LOForEach foreach1=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach1.getAlias().equals("C"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(0,forEachCount1 - forEachCount2);
  int outputExprCount2=getOutputExprCount(newLogicalPlan);
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  LOForEach foreach2=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach2.getAlias().equals("C"));
  LogicalSchema newSchema=foreach2.getSchema();
  Assert.assertTrue(newSchema.getField(0).alias.equals("x"));
  Assert.assertTrue(newSchema.getField(1).alias.equals("y"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic test case. Two simple FOREACH statements can be merged to one.
 * @throws Exception 
 */
@Test public void testSimple() throws Exception {
  String query="A = load 'file.txt' as (a, b, c);" + "B = foreach A generate a+b, c-b;" + "C = foreach B generate $0+5, $1;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  int outputExprCount1=getOutputExprCount(newLogicalPlan);
  LOForEach foreach1=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach1.getAlias().equals("C"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  int outputExprCount2=getOutputExprCount(newLogicalPlan);
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  LOForEach foreach2=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach2.getAlias().equals("C"));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * MergeForEach Optimization is off if the first statement has a FLATTEN operator.
 * @throws Exception 
 */
@Test public void testNegative2() throws Exception {
  String query="A = LOAD 'file.txt' as (a, b, c);" + "B = FOREACH A GENERATE FLATTEN(a), b, c;" + "C = FOREACH B GENERATE $0, $1+$2;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(2,forEachCount1);
  Assert.assertEquals(2,forEachCount2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that join input order does not get reversed (PIG-1672)
 * @throws Exception 
 */
@Test public void testJoinInputOrder() throws Exception {
  String query="l1 = load 'y' as (a);" + "l2 = load 'z' as (a1,b1,c1,d1);" + "f1 = foreach l2 generate a1, b1, c1, d1;"+ "f2 = foreach f1 generate a1, b1, c1;"+ "j1 = join f2 by a1, l1 by a using 'replicated';"+ "store j1 into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  List<Operator> loads=newLogicalPlan.getSources();
  Operator l2=null;
  for (  Operator load : loads) {
    if (((LogicalRelationalOperator)load).getAlias().equals("l2"))     l2=load;
  }
  LOForEach foreachL2=(LOForEach)newLogicalPlan.getSuccessors(l2).get(0);
  foreachL2=(LOForEach)newLogicalPlan.getSuccessors(foreachL2).get(0);
  int outputExprCount1=((LOGenerate)foreachL2.getInnerPlan().getSinks().get(0)).getOutputPlans().size();
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  loads=newLogicalPlan.getSources();
  l2=null;
  for (  Operator load : loads) {
    if (((LogicalRelationalOperator)load).getAlias().equals("l2"))     l2=load;
  }
  foreachL2=(LOForEach)newLogicalPlan.getSuccessors(l2).get(0);
  int outputExprCount2=((LOGenerate)foreachL2.getInnerPlan().getSinks().get(0)).getOutputPlans().size();
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  Assert.assertTrue(foreachL2.getAlias().equals("f2"));
  LOJoin join=(LOJoin)getOperator(newLogicalPlan,LOJoin.class);
  LogicalRelationalOperator leftInp=(LogicalRelationalOperator)newLogicalPlan.getPredecessors(join).get(0);
  assertEquals("join child left",leftInp.getAlias(),"f2");
  LogicalRelationalOperator rightInp=(LogicalRelationalOperator)newLogicalPlan.getPredecessors(join).get(1);
  assertEquals("join child right",rightInp.getAlias(),"l1");
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Not all consecutive FOREACHes can be merged. In this case, the second FOREACH statment
 * has inner plan, which cannot be merged with one before it.
 * @throws Exception 
 */
@Test public void testNegative1() throws Exception {
  String query="A = LOAD 'file.txt' as (a, b, c, d:bag{t:tuple(c0:int,c1:int)});" + "B = FOREACH A GENERATE a+5 AS u, b-c/2 AS v, d AS w;" + "C = FOREACH B { S = ORDER w BY $0; GENERATE $0 as x, COUNT(S) as y; };"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(forEachCount1,forEachCount2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoin </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParallelism() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "';"+ "B = LOAD '"+ INPUT_FILE+ "';"+ "C = join A by $0, B by $0 using 'merge' parallel 50;"+ "store C into 'out';";
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  MROperPlan mro=Util.buildMRPlan(Util.buildPp(pigServer,query),pc);
  Assert.assertEquals(1,mro.getRoots().get(0).getRequestedParallelism());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpressionFail() throws IOException {
  pigServer.registerQuery("A = LOAD 'leftinput' as (a:int);");
  pigServer.registerQuery("B = LOAD 'temp_file*' using " + DummyIndexableLoader.class.getName() + "() as (a:int);");
  boolean exceptionThrown=false;
  try {
    pigServer.registerQuery("C = join A by $0 + 10, B by $0 + 10 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
  }
 catch (  Exception e) {
    e.printStackTrace();
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1106,pe.getErrorCode());
    exceptionThrown=true;
  }
  Assert.assertEquals(true,exceptionThrown);
}

</code></pre>

<br>
<pre class="type-7 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoinFailure2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
  pigServer.registerQuery("C = GROUP B by id;");
  pigServer.registerQuery("D = join A by id, C by $0 using 'merge';");
  try {
    pigServer.openIterator("D");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1103,pe.getErrorCode());
    return;
  }
  Assert.fail("Should fail to compile");
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin3Way() throws IOException {
  try {
    pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
    pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("D = join A by id, B by id, C by id using 'merge';");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getMessage().contains("Merge join can only be applied for 2-way joins"));
    return;
  }
  Assert.fail("Should throw exception, do not support 3 way join");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoinOuter </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = join A by id left, B by id using 'merge';"+ "store C into 'out';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    LOStore store=(LOStore)lp.getSinks().get(0);
    LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
    assertEquals(LOJoin.JOINTYPE.MERGE,join.getJoinType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POForEach);
    assertEquals(1,phyOp.getInputs().size());
    assertTrue(phyOp.getInputs().get(0) instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailure() throws Exception {
  String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "E = group A by id;"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = join E by A.id, B by id using 'merge';"+ "store C into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator op=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(op).get(0);
  assertEquals(LOJoin.JOINTYPE.MERGE,join.getJoinType());
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  boolean exceptionCaught=false;
  try {
    Util.buildPp(pigServer,query);
  }
 catch (  FrontendException e) {
    assertEquals(1103,e.getErrorCode());
    exceptionCaught=true;
  }
  assertTrue(exceptionCaught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMod </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Mod operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 % inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 % inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryBasic </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that MultiQuery optimization won't use user's output for
 * ScalarExpression (and get empty output) at the end
 */
@Test public void testMultiQueryWithScalarExpression() throws Exception {
  System.out.println("===== multi-query with ScalarExpression =====");
  String[] inputData={"john","henry","adam"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("b = group a ALL;");
  myPig.registerQuery("c = foreach b generate COUNT(a) as count;");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("z = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("y = foreach z generate uname, c.count;");
  myPig.registerQuery("store y into 'output2';");
  List<ExecJob> jobs=myPig.executeBatch();
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
  myPig.registerQuery("aa = load 'output2' as (uname:chararray, cnt:int) ;");
  Iterator<Tuple> it=myPig.openIterator("aa");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(3,t.get(1));
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryWithSplitInMapAndMultiMerge() throws Exception {
  String[] toClean={"tmwsimam-input.txt","foo1","foo2","foo3","foo4"};
  for (int j=0; j < toClean.length; j++) {
    Util.deleteFile(new PigContext(Util.getLocalTestMode(),new Properties()),toClean[j]);
  }
  String[] inputData={"1	a	b	e	f	i	j	m	n","2	a	b	e	f	i	j	m	n","3	c	d	g	h	k	l	o	p","4	c	d	g	h	k	l	o	p"};
  Util.createLocalInputFile("tmwsimam-input.txt",inputData);
  String query="A = LOAD 'tmwsimam-input.txt' " + "as (f0:chararray, f1:chararray, f2:chararray, f3:chararray, " + "f4:chararray, f5:chararray, f6:chararray, f7:chararray, f8:chararray); "+ "B = FOREACH A GENERATE f0, f1, f2, f3, f4;"+ "B1 = foreach B generate f0, f1, f2;"+ "C = GROUP B1 BY (f1, f2);"+ "STORE C into 'foo1' using BinStorage();"+ "B2 = FOREACH B GENERATE f0, f3, f4;"+ "E = GROUP B2 BY (f3, f4);"+ "STORE E into 'foo2'  using BinStorage();"+ "F = FOREACH A GENERATE f0, f5, f6, f7, f8;"+ "F1 = FOREACH F GENERATE f0, f5, f6;"+ "G = GROUP F1 BY (f5, f6);"+ "STORE G into 'foo3'  using BinStorage();"+ "F2  = FOREACH F GENERATE f0, f7, f8;"+ "I = GROUP F2 BY (f7, f8);"+ "STORE I into 'foo4'  using BinStorage();"+ "explain;";
  myPig.setBatchOn();
  Util.registerMultiLineQuery(myPig,query);
  myPig.executeBatch();
  String templateLoad="a = load 'foo' using BinStorage();";
  Map<Tuple,DataBag> expectedResults=new HashMap<Tuple,DataBag>();
  expectedResults.put((Tuple)Util.getPigConstant("('a','b')"),(DataBag)Util.getPigConstant("{('1','a','b'),('2','a','b')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('c','d')"),(DataBag)Util.getPigConstant("{('3','c','d'),('4','c','d')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('e','f')"),(DataBag)Util.getPigConstant("{('1','e','f'),('2','e','f')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('g','h')"),(DataBag)Util.getPigConstant("{('3','g','h'),('4','g','h')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('i','j')"),(DataBag)Util.getPigConstant("{('1','i','j'),('2','i','j')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('k','l')"),(DataBag)Util.getPigConstant("{('3','k','l'),('4','k','l')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('m','n')"),(DataBag)Util.getPigConstant("{('1','m','n'),('2','m','n')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('o','p')"),(DataBag)Util.getPigConstant("{('3','o','p'),('4','o','p')}"));
  String[] outputDirs={"foo1","foo2","foo3","foo4"};
  for (int k=0; k < outputDirs.length; k++) {
    myPig.registerQuery(templateLoad.replace("foo",outputDirs[k]));
    Iterator<Tuple> it=myPig.openIterator("a");
    int numTuples=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      assertEquals(expectedResults.get(t.get(0)),t.get(1));
      numTuples++;
    }
    assertEquals(numTuples,2);
  }
  for (int j=0; j < toClean.length; j++) {
    Util.deleteFile(new PigContext(Util.getLocalTestMode(),new Properties()),toClean[j]);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3WithDifferentMapDataTypes3() throws Exception {
  System.out.println("===== multi-query phase 3 with different map datatypes (3) =====");
  myPig.setBatchOn();
  String[] inputData={"john\t20\t3.4","john\t25\t3.4","henry\t23\t3.9","adam\t54\t2.9","henry\t21\t3.9"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.registerQuery("a = load 'queryInput.txt' " + "as (name:chararray, age:int, gpa:double);");
  myPig.registerQuery("b = group a all;");
  myPig.registerQuery("c = foreach b generate group, COUNT(a);");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("d = group a by (name, gpa);");
  myPig.registerQuery("e = foreach d generate flatten(group), MIN(a.age);");
  myPig.registerQuery("store e into 'output2';");
  myPig.executeBatch();
  myPig.registerQuery("a = load 'output1' as (grp:chararray, cnt:long) ;");
  Iterator<Tuple> it=myPig.openIterator("a");
  assertEquals(Util.getPigConstant("('all', 5l)"),it.next());
  assertFalse(it.hasNext());
  myPig.registerQuery("a = load 'output2' as (name:chararray, gpa:double, age:int);");
  it=myPig.openIterator("a");
  int i=0;
  Map<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("john",(Tuple)Util.getPigConstant("('john',3.4,20)"));
  expectedResults.put("adam",(Tuple)Util.getPigConstant("('adam',2.9,54)"));
  expectedResults.put("henry",(Tuple)Util.getPigConstant("('henry',3.9,21)"));
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(expectedResults.get(t.get(0)),t);
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryCompiler </h4><pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryWithCustomPartitioner(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("l = FILTER a BY uname == 'foo';");
    myPig.registerQuery("b = GROUP a BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c = FOREACH b GENERATE FLATTEN(a) PARALLEL 3;");
    myPig.registerQuery("STORE c INTO 'output1';");
    myPig.registerQuery("STORE l INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,12);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryDoNotMergeMRwithDifferentPartitioners(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b1 = FILTER a BY gid != 0;");
    myPig.registerQuery("b2 = FILTER a BY uid > 100;");
    myPig.registerQuery("c1 = GROUP b1 BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c2 = GROUP b2 BY uname PARALLEL 3;");
    myPig.registerQuery("STORE c1 INTO 'output1';");
    myPig.registerQuery("STORE c2 INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,10);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,15);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop;
    mrop=mrp.getRoots().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner() == null);
    mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemovalCollapseSplit(){
  System.out.println("===== multi-query unnecessary stores collapse split =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,1,6);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,11);
    MROperPlan mp=checkMRPlan(pp,1,1,2);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemoval(){
  System.out.println("===== multi-query unnecessary stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output3';");
    myPig.registerQuery("f = load '/tmp/output2';");
    myPig.registerQuery("g = group f by $0;");
    myPig.registerQuery("store g into '/tmp/output4';");
    LogicalPlan lp=checkLogicalPlan(1,2,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,20);
    MROperPlan mp=checkMRPlan(pp,1,2,3);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    MapReduceOper mo3=mp.getLeaves().get(1);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,2);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo3.mapPlan,1,1,2);
    checkPhysicalPlan(mo3.reducePlan,1,1,2);
    leaf=mo3.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFilterRemoval(){
  System.out.println("===== multi-query empty filters =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid>0;");
    myPig.registerQuery("c = filter a by uid>5;");
    myPig.registerQuery("d = filter c by uid<10;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("store b into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,10);
    MROperPlan mp=checkMRPlan(pp,1,1,1);
    MapReduceOper mo=mp.getRoots().get(0);
    checkPhysicalPlan(mo.mapPlan,1,1,4);
    PhysicalOperator leaf=mo.mapPlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,3);
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryLocal </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMultiQueryWithTwoStores() throws Exception {
  System.out.println("===== test multi-query with 2 stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    LogicalPlan lp=checkLogicalPlan(1,2,8);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,11);
    Assert.assertTrue(executePlan(pp));
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMultiQueryWithThreeStores() throws Exception {
  System.out.println("===== test multi-query with 3 stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("c = filter b by uid > 10;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.registerQuery("d = filter c by uid > 15;");
    myPig.registerQuery("store d into '" + TMP_DIR + "/Pig-TestMultiQueryLocal3';");
    LogicalPlan lp=checkLogicalPlan(1,3,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,14);
    Assert.assertTrue(executePlan(pp));
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMultiQueryWithTwoLoads() throws Exception {
  System.out.println("===== test multi-query with two loads =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = load 'test/org/apache/pig/test/data/passwd2' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("c = filter a by uid > 5;");
    myPig.registerQuery("d = filter b by uid > 10;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("store d into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.registerQuery("e = cogroup c by uid, d by uid;");
    myPig.registerQuery("store e into '" + TMP_DIR + "/Pig-TestMultiQueryLocal3';");
    LogicalPlan lp=checkLogicalPlan(2,3,14);
    PhysicalPlan pp=checkPhysicalPlan(lp,2,3,19);
    Assert.assertTrue(executePlan(pp));
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultiStoreWithConfig() throws Exception {
  System.out.println("===== test multi-query with competing config =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid < 5;");
  myPig.registerQuery("c = filter a by uid > 5;");
  myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1' using "+ PigStorageWithConfig.class.getName()+ "('test.key1', 'a');");
  myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2' using "+ PigStorageWithConfig.class.getName()+ "('test.key2', 'b');");
  myPig.executeBatch();
  myPig.discardBatch();
  FileSystem fs=FileSystem.getLocal(new Configuration());
  BufferedReader reader=new BufferedReader(new InputStreamReader(fs.open(Util.getFirstPartFile(new Path("file:///" + TMP_DIR + "/Pig-TestMultiQueryLocal1")))));
  String line;
  while ((line=reader.readLine()) != null) {
    Assert.assertTrue(line.endsWith("a"));
  }
  reader=new BufferedReader(new InputStreamReader(fs.open(Util.getFirstPartFile(new Path("file:///" + TMP_DIR + "/Pig-TestMultiQueryLocal2")))));
  while ((line=reader.readLine()) != null) {
    Assert.assertTrue(line.endsWith("b"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiply </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Multiply operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 * inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 * inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 * inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 * inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNativeMapReduce </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNativeMRJobSimple() throws Exception {
  try {
    Collection<String> results=new HashSet<String>();
    results.add("(two,2)");
    results.add("(three,3)");
    pigServer.setBatchOn();
    pigServer.registerQuery("A = load '" + INPUT_FILE + "';");
    pigServer.registerQuery("B = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobSimple_input' "+ "Load 'table_testNativeMRJobSimple_output' "+ "`org.apache.pig.test.utils.WordCount "+ " -Dmapred.child.java.opts='-Xmx1536m -Xms128m' "+ " -files "+ STOPWORD_FILE+ " table_testNativeMRJobSimple_input table_testNativeMRJobSimple_output "+ STOPWORD_FILE+ "`;");
    pigServer.registerQuery("Store B into 'table_testNativeMRJobSimpleDir';");
    List<ExecJob> execJobs=pigServer.executeBatch();
    assertEquals("num of jobs",execJobs.size(),1);
    boolean foundNativeFeature=false;
    for (    ExecJob job : execJobs) {
      assertEquals("job status",job.getStatus(),JOB_STATUS.COMPLETED);
      if (job.getStatistics().getFeatures().contains("NATIVE")) {
        foundNativeFeature=true;
      }
    }
    assertTrue("foundNativeFeature",foundNativeFeature);
    pigServer.registerQuery("C = load 'table_testNativeMRJobSimpleDir';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    Tuple t;
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
    iter=pigServer.openIterator("B");
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
  }
  finally {
    Util.deleteFile(cluster,"table_testNativeMRJobSimple_input");
    Util.deleteFile(cluster,"table_testNativeMRJobSimple_output");
    Util.deleteFile(cluster,"table_testNativeMRJobSimpleDir");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNativeMRJobMultiQueryOpt() throws Exception {
  try {
    Collection<String> results=new HashSet<String>();
    results.add("(one,1)");
    results.add("(two,2)");
    results.add("(three,3)");
    pigServer.registerQuery("A = load '" + INPUT_FILE + "';");
    pigServer.registerQuery("B = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobMultiQueryOpt_inputB' "+ "Load 'table_testNativeMRJobMultiQueryOpt_outputB' "+ "`org.apache.pig.test.utils.WordCount table_testNativeMRJobMultiQueryOpt_inputB table_testNativeMRJobMultiQueryOpt_outputB`;");
    pigServer.registerQuery("C = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobMultiQueryOpt_inputC' "+ "Load 'table_testNativeMRJobMultiQueryOpt_outputC' "+ "`org.apache.pig.test.utils.WordCount table_testNativeMRJobMultiQueryOpt_inputC table_testNativeMRJobMultiQueryOpt_outputC`;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    Tuple t;
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
    iter=pigServer.openIterator("B");
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
  }
  finally {
    Util.deleteFile(cluster,"table_testNativeMRJobMultiQueryOpt_inputB");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiQueryOpt_outputB");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiQueryOpt_inputC");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiQueryOpt_outputC");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNativeMRJobMultiStoreOnPred() throws Exception {
  try {
    Collection<String> results=new HashSet<String>();
    results.add("(one,1)");
    results.add("(two,2)");
    results.add("(three,3)");
    pigServer.setBatchOn();
    pigServer.registerQuery("A = load '" + INPUT_FILE + "';");
    pigServer.registerQuery("Store A into 'testNativeMRJobMultiStoreOnPredTemp';");
    pigServer.registerQuery("B = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobMultiStoreOnPred_input' "+ "Load 'table_testNativeMRJobMultiStoreOnPred_output' "+ "`org.apache.pig.test.utils.WordCount table_testNativeMRJobMultiStoreOnPred_input table_testNativeMRJobMultiStoreOnPred_output`;");
    pigServer.registerQuery("Store B into 'table_testNativeMRJobMultiStoreOnPredDir';");
    pigServer.executeBatch();
    pigServer.registerQuery("C = load 'table_testNativeMRJobMultiStoreOnPredDir';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    Tuple t;
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
    iter=pigServer.openIterator("B");
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
  }
  finally {
    Util.deleteFile(cluster,"testNativeMRJobMultiStoreOnPredTemp");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiStoreOnPred_input");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiStoreOnPred_output");
    Util.deleteFile(cluster,"table_testNativeMRJobMultiStoreOnPredDir");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNativeMRJobTypeCastInserter() throws Exception {
  try {
    Collection<String> results=new HashSet<String>();
    results.add("(2)");
    results.add("(3)");
    results.add("(4)");
    pigServer.registerQuery("A = load '" + INPUT_FILE + "';");
    pigServer.registerQuery("B = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobTypeCastInserter_input' "+ "Load 'table_testNativeMRJobTypeCastInserter_output' as (name:chararray, count: int)"+ "`org.apache.pig.test.utils.WordCount table_testNativeMRJobTypeCastInserter_input table_testNativeMRJobTypeCastInserter_output`;");
    pigServer.registerQuery("C = foreach B generate count+1;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    Tuple t;
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
  }
  finally {
    Util.deleteFile(cluster,"table_testNativeMRJobTypeCastInserter_input");
    Util.deleteFile(cluster,"table_testNativeMRJobTypeCastInserter_output");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPartitionFilterPushDown </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test PIG-1267
 * @throws Exception
 */
@Test public void testColNameMapping5() throws Exception {
  TestLoader.partFilter=null;
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('mrkt:chararray, a1:chararray, a2:chararray, srcid:int, bcookie:chararray', "+ "'srcid');"+ "b = load 'bar' using "+ TestLoader.class.getName()+ "('dstid:int, b1:int, b2:int, srcid:int, bcookie:chararray, mrkt:chararray',"+ "'srcid');"+ "a1 = filter a by srcid == 10;"+ "b1 = filter b by srcid == 20;"+ "c = join a1 by bcookie, b1 by bcookie;"+ "d = foreach c generate $4 as bcookie:chararray, "+ "$5 as dstid:int, $0 as mrkt:chararray;"+ "store d into 'out';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(q);
  String partFilter=TestLoader.partFilter.toString();
  Assert.assertTrue("(srcid == 20)".equals(partFilter) || "(srcid == 10)".equals(partFilter));
  int counter=0;
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Assert.assertTrue(!(iter.next() instanceof LOFilter));
    counter++;
  }
  Assert.assertEquals(counter,5);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMixedNonPartitionTypeMapComplex() throws Exception {
  TestLoader.partFilter=null;
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray, dstid:int, name:chararray, "+ "age:int, browser:map[], location:tuple(country:chararray, zip:int)', "+ "'srcid,mrkt');"+ "b = filter a by srcid == 10 and mrkt > '1' and mrkt < '5';"+ "c = filter b by browser#'type' == 'IE';"+ "store c into 'out';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(q);
  Assert.assertEquals("checking partition filter:","(((srcid == 10) and (mrkt > '1')) and (mrkt < '5'))",TestLoader.partFilter.toString());
  Operator op=newLogicalPlan.getSinks().get(0);
  LOFilter filter=(LOFilter)newLogicalPlan.getPredecessors(op).get(0);
  String actual=getTestExpression((LogicalExpression)filter.getFilterPlan().getSources().get(0)).toString();
  Assert.assertEquals("checking trimmed filter expression:","(browser#'type' == IE)",actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPruneWithBag() throws Exception {
  String query="a =load 'd.txt' as (id, v:bag{t:(s1,s2,s3)});" + "b = filter a by id>10;" + "c = foreach b generate id, FLATTEN(v);"+ "d = foreach c generate id, v::s2;"+ "store d into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, v:bag{t:(s1,s2,s3)});" + "b = filter a by id>10;" + "c = foreach b generate id, FLATTEN(v);"+ "d = foreach c generate id, v::s2;"+ "store d into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNoPrune() throws Exception {
  String query="a = load 'd.txt' as (id, v1, v2);" + "b = filter a by v1==NULL;" + "store b into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt' as (id, v1, v2);" + "b = filter a by v1==NULL;" + "store b into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a = load 'd.txt';" + "b = foreach a generate $0, $1;" + "store b into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt';" + "b = foreach a generate $0, $1;" + "store b into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPrune() throws Exception {
  String query="a = load 'd.txt' as (id, v1, v2);" + "b = foreach a generate id;" + "store b into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt' as (id);" + "b = foreach a generate id;" + "store b into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a = load 'd.txt' as (id, v1, v5, v3, v4, v2);" + "b = filter a by v1 != NULL AND (v2+v3)<100;" + "c = foreach b generate id;"+ "store c into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt' as (id, v1, v3, v2);" + "b = filter a by v1 != NULL AND (v2+v3)<100;" + "c = foreach b generate id;"+ "store c into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a = load 'd.txt' as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v2, v5, v4;" + "c = foreach b generate v5, v4;"+ "store c into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt' as (v5, v4);" + "b = foreach a generate v5, v4;" + "c = foreach b generate v5, v4;"+ "store c into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a = load 'd.txt' as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate id, v1, v5, v3, v4;" + "c = foreach b generate v5, v4;"+ "store c into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a = load 'd.txt' as (v5, v4);" + "b = foreach a generate v5, v4;" + "c = foreach b generate v5, v4;"+ "store c into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v2, v5, v4;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5, v4;"+ "store d into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (v5, v4, v2);" + "b = foreach a generate v2, v5, v4;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5, v4;"+ "store d into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' as (id, v1, v2, v3);" + "b = load 'c.txt' as (id, v4, v5, v6);" + "c = join a by id, b by id;"+ "d = foreach c generate a::id, v5, v3, v4;"+ "store d into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, v3);" + "b = load 'c.txt' as (id, v4, v5);" + "c = join a by id, b by id;"+ "d = foreach c generate a::id, v5, v3, v4;"+ "store d into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "c = filter a by v2 != NULL;" + "d = foreach c generate v5, v4;"+ "store d into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v5, v4, v2;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5, v4;"+ "store d into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v5, v4, v2;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5;"+ "store d into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v5, v2;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5;"+ "store d into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v5, v4, v2, 10;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5;"+ "store d into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' using BinStorage() as (id, v1, v5, v3, v4, v2);" + "b = foreach a generate v5, v2, 10;" + "c = filter b by v2 != NULL;"+ "d = foreach c generate v5;"+ "store d into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDistinct() throws Exception {
  String testQuery="a = load 'd.txt' as (id, v1, v2);" + "b = load 'd.txt' as (id, v1, v2);" + "c = distinct a;"+ "d = union b, c;"+ "e = foreach d generate id, v1;"+ "store e into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(testQuery);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Operator o=iter.next();
    LogicalRelationalOperator lro=(LogicalRelationalOperator)o;
    if (lro == null || lro.getAlias() == null)     continue;
    if (lro.getAlias().equals("d")) {
      assertNotNull(lro.getSchema());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testAddForeach() throws Exception {
  String query="a =load 'd.txt' as (id, v1, v2);" + "b = filter a by v1>10;" + "c = foreach b generate id;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, v1);" + "b = filter a by v1>10;" + "c = foreach b generate id;"+ "store c into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  query="a =load 'd.txt' as (id, v1, v2);" + "b = load 'd.txt' as (id, v1, v2);" + "c = join a by id, b by id;"+ "d = filter c by a::v1>b::v1;"+ "e = foreach d generate a::id;"+ "store e into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, v1);" + "b = load 'd.txt' as (id, v1);" + "c = join a by id, b by id;"+ "d = foreach c generate a::id, a::v1, b::v1;"+ "e = filter d by a::v1>b::v1;"+ "f = foreach e generate a::id;"+ "store f into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testPruneWithMapKey() throws Exception {
  String query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  LOLoad op=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Integer,Set<String>> annotation=(Map<Integer,Set<String>>)op.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  Set<String> s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
  query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = load 'd.txt' as (id, v1, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = load 'd.txt' as (id, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  List<Operator> ll=newLogicalPlan.getSources();
  assertEquals(2,ll.size());
  LOLoad loada=null;
  LOLoad loadb=null;
  for (  Operator opp : ll) {
    if (((LogicalRelationalOperator)opp).getAlias().equals("a")) {
      loada=(LOLoad)opp;
      continue;
    }
    if (((LogicalRelationalOperator)opp).getAlias().equals("b")) {
      loadb=(LOLoad)opp;
      continue;
    }
  }
  annotation=(Map<Integer,Set<String>>)loada.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNull(annotation);
  annotation=(Map<Integer,Set<String>>)loadb.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanFilterAboveForeach </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionForeach() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, $2;" + "C = filter B by 1 == 1;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator store=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNotPossibleFilter() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, flatten(cuisines);" + "C = FILTER B BY cuisine == 'French';"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Non-deterministic filters should not be pushed up (see PIG-2014).
 * In the example below, if Filter gets pushed above flatten, we might remove
 * whole bags of cuisines of random gets pushed up, while the intent is to sample from each bag.
 * @throws Exception
 */
@Test public void testNondeterministicFilter() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) }, num:int );" + "B = FOREACH A GENERATE name, flatten(cuisines), num;" + "C = FILTER B BY RANDOM(num) > 5;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCastForeach() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, $2;" + "C = filter B by (int)$0 < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator store=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterForeachFlatten() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, flatten($2);" + "C = filter B by $0 < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator store=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterForeach() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, $2;" + "C = filter B by $0 < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator store=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFForeach() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, $2;" + "C = filter B by " + MyFilterFunc.class.getName() + "($1) ;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator store=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterForeachAddedField() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate $1, $2, COUNT({(1)});" + "C = filter B by $2 < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator store=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleFilter2() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, age, cuisines : bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, age, flatten(cuisines);" + "C = FILTER B BY name == 'joe';"+ "D = FILTER C BY age == 30;"+ "E = STORE D INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator filter2=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(filter2 instanceof LOFilter);
  Operator fe1=newLogicalPlan.getSuccessors(filter2).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Similar to test2, but not all fields are available from the operator before foreach.
 * Optimziation doesn't kick in.
 * @throws Exception 
 */
@Test public void test4() throws Exception {
  String query="A =LOAD 'file.txt' AS (a:(u,v), b, c);" + "B = FOREACH A GENERATE $0, b, flatten(1);" + "C = FILTER B BY " + SIZE.class.getName() + "(TOTUPLE(*)) > 5;"+ "STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPushUpFilterWithScalar() throws Exception {
  String query="a = load 'studenttab10k' as (name, age, gpa);" + "b = group a all;" + "c = foreach b generate AVG(a.age) as age;"+ "d = foreach a generate name, age;"+ "e = filter d by age > c.age;"+ "f = store e into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator foreach=newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleNotPossible() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, flatten(cuisines) as cuisines;" + "C = FILTER B BY cuisines == 'pizza';"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimple2() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, cuisines;" + "C = FILTER B BY name == 'joe';"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe1=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleFilter() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines : bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, flatten(cuisines);" + "C = FILTER B BY $1 == 'french';"+ "D = FILTER C BY name == 'joe';"+ "E = STORE D INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe1=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter2=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter2 instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleFilterNotPossible() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines : bag{ t : ( cuisine, region ) } );" + "B = FOREACH A GENERATE name, flatten(cuisines);" + "C = FILTER B BY $1 == 'French';"+ "D = FILTER C BY $2 == 'Europe';"+ "E = STORE D INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator filter2=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(filter2 instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Identical to test1() except that it use project *.
 * @throws Exception 
 */
@Test public void test2() throws Exception {
  String query="A =LOAD 'file.txt' AS (a:(u,v), b, c);" + "B = FOREACH A GENERATE $0, b;" + "C = FILTER B BY " + SIZE.class.getName() + "(TOTUPLE(*)) > 5;"+ "STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe2=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Normal test case: all fields from Foreach are used by exhaustive list.
 * Optimization should kick in.
 * @throws Exception 
 */
@Test public void test1() throws Exception {
  String query="A =LOAD 'file.txt' AS (a:bag{(u,v)}, b, c);" + "B = FOREACH A GENERATE $0, b;" + "C = FILTER B BY " + COUNT.class.getName() + "($0) > 5;"+ "STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe2=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimple() throws Exception {
  String query="A =LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = FOREACH A GENERATE name, flatten(cuisines);" + "C = FILTER B BY name == 'joe';"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe1=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPushUpFilterAboveBinCond() throws Exception {
  String query="data = LOAD 'data.txt' as (referrer:chararray, canonical_url:chararray, ip:chararray);" + "best_url = FOREACH data GENERATE ((canonical_url != '' and canonical_url is not null) ? canonical_url : referrer) AS url, ip;" + "filtered = FILTER best_url BY url == 'badsite.com';"+ "store filtered into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator filter=newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * No fields are used in filter condition at all.
 * @throws Exception 
 */
@Test public void test3() throws Exception {
  String query="A =LOAD 'file.txt' AS (a:(u,v), b, c);" + "B = FOREACH A GENERATE $0, b;" + "C = FILTER B BY 8 > 5;"+ "STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator filter=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator fe1=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator fe2=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(fe2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterForeachCast() throws Exception {
  String query="A =load 'myfile' as (name, age, gpa);" + "B = foreach A generate (int)$1, $2;" + "C = filter B by $0 < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator store=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanFilterRule </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that filter cannot get pushed up over nested Limit (see PIG-3347)
 */
@Test public void testFilterAfterNestedLimit() throws Exception {
  String query="a = LOAD 'file.txt';" + "a_group = group a by $0;" + "b = foreach a_group { a_limit = limit a.$0 5;generate group, a_limit;}"+ "c = filter b by SIZE(a_limit) == 1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator cogroup=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(cogroup instanceof LOCogroup);
  Operator foreach=newLogicalPlan.getSuccessors(cogroup).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that filter cannot get pushed up over nested Distinct (see PIG-3347)
 */
@Test public void testFilterAfterNestedDistinct() throws Exception {
  String query="a = LOAD 'file.txt';" + "a_group = group a by $0;" + "b = foreach a_group { a_distinct = distinct a.$0;generate group, a_distinct;}"+ "c = filter b by SIZE(a_distinct) == 1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator cogroup=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(cogroup instanceof LOCogroup);
  Operator foreach=newLogicalPlan.getSuccessors(cogroup).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that filter cannot get pushed up over nested Filter (see PIG-3347)
 */
@Test public void testFilterAfterNestedFilter() throws Exception {
  String query="a = LOAD 'file.txt';" + "a_group = group a by $0;" + "b = foreach a_group { a_filter = filter a by $0 == 1;generate group, a_filter;}"+ "c = filter b by SIZE(a_filter) == 1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator cogroup=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(cogroup instanceof LOCogroup);
  Operator foreach=newLogicalPlan.getSuccessors(cogroup).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that SAMPLE doesn't get pushed up over Distinct (see PIG-2137)
 */
@Test public void testSampleDistinct() throws Exception {
  String query="A = LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = DISTINCT A;" + "C = SAMPLE B 0.1 ; "+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator dist=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(dist instanceof LODistinct);
  Operator filter=newLogicalPlan.getSuccessors(dist).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that deterministic filter gets get pushed up over Distinct (see PIG-2137)
 */
@Test public void testFilterAfterDistinct() throws Exception {
  String query="A = LOAD 'file.txt' AS (name : chararray, cuisines:bag{ t : ( cuisine ) } );" + "B = DISTINCT A;" + "C = filter B by SIZE(name) > 10;"+ "D = STORE C INTO 'long_name';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator dist=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(dist instanceof LODistinct);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that SAMPLE doesn't get pushed up (see PIG-2014)
 */
@Test public void testSample() throws Exception {
  String query="A = LOAD 'file.txt' AS (name, cuisines:bag{ t : ( cuisine ) } );" + "B = GROUP A by name;" + "C = FOREACH B GENERATE group, A;"+ "D = SAMPLE C 0.1 ; "+ "E = STORE D INTO 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator fe1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator cg=newLogicalPlan.getSuccessors(fe1).get(0);
  Assert.assertTrue(cg instanceof LOCogroup);
  Operator fe2=newLogicalPlan.getSuccessors(cg).get(0);
  Assert.assertTrue(fe1 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(fe2).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that filter does not get blocked for PushUpFilter/FilterAboveForeach
 * by an unrelated nested filter (see PIG-3347)
 */
@Test public void testFilterAfterUnrelatedNestedFilter() throws Exception {
  String query="a = LOAD 'file.txt' as (a0:int, a1_bag:bag{(X:int)}, a2_bag:bag{(Y:int)});" + "b = foreach a { a1_filter = filter a1_bag by X == 1; generate a0, a1_filter, a2_bag;}" + "c = filter b by SIZE(a2_bag) == 1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  newLogicalPlan.explain(System.out,"text",true);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach1=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach1 instanceof LOForEach);
  Operator filter=newLogicalPlan.getSuccessors(foreach1).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator foreach2=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(foreach2 instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFNegative() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by age;" + "C = filter B by COUNT(A) < 18;"+ "D = STORE C INTO 'empty';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator group=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(group instanceof LOCogroup);
  Operator filter=newLogicalPlan.getSuccessors(group).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Operator store=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanImplicitSplit </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitInCoGroup() throws Exception {
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  pigServer.explain("f",System.out);
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitInCoGroup2() throws Exception {
  String query=("a = load 'file1' using PigStorage(':') as (name:chararray, marks:int);" + "b = load 'file2' using PigStorage(':') as (name:chararray, rank:chararray);" + "c = cogroup a by name, b by name;"+ "d = foreach c generate group, FLATTEN(a.marks) as newmarks;"+ "e = cogroup a by marks, d by newmarks;"+ "f = foreach e generate group, flatten(a), flatten(d);"+ "store f into 'out';");
  org.apache.pig.newplan.logical.relational.LogicalPlan plan=Util.buildLp(pigServer,query);
  new LogicalPlanOptimizer(plan,5,null).optimize();
  String expectedSchema="group:int,a::name:chararray,a::marks:int,d::group:chararray,d::newmarks:int";
  assertEquals(expectedSchema,((LogicalRelationalOperator)plan.getSinks().get(0)).getSchema().toString(false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanListener </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaPatcher() throws FrontendException {
  SchemaPatcher patcher=new SchemaPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalSchema dschema=D.getSchema();
  assertEquals(1,dschema.size());
  LogicalSchema.LogicalFieldSchema y=dschema.getField(0);
  assertEquals("y",y.alias);
  assertEquals(2,y.uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionPatcher() throws FrontendException {
  ProjectionPatcher patcher=new ProjectionPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalExpressionPlan filterPlan=D.getFilterPlan();
  List<Operator> leaves=filterPlan.getSinks();
  assertEquals(2,leaves.size());
  ProjectExpression proj=null;
  for (  Operator leaf : leaves) {
    if (leaf instanceof ProjectExpression) {
      proj=(ProjectExpression)leaf;
      break;
    }
  }
  assertNotNull(proj);
  assertEquals(0,proj.getInputNum());
  assertEquals(0,proj.getColNum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUserDefinedForEachSchema2() throws Exception {
  String query=("a = load 'a.txt' as (b:bag{});" + "b = foreach a generate flatten($0) as (a0, a1);" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOForEach foreach=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  foreach.getSchema();
  assertTrue(foreach.getSchema().size() == 2);
  assertTrue(foreach.getSchema().getField(0).alias.equals("a0"));
  assertTrue(foreach.getSchema().getField(1).alias.equals("a1"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithSubtract() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a-b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(SubtractExpression.class,genExp.getSources().get(0).getClass());
  SubtractExpression add=(SubtractExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Subtract.class,inputPln.getLeaves().get(0).getClass());
  Subtract pSubtract=(Subtract)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pSubtract.getLhs().getClass());
  assertEquals(POProject.class,pSubtract.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithCast() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id==10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator equal=filPlan.getLeaves().get(0);
  assertEquals(EqualToExpr.class,equal.getClass());
  assertEquals(DataType.BOOLEAN,((EqualToExpr)equal).getResultType());
  PhysicalOperator constExpr=((EqualToExpr)equal).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((EqualToExpr)equal).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithNegative() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate -a;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(NegativeExpression.class,genExp.getSources().get(0).getClass());
  NegativeExpression add=(NegativeExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getExpression().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(PONegative.class,inputPln.getLeaves().get(0).getClass());
  PONegative pNegative=(PONegative)inputPln.getLeaves().get(0);
  assertEquals(1,inputPln.getRoots().size());
  assertEquals(POProject.class,pNegative.getInputs().get(0).getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachPlan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = foreach a generate id, c;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(phyPlan.size(),3);
  assertEquals(phyPlan.getLeaves().get(0).getClass(),POStore.class);
  POForEach foreach=(POForEach)phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(foreach.getInputPlans().size(),2);
  PhysicalPlan inner=foreach.getInputPlans().get(0);
  assertEquals(inner.size(),1);
  POProject prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),0);
  assertEquals(prj.getInputs(),null);
  inner=foreach.getInputPlans().get(1);
  assertEquals(inner.size(),1);
  prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),1);
  assertEquals(prj.getInputs(),null);
  Boolean[] flat=foreach.getToBeFlattened().toArray(new Boolean[0]);
  assertFalse(flat[0]);
  assertFalse(flat[1]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithGreaterThan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id>10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator greaterThan=filPlan.getLeaves().get(0);
  assertEquals(GreaterThanExpr.class,greaterThan.getClass());
  assertEquals(DataType.BOOLEAN,((GreaterThanExpr)greaterThan).getResultType());
  PhysicalOperator constExpr=((GreaterThanExpr)greaterThan).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((GreaterThanExpr)greaterThan).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithMultiply() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a*b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(MultiplyExpression.class,genExp.getSources().get(0).getClass());
  MultiplyExpression add=(MultiplyExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Multiply.class,inputPln.getLeaves().get(0).getClass());
  Multiply pMultiply=(Multiply)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pMultiply.getLhs().getClass());
  assertEquals(POProject.class,pMultiply.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimplePlan() throws Exception {
  String query=("a = load 'd.txt';" + "b = filter a by $0==NULL;" + "store b into 'empty';");
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(1,phyPlan.getRoots().size());
  assertEquals(1,phyPlan.getLeaves().size());
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> roots=filPlan.getRoots();
  Collections.sort(roots);
  assertEquals(2,roots.size());
  assertEquals(1,filPlan.getLeaves().size());
  PhysicalOperator eq=filPlan.getLeaves().get(0);
  assertEquals(EqualToExpr.class,eq.getClass());
  PhysicalOperator prj1=roots.get(0);
  assertEquals(POProject.class,prj1.getClass());
  assertEquals(0,((POProject)prj1).getColumn());
  PhysicalOperator constExp=roots.get(1);
  assertEquals(ConstantExpression.class,constExp.getClass());
  assertEquals(null,((ConstantExpression)constExp).getValue());
  PhysicalOperator stor=phyPlan.getSuccessors(fil).get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlanwithUserFunc2() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:bag{t:tuple(b_a:int,b_b:int)});" + "b = foreach a generate a,COUNT(b.b_a);" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(2,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp1=gen.getOutputPlans().get(0);
  assertEquals(1,genExp1.getSources().size());
  assertEquals(ProjectExpression.class,genExp1.getSources().get(0).getClass());
  ProjectExpression prj1=(ProjectExpression)genExp1.getSources().get(0);
  assertEquals(ls.getField(0).uid,prj1.getFieldSchema().uid);
  LogicalExpressionPlan genExp2=gen.getOutputPlans().get(1);
  assertEquals(UserFuncExpression.class,genExp2.getSources().get(0).getClass());
  assertEquals(ProjectExpression.class,genExp2.getSinks().get(0).getClass());
  ProjectExpression prj2=(ProjectExpression)genExp2.getSinks().get(0);
  assertEquals(ls.getField(1).uid,prj2.getFieldSchema().uid);
  assertEquals(DereferenceExpression.class,genExp2.getPredecessors(prj2).get(0).getClass());
  assertEquals(0,(int)((DereferenceExpression)genExp2.getPredecessors(prj2).get(0)).getBagColumns().get(0));
  assertEquals(1,inputPln.getRoots().size());
  assertEquals(POProject.class,inputPln.getRoots().get(0).getClass());
  assertEquals(0,((POProject)inputPln.getRoots().get(0)).getColumn());
  PhysicalPlan inputPln2=pForEach.getInputPlans().get(1);
  assertEquals(1,inputPln2.getRoots().size());
  assertEquals(POProject.class,inputPln2.getRoots().get(0).getClass());
  assertEquals(1,((POProject)inputPln2.getRoots().get(0)).getColumn());
  assertEquals(POUserFunc.class,inputPln2.getLeaves().get(0).getClass());
  assertEquals("org.apache.pig.builtin.COUNT",((POUserFunc)inputPln2.getLeaves().get(0)).getFuncSpec().getClassName());
  POProject prj3=(POProject)inputPln2.getRoots().get(0);
  assertEquals(POProject.class,inputPln2.getSuccessors(prj3).get(0).getClass());
  assertEquals(0,((POProject)inputPln2.getSuccessors(prj3).get(0)).getColumn());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroup() throws Exception {
  String query=("a = load 'd.txt' as (name:chararray, age:int, gpa:float);" + "b = group a by name;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(1,phyPlan.getRoots().size());
  assertEquals(POLoad.class,phyPlan.getRoots().get(0).getClass());
  POLoad load=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load).get(0).getClass());
  POLocalRearrange localR=(POLocalRearrange)phyPlan.getSuccessors(load).get(0);
  assertEquals(1,localR.getInputs().size());
  assertEquals(1,localR.getPlans().size());
  PhysicalPlan cogroupPlan=localR.getPlans().get(0);
  assertEquals(1,cogroupPlan.getLeaves().size());
  assertEquals(POProject.class,cogroupPlan.getLeaves().get(0).getClass());
  POProject prj=(POProject)cogroupPlan.getLeaves().get(0);
  assertEquals(0,prj.getColumn());
  assertEquals(DataType.CHARARRAY,prj.getResultType());
  assertEquals(POGlobalRearrange.class,phyPlan.getSuccessors(localR).get(0).getClass());
  POGlobalRearrange globalR=(POGlobalRearrange)phyPlan.getSuccessors(localR).get(0);
  assertEquals(DataType.TUPLE,globalR.getResultType());
  assertEquals(POPackage.class,phyPlan.getSuccessors(globalR).get(0).getClass());
  POPackage pack=(POPackage)phyPlan.getSuccessors(globalR).get(0);
  assertEquals(DataType.TUPLE,pack.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlanwithUserFunc() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:bag{t:tuple(b_a:int,b_b:int)});" + "b = foreach a generate a,COUNT(b);" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln1=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(2,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp1=gen.getOutputPlans().get(0);
  assertEquals(1,genExp1.getSources().size());
  assertEquals(ProjectExpression.class,genExp1.getSources().get(0).getClass());
  ProjectExpression prj1=(ProjectExpression)genExp1.getSources().get(0);
  assertEquals(ls.getField(0).uid,prj1.getFieldSchema().uid);
  LogicalExpressionPlan genExp2=gen.getOutputPlans().get(1);
  assertEquals(UserFuncExpression.class,genExp2.getSources().get(0).getClass());
  assertEquals(ProjectExpression.class,genExp2.getSinks().get(0).getClass());
  ProjectExpression prj2=(ProjectExpression)genExp2.getSinks().get(0);
  assertEquals(ls.getField(1).uid,prj2.getFieldSchema().uid);
  assertEquals(1,inputPln1.getLeaves().size());
  assertEquals(1,inputPln1.getRoots().size());
  assertEquals(POProject.class,inputPln1.getLeaves().get(0).getClass());
  assertEquals(0,((POProject)inputPln1.getLeaves().get(0)).getColumn());
  PhysicalPlan inputPln2=pForEach.getInputPlans().get(1);
  assertEquals(POUserFunc.class,inputPln2.getLeaves().get(0).getClass());
  assertEquals("org.apache.pig.builtin.COUNT",((POUserFunc)inputPln2.getLeaves().get(0)).getFuncSpec().getClassName());
  assertEquals(POProject.class,inputPln2.getRoots().get(0).getClass());
  assertEquals(1,((POProject)inputPln2.getRoots().get(0)).getColumn());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithisNotNull() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = filter a by a is not null;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fil=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(newLogicalPlan.getSources().get(0)).get(0);
  assertEquals(LOFilter.class,fil.getClass());
  LOFilter filter=(LOFilter)fil;
  LogicalExpressionPlan filPlan=filter.getFilterPlan();
  assertEquals(1,filPlan.getSources().size());
  assertEquals(3,filPlan.size());
  assertEquals(1,filPlan.getSinks().size());
  assertEquals(NotExpression.class,filPlan.getSources().get(0).getClass());
  NotExpression notExp=(NotExpression)filPlan.getSources().get(0);
  assertTrue(ls.getField(0).uid != notExp.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != notExp.getFieldSchema().uid);
  assertEquals(IsNullExpression.class,notExp.getExpression().getClass());
  IsNullExpression isNull=(IsNullExpression)notExp.getExpression();
  assertTrue(ls.getField(0).uid != isNull.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != isNull.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,isNull.getExpression().getClass());
  ProjectExpression prj=(ProjectExpression)isNull.getExpression();
  assertEquals(ls.getField(0).uid,prj.getFieldSchema().uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupSchema2() throws Exception {
  String query="a = load '1.txt' as (a0, a1);" + "b = group a by a0;" + "c = foreach b generate a.a1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOForEach foreach=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  LogicalSchema foreachSchema=foreach.getSchema();
  assertEquals(foreachSchema.getField(0).type,DataType.BAG);
  LogicalSchema bagSchema=foreachSchema.getField(0).schema;
  assertEquals(bagSchema.getField(0).type,DataType.TUPLE);
  assertEquals(bagSchema.getField(0).alias,null);
  LogicalSchema tupleSchema=bagSchema.getField(0).schema;
  assertEquals(tupleSchema.size(),1);
  assertTrue(tupleSchema.getField(0).alias.equals("a1"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroup4() throws Exception {
  String query="a = load 'd.txt' as (name:chararray, age:int, gpa:float);" + "b = load 'e.txt' as (name:chararray, age:int, gpa:float);" + "c = group a by ( name, age ), b by ( name, age );"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(2,phyPlan.getRoots().size());
  assertEquals(POLoad.class,phyPlan.getRoots().get(0).getClass());
  POLoad load=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load).get(0).getClass());
  POLocalRearrange localR=(POLocalRearrange)phyPlan.getSuccessors(load).get(0);
  assertEquals(2,localR.getPlans().size());
  PhysicalPlan cogroupPlan=localR.getPlans().get(0);
  assertEquals(1,cogroupPlan.getLeaves().size());
  assertEquals(POProject.class,cogroupPlan.getLeaves().get(0).getClass());
  POProject prj=(POProject)cogroupPlan.getLeaves().get(0);
  assertEquals(0,prj.getColumn());
  assertEquals(DataType.CHARARRAY,prj.getResultType());
  PhysicalPlan cogroupPlan2=localR.getPlans().get(1);
  assertEquals(1,cogroupPlan2.getLeaves().size());
  assertEquals(POProject.class,cogroupPlan2.getLeaves().get(0).getClass());
  POProject prj2=(POProject)cogroupPlan2.getLeaves().get(0);
  assertEquals(1,prj2.getColumn());
  assertEquals(DataType.INTEGER,prj2.getResultType());
  assertEquals(POGlobalRearrange.class,phyPlan.getSuccessors(localR).get(0).getClass());
  POGlobalRearrange globalR=(POGlobalRearrange)phyPlan.getSuccessors(localR).get(0);
  assertEquals(DataType.TUPLE,globalR.getResultType());
  assertEquals(POLoad.class,phyPlan.getRoots().get(1).getClass());
  POLoad load2=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load2).get(0).getClass());
  POLocalRearrange localR3=(POLocalRearrange)phyPlan.getSuccessors(load2).get(0);
  assertEquals(2,localR3.getPlans().size());
  PhysicalPlan cogroupPlan3=localR3.getPlans().get(0);
  POProject prj3=(POProject)cogroupPlan3.getLeaves().get(0);
  assertEquals(0,prj3.getColumn());
  assertEquals(DataType.CHARARRAY,prj3.getResultType());
  PhysicalPlan cogroupPlan4=localR3.getPlans().get(1);
  POProject prj4=(POProject)cogroupPlan4.getLeaves().get(0);
  assertEquals(1,prj4.getColumn());
  assertEquals(DataType.INTEGER,prj4.getResultType());
  assertEquals(POPackage.class,phyPlan.getSuccessors(globalR).get(0).getClass());
  POPackage pack=(POPackage)phyPlan.getSuccessors(globalR).get(0);
  assertEquals(DataType.TUPLE,pack.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStore() throws Exception {
  String query=("a = load 'd1.txt' as (id, c);" + "b = load 'd2.txt'as (id, c);" + "c = load 'd3.txt' as (id, c);"+ "d = join a by id, b by c;"+ "e = filter d by a::id==NULL AND b::c==NULL;"+ "f = join e by b::c, c by id;"+ "g = filter f by b::id==NULL AND c::c==NULL;"+ "store g into 'empty2';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(16,phyPlan.size());
  List<PhysicalOperator> phyPlanRoots=phyPlan.getRoots();
  Collections.sort(phyPlanRoots);
  assertEquals(phyPlanRoots.size(),3);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator LoR=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(2)).get(0);
  assertEquals(POLocalRearrange.class,LoR.getClass());
  POLocalRearrange Lor=(POLocalRearrange)LoR;
  PhysicalOperator prj1=Lor.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj1.getClass());
  assertEquals(0,((POProject)prj1).getColumn());
  PhysicalOperator inp1=Lor.getInputs().get(0);
  assertEquals(POLoad.class,inp1.getClass());
  assertTrue(((POLoad)inp1).getLFile().getFileName().contains("d3.txt"));
  PhysicalOperator LoR1=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(0)).get(0);
  assertEquals(POLocalRearrange.class,LoR1.getClass());
  POLocalRearrange Lor1=(POLocalRearrange)LoR1;
  PhysicalOperator prj2=Lor1.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj2.getClass());
  assertEquals(0,((POProject)prj2).getColumn());
  PhysicalOperator inp2=Lor1.getInputs().get(0);
  assertEquals(POLoad.class,inp2.getClass());
  assertTrue(((POLoad)inp2).getLFile().getFileName().contains("d1.txt"));
  PhysicalOperator GoR=(PhysicalOperator)phyPlan.getSuccessors(LoR).get(0);
  assertEquals(POGlobalRearrange.class,GoR.getClass());
  PhysicalOperator Pack=(PhysicalOperator)phyPlan.getSuccessors(GoR).get(0);
  assertEquals(POPackage.class,Pack.getClass());
  PhysicalOperator LoR2=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(1)).get(0);
  assertEquals(POLocalRearrange.class,LoR2.getClass());
  POLocalRearrange Lor2=(POLocalRearrange)LoR2;
  PhysicalOperator prj3=Lor2.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj3.getClass());
  assertEquals(1,((POProject)prj3).getColumn());
  PhysicalOperator inp3=Lor2.getInputs().get(0);
  assertEquals(POLoad.class,inp3.getClass());
  assertTrue(((POLoad)inp3).getLFile().getFileName().contains("d2.txt"));
  PhysicalOperator GoR2=(PhysicalOperator)phyPlan.getSuccessors(LoR2).get(0);
  assertEquals(POGlobalRearrange.class,GoR2.getClass());
  PhysicalOperator Pack2=(PhysicalOperator)phyPlan.getSuccessors(GoR2).get(0);
  assertEquals(POPackage.class,Pack2.getClass());
  PhysicalOperator ForE=(PhysicalOperator)phyPlan.getSuccessors(Pack).get(0);
  assertEquals(POForEach.class,ForE.getClass());
  PhysicalOperator prj4=((POForEach)ForE).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj4.getClass());
  assertEquals(1,((POProject)prj4).getColumn());
  PhysicalOperator prj5=((POForEach)ForE).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj5.getClass());
  assertEquals(2,((POProject)prj5).getColumn());
  PhysicalOperator ForE2=(PhysicalOperator)phyPlan.getSuccessors(Pack2).get(0);
  assertEquals(POForEach.class,ForE2.getClass());
  PhysicalOperator prj6=((POForEach)ForE2).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj6.getClass());
  assertEquals(1,((POProject)prj6).getColumn());
  PhysicalOperator prj7=((POForEach)ForE2).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj7.getClass());
  assertEquals(2,((POProject)prj7).getColumn());
  PhysicalOperator fil=(PhysicalOperator)phyPlan.getSuccessors(ForE).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> filRoots=filPlan.getRoots();
  Collections.sort(filRoots);
  assertEquals(ConstantExpression.class,filRoots.get(1).getClass());
  ConstantExpression ce1=(ConstantExpression)filRoots.get(1);
  assertEquals(null,ce1.getValue());
  assertEquals(ConstantExpression.class,filRoots.get(3).getClass());
  ConstantExpression ce2=(ConstantExpression)filRoots.get(3);
  assertEquals(null,ce2.getValue());
  assertEquals(POProject.class,filRoots.get(2).getClass());
  POProject prj8=(POProject)filRoots.get(2);
  assertEquals(5,prj8.getColumn());
  assertEquals(POProject.class,filRoots.get(0).getClass());
  POProject prj9=(POProject)filRoots.get(0);
  assertEquals(2,prj9.getColumn());
  PhysicalOperator fil2=(PhysicalOperator)phyPlan.getSuccessors(ForE2).get(0);
  assertEquals(POFilter.class,fil2.getClass());
  PhysicalOperator LoR3=(PhysicalOperator)phyPlan.getSuccessors(fil2).get(0);
  assertEquals(POLocalRearrange.class,LoR3.getClass());
  POLocalRearrange Lor3=(POLocalRearrange)LoR3;
  PhysicalOperator prj12=Lor3.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj12.getClass());
  assertEquals(3,((POProject)prj12).getColumn());
  PhysicalPlan filPlan2=((POFilter)fil2).getPlan();
  List<PhysicalOperator> filRoots2=filPlan2.getRoots();
  Collections.sort(filRoots2);
  assertEquals(ConstantExpression.class,filRoots2.get(1).getClass());
  ConstantExpression ce3=(ConstantExpression)filRoots2.get(1);
  assertEquals(null,ce3.getValue());
  assertEquals(ConstantExpression.class,filRoots2.get(3).getClass());
  ConstantExpression ce4=(ConstantExpression)filRoots2.get(3);
  assertEquals(null,ce4.getValue());
  assertEquals(POProject.class,filRoots2.get(2).getClass());
  POProject prj10=(POProject)filRoots2.get(2);
  assertEquals(3,prj10.getColumn());
  assertEquals(POProject.class,filRoots2.get(0).getClass());
  POProject prj11=(POProject)filRoots2.get(0);
  assertEquals(0,prj11.getColumn());
  PhysicalOperator stor=(PhysicalOperator)phyPlan.getLeaves().get(0);
  assertEquals(stor,phyPlan.getSuccessors(fil).get(0));
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupSchema1() throws Exception {
  String query=("a = load '1.txt' as (a0, a1);" + "b = group a by a0;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOCogroup cogroup=(LOCogroup)newLogicalPlan.getPredecessors(store).get(0);
  LogicalSchema cogroupSchema=cogroup.getSchema();
  assertEquals(cogroupSchema.getField(1).type,DataType.BAG);
  assertTrue(cogroupSchema.getField(1).alias.equals("a"));
  LogicalSchema bagSchema=cogroupSchema.getField(1).schema;
  assertEquals(bagSchema.getField(0).type,DataType.TUPLE);
  assertEquals(bagSchema.getField(0).alias,null);
  LogicalSchema tupleSchema=bagSchema.getField(0).schema;
  assertEquals(tupleSchema.size(),2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroup3() throws Exception {
  String query="a = load 'd.txt' as (name:chararray, age:int, gpa:float);" + "b = load 'e.txt' as (name:chararray, age:int, gpa:float);" + "c = group a by name, b by name;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(2,phyPlan.getRoots().size());
  assertEquals(POLoad.class,phyPlan.getRoots().get(0).getClass());
  POLoad load=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load).get(0).getClass());
  POLocalRearrange localR=(POLocalRearrange)phyPlan.getSuccessors(load).get(0);
  assertEquals(1,localR.getPlans().size());
  PhysicalPlan cogroupPlan=localR.getPlans().get(0);
  assertEquals(1,cogroupPlan.getLeaves().size());
  assertEquals(POProject.class,cogroupPlan.getLeaves().get(0).getClass());
  POProject prj=(POProject)cogroupPlan.getLeaves().get(0);
  assertEquals(0,prj.getColumn());
  assertEquals(DataType.CHARARRAY,prj.getResultType());
  assertEquals(POGlobalRearrange.class,phyPlan.getSuccessors(localR).get(0).getClass());
  POGlobalRearrange globalR=(POGlobalRearrange)phyPlan.getSuccessors(localR).get(0);
  assertEquals(DataType.TUPLE,globalR.getResultType());
  assertEquals(POLoad.class,phyPlan.getRoots().get(1).getClass());
  POLoad load2=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load2).get(0).getClass());
  POLocalRearrange localR2=(POLocalRearrange)phyPlan.getSuccessors(load2).get(0);
  assertEquals(1,localR2.getPlans().size());
  PhysicalPlan cogroupPlan2=localR2.getPlans().get(0);
  POProject prj2=(POProject)cogroupPlan2.getLeaves().get(0);
  assertEquals(0,prj2.getColumn());
  assertEquals(DataType.CHARARRAY,prj2.getResultType());
  assertEquals(POPackage.class,phyPlan.getSuccessors(globalR).get(0).getClass());
  POPackage pack=(POPackage)phyPlan.getSuccessors(globalR).get(0);
  assertEquals(DataType.TUPLE,pack.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithDivide() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a/b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(DivideExpression.class,genExp.getSources().get(0).getClass());
  DivideExpression add=(DivideExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Divide.class,inputPln.getLeaves().get(0).getClass());
  Divide pDivide=(Divide)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pDivide.getLhs().getClass());
  assertEquals(POProject.class,pDivide.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithPlus() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a+b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(AddExpression.class,genExp.getSources().get(0).getClass());
  AddExpression add=(AddExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Add.class,inputPln.getLeaves().get(0).getClass());
  Add pAdd=(Add)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pAdd.getLhs().getClass());
  assertEquals(POProject.class,pAdd.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithLessThan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id<10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator lessThan=filPlan.getLeaves().get(0);
  assertEquals(LessThanExpr.class,lessThan.getClass());
  assertEquals(DataType.BOOLEAN,((LessThanExpr)lessThan).getResultType());
  PhysicalOperator constExpr=((LessThanExpr)lessThan).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((LessThanExpr)lessThan).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlanwithBinCond() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate ( a < b ? b : a );" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(BinCondExpression.class,genExp.getSources().get(0).getClass());
  BinCondExpression add=(BinCondExpression)genExp.getSources().get(0);
  assertEquals(LessThanExpression.class,add.getCondition().getClass());
  LessThanExpression lessThan=(LessThanExpression)add.getCondition();
  assertEquals(ProjectExpression.class,lessThan.getLhs().getClass());
  ProjectExpression prj1=((ProjectExpression)lessThan.getLhs());
  ProjectExpression prj2=((ProjectExpression)lessThan.getRhs());
  assertEquals(ls.getField(0).uid,prj1.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,lessThan.getRhs().getClass());
  assertEquals(ls.getField(1).uid,prj2.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,add.getLhs().getClass());
  ProjectExpression prj3=((ProjectExpression)add.getLhs());
  assertEquals(ls.getField(1).uid,prj3.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,add.getRhs().getClass());
  ProjectExpression prj4=((ProjectExpression)add.getRhs());
  assertEquals(ls.getField(0).uid,prj4.getFieldSchema().uid);
  assertEquals(4,inputPln.getRoots().size());
  for (  PhysicalOperator p : inputPln.getRoots()) {
    assertEquals(POProject.class,p.getClass());
  }
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(POBinCond.class,inputPln.getLeaves().get(0).getClass());
  POBinCond binCond=(POBinCond)inputPln.getLeaves().get(0);
  assertEquals(POProject.class,binCond.getLhs().getClass());
  POProject prj_1=(POProject)binCond.getLhs();
  assertEquals(1,prj_1.getColumn());
  assertEquals(POProject.class,binCond.getRhs().getClass());
  POProject prj_2=(POProject)binCond.getRhs();
  assertEquals(0,prj_2.getColumn());
  assertEquals(LessThanExpr.class,binCond.getCond().getClass());
  LessThanExpr lessThan_p=(LessThanExpr)binCond.getCond();
  assertEquals(POProject.class,lessThan_p.getLhs().getClass());
  POProject prj_3=(POProject)lessThan_p.getLhs();
  assertEquals(0,prj_3.getColumn());
  assertEquals(POProject.class,lessThan_p.getRhs().getClass());
  POProject prj_4=(POProject)lessThan_p.getRhs();
  assertEquals(1,prj_4.getColumn());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithMod() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a%b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(ModExpression.class,genExp.getSources().get(0).getClass());
  ModExpression add=(ModExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Mod.class,inputPln.getLeaves().get(0).getClass());
  Mod pMod=(Mod)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pMod.getLhs().getClass());
  assertEquals(POProject.class,pMod.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroup2() throws Exception {
  String query=("a = load 'd.txt' as (name:chararray, age:int, gpa:float);" + "b = group a by ( name, age );" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(1,phyPlan.getRoots().size());
  assertEquals(POLoad.class,phyPlan.getRoots().get(0).getClass());
  POLoad load=(POLoad)phyPlan.getRoots().get(0);
  assertEquals(POLocalRearrange.class,phyPlan.getSuccessors(load).get(0).getClass());
  POLocalRearrange localR=(POLocalRearrange)phyPlan.getSuccessors(load).get(0);
  assertEquals(1,localR.getInputs().size());
  assertEquals(2,localR.getPlans().size());
  PhysicalPlan cogroupPlan=localR.getPlans().get(0);
  assertEquals(1,cogroupPlan.getLeaves().size());
  assertEquals(POProject.class,cogroupPlan.getLeaves().get(0).getClass());
  POProject prj=(POProject)cogroupPlan.getLeaves().get(0);
  assertEquals(0,prj.getColumn());
  assertEquals(DataType.CHARARRAY,prj.getResultType());
  PhysicalPlan cogroupPlan2=localR.getPlans().get(1);
  POProject prj2=(POProject)cogroupPlan2.getLeaves().get(0);
  assertEquals(1,prj2.getColumn());
  assertEquals(DataType.INTEGER,prj2.getResultType());
  assertEquals(POGlobalRearrange.class,phyPlan.getSuccessors(localR).get(0).getClass());
  POGlobalRearrange globalR=(POGlobalRearrange)phyPlan.getSuccessors(localR).get(0);
  assertEquals(DataType.TUPLE,globalR.getResultType());
  assertEquals(POPackage.class,phyPlan.getSuccessors(globalR).get(0).getClass());
  POPackage pack=(POPackage)phyPlan.getSuccessors(globalR).get(0);
  assertEquals(DataType.TUPLE,pack.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinPlan() throws Exception {
  String query=("a = load 'd1.txt' as (id, c);" + "b = load 'd2.txt'as (id, c);" + "c = join a by id, b by c;"+ "d = filter c by a::id==NULL AND b::c==NULL;"+ "store d into 'empty';");
  LogicalPlan newPlan=buildPlan(query);
  PhysicalPlan physicalPlan=translatePlan(newPlan);
  assertEquals(9,physicalPlan.size());
  List<PhysicalOperator> roots=physicalPlan.getRoots();
  Collections.sort(roots);
  assertEquals(roots.size(),2);
  PhysicalOperator LoR=(PhysicalOperator)physicalPlan.getSuccessors(roots.get(0)).get(0);
  assertEquals(POLocalRearrange.class,LoR.getClass());
  POLocalRearrange Lor=(POLocalRearrange)LoR;
  PhysicalOperator prj3=Lor.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj3.getClass());
  assertEquals(0,((POProject)prj3).getColumn());
  PhysicalOperator inp1=Lor.getInputs().get(0);
  assertEquals(POLoad.class,inp1.getClass());
  assertTrue(((POLoad)inp1).getLFile().getFileName().contains("d1.txt"));
  PhysicalOperator LoR1=(PhysicalOperator)physicalPlan.getSuccessors(roots.get(1)).get(0);
  assertEquals(POLocalRearrange.class,LoR1.getClass());
  POLocalRearrange Lor1=(POLocalRearrange)LoR1;
  PhysicalOperator prj4=Lor1.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj4.getClass());
  assertEquals(1,((POProject)prj4).getColumn());
  PhysicalOperator inp2=Lor1.getInputs().get(0);
  assertEquals(POLoad.class,inp2.getClass());
  assertTrue(((POLoad)inp2).getLFile().getFileName().contains("d2.txt"));
  PhysicalOperator GoR=(PhysicalOperator)physicalPlan.getSuccessors(LoR).get(0);
  assertEquals(POGlobalRearrange.class,GoR.getClass());
  PhysicalOperator Pack=(PhysicalOperator)physicalPlan.getSuccessors(GoR).get(0);
  assertEquals(POPackage.class,Pack.getClass());
  PhysicalOperator ForE=(PhysicalOperator)physicalPlan.getSuccessors(Pack).get(0);
  assertEquals(POForEach.class,ForE.getClass());
  PhysicalOperator prj5=((POForEach)ForE).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj5.getClass());
  assertEquals(1,((POProject)prj5).getColumn());
  PhysicalOperator prj6=((POForEach)ForE).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj6.getClass());
  assertEquals(2,((POProject)prj6).getColumn());
  PhysicalOperator fil=(PhysicalOperator)physicalPlan.getSuccessors(ForE).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> filRoots=filPlan.getRoots();
  assertEquals(4,filRoots.size());
  Collections.sort(filRoots);
  assertEquals(ConstantExpression.class,filRoots.get(1).getClass());
  ConstantExpression ce1=(ConstantExpression)filRoots.get(1);
  assertEquals(null,ce1.getValue());
  assertEquals(ConstantExpression.class,filRoots.get(3).getClass());
  ConstantExpression ce2=(ConstantExpression)filRoots.get(3);
  assertEquals(null,ce2.getValue());
  assertEquals(POProject.class,filRoots.get(0).getClass());
  POProject prj1=(POProject)filRoots.get(0);
  assertEquals(0,prj1.getColumn());
  assertEquals(POProject.class,filRoots.get(2).getClass());
  POProject prj2=(POProject)filRoots.get(2);
  assertEquals(3,prj2.getColumn());
  PhysicalOperator stor=(PhysicalOperator)physicalPlan.getSuccessors(fil).get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUserDefinedForEachSchema1() throws Exception {
  String query=("a = load 'a.txt';" + "b = foreach a generate $0 as a0, $1 as a1;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOForEach foreach=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  foreach.getSchema();
  assertTrue(foreach.getSchema().size() == 2);
  assertTrue(foreach.getSchema().getField(0).alias.equals("a0"));
  assertTrue(foreach.getSchema().getField(1).alias.equals("a1"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithisNull() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = filter a by a is null;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fil=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(newLogicalPlan.getSources().get(0)).get(0);
  assertEquals(LOFilter.class,fil.getClass());
  LOFilter filter=(LOFilter)fil;
  LogicalExpressionPlan filPlan=filter.getFilterPlan();
  assertEquals(1,filPlan.getSources().size());
  assertEquals(2,filPlan.size());
  assertEquals(1,filPlan.getSinks().size());
  assertEquals(IsNullExpression.class,filPlan.getSources().get(0).getClass());
  IsNullExpression isNull=(IsNullExpression)filPlan.getSources().get(0);
  assertTrue(ls.getField(0).uid != isNull.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != isNull.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,isNull.getExpression().getClass());
  ProjectExpression prj=(ProjectExpression)isNull.getExpression();
  assertEquals(ls.getField(0).uid,prj.getFieldSchema().uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachPlan2() throws Exception {
  String query=("a = load 'd.txt' as (id, c:bag{t:(s,v)});" + "b = foreach a generate id, flatten(c);" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(ld).get(0);
  LogicalSchema ls=fe.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(4,ls.getField(1).uid);
  assertEquals(5,ls.getField(2).uid);
  LogicalSchema expected=new LogicalSchema();
  expected.addField(new LogicalFieldSchema("id",null,DataType.BYTEARRAY));
  expected.addField(new LogicalFieldSchema("s",null,DataType.BYTEARRAY));
  expected.addField(new LogicalFieldSchema("v",null,DataType.BYTEARRAY));
  assertTrue(expected.isEqual(ls));
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(phyPlan.size(),3);
  assertEquals(phyPlan.getLeaves().get(0).getClass(),POStore.class);
  POForEach foreach=(POForEach)phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(foreach.getInputPlans().size(),2);
  PhysicalPlan inner=foreach.getInputPlans().get(0);
  assertEquals(inner.size(),1);
  POProject prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),0);
  assertEquals(prj.getInputs(),null);
  inner=foreach.getInputPlans().get(1);
  assertEquals(inner.size(),1);
  prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),1);
  assertEquals(prj.getInputs(),null);
  Boolean[] flat=foreach.getToBeFlattened().toArray(new Boolean[0]);
  assertFalse(flat[0]);
  assertTrue(flat[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDepthFirstWalkerTree() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jill=new SillyOperator("jill",plan);
  SillyOperator jane=new SillyOperator("jane",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jill);
  plan.add(jane);
  plan.connect(fred,bob);
  plan.connect(fred,joe);
  plan.connect(joe,jill);
  plan.connect(joe,jane);
  SillyVisitor v=new SillyVisitor(plan,new DepthFirstWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  assertEquals("fredbobjoejilljane",s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRelationalEqualityNullSchemas() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LOLoad load7=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),null,lp,conf);
  lp.add(load7);
  LOLoad load8=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),null,lp,conf);
  lp.add(load8);
  assertTrue(load7.isEqual(load8));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlanEdgeInsert(){
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  PlanEdge edges=new PlanEdge();
  edges.put(fred,joe,0);
  Collection<Operator> c=edges.get(fred);
  assertEquals(1,c.size());
  Operator[] a=new Operator[1];
  Operator[] b=c.toArray(a);
  assertEquals(joe,b[0]);
  SillyOperator bob=new SillyOperator("bob",plan);
  edges.put(fred,bob);
  c=edges.get(fred);
  assertEquals(2,c.size());
  a=new Operator[2];
  b=c.toArray(a);
  assertEquals(joe,b[0]);
  assertEquals(bob,b[1]);
  SillyOperator jill=new SillyOperator("jill",plan);
  edges.put(fred,jill,1);
  c=edges.get(fred);
  assertEquals(3,c.size());
  a=new Operator[3];
  b=c.toArray(a);
  assertEquals(joe,b[0]);
  assertEquals(jill,b[1]);
  assertEquals(bob,b[2]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadEqualityDifferentFuncSpecCtorArgs() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LOLoad load2=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","z"})),aschema1,lp,conf);
  lp.add(load2);
  assertFalse(load1.isEqual(load2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRelationalEqualityDifferentSchema() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LogicalSchema aschema2=new LogicalSchema();
  aschema2.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.CHARARRAY));
  LOLoad load6=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","z"})),aschema2,lp,conf);
  lp.add(load6);
  assertFalse(load1.isEqual(load6));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadEqualityDifferentFunctionNames() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LOLoad load4=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","z"})),aschema1,lp,conf);
  lp.add(load4);
  assertFalse(load1.isEqual(load4));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadEqualityDifferentFileName() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LOLoad load5=newLOLoad(new FileSpec("/def",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","z"})),aschema1,lp,conf);
  lp.add(load5);
  assertFalse(load1.isEqual(load5));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDependencyOrderWalkerLinear() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.connect(fred,joe);
  plan.connect(joe,bob);
  SillyVisitor v=new SillyVisitor(plan,new DependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  assertEquals("fredjoebob",s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDepthFirstWalkerLinear() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.connect(fred,joe);
  plan.connect(joe,bob);
  SillyVisitor v=new SillyVisitor(plan,new DepthFirstWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  assertEquals("fredjoebob",s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoadEqualityDifferentNumFuncSpecCstorArgs() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LOLoad load3=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),"x")),aschema1,lp,conf);
  lp.add(load3);
  assertFalse(load1.isEqual(load3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReverseDependencyOrderWalkerLinear() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.connect(fred,joe);
  plan.connect(joe,bob);
  SillyVisitor v=new SillyVisitor(plan,new ReverseDependencyOrderWalker(plan));
  v.visit();
  String s=v.getVisitPattern();
  assertEquals("bobjoefred",s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRelationalEqualityOneNullOneNotNullSchema() throws FrontendException {
  LogicalPlan lp=new LogicalPlan();
  LogicalSchema aschema1=new LogicalSchema();
  aschema1.addField(new LogicalSchema.LogicalFieldSchema("x",null,DataType.INTEGER));
  LOLoad load1=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","y"})),aschema1,lp,conf);
  lp.add(load1);
  LOLoad load9=newLOLoad(new FileSpec("/abc",new FuncSpec(DummyLoad.class.getName(),new String[]{"x","z"})),null,lp,conf);
  lp.add(load9);
  assertFalse(load1.isEqual(load9));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPruneMapKeys </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan2() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(1,keys.size());
  assertEquals("name",keys.toArray(new String[0])[0]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan3() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate a#'age',b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(2,keys.size());
  assertTrue(keys.contains("name"));
  assertTrue(keys.contains("age"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan4() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate a#'age',a,b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "store b into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan5() throws Exception {
  String query="a =load 'd.txt' as (a:chararray, b:int, c:float);" + "b = filter a by a == 'hello';" + "c = foreach b generate a,b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertNull(annotation);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan6() throws Exception {
  String query="a =load 'd.txt';" + "b = filter a by $0 == 'hello';" + "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan7() throws Exception {
  String query="a =load 'd.txt';" + "a1 = load 'b.txt' as (a:map[],b:int, c:float);" + "b = join a by $0, a1 by a#'name';"+ "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  printPlan(newLogicalPlan);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(2,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan8() throws Exception {
  String query="a =load 'd.txt';" + "a1 = load 'b.txt' as (a:chararray,b:int, c:float);" + "b = join a by $0, a1 by a;"+ "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  printPlan(newLogicalPlan);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(2,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPushDownForeachFlatten </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachFRJoin2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = foreach C generate $0, $1, flatten($2);"+ "E = join B by $0, D by $0 using 'replicated';"+ "F = limit E 10;"+ "store F into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator limit=newLogicalPlan.getPredecessors(store).get(0);
  Operator join=newLogicalPlan.getPredecessors(limit).get(0);
  Assert.assertTrue(join instanceof LOJoin);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference);"+ "D = cross B, C;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * No foreach in the plan, no effect.
 */
@Test public void testErrorNonForeachInput() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "store A into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  List<Operator> nexts=newLogicalPlan.getSuccessors(load);
  Assert.assertTrue(nexts != null && nexts.size() == 1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachInnerJoin1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = load 'anotherfile' as (name, age, preference:(course_name, instructor));" + "C = foreach B generate $0, $1, flatten($2);"+ "D = join A by $0, C by $0;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This is actually a valid, positive test case. Cast doesn't prevent optimization.
 * @throws Exception
 */
@Test public void testForeachCastFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, (int)$1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0 using 'replicated';"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachRequiredField() throws Exception {
  String query="A = load 'myfile' as (b:bag{t:tuple(a0:chararray,a1:int)});" + "B = foreach A generate flatten($0);" + "C = order B by $1 desc;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator foreach1=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(foreach1 instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach1).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachWithUserDefinedSchema() throws Exception {
  String query="a = load '1.txt' as (a0:int, a1, a2:bag{t:(i1:int, i2:int)});" + "b = load '2.txt' as (b0:int, b1);" + "c = foreach a generate a0, flatten(a2) as (q1, q2);"+ "d = join c by a0, b by b0;"+ "store d into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOForEach foreach=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach.getSchema().getField(1).alias.equals("q1"));
  Assert.assertTrue(foreach.getSchema().getField(2).alias.equals("q2"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachUnion() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference);"+ "D = union B, C;"+ "store D into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator load=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   load=loads.get(0);
 else   load=loads.get(1);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachCogroup() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference);"+ "D = cogroup B by $0, C by $0;"+ "store D into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator load=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   load=loads.get(0);
 else   load=loads.get(1);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachForeach() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten(1);" + "C = foreach B generate $0;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
  foreach=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachNoFlatten() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, $2;" + "C = order B by $0, $1;"+ "D = store C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachNoSuccessors() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate flatten($1);" + "Store B into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachDistinct() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate flatten($1);" + "C = distinct B;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachJoinRequiredField() throws Exception {
  String query="A = load 'myfile' as (bg:bag{t:tuple(a0,a1)});" + "B = FOREACH A generate flatten($0);" + "C = load '3.txt' AS (c0, c1);"+ "D = JOIN B by a1, C by c1;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator limit=newLogicalPlan.getPredecessors(store).get(0);
  Operator join=newLogicalPlan.getPredecessors(limit).get(0);
  Assert.assertTrue(join instanceof LOJoin);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachInnerJoin2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = foreach C generate $0, $1, flatten($2);"+ "E = join B by $0, D by $0;"+ "F = limit E 10;"+ "store F into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator limit=newLogicalPlan.getPredecessors(store).get(0);
  Operator join=newLogicalPlan.getPredecessors(limit).get(0);
  Assert.assertTrue(join instanceof LOJoin);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachWithUserDefinedSchema2() throws Exception {
  String query="a = load '1.txt' as (a0:chararray);" + "b = load '2.txt' as (b0:chararray);" + "c = foreach b generate flatten(STRSPLIT(b0)) as c0;"+ "d = join c by (chararray)c0, a by a0;"+ "store d into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator op=newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(op instanceof LOJoin);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Cast should NOT matter to cross. This is a valid positive test case.
 */
@Test public void testForeachCastCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, (int)$1, flatten( $2 );" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = cross B, C;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * UDF doesn't prevent optimization.
 */
@Test public void testForeachUDFInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, flatten($1), " + Identity.class.getName() + "($2) ;"+ "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference);"+ "D = join B by $0, C by $0 using 'replicated';"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachCross2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = foreach C generate $0, $1, flatten($2);"+ "E = cross B, D;"+ "F = limit E 10;"+ "store F into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator limit=newLogicalPlan.getPredecessors(store).get(0);
  Operator cross=newLogicalPlan.getPredecessors(limit).get(0);
  Assert.assertTrue(cross instanceof LOCross);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachSortWithUserDefinedSchema() throws Exception {
  String query="a = load '1.txt' as (a0:int, a1:bag{t:(i1:int, i2:int)});" + "b = foreach a generate a0, flatten(a1) as (q1, q2);" + "c = order b by a0;"+ "store c into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlanWithPruning(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Assert.assertTrue("Field \"a1\" is dropped by ColumnMapKeyPrune" + "even though it should be stored",((LOLoad)load).getSchema().getField("a1") != null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachLimit() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = limit B 10;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * If the flattened field is referenced in the sort condition, then no optimization can be done.
 */
@Test public void testForeachSortNegative2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:tuple(x,y));" + "B = foreach A generate $0, $1, flatten($2);" + "C = order B by $0, $3;"+ "D = store C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator foreach1=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(foreach1 instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach1).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachCross1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = load 'anotherfile' as (name, age, preference:(course_name, instructor));" + "C = foreach B generate $0, $1, flatten($2);"+ "D = cross A, C;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Valid positive test case, even though the benefit from the optimization is questionable. However, putting in additinal check for
 * this condition requires extra coding.
 */
@Test public void testForeachFlattenAddedColumnFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten(1);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0 using 'replicated';"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachStreaming() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate flatten($1);" + "C = stream B through `"+ "pc -l"+ "`;"+ "Store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This is actually a valid, positive test case. UDF doesn't prevent optimization.
 * @throws Exception
 */
@Test public void testForeachUDFFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, flatten($1), " + Identity.class.getName() + "($2) ;"+ "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0 using 'replicated';"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Non-pure-projection, not optimizable.
 */
@Test public void testForeachSortNegative1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0 + 5, $1, flatten($2);" + "C = order B by $0, $1;"+ "D = store C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachFilter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = filter B by $1 < 18;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOuterJoin() throws Exception {
  String query="A = load 'A.txt' as (id:chararray, value:double);" + "B = load 'B.txt' as (id:chararray, name:chararray);" + "t1 = group A by id;"+ "t2 = foreach t1 { r1 = filter $1 by (value>1); r2 = limit r1 1; generate group as id, FLATTEN(r2.value) as value; }"+ "t3 = join B by id LEFT OUTER, t2 by id;"+ "store t3 into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  Operator join=newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(join instanceof LOJoin);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachSplitOutput() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "split B into C if $1 < 18, D if $1 >= 18;"+ "store C into 'output1';"+ "store D into 'output2';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = order B by $0, $1;"+ "D = store C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator sort=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(sort instanceof LOSort);
  Operator foreach=newLogicalPlan.getSuccessors(sort).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachCastSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate (chararray)$0, $1, flatten($2);" + "C = order B by $0, $1;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This is a valid, positive test case. Optimization should go thru.
 */
@Test public void testForeachUDFCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, flatten($1), " + Identity.class.getName() + "($2) ;"+ "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = cross B, C;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachUDFSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, " + Identity.class.getName() + "($2) ;"+ "C = order B by $0, $1;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This actually is a valid case, even though the optimization may not provide any performance benefit. However, detecting 
 * such a case requires more coding. Thus, we allow optimization to go thru in this case.
 */
@Test public void testForeachFlattenAddedColumnCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten(1);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = cross B, C;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachFRJoin1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = load 'anotherfile' as (name, age, preference:(course_name, instructor));" + "C = foreach B generate $0, $1, flatten($2);"+ "D = join A by $0, C by $0 using 'replicated';"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Cast doesn't prevent optimization.
 */
@Test public void testForeachCastInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, (int)$1, flatten($2);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachGroupBy() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten($2);" + "C = group B by $0;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)foreach));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNonDeterministicUdf() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, RANDOM(), flatten($2);" + "C = order B by $0, $1;"+ "D = store C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testForeachFlattenAddedColumnSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = foreach A generate $0, $1, flatten(1);" + "C = order B by $0, $1;"+ "store C into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator load=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(load instanceof LOLoad);
  Operator foreach=newLogicalPlan.getSuccessors(load).get(0);
  Assert.assertTrue(foreach instanceof LOForEach);
  Operator sort=newLogicalPlan.getSuccessors(foreach).get(0);
  Assert.assertTrue(sort instanceof LOSort);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This is actually a valid positive test case, even though the benefit of such optimization is questionable. However, 
 * checking for such condition requires additional coding effort.
 */
@Test public void testForeachFlattenAddedColumnInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa:(letter_grade, point_score));" + "B = foreach A generate $0, $1, flatten(1);" + "C = load 'anotherfile' as (name, age, preference:(course_name, instructor));"+ "D = join B by $0, C by $0;"+ "E = limit D 10;"+ "store E into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(!OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOForEach);
  Assert.assertTrue(OptimizerUtils.hasFlatten((LOForEach)op));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPushUpFilter </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionGroupByOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0 outer;" + "C = filter B by 1 == 1;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = order A by $1, $2;" + "C = filter B by " + MyFilterFunc.class.getName() + "($1) ;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOSort);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionCogroupOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0 outer;"+ "D = filter C by 1 == 1;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator cogrpA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(cogrpA instanceof LOCogroup);
  Operator cogrpB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(cogrpB instanceof LOCogroup);
  Assert.assertTrue(cogrpB == cogrpA);
  Operator store=newLogicalPlan.getSuccessors(cogrpA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterInnerJoinNegative() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0;"+ "D = filter C by $4 < 'name' AND $0 == 'joe';"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=newLogicalPlan.getSuccessors(loads.get(0)).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(loads.get(1)).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCogroup() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0;"+ "D = filter C by $0 < 'name';"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator cogrpA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(cogrpA instanceof LOCogroup);
  Operator cogrpB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(cogrpB instanceof LOCogroup);
  Assert.assertTrue(cogrpB == cogrpA);
  Operator store=newLogicalPlan.getSuccessors(cogrpA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterFRJoin1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0 using 'replicated';"+ "D = filter C by $4 < 'name';"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionCogroup() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0;"+ "D = filter C by 1 == 1;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator cogrpA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(cogrpA instanceof LOCogroup);
  Operator cogrpB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(cogrpB instanceof LOCogroup);
  Assert.assertTrue(cogrpB == cogrpA);
  Operator store=newLogicalPlan.getSuccessors(cogrpA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0;"+ "D = filter C by $0 < 'name';"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFInnerJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0;"+ "D = filter C by " + MyFilterFunc.class.getName() + "() ;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cascading joins. First one has outer, but filter should be able to push up above the second one, but below
 * the first one.
 */
@Test public void testFullOutJoin1() throws Exception {
  String query="A = load 'myfile' as (d1:int);" + "B = load 'anotherfile' as (d2:int);" + "C = join A by d1 full outer, B by d2;"+ "D = load 'xxx' as (d3:int);"+ "E = join C by d1, D by d3;"+ "F = filter E by d1 > 5;"+ "G = store F into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> ops=newLogicalPlan.getSinks();
  Assert.assertTrue(ops.size() == 1);
  Operator op=ops.get(0);
  Assert.assertTrue(op instanceof LOStore);
  Operator join=newLogicalPlan.getPredecessors(op).get(0);
  Assert.assertTrue(join instanceof LOJoin);
  ops=newLogicalPlan.getPredecessors(join);
  Assert.assertEquals(2,ops.size());
  Assert.assertTrue(ops.get(0) instanceof LOFilter || ops.get(1) instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFullOutJoin() throws Exception {
  String query="A = load 'myfile' as (d1:int);" + "B = load 'anotherfile' as (d2:int);" + "c = join A by d1 full outer, B by d2;"+ "d = filter c by d2 is null;"+ "store d into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSinks().get(0);
  Assert.assertTrue(op instanceof LOStore);
  op=newLogicalPlan.getPredecessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0 using 'replicated';"+ "D = filter C by 1 == 1;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFCogroup() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0;"+ "D = filter C by " + MyFilterFunc.class.getName() + "($1) ;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator cogroupA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(cogroupA instanceof LOCogroup);
  Operator cogroupB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(cogroupB instanceof LOCogroup);
  Operator filter=newLogicalPlan.getSuccessors(cogroupA).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  filter=newLogicalPlan.getSuccessors(cogroupB).get(0);
  Assert.assertTrue(cogroupB instanceof LOCogroup);
  Assert.assertTrue(cogroupB == cogroupA);
  Operator store=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterLoad() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = filter A by $1 < 18;" + "store B into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFFRJoin1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0 using 'replicated';"+ "D = filter C by TupleSize(*) > 5;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=newLogicalPlan.getSuccessors(loads.get(0)).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(loads.get(1)).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cross A, B;"+ "D = filter C by $5 < 18;"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterInnerJoin2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0;"+ "D = filter C by $0 < 'jonh' OR $1 > 50;"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = order A by $1, $2;" + "C = filter B by 1 == 1;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOSort);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterGroupBy() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0;" + "C = filter B by $0 < 'name';"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterDistinct() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = distinct A;" + "C = filter B by $1 < 18;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LODistinct);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0 using 'replicated';"+ "D = filter C by " + MyFilterFunc.class.getName() + "();"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterStreaming() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = stream A through `" + "ps -u"+ "`;"+ "C = filter B by $1 < 18;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStream);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterSort() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = order A by $1, $2;" + "C = filter B by $1 < 18;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOSort);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFGroupBy() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0;" + "C = filter B by " + MyFilterFunc.class.getName() + "($1) ;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCross2() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cross A, B;"+ "D = filter C by $1 < 18 and $5 < 18;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator op=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFUnion() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = union A, B;"+ "D = filter C by " + MyFilterFunc.class.getName() + "() ;"+ "E = STORE D into'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator unionA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(unionA instanceof LOUnion);
  Operator unionB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(unionB instanceof LOUnion);
  Assert.assertTrue(unionB == unionA);
  Operator store=newLogicalPlan.getSuccessors(unionA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cross A, B;"+ "D = filter C by " + MyFilterFunc.class.getName() + "($0) ;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterInnerJoin1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0;"+ "D = filter C by $4 < 'name';"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("B"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionCross() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cross A, B;"+ "D = filter C by 1 == 1;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator op=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCross1() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cross A, B;"+ "D = filter C by $1 < 18;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCross);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFCogroupOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0 outer;"+ "D = filter C by " + MyFilterFunc.class.getName() + "() ;"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator cogroupA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(cogroupA instanceof LOCogroup);
  Operator cogroupB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(cogroupB instanceof LOCogroup);
  Operator filter=newLogicalPlan.getSuccessors(cogroupA).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  filter=newLogicalPlan.getSuccessors(cogroupB).get(0);
  Assert.assertTrue(filter instanceof LOFilter);
  Assert.assertTrue(cogroupB == cogroupA);
  Operator store=newLogicalPlan.getSuccessors(filter).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionGroupBy() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0;" + "C = filter B by 1 == 1;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterSplitOutput() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "split A into B if $1 < 18, C if $1 >= 18;" + "C = filter B by $1 < 10;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOSplit);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOSplitOutput);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterCogroupOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = cogroup A by $0, B by $0 outer;"+ "D = filter C by $0 < 'name';"+ "E = STORE D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator cogrpA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(cogrpA instanceof LOCogroup);
  Operator cogrpB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(cogrpB instanceof LOCogroup);
  Assert.assertTrue(cogrpB == cogrpA);
  Operator store=newLogicalPlan.getSuccessors(cogrpA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionDistinct() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = distinct A;" + "C = filter B by 1 == 1;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LODistinct);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUnion() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = union A, B;"+ "D = filter C by $1 < 18;"+ "E = STORE D into'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator unionA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(unionA instanceof LOUnion);
  Operator unionB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(unionB instanceof LOUnion);
  Assert.assertTrue(unionB == unionA);
  Operator store=newLogicalPlan.getSuccessors(unionA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterConstantConditionUnion() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = union A, B;"+ "D = filter C by 1 == 1;"+ "E = STORE D into'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator loadA=null;
  Operator loadB=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A")) {
    loadA=loads.get(0);
    loadB=loads.get(1);
  }
 else {
    loadA=loads.get(1);
    loadB=loads.get(0);
  }
  Operator filterA=newLogicalPlan.getSuccessors(loadA).get(0);
  Assert.assertTrue(filterA instanceof LOFilter);
  Operator filterB=newLogicalPlan.getSuccessors(loadB).get(0);
  Assert.assertTrue(filterB instanceof LOFilter);
  Operator unionA=newLogicalPlan.getSuccessors(filterA).get(0);
  Assert.assertTrue(unionA instanceof LOUnion);
  Operator unionB=newLogicalPlan.getSuccessors(filterB).get(0);
  Assert.assertTrue(unionB instanceof LOUnion);
  Assert.assertTrue(unionB == unionA);
  Operator store=newLogicalPlan.getSuccessors(unionA).get(0);
  Assert.assertTrue(store instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterFilter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = filter A by $0 != 'name';" + "C = filter B by $1 < 18;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  Assert.assertTrue(((LOFilter)op).getAlias().equals("B"));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  Assert.assertTrue(((LOFilter)op).getAlias().equals("C"));
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFGroupByOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0 outer;" + "C = filter B by " + MyFilterFunc.class.getName() + "($1) ;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFDistinct() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = distinct A;" + "C = filter B by " + MyFilterFunc.class.getName() + "($1) ;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LODistinct);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorNonFilterInput() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);store A into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
  Assert.assertTrue(newLogicalPlan.getSuccessors(op) == null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterLimit() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = limit A 10;" + "C = filter B by $1 < 18;"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterGroupByOuter() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = group A by $0 outer;" + "C = filter B by $0 < 'name';"+ "D = STORE C into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSources().get(0);
  Assert.assertTrue(op instanceof LOLoad);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOCogroup);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOutJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name);" + "C = join A by name LEFT OUTER, B by name;"+ "D = filter C by B::name is null;"+ "store D into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  Operator op=newLogicalPlan.getSinks().get(0);
  Assert.assertTrue(op instanceof LOStore);
  op=newLogicalPlan.getPredecessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterFRJoin() throws Exception {
  String query="A = load 'myfile' as (name, age, gpa);" + "B = load 'anotherfile' as (name, age, preference);" + "C = join A by $0, B by $0 using 'replicated';"+ "D = filter C by $0 < 'name';"+ "E = limit D 10;"+ "F = STORE E into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> loads=newLogicalPlan.getSources();
  Assert.assertTrue(loads.size() == 2);
  Assert.assertTrue(loads.get(0) instanceof LOLoad);
  Assert.assertTrue(loads.get(1) instanceof LOLoad);
  Operator op=null;
  if (((LOLoad)loads.get(0)).getAlias().equals("A"))   op=loads.get(0);
 else   op=loads.get(1);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOFilter);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOJoin);
  op=newLogicalPlan.getSuccessors(op).get(0);
  Assert.assertTrue(op instanceof LOLimit);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanRule </h4><pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiNode() throws Exception {
  Operator l3=new OP_Load("p3",plan);
  Operator f5=new OP_Filter("f5",plan);
  plan.add(l3);
  plan.add(f5);
  plan.connect(l3,f5);
  plan.connect(f5,join);
  OperatorPlan pattern=new SillyPlan();
  Operator op1=new OP_Load("mmm1",pattern);
  Operator op2=new OP_Filter("mmm2",pattern);
  Operator op3=new OP_Join("mmm3",pattern);
  pattern.add(op1);
  pattern.add(op2);
  pattern.add(op3);
  pattern.connect(op1,op3);
  pattern.connect(op2,op3);
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(1,l.size());
  OperatorPlan match=l.get(0);
  assertEquals(3,match.size());
  assertEquals(1,match.getSinks().size());
  assertEquals(join,match.getSinks().get(0));
  assertEquals(2,match.getSources().size());
  assertTrue(match.getSources().get(0).getClass().equals(OP_Load.class) || match.getSources().get(0).equals(f5));
  assertTrue(match.getSources().get(1).getClass().equals(OP_Load.class) || match.getSources().get(1).equals(f5));
  assertNotSame(match.getSources().get(0),match.getSources().get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleNodeMatch() throws FrontendException {
  OperatorPlan pattern=new SillyPlan();
  pattern.add(new OP_Load("mmm",pattern));
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(2,l.size());
  Operator m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("p1") || m1.getName().equals("p2"));
  assertEquals(1,l.get(0).size());
  Operator m2=l.get(1).getSources().get(0);
  assertTrue(m2.getName().equals("p1") || m2.getName().equals("p2"));
  assertEquals(1,l.get(1).size());
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Filter("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(4,l.size());
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("f1") || m1.getName().equals("f2") || m1.getName().equals("f3")|| m1.getName().equals("f4"));
  assertEquals(1,l.get(0).size());
  m2=l.get(1).getSources().get(0);
  assertTrue(m1.getName().equals("f1") || m1.getName().equals("f2") || m1.getName().equals("f3")|| m1.getName().equals("f4"));
  assertEquals(1,l.get(1).size());
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Store("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),2);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("s1") || m1.getName().equals("s2"));
  assertEquals(l.get(0).size(),1);
  m2=l.get(1).getSources().get(0);
  assertTrue(m2.getName().equals("s1") || m2.getName().equals("s2"));
  assertEquals(l.get(1).size(),1);
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Split("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("t1"));
  assertEquals(l.get(0).size(),1);
  pattern=new SillyPlan();
  pattern.add(new OP_Join("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("j1"));
  assertEquals(l.get(0).size(),1);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodeMatch() throws FrontendException {
  Operator f5=new OP_Filter("f5",plan);
  Operator f6=new OP_Filter("f6",plan);
  Operator s5=new OP_Store("s5",plan);
  Operator s6=new OP_Store("s6",plan);
  plan.add(f5);
  plan.add(f6);
  plan.add(s5);
  plan.add(s6);
  plan.connect(f5,s5);
  plan.connect(f6,s6);
  plan.connect(join,f5);
  plan.connect(join,f6);
  OperatorPlan pattern=new SillyPlan();
  Operator s1=new OP_Join("mmm1",pattern);
  Operator s2=new OP_Filter("mmm2",pattern);
  Operator s3=new OP_Filter("mmm3",pattern);
  Operator s4=new OP_Filter("mmm4",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.add(s4);
  pattern.connect(s1,s2);
  pattern.connect(s1,s3);
  pattern.connect(s1,s4);
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(3,l.get(0).getSinks().size());
  assertEquals(4,l.get(0).size());
  Operator m1, m2;
  m1=l.get(0).getSources().get(0);
  assertEquals("j1",m1.getName());
  for (int i=0; i < 3; i++) {
    m2=l.get(0).getSinks().get(i);
    assertTrue(m2.getName().equals("f1") || m2.getName().equals("f5") || m2.getName().equals("f6"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoNodeMatch() throws FrontendException {
  OperatorPlan pattern=new SillyPlan();
  pattern.add(new OP_Load("mmm1",pattern));
  pattern.add(new OP_Load("mmm2",pattern));
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(l.size(),1);
  assertEquals(l.get(0).getSources().size(),2);
  assertEquals(l.get(0).getSinks().size(),2);
  assertEquals(l.get(0).size(),2);
  Operator m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("p1") || m1.getName().equals("p2"));
  Operator m2=l.get(0).getSources().get(1);
  assertTrue(m2.getName().equals("p1") || m2.getName().equals("p2"));
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  Operator s1=new OP_Join("mmm1",pattern);
  Operator s2=new OP_Filter("mmm2",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.connect(s1,s2);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(1,l.get(0).getSinks().size());
  assertEquals(2,l.get(0).size());
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("j1"));
  m2=l.get(0).getSinks().get(0);
  assertTrue(m2.getName().equals("f1"));
  pattern=new SillyPlan();
  s1=new OP_Filter("mmm1",pattern);
  s2=new OP_Store("mmm2",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.connect(s1,s2);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(2,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(1,l.get(0).getSinks().size());
  pattern=new SillyPlan();
  s1=new OP_Load("mmm1",pattern);
  s2=new OP_Load("mmm2",pattern);
  Operator s3=new OP_Join("jjj",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.connect(s1,s3);
  pattern.connect(s2,s3);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  pattern=new SillyPlan();
  s1=new OP_Split("mmm1",pattern);
  s2=new OP_Filter("mmm2",pattern);
  s3=new OP_Filter("mmm3",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.connect(s1,s2);
  pattern.connect(s1,s3);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(2,l.get(0).getSinks().size());
  assertEquals(3,l.get(0).size());
  m1=l.get(0).getSources().get(0);
  assertEquals("t1",m1.getName());
  m2=l.get(0).getSinks().get(0);
  assertTrue(m2.getName().equals("f3") || m2.getName().equals("f4"));
  m2=l.get(0).getSinks().get(1);
  assertTrue(m2.getName().equals("f3") || m2.getName().equals("f4"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNullConstant </h4><pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testExplicitCast() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate (int)null, (double)null, (chararray)null, (map[])null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testArithExpressions() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate x + null, x * null, x / null, x - null, null % x, " + "y + null, y * null, y / null, y - null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 9; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinCond() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate (2 > 1? null : 1), ( 2 < 1 ? null : 1), (2 > 1 ? 1 : null), ( 2 < 1 ? 1 : null);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Object[] result=new Object[]{null,1,1,null};
  for (int i=0; i < 4; i++) {
    assertEquals(result[i],t.get(i));
  }
  pigServer.registerQuery("b = foreach a generate (null is null ? 1 : 2), ( null is not null ? 2 : 1);");
  it=pigServer.openIterator("b");
  t=it.next();
  for (int i=0; i < 2; i++) {
    assertEquals(1,t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testForeachGenerate() throws ExecException, IOException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate x, null, y, null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Object[] result=new Object[]{10,null,11.0,null};
  for (int i=0; i < 4; i++) {
    assertEquals(result[i],t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOuterJoin() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo_left",tuple(10,"will_join"),tuple(11,"will_not_join"));
  data.set("foo_right",tuple(10,"will_join"),tuple(12,"will_not_join"));
  pigServer.registerQuery("a = load 'foo_left' using mock.Storage() as (x:int, y:chararray);");
  pigServer.registerQuery("b = load 'foo_right' using mock.Storage() as (u:int, v:chararray);");
  pigServer.registerQuery("c = cogroup a by x, b by u;");
  pigServer.registerQuery("d = foreach c generate flatten((SIZE(a) == 0 ? null: a)), flatten((SIZE(b) == 0 ? null : b));");
  Iterator<Tuple> it=pigServer.openIterator("d");
  Object[][] results=new Object[][]{{10,"will_join",10,"will_join"},{11,"will_not_join",null},{null,12,"will_not_join"}};
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Object[] result=results[i++];
    assertEquals(result.length,t.size());
    for (int j=0; j < result.length; j++) {
      assertEquals(result[j],t.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testComplexNullConstants() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate {(null)}, ['2'#null];");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  assertNull(((DataBag)t.get(0)).iterator().next().get(0));
  assertNull(((Map<String,Object>)t.get(1)).get("2"));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testConcatAndSize() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate SIZE(null), CONCAT(str, null), " + "CONCAT(null, str);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOptimizeLimit </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testOPLimit2Optimizer() throws Exception {
  String query="A = load 'myfile';" + "B = limit A 10;" + "C = limit B 100;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan2.dot");
  Assert.assertTrue(((LOLoad)newLogicalPlan.getSources().get(0)).getLimit() == 10);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testOPLimit5Optimizer() throws Exception {
  String query="A = load 'myfile1';" + "B = foreach A generate $0;" + "C = limit B 100;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan5.dot");
  Assert.assertTrue(((LOLoad)newLogicalPlan.getSources().get(0)).getLimit() == 100);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testOPLimit10Optimizer() throws Exception {
  String query="A = load 'myfile' AS (s:chararray);" + "B = limit A 100;" + "C = GROUP B by $0;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan10.dot");
  Assert.assertTrue(((LOLoad)newLogicalPlan.getSources().get(0)).getLimit() == 100);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLimitSoftLink() throws Exception {
  String query="A = LOAD 'data1.txt' AS (owner:chararray,pet:chararray,age:int,phone:chararray);" + "B = group A all; " + "C = foreach B generate SUM(A.age) as total; "+ "D = foreach A generate owner, age/(double)C.total AS percentAge; "+ "F = LIMIT D C.total/8;"+ "store F into 'output';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  LOStore store=(LOStore)newLogicalPlan.getSinks().get(0);
  LOForEach foreach1=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  LOLimit limit=(LOLimit)newLogicalPlan.getPredecessors(foreach1).get(0);
  Assert.assertTrue(newLogicalPlan.getSoftLinkPredecessors(limit).get(0) instanceof LOStore);
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testOPLimit6Optimizer() throws Exception {
  String query="A = load 'myfile';" + "B = limit A 50;" + "C = limit B 20;"+ "D = limit C 100;"+ "store D into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan6.dot");
  Assert.assertTrue(((LOLoad)newLogicalPlan.getSources().get(0)).getLimit() == 20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOrderBy </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByGroup() throws Exception {
  tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 100; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerQuery("a = load 'file:" + tmpFile + "' as (f1:int);");
  pig.registerQuery("b = group a by $0;");
  pig.registerQuery("c = order b by group;");
  Iterator<Tuple> iter=pig.openIterator("c");
  int count=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(count,tuple.get(0));
    count++;
  }
  assertEquals(count,100);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByDateTimeColumn() throws Exception {
  File tmpFile=genDataSetFileForOrderByDateTimeColumn();
  List<Tuple> expectedResults=new ArrayList<Tuple>();
  expectedResults.add(Util.buildTuple("value3",null));
  expectedResults.add(Util.buildTuple("value4",null));
  expectedResults.add(Util.buildTuple("value10",null));
  expectedResults.add(Util.buildTuple("value2",new DateTime("1970-01-01T00:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value6",new DateTime("1970-01-01T00:00:01.000Z")));
  expectedResults.add(Util.buildTuple("value7",new DateTime("1970-01-01T00:00:01.000Z")));
  expectedResults.add(Util.buildTuple("value1",new DateTime("1970-01-01T00:01:00.000Z")));
  expectedResults.add(Util.buildTuple("value5",new DateTime("1970-01-01T01:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value8",new DateTime("1970-01-02T00:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value9",new DateTime("1970-02-01T00:00:00.000Z")));
  pig.registerQuery("blah = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' as (data:chararray, test:datetime);");
  pig.registerQuery("ordered = order blah by test;");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("ordered");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByBooleanColumn() throws Exception {
  File tmpFile=genDataSetFileForOrderByBooleanColumn();
  List<Tuple> expectedResults=new ArrayList<Tuple>();
  expectedResults.add(Util.buildTuple("value3",null));
  expectedResults.add(Util.buildTuple("value4",null));
  expectedResults.add(Util.buildTuple("value10",null));
  expectedResults.add(Util.buildTuple("value2",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value6",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value7",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value1",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value5",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value8",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value9",Boolean.TRUE));
  pig.registerQuery("blah = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' as (data:chararray, test:boolean);");
  pig.registerQuery("ordered = order blah by test;");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("ordered");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOBinCond </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithLong() throws ExecException, PlanException {
  bag=getBag(DataType.LONG);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.LONG,new Long(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Long value=(Long)t.get(0);
    int expected=(value.longValue() == 1L) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondLongWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.LONG);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.LONG,new Long(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Long value=null;
    if (t.get(0) != null) {
      value=(Long)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithFloat() throws ExecException, PlanException {
  bag=getBag(DataType.FLOAT);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.FLOAT,new Float(1.0f));
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    testHelper.getPlan().attachInput(t);
    Float value=(Float)t.get(0);
    int expected=(value.floatValue() == 1.0f) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithInteger() throws ExecException, PlanException {
  bag=getBag(DataType.INTEGER);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.INTEGER,new Integer(1));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Integer value=(Integer)t.get(0);
    int expected=(value.intValue() == 1) ? 1 : 0;
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDoubleWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DOUBLE);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DOUBLE,new Double(1.0));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Double value=null;
    if (t.get(0) != null) {
      value=(Double)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithDateTime() throws ExecException, PlanException {
  bag=getBag(DataType.DATETIME);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DATETIME,new DateTime(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    DateTime value=(DateTime)t.get(0);
    int expected=value.equals(new DateTime(1L)) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondIntWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.INTEGER);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.INTEGER,new Integer(1));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Integer value=null;
    Integer result;
    if (t.get(0) != null) {
      value=(Integer)t.get(0);
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
 else {
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
    int actual;
    if (value != null) {
      int expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithBoolean() throws ExecException, PlanException {
  bag=getBag(DataType.BOOLEAN);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.BOOLEAN,Boolean.TRUE);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    testHelper.getPlan().attachInput(t);
    Boolean value=(Boolean)t.get(0);
    int expected=(value.booleanValue() == true) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithDouble() throws ExecException, PlanException {
  bag=getBag(DataType.DOUBLE);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DOUBLE,new Double(1.0));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Double value=(Double)t.get(0);
    int expected=(value.doubleValue() == 1.0) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDateTimeWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DATETIME);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DATETIME,new DateTime(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    DateTime value=null;
    if (t.get(0) != null) {
      value=(DateTime)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=value.equals(new DateTime(1L)) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOCast </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringToOther() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.CHARARRAY);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append((new Boolean(r.nextBoolean())).toString());
    plan.attachInput(t);
    String str=(String)t.get(0);
    Boolean b=null;
    if (str.equalsIgnoreCase("true")) {
      b=Boolean.TRUE;
    }
 else     if (str.equalsIgnoreCase("false")) {
      b=Boolean.FALSE;
    }
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
    t=tf.newTuple();
    t.append("neither true nor false");
    plan.attachInput(t);
    res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(null,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Integer(r.nextInt())).toString());
    plan.attachInput(t);
    Integer i=Integer.valueOf(((String)t.get(0)));
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Float(r.nextFloat())).toString());
    plan.attachInput(t);
    Float i=Float.valueOf(((String)t.get(0)));
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Long(r.nextLong())).toString());
    plan.attachInput(t);
    Long i=Long.valueOf(((String)t.get(0)));
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new Double(r.nextDouble())).toString());
    plan.attachInput(t);
    Double i=Double.valueOf(((String)t.get(0)));
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append((new DateTime(r.nextLong())).toString());
    plan.attachInput(t);
    DateTime i=new DateTime(t.get(0));
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i.getMillis(),((DateTime)res.result).getMillis());
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i.getMillis(),((DateTime)res.result).getMillis());
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    String str=(String)t.get(0);
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((String)t.get(0)).getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBooleanToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextBoolean());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=(Boolean)t.get(0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Boolean)t.get(0)) ? Integer.valueOf(1) : Integer.valueOf(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Boolean)t.get(0)) ? Long.valueOf(1L) : Long.valueOf(0L);
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Boolean)t.get(0)) ? Float.valueOf(1.0F) : Float.valueOf(0.0F);
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Boolean)t.get(0)) ? Double.valueOf(1.0D) : Double.valueOf(0.0D);
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Boolean)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Boolean)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BAG);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataBag b=(DataBag)t.get(0);
    Result res=op.getNextDataBag();
    assertEquals(b,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:float)}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Float);
        assertTrue(((Float)(expectedBagTuple.get(1))).floatValue() == (Float)(convertedBagTuple.get(1)));
      }
    }
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Integer);
        assertTrue(((Integer)(expectedBagTuple.get(1))) == (Integer)(convertedBagTuple.get(1)));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloatToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0F : r.nextFloat());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.FLOAT);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Float)t.get(0)) != 0.0F);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Float)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Float)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Float)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Float)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Float)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Float)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Float)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float result=(Float)op.getNextFloat().result;
      assertEquals(null,result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0L : r.nextLong());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.LONG);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Long)t.get(0)) != 0L);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Long)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Long)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Long)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Long)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(t.get(0));
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Long)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Long)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0 : r.nextInt());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.INTEGER);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf((Integer)t.get(0) != 0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=(Integer)t.get(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Integer)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Integer)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Integer)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Integer)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Integer)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Integer)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0D : r.nextDouble());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DOUBLE);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Double)t.get(0)) != 0.0D);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Double)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Double)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Double)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Double)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Double)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Double)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Double)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testByteArrayToOther() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BYTEARRAY);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Boolean(r.nextBoolean())).toString().getBytes()));
    plan.attachInput(t);
    String str=((DataByteArray)t.get(0)).toString();
    Boolean b=null;
    if (str.equalsIgnoreCase("true")) {
      b=Boolean.TRUE;
    }
 else     if (str.equalsIgnoreCase("false")) {
      b=Boolean.FALSE;
    }
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Integer(r.nextInt())).toString().getBytes()));
    plan.attachInput(t);
    Integer i=Integer.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Float(r.nextFloat())).toString().getBytes()));
    plan.attachInput(t);
    Float i=Float.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Long(r.nextLong())).toString().getBytes()));
    plan.attachInput(t);
    Long i=Long.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Double(r.nextDouble())).toString().getBytes()));
    plan.attachInput(t);
    Double i=Double.valueOf(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new DateTime(r.nextLong())).toString().getBytes()));
    plan.attachInput(t);
    DateTime i=new DateTime(((DataByteArray)t.get(0)).toString());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    String str=((DataByteArray)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    DataByteArray dba=(DataByteArray)t.get(0);
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextMap();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextTuple();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray(GenRandomData.genRandString(r).getBytes()));
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(null,res.result);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.TUPLE);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Result res=op.getNextTuple();
    assertEquals(t,res.result);
    planToTestBACasts.attachInput(tNew);
    res=opWithInputTypeAsBA.getNextTuple();
    assertEquals(t,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(tNew);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(GenRandomData.genRandString(r));
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    assertTrue(res.result == null);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(GenRandomData.genRandString(r));
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    verifyResult(res,POStatus.STATUS_OK,wrappedTuple);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(null);
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    verifyResult(res,POStatus.STATUS_OK,wrappedTuple);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testByteArrayToOtherNoCast() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan plan=constructPlan(op);
  TupleFactory tf=TupleFactory.getInstance();
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Boolean input=new Boolean(r.nextBoolean());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
    t=tf.newTuple();
    t.append("neither true nor false");
    plan.attachInput(t);
    res=newOp.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(null,res.result);
    }
  }
{
    Tuple t=tf.newTuple();
    Integer input=new Integer(r.nextInt());
    t.append(input);
    plan.attachInput(t);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Float input=new Float(r.nextFloat());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Long input=new Long(r.nextLong());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Double input=new Double(r.nextDouble());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    DateTime input=new DateTime(r.nextLong());
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Tuple input=GenRandomData.genRandSmallTuple("test",1);
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    DataBag input=GenRandomData.genRandSmallTupDataBag(r,10,100);
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextDataBag();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
{
    POCast newOp=new POCast(new OperatorKey("",r.nextLong()),-1);
    plan=constructPlan(newOp);
    Tuple t=tf.newTuple();
    Map<String,Object> input=new HashMap<String,Object>();
    input.put("key1","value1");
    input.put("key2","value2");
    t.append(input);
    plan.attachInput(t);
    Result res=newOp.getNextMap();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(input,res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapToOther() throws IOException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.MAP);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    plan.attachInput(t);
    Map map=(Map)t.get(0);
    Result res=op.getNextMap();
    assertEquals(map,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextMap();
    assertEquals(map,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandMap(r,10));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateTimeToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? new DateTime(0L) : new DateTime(r.nextLong()));
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DATETIME);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=null;
    Result res=op.getNextBoolean();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=new Long(((DateTime)t.get(0)).getMillis()).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=new Float(Long.valueOf(((DateTime)t.get(0)).getMillis()).floatValue());
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=new Long(((DateTime)t.get(0)).getMillis());
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=new Double(Long.valueOf(((DateTime)t.get(0)).getMillis()).doubleValue());
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=(DateTime)t.get(0);
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((DateTime)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((DateTime)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullToOther() throws PlanException, ExecException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=TupleFactory.getInstance().newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Boolean result=(Boolean)op.getNextBoolean().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.INTEGER);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.FLOAT);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DOUBLE);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double result=(Double)op.getNextDouble().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DATETIME);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      DateTime result=(DateTime)op.getNextDateTime().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.CHARARRAY);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      String result=(String)op.getNextString().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.BYTEARRAY);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Integer(r.nextInt())).toString().getBytes()));
    plan.attachInput(t);
    if (t.get(0) == null) {
      DataByteArray result=(DataByteArray)op.getNextString().result;
      assertEquals(null,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValueTypesChanged() throws IOException {
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    if (i % 6 == 0)     t.append(r.nextBoolean());
    if (i % 6 == 1)     t.append(r.nextInt());
    if (i % 6 == 2)     t.append(r.nextLong());
    if (i % 6 == 3)     t.append(r.nextDouble());
    if (i % 6 == 4)     t.append(r.nextFloat());
    if (i % 6 == 5)     t.append(r.nextLong());
    bag.add(t);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    planToTestBACasts.attachInput(t);
    Object toCast=t.get(0);
    Boolean b=DataType.toBoolean(toCast);
    Result res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    Integer i=DataType.toInteger(toCast);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    Long l=DataType.toLong(toCast);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    Float f=DataType.toFloat(toCast);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    Double d=DataType.toDouble(toCast);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    if (!(toCast instanceof Boolean)) {
      DateTime dt=DataType.toDateTime(toCast);
      res=opWithInputTypeAsBA.getNextDateTime();
      if (res.returnStatus == POStatus.STATUS_OK) {
        assertEquals(dt,res.result);
      }
    }
    String s=DataType.toString(toCast);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(s,res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOGenerate </h4><pre class="type-13 type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testJoin() throws Exception {
  ExpressionOperator prj1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  ExpressionOperator prj2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  prj1.setResultType(DataType.BAG);
  prj2.setResultType(DataType.BAG);
  List<Boolean> toBeFlattened=new LinkedList<Boolean>();
  toBeFlattened.add(true);
  toBeFlattened.add(true);
  PhysicalPlan plan1=new PhysicalPlan();
  plan1.add(prj1);
  PhysicalPlan plan2=new PhysicalPlan();
  plan2.add(prj2);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  inputs.add(plan1);
  inputs.add(plan2);
  PhysicalOperator poGen=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toBeFlattened);
  for (  Tuple t : cogroup) {
    poGen.attachInput(t);
    Result output=poGen.getNextTuple();
    while (output.result != null && output.returnStatus != POStatus.STATUS_EOP) {
      Tuple tObtained=(Tuple)output.result;
      assertTrue(tObtained.get(0).toString().equals(tObtained.get(2).toString()));
      output=poGen.getNextTuple();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOMapLookUp </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapLookUp() throws PlanException, ExecException {
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  POMapLookUp op=new POMapLookUp(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(op);
  plan.add(prj);
  plan.connect(prj,op);
  for (int i=0; i < 10; i++) {
    map=GenRandomData.genRandMap(r,10);
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(map);
    for (    Map.Entry<String,Object> e : map.entrySet()) {
      op.setLookUpKey(e.getKey());
      plan.attachInput(t);
      Result res=op.getNextMap();
      assertEquals(e.getValue(),res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPONegative </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPONegFloat() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    Float expected=-(Float)t.get(0);
    Float output=(Float)pn.getNextFloat().result;
    assertEquals(expected,output);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPONegInt() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt());
    bag.add(t);
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.INTEGER);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.INTEGER);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    Integer expected=-(Integer)t.get(0);
    Integer output=(Integer)pn.getNextInteger().result;
    assertEquals(expected,output);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegLongAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Long output=(Long)pn.getNextLong().result;
      assertNull(output);
    }
 else {
      Long expected=-(Long)t.get(0);
      long output=(Long)pn.getNextLong().result;
      assertEquals(expected.longValue(),output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPONegDouble() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextDouble());
    bag.add(t);
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.DOUBLE);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.DOUBLE);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    Double expected=-(Double)t.get(0);
    Double output=(Double)pn.getNextDouble().result;
    assertEquals(expected,output);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegIntAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.INTEGER);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.INTEGER);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer output=(Integer)pn.getNextInteger().result;
      assertNull(output);
    }
 else {
      Integer expected=-(Integer)t.get(0);
      Integer output=(Integer)pn.getNextInteger().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPONegLong() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    Long expected=-(Long)t.get(0);
    long output=(Long)pn.getNextLong().result;
    assertEquals(expected.longValue(),output);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegFloatAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float output=(Float)pn.getNextFloat().result;
      assertNull(output);
    }
 else {
      Float expected=-(Float)t.get(0);
      Float output=(Float)pn.getNextFloat().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegDoubleAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextDouble());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.DOUBLE);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.DOUBLE);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double output=(Double)pn.getNextDouble().result;
      assertNull(output);
    }
 else {
      Double expected=-(Double)t.get(0);
      Double output=(Double)pn.getNextDouble().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAgg </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill1() throws Exception {
  Result res;
  for (long i=1; i <= 15; i++) {
    Tuple t=tuple(1,tuple(i));
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  assertFalse(spilled.isDone());
  res=partAggOp.getNextTuple();
  assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  expectedValues.add(tuple(1,tuple(120L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  parentPlan.endOfAllInput=true;
  res=partAggOp.getNextTuple();
  do {
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertTrue(expectedValues.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill2() throws Exception {
  Result res=null;
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  for (long i=1; i <= 2001; i++) {
    Tuple t=tuple(i,tuple(i));
    expectedValues.add(t);
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  long i=0;
  res=partAggOp.getNextTuple();
  do {
    assertFalse(spilled.isDone());
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    i++;
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertEquals(2002,i);
  assertTrue(expectedValues.isEmpty());
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlan </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlanMR </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOSort </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (null, 10)
 * (1, 8 )
 * (3, 8 )
 * (null,null)
 * (1, null)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1WithNull() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Sorting
 * (1, 10)
 * (3, 8)
 * (2, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (1, 10)
 * (2 ,8)
 * (3, 8)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(1);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(3);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(2);
  t3.append(8);
  input.add(t3);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),2);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Sorting
 * (1, 2)
 * (3, 5)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 5)
 * (3 ,8)
 * (1, 2)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(1);
  t1.append(2);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(3);
  t2.append(5);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(3);
  t3.append(8);
  input.add(t3);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),5);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 8 )
 * (1, null)
 * (1, 8 )
 * (null,null)
 * (null, 10)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2Null() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOSplit </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNegativeErrorAtInputProcessing() throws IOException {
  POCast cast=new POCast(new OperatorKey("",r.nextLong()),-1);
  POProject proj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  proj.setResultType(DataType.CHARARRAY);
  List<PhysicalOperator> inputs=new ArrayList<PhysicalOperator>();
  inputs.add(proj);
  cast.setInputs(inputs);
  Tuple tuple=TupleFactory.getInstance().newTuple(1);
  tuple.set(0,"1.2345");
  proj.attachInput(tuple);
  POSplit split=new POSplit(new OperatorKey("",r.nextLong()),-1);
  inputs=new ArrayList<PhysicalOperator>();
  inputs.add(cast);
  split.setInputs(inputs);
  PhysicalPlan pplan=new PhysicalPlan();
  POStore store=GenPhyOp.dummyPigStorageOp();
  pplan.add(store);
  split.addPlan(pplan);
  split.setParentPlan(pplan);
  Result res=split.getNextTuple();
  assertEquals("POSplit should fail when input processing fails.",res.returnStatus,POStatus.STATUS_ERR);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscaping() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputEscape.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult2.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGruntMultilineDefine() throws Exception {
  log.info("Starting test testGruntMultilineDefine()");
  File inputFile=Util.createFile(new String[]{"daniel\t10","jenny\t20"});
  File outputFile=File.createTempFile("tmp","");
  outputFile.delete();
  PigContext pc=new PigContext(ExecType.LOCAL,new Properties());
  String command="DEFINE process(input_file) returns data {\n" + "$data = load '$input_file' using PigStorage(',');};\n" + "b = process('" + Util.generateURI(inputFile.toString(),pc) + "');\n"+ "store b into '"+ Util.generateURI(outputFile.toString(),pc)+ "';"+ "quit\n";
  System.setProperty("jline.WindowsTerminal.directConsole","false");
  System.setIn(new ByteArrayInputStream(command.getBytes()));
  org.apache.pig.PigRunner.run(new String[]{"-x","local"},null);
  File[] partFiles=outputFile.listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.startsWith("part");
    }
  }
);
  String resultContent=Util.readFile(partFiles[0]);
  assertEquals(resultContent,"daniel\t10\njenny\t20\n");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMacroDef() throws Exception {
  log.info("Starting test testMacroDef() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input6.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult6.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileComboDuplicate() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFileDuplicates.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdnameAsParamDeclare() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputCmdnameAsParamDeclare.pig","sh \\$cmd.sh \\$date","\\$cmd.bat \\$date",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSameParamInMultipleFiles() throws Exception {
  log.info("Starting test testSameParamInMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile3.txt",basedir + "/ConfFile2.txt",basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamCurlySyntax() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input7.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult7.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParam() throws Exception {
  log.info("Starting test testCmdlineParam() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamPriortoDeclare() throws Exception {
  log.info("Starting test testCmdlineParamPriortoDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"param='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultCmdLnPriorDeclare.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionInFuncArgs() throws Exception {
  log.info("Starting test testSubstitutionInFuncArgs()");
  final String queryString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": $debug,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"$name\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  final String expectedString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": 5,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"TestRecord\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(queryString.getBytes("UTF-8"))));
  pigOStream=new FileWriter(basedir + "/output26.pig");
  String[] arg={"debug = '5'","name = 'TestRecord'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output26.pig");
  InputStream expected=new ByteArrayInputStream(expectedString.getBytes("UTF-8"));
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(expected));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareDefaultComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDefault.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexVals() throws Exception {
  log.info("Starting test testComplexVals() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input5.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"loadfile = /user/pig/tests/data/singlefile/textdoc.txt"};
  String[] argFiles={basedir + "/ConfFileComplexVal.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult3.txt");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithDollarSign() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDollarSign.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"filter=\"($0 == 'x') and ($1 == 'y')\""};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDollarSign.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommentWithParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputComment.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultComment.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamWithInlineCmd() throws Exception {
  log.info("Starting test testCmdlineParamWithInlineCmd() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=`perl -e \"print qq@20080228\\n20070101@\" | head -n 1`"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleCmdlineParam() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='092487'","date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand() throws Exception {
  log.info("Starting test testShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/input4.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDefault.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParamsFromMultipleFiles() throws Exception {
  log.info("Starting test testFileParamsFromMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt",basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinValue() throws Exception {
  log.info("Starting test  testSubstitutionWithinValue()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputSubstitutionWithinValue.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsinSingleLine() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstituteWithinLiteral() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParam() throws Exception {
  log.info("Starting test  testFileParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeclareScope() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleDeclares.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultMulDecs.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoVars() throws Exception {
  log.info("Starting test testNoVars() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputNoVars.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/inputNoVars.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinShellCommand() throws Exception {
  log.info("Starting test testSubstitutionWithinShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputSubstitutionWithinShellCommand.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGruntWithParamSub() throws Exception {
  log.info("Starting test testGruntWithParamSub()");
  File inputFile=Util.createFile(new String[]{"daniel\t10","jenny\t20"});
  File outputFile=File.createTempFile("tmp","");
  outputFile.delete();
  PigContext pc=new PigContext(ExecType.LOCAL,new Properties());
  String command="%default agelimit `echo 15`\n" + "rmf $outputFile;\n" + "a = load '" + Util.generateURI(inputFile.toString(),pc) + "' as ($param1:chararray, $param2:int);\n"+ "b = filter a by age > $agelimit;"+ "store b into '$outputFile';\n"+ "quit\n";
  System.setProperty("jline.WindowsTerminal.directConsole","false");
  System.setIn(new ByteArrayInputStream(command.getBytes()));
  org.apache.pig.PigRunner.run(new String[]{"-x","local","-p","param1=name","-p","param2=age","-p","outputFile=" + Util.generateURI(outputFile.toString(),pc)},null);
  File[] partFiles=outputFile.listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.startsWith("part");
    }
  }
);
  String resultContent=Util.readFile(partFiles[0]);
  assertEquals(resultContent,"jenny\t20\n");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsFromSingleFile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileSameParamMultipleTimes.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParser </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoteServerList() throws Exception {
  for (  ExecType execType : execTypes) {
    setUp(execType);
    Properties pigProperties=pigServer.getPigContext().getProperties();
    pigProperties.setProperty("fs.default.name","hdfs://a.com:8020");
    Configuration conf;
    Data data=Storage.resetData(pigServer.getPigContext());
    data.set("/user/pig/1.txt");
    pigServer.registerQuery("a = load '/user/pig/1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) == null || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.default.name")) || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.defaultFS")));
    pigServer.registerQuery("a = load 'hdfs://a.com/user/pig/1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS) == null || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.default.name")) || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.defaultFS")));
    pigServer.registerQuery("a = load 'har:///1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS) == null || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.default.name")) || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.defaultFS")));
    pigServer.registerQuery("a = load 'hdfs://b.com/user/pig/1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://b.com"));
    pigServer.registerQuery("a = load 'har://hdfs-c.com/user/pig/1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://c.com"));
    pigServer.registerQuery("a = load 'hdfs://d.com:8020/user/pig/1.txt' using mock.Storage;");
    conf=ConfigurationUtil.toConfiguration(pigProperties);
    assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://d.com:8020"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestrictedColumnNamesWhitelist() throws Exception {
  pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  Set<Tuple> tuples=Sets.newHashSet(tuple(1),tuple(2),tuple(3));
  data.set("foo","x:int",tuples);
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("a = foreach a generate x as rank;");
  pigServer.registerQuery("a = foreach a generate rank as cube;");
  pigServer.registerQuery("a = foreach a generate cube as y;");
  pigServer.registerQuery("rank = a;");
  pigServer.registerQuery("cube = rank;");
  pigServer.registerQuery("rank = cube;");
  pigServer.registerQuery("cube = foreach rank generate y as cube;");
  pigServer.registerQuery("store cube into 'baz' using mock.Storage();");
  List<Tuple> tuples2=data.get("baz");
  assertEquals(tuples.size(),tuples2.size());
  for (  Tuple t : tuples2) {
    tuples.remove(t);
  }
  assertTrue(tuples.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoteServerList2() throws Exception {
  pigServer=new PigServer(Util.getLocalTestMode());
  Properties pigProperties=pigServer.getPigContext().getProperties();
  pigProperties.setProperty("fs.default.name","hdfs://a.com:8020");
  Configuration conf;
  pigServer.setBatchOn();
  Data data=Storage.resetData(pigServer.getPigContext());
  data.set("/user/pig/1.txt");
  pigServer.registerQuery("a = load '/user/pig/1.txt' using mock.Storage;");
  pigServer.registerQuery("store a into '/user/pig/1.txt';");
  System.out.println("hdfs-servers: " + pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  conf=ConfigurationUtil.toConfiguration(pigProperties);
  assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) == null || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.default.name")) || conf.get(MRConfiguration.JOB_HDFS_SERVERS).equals(pigProperties.get("fs.defaultFS")));
  pigServer.registerQuery("store a into 'hdfs://b.com/user/pig/1.txt' using mock.Storage;");
  System.out.println("hdfs-servers: " + pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  conf=ConfigurationUtil.toConfiguration(pigProperties);
  assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://b.com"));
  pigServer.registerQuery("store a into 'har://hdfs-c.com:8020/user/pig/1.txt' using mock.Storage;");
  System.out.println("hdfs-servers: " + pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  conf=ConfigurationUtil.toConfiguration(pigProperties);
  assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://c.com:8020"));
  pigServer.registerQuery("store a into 'hdfs://d.com:8020/user/pig/1.txt' using mock.Storage;");
  System.out.println("hdfs-servers: " + pigProperties.getProperty(MRConfiguration.JOB_HDFS_SERVERS));
  conf=ConfigurationUtil.toConfiguration(pigProperties);
  assertTrue(conf.get(MRConfiguration.JOB_HDFS_SERVERS) != null && conf.get(MRConfiguration.JOB_HDFS_SERVERS).contains("hdfs://d.com:8020"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPhyPatternMatch </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodePatternLinear() throws PlanException {
  PatternPlan ptPlan=new PatternPlan();
  PatternNode ptFilNode=createPtNode(ptPlan,POFilter.class);
  PatternNode ptFENode=createPtNode(ptPlan,POForEach.class);
  PatternNode ptStNode=createPtNode(ptPlan,POStore.class);
  ptPlan.connect(ptFilNode,ptFENode);
  ptPlan.connect(ptFENode,ptStNode);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
  assertEquals("null match",ptStNode.getMatch(),null);
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  pplan.connect(fil,fe);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POFilter fil2=new POFilter(getNewOpKey());
  pplan.add(fil2);
  pplan.connect(fil2,fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POStore store=new POStore(getNewOpKey());
  pplan.add(store);
  pplan.connect(fe,store);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("test match node",ptFilNode.getMatch(),fil);
  assertEquals("test match node",ptFENode.getMatch(),fe);
  assertEquals("test match node",ptStNode.getMatch(),store);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoNodePattern() throws PlanException {
  Class<?>[] nodes={POForEach.class,POFilter.class};
  PatternPlan ptPlan=PatternPlan.create(nodes);
  PatternNode ptFilNode=(PatternNode)ptPlan.getSinks().get(0);
  PatternNode ptFENode=(PatternNode)ptPlan.getSources().get(0);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  pplan.connect(fe,fil);
  assertTrue("plan matched",ptPlan.match(pplan));
  ptFilNode.setLeafNode(true);
  ptFENode.setSourceNode(true);
  assertTrue("plan matched",ptPlan.match(pplan));
  POStore store=new POStore(getNewOpKey());
  pplan.add(store);
  pplan.connect(fil,store);
  assertFalse("plan matched",ptPlan.match(pplan));
  ptFilNode.setLeafNode(false);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("filter pt node match",ptFilNode.getMatch(),fil);
  assertEquals("foreach pt node match",ptFENode.getMatch(),fe);
  POForEach fe2=new POForEach(getNewOpKey());
  pplan.add(fe2);
  pplan.connect(fe2,fe);
  assertFalse("plan matched",ptPlan.match(pplan));
  ptFENode.setSourceNode(false);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("filter pt node match",ptFilNode.getMatch(),fil);
  assertEquals("foreach pt node match",ptFENode.getMatch(),fe);
  PhysicalPlan pplan2=new PhysicalPlan();
  POFilter fil2=new POFilter(getNewOpKey());
  pplan.add(fil2);
  POForEach fe21=new POForEach(getNewOpKey());
  pplan.add(fe21);
  pplan.connect(fil2,fe21);
  assertFalse("plan not matched",ptPlan.match(pplan2));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodePatternTwoParents() throws PlanException, ExecException {
  PatternPlan ptPlan=new PatternPlan();
  PatternNode ptFilNode=createPtNode(ptPlan,POFilter.class);
  PatternNode ptFENode=createPtNode(ptPlan,POForEach.class);
  PatternNode ptJoinNode=createPtNode(ptPlan,POFRJoin.class);
  ptPlan.connect(ptFilNode,ptJoinNode);
  ptPlan.connect(ptFENode,ptJoinNode);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POFRJoin join=new POFRJoin(getNewOpKey(),0,null,new ArrayList<List<PhysicalPlan>>(),null,null,0,false,null);
  pplan.add(join);
  pplan.connect(fil,join);
  pplan.connect(fe,join);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("test match node",ptFilNode.getMatch(),fil);
  assertEquals("test match node",ptFENode.getMatch(),fe);
  assertEquals("test match node",ptJoinNode.getMatch(),join);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPi </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPi() throws Exception {
  pig.registerQuery("A = load 'foo' using mock.Storage() as (x:double, y:double);");
  pig.registerQuery("B = foreach A generate $0 - 0.5 as d1, $1 - 0.5 as d2;");
  pig.registerQuery("C = foreach B generate $0 * $0 as m1, $1 * $1 as m2;");
  pig.registerQuery("D = foreach C generate $0 + $1 as s1;");
  pig.registerQuery("D = foreach D generate $0, ARITY($0);");
  pig.registerQuery("E = filter D by $0 <= 0.25;");
  pig.registerQuery("F = cogroup D by $1, E by $1;");
  pig.registerQuery("G = foreach F generate COUNT($1) as total, COUNT($2) as in_circle;");
  Iterator<Tuple> values=pig.openIterator("G");
  assertTrue(values.hasNext());
  Tuple finalValues=values.next();
  int totalPoints=DataType.toInteger(finalValues.get(0));
  int inCirclePoints=DataType.toInteger(finalValues.get(1));
  log.info("Value of PI = " + 4 * (double)inCircle / (double)total);
  log.info("Value of PI (From Test data) = " + 4 * (double)inCirclePoints / (double)totalPoints);
  Iterator<Tuple> lengthTest=pig.openIterator("D");
  while (lengthTest.hasNext()) {
    Tuple temp=lengthTest.next();
    totalLengthTest+=temp.get(0).toString().length();
  }
  assertEquals(totalPoints,total);
  assertEquals(inCirclePoints,inCircle);
  assertEquals(totalLengthTest,totalLength);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigContext </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportList() throws Exception {
  String FILE_SEPARATOR=System.getProperty("file.separator");
  File tmpDir=File.createTempFile("test","");
  tmpDir.delete();
  tmpDir.mkdir();
  File udf1Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf1");
  udf1Dir.mkdirs();
  File udf2Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf2");
  udf2Dir.mkdirs();
  String udf1Src=new String("package com.xxx.udf1;\n" + "import java.io.IOException;\n" + "import org.apache.pig.EvalFunc;\n"+ "import org.apache.pig.data.Tuple;\n"+ "public class TestUDF1 extends EvalFunc<Integer>{\n"+ "public Integer exec(Tuple input) throws IOException {\n"+ "return 1;}\n"+ "}");
  String udf2Src=new String("package com.xxx.udf2;\n" + "import org.apache.pig.builtin.PigStorage;\n" + "public class TestUDF2 extends PigStorage { }\n");
  JavaCompilerHelper javaCompilerHelper=new JavaCompilerHelper();
  javaCompilerHelper.compile(tmpDir.getAbsolutePath(),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf1.TestUDF1",udf1Src),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf2.TestUDF2",udf2Src));
  String jarName="TestUDFJar.jar";
  String jarFile=tmpDir.getAbsolutePath() + FILE_SEPARATOR + jarName;
  int status=Util.executeJavaCommand("jar -cf " + jarFile + " -C "+ tmpDir.getAbsolutePath()+ " "+ "com");
  assertEquals(0,status);
  Util.resetStateForExecModeSwitch();
  PigContext localPigContext=new PigContext(cluster.getExecType(),properties);
  localPigContext.getProperties().setProperty("pig.additional.jars",jarFile);
  PigServer pigServer=new PigServer(localPigContext);
  PigContext.initializeImportList("com.xxx.udf1:com.xxx.udf2.");
  ArrayList<String> importList=PigContext.getPackageImportList();
  assertEquals(6,importList.size());
  assertEquals("",importList.get(0));
  assertEquals("com.xxx.udf1.",importList.get(1));
  assertEquals("com.xxx.udf2.",importList.get(2));
  assertEquals("java.lang.",importList.get(3));
  assertEquals("org.apache.pig.builtin.",importList.get(4));
  assertEquals("org.apache.pig.impl.builtin.",importList.get(5));
  Object udf=PigContext.instantiateFuncFromSpec("TestUDF1");
  assertTrue(udf.getClass().toString().endsWith("com.xxx.udf1.TestUDF1"));
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  tmpFile.delete();
  String clusterTmpPath=Util.removeColon(tmpFile.getCanonicalPath());
  String localInput[]=new String[LOOP_COUNT];
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    localInput[i]=Integer.toString(rand);
  }
  Util.createInputFile(cluster,clusterTmpPath,localInput);
  FileLocalizer.deleteTempFiles();
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterTmpPath) + "' using TestUDF2() AS (num:chararray);");
  pigServer.registerQuery("B = foreach A generate TestUDF1(num);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.get(0) instanceof Integer);
    assertEquals(Integer.valueOf(1),(Integer)t.get(0));
  }
  Util.deleteFile(cluster,clusterTmpPath);
  Util.deleteDirectory(tmpDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigRunner </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = limit B 1;");
  w.println("dump C;");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.toString().startsWith("tez")) {
      assertEquals(1,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),1);
    }
 else {
      assertEquals(2,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),2);
    }
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void simpleNegativeTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,"-c",PIG_FILE};
  PigStats stats=PigRunner.run(args,null);
  assertTrue(stats.getReturnCode() == ReturnCode.PIG_EXCEPTION);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void returnCodeTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load 'non-existine.file' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 > 0;;");
  w.println("C = group B by $0;");
  w.println("D = join C by $0, B by $0;");
  w.println("store D into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() != 0);
    assertTrue(stats.getOutputStats().size() == 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    if (execType.equals("tez")) {
      assertEquals(outputs.get(0).getNumberRecords(),5);
      assertEquals(outputs.get(1).getNumberRecords(),2);
    }
 else {
      for (      OutputStats outstats : outputs) {
        assertEquals(-1,outstats.getNumberRecords());
      }
    }
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(1,inputs.size());
    InputStats instats=inputs.get(0);
    assertEquals(5,instats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 < 0;");
  w1.println("store A into '" + OUTPUT_FILE + "';");
  w1.println("store B into 'output2';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("output2")) {
        assertEquals(0,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"output2");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void fsCommandTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("fs -mv nonexist.file dummy.file");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() == PigRunner.ReturnCode.IO_EXCEPTION);
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void streamNegativeTest() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ temporarily as it hangs",Util.isMapredExecType(cluster.getExecType()));
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate 1;");
  w.println("C = foreach A generate 0/0;");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.println("store C into '" + OUTPUT_FILE_2 + "';");
  w.println("D = load '" + OUTPUT_FILE_2 + "';");
  w.println("E = stream D through `false`;");
  w.println("store E into 'ee';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    if (execType.equals("tez")) {
      assertTrue(stats.getReturnCode() == ReturnCode.FAILURE);
      assertTrue(stats.getJobGraph().size() == 1);
      JobStats job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        assertTrue(!output.isSuccessful());
      }
    }
 else {
      assertTrue(stats.getReturnCode() == ReturnCode.PARTIAL_FAILURE);
      assertTrue(stats.getJobGraph().size() == 2);
      JobStats job=(JobStats)stats.getJobGraph().getSources().get(0);
      assertTrue(job.isSuccessful());
      job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        if (output.getName().equals("ee")) {
          assertTrue(!output.isSuccessful());
        }
 else {
          assertTrue(output.isSuccessful());
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCounterName() throws Exception {
  String s="jdbc:hsqldb:file:/tmp/batchtest;hsqldb.default_table_type=cached;hsqldb.cache_rows=100";
  String name=MRPigStatsUtil.getMultiInputsCounterName(s,0);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_0_batchtest",name);
  s="file:///tmp/batchtest{1,2}.txt";
  name=MRPigStatsUtil.getMultiInputsCounterName(s,1);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_1_batchtest{1,2}.txt",name);
  s="file:///tmp/batchtest*.txt";
  name=MRPigStatsUtil.getMultiInputsCounterName(s,2);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_2_batchtest*.txt",name);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorLogFile() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate StringSize(a0);");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    Properties props=stats.getPigProperties();
    String logfile=props.getProperty("pig.logfile");
    File f=new File(logfile);
    assertTrue(f.exists());
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Dopt.fetch=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(!conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    final int numOfRecords=5;
    final int numOfCharsPerRecord=6;
    assertEquals(numOfRecords,stats.getRecordWritten());
    assertEquals(numOfRecords * numOfCharsPerRecord,stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(3,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.close();
  Util.copyFromLocalToCluster(cluster,"myinputfile","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '1.txt' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("1.txt")) {
        assertEquals(0,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    if (execType.equals("tez")) {
      assertEquals(5,inputs.get(0).getNumberRecords());
      assertEquals(5,inputs.get(1).getNumberRecords());
    }
 else {
      for (      InputStats instats : inputs) {
        assertEquals(-1,instats.getNumberRecords());
      }
    }
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(1,outputs.size());
    OutputStats outstats=outputs.get(0);
    assertEquals(9,outstats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void classLoaderTest() throws Exception {
  if (org.apache.pig.impl.util.Utils.isHadoop23() || org.apache.pig.impl.util.Utils.isHadoop2())   return;
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("register test/org/apache/pig/test/data/pigtestloader.jar");
  w.println("A = load '" + INPUT_FILE + "' using org.apache.pig.test.PigTestLoader();");
  w.println("store A into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  String longfilename="longlonglonglonglonglonglonglonglonglonglonglongfilefilefilename";
  Util.copyFromLocalToCluster(cluster,"myinputfile",longfilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + longfilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      assertEquals(5,instats.getNumberRecords());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void MQDepJobFailedTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (name:chararray, a1:int, a2:int);");
  w.println("store A into '" + OUTPUT_FILE_2 + "';");
  w.println("B = FOREACH A GENERATE org.apache.pig.test.utils.UPPER(name);");
  w.println("C= order B by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    Iterator<JobStats> iter=stats.getJobGraph().iterator();
    while (iter.hasNext()) {
      JobStats js=iter.next();
      if (execType.equals("tez")) {
        assertEquals(js.getState().name(),"FAILED");
      }
 else {
        if (js.getState().name().equals("FAILED")) {
          List<Operator> ops=stats.getJobGraph().getSuccessors(js);
          for (          Operator op : ops) {
            assertEquals(((JobStats)op).getState().toString(),"UNKNOWN");
          }
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void returnCodeTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load 'non-existine.file' as (a0, a1);");
  w.println("B = load 'data' as (b0, b1);");
  w.println("C = join B by b0, A by a0 using 'repl';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() != 0);
    assertTrue(stats.getOutputStats().size() == 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * PIG-2780: In this test case, Pig submits three jobs at the same time and
 * one of them will fail due to nonexistent input file. If users enable
 * stop.on.failure, then Pig should immediately stop if anyone of the three
 * jobs has failed.
 */
@Test public void testStopOnFailure() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A1 = load '" + INPUT_FILE + "';");
  w1.println("B1 = load 'nonexist';");
  w1.println("C1 = load '" + INPUT_FILE + "';");
  w1.println("A2 = distinct A1;");
  w1.println("B2 = distinct B1;");
  w1.println("C2 = distinct C1;");
  w1.println("ret = union A2,B2,C2;");
  w1.println("store ret into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,"-F",PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(!stats.isSuccessful());
    int successfulJobs=0;
    Iterator<Operator> it=stats.getJobGraph().getOperators();
    while (it.hasNext()) {
      JobStats js=(JobStats)it.next();
      if (js.isSuccessful())       successfulJobs++;
    }
    assertTrue("Should have less than 2 successful jobs",successfulJobs < 2);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorLogFile2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate StringSize(a0);");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-M","-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    Properties props=stats.getPigProperties();
    if (props != null) {
      String logfile=props.getProperty("pig.logfile");
      File f=new File(logfile);
      assertTrue(f.exists());
    }
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void scriptsInDfsTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  Util.copyFromLocalToCluster(cluster,PIG_FILE,PIG_FILE);
  Path inputInDfs=new Path(cluster.getFileSystem().getHomeDirectory(),PIG_FILE);
  try {
    String[] args={"-x",execType,inputInDfs.toString()};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,PIG_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetHadoopCounters() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    String TASK_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.TaskCounter" : MRPigStatsUtil.TASK_COUNTER_GROUP;
    String FS_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.FileSystemCounter" : MRPigStatsUtil.FS_COUNTER_GROUP;
    if (execType.equals("tez")) {
      Counters counter=((JobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("INPUT_RECORDS_PROCESSED").getValue());
      assertEquals(2,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(7,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("OUTPUT_RECORDS").getValue());
      assertEquals(20,counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      assertEquals(new File(INPUT_FILE).length(),counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
 else {
      Counters counter=((MRJobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_INPUT_RECORDS).getValue());
      assertEquals(3,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_OUTPUT_RECORDS).getValue());
      assertEquals(2,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(0,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_OUTPUT_RECORDS).getValue());
      assertEquals(20,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      if (Util.isHadoop203plus())       return;
      assertEquals(30,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFile() throws IOException {
  File f1=new File(PIG_FILE);
  FileWriter fw1=new FileWriter(f1);
  fw1.close();
  try {
    String[] args={"-x","local","-c",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(0,stats.getReturnCode());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest3() throws Exception {
  final String INPUT_FILE_2="input2";
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE_2));
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  Util.copyFromLocalToCluster(cluster,INPUT_FILE_2,INPUT_FILE_2);
  new File(INPUT_FILE_2).delete();
  w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("A1 = load '" + INPUT_FILE_2 + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = filter A by a1 <=5;");
  w.println("D = join C by a0, B by a0, A1 by a0 using 'replicated';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.println("store D into '" + OUTPUT_FILE_2 + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(3,stats.getJobGraph().size());
    }
 else {
      assertEquals(1,stats.getJobGraph().size());
    }
    final int numOfRecords1=3;
    final int numOfRecords2=4;
    final int numOfBytesWritten1=18;
    final int numOfBytesWritten2=72;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals(numOfBytesWritten1 + numOfBytesWritten2,stats.getBytesWritten());
    List<String> outputNames=new ArrayList<String>(stats.getOutputNames());
    assertTrue(outputNames.size() == 2);
    Collections.sort(outputNames);
    assertEquals(OUTPUT_FILE,outputNames.get(0));
    assertEquals(OUTPUT_FILE_2,outputNames.get(1));
    assertEquals(3,stats.getNumberRecords(OUTPUT_FILE));
    assertEquals(4,stats.getNumberRecords(OUTPUT_FILE_2));
    List<InputStats> inputStats=new ArrayList<InputStats>(stats.getInputStats());
    assertTrue(inputStats.size() == 2);
    Collections.sort(inputStats,new Comparator<InputStats>(){
      @Override public int compare(      InputStats o1,      InputStats o2){
        return o1.getLocation().compareTo(o2.getLocation());
      }
    }
);
    assertEquals(5,inputStats.get(0).getNumberRecords());
    assertEquals(3,inputStats.get(1).getNumberRecords());
    if (!Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(30,inputStats.get(0).getBytes());
      assertEquals(18,inputStats.get(1).getBytes());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,INPUT_FILE_2);
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest2() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(stats.getJobGraph().size(),1);
    final int numOfRecords1=2;
    final int numOfRecords2=2;
    final int numOfCharsPerRecord1=6;
    final int numOfCharsPerRecord2=4;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals((numOfRecords1 * numOfCharsPerRecord1) + (numOfRecords2 * numOfCharsPerRecord2),stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(2,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C,D,E",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleNegativeTest3() throws Exception {
  String[] args={"-x",execType,"-c","-y"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  assertTrue(stats.getReturnCode() == ReturnCode.PARSE_EXCEPTION);
  assertEquals("Found unknown option (-y) at position 4",stats.getErrorMessage());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTempFile() throws Exception {
  PigContext context=new PigContext(Util.getLocalTestMode(),new Properties());
  context.connect();
  for (int i=0; i < 100; i++) {
    String file=FileLocalizer.getTemporaryPath(context).toString();
    assertTrue("not a temp file: " + file,PigStatsUtil.isTempFile(file));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterExternalJar() throws Exception {
  String jarName=Util.findPigJarName();
  String[] args={"-Dpig.additional.jars=" + jarName,"-Dmapred.job.queue.name=default","-x",execType,"-e","A = load '" + INPUT_FILE + "';store A into '"+ OUTPUT_FILE+ "';\n"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  Util.deleteFile(cluster,OUTPUT_FILE);
  PigContext ctx=stats.getPigContext();
  assertNotNull(ctx);
  assertTrue(ctx.extraJars.contains(ClassLoader.getSystemResource(jarName)));
  assertTrue("default",ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME) != null && ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME).equals("default") || ctx.getProperties().getProperty("mapreduce.job.queuename") != null && ctx.getProperties().getProperty("mapreduce.job.queuename").equals("default"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("tmp/output")) {
        assertEquals(2,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void orderByTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = order A by a0;");
  w.println("C = limit B 2;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,PIG_FILE};
  try {
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.equals("tez")) {
      assertEquals(stats.getJobGraph().size(),1);
      assertEquals(stats.getJobGraph().getSources().get(0).getPlan().size(),5);
    }
 else {
      assertEquals(stats.getJobGraph().size(),4);
    }
    assertTrue(stats.getJobGraph().getSinks().size() == 1);
    assertTrue(stats.getJobGraph().getSources().size() == 1);
    JobStats js=(JobStats)stats.getJobGraph().getSinks().get(0);
    assertEquals(OUTPUT_FILE,js.getOutputs().get(0).getName());
    assertEquals(2,js.getOutputs().get(0).getNumberRecords());
    assertEquals(12,js.getOutputs().get(0).getBytes());
    assertEquals(OUTPUT_FILE,stats.getOutputNames().get(0));
    assertEquals(2,stats.getRecordWritten());
    assertEquals(12,stats.getBytesWritten());
    if (execType.equals("tez")) {
      assertEquals("A,B",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
    }
 else {
      assertEquals("A",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
      assertEquals("B",((JobStats)stats.getJobGraph().getPredecessors(js).get(0)).getAlias());
      assertEquals("B",js.getAlias());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void simpleNegativeTest2() throws Exception {
  String[] args={"-x",execType,"-c","-e","this is a test"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  assertTrue(stats.getReturnCode() == ReturnCode.ILLEGAL_ARGS);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.close();
  String samefilename="tmp/input";
  Util.copyFromLocalToCluster(cluster,"myinputfile",samefilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + samefilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("tmp/input")) {
        assertEquals(2,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigScriptParser </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefineUDF() throws Exception {
  PigServer ps=new PigServer(ExecType.LOCAL);
  String inputData[]={"dshfdskfwww.xyz.com/sportsjoadfjdslpdshfdskfwww.xyz.com/sportsjoadfjdsl","kas;dka;sd","jsjsjwww.xyz.com/sports","jsdLSJDcom/sports","wwwJxyzMcom/sports"};
  File f=Util.createFile(inputData);
  String[] queryLines=new String[]{"define minelogs org.apache.pig.test.RegexGroupCount('www\\\\.xyz\\\\.com/sports');","A = load '" + Util.generateURI(f.getAbsolutePath(),ps.getPigContext()) + "'  using PigStorage() as (source : chararray);","B = foreach A generate minelogs(source) as sportslogs;"};
  for (  String line : queryLines) {
    ps.registerQuery(line);
  }
  Iterator<Tuple> it=ps.openIterator("B");
  int[] expectedResults=new int[]{2,0,1,0,0};
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals(expectedResults[i++],t.get(0));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUniquePigTempDir() throws Throwable {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  File pigTempDir=new File(tempDir,FILE_SEPARATOR + "tmp" + FILE_SEPARATOR+ "test");
  properties.put("pig.temp.dir",pigTempDir.getPath());
  PigContext pigContext=new PigContext(ExecType.LOCAL,properties);
  pigContext.connect();
  FileLocalizer.setInitialized(false);
  Random r=new Random(5);
  FileLocalizer.setR(r);
  String tempPath1=FileLocalizer.getTemporaryPath(pigContext).toString();
  FileLocalizer.setInitialized(false);
  r=new Random(5);
  FileLocalizer.setR(r);
  String tempPath2=FileLocalizer.getTemporaryPath(pigContext).toString();
  assertFalse(tempPath1.toString().equals(tempPath2.toString()));
  pigTempDir.delete();
  FileLocalizer.setInitialized(false);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigTempDir() throws Throwable {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  File pigTempDir=new File(tempDir,FILE_SEPARATOR + "tmp" + FILE_SEPARATOR+ "test");
  properties.put("pig.temp.dir",pigTempDir.getPath());
  PigContext pigContext=new PigContext(ExecType.LOCAL,properties);
  pigContext.connect();
  FileLocalizer.setInitialized(false);
  String tempPath=FileLocalizer.getTemporaryPath(pigContext).toString();
  Path path=new Path(tempPath);
  assertTrue(tempPath.startsWith(pigTempDir.toURI().toString()));
  FileSystem fs=FileSystem.get(path.toUri(),ConfigurationUtil.toConfiguration(pigContext.getProperties()));
  FileStatus status=fs.getFileStatus(path.getParent());
  assertEquals("rwx------",status.getPermission().toString());
  pigTempDir.delete();
  FileLocalizer.setInitialized(false);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterRemoteScript() throws Throwable {
  String scriptName="script.py";
  File scriptFile=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(new FileWriter(scriptFile));
  pw.println("@outputSchema(\"word:chararray\")\ndef helloworld():\n    return 'Hello, World'");
  pw.close();
  FileSystem fs=cluster.getFileSystem();
  fs.copyFromLocalFile(new Path(scriptFile.getAbsolutePath()),new Path(scriptName));
  String absPath=fs.getFileStatus(new Path(scriptName)).getPath().toString();
  Util.createInputFile(cluster,"testRegisterRemoteScript_input",new String[]{"1","2"});
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerCode(absPath,"jython","pig");
  pig.registerQuery("a = load 'testRegisterRemoteScript_input';");
  pig.registerQuery("b = foreach a generate pig.helloworld($0);");
  Iterator<Tuple> iter=pig.openIterator("b");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSecondarySort() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a",1,"b"),out.get(0));
  assertEquals(tuple("b",2,"c"),out.get(1));
  assertEquals(tuple("c",3,"d"),out.get(2));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParamSubstitution() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  Map<String,String> params=new HashMap<String,String>();
  params.put("input","test/org/apache/pig/test/data/passwd");
  File scriptFile=Util.createFile(new String[]{"a = load '$input' using PigStorage(':');"});
  pig.registerScript(scriptFile.getAbsolutePath(),params);
  Iterator<Tuple> iter=pig.openIterator("a");
  int index=0;
  List<Tuple> expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  List<String> paramFile=new ArrayList<String>();
  paramFile.add(Util.createFile(new String[]{"input=test/org/apache/pig/test/data/passwd2"}).getAbsolutePath());
  pig.registerScript(scriptFile.getAbsolutePath(),paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd2",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(scriptFile.getAbsolutePath(),params,paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonExistingSecondDirectoryInSkewJoin() throws Exception {
  String script="exists = LOAD 'test/org/apache/pig/test/data/InputFiles/jsTst1.txt' AS (x:chararray, a:long);" + "missing = LOAD '/non/existing/directory' AS (a:long);" + "missing = FOREACH ( GROUP missing BY a ) GENERATE $0 AS a, COUNT_STAR($1);"+ "joined = JOIN exists BY a, missing BY a USING 'skewed';"+ "STORE joined INTO '/tmp/test_out.tsv';";
  PigServer pig=new PigServer(Util.getLocalTestMode());
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
      fail("Expect front exception");
    }
 catch (    Exception ex) {
      Throwable excp=ex;
      assertTrue(excp instanceof FrontendException);
      excp=excp.getCause();
      assertTrue(excp instanceof VisitorException);
      excp=excp.getCause();
      assertTrue(excp instanceof ExecException);
      excp=excp.getCause();
      assertTrue(excp instanceof InvalidInputException);
    }
  }
 else {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
    }
 catch (    Exception ex) {
      fail("Unexpected exception: " + ex);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRegisterScriptFromStream() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  Map<String,String> params=new HashMap<String,String>();
  params.put("input","test/org/apache/pig/test/data/passwd");
  String script="a = load '$input' using PigStorage(':');";
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),params);
  Iterator<Tuple> iter=pig.openIterator("a");
  int index=0;
  List<Tuple> expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  List<String> paramFile=new ArrayList<String>();
  paramFile.add(Util.createFile(new String[]{"input=test/org/apache/pig/test/data/passwd2"}).getAbsolutePath());
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd2",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),params,paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testLocationStrictCheck() throws Exception {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  properties.setProperty("pig.location.check.strict","true");
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),properties);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("C = order A by f1,f2,f3;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a",1,"b"),out.get(0));
  assertEquals(tuple("b",2,"c"),out.get(1));
  assertEquals(tuple("c",3,"d"),out.get(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStats </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigScriptInConf() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("test.pig"));
  w.println("register /mydir/sath.jar");
  w.println("register /mydir/lib/hadoop-tools-0.20.201.0-SNAPSHOT.jar");
  w.println("register /mydir/lib/jackson-core-asl-1.4.2.jar");
  w.println("register /mydir/lib/jackson-mapper-asl-1.4.2.jar");
  w.close();
  Configuration conf=new Configuration();
  addSettingsToConf(conf,"test.pig");
  String s=conf.get("pig.script");
  String script=(String)ObjectSerializer.deserialize(s);
  String expected="register /mydir/sath.jar\n" + "register /mydir/lib/hadoop-tools-0.20.201.0-SNAPSHOT.jar\n" + "register /mydir/lib/jackson-core-asl-1.4.2.jar\n"+ "register /mydir/lib/jackson-mapper-asl-1.4.2.jar\n";
  assertEquals(expected,script);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJythonScriptInConf() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table'","output = 'simple_out'","P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  Util.createLocalInputFile("testScript.py",script);
  Configuration conf=new Configuration();
  addSettingsToConf(conf,"testScript.py");
  String s=conf.get("pig.script");
  String actual=(String)ObjectSerializer.deserialize(s);
  String expected="#!/usr/bin/python\n" + "from org.apache.pig.scripting import *\n" + "Pig.fs(\"rmr simple_out\")\n"+ "input = 'simple_table'\n"+ "output = 'simple_out'\n"+ "P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")\n"+ "Q = P.bind({'input':input, 'output':output})\n"+ "stats = Q.runSingle()\n"+ "if stats.isSuccessful():\n"+ "\tprint 'success!'\n"+ "else:\n"+ "\traise 'failed'\n";
  assertEquals(expected,actual);
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesWritten_JIRA_1027() throws Exception {
  File outputFile=null;
  try {
    String fileName=this.getClass().getName() + "_" + "testBytesWritten_JIRA_1027";
    outputFile=File.createTempFile(fileName,".out");
    String filePath=outputFile.getAbsolutePath();
    outputFile.delete();
    PigServer pig=new PigServer(Util.getLocalTestMode());
    pig.registerQuery("A = load 'test/org/apache/pig/test/data/passwd';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    File dataFile=Util.getFirstPartFile(outputFile);
    assertEquals(dataFile.length(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    if (outputFile != null) {
      deleteDirectory(outputFile);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStatsMR </h4><pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testBytesWritten_JIRA_1027() throws Exception {
  FileLocalizer.setInitialized(false);
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  try {
    String filePath="/tmp/" + this.getClass().getName() + "_"+ "testBytesWritten_JIRA_1027";
    PigServer pig=new PigServer(cluster.getExecType(),cluster.getProperties());
    String inputFile="test/org/apache/pig/test/data/passwd";
    Util.copyFromLocalToCluster(cluster,inputFile,inputFile);
    pig.registerQuery("A = load '" + inputFile + "';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    Path dataFile=Util.getFirstPartFile(new Path(filePath));
    FileStatus fs=cluster.getFileSystem().getFileStatus(dataFile);
    assertEquals(fs.getLen(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    FileLocalizer.setInitialized(false);
    cluster.shutDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  Schema origSchema=pig.dumpSchema("a");
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t');");
  Schema genSchema=pig.dumpSchema("b");
  Assert.assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
  String[] aliases={"foo","bar"};
  byte[] types={DataType.INTEGER,DataType.LONG};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  pig.registerQuery("c = LOAD '" + datadir + "aout' using PigStorage('\\t', '-schema') "+ "as (foo:int, bar:long);");
  Schema newGenSchema=pig.dumpSchema("c");
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,newGenSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is for testing source tagging option on PigStorage. When a user
 * specifies '-tagFile' as an option, PigStorage must prepend the input
 * source path to the tuple and "INPUT_FILE_NAME" to schema.
 * @throws Exception
 */
@Test public void testPigStorageSourceTagSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile');");
  Schema genSchema=pig.dumpSchema("b");
  String[] fileAliases={"INPUT_FILE_NAME","f1","f2"};
  byte[] fileTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(fileAliases,fileTypes);
  Assert.assertTrue("schema with -tagFile preprends INPUT_FILE_NAME",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagPath');");
  genSchema=pig.dumpSchema("b");
  String[] pathAliases={"INPUT_FILE_PATH","f1","f2"};
  byte[] pathTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(pathAliases,pathTypes);
  Assert.assertTrue("schema with -tagPath preprends INPUT_FILE_PATH",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile') "+ "as (input_file:chararray, foo:chararray, bar:int);");
  genSchema=pig.dumpSchema("b");
  String[] newAliases={"input_file","foo","bar"};
  byte[] newTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(newAliases,newTypes);
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,genSchema,true,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchemaHeaderDelimiter() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (foo:chararray, bar:int);";
  pig.registerQuery(query);
  pig.registerQuery("STORE a into '" + datadir + "dout' using PigStorage('#', '-schema');");
  pig.registerQuery("STORE a into '" + datadir + "eout' using PigStorage('\\t', '-schema');");
  String outPath=FileLocalizer.fullPath(datadir + "dout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  String[] header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo#bar"},header);
  outPath=FileLocalizer.fullPath(datadir + "eout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo\tbar"},header);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigStorageSchemaWithOverwrite() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);";
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A',1L)","('B',2L)","('C',3L)","('D',2L)","('A',5L)","('B',5L)","('C',8L)","('A',8L)","('D',8L)","('A',9L)"});
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage(',')");
  pig.store("a",datadir + "aout","PigStorage(',', '--overwrite true')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage(',');");
  Iterator<Tuple> iter=pig.openIterator("b");
  int counter=0;
  while (iter.hasNext()) {
    String tuple=iter.next().toString();
    Assert.assertEquals(expectedResults.get(counter++).toString(),tuple);
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchemaHeader() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (foo:chararray, bar:int);";
  pig.registerQuery(query);
  pig.registerQuery("a2 = FOREACH a GENERATE *, 1;");
  pig.registerQuery("STORE a2 into '" + datadir + "nout' using PigStorage('\\t', '-schema');");
  String outPath=FileLocalizer.fullPath(datadir + "nout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  String[] header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo\tbar\t$2"},header);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigStorageSourceTagValue() throws Exception {
  final String storeFileName="part-m-00000";
  pigContext.connect();
  String query="a = LOAD '" + datadir + "' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile');");
  pig.registerQuery("c = foreach b generate INPUT_FILE_NAME;");
  Iterator<Tuple> iter=pig.openIterator("c");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    String inputFileName=(String)tuple.get(0);
    assertEquals("tagFile value must be part-m-00000",inputFileName,storeFileName);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPruneColumnsWithSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t'); c = FOREACH b GENERATE f2;");
  Iterator<Tuple> it=pig.openIterator("c");
  Assert.assertTrue("results were produced",it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue("data is correct type",t.get(0) instanceof Integer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigTupleRawComparator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareMap() throws IOException {
  list=new ArrayList(list);
  list.add(Collections.singletonMap("pig","scalability"));
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,Collections.singletonMap("pig","scalability"));
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(list.size() - 1,Collections.singletonMap("pigg","scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(list.size() - 1,Collections.singletonMap("pig","Scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(list.size() - 1,Collections.singletonMap("pii","scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.add(107);
  t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,108);
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortOrder() throws IOException {
  list.set(2,(Double)list.get(2) + 0.1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  JobConf jobConf=new JobConf();
  jobConf.set("pig.sortOrder",ObjectSerializer.serialize(new boolean[]{false}));
  comparator.setConf(jobConf);
  int res=compareHelper(prototype,t,comparator);
  assertEquals(-1 * Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  jobConf.set("pig.sortOrder",ObjectSerializer.serialize(new boolean[]{true,true,false,true,true,true,true,true,true}));
  comparator.setConf(jobConf);
  res=compareHelper(prototype,t,comparator);
  assertEquals(-1 * Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEquals() throws IOException {
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareFloat() throws IOException {
  list.set(0,(Float)list.get(0) - 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDateTime() throws IOException {
  list.set(9,((DateTime)list.get(9)).plus(1L));
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDataBag() throws IOException {
  list=new ArrayList(list);
  list.add(new DefaultDataBag(Arrays.asList(tf.newTuple(Arrays.asList(0)))));
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,new DefaultDataBag(Arrays.asList(tf.newTuple(Arrays.asList(1)))));
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  DataBag largeBag=createLargeBag(200,tf);
  t2=new NullableTuple(tf.newTuple(largeBag));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  largeBag=createLargeBag(3000,tf);
  t2=new NullableTuple(tf.newTuple(largeBag));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareBoolean() throws IOException {
  list.set(5,false);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDiffertTypes() throws IOException {
  list.set(3,4);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomTuples() throws IOException {
  Random rand=new Random(SEED);
  for (int i=0; i < TUPLE_NUMBER; i++) {
    NullableTuple t=new NullableTuple(getRandomTuple(rand));
    int res=compareHelper(prototype,t,comparator);
    assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDouble() throws IOException {
  list.set(2,(Double)list.get(2) + 0.1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareCharArray() throws IOException {
  list.set(7,"hello world!");
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(7,"hello worlc!");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  String largeTinyString=appendChars("hello worlc!",'x',300);
  list.set(7,largeTinyString);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(7,"hello worlz!");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(7,"hello");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(7,"hello world!?");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareByte() throws IOException {
  list.set(4,(Byte)list.get(4) + 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compareInnerTuples() throws IOException {
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(8,tf.newTuple(Arrays.asList(8.0,9f,10l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(8,tf.newTuple(Arrays.asList(8.0,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(8,tf.newTuple(Arrays.asList(7.0,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  Tuple tinyTuple=createLargeTuple(1,200,tf);
  list.set(8,tinyTuple);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  Tuple smallTuple=createLargeTuple(1,1000,tf);
  list.set(8,smallTuple);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  list.set(8,tf.newTuple(Arrays.asList(8l,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list=new ArrayList(list);
  list.add(10);
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,11);
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(list.size() - 1,tf.newTuple(list));
  t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,10);
  list.set(list.size() - 1,tf.newTuple(list));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDifferentSizes() throws IOException {
  list=new ArrayList(list);
  list.add(new DefaultDataBag());
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareInt() throws IOException {
  list.set(1,(Integer)list.get(1) + 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompareByteArray() throws IOException {
  list.set(6,new DataByteArray(new byte[]{0x10,0x1a}));
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  list.set(6,new DataByteArray(new byte[]{0x20}));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  String largeTinyStr=appendChars("abc",'x',255 - 10);
  list.set(6,new DataByteArray(largeTinyStr));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  largeTinyStr=appendChars("",'x',255);
  list.set(6,new DataByteArray(largeTinyStr));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  String largeSmallStr=appendChars("abc",'x',65535 - 100);
  list.set(6,new DataByteArray(largeSmallStr));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  String largeStr=appendChars("abc",'x',65535 + 10000);
  list.set(6,new DataByteArray(largeStr));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPinOptions </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotPinnedJinOption() throws Exception {
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
  pigServer.registerQuery("b = load 'tmp1' as (foo, bar);");
  pigServer.registerQuery("c = join a by foo, b by foo;");
  pigServer.registerQuery("store c into 'tmp2';");
  LOJoin op=(LOJoin)TestPigStats.getLogicalPlan(pigServer).findByAlias("c");
  assertEquals("default join should be hash",((LOJoin)op).getJoinType().toString(),"HASH");
  assertFalse(op.isPinnedOption(LOJoin.OPTION_JOIN));
  pigServer.discardBatch();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGroupOptions() throws Exception {
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
  pigServer.registerQuery("b = group a by foo;");
  pigServer.registerQuery("store b into 'tmp2';");
  LOCogroup op=(LOCogroup)TestPigStats.getLogicalPlan(pigServer).findByAlias("b");
  assertFalse(op.isPinnedOption(LOCogroup.OPTION_GROUPTYPE));
  pigServer.discardBatch();
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load 'tmp' as (foo, bar);");
  pigServer.registerQuery("b = group a by foo using 'collected';");
  pigServer.registerQuery("store b into 'tmp2';");
  op=(LOCogroup)TestPigStats.getLogicalPlan(pigServer).findByAlias("b");
  assertTrue(op.isPinnedOption(LOCogroup.OPTION_GROUPTYPE));
  pigServer.discardBatch();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPinnedJoinOption() throws Exception {
  String[] joinTypes={"hash","repl","merge","skewed","default"};
  String[] expectedJoinTypes={"HASH","REPLICATED","MERGE","SKEWED","HASH"};
  for (int i=0; i < joinTypes.length; i++) {
    pigServer.setBatchOn();
    pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("b = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("c = join a by foo, b by foo using '" + joinTypes[i] + "';");
    pigServer.registerQuery("store c into 'tmp2';");
    LOJoin op=(LOJoin)TestPigStats.getLogicalPlan(pigServer).findByAlias("c");
    assertTrue("did " + joinTypes[i] + " join get pinned? ",op.isPinnedOption(LOJoin.OPTION_JOIN));
    assertEquals("did the right join type get set? ",((LOJoin)op).getJoinType().toString(),expectedJoinTypes[i]);
    pigServer.discardBatch();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPlanGeneration </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = order A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOSort loSort=(LOSort)lp.getPredecessors(loStore).get(0);
  Operator sortPlanLeaf=loSort.getSortColPlans().get(0).getSources().get(0);
  LogicalFieldSchema sortPlanFS=((LogicalExpression)sortPlanLeaf).getFieldSchema();
  assertNull(sortPlanFS);
  PhysicalPlan pp=Util.buildPhysicalPlanFromNewLP(lp,pc);
  POStore poStore=(POStore)pp.getLeaves().get(0);
  POSort poSort=(POSort)pp.getPredecessors(poStore).get(0);
  POProject poProject=(POProject)poSort.getSortPlans().get(0).getLeaves().get(0);
  assertEquals(DataType.TUPLE,poProject.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBagInnerPlan() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A { B1 = filter u by $1==0; generate B1;};" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertNull(tupleFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyTupleDereference() throws Exception {
  String query="A = load 'x' as ( u:tuple() );" + "B = foreach A generate u.$100;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  assertEquals(DataType.BYTEARRAY,schema.getField(0).type);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testStoreAlias() throws Exception {
  String query="A = load 'data' as (a0, a1);" + "B = filter A by a0 > 1;" + "store B into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  assertEquals("B",loStore.getAlias());
  PhysicalPlan pp=Util.buildPhysicalPlanFromNewLP(lp,pc);
  POStore poStore=(POStore)pp.getLeaves().get(0);
  assertEquals("B",poStore.getAlias());
  MROperPlan mrp=Util.buildMRPlanWithOptimizer(pp,pc);
  MapReduceOper mrOper=mrp.getLeaves().get(0);
  poStore=(POStore)mrOper.mapPlan.getLeaves().get(0);
  assertEquals("B",poStore.getAlias());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testEmptyBagDereference() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A generate u.$100;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertEquals(1,tupleFieldSchema.schema.size());
  assertEquals(DataType.BYTEARRAY,tupleFieldSchema.schema.getField(0).type);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = group A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOCogroup loCoGroup=(LOCogroup)lp.getPredecessors(loStore).get(0);
  LogicalFieldSchema groupFieldSchema=loCoGroup.getSchema().getField(0);
  assertEquals(DataType.TUPLE,groupFieldSchema.type);
  assertNull(groupFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionFilterOptimizer() throws Exception {
  String query="a = load 'foo' using " + PartitionedLoader.class.getName() + "('name:chararray, dt:chararray', 'dt');\n"+ "b = filter a by dt=='2011';\n"+ "store b into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOLoad loLoad=(LOLoad)lp.getSources().get(0);
  LOStore loStore=(LOStore)lp.getSuccessors(loLoad).get(0);
  assertNotNull(((PartitionedLoader)loLoad.getLoadFunc()).getPartFilter());
  assertEquals("b",loStore.getAlias());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLoaderWithSchema() throws Exception {
  String query="a = load 'foo' using " + SchemaLoader.class.getName() + "('name,age,gpa');\n"+ "b = filter a by age==20;"+ "store b into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOLoad loLoad=(LOLoad)lp.getSources().get(0);
  LOFilter loFilter=(LOFilter)lp.getSuccessors(loLoad).get(0);
  LOStore loStore=(LOStore)lp.getSuccessors(loFilter).get(0);
  assertNull(lp.getSuccessors(loStore));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGenerateStar() throws Exception {
  String query="a = load 'x';" + "b = foreach a generate *;" + "store b into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  assertNull(loForEach.getSchema());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPoissonSampleLoader </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstantiation() throws IOException {
  pigServer.registerQuery("A = Load '" + INPUT_FILE1 + "' Using PoissonSampleLoader('PigStorage(\\\\\\':\\\\\\')', '100');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  while (iter.hasNext()) {
    t=iter.next();
  }
  assertEquals(5,t.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPredeployedJar </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPredeployedJar() throws IOException, ClassNotFoundException {
  Logger logger=Logger.getLogger(JobControlCompiler.class);
  logger.removeAllAppenders();
  logger.setLevel(Level.INFO);
  SimpleLayout layout=new SimpleLayout();
  File logFile=File.createTempFile("log","");
  FileAppender appender=new FileAppender(layout,logFile.toString(),false,false,0);
  logger.addAppender(appender);
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getConfiguration());
  pigServer.getPigContext().getProperties().put(PigConfiguration.PIG_OPT_FETCH,"false");
  String[] inputData=new String[]{"hello","world"};
  Util.createInputFile(cluster,"a.txt",inputData);
  String jodaTimeJar=JarManager.findContainingJar(org.joda.time.DateTime.class);
  pigServer.registerQuery("a = load 'a.txt' as (line:chararray);");
  Iterator<Tuple> it=pigServer.openIterator("a");
  String content=FileUtils.readFileToString(logFile);
  Assert.assertTrue(content.contains(jodaTimeJar));
  logFile=File.createTempFile("log","");
  pigServer.getPigContext().markJarAsPredeployed(jodaTimeJar);
  it=pigServer.openIterator("a");
  content=FileUtils.readFileToString(logFile);
  Assert.assertFalse(content.contains(jodaTimeJar));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPruneColumn </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2:int);");
  pigServer.registerQuery("B = filter A by a2==3;");
  pigServer.registerQuery("C = foreach B generate $2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by a2;");
  pigServer.registerQuery("C = foreach B generate a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(2)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by $1, B by $1;");
  pigServer.registerQuery("D = foreach C generate AVG($1.$1);");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertNull(t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2.0",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("5.0",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroup9() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (c0, c1, c2);");
  pigServer.registerQuery("D = cogroup A by a2, B by b2, C by c2;");
  pigServer.registerQuery("E = foreach D generate $1, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("({(2,5,2)},{(2,5,2)})",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("({(1,2,3)},{(1,2,3)})",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for C: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = filter A by " + MyFilterFunc.class.getName() + "(*) ;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplex2() throws Exception {
  HashSet<String> optimizerRules=new HashSet<String>();
  optimizerRules.add("PushUpFilter");
  pigServer.getPigContext().getProperties().setProperty(PigImplConstants.PIG_OPTIMIZER_RULES_KEY,ObjectSerializer.serialize(optimizerRules));
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile13.toString(),pigServer.getPigContext()) + "' as (a:int, b:chararray);");
  pigServer.registerQuery("B = FOREACH A generate a;");
  pigServer.registerQuery("C = GROUP B by a;");
  pigServer.registerQuery("D = filter C by group > 0 and group < 100;");
  pigServer.registerQuery("E = FOREACH D {F = LIMIT B 1 ;GENERATE B.a as mya, FLATTEN(F.a) as setting;}");
  pigServer.registerQuery("G = FOREACH E GENERATE mya, setting as setting;");
  Iterator<Tuple> iter=pigServer.openIterator("G");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("({(1)},1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("({(2),(2)},2)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("({(3),(3),(3)},3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
  pigServer.getPigContext().getProperties().remove(PigImplConstants.PIG_OPTIMIZER_RULES_KEY);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile6.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("C = join A by $0 left, B by $0;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(2)");
  results.add("()");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinct1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = distinct A;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate a0, a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile5.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2, a3);");
  pigServer.registerQuery("B = foreach A generate ($1 == '2'? $2 : $3);");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("3",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("5",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachFlatten() throws Exception {
  File inputFile=Util.createInputFile("table_testForEachFlatten","",new String[]{"oiue\tM\t{(3),(4)}\t{(toronto),(montreal)}"});
  pigServer.registerQuery("A = load '" + Util.encodeEscape(inputFile.toString()) + "' as (a0:chararray, a1:chararray, a2:bag{t:tuple(id:chararray)}, a3:bag{t:tuple(loc:chararray)});");
  pigServer.registerQuery("B = foreach A generate a0, a1, flatten(a2), flatten(a3), 10;");
  pigServer.registerQuery("C = foreach B generate a0, $4;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("split A into B if $0<=1, C if $0>1;");
  pigServer.registerQuery("D = foreach B generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectCastKeyLookup() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0, a1);");
  pigServer.registerQuery("B = foreach A generate a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFRJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = join A by $0, B by $0 using 'replicated';");
  pigServer.registerQuery("D = foreach C generate $0, $3;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroup8() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(1,2,3)",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(2,5,2)",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderbyWrongSignature() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = order A by a1;");
  pigServer.registerQuery("D = join C by a1, B by b0;");
  pigServer.registerQuery("E = foreach D generate a1, b0, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("(2,2,2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = filter A by a0+a2 == 4;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKeyInSplit1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile12.toString(),pigServer.getPigContext()) + "' as (m:map[]);");
  pigServer.registerQuery("B = foreach A generate m#'key1' as key1;");
  pigServer.registerQuery("C = foreach A generate m#'key2' as key2;");
  pigServer.registerQuery("D = join B by key1, C by key2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $0->[key1, key2]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRelayFlattenMap() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate flatten(a1);");
  pigServer.registerQuery("C = foreach B generate a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInconsistentPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2);");
  pigServer.registerQuery("B = foreach A generate CONCAT(a0,a1) as b0, a0, a2;");
  pigServer.registerQuery("C = foreach B generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1,3)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2,2)",t.toString());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("split A into B if $0<=1, C if $0>1;");
  pigServer.registerQuery("D = foreach B generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup7() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C {B = order B by $0;generate FLATTEN(A), B.($1);};");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("3",t.get(2).toString());
  assertEquals("{(2)}",t.get(3).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertEquals("{}",t.get(3).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEach2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0 as b0, *;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals(1,t.get(0));
  assertEquals(1,t.get(1));
  assertEquals(2,t.get(2));
  assertEquals(3,t.get(3));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals(2,t.get(0));
  assertEquals(2,t.get(1));
  assertEquals(5,t.get(2));
  assertEquals(2,t.get(3));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(3,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by a1;");
  pigServer.registerQuery("C = limit B 10;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testMapKeyInSplit2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile12.toString(),pigServer.getPigContext()) + "' as (m:map[]);");
  pigServer.registerQuery("B = filter A by m#'cond'==1;");
  pigServer.registerQuery("C = filter B by m#'key1'==1;");
  pigServer.registerQuery("D = filter B by m#'key2'==2;");
  pigServer.registerQuery("E = join C by m#'key1', D by m#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",((Map)t.get(0)).get("key1").toString());
  assertEquals("2",((Map)t.get(0)).get("key2").toString());
  assertEquals("1",((Map)t.get(0)).get("cond").toString());
  assertEquals("1",((Map)t.get(1)).get("key1").toString());
  assertEquals("2",((Map)t.get(1)).get("key2").toString());
  assertEquals("1",((Map)t.get(1)).get("cond").toString());
  assertFalse(iter.hasNext());
  assertTrue(this.emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2:int);");
  pigServer.registerQuery("split A into B if a2==3, C if a2<3;");
  pigServer.registerQuery("C = foreach B generate $2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEach1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a1+a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(5,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(7,t.get(1));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(5,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup8() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate $0, $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("{}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("{(1,2,3)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("{(2,5,2)}",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = join A by a1, B by b1;");
  pigServer.registerQuery("D = foreach C generate a1, a2, b0, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertEquals(2,t.get(2));
  assertEquals(2,t.get(3));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnion1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = union A, B;");
  pigServer.registerQuery("D = foreach C generate $0, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1,3)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup5() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by (a0, a1);");
  pigServer.registerQuery("C = foreach B generate flatten(group);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;");
  pigServer.registerQuery("C = join A by a0, B by a0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1,2,3,1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2,5,2,2)",t.toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = limit A 10;");
  pigServer.registerQuery("C = foreach B generate $0, $1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorage1() throws Exception {
  File intermediateFile=File.createTempFile("intemediate","txt");
  intermediateFile.delete();
  String clusterPath=Util.removeColon(intermediateFile.getAbsolutePath());
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.store("A",clusterPath,"BinStorage()");
  pigServer.registerQuery("A = load '" + Util.encodeEscape(clusterPath) + "' using BinStorage() as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStream1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = stream A through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachNoSchema2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate $1, 'aoeuaoeu';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("aoeuaoeu",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("aoeuaoeu",t.get(1).toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCrossAtLeastOneColumnOneInput() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = cross A, B;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1)");
  results.add("(2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachFilter() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = filter A by a2==3;");
  pigServer.registerQuery("C = foreach B generate a0, a1;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(2,t.get(1));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = join A by a1, B by b1;");
  pigServer.registerQuery("D = foreach C generate a1, a2, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertEquals(2,t.get(2));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup6() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate A, flatten(B.($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("{}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertEquals("1",t.get(2).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(3,t.size());
  assertEquals("{(1,2,3)}",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorage2() throws Exception {
  File intermediateFile=File.createTempFile("intemediate","txt");
  intermediateFile.delete();
  String clusterPath=Util.removeColon(intermediateFile.getAbsolutePath());
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.store("A",clusterPath,"BinStorage()");
  pigServer.registerQuery("A = load '" + Util.encodeEscape(clusterPath) + "' using BinStorage() as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a2, a0, a1;");
  pigServer.registerQuery("C = foreach B generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionMixedPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:chararray, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b2);");
  pigServer.registerQuery("C = foreach B generate b0, 'hello', b2;");
  pigServer.registerQuery("D = union A, C;");
  pigServer.registerQuery("E = foreach D generate $0, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  Collection<String> results=new HashSet<String>();
  results.add("(1,3)");
  results.add("(2,2)");
  results.add("(1,1)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey5() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate $0, $1#'key1';");
  pigServer.registerQuery("C = stream B through `" + simpleEchoStreamingCommand + "`;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachNoSchema1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate $1, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlainPlan() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = order A by $0;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("3",t.get(2).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(3,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = join A by *, B by * using 'replicated';");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a1;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(5,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = group A by $1;");
  pigServer.registerQuery("C = foreach B generate $1, '1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(1,2,3)}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(2,5,2)}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplex1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile7.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile8.toString(),pigServer.getPigContext()) + "' as (b0, b1, b2, b3);");
  pigServer.registerQuery("B1 = foreach B generate b2, b0+b3;");
  pigServer.registerQuery("C = join A by $0, B1 by $0;");
  pigServer.registerQuery("D = order C by $4;");
  pigServer.registerQuery("E = foreach D generate $0, $2;");
  pigServer.registerQuery("F = filter E by $1<10;");
  pigServer.registerQuery("G = group F by $0;");
  pigServer.registerQuery("H = foreach G generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("H");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("{(2,2)}",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by $0;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate a1, a1#'key1';");
  pigServer.registerQuery("C = foreach B generate $0#'key2', $1;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("4",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1, key2]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFieldsToReadDuplicatedEntry() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0+a0, a1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(2.0,2,3)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(4.0,5,2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testJoin4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = join A by a2, B by b2;");
  pigServer.registerQuery("D = foreach C generate $0,  $1,  $2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1,2,3)");
  results.add("(2,5,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate $1.$1, $2.$1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{}",t.get(0).toString());
  assertEquals("{(1)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(2)}",t.get(0).toString());
  assertEquals("{(2)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(5)}",t.get(0).toString());
  assertEquals("{}",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCross1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cross A, B;");
  pigServer.registerQuery("D = foreach C generate $0, $3;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1,1)");
  results.add("(2,1)");
  results.add("(1,2)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserDefinedSchema() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS ( c1 : chararray, c2 : int);");
  pigServer.registerQuery("B = foreach A generate c1 as c1 : chararray, c2 as c2 : int, 'CA' as state : chararray;");
  pigServer.registerQuery("C = foreach B generate c1 as c1 : chararray;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitOutputWithForEach() throws Exception {
  Path output1=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  Path output2=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile5.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2, a3);");
  pigServer.registerQuery("B = foreach A generate a0, a1, a2;");
  pigServer.registerQuery("store B into '" + Util.generateURI(output1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("C = order B by a2;");
  pigServer.registerQuery("D = foreach C generate a2;");
  pigServer.registerQuery("store D into '" + Util.generateURI(output2.toString(),pigServer.getPigContext()) + "';");
  pigServer.executeBatch();
  BufferedReader reader1=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output1.toString(),pigServer.getPigContext().getProperties())));
  String line=reader1.readLine();
  assertEquals("1\t2\t3",line);
  line=reader1.readLine();
  assertEquals("2\t3\t4",line);
  assertNull(reader1.readLine());
  BufferedReader reader2=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output2.toString(),pigServer.getPigContext().getProperties())));
  line=reader2.readLine();
  assertEquals("3",line);
  line=reader2.readLine();
  assertEquals("4",line);
  assertNull(reader2.readLine());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $3"}));
  reader1.close();
  reader2.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstantPlan() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate 1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSharedSchemaObject() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile10.toString(),pigServer.getPigContext()) + "' AS (a0, a1:map[], a2);");
  pigServer.registerQuery("B = foreach A generate a1;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("([1#1, 2#1])",TestHelper.sortString("\\[(.*)\\]",t.toString(),","));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachUDF() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("B = foreach A generate StringSize(*);");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionMixedSchemaPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;;");
  pigServer.registerQuery("C = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("D = foreach C generate $0;");
  pigServer.registerQuery("E = union B, D;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  Collection<String> results=new HashSet<String>();
  results.add("(1)");
  results.add("(2)");
  results.add("(1)");
  results.add("(2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRelationToExprProject </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterCount1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        filter_notone = filter test by (col2!=1);"+ "        generate group as col1, COUNT(filter_one) as cnt_one, COUNT(filter_notone) as cnt_notone;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Tuple[] expected=new DefaultTuple[2];
  expected[0]=(Tuple)Util.getPigConstant("(1,1L,1L)");
  expected[1]=(Tuple)Util.getPigConstant("(2,2L,0L)");
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertTrue(expected[j].equals(results[j]));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterCount2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple("a","hello"),tuple("a","goodbye"),tuple("b","goodbye"),tuple("c","hello"),tuple("c","hello"),tuple("c","hello"),tuple("d","what"));
  String query="A = load 'foo' using mock.Storage() as ( id:chararray, str:chararray );" + "B = group A by ( id );" + "Cfiltered = foreach B {"+ "        D = filter A by ("+ "                str matches 'hello'"+ "                );"+ "        matchedcount = COUNT(D);"+ "        generate"+ "                group,"+ "                matchedcount as matchedcount,"+ "                A.str;"+ "        };";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("Cfiltered");
  Map<String,Tuple> expected=new HashMap<String,Tuple>();
  expected.put("a",(Tuple)Util.getPigConstant("('a',1L,{('hello'),('goodbye')})"));
  expected.put("b",(Tuple)Util.getPigConstant("('b',0L,{('goodbye')})"));
  expected.put("c",(Tuple)Util.getPigConstant("('c',3L,{('hello'),('hello'),('hello')})"));
  expected.put("d",(Tuple)Util.getPigConstant("('d',0L,{('what')})"));
  int i=0;
  while (it.hasNext()) {
    Tuple actual=it.next();
    assertEquals(expected.get(actual.get(0)),actual);
    i++;
  }
  assertEquals(4,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterCount3() throws IOException, ParserException {
  String query="TESTDATA =  load '" + TEST_FILTER_COUNT3_INPUT + "' using PigStorage() as (timestamp:chararray, testid:chararray, userid: chararray, sessionid:chararray, value:long, flag:int);"+ "TESTDATA_FILTERED = filter TESTDATA by (timestamp gte '1230800400000' and timestamp lt '1230804000000' and value != 0);"+ "TESTDATA_GROUP = group TESTDATA_FILTERED by testid;"+ "TESTDATA_AGG = foreach TESTDATA_GROUP {"+ "                        A = filter TESTDATA_FILTERED by (userid eq sessionid);"+ "                        C = distinct A.userid;"+ "                        generate group as testid, COUNT(TESTDATA_FILTERED) as counttestdata, COUNT(C) as distcount, SUM(TESTDATA_FILTERED.flag) as total_flags;"+ "                }"+ "TESTDATA_AGG_1 = group TESTDATA_AGG ALL;"+ "TESTDATA_AGG_2 = foreach TESTDATA_AGG_1 generate COUNT(TESTDATA_AGG);";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("TESTDATA_AGG_2");
  int i=0;
  while (it.hasNext()) {
    Tuple actual=it.next();
    assertEquals(20l,actual.get(0));
    i++;
  }
  assertEquals(1,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate filter_one;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("({(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("({(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(new Integer(1),occurences);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate group, filter_one;};";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("(1,{(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("(2,{(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(new Integer(3));
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(Integer.valueOf(1),occurences);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  assertEquals("num fields",aliases.length,rsSchema.getFields().length);
  ResourceSchema.ResourceFieldSchema[] fields=rsSchema.getFields();
  for (int i=0; i < fields.length; i++) {
    assertEquals(fields[i].getName(),aliases[i]);
    assertEquals(fields[i].getType(),types[i]);
  }
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can turn a schema into a string and then parse it
 * back into a schema.
 */
@Test public void testToStringAndParse() throws Exception {
  ResourceSchema rs=new ResourceSchema();
  ResourceFieldSchema[] fields=new ResourceFieldSchema[13];
  byte[] types={DataType.INTEGER,DataType.LONG,DataType.FLOAT,DataType.DOUBLE,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.MAP,DataType.TUPLE,DataType.TUPLE,DataType.BAG,DataType.BAG,DataType.BOOLEAN,DataType.DATETIME};
  String[] names={"i","l","f","d","b","s","m","tschema","tnull","bschema","bnull","bb","dt"};
  for (int i=0; i < fields.length; i++) {
    fields[i]=new ResourceFieldSchema();
    fields[i].setName(names[i]);
    fields[i].setType(types[i]);
  }
  ResourceSchema tschema=new ResourceSchema();
  ResourceFieldSchema[] tfields=new ResourceFieldSchema[3];
  for (int i=0; i < 3; i++) {
    tfields[i]=new ResourceFieldSchema();
    tfields[i].setName(names[i]);
    tfields[i].setType(types[i]);
  }
  tschema.setFields(tfields);
  fields[7].setSchema(tschema);
  ResourceSchema bschema=new ResourceSchema();
  ResourceFieldSchema[] bfields=new ResourceFieldSchema[1];
  bfields[0]=new ResourceFieldSchema();
  bfields[0].setName("t");
  bfields[0].setType(DataType.TUPLE);
  ResourceSchema tbschema=new ResourceSchema();
  ResourceFieldSchema[] tbfields=new ResourceFieldSchema[3];
  for (int i=3; i < 6; i++) {
    tbfields[i - 3]=new ResourceFieldSchema();
    tbfields[i - 3].setName(names[i]);
    tbfields[i - 3].setType(types[i]);
  }
  tbschema.setFields(tbfields);
  bfields[0].setSchema(tbschema);
  bschema.setFields(bfields);
  fields[9].setSchema(bschema);
  rs.setFields(fields);
  String strSchema=rs.toString();
  assertEquals("i:int,l:long,f:float,d:double,b:bytearray,s:" + "chararray,m:[],tschema:(i:int,l:long,f:float)," + "tnull:(),bschema:{t:(d:double,b:bytearray,s:chararray)},bnull:{},bb:boolean,dt:datetime",strSchema);
  ResourceSchema after=new ResourceSchema(Utils.getSchemaFromString(strSchema));
  ResourceFieldSchema[] afterFields=after.getFields();
  assertEquals(13,afterFields.length);
  assertEquals("i",afterFields[0].getName());
  assertEquals(DataType.INTEGER,afterFields[0].getType());
  assertEquals("l",afterFields[1].getName());
  assertEquals(DataType.LONG,afterFields[1].getType());
  assertEquals("f",afterFields[2].getName());
  assertEquals(DataType.FLOAT,afterFields[2].getType());
  assertEquals("d",afterFields[3].getName());
  assertEquals(DataType.DOUBLE,afterFields[3].getType());
  assertEquals("b",afterFields[4].getName());
  assertEquals(DataType.BYTEARRAY,afterFields[4].getType());
  assertEquals("s",afterFields[5].getName());
  assertEquals(DataType.CHARARRAY,afterFields[5].getType());
  assertEquals("m",afterFields[6].getName());
  assertEquals(DataType.MAP,afterFields[6].getType());
  assertEquals("tschema",afterFields[7].getName());
  assertEquals(DataType.TUPLE,afterFields[7].getType());
  assertEquals("tnull",afterFields[8].getName());
  assertEquals(DataType.TUPLE,afterFields[8].getType());
  assertEquals("bschema",afterFields[9].getName());
  assertEquals(DataType.BAG,afterFields[9].getType());
  assertEquals("bnull",afterFields[10].getName());
  assertEquals(DataType.BAG,afterFields[10].getType());
  assertEquals("bb",afterFields[11].getName());
  assertEquals(DataType.BOOLEAN,afterFields[11].getType());
  assertEquals("dt",afterFields[12].getName());
  assertEquals(DataType.DATETIME,afterFields[12].getType());
  assertNotNull(afterFields[7].getSchema());
  ResourceFieldSchema[] tAfterFields=afterFields[7].getSchema().getFields();
  assertEquals(3,tAfterFields.length);
  assertEquals("i",tAfterFields[0].getName());
  assertEquals(DataType.INTEGER,tAfterFields[0].getType());
  assertEquals("l",tAfterFields[1].getName());
  assertEquals(DataType.LONG,tAfterFields[1].getType());
  assertEquals("f",tAfterFields[2].getName());
  assertEquals(DataType.FLOAT,tAfterFields[2].getType());
  assertNotNull(afterFields[9].getSchema());
  ResourceFieldSchema[] bAfterFields=afterFields[9].getSchema().getFields();
  assertEquals(1,bAfterFields.length);
  assertNotNull(bAfterFields[0].getSchema());
  ResourceFieldSchema[] tbAfterFields=bAfterFields[0].getSchema().getFields();
  assertEquals(3,tbAfterFields.length);
  assertEquals("d",tbAfterFields[0].getName());
  assertEquals(DataType.DOUBLE,tbAfterFields[0].getType());
  assertEquals("b",tbAfterFields[1].getName());
  assertEquals(DataType.BYTEARRAY,tbAfterFields[1].getType());
  assertEquals("s",tbAfterFields[2].getName());
  assertEquals(DataType.CHARARRAY,tbAfterFields[2].getType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that Pig Schema is correctly created given a
 * ResourceSchema and vice versa. Test also that 
 * TwoLevelAccess flag is set for Pig Schema when needed.
 * @throws IOException 
 */
@Test public void testToPigSchemaWithTwoLevelAccess() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY),new ResourceFieldSchema().setName("fld1").setType(DataType.DOUBLE),new ResourceFieldSchema().setName("fld2").setType(DataType.INTEGER)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level1=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t1").setType(DataType.TUPLE).setSchema(rSchema0)};
  ResourceSchema rSchema1=new ResourceSchema().setFields(level1);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema1)};
  ResourceSchema origSchema=new ResourceSchema().setFields(level2);
  Schema pSchema=Schema.getPigSchema(origSchema);
  assertTrue(!CheckTwoLevelAccess(pSchema));
  assertTrue(ResourceSchema.equals(origSchema,new ResourceSchema(pSchema)));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation2() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=new Schema(new Schema.FieldSchema("t1",new Schema(new Schema.FieldSchema("t0",TypeCheckingTestUtil.genFlatSchema(aliases,types),DataType.TUPLE)),DataType.BAG));
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that ResourceSchema is correctly with SortInfo
 */
@Test public void testResourceFlatSchemaCreationWithSortInfo() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=new Schema(new Schema.FieldSchema("t1",new Schema(new Schema.FieldSchema("t0",TypeCheckingTestUtil.genFlatSchema(aliases,types),DataType.TUPLE)),DataType.BAG));
  List<SortColInfo> colList=new ArrayList<SortColInfo>();
  SortColInfo col1=new SortColInfo("f1",0,SortColInfo.Order.ASCENDING);
  SortColInfo col2=new SortColInfo("f1",1,SortColInfo.Order.DESCENDING);
  colList.add(col1);
  colList.add(col2);
  SortInfo sortInfo=new SortInfo(colList);
  ResourceSchema rsSchema=new ResourceSchema(origSchema,sortInfo);
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
  assertTrue(rsSchema.getSortKeys()[0] == 0);
  assertTrue(rsSchema.getSortKeys()[1] == 1);
  assertTrue(rsSchema.getSortKeyOrders()[0] == ResourceSchema.Order.ASCENDING);
  assertTrue(rsSchema.getSortKeyOrders()[1] == ResourceSchema.Order.DESCENDING);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSampleOptimizer </h4><pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerNotFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + "B = group A by $0;" + " C = order B by $0;"+ "store C into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEndToEnd() throws Exception {
  PigServer pigServer=new PigServer(pc);
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(3);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' using PigStorage() AS (num:int);");
  pigServer.registerQuery("B = order A by num desc;");
  Iterator<Tuple> result=pigServer.openIterator("B");
  Integer prevNum=null;
  while (result.hasNext()) {
    Integer curNum=(Integer)result.next().get(0);
    if (null != prevNum)     assertTrue(curNum.compareTo(prevNum) <= 0);
    prevNum=curNum;
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByUDFSet() throws Exception {
  String query="a = load 'input1' using BinStorage();" + "b = order a by $0;" + "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  assertTrue(mrOper.UDFs.size() == 1);
  assertTrue(mrOper.UDFs.contains("BinStorage"));
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    assertTrue(mrOper.UDFs.size() == 2);
    assertTrue(mrOper.UDFs.contains("BinStorage"));
    assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
    ++count;
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + " B = order A by $0;" + "store B into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(2,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliases </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarAliasesSplitClause() throws Exception {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] input={"1\t5","2\t10","3\t20"};
  String inputPath="table_testScalarAliasesSplitClause";
  String output="table_testScalarAliasesSplitClauseDir";
  Util.createInputFile(cluster,inputPath,input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0: long, a1: double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = foreach B generate COUNT(A) as count;");
  pigServer.registerQuery("split A into Y if (2 * C.count) < a1, X if a1 == 5;");
  pigServer.registerQuery("Store Y into '" + output + "';");
  pigServer.executeBatch();
  pigServer.registerQuery("Z = LOAD '" + output + "' as (a0: int, a1: double);");
  Iterator<Tuple> iter=pigServer.openIterator("Z");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(2,10.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(3,20.0)"));
  assertFalse(iter.hasNext());
  Util.deleteFile(cluster,output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliasesLocal </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarAliasesLimit() throws Exception {
  String[] input={"a\t1","b\t2","c\t3","a\t4","c\t5"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarAliasesLimit";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0:chararray, a1: int);");
  pigServer.registerQuery("G = group A all;");
  pigServer.registerQuery("C = foreach G generate SUM(A.$1) as total;");
  pigServer.registerQuery("C1 = limit C 1;");
  pigServer.registerQuery("Y = foreach A generate a0, a1 * (double)C1.total;");
  Iterator<Tuple> iter=pigServer.openIterator("Y");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(a,15.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(b,30.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(c,45.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(a,60.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(c,75.0)"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarWithTwoBranches() throws Exception {
  String[] inputA={"1\t5","2\t10","3\t20"};
  String[] inputX={"pig","hadoop","rocks"};
  String output=BUILD_TEST_TMP + "testScalarWithTwoBranchesDir";
  TestScalarAliases.deleteDirectory(new File(output));
  String inputPathA=BUILD_TEST_TMP + "testScalarWithTwoBranchesA";
  TestScalarAliases.createLocalInputFile(inputPathA,inputA);
  String inputPathX=BUILD_TEST_TMP + "testScalarWithTwoBranchesX";
  TestScalarAliases.createLocalInputFile(inputPathX,inputX);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPathA + "' as (a0: long, a1: double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = foreach B generate COUNT(A) as count, MAX(A.$1) as max;");
  pigServer.registerQuery("X = LOAD '" + inputPathX + "' as (names: chararray);");
  pigServer.registerQuery("Y = foreach X generate names, C.max;");
  pigServer.registerQuery("Store Y into '" + output + "';");
  pigServer.executeBatch();
  pigServer.registerQuery("Z = LOAD '" + output + "' as (a0: chararray, a1: double);");
  Iterator<Tuple> iter=pigServer.openIterator("Z");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(pig,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(hadoop,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(rocks,20.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Y");
  t=iter.next();
  assertTrue(t.toString().equals("(pig,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(hadoop,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(rocks,20.0)"));
  assertFalse(iter.hasNext());
  pigServer.getPigContext().getProperties().remove("tez.am.inline.task.execution.max-tasks");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUseScalarMultipleTimes() throws Exception {
  String[] input={"1\t5","2\t10","3\t20"};
  String outputY=BUILD_TEST_TMP + "table_testUseScalarMultipleTimesOutY";
  TestScalarAliases.deleteDirectory(new File(outputY));
  String outputZ=BUILD_TEST_TMP + "table_testUseScalarMultipleTimesOutZ";
  TestScalarAliases.deleteDirectory(new File(outputZ));
  String inputPath=BUILD_TEST_TMP + "table_testUseScalarMultipleTimes";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0: long, a1: double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = foreach B generate COUNT(A) as count, MAX(A.$1) as max;");
  pigServer.registerQuery("Y = foreach A generate (a0 * C.count), (a1 / C.max);");
  pigServer.registerQuery("Store Y into '" + outputY + "';");
  pigServer.registerQuery("Z = foreach A generate (a1 + C.count), (a0 * C.max);");
  pigServer.registerQuery("Store Z into '" + outputZ + "';");
  pigServer.executeBatch();
  pigServer.registerQuery("M = LOAD '" + outputY + "' as (a0: int, a1: double);");
  Iterator<Tuple> iter;
  Tuple t;
  iter=pigServer.openIterator("M");
  t=iter.next();
  assertTrue(t.toString().equals("(3,0.25)"));
  t=iter.next();
  assertTrue(t.toString().equals("(6,0.5)"));
  t=iter.next();
  assertTrue(t.toString().equals("(9,1.0)"));
  assertFalse(iter.hasNext());
  pigServer.registerQuery("N = LOAD '" + outputZ + "' as (a0: double, a1: double);");
  iter=pigServer.openIterator("N");
  t=iter.next();
  assertTrue(t.toString().equals("(8.0,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(13.0,40.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(23.0,60.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Y");
  t=iter.next();
  assertTrue(t.toString().equals("(3,0.25)"));
  t=iter.next();
  assertTrue(t.toString().equals("(6,0.5)"));
  t=iter.next();
  assertTrue(t.toString().equals("(9,1.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Z");
  t=iter.next();
  assertTrue(t.toString().equals("(8.0,20.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(13.0,40.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(23.0,60.0)"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarWithNoSchema() throws Exception {
  String[] scalarInput={"1\t5"};
  String[] input={"1\t5","2\t10","3\t20"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarWithNoSchema";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  String inputPathScalar=BUILD_TEST_TMP + "table_testScalarWithNoSchemaScalar";
  TestScalarAliases.createLocalInputFile(inputPathScalar,scalarInput);
  pigServer.registerQuery("A = LOAD '" + inputPath + "';");
  pigServer.registerQuery("scalar = LOAD '" + inputPathScalar + "' as (count, total);");
  pigServer.registerQuery("B = foreach A generate 5 / scalar.total;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Tuple t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarAliasesFilterClause() throws Exception {
  String[] input={"1\t5","2\t10","3\t20","4\t12","5\t8"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarAliasesFilterClause";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0, a1);");
  pigServer.registerQuery("G = group A all;");
  pigServer.registerQuery("C = foreach G generate AVG(A.$1) as average;");
  pigServer.registerQuery("Y = filter A by a1 > C.average;");
  Iterator<Tuple> iter=pigServer.openIterator("Y");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(3,20)"));
  t=iter.next();
  assertTrue(t.toString().equals("(4,12)"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarAliasesBatchNobatch() throws Exception {
  String[] input={"1\t5","2\t10","3\t20"};
  String output=BUILD_TEST_TMP + "table_testScalarAliasesDir";
  TestScalarAliases.deleteDirectory(new File(output));
  String inputPath=BUILD_TEST_TMP + "table_testScalarAliasesBatch";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0: long, a1: double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = foreach B generate COUNT(A) as count, MAX(A.$1) as max;");
  pigServer.registerQuery("Y = foreach A generate (a0 * C.count), (a1 / C.max);");
  pigServer.registerQuery("Store Y into '" + output + "';");
  pigServer.executeBatch();
  pigServer.registerQuery("Z = LOAD '" + output + "' as (a0: int, a1: double);");
  Iterator<Tuple> iter;
  Tuple t;
  iter=pigServer.openIterator("Z");
  t=iter.next();
  assertTrue(t.toString().equals("(3,0.25)"));
  t=iter.next();
  assertTrue(t.toString().equals("(6,0.5)"));
  t=iter.next();
  assertTrue(t.toString().equals("(9,1.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Y");
  t=iter.next();
  assertTrue(t.toString().equals("(3,0.25)"));
  t=iter.next();
  assertTrue(t.toString().equals("(6,0.5)"));
  t=iter.next();
  assertTrue(t.toString().equals("(9,1.0)"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testScalarWithNoSchemaDollarProj() throws Exception {
  String[] scalarInput={"1\t5"};
  String[] input={"1\t5","2\t10","3\t20"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarWithNoSchemaDollarProj";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  String inputPathScalar=BUILD_TEST_TMP + "table_testScalarWithNoSchemaDollarProjScalar";
  TestScalarAliases.createLocalInputFile(inputPathScalar,scalarInput);
  pigServer.registerQuery("A = LOAD '" + inputPath + "';");
  pigServer.registerQuery("scalar = LOAD '" + inputPathScalar + "';");
  pigServer.registerQuery("B = foreach A generate 5 / scalar.$1;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Tuple t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  t=iter.next();
  assertTrue(t.get(0).toString().equals("1"));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilteredScalarDollarProj() throws Exception {
  String output=BUILD_TEST_TMP + "table_testFilteredScalarDollarProjDir";
  TestScalarAliases.deleteDirectory(new File(output));
  String[] input={"1\t5\t[state#maine,city#portland]\t{(a),(b)}\t(a,b)","2\t10\t\t\t","3\t20\t\t\t"};
  String inputPath=BUILD_TEST_TMP + "table_testFilteredScalarDollarProj";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPath + "'"+ " as (a0: long, a1: double, a2 : bytearray, "+ "a3: bag{ t : tuple(tc : chararray)}, "+ "a4: tuple(c1 : chararray, c2 : chararray) );");
  pigServer.registerQuery("B = filter A by $1 < 8;");
  pigServer.registerQuery("Y = foreach A generate (a0 * B.$0), (a1 / B.$1), B.$2, B.$2#'state', B.$3, B.a4;");
  pigServer.registerQuery("Store Y into '" + output + "';");
  pigServer.explain("Y",System.err);
  pigServer.executeBatch();
  pigServer.registerQuery("Z = LOAD '" + output + "' as (a0: int, a1: double);");
  pigServer.explain("Z",System.err);
  Iterator<Tuple> iter=pigServer.openIterator("Z");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(1,1.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(2,2.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(3,4.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Y");
  t=iter.next();
  assertEquals(t.toString(),"(1,1.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  t=iter.next();
  assertEquals(t.toString(),"(2,2.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  t=iter.next();
  assertEquals(t.toString(),"(3,4.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetInitialSchemaStringFromSchema() throws ParserException {
  String[] schemaStrings={"my_list:{array:(array_element:(num1:int,num2:int))}","my_list:{array:(array_element:(num1:int,num2:int),c:chararray)}","bag:{mytuple3:(mytuple2:(mytuple:(f1:int)))}","bag:{mytuple:(f1:int)}","{((num1:int,num2:int))}"};
  for (  String schemaString : schemaStrings) {
    String s1=Utils.getSchemaFromString(schemaString).toString();
    String s2=s1.substring(1,s1.length() - 1).replaceAll("\\s|bag_0:|tuple_0:","");
    assertTrue(schemaString.equals(s2));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeNullSchemas2() throws Throwable {
  Schema innerInner=new Schema(new ArrayList<FieldSchema>());
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",innerInner));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",null));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema1=new Schema(innerList1);
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,true);
  List<FieldSchema> expectedInnerList=new ArrayList<FieldSchema>();
  expectedInnerList.add(new FieldSchema("22a",null));
  expectedInnerList.add(new FieldSchema("11b",DataType.FLOAT));
  Schema expectedInner=new Schema(expectedInnerList);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",expectedInner));
  expectedList.add(new FieldSchema("2c",DataType.LONG));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeSchemaWithTwoLevelAccess3() throws Exception {
  LogicalSchema ls1=Utils.parseSchema("a:{t:(a0:int, a1:int)}");
  LogicalSchema ls2=Utils.parseSchema("b:{t:(b0:int, b1:int)}");
  LogicalSchema ls3=LogicalSchema.merge(ls1,ls2,MergeMode.LoadForEach);
  assertEquals("{a: {t: (a0: int,a1: int)}}",org.apache.pig.newplan.logical.Util.translateSchema(ls3).toString());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType1() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:long, c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:bytearray, c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize1() throws Throwable {
  LogicalSchema a=Utils.parseSchema("a1:bytearray, b1:long, c1:long");
  LogicalSchema b=Utils.parseSchema("a2:bytearray, b2:long");
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  assertNull(mergedSchema);
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNewNormalNestedMerge2() throws Exception {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:(a11:chararray, a12:float), b1:(b11:chararray, b12:float), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:chararray"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:(a11:chararray, a12:float), b1:(), c1:bytearray"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:(a11:chararray, a12:float), b1:(b11:chararray, b12:float), c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:(a11:chararray, a12:float), b2:(b21:double, b22:long), c2:chararray"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(b11:double, b12:(b121:int)), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeDifferentSizeAndTypeMismatch1() throws Throwable {
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",DataType.INTEGER));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  innerList1.add(new FieldSchema("11c",DataType.CHARARRAY));
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",DataType.CHARARRAY));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema1=new Schema(innerList1);
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.INTEGER));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.CHARARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  list2.add(new FieldSchema("2d",DataType.MAP));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,true,true);
  List<FieldSchema> expectedInnerList=new ArrayList<FieldSchema>();
  expectedInnerList.add(new FieldSchema("22a",DataType.BYTEARRAY));
  expectedInnerList.add(new FieldSchema("11b",DataType.FLOAT));
  expectedInnerList.add(new FieldSchema("11c",DataType.CHARARRAY));
  Schema expectedInner=new Schema(expectedInnerList);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",expectedInner));
  expectedList.add(new FieldSchema("2c",DataType.LONG));
  expectedList.add(new FieldSchema("2d",DataType.MAP));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeNullSchemas1() throws Throwable {
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",DataType.DOUBLE));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",null));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,true);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",null));
  expectedList.add(new FieldSchema("2c",DataType.LONG));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMergeSchemaWithTwoLevelAccess1() throws Exception {
  Schema s1=Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
  Schema s2=Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
  s1.getField(0).schema.setTwoLevelAccessRequired(true);
  s2.getField(0).schema.setTwoLevelAccessRequired(true);
  Schema s3=Schema.mergeSchema(s1,s2,true);
  assertTrue(s3.getField(0).schema.isTwoLevelAccessRequired());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(b11:int, b12:float, b13:float), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeDifferentSize1() throws Throwable {
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",DataType.INTEGER));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  innerList1.add(new FieldSchema("11c",DataType.CHARARRAY));
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",DataType.DOUBLE));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema1=new Schema(innerList1);
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  list2.add(new FieldSchema("2d",DataType.MAP));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,true,false);
  List<FieldSchema> expectedInnerList=new ArrayList<FieldSchema>();
  expectedInnerList.add(new FieldSchema("22a",DataType.DOUBLE));
  expectedInnerList.add(new FieldSchema("11b",DataType.FLOAT));
  expectedInnerList.add(new FieldSchema("11c",DataType.CHARARRAY));
  Schema expectedInner=new Schema(expectedInnerList);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",expectedInner));
  expectedList.add(new FieldSchema("2c",DataType.LONG));
  expectedList.add(new FieldSchema("2d",DataType.MAP));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetStringFromSchema() throws ParserException {
  String[] schemaStrings={"a:int","a:long","a:chararray","a:double","a:float","a:bytearray","b:bag{tuple(x:int,y:int,z:int)}","b:bag{t:tuple(x:int,y:int,z:int)}","a:int,b:chararray,c:Map[int]","a:double,b:float,t:tuple(x:int,y:double,z:bytearray)","a:double,b:float,t:tuple(x:int,b:bag{t:tuple(a:int,b:float,c:double,x:tuple(z:bag{r:tuple(z:bytearray)}))},z:bytearray)","a,b,t:tuple(x,b:bag{t:tuple(a,b,c,x:tuple(z:bag{r:tuple(z)}))},z)","a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:bag{t:tuple(a:int,b:float)})})})})})}","a:bag{}","b:{null:(a:int)}","int,int,int,int,int,int,int,int,int,int","long,long,long,long,long,long,long,long,long,long","float,float,float,float,float,float,float,float,float,float","double,double,double,double,double,double,double,double,double,double","boolean,boolean,boolean,boolean,boolean,boolean,boolean,boolean,boolean,boolean","datetime,datetime,datetime,datetime,datetime,datetime,datetime,datetime,datetime,datetime","{},{},{},{},{},{},{},{},{},{}","map[],map[],map[],map[],map[],map[],map[],map[],map[],map[]","int,int,long,long,float,float,double,double,boolean,boolean,datetime,datetime,(int,long,float,double,boolean,datetime),{(int,long,float,double,boolean,datetime)},map[(int,long,float,double,boolean,datetime)]"};
  for (  String schemaString : schemaStrings) {
    Schema s1=Utils.getSchemaFromString(schemaString);
    String s=s1.toString();
    Schema s2=Utils.getSchemaFromBagSchemaString(s);
    assertTrue(Schema.equals(s1,s2,false,true));
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNewNormalNestedMerge1() throws Exception {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(b11:int, b12:float), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(b11:int, b12:float), c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeSchemaWithTwoLevelAccess() throws Exception {
  Schema s1=Utils.getSchemaFromString("a:{t:(a0:int, a1:int)}");
  Schema s2=Utils.getSchemaFromString("b:{t:(b0:int, b1:int)}");
  s1.getField(0).schema.setTwoLevelAccessRequired(true);
  s1.getField(0).schema.setTwoLevelAccessRequired(false);
  Schema s3=Schema.mergeSchema(s1,s2,true);
  assertEquals(s3,s2);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSchemaSerialization() throws IOException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String inputFileName="testSchemaSerialization-input.txt";
  String[] inputData=new String[]{"foo\t1","hello\t2"};
  Util.createInputFile(cluster,inputFileName,inputData);
  String script="a = load '" + inputFileName + "' as (f1:chararray, f2:int);"+ " b = group a all; c = foreach b generate org.apache.pig.test.InputSchemaUDF(a);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals("{a: {(f1: chararray,f2: int)}}",t.get(0));
  }
  cluster.shutDown();
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeMismatchType2() throws Throwable {
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",DataType.CHARARRAY));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  Schema innerSchema1=new Schema(innerList1);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.MAP));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,true);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",DataType.TUPLE));
  expectedList.add(new FieldSchema("2c",DataType.BYTEARRAY));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNewMergeNullSchemas() throws Throwable {
  LogicalSchema a=Utils.parseSchema("a1:bytearray, b1:(b11:int, b12:float), c1:long");
  LogicalSchema b=Utils.parseSchema("a2:bytearray, b2:(), c2:int");
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=Utils.parseSchema("a1:bytearray, b1:(), c1:long");
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  expected=Utils.parseSchema("a1:bytearray, b1:(b11:int, b12:float), c1:long");
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  mergedSchema=LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  expected=Utils.parseSchema("a2:bytearray, b2:(b11:int,b12:float), c2:int");
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMergeMismatchType1() throws Throwable {
  List<FieldSchema> innerList1=new ArrayList<FieldSchema>();
  innerList1.add(new FieldSchema("11a",DataType.CHARARRAY));
  innerList1.add(new FieldSchema("11b",DataType.FLOAT));
  List<FieldSchema> innerList2=new ArrayList<FieldSchema>();
  innerList2.add(new FieldSchema("22a",DataType.DOUBLE));
  innerList2.add(new FieldSchema(null,DataType.LONG));
  Schema innerSchema1=new Schema(innerList1);
  Schema innerSchema2=new Schema(innerList2);
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",innerSchema1));
  list1.add(new FieldSchema("1c",DataType.MAP));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",innerSchema2));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,true);
  List<FieldSchema> expectedInnerList=new ArrayList<FieldSchema>();
  expectedInnerList.add(new FieldSchema("22a",DataType.BYTEARRAY));
  expectedInnerList.add(new FieldSchema("11b",DataType.FLOAT));
  Schema expectedInner=new Schema(expectedInnerList);
  List<FieldSchema> expectedList=new ArrayList<FieldSchema>();
  expectedList.add(new FieldSchema("2a",DataType.BYTEARRAY));
  expectedList.add(new FieldSchema("2b",expectedInner));
  expectedList.add(new FieldSchema("2c",DataType.BYTEARRAY));
  Schema expected=new Schema(expectedList);
  assertTrue(Schema.equals(mergedSchema,expected,false,false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchemaUtil </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTupleSchema() throws Exception {
  String tupleName="mytuple";
  String[] fieldNames=new String[]{"field_0","field_1"};
  Byte[] dataTypes=new Byte[]{DataType.LONG,DataType.CHARARRAY};
  String expected="{mytuple: (field_0: long,field_1: chararray)}";
  Schema tupleSchema=SchemaUtil.newTupleSchema(tupleName,fieldNames,dataTypes);
  assertEquals(expected,tupleSchema.toString());
  tupleSchema=SchemaUtil.newTupleSchema(tupleName,Arrays.asList(fieldNames),Arrays.asList(dataTypes));
  assertEquals(expected,tupleSchema.toString());
  expected="{t: (field_0: long,field_1: chararray)}";
  tupleSchema=SchemaUtil.newTupleSchema(fieldNames,dataTypes);
  assertEquals(expected,tupleSchema.toString());
  tupleSchema=SchemaUtil.newTupleSchema(Arrays.asList(fieldNames),Arrays.asList(dataTypes));
  assertEquals(expected,tupleSchema.toString());
  expected="{t: (f0: long,f1: chararray)}";
  tupleSchema=SchemaUtil.newTupleSchema(dataTypes);
  assertEquals(expected,tupleSchema.toString());
  tupleSchema=SchemaUtil.newTupleSchema(Arrays.asList(dataTypes));
  assertEquals(expected,tupleSchema.toString());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBagSchema() throws Exception {
  String bagName="mybag";
  String tupleName="mytuple";
  String[] fieldNames=new String[]{"field_0","field_1"};
  Byte[] dataTypes=new Byte[]{DataType.LONG,DataType.CHARARRAY};
  String expected="{mybag: {mytuple: (field_0: long,field_1: chararray)}}";
  Schema bagSchema=SchemaUtil.newBagSchema(bagName,tupleName,fieldNames,dataTypes);
  assertEquals(expected,bagSchema.toString());
  bagSchema=SchemaUtil.newBagSchema(bagName,tupleName,Arrays.asList(fieldNames),Arrays.asList(dataTypes));
  assertEquals(expected,bagSchema.toString());
  expected="{b: {t: (field_0: long,field_1: chararray)}}";
  bagSchema=SchemaUtil.newBagSchema(fieldNames,dataTypes);
  assertEquals(expected,bagSchema.toString());
  bagSchema=SchemaUtil.newBagSchema(Arrays.asList(fieldNames),Arrays.asList(dataTypes));
  assertEquals(expected,bagSchema.toString());
  expected="{b: {t: (f0: long,f1: chararray)}}";
  bagSchema=SchemaUtil.newBagSchema(dataTypes);
  assertEquals(expected,bagSchema.toString());
  bagSchema=SchemaUtil.newBagSchema(Arrays.asList(dataTypes));
  assertEquals(expected,bagSchema.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptLanguage </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bindNonStringVariableTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"-rmr simple_out\")","input = 'simple_table'","output = 'simple_out'","max = 2","P = Pig.compile(\"\"\"a = load '$in' as (a0:int, a1:int);" + "   b = filter a by a0 > $max;" + "   store b into '$out';\"\"\")","Q = P.bind({'in':input, 'out':output, 'max':max})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(cluster,"simple_table");
  Util.createInputFile(cluster,"simple_table",input);
  PigStats stats=runSimpleScript("bindNonStringVariableTest",script);
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(4,stats.getBytesWritten());
  assertEquals(1,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runLoopTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","input = 'simple_table_4'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","for x in [\"simple_out\", \"simple_out2\"]:","\tQ = P.bind({'input':input, 'output':x}).run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_4",input);
  PigStats mainStats=runPigRunner("runLoopTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixNonEscapedDollarSign() throws Exception {
  java.lang.reflect.Method fixNonEscapedDollarSign=Class.forName("org.apache.pig.scripting.Pig").getDeclaredMethod("fixNonEscapedDollarSign",new Class[]{String.class});
  fixNonEscapedDollarSign.setAccessible(true);
  String s=(String)fixNonEscapedDollarSign.invoke(null,"abc$py$");
  assertEquals("abc\\\\$py\\\\$",s);
  s=(String)fixNonEscapedDollarSign.invoke(null,"$abc$py");
  assertEquals("\\\\$abc\\\\$py",s);
  s=(String)fixNonEscapedDollarSign.invoke(null,"$");
  assertEquals("\\\\$",s);
  s=(String)fixNonEscapedDollarSign.invoke(null,"$$abc");
  assertEquals("\\\\$\\\\$abc",s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void NegativeTest() throws Exception {
  String[] script={"#!/usr/bin/python"," from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")"};
  PigStats stats=runPigRunner("NegativeTest",script,false);
  assertTrue(stats.getErrorCode() == 1121);
  assertTrue(stats.getReturnCode() == PigRunner.ReturnCode.PIG_EXCEPTION);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void firstTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table'","output = 'simple_out'","P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(cluster,"simple_table");
  Util.createInputFile(cluster,"simple_table",input);
  PigStats stats=runSimpleScript("firstTest",script);
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runParallelTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","input = 'simple_table_3'","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_3",input);
  PigStats mainStats=runPigRunner("runParallelTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void NegativeTest2() throws Exception {
  String[] script={"#!/usr/bin/python"," from org.apache.pig.scripting import *","raise 'This is a test'"};
  PigStats stats=runPigRunner("NegativeTest2",script,false);
  assertTrue(stats.getErrorCode() == 1121);
  assertTrue(stats.getReturnCode() == PigRunner.ReturnCode.PIG_EXCEPTION);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bindLocalVariableTest2() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'bindLocalVariableTest2'","output = 'simple_out'","separator = '$'","P = Pig.compile(\"\"\"a = load '$input' using PigStorage('$separator');store a into '$output';\"\"\")","Q = P.bind()","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1$3","2$4","3$5"};
  Util.createInputFile(cluster,"bindLocalVariableTest2",input);
  PigStats stats=runSimpleScript("bindLocalVariableTest2",script);
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void secondTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table_6'","output = 'simple_out'","P = Pig.compileFromFile(\"\"\"secondTest.pig\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  String[] pigLatin={"-- ensure comment parsed correctly","a = load '$input';","store a into '$output';"};
  Util.createInputFile(cluster,"simple_table_6",input);
  Util.createLocalInputFile("secondTest.pig",pigLatin);
  PigStats stats=runSimpleScript("secondTest",script);
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void firstParallelTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","input = 'simple_table_1'","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_1",input);
  Map<String,List<PigStats>> statsMap=runScript("firstParallelTest",script);
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void NegativeTest3() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import Pig","P = Pig.compile(\"\"\"","    #TEST PIG COMMENTS","    A = load 'studenttab10k' as (name, age, gpa);","    store A into 'CompileBindRun_2.out';\"\"\")","result = P.bind().runSingle()"};
  PigStats stats=runPigRunner("NegativeTest3",script,false);
  assertTrue(stats.getErrorCode() == 1121);
  assertTrue(stats.getReturnCode() == PigRunner.ReturnCode.PIG_EXCEPTION);
  String expected="Python Error. Traceback (most recent call last):";
  String msg=stats.getErrorMessage();
  Util.checkErrorMessageContainsExpected(msg,expected);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bindLocalVariableTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table_5'","output = 'simple_out'","testvar = 'abcd$py'","testvar2 = '$'","testvar3 = '\\\\\\\\$'","testvar4 = 'abcd\\$py$'","testvar5 = 'abcd\\$py'","P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind()","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_5",input);
  PigStats stats=runSimpleScript("bindLocalVariableTest",script);
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runParallelTest2() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","input = 'simple_table_7'","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';","b = foreach a generate $0, org.apache.pig.test.utils.UDFContextTestEvalFunc3($0);","store b into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3"};
  Util.createInputFile(cluster,"simple_table_7",input);
  PigStats mainStats=runPigRunner("runParallelTest2",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  String[] results=new String[2];
  int i=0;
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    OutputStats os=stats.getOutputStats().get(0);
    Tuple t=os.iterator().next();
    results[i++]=t.get(1).toString();
  }
  assertTrue(results[0] != null);
  assertTrue(results[1] != null);
  assertTrue(!results[0].equals(results[1]));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPyShouldNotFailScriptIfExitCodeIs0() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","import sys","if 1 == 2:","   sys.exit(1)","else: sys.exit(0)"};
  Map<String,List<PigStats>> statsMap=runScript("testPyShouldNotFailScriptIfExitCodeIs0",script);
  assertEquals(0,statsMap.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void pigRunnerTest() throws Exception {
  String[] script={"from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table_2'","output = 'simple_out'","P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_2",input);
  PigStats mainStats=runPigRunner("pigRunnerTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue("job should succeed",stats.isSuccessful());
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSysArguments() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import Pig","import sys","P = Pig.compile(\"\"\"rmf $file;\"\"\")","files = sys.argv[1].strip().split(',')","for file in files:","    P.bind({'file':file}).runSingle()"};
  String file1="/tmp/sysarg_1";
  String file2="/tmp/sysarg_2";
  createEmptyFiles(file1,file2);
  File scriptFile=Util.createInputFile("sysarg",".py",script);
  PigStats stats=PigRunner.run(new String[]{scriptFile.getAbsolutePath(),file1 + "," + file2},null);
  assertEquals(null,stats.getErrorMessage());
  assertFileNotExists(file1,file2);
  createEmptyFiles(file1,file2);
  PigStatsUtil.getEmptyPigStats();
  stats=PigRunner.run(new String[]{"-x",cluster.getExecType().name().toLowerCase(),"-f",scriptFile.getAbsolutePath(),"arg0",file1 + "," + file2},null);
  assertEquals(null,stats.getErrorMessage());
  assertFileNotExists(file1,file2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptLanguageJavaScript </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void firstTest() throws Exception {
  String[] script={"importPackage(Packages.org.apache.pig.scripting.js)","pig = org.apache.pig.scripting.js.JSPig;","function main() {","  pig.fs(\"-rmr simple_out\")","  input = 'simple_table'","  output = 'simple_out'","  P = pig.compile(\"a = load '$input';store a into '$output';\")","  Q = P.bind({'input':input, 'output':output})","  stats = Q.runSingle()","  if (stats.isSuccessful()) {","    print(\"success!\")","  } else {","    print(\"failed\")","  }","}"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(pigServer.getPigContext(),"simple_table");
  Util.createInputFile(pigServer.getPigContext(),"simple_table",input);
  Util.createLocalInputFile("testScript.js",script);
  ScriptEngine scriptEngine=ScriptEngine.getInstance("javascript");
  Map<String,List<PigStats>> statsMap=scriptEngine.run(pigServer.getPigContext(),"testScript.js");
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue("job should succeed",stats.isSuccessful());
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  String[] output=Util.readOutput(pigServer.getPigContext(),"simple_out");
  assertTrue(Arrays.toString(input) + " equals " + Arrays.toString(output),Arrays.equals(input,output));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptUDF </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJavascriptExampleScript() throws Exception {
  String[] script={"function simple(word) {","return word;","}","helloworld.outputSchema = \"word:chararray\";","function helloworld() {","return 'Hello, World';","}","complex.outputSchema = \"(word:chararray,num:long)\";","function complex(word) {","return {word:word, num:word.length};","}"};
  String[] input={"one\t1","two\t2","three\t3"};
  Util.createInputFile(cluster,"table_testJavascriptExampleScript",input);
  Util.createLocalInputFile("testJavascriptExampleScript.js",script);
  pigServer.registerCode("testJavascriptExampleScript.js","javascript","myfuncs");
  pigServer.registerQuery("A = LOAD 'table_testJavascriptExampleScript' as (a0:chararray, a1:long);");
  pigServer.registerQuery("B = foreach A generate myfuncs.simple($0), myfuncs.helloworld(), myfuncs.complex($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),3);
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),3);
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),5);
  Schema outputSchema=pigServer.dumpSchema("B");
  Assert.assertEquals(new Schema.FieldSchema(null,DataType.BYTEARRAY),outputSchema.getField(0));
  Assert.assertEquals(new Schema.FieldSchema("word",DataType.CHARARRAY),outputSchema.getField(1));
  Schema inner=new Schema();
  inner.add(new Schema.FieldSchema("word",DataType.CHARARRAY));
  inner.add(new Schema.FieldSchema("num",DataType.LONG));
  Assert.assertEquals(new Schema.FieldSchema("tuple_0",inner,DataType.TUPLE),outputSchema.getField(2));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPythonBuiltinModuleImport2() throws Exception {
  String[] script={"#!/usr/bin/python","import re","@outputSchema(\"word:chararray\")","def resplit(content,regex,index):"," return re.compile(regex).split(content)[index];"};
  String[] input={"Hello world","The quick brown fox jumps over the lazy dog"};
  Util.createInputFile(cluster,"testPythonBuiltinModuleImport2",input);
  File scriptFile=Util.createLocalInputFile("importre.py",script);
  String[] pigScript={"register '" + scriptFile.getAbsolutePath() + "' using jython as pig;","A = LOAD 'testPythonBuiltinModuleImport2' as (a0:chararray);","B = foreach A generate pig.resplit(a0, '\\\\s+', 0);"};
  String pigScriptFile=Util.createLocalInputFile("importre.pig",pigScript).getPath();
  pigServer.registerScript(pigScriptFile);
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertTrue(t.get(0).toString().equals(input[0].split("\\s+")[0]));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.get(0).toString().equals(input[1].split("\\s+")[0]));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPythonAbsolutePath() throws Exception {
  String[] script={"#!/usr/bin/python","@outputSchema(\"x:{t:(num:long)}\")","def square(number):","\treturn (number * number)"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"table_testPythonAbsolutePath",input);
  File scriptFile=Util.createLocalInputFile("testPythonAbsolutePath.py",script);
  pigServer.registerCode(scriptFile.getAbsolutePath(),"jython","pig");
  pigServer.registerQuery("A = LOAD 'table_testPythonAbsolutePath' as (a0:long, a1:long);");
  pigServer.registerQuery("B = foreach A generate pig.square(a0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertTrue(t.toString().equals("(1)"));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(4)"));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.toString().equals("(9)"));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPythonBuiltinModuleImport1() throws Exception {
  String[] script={"#!/usr/bin/python","import os","@outputSchema(\"env:chararray\")","def getEnv(envkey):"," return os.getenv(envkey);"};
  String userenv=Shell.WINDOWS ? "USERNAME" : "USER";
  String[] input={userenv,"JAVA_HOME"};
  Util.createInputFile(cluster,"testPythonBuiltinModuleImport1",input);
  File scriptFile=Util.createLocalInputFile("importos.py",script);
  pigServer.registerCode(scriptFile.getAbsolutePath(),"jython","pig");
  pigServer.registerQuery("A = LOAD 'testPythonBuiltinModuleImport1' as (a0:chararray);");
  pigServer.registerQuery("B = foreach A generate pig.getEnv(a0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertTrue(t.get(0).toString().equals(System.getenv(input[0])));
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertTrue(t.get(0).toString().equals(System.getenv(input[1])));
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptingLanguagePython </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void varargTest() throws Exception {
  System.setProperty("python.cachedir",System.getProperty("java.io.tmpdir"));
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","@outputSchema(\"s:chararray\")","def firstNonempty(*args):","\tfor v in args:","\t\tif len(v) != 0:","\t\t\treturn v","\treturn ''","if __name__ == \"__main__\":","\tPig.compile(\"\"\"","data = load 'simple_table' AS (string1:chararray, string2:chararray);","data = foreach data generate firstNonempty(string1, string2) as id, string1, string2;","store data into 'simple_out';","\"\"\").bind().runSingle()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(pigServer.getPigContext(),"simple_table");
  Util.deleteFile(pigServer.getPigContext(),"simple_out");
  Util.createInputFile(pigServer.getPigContext(),"simple_table",input);
  Util.createLocalInputFile("testScript.py",script);
  ScriptEngine scriptEngine=ScriptEngine.getInstance("jython");
  Map<String,List<PigStats>> statsMap=scriptEngine.run(pigServer.getPigContext(),"testScript.py");
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue(stats.isSuccessful());
  String[] output=Util.readOutput(pigServer.getPigContext(),"simple_out");
  assertEquals(3,output.length);
  assertEquals(output[0],"1\t1\t3");
  assertEquals(output[1],"2\t2\t4");
  assertEquals(output[2],"3\t3\t5");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSecondarySort </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization2() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = limit A 10; E = order D by $0; generate group, E;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(0,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization3() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = limit A 10; E = order D by $1; F = order E by $0; generate group, F;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(2,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization8() throws Exception {
  String query=("A=LOAD 'input1' AS (a0);" + "B = group A all;" + "C = foreach B { D = order A by $0 desc; generate DIFF(D, D);};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(2,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization1() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = limit A 10; E = order D by $1; generate group, E;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization6() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = order A by $0 desc; generate group, D;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDistinctOptimization1() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = distinct A; generate group, D;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(0,so.getNumSortRemoved());
  assertEquals(1,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization7() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by ($0, $1);" + "C = foreach B { D = order A by $0, $1 desc; generate group, D;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization4() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = limit A 10; E = order D by $0, $1, $2; generate group, E;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortOptimization5() throws Exception {
  String query=("A=LOAD 'input1' AS (a0, a1, a2);" + "B = group A by $0;" + "C = foreach B { D = limit A 10; E = order D by $1; F = order E by $2; generate group, F;};"+ "store C into 'output';");
  SecondaryKeyOptimizer so=visitSecondaryKeyOptimizer(query);
  assertEquals(1,so.getNumUseSecondaryKey());
  assertEquals(1,so.getNumSortRemoved());
  assertEquals(0,so.getNumDistinctChanged());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplitCombine </h4><pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test2() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(700,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(800,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),3);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(800,pigSplit.getLength(0));
    }
 else     if (index == 1) {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(700,pigSplit.getLength(0));
    }
 else {
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(1,len);
      Assert.assertEquals(600,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test9() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l3","l4","l5"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l5","l6","l1"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),1);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    Assert.assertEquals(3,len);
    checkLocationOrdering(pigSplit.getLocations(),new String[]{"l5","l1","l6","l3","l4"});
    Assert.assertEquals(400,pigSplit.getLength(0));
    Assert.assertEquals(200,pigSplit.getLength(1));
    Assert.assertEquals(100,pigSplit.getLength(2));
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),2);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test8() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),1);
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    Assert.assertEquals(3,len);
    checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3","l4","l5"});
    Assert.assertEquals(200,pigSplit.getLength(0));
    Assert.assertEquals(100,pigSplit.getLength(1));
    Assert.assertEquals(100,pigSplit.getLength(2));
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test7() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(300,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(3,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(600,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else     if (idx == 1) {
      Assert.assertEquals(3,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(300,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(100,pigSplit.getLength(0));
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test6() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(600,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(300,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(3,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(600,pigSplit.getLength(0));
      Assert.assertEquals(400,pigSplit.getLength(1));
    }
 else     if (idx == 1) {
      Assert.assertEquals(3,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(300,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(100,pigSplit.getLength(0));
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test5() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(400,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,false,conf);
  Assert.assertEquals(3,result.size());
  int index=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (index == 0) {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(500,pigSplit.getLength(0));
    }
 else     if (index == 1) {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
 else {
      Assert.assertEquals(1,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(400,pigSplit.getLength(0));
    }
    index++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test11() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new ParquetInputSplit(new Path("path1"),0,100,new String[]{"l1","l2","l3"},new ArrayList<BlockMetaData>(),"","",new HashMap<String,String>(),new HashMap<String,String>()));
  rawSplits.add(new FileSplit(new Path("path2"),0,400,new String[]{"l5","l6","l1"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),1);
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
    DataOutput out=new DataOutputStream(outputStream);
    pigSplit.write(out);
    ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
    DataInput in=new DataInputStream(inputStream);
    PigSplit anotherSplit=new PigSplit();
    anotherSplit.setConf(conf);
    anotherSplit.readFields(in);
    Assert.assertEquals(500,anotherSplit.getLength());
    Assert.assertEquals(2,anotherSplit.getNumPaths());
    Assert.assertEquals("parquet.hadoop.ParquetInputSplit",(anotherSplit.getWrappedSplit(0).getClass().getName()));
    Assert.assertEquals("org.apache.hadoop.mapreduce.lib.input.FileSplit",(anotherSplit.getWrappedSplit(1).getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test4() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l4","l5"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(2,result.size());
  int idx=0;
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    if (idx == 0) {
      Assert.assertEquals(2,len);
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l4","l5"});
      Assert.assertEquals(500,pigSplit.getLength(0));
      Assert.assertEquals(100,pigSplit.getLength(1));
    }
 else {
      Assert.assertEquals(4,len);
      Assert.assertEquals(500,pigSplit.getLength(0));
      checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3"});
      Assert.assertEquals(200,pigSplit.getLength(1));
      Assert.assertEquals(200,pigSplit.getLength(2));
      Assert.assertEquals(100,pigSplit.getLength(3));
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test10() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new FileSplit(new Path("path1"),0,100,new String[]{"l1","l2","l3"}));
  rawSplits.add(new FileSplit(new Path("path2"),0,200,new String[]{"l3","l4","l5"}));
  rawSplits.add(new FileSplit(new Path("path3"),0,400,new String[]{"l5","l6","l1"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(result.size(),1);
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
    DataOutput out=new DataOutputStream(outputStream);
    pigSplit.write(out);
    ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
    DataInput in=new DataInputStream(inputStream);
    PigSplit anotherSplit=new PigSplit();
    anotherSplit.setConf(conf);
    anotherSplit.readFields(in);
    Assert.assertEquals(700,anotherSplit.getLength());
    checkLocationOrdering(pigSplit.getLocations(),new String[]{"l5","l1","l6","l3","l4"});
    Assert.assertEquals(3,anotherSplit.getNumPaths());
    Assert.assertEquals("org.apache.hadoop.mapreduce.lib.input.FileSplit",(anotherSplit.getWrappedSplit(0).getClass().getName()));
    Assert.assertEquals("org.apache.hadoop.mapreduce.lib.input.FileSplit",(anotherSplit.getWrappedSplit(1).getClass().getName()));
    Assert.assertEquals("org.apache.hadoop.mapreduce.lib.input.FileSplit",(anotherSplit.getWrappedSplit(2).getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3() throws IOException, InterruptedException {
  ArrayList<InputSplit> rawSplits=new ArrayList<InputSplit>();
  rawSplits.add(new DummyInputSplit(500,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(200,new String[]{"l1","l2","l3"}));
  rawSplits.add(new DummyInputSplit(100,new String[]{"l1","l4","l5"}));
  List<InputSplit> result=pigInputFormat.getPigSplits(rawSplits,0,ok,null,true,conf);
  Assert.assertEquals(1,result.size());
  for (  InputSplit split : result) {
    PigSplit pigSplit=(PigSplit)split;
    int len=pigSplit.getNumPaths();
    Assert.assertEquals(3,len);
    checkLocations(pigSplit.getLocations(),new String[]{"l1","l2","l3","l4","l5"});
    Assert.assertEquals(500,pigSplit.getLength(0));
    Assert.assertEquals(200,pigSplit.getLength(1));
    Assert.assertEquals(100,pigSplit.getLength(2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStore </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidationFailure() throws Exception {
  String input[]=new String[]{"some data"};
  String outputFileName="test-output.txt";
  boolean sawException=false;
  try {
    Util.createInputFile(ps.getPigContext(),outputFileName,input);
    String query="a = load '" + inputFileName + "' as (c:chararray, "+ "i:int,d:double);"+ "store a into '"+ outputFileName+ "' using PigStorage();";
    Util.buildLp(ps,query);
  }
 catch (  InvocationTargetException e) {
    FrontendException pve=(FrontendException)e.getCause();
    pve.printStackTrace();
    assertEquals(6000,pve.getErrorCode());
    assertEquals(PigException.REMOTE_ENVIRONMENT,pve.getErrorSource());
    assertTrue(pve.getCause() instanceof IOException);
    sawException=true;
  }
 finally {
    assertTrue(sawException);
    Util.deleteFile(ps.getPigContext(),outputFileName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStoreBase </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCleanupOnFailureMultiStore() throws Exception {
  String outputFileName1=TESTDIR + "/TestStore-output-" + new Random().nextLong()+ ".txt";
  String outputFileName2=TESTDIR + "/TestStore-output-" + new Random().nextLong()+ ".txt";
  Map<String,Boolean> filesToVerify=new HashMap<String,Boolean>();
  filesToVerify.put(outputFileName1 + "_cleanupOnFailure_succeeded1",Boolean.TRUE);
  filesToVerify.put(outputFileName2 + "_cleanupOnFailure_succeeded2",Boolean.TRUE);
  filesToVerify.put(outputFileName1 + "_cleanupOnFailure_failed1",Boolean.FALSE);
  filesToVerify.put(outputFileName2 + "_cleanupOnFailure_failed2",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED + "1",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED + "2",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPTASK_CALLED + "1",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPTASK_CALLED + "2",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITTASK_CALLED + "1",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITTASK_CALLED + "2",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTTASK_CALLED + "1",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTTASK_CALLED + "2",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED + "1",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED + "2",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTJOB_CALLED + "1",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTJOB_CALLED + "2",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_CLEANUPJOB_CALLED + "1",Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_CLEANUPJOB_CALLED + "2",Boolean.FALSE);
  String[] inputData=new String[]{"hello\tworld","bye\tworld"};
  String script="a = load '" + inputFileName + "';"+ "store a into '"+ outputFileName1+ "' using "+ DUMMY_STORE_CLASS_NAME+ "('true', '1');"+ "store a into '"+ outputFileName2+ "' using "+ DUMMY_STORE_CLASS_NAME+ "('false', '2');";
  if (mode.isLocal()) {
    if (!mode.toString().startsWith("TEZ")) {
      filesToVerify.put(DummyOutputCommitter.FILE_ABORTTASK_CALLED + "1",Boolean.FALSE);
      filesToVerify.put(DummyOutputCommitter.FILE_ABORTTASK_CALLED + "2",Boolean.FALSE);
    }
    if (Util.isHadoop1_x()) {
      filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED + "1",Boolean.FALSE);
      filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED + "2",Boolean.FALSE);
      filesToVerify.put(DummyOutputCommitter.FILE_ABORTJOB_CALLED + "1",Boolean.FALSE);
      filesToVerify.put(DummyOutputCommitter.FILE_ABORTJOB_CALLED + "2",Boolean.FALSE);
    }
  }
  Util.deleteFile(ps.getPigContext(),TESTDIR);
  ps.setBatchOn();
  Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
  Util.registerMultiLineQuery(ps,script);
  ps.executeBatch();
  for (  Entry<String,Boolean> entry : filesToVerify.entrySet()) {
    String condition=entry.getValue() ? "" : "not";
    assertEquals("Checking if file " + entry.getKey() + " does "+ condition+ " exists in "+ mode+ " mode",(boolean)entry.getValue(),Util.exists(ps.getPigContext(),entry.getKey()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetStoreSchema() throws Exception {
  Map<String,Boolean> filesToVerify=new HashMap<String,Boolean>();
  filesToVerify.put(outputFileName + "_storeSchema_test",Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED,Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_SETUPTASK_CALLED,Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITTASK_CALLED,Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTTASK_CALLED,Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED,Boolean.TRUE);
  filesToVerify.put(DummyOutputCommitter.FILE_ABORTJOB_CALLED,Boolean.FALSE);
  filesToVerify.put(DummyOutputCommitter.FILE_CLEANUPJOB_CALLED,Boolean.FALSE);
  String[] inputData=new String[]{"hello\tworld","bye\tworld"};
  String script="a = load '" + inputFileName + "' as (a0:chararray, a1:chararray);"+ "store a into '"+ outputFileName+ "' using "+ DUMMY_STORE_CLASS_NAME+ "();";
  if (!mode.isLocal()) {
    filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED,Boolean.TRUE);
    filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED,Boolean.TRUE);
  }
 else {
    if (Util.isHadoop1_x()) {
      filesToVerify.put(DummyOutputCommitter.FILE_SETUPJOB_CALLED,Boolean.FALSE);
      filesToVerify.put(DummyOutputCommitter.FILE_COMMITJOB_CALLED,Boolean.FALSE);
    }
  }
  ps.setBatchOn();
  Util.deleteFile(ps.getPigContext(),TESTDIR);
  Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
  Util.registerMultiLineQuery(ps,script);
  ps.executeBatch();
  for (  Entry<String,Boolean> entry : filesToVerify.entrySet()) {
    String condition=entry.getValue() ? "" : "not";
    assertEquals("Checking if file " + entry.getKey() + " does "+ condition+ " exists in "+ mode+ " mode",(boolean)entry.getValue(),Util.exists(ps.getPigContext(),entry.getKey()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStoreOld </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleStore() throws Exception {
  pig.registerQuery("A = load " + fileName + ";");
  pig.store("A",tmpFile1);
  pig.registerQuery("B = load " + tmpFile1 + ";");
  Iterator<Tuple> iter=pig.openIterator("B");
  int i=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(DataType.toInteger(t.get(0)).intValue(),i);
    assertEquals(DataType.toInteger(t.get(1)).intValue(),i);
    i++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSubtract </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Subtract operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 - inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 - inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 - inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 - inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTextDataParser </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLongValueType() throws Exception {
  String myMap="[key1#1l]";
  Schema schema=Utils.getSchemaFromString("m:map[long]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Long);
  String value=String.valueOf(v);
  assertEquals("1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloat() throws Exception {
  String myFloat="0.1";
  Float f=ps.getLoadCaster().bytesToFloat(myFloat.getBytes());
  assertEquals(Float.valueOf(0.1f),f);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTuple() throws Exception {
  String myTuple="(1,a)";
  Object o=ps.getLoadCaster().bytesToTuple(myTuple.getBytes(),getTupleFieldSchema());
  assertTrue(o instanceof Tuple);
  Tuple t=(Tuple)o;
  Tuple expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,1);
  expectedTuple.set(1,"a");
  assertEquals(expectedTuple,t);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBag() throws Exception {
  String myBag="{(1,a),(2,b)}";
  Object o=ps.getLoadCaster().bytesToBag(myBag.getBytes(),getBagFieldSchema());
  assertTrue(o instanceof DataBag);
  DataBag b=(DataBag)o;
  DataBag expectedBag=bagFactory.newDefaultBag();
  Tuple expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,1);
  expectedTuple.set(1,"a");
  expectedBag.add(expectedTuple);
  expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,2);
  expectedTuple.set(1,"b");
  expectedBag.add(expectedTuple);
  assertEquals(expectedBag,b);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDoubleValueType() throws Exception {
  String myMap="[key1#0.1]";
  Schema schema=Utils.getSchemaFromString("m:map[double]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Double);
  String value=String.valueOf(v);
  assertEquals("0.1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateTime() throws Exception {
  String myDateTime="1970-01-01T00:00:00.000Z";
  DateTime d=ps.getLoadCaster().bytesToDateTime(myDateTime.getBytes());
  assertEquals(new DateTime(myDateTime,DateTimeZone.forID("+00:00")),d);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapStringValueType() throws Exception {
  String myMap="[key1#value1]";
  Schema schema=Utils.getSchemaFromString("m:map[chararray]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof String);
  String value=String.valueOf(v);
  assertEquals("value1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testString() throws Exception {
  String myString="1a";
  String s=ps.getLoadCaster().bytesToCharArray(myString.getBytes());
  assertEquals(myString,s);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapFloatValueType() throws Exception {
  String myMap="[key1#0.1f]";
  Schema schema=Utils.getSchemaFromString("m:map[float]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Float);
  String value=String.valueOf(v);
  assertEquals("0.1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLong() throws Exception {
  String myLong="1";
  Long l=ps.getLoadCaster().bytesToLong(myLong.getBytes());
  assertEquals(Long.valueOf(1L),l);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInteger() throws Exception {
  String myInteger="1";
  Integer i=ps.getLoadCaster().bytesToInteger(myInteger.getBytes());
  assertEquals(Integer.valueOf(1),i);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBoolean() throws Exception {
  String myBoolean="true";
  Boolean b=ps.getLoadCaster().bytesToBoolean(myBoolean.getBytes());
  assertEquals(Boolean.TRUE,b);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDouble() throws Exception {
  String myDouble="0.1";
  Double d=ps.getLoadCaster().bytesToDouble(myDouble.getBytes());
  assertEquals(Double.valueOf(0.1),d);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapIntegerValueType() throws Exception {
  String myMap="[key1#1]";
  Schema schema=Utils.getSchemaFromString("m:map[int]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Integer);
  String value=String.valueOf(v);
  assertEquals("1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBag() throws Exception {
  String myBag="{}";
  Object o=ps.getLoadCaster().bytesToBag(myBag.getBytes(),getBagFieldSchema());
  assertTrue(o instanceof DataBag);
  DataBag b=(DataBag)o;
  assertEquals(0,b.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitInCoGroupUncompressed() throws Exception {
  resetLog(InterStorage.class);
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
  assertTrue(checkLogFileMessage(new String[]{InterStorage.useLog}));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTFileRecordReader() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("1.txt"));
  for (int i=0; i < 30; i++) {
    w.println("1\tthis is a test for compression of temp files");
  }
  w.close();
  Util.copyFromLocalToCluster(cluster,"1.txt","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter("tfile.pig"));
  w1.println("A = load '1.txt' as (a0:int, a1:chararray);");
  w1.println("B = group A by a0;");
  w1.println("store B into 'tfile' using org.apache.pig.impl.io.TFileStorage();");
  w1.close();
  PrintWriter w2=new PrintWriter(new FileWriter("tfile2.pig"));
  w2.println("A = load 'tfile' using org.apache.pig.impl.io.TFileStorage() as (a:int, b:bag{(b0:int, b1:chararray)});");
  w2.println("B = foreach A generate flatten($1);");
  w2.println("store B into '2.txt';");
  w2.close();
  try {
    String[] args={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile.pig"};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    String[] args2={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile2.pig"};
    PigStats stats2=PigRunner.run(args2,null);
    assertTrue(stats2.isSuccessful());
    OutputStats os=stats2.result("B");
    Iterator<Tuple> iter=os.iterator();
    int count=0;
    String expected="(1,this is a test for compression of temp files)";
    while (iter.hasNext()) {
      count++;
      assertEquals(expected,iter.next().toString());
    }
    assertEquals(30,count);
  }
  finally {
    new File("tfile.pig").delete();
    new File("tfile2.pig").delete();
    new File("1.txt").delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServerRegister() throws Exception {
  Util.createLocalInputFile("testRegisterScripts.jar",new String[]{"mary had a little lamb"});
  Util.createInputFile(cluster,"input1",new String[]{"abc:123","def:456","ghi:789"});
  File scriptFile=Util.createFile(new String[]{"register 'testRegisterScripts.jar';","a = load 'input1' using " + PigStorage.class.getName() + "(':');","b = foreach a generate $0;","store b into '/bla1';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServer() throws Exception {
  Util.createInputFile(cluster,"input",new String[]{"abc\t123","def\t456","ghi\t789"});
  File scriptFile=Util.createFile(new String[]{"a = load 'input' using " + PigStorage.class.getName() + "('\t');","b = foreach a generate $0;","store b into '/bla';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTuple </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTupleSerDe() throws Exception {
  for (int i=0; i < 1000; i++) {
    Tuple t=mTupleFactory.newTuple(i);
    for (int j=0; j < i; j++) {
      t.set(j,Integer.valueOf(random.nextInt()));
    }
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    DataOutput out=new DataOutputStream(baos);
    bis.writeDatum(out,t);
    DataInput in=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    Tuple t2=(Tuple)bis.readDatum(in);
    assertEquals(t,t2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDistinct1() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> innerList=new ArrayList<FieldSchema>();
    innerList.add(new FieldSchema("innerfield1",DataType.BAG));
    innerList.add(new FieldSchema("innerfield2",DataType.FLOAT));
    Schema innerSchema=new Schema(innerList);
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2",DataType.BYTEARRAY));
    fsList1.add(new FieldSchema("field3",innerSchema));
    fsList1.add(new FieldSchema("field4",DataType.BAG));
    inputSchema1=new Schema(fsList1);
  }
  load1.setSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema1));
  LODistinct distinct1=new LODistinct(plan);
  plan.add(load1);
  plan.add(distinct1);
  plan.connect(load1,distinct1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  typeChecker.visit();
  printMessageCollector(collector);
  LogicalSchema outputSchema=distinct1.getSchema();
  assertTrue(load1.getSchema().isEqual(outputSchema));
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLineage1NoSchema() throws Throwable {
  String query="a = load 'a';" + "b = foreach a generate $1 + 1.0;";
  CastExpression cast=getCastFromLastForeach(query);
  assertTrue(cast.getFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionCastingInsert2() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  LOLoad load2=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1a",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2a",DataType.BYTEARRAY));
    inputSchema1=new Schema(fsList1);
  }
  Schema inputSchema2=null;
{
    List<FieldSchema> fsList2=new ArrayList<FieldSchema>();
    fsList2.add(new FieldSchema("field1b",DataType.DOUBLE));
    fsList2.add(new FieldSchema("field2b",DataType.DOUBLE));
    inputSchema2=new Schema(fsList2);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema1));
  load2.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema2));
  ArrayList<LogicalRelationalOperator> inputList=new ArrayList<LogicalRelationalOperator>();
  inputList.add(load1);
  inputList.add(load2);
  LOUnion union=new LOUnion(plan,false);
  plan.add(load1);
  plan.add(load2);
  plan.add(union);
  plan.connect(load1,union);
  plan.connect(load2,union);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  typeChecker.visit();
  printMessageCollector(collector);
  Schema outputSchema=org.apache.pig.newplan.logical.Util.translateSchema(union.getSchema());
  Schema expectedSchema=null;
{
    List<FieldSchema> fsListExpected=new ArrayList<FieldSchema>();
    fsListExpected.add(new FieldSchema("field1a",DataType.DOUBLE));
    fsListExpected.add(new FieldSchema("field2a",DataType.DOUBLE));
    expectedSchema=new Schema(fsListExpected);
  }
  assertTrue(Schema.equals(outputSchema,expectedSchema,true,false));
{
    List<Operator> sucList1=plan.getSuccessors(load1);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,true,DataType.DOUBLE);
    checkForEachCasting(foreach,1,true,DataType.DOUBLE);
  }
{
    List<Operator> sucList1=plan.getSuccessors(load2);
    assertEquals(1,sucList1.size());
    assertTrue(sucList1.get(0) instanceof LOUnion);
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareNULL() throws Throwable {
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : (i : int));" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.TUPLE,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by t1 <= null;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBincond() throws Throwable {
  String query="a= load 'a' as (name: chararray, age: int, gpa: float);" + "b = group a by name;" + "c = foreach b generate (IsEmpty(a) ? " + TestBinCondFieldSchema.class.getName() + "(*): a);";
  LOForEach foreach=getForeachFromPlan(query);
  Schema.FieldSchema charFs=new FieldSchema(null,DataType.CHARARRAY);
  Schema.FieldSchema intFs=new FieldSchema(null,DataType.INTEGER);
  Schema.FieldSchema floatFs=new FieldSchema(null,DataType.FLOAT);
  Schema tupleSchema=new Schema();
  tupleSchema.add(charFs);
  tupleSchema.add(intFs);
  tupleSchema.add(floatFs);
  Schema.FieldSchema bagFs=null;
  Schema bagSchema=new Schema();
  bagSchema.add(new FieldSchema(null,tupleSchema,DataType.TUPLE));
  try {
    bagFs=new Schema.FieldSchema(null,bagSchema,DataType.BAG);
  }
 catch (  FrontendException fee) {
    fail("Did not expect an error");
  }
  Schema expectedSchema=new Schema(bagFs);
  Schema foreachSch=org.apache.pig.newplan.logical.Util.translateSchema(foreach.getSchema());
  assertTrue(Schema.equals(foreachSch,expectedSchema,false,true));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMapLookupLineage2() throws Throwable {
  String query="a = load 'a' as (s, m, l);" + "b = foreach a generate s#'x' as f1, s#'y' as f2, s#'z' as f3;" + "c = group b by f1;"+ "d = foreach c {fil = filter b by f2 == 1; generate flatten(group), SUM(fil.f3);};";
  LOForEach foreach=getForeachFromPlan(query);
  LogicalPlan innerPlan=foreach.getInnerPlan();
  LOFilter filter=null;
  Iterator<Operator> iter=innerPlan.getOperators();
  while (iter.hasNext()) {
    Operator op=iter.next();
    if (op instanceof LOFilter)     filter=(LOFilter)op;
  }
  LogicalExpressionPlan filterPlan=filter.getFilterPlan();
  CastExpression cast=getCastFromExpPlan(filterPlan);
  assertTrue(cast.getFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinCondForOuterJoin() throws Throwable {
  String query="a= LOAD 'student_data' AS (name: chararray, age: int, gpa: float);" + "b = LOAD 'voter_data' AS (name: chararray, age: int, registration: chararray, contributions: float);" + "c = COGROUP a BY name, b BY name;"+ "d = FOREACH c GENERATE group, "+ "flatten((not IsEmpty(a) ? a : (bag{tuple(chararray, int, float)}){(null, null, null)})),"+ " flatten((not IsEmpty(b) ? b : (bag{tuple(chararray, int, chararray, float)}){(null,null,null, null)}));";
  LOForEach foreach=getForeachFromPlan(query);
  String expectedSchemaString="mygroup: chararray,A::name: chararray,A::age: int," + "A::gpa: float,B::name: chararray,B::age: int," + "B::registration: chararray,B::contributions: float";
  Schema expectedSchema=Utils.getSchemaFromString(expectedSchemaString);
  Schema foreachSch=org.apache.pig.newplan.logical.Util.translateSchema(foreach.getSchema());
  assertTrue(Schema.equals(foreachSch,expectedSchema,false,true));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityMapCast() throws Throwable {
  String query="a = load 'a' as (t : map[], col);" + "b = filter a by t != col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.MAP,castExp.getType());
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testLineage1() throws Throwable {
  String query="a = load 'a' as (field1: int, field2: float, field3: chararray );" + "b = foreach a generate field1 + 1.0;";
  CastExpression cast=getCastFromLastForeach(query);
  assertNull(cast.getFuncSpec());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionCastingInsert1() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  LOLoad load2=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1a",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2a",DataType.LONG));
    fsList1.add(new FieldSchema(null,DataType.BYTEARRAY));
    fsList1.add(new FieldSchema(null,DataType.CHARARRAY));
    inputSchema1=new Schema(fsList1);
  }
  Schema inputSchema2=null;
{
    List<FieldSchema> fsList2=new ArrayList<FieldSchema>();
    fsList2.add(new FieldSchema("field1b",DataType.DOUBLE));
    fsList2.add(new FieldSchema(null,DataType.INTEGER));
    fsList2.add(new FieldSchema("field3b",DataType.FLOAT));
    fsList2.add(new FieldSchema("field4b",DataType.CHARARRAY));
    inputSchema2=new Schema(fsList2);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema1));
  load2.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema2));
  ArrayList<LogicalRelationalOperator> inputList=new ArrayList<LogicalRelationalOperator>();
  inputList.add(load1);
  inputList.add(load2);
  LOUnion union=new LOUnion(plan,false);
  plan.add(load1);
  plan.add(load2);
  plan.add(union);
  plan.connect(load1,union);
  plan.connect(load2,union);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  typeChecker.visit();
  printMessageCollector(collector);
  Schema outputSchema=org.apache.pig.newplan.logical.Util.translateSchema(union.getSchema());
  Schema expectedSchema=null;
{
    List<FieldSchema> fsListExpected=new ArrayList<FieldSchema>();
    fsListExpected.add(new FieldSchema("field1a",DataType.DOUBLE));
    fsListExpected.add(new FieldSchema("field2a",DataType.LONG));
    fsListExpected.add(new FieldSchema("field3b",DataType.FLOAT));
    fsListExpected.add(new FieldSchema("field4b",DataType.CHARARRAY));
    expectedSchema=new Schema(fsListExpected);
  }
  assertTrue(Schema.equals(outputSchema,expectedSchema,true,false));
{
    List<Operator> sucList1=plan.getSuccessors(load1);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,true,DataType.DOUBLE);
    checkForEachCasting(foreach,1,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,2,true,DataType.FLOAT);
    checkForEachCasting(foreach,3,false,DataType.UNKNOWN);
  }
{
    List<Operator> sucList1=plan.getSuccessors(load2);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,1,true,DataType.LONG);
    checkForEachCasting(foreach,2,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,3,false,DataType.UNKNOWN);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookupCast() throws Exception {
  String input[]={"[k1#hello,k2#bye]","[k1#good,k2#morning]"};
  PigServer ps=new PigServer(ExecType.LOCAL);
  File f=org.apache.pig.test.Util.createInputFile("test",".txt",input);
  String inputFileName=Util.generateURI(f.getAbsolutePath(),ps.getPigContext());
  String query="a= load '" + inputFileName + "' as (m);"+ " b = foreach a generate m#'k1';";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
  query="a= load '" + inputFileName + "' as (m:[]);"+ "b = foreach a generate m#'k1';";
  LOForEach foreach=getForeachFromPlan(query);
  LOGenerate loGen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  Operator outExp=loGen.getOutputPlans().get(0).getSources().get(0);
  assertFalse("outExp is not cast",outExp instanceof CastExpression);
  ps.registerQuery("a = load '" + inputFileName + "' as (m);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  Iterator<Tuple> it=ps.openIterator("b");
  String[] expectedResults=new String[]{"(hello)","(good)"};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
  ps.registerQuery("a = load '" + inputFileName + "' as (m:[]);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  it=ps.openIterator("b");
  expectedResults=new String[]{"(hello)","(good)"};
  i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityTupleCast() throws Throwable {
  String query="a = load 'a' as (t : (i : int, j : int), col);" + "b = filter a by t == col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.TUPLE,castExp.getType());
}

</code></pre>

<br>
<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLineage2() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = foreach a generate field1 + 1.0;";
  CastExpression cast=getCastFromLastForeach(query);
  assertTrue(cast.getFuncSpec().getClassName().startsWith("org.apache.pig.builtin.PigStorage"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypedMap </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexLoad() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#{(1,2),(1,3)},134#]","[key2#]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexLoad",input);
  String query="a = load '" + tmpDirName + "/testComplexLoad' as (m:map[bag{(i:int,j:int)}]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[{(i: int,j: int)}]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("134"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataBag);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("{(1,2),(1,3)}"));
  Assert.assertTrue(((Map)t.get(0)).get("134") == null);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") == null);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexCast2() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexCast2",input);
  String query="a = load '" + tmpDirName + "/testComplexCast2' as (m:[int]);"+ "b = foreach a generate ([long])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[long]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Long);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Long);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnTypedMap() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testUnTypedMap",input);
  String query="a = load '" + tmpDirName + "/testUnTypedMap' as (m:[]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataByteArray);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof DataByteArray);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOrderBy() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key1#2]","[key#2,key3#2]","[key#11]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testOrderBy",input);
  String query="a = load '" + tmpDirName + "/testOrderBy' as (m:[int]);"+ "b = foreach a generate m#'key' as b0;"+ "c = order b by b0;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("c");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.toString().equals("(1)"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.toString().equals("(2)"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.toString().equals("(11)"));
  Assert.assertFalse(it.hasNext());
  query="a = load '" + tmpDirName + "/testOrderBy' as (m:[]);"+ "b = foreach a generate m#'key' as b0;"+ "c = order b by b0;";
  Util.registerMultiLineQuery(pig,query);
  it=pig.openIterator("c");
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.toString().equals("(1)"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.toString().equals("(11)"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.toString().equals("(2)"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapKeyLookup() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testSimpleMapKeyLookup",input);
  String query="a = load '" + tmpDirName + "/testSimpleMapKeyLookup' as (m:map[int]);"+ "b = foreach a generate m#'key';";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{int}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue((Integer)t.get(0) == 1);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue((Integer)t.get(0) == 2);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleLoad() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/table_testSimpleLoad",input);
  String query="  a = load '" + tmpDirName + "/table_testSimpleLoad' as (m:map[int]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[int]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexCast() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#{(1,2),(1,3)},134#]","[key2#]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexCast",input);
  String query="a = load '" + tmpDirName + "/testComplexCast' as (m);"+ "b = foreach a generate ([{(i:int,j:int)}])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[{(i: int,j: int)}]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("134"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataBag);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("{(1,2),(1,3)}"));
  Assert.assertTrue(((Map)t.get(0)).get("134") == null);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") == null);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapCast() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testSimpleMapCast",input);
  String query="a = load '" + tmpDirName + "/testSimpleMapCast' as (m);"+ "b = foreach a generate ([int])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[int]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDF </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNormalDefine() throws Exception {
  String input="udf_test_jira_2430_2.txt";
  Util.createLocalInputFile(input,new String[]{"1"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:int);");
  pigServer.registerQuery("DEFINE udftest1 org.apache.pig.test.TestUDF$UdfWithFuncSpecWithArgs('1');");
  pigServer.registerQuery("DEFINE udftest2 org.apache.pig.test.TestUDF$UdfWithFuncSpecWithArgs('2');");
  pigServer.registerQuery("DEFINE udftest3 org.apache.pig.test.TestUDF$UdfWithFuncSpecWithArgs('3');");
  pigServer.registerQuery("B = FOREACH A GENERATE udftest1(x), udftest2(x), udftest3(x);");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals(Integer.valueOf(1),t.get(0));
  assertEquals(Integer.valueOf(2),t.get(1));
  assertEquals(Integer.valueOf(3),t.get(2));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFReturnMap_MapReduceMode() throws Exception {
  Util.createInputFile(cluster,"a.txt",new String[]{"dummy","dummy"});
  FileLocalizer.deleteTempFiles();
  PigServer pig=new PigServer(cluster.getExecType(),cluster.getProperties());
  pig.registerQuery("A = LOAD 'a.txt';");
  pig.registerQuery("B = FOREACH A GENERATE org.apache.pig.test.utils.MyUDFReturnMap();");
  Iterator<Tuple> iterator=pig.openIterator("B");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    @SuppressWarnings("unchecked") Map<Object,Object> result=(Map<Object,Object>)tuple.get(0);
    assertEquals(result,MyUDFReturnMap.map);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHelperEvalFunc() throws Exception {
  String pref="org.apache.pig.test.utils.HelperEvalFuncUtils$";
  String[][] UDF={{pref + "BasicSUM",pref + "AccSUM",pref + "AlgSUM","SUM"},{pref + "BasicCOUNT",pref + "AccCOUNT",pref + "AlgCOUNT","COUNT"},{"BasLCWC","AccLCWC","AlgLCWC","5*COUNT"}};
  String input="udf_test_helper_eval_func.txt";
  Util.createLocalInputFile(input,new String[]{"1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15"});
  for (  String[] udfs : UDF) {
    for (int i=0; i < udfs.length - 1; i++) {
      String query="DEFINE BasLCWC " + pref + "BasicLongCountWithConstructor('5');";
      query+="DEFINE AccLCWC " + pref + " AccLongCountWithConstructor('5');";
      query+="DEFINE AlgLCWC " + pref + "AlgLongCountWithConstructor('5');";
      query+="A = load '" + input + "' as (x:int);";
      query+="B = foreach (group A all) generate ";
      for (      String s : Arrays.copyOfRange(udfs,i,udfs.length - 1)) {
        query+=s + "(A),";
      }
      query+=udfs[udfs.length - 1] + "(A);";
      PigServer pigServer=new PigServer(Util.getLocalTestMode());
      pigServer.registerQuery(query);
      Iterator<Tuple> it=pigServer.openIterator("B");
      while (it.hasNext()) {
        Tuple t=it.next();
        Long val=(Long)t.get(0);
        for (int j=1; j < i; j++) {
          assertEquals(val,t.get(j));
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFReturnMap_LocalMode() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(TempScriptFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("B");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    @SuppressWarnings("unchecked") Map<Object,Object> result=(Map<Object,Object>)tuple.get(0);
    assertEquals(result,MyUDFReturnMap.map);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFContext </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFContext() throws Exception {
  File a=Util.createInputFile("inp1","txt",new String[]{"dumb"});
  File b=Util.createInputFile("inp2","txt",new String[]{"dumber"});
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] statement={"A = LOAD '" + Util.encodeEscape(a.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('joe');","B = LOAD '" + Util.encodeEscape(b.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('jane');","C = union A, B;","D = FOREACH C GENERATE $0, $1, org.apache.pig.test.utils.UDFContextTestEvalFunc($0), " + "org.apache.pig.test.utils.UDFContextTestEvalFunc2($0);"};
  File tmpFile=File.createTempFile("temp_jira_851",".pig");
  FileWriter writer=new FileWriter(tmpFile);
  for (  String line : statement) {
    writer.write(line + "\n");
  }
  writer.close();
  pig.registerScript(tmpFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("D");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    if ("dumb".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"joe");
    }
 else     if ("dumber".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"jane");
    }
    assertEquals(Integer.valueOf(tuple.get(2).toString()),new Integer(5));
    assertEquals(tuple.get(3).toString(),"five");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFContextSeparator() throws Exception {
  File inputFile=Util.createInputFile("input","txt",new String[]{"f1\tf2\tf3\tf4\tf5"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),new Properties());
  Storage.Data data=resetData(pigServer);
  String inputPath=Util.encodeEscape(inputFile.getAbsolutePath());
  String query="A = LOAD '" + inputPath + "' USING PigStorage();"+ "B = LOAD '"+ inputPath+ "' USING PigStorage();"+ "B = FOREACH B GENERATE $0, $1;"+ "C = LOAD '"+ inputPath+ "' USING "+ FieldsByIndexLoader.class.getName()+ "('1,2');"+ "C = FOREACH C GENERATE *, B.$0;"+ "STORE A INTO 'A' USING mock.Storage();"+ "STORE B INTO 'B' USING mock.Storage();"+ "STORE C INTO 'C' USING mock.Storage();";
  pigServer.registerQuery(query);
  List<Tuple> a=data.get("A");
  List<Tuple> b=data.get("B");
  List<Tuple> c=data.get("C");
  assertEquals(1,a.size());
  assertEquals(1,b.size());
  assertEquals(1,c.size());
  DataByteArray f1=new DataByteArray("f1");
  DataByteArray f2=new DataByteArray("f2");
  DataByteArray f3=new DataByteArray("f3");
  DataByteArray f4=new DataByteArray("f4");
  DataByteArray f5=new DataByteArray("f5");
  assertEquals(tuple(f1,f2,f3,f4,f5),a.get(0));
  assertEquals(tuple(f1,f2),b.get(0));
  assertEquals(tuple(f2,f3,f1),c.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFGroovy </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEvalFunc_Static() throws Exception {
  String[] groovyStatements={"import org.apache.pig.builtin.OutputSchema;","class GroovyUDF {","  @OutputSchema('x:long')","  static long square(long x) {","    return x*x;","  }","}"};
  File tmpScriptFile=File.createTempFile("temp_groovy_udf",".groovy");
  tmpScriptFile.deleteOnExit();
  FileWriter writer=new FileWriter(tmpScriptFile);
  for (  String line : groovyStatements) {
    writer.write(line + "\n");
  }
  writer.close();
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerCode(tmpScriptFile.getCanonicalPath(),"groovy","groovyudfs");
  Data data=resetData(pigServer);
  data.set("foo0",tuple(1),tuple(2),tuple(3),tuple(4));
  pigServer.registerQuery("A = LOAD 'foo0' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE groovyudfs.square($0);");
  pigServer.registerQuery("STORE B INTO 'bar0' USING mock.Storage();");
  List<Tuple> out=data.get("bar0");
  assertEquals(tuple(1L),out.get(0));
  assertEquals(tuple(4L),out.get(1));
  assertEquals(tuple(9L),out.get(2));
  assertEquals(tuple(16L),out.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOutputSchemaFunction() throws Exception {
  String[] groovyStatements={"import org.apache.pig.scripting.groovy.OutputSchemaFunction;","class GroovyUDFs {","  @OutputSchemaFunction('squareSchema')","  public static square(x) {","    return x * x;","  }","  public static squareSchema(input) {","    return input;","  }","}"};
  File tmpScriptFile=File.createTempFile("temp_groovy_udf",".groovy");
  tmpScriptFile.deleteOnExit();
  FileWriter writer=new FileWriter(tmpScriptFile);
  for (  String line : groovyStatements) {
    writer.write(line + "\n");
  }
  writer.close();
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerCode(tmpScriptFile.getCanonicalPath(),"groovy","groovyudfs");
  Data data=resetData(pigServer);
  data.set("foo4",tuple(1,1L,1.0F,1.0D),tuple(2,2L,2.0F,2.0D));
  pigServer.registerQuery("A = LOAD 'foo4' USING mock.Storage() AS (i: int, l: long, f: float, d: double);");
  pigServer.registerQuery("B = FOREACH A GENERATE groovyudfs.square(i),groovyudfs.square(l),groovyudfs.square(f),groovyudfs.square(d);");
  pigServer.registerQuery("STORE B INTO 'bar4' USING mock.Storage();");
  List<Tuple> out=data.get("bar4");
  assertEquals(tuple(1,1L,1.0D,1.0D),out.get(0));
  assertEquals(tuple(4,4L,4.0D,4.0D),out.get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEvalFunc_NonStatic() throws Exception {
  String[] groovyStatements={"import org.apache.pig.builtin.OutputSchema;","class GroovyUDF {","  private final long multiplicator;","  public GroovyUDF() {","    this.multiplicator = 42L;","  }","  @OutputSchema('x:long')","  long mul(long x) {","    return x*this.multiplicator;","  }","}"};
  File tmpScriptFile=File.createTempFile("temp_groovy_udf",".groovy");
  tmpScriptFile.deleteOnExit();
  FileWriter writer=new FileWriter(tmpScriptFile);
  for (  String line : groovyStatements) {
    writer.write(line + "\n");
  }
  writer.close();
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerCode(tmpScriptFile.getCanonicalPath(),"groovy","groovyudfs");
  Data data=resetData(pigServer);
  data.set("foo1",tuple(1));
  pigServer.registerQuery("A = LOAD 'foo1' USING mock.Storage();");
  pigServer.registerQuery("B = FOREACH A GENERATE groovyudfs.mul($0);");
  pigServer.registerQuery("STORE B INTO 'bar1' USING mock.Storage();");
  List<Tuple> out=data.get("bar1");
  assertEquals(tuple(42L),out.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroovyToPig() throws Exception {
  Object groovyObject=Boolean.TRUE;
  Object pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Boolean);
  assertEquals(true,pigObject);
  groovyObject=Byte.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Byte.MIN_VALUE,pigObject);
  groovyObject=Short.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Short.MIN_VALUE,pigObject);
  groovyObject=Integer.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals(Integer.MIN_VALUE,pigObject);
  groovyObject=Long.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Long);
  assertEquals(Long.MIN_VALUE,pigObject);
  groovyObject=BigInteger.TEN;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=Float.MIN_NORMAL;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Float);
  assertEquals(Float.MIN_NORMAL,pigObject);
  groovyObject=Double.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Double);
  assertEquals(Double.MIN_VALUE,pigObject);
  groovyObject=new BigDecimal("42.42");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject="Dans le cochon tout est bon !";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",pigObject);
  groovyObject="Surtout le jambon".getBytes("UTF-8");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataByteArray);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),((DataByteArray)pigObject).get());
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Pate";
  ((Object[])groovyObject)[1]="Henaff";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Pate",((Tuple)pigObject).get(0));
  assertEquals("Henaff",((Tuple)pigObject).get(1));
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Rillettes";
  ((Object[])groovyObject)[1]="Bordeau Chesnel";
  groovyObject=new groovy.lang.Tuple((Object[])groovyObject);
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Rillettes",((Tuple)pigObject).get(0));
  assertEquals("Bordeau Chesnel",((Tuple)pigObject).get(1));
  groovyObject=new ArrayList();
  ((List)groovyObject).add("Jaret");
  ((List)groovyObject).add("Filet Mignon");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataBag);
  assertEquals(2,((DataBag)pigObject).size());
  Iterator<Tuple> iter=((DataBag)pigObject).iterator();
  Set<String> values=new HashSet<String>();
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(1,t.size());
    values.add((String)t.get(0));
  }
  assertEquals(2,values.size());
  assertTrue(values.contains("Jaret"));
  assertTrue(values.contains("Filet Mignon"));
  groovyObject=new HashMap<String,String>();
  ((Map)groovyObject).put("Henaff","a bord");
  ((Map)groovyObject).put("Copains","comme cochons");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Map);
  assertEquals(2,((Map)pigObject).size());
  assertEquals("a bord",((Map)pigObject).get("Henaff"));
  assertEquals("comme cochons",((Map)pigObject).get("Copains"));
  groovyObject=TupleFactory.getInstance().newTuple(2);
  ((Tuple)groovyObject).set(0,"jambon");
  ((Tuple)groovyObject).set(1,"blanc");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new DefaultDataBag();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new org.joda.time.DateTime();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  groovyObject=null;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertNull(pigObject);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigToGroovy() throws Exception {
  Object pigObject=Boolean.TRUE;
  Object groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Boolean);
  assertEquals(true,groovyObject);
  pigObject=Integer.valueOf(42);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Integer);
  assertEquals(42,groovyObject);
  pigObject=Long.valueOf(0x100000000L);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Long);
  assertEquals(0x100000000L,groovyObject);
  pigObject=Float.MIN_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Float);
  assertEquals(Float.MIN_VALUE,groovyObject);
  pigObject=Double.MAX_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Double);
  assertEquals(Double.MAX_VALUE,groovyObject);
  pigObject="Dans le cochon tout est bon !";
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",groovyObject);
  pigObject=new DataByteArray("Surtout le jambon".getBytes("UTF-8"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof byte[]);
  assertNotSame(groovyObject,pigObject);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),(byte[])groovyObject);
  pigObject=new org.joda.time.DateTime();
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  pigObject=tuple("a","b","c");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(3,((groovy.lang.Tuple)groovyObject).size());
  assertEquals("a",((groovy.lang.Tuple)groovyObject).get(0));
  assertEquals("b",((groovy.lang.Tuple)groovyObject).get(1));
  assertEquals("c",((groovy.lang.Tuple)groovyObject).get(2));
  pigObject=bag(tuple("a"),tuple("b"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(2,((groovy.lang.Tuple)groovyObject).size());
  assertEquals(2L,((groovy.lang.Tuple)groovyObject).get(0));
  assertTrue(((groovy.lang.Tuple)groovyObject).get(1) instanceof Iterator);
  Iterator<groovy.lang.Tuple> iter=(Iterator)((groovy.lang.Tuple)groovyObject).get(1);
  groovy.lang.Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("a",t.get(0));
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("b",t.get(0));
  pigObject=new HashMap<String,String>();
  ((Map)pigObject).put("Pate","Henaff");
  ((Map)pigObject).put("Rillettes","Bordeau Chesnel");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Map);
  assertEquals(2,((Map)groovyObject).size());
  assertEquals("Henaff",((Map)groovyObject).get("Pate"));
  assertEquals("Bordeau Chesnel",((Map)groovyObject).get("Rillettes"));
  pigObject=BigInteger.ONE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=new BigDecimal("42.42");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=null;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertNull(groovyObject);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumulatorEvalFunc() throws Exception {
  String[] groovyStatements={"import org.apache.pig.builtin.OutputSchema;","import org.apache.pig.scripting.groovy.AccumulatorAccumulate;","import org.apache.pig.scripting.groovy.AccumulatorGetValue;","import org.apache.pig.scripting.groovy.AccumulatorCleanup;","class GroovyUDFs {","  private int sum = 0;","  @AccumulatorAccumulate('sumacc')","  public void accuAccumulate(Tuple t) {","    for (Object o: t[1]) {","      sum += o[0]","    }","  }","  @AccumulatorGetValue('sumacc')","  @OutputSchema('sum: long')","  public long accuGetValue() {","    return this.sum;","  }","  @AccumulatorCleanup('sumacc')","  public void accuCleanup() {","    this.sum = 0L;","  }","}"};
  File tmpScriptFile=File.createTempFile("temp_groovy_udf",".groovy");
  tmpScriptFile.deleteOnExit();
  FileWriter writer=new FileWriter(tmpScriptFile);
  for (  String line : groovyStatements) {
    writer.write(line + "\n");
  }
  writer.close();
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerCode(tmpScriptFile.getCanonicalPath(),"groovy","groovyudfs");
  Data data=resetData(pigServer);
  data.set("foo3",tuple(1),tuple(2),tuple(3),tuple(4));
  pigServer.registerQuery("A = LOAD 'foo3' USING mock.Storage();");
  pigServer.registerQuery("B = GROUP A ALL;");
  pigServer.registerQuery("C = FOREACH B GENERATE groovyudfs.sumacc(A) AS sum1,groovyudfs.sumacc(A) AS sum2;");
  pigServer.registerQuery("STORE C INTO 'bar3' USING mock.Storage();");
  List<Tuple> out=data.get("bar3");
  assertEquals(tuple(10L,10L),out.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlgebraicEvalFunc() throws Exception {
  String[] groovyStatements={"import org.apache.pig.scripting.groovy.AlgebraicInitial;","import org.apache.pig.scripting.groovy.AlgebraicIntermed;","import org.apache.pig.scripting.groovy.AlgebraicFinal;","class GroovyUDFs {","  @AlgebraicFinal('sumalg')","  public static long algFinal(Tuple t) {","    long x = 0;","    for (Object o: t[1]) {","      x = x + o;","    }","    return x;","  }","  @AlgebraicInitial('sumalg')","  public static Tuple algInitial(Tuple t) {","    long x = 0;","    for (Object o: t[1]) {","      x = x + o[0];","    }","    return [x];","  }","  @AlgebraicIntermed('sumalg')","  public static Tuple algIntermed(Tuple t) {","    long x = 0;","    for (Object o: t[1]) {","      x = x + o;","    }","    return [x];","  }","}"};
  File tmpScriptFile=File.createTempFile("temp_groovy_udf",".groovy");
  tmpScriptFile.deleteOnExit();
  FileWriter writer=new FileWriter(tmpScriptFile);
  for (  String line : groovyStatements) {
    writer.write(line + "\n");
  }
  writer.close();
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerCode(tmpScriptFile.getCanonicalPath(),"groovy","groovyudfs");
  Data data=resetData(pigServer);
  data.set("foo2",tuple(1),tuple(2),tuple(3),tuple(4));
  pigServer.registerQuery("A = LOAD 'foo2' USING mock.Storage();");
  pigServer.registerQuery("B = GROUP A ALL;");
  pigServer.registerQuery("C = FOREACH B GENERATE groovyudfs.sumalg(A);");
  pigServer.registerQuery("STORE C INTO 'bar2' USING mock.Storage();");
  List<Tuple> out=data.get("bar2");
  assertEquals(tuple(10L),out.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFWithoutParameter </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFWithoutParameter() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(TempScriptFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("B");
  int index=0;
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    index++;
    int result=(Integer)tuple.get(0);
    assertEquals(result,index);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnion </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaMergeWithBag() throws Exception {
  File f1=Util.createInputFile("tmp","input1.txt",new String[]{"dummy"});
  File f2=Util.createInputFile("tmp","input2.txt",new String[]{"dummy"});
  Util.registerMultiLineQuery(pigServer,"a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "';"+ "b = load '"+ Util.encodeEscape(f2.getAbsolutePath())+ "';"+ "c = foreach a generate 1, {(1, 'str1')};"+ "d = foreach b generate 2, {(2, 'str2')};"+ "e = union c,d;"+ "");
  Iterator<Tuple> it=pigServer.openIterator("e");
  Object[] expected=new Object[]{Util.getPigConstant("(1, {(1, 'str1')})"),Util.getPigConstant("(2, {(2, 'str2')})")};
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertEquals(expected[j],results[j]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnionOnSchema </h4><pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnionOnSchemaAdditionalColumnsWithImplicitSplit() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  Data data=Storage.resetData(pig);
  pig.setBatchOn();
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j: int);"+ "l2 = load '"+ INP_FILE_3NUMS+ "' as (i : int, j : int, k : int);"+ "l3 = load '"+ INP_FILE_EMPTY+ "' as (i : int, j : int, k : int, l :int);"+ "u = union onschema l1, l2, l3;"+ "store u into 'out1' using mock.Storage;"+ "store l3 into 'out2' using mock.Storage;";
  Util.registerMultiLineQuery(pig,query);
  pig.executeBatch();
  List<Tuple> list1=data.get("out1");
  List<Tuple> list2=data.get("out2");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,2,null,null)","(5,3,null,null)","(1,2,3,null)","(4,5,6,null)"});
  Util.checkQueryOutputsAfterSort(list1,expectedRes);
  assertEquals(0,list2.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestPOPartialAggPlanTez </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezAutoParallelism </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncreaseIntermediateParallelism1() throws IOException {
  String outputDir="/tmp/testIncreaseIntermediateParallelism";
  String script="A = load '" + INPUT_FILE1 + "' as (name:chararray, age:int);"+ "B = load '"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);"+ "C = join A by name, B by name using 'skewed' parallel 1;"+ "D = group C by A::name;"+ "E = foreach D generate group, COUNT(C.A::name);"+ "STORE E into '"+ outputDir+ "/finalout';";
  String log=testIncreaseIntermediateParallelism(script,outputDir,true);
  assertTrue(log.contains("Increased requested parallelism of scope-59 to 4"));
  assertEquals(1,StringUtils.countMatches(log,"Increased requested parallelism"));
  assertTrue(log.contains("Total estimated parallelism is 52"));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIncreaseIntermediateParallelism2() throws IOException {
  String outputDir="/tmp/testIncreaseIntermediateParallelism";
  String script="A = load '" + INPUT_FILE1 + "' as (name:chararray, age:int);"+ "B = load '"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);"+ "C = join A by name, B by name using 'skewed' parallel 2;"+ "STORE C into '/tmp/testIncreaseIntermediateParallelism';"+ "D = group C by A::name parallel 2;"+ "E = foreach D generate group, COUNT(C.A::name);"+ "STORE E into '"+ outputDir+ "/finalout';";
  String log=testIncreaseIntermediateParallelism(script,outputDir,true);
  assertEquals(0,StringUtils.countMatches(log,"Increased requested parallelism"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncreaseIntermediateParallelism3() throws IOException {
  try {
    String outputDir="/tmp/testIncreaseIntermediateParallelism";
    String script="set default_parallel 1\n" + "A = load '" + INPUT_FILE1 + "' as (name:chararray, age:int);"+ "B = load '"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);"+ "C = join A by name, B by name;"+ "STORE C into '/tmp/testIncreaseIntermediateParallelism';"+ "C1 = group C by A::name;"+ "C2 = FOREACH C1 generate group, FLATTEN(C);"+ "D = group C2 by group;"+ "E = foreach D generate group, COUNT(C2.A::name);"+ "F = order E by $0;"+ "STORE F into '"+ outputDir+ "/finalout';";
    String log=testIncreaseIntermediateParallelism(script,outputDir,false);
    assertEquals(1,StringUtils.countMatches(log,"Increased requested parallelism"));
    assertTrue(log.contains("Increased requested parallelism of scope-65 to 10"));
    assertTrue(log.contains("Total estimated parallelism is 19"));
  }
  finally {
    pigServer.setDefaultParallel(-1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezGraceParallelism </h4><pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUDFContextSetInBackend() throws IOException {
  NodeIdGenerator.reset();
  PigServer.resetScope();
  File outputDir=File.createTempFile("intemediate","txt");
  outputDir.delete();
  pigServer.registerQuery("A = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
  pigServer.registerQuery("B = order A by name;");
  pigServer.registerQuery("C = distinct B;");
  pigServer.registerQuery("D = load '" + INPUT_DIR + "/"+ INPUT_FILE1+ "' as (name:chararray, age:int);");
  pigServer.registerQuery("E = group D by name;");
  pigServer.registerQuery("F = foreach E generate group as name, AVG(D.age) as avg_age;");
  pigServer.registerQuery("G = join C by name left, F by name;");
  ExecJob job=pigServer.store("G",Util.removeColon(outputDir.getAbsolutePath()),StorerWithUDFContextCheck.class.getName());
  assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezJobControlCompiler </h4><pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismDefaultParallelism() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  pc.defaultParallel=5;
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name;"+ "store b into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),5);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorFilterFlatten() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = group b by name;"+ "d = foreach c generate group, flatten(b.gpa);"+ "e = group d by group;"+ "store e into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorSplitBranch() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = filter a by age>50;"+ "store b into 'o1';"+ "d = group c by name;"+ "store d into 'o2';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  Collections.sort(leaves);
  TezOperator leafOper=leaves.get(1);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorHashJoin() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = load '5' using "+ ArbitarySplitsLoader.class.getName()+ "() as (name:chararray, course:chararray);"+ "c = join a by name, b by name;"+ "store c into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),15);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun2() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = group a by x;"+ "c = foreach b generate group, a;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(1,root.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(1,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root.getOutputVertices().get(0),leaf);
  assertEquals(root,leaf.getInputVertices().get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun3() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = load '"+ input2+ "' as (x:int, z:int);"+ "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(2,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root0=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  Vertex root1=compiledPlan.second.getVertex(roots.get(1).getOperatorKey().toString());
  assertNotNull(root0);
  assertNotNull(root1);
  assertEquals(0,root0.getInputVertices().size());
  assertEquals(1,root1.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(2,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root0.getOutputVertices().get(0),leaf);
  assertEquals(root1.getOutputVertices().get(0),leaf);
  assertTrue(leaf.getInputVertices().contains(root0));
  assertTrue(leaf.getInputVertices().contains(root1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = filter a by x > 0;"+ "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(0,root.getOutputVertices().size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorOrderBy() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '2' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name parallel 3;"+ "c = foreach b generate group as name, AVG(a.age) as age;"+ "d = order c by age;"+ "store d into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator sortOper=compiledPlan.first.getLeaves().get(0);
  Vertex sortVertex=compiledPlan.second.getVertex(sortOper.getOperatorKey().toString());
  assertEquals(sortVertex.getParallelism(),-1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezLauncher </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + INPUT_FILE + "' as (x:int, y:chararray);"+ "b = filter a by x > 100;"+ "c = foreach b generate y;"+ "d = group c all;"+ "store d into '"+ OUTPUT_FILE+ "';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  TezLauncher launcher=new TezLauncher();
  PigStats pigStats=launcher.launchPig(pp,"testRun1",pc);
  assertTrue(pigStats.isSuccessful());
  assertEquals(1,pigStats.getInputStats().size());
  assertEquals(INPUT_FILE,pigStats.getInputStats().get(0).getName());
  assertEquals(1,pigStats.getOutputStats().size());
  assertEquals(OUTPUT_FILE,pigStats.getOutputStats().get(0).getName());
  query="m = load '" + OUTPUT_FILE + "' as (a:chararray, b:{(y:chararray)});";
  pigServer=new PigServer(pc);
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("m");
  Tuple result=iter.next();
  assertEquals(result.get(0).toString(),"all");
  Iterator<Tuple> innerIter=((DataBag)result.get(1)).iterator();
  int count=0;
  while (innerIter.hasNext()) {
    assertTrue(Arrays.asList(OUTPUT_RECORDS).contains(innerIter.next().toString()));
    count++;
  }
  assertEquals(count,OUTPUT_RECORDS.length);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQueueName() throws Exception {
  Configuration conf=new Configuration();
  conf.set("tez.queue.name","special");
  conf=MRToTezHelper.getDAGAMConfFromMRConf(conf);
  assertEquals(conf.get("tez.queue.name"),"special");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
