<h3><span class=" glyphicon glyphicon-tag"/>&nbspNullVerifier</h3><kbd>Verifies whether objects are null</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.TestLoadFuncMetadataWrapper </h4><pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getSchema(null,null);
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized LoadFuncMetadataWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getSchema"));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyLoadMetadata loadFunc=new DummyLoadMetadata();
  MockWrapper wrapper=new MockWrapper(loadFunc);
  wrapper.getSchema(null,null);
  assertEquals("getSchema",loadFunc.getLastMethodCalled());
  wrapper.getStatistics(null,null);
  assertEquals("getStatistics",loadFunc.getLastMethodCalled());
  wrapper.getPartitionKeys(null,null);
  assertEquals("getPartitionKeys",loadFunc.getLastMethodCalled());
  wrapper.setPartitionFilter(null);
  assertEquals("setPartitionFilter",loadFunc.getLastMethodCalled());
  wrapper.relativeToAbsolutePath(null,null);
  assertEquals("relativeToAbsolutePath",loadFunc.getLastMethodCalled());
  wrapper.setLocation(null,null);
  assertEquals("setLocation",loadFunc.getLastMethodCalled());
  wrapper.getInputFormat();
  assertEquals("getInputFormat",loadFunc.getLastMethodCalled());
  wrapper.getLoadCaster();
  assertEquals("getLoadCaster",loadFunc.getLastMethodCalled());
  wrapper.prepareToRead(null,null);
  assertEquals("prepareToRead",loadFunc.getLastMethodCalled());
  wrapper.getNext();
  assertEquals("getNext",loadFunc.getLastMethodCalled());
  wrapper.setUDFContextSignature(null);
  assertEquals("setUDFContextSignature",loadFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    loadFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestLoadFuncWrapper </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyLoadFunc loadFunc=new DummyLoadFunc();
  MockWrapper wrapper=new MockWrapper(loadFunc);
  wrapper.relativeToAbsolutePath(null,null);
  assertEquals("relativeToAbsolutePath",loadFunc.getLastMethodCalled());
  wrapper.setLocation(null,null);
  assertEquals("setLocation",loadFunc.getLastMethodCalled());
  wrapper.getInputFormat();
  assertEquals("getInputFormat",loadFunc.getLastMethodCalled());
  wrapper.getLoadCaster();
  assertEquals("getLoadCaster",loadFunc.getLastMethodCalled());
  wrapper.prepareToRead(null,null);
  assertEquals("prepareToRead",loadFunc.getLastMethodCalled());
  wrapper.getNext();
  assertEquals("getNext",loadFunc.getLastMethodCalled());
  wrapper.setUDFContextSignature(null);
  assertEquals("setUDFContextSignature",loadFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    loadFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getInputFormat();
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized LoadFuncWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getInputFormat"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestStoreFuncMetadataWrapper </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyStoreMetadata storeFunc=new DummyStoreMetadata();
  MockWrapper wrapper=new MockWrapper(storeFunc);
  wrapper.storeSchema(null,null,null);
  assertEquals("storeSchema",storeFunc.getLastMethodCalled());
  wrapper.storeStatistics(null,null,null);
  assertEquals("storeStatistics",storeFunc.getLastMethodCalled());
  wrapper.relToAbsPathForStoreLocation(null,null);
  assertEquals("relToAbsPathForStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.getOutputFormat();
  assertEquals("getOutputFormat",storeFunc.getLastMethodCalled());
  wrapper.setStoreLocation(null,null);
  assertEquals("setStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.checkSchema(null);
  assertEquals("checkSchema",storeFunc.getLastMethodCalled());
  wrapper.prepareToWrite(null);
  assertEquals("prepareToWrite",storeFunc.getLastMethodCalled());
  wrapper.putNext(null);
  assertEquals("putNext",storeFunc.getLastMethodCalled());
  wrapper.setStoreFuncUDFContextSignature(null);
  assertEquals("setStoreFuncUDFContextSignature",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnSuccess(null,null);
  assertEquals("cleanupOnSuccess",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnFailure(null,null);
  assertEquals("cleanupOnFailure",storeFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    storeFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.storeSchema(null,null,null);
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized StoreFuncMetadataWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("storeSchema"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestStoreFuncWrapper </h4><pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getOutputFormat();
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized StoreFuncWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getOutputFormat"));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyStoreFunc storeFunc=new DummyStoreFunc();
  MockWrapper wrapper=new MockWrapper(storeFunc);
  wrapper.relToAbsPathForStoreLocation(null,null);
  assertEquals("relToAbsPathForStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.getOutputFormat();
  assertEquals("getOutputFormat",storeFunc.getLastMethodCalled());
  wrapper.setStoreLocation(null,null);
  assertEquals("setStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.checkSchema(null);
  assertEquals("checkSchema",storeFunc.getLastMethodCalled());
  wrapper.prepareToWrite(null);
  assertEquals("prepareToWrite",storeFunc.getLastMethodCalled());
  wrapper.putNext(null);
  assertEquals("putNext",storeFunc.getLastMethodCalled());
  wrapper.setStoreFuncUDFContextSignature(null);
  assertEquals("setStoreFuncUDFContextSignature",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnSuccess(null,null);
  assertEquals("cleanupOnSuccess",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnFailure(null,null);
  assertEquals("cleanupOnFailure",storeFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    storeFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.hbase.TestHBaseStorageFiltering </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDescriptors() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:a cf1:b");
  assertNull(filter);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDescriptorsAndFamily1() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:a cf1:b cf2:");
  assertNull(filter);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testFamily2() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:*");
  assertNull(filter);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDescriptorsAndFamily2() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:a cf1:b cf2:*");
  assertNull(filter);
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnGroups() throws Exception {
  List<HBaseStorage.ColumnInfo> columnInfoList=getHBaseColumnInfo("cf1:a cf1:b cf2:foo*","");
  Map<String,List<HBaseStorage.ColumnInfo>> groupMap=HBaseStorage.groupByFamily(columnInfoList);
  assertEquals(2,groupMap.size());
  List<HBaseStorage.ColumnInfo> cf1List=groupMap.get("cf1");
  assertNotNull(cf1List);
  assertEquals(2,cf1List.size());
  assertColumnInfo(cf1List.get(0),"cf1","a",null);
  assertColumnInfo(cf1List.get(1),"cf1","b",null);
  List<HBaseStorage.ColumnInfo> cf2List=groupMap.get("cf2");
  assertNotNull(cf2List);
  assertEquals(1,cf2List.size());
  assertColumnInfo(cf2List.get(0),"cf2",null,"foo");
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testFamily() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:");
  assertNull(filter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestFunctionWrapperEvalFunc </h4><pre class="type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testExceptionalIntegerToFloatWithException() throws IOException, ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException {
  FunctionWrapperEvalFunc udf=new FunctionWrapperEvalFunc(ExceptionalIntegerFloatFunction.class.getName());
  assertEquals(Float.class,udf.getOutputTypeClass());
  Exception exception=null;
  try {
    udf.exec(new Integer(11));
  }
 catch (  IOException e) {
    exception=e;
  }
  assertNotNull(exception);
  assertEquals(IOException.class,exception.getClass());
  assertEquals(MockException.class,exception.getCause().getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStoragePushdown </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMatchesExpr() throws Exception {
  String q=query + "b = filter a by name matches 'foo*';" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("name"));
  Assert.assertNull(expr);
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
  q=query + "b = filter a by name matches 'foo*' and srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by srcid == 10 and name matches 'foo*';" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by name matches 'foo*' or srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  Assert.assertNull(expr);
  sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.data.TestSchemaTuple </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testCompileAndResolve() throws Exception {
  Schema udfSchema=Utils.getSchemaFromString("a:int");
  boolean isAppendable=false;
  GenContext context=GenContext.UDF;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:long");
  isAppendable=true;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:chararray,(a:chararray)");
  isAppendable=false;
  context=GenContext.FOREACH;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:int,(a:int,(a:int,(a:int,(a:int,(a:int,(a:int))))))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("((a:int,b:int),(a:int,b:int),(a:int,b:int)),((a:int,b:int),(a:int,b:int),(a:int,b:int))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt:datetime, bd: bigdecimal, bi: biginteger))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  udfSchema=Utils.getSchemaFromString("int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger))");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=true;
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, b:bag{(int,int,int)}");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, m:map[(int,int,int)]");
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=new Schema();
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  isAppendable=false;
  udfSchema=new Schema(new FieldSchema(null,DataType.BAG));
  SchemaTupleFrontend.registerToGenerateIfPossible(udfSchema,isAppendable,context);
  SchemaTupleFrontend.copyAllGeneratedToDistributedCache(pigContext,conf);
  SchemaTupleBackend.initialize(conf,pigContext);
  udfSchema=Utils.getSchemaFromString("a:int");
  isAppendable=false;
  context=GenContext.UDF;
  SchemaTupleFactory tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  context=GenContext.MERGE_JOIN;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:long");
  context=GenContext.UDF;
  isAppendable=true;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:chararray,(a:chararray)");
  isAppendable=false;
  context=GenContext.FOREACH;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("(a:chararray)");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  udfSchema=Utils.getSchemaFromString("a:int,(a:int,(a:int,(a:int,(a:int,(a:int,(a:int))))))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("((a:int,b:int),(a:int,b:int),(a:int,b:int)),((a:int,b:int),(a:int,b:int),(a:int,b:int))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger," + "(a:int, b:long, c:chararray, d:boolean, e:bytearray, f:float, g:double, dt: datetime, bd: bigdecimal, bi: biginteger))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean," + "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean,"+ "boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean, boolean");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  udfSchema=Utils.getSchemaFromString("int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger," + "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger)),"+ "int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger,"+ "(int, long, chararray, boolean, bytearray, float, double, datetime, bigdecimal, biginteger))");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=true;
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, b:bag{(int,int,int)}");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=Utils.getSchemaFromString("int, m:map[(int,int,int)]");
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
  isAppendable=false;
  udfSchema=new Schema();
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  assertNull(tf);
  isAppendable=false;
  udfSchema=new Schema(new FieldSchema(null,DataType.BAG));
  tf=SchemaTupleFactory.getInstance(udfSchema,isAppendable,context);
  putThroughPaces(tf,udfSchema,isAppendable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestOver </h4><pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagWithRowsBehindNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadWithRowsAheadNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestStitch </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNoInput() throws Exception {
  Stitch func=new Stitch();
  assertNull(func.exec(null));
  Tuple t=TupleFactory.getInstance().newTuple();
  assertNull(func.exec(t));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.datetime.convert.TestConvertDateTime </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadFormat() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(2);
  t1.set(0,"2011-01-01");
  t1.set(1,"MMMM, yyyy");
  CustomFormatToISO convert=new CustomFormatToISO();
  assertNull("Input that doesn't match format should result in null",convert.exec(t1));
  t1.set(0,"July, 2012");
  assertEquals("Matching format should work correctly","2012-07-01T00:00:00.000+08:00",convert.exec(t1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestLength </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLength() throws IOException {
  testTuple_.set(0,"foo");
  assertEquals("regular length should match",(Integer)3,len_.exec(testTuple_));
  testTuple_.set(0,null);
  assertNull("length of null is null",len_.exec(testTuple_));
  testTuple_.set(0,"");
  assertEquals("empty string has 0 length",(Integer)0,len_.exec(testTuple_));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestReplaceMulti </h4><pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDFNullParameters() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE org.apache.pig.piggybank.evaluation.string.REPLACE_MULTI(NULL, NULL);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNullSourceStringToReplaceMultiUDF() throws Exception {
  Tuple input;
  String output;
  String inputStr=null;
  List list=new LinkedList();
  EvalFunc<String> strFunc=new REPLACE_MULTI();
  list.add(inputStr);
  Map<String,String> map=new HashMap<String,String>();
  list.add(map);
  input=TupleFactory.getInstance().newTuple(list);
  output=strFunc.exec(input);
  assertNull(output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestStuff </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws IOException {
  Tuple tupleWithNullElement=TupleFactory.getInstance().newTuple(1);
  String result=udf.exec(tupleWithNullElement);
  assertNull(result);
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Chocolate Cake");
  t.set(1,10);
  t.set(2,4);
  t.set(3,"Pie");
  result=udf.exec(t);
  assertEquals("Chocolate Pie",result);
  t.set(0,"Old Zealand");
  t.set(1,0);
  t.set(2,3);
  t.set(3,"New");
  result=udf.exec(t);
  assertEquals("New Zealand",result);
  t.set(0,"Take a look");
  t.set(1,5);
  t.set(2,1);
  t.set(3,"b");
  result=udf.exec(t);
  assertEquals("Take b look",result);
  t.set(0,"Take a look");
  t.set(1,5);
  t.set(2,6);
  t.set(3,"b");
  result=udf.exec(t);
  assertEquals("Take b",result);
  t.set(0,"Take a look");
  t.set(1,4);
  t.set(2,7);
  t.set(3,null);
  result=udf.exec(t);
  assertEquals("Take",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestUcFirst </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUcFirst() throws IOException {
  testTuple_.set(0,null);
  assertNull("null is null",ucf_.exec(testTuple_));
  testTuple_.set(0,"");
  assertEquals("empty string","",ucf_.exec(testTuple_));
  testTuple_.set(0,"foo");
  assertEquals("lowercase string","Foo",ucf_.exec(testTuple_));
  testTuple_.set(0,"Foo");
  assertEquals("uppercase string","Foo",ucf_.exec(testTuple_));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestDateExtractor </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  assertNotNull(new DateExtractor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestHostExtractor </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  assertNotNull(new HostExtractor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestSearchEngineExtractor </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  assertNotNull(new SearchEngineExtractor());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTests() throws Exception {
  SearchEngineExtractor searchEngineExtractor=new SearchEngineExtractor();
  int testCount=0;
  Tuple input=DefaultTupleFactory.getInstance().newTuple(1);
  for (  String key : tests.keySet()) {
    String expected=tests.get(key);
    assertNotNull(expected);
    assertTrue(expected.length() > 0);
    input.set(0,key);
    assertEquals(expected,searchEngineExtractor.exec(input));
    testCount++;
  }
  assertEquals(tests.size(),testCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestSearchTermExtractor </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  assertNotNull(new SearchEngineExtractor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestCombinedLogLoader </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  CombinedLogLoader combinedLogLoader=new CombinedLogLoader();
  assertNotNull(combinedLogLoader);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestCommonLogLoader </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testInstantiation(){
  CommonLogLoader commonLogLoader=new CommonLogLoader();
  assertNotNull(commonLogLoader);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestLoadFuncHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunctionSingleArg() throws IOException {
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath());
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFirstFile() throws IOException {
  Path path=helper.determineFirstFile(baseDir.getAbsolutePath());
  assertNotNull(path);
  assertEquals(new Path(testFile.getAbsolutePath()).toUri().toString(),path.toUri().toURL().getFile());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunction() throws IOException {
  Path firstFile=helper.determineFirstFile(baseDir.getAbsolutePath());
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath(),firstFile);
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitionHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatusPartitionFilterFound() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionFilterExpression("year<='2010' and month=='01' and day>='01'",PigStorage.class,"2");
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"2");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"2");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatus() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"3");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"3");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitioner </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeysForEmptyDir() throws Exception {
  File baseDir=createDir(null,"testPathPartitioner-testGetKeys-" + System.currentTimeMillis());
  File partition1=createDir(baseDir,"year=2010");
  File partition2=createDir(partition1,"month=01");
  File emptyPartition=createDir(partition2,"day=01");
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeys() throws Exception {
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-7 type-9 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  final String str1="[ \"string\", \"int\", \"boolean\"  ]";
  Schema s=Schema.parse(str1);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str2="[ \"string\", \"int\", \"null\"  ]";
  s=Schema.parse(str2);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str3="[ \"string\", \"null\"  ]";
  s=Schema.parse(str3);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  Schema realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str4="{\"type\": \"array\", \"items\": " + str2 + "}";
  s=Schema.parse(str4);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  try {
    realSchema=AvroStorageUtils.getAcceptedType(s);
    fail("\"Should throw a runtime exception when trying to get accepted type from a unacceptable union");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Cannot call this function on a unacceptable union"));
  }
  final String str5=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"null\", \"int\"] } ] }";
  s=Schema.parse(str5);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  final String str6=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"string\", \"int\"] } ] }";
  s=Schema.parse(str6);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str7="[ \"string\"  ]";
  s=Schema.parse(str7);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str8="[  ]";
  s=Schema.parse(str8);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertNull(realSchema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, SUM(A.v), COUNT(A.v), MIN(A.v), MAX(A.v);");
  HashMap<Integer,Double[]> expected=new HashMap<Integer,Double[]>();
  expected.put(100,new Double[]{15.0,5.0,1.0,5.0});
  expected.put(200,new Double[]{6.3,3.0,1.1,3.1});
  expected.put(300,new Double[]{3.3,1.0,3.3,3.3});
  expected.put(400,new Double[]{null,0.0,null,null});
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Double[] v=expected.get((Integer)t.get(0));
    for (int i=0; i < v.length; i++) {
      if (v[i] != null) {
        assertEquals(v[i].doubleValue(),((Number)t.get(i + 1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(i + 1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltinAvg() throws IOException {
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,3.0);
  expected.put(200,2.1);
  expected.put(300,3.3);
  expected.put(400,null);
  String[] types={"double","float","int","long"};
  for (int i=0; i < types.length; i++) {
    if (i > 1) {
      expected.put(200,2.0);
      expected.put(300,3.0);
    }
    pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:"+ types[i]+ ");");
    pigServer.registerQuery("C = group A by id;");
    pigServer.registerQuery("D = foreach C generate group, AVG(A.v);");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      Double v=expected.get((Integer)t.get(0));
      if (v != null) {
        assertEquals(v.doubleValue(),((Number)t.get(1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(1));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAdd </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE,DataType.BIGINTEGER,DataType.BIGDECIMAL};
  System.out.println("Testing Add operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 + inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 + inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 + inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 + inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBoolean </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotNull() throws ExecException {
  setupNot();
  lt.setValue(null);
  Result res=uop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertNull(res.result);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndNull() throws ExecException {
  setupAnd();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrNull() throws ExecException {
  setupOr();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNullInputBagToTupleUDF() throws Exception {
  BagToTuple udf=new BagToTuple();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,null);
  Tuple output=udf.exec(udfInput);
  assertNull(output);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNullInputBagToStringUDF() throws Exception {
  BagToString udf=new BagToString();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,null);
  String output=udf.exec(udfInput);
  assertNull(output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMAX() throws Exception {
  String[] maxTypes={"MAX","LongMax","IntMax","FloatMax","BigDecimalMax","BigIntegerMax","StringMax","DateTimeMax"};
  for (int k=0; k < maxTypes.length; k++) {
    EvalFunc<?> max=evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=max.exec(tup);
    String msg="[Testing " + maxTypes[k] + " on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),output);
    assertNull(max.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * End-to-end testing of the CONCAT() builtin function for vararg parameters
 * @throws Exception
 */
@Test public void testComplexMultiCONCAT() throws Exception {
  String input="vararg_concat_test_jira_3444.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',CONCAT('c','d')));");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', 'b', 'c', 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b','c'), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',Null), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMIN() throws Exception {
  String[] minTypes={"MIN","LongMin","IntMin","FloatMin","BigDecimalMin","BigIntegerMin","StringMin","DateTimeMin"};
  for (int k=0; k < minTypes.length; k++) {
    EvalFunc<?> min=evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=min.exec(tup);
    String msg="[Testing " + minTypes[k] + " on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),output);
    assertNull(min.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSUM() throws Exception {
  String[] sumTypes={"SUM","DoubleSum","LongSum","IntSum","FloatSum","BigDecimalSum","BigIntegerSum"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType == "Integer" || inputType == "Long") {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
    assertNull(sum.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSPRINTF() throws Exception {
  String fmt="%2$10s <%1$-6s< %2$,10d >%1$7s> %2$8x %3$10.3f";
  String s1="meep";
  Integer ii=665568;
  Float ff=993.14159265f;
  String exp="    665568 <meep  <    665,568 >   meep>    a27e0    993.142";
  Tuple ts;
  String res;
  EvalFunc<String> sprinter=new SPRINTF();
  ts=TupleFactory.getInstance().newTuple(5);
  ts.set(0,fmt);
  ts.set(1,s1);
  ts.set(2,ii);
  ts.set(3,ff);
  ts.set(4,(long)(ii * 1000000L));
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(2,665568l);
  ts.set(3,993.14159265d);
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(3,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts.set(3,ff);
  ts.set(0,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts=TupleFactory.getInstance().newTuple(1);
  ts.set(0,"meep!");
  res=sprinter.exec(ts);
  assertEquals("meep!",res);
  String input="vararg_sprintf_test_jira_3939.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate SPRINTF('%6s|%-8s|%2$,+12d %2$8x', 'yay', 665568);");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("   yay|665568  |    +665,568    a27e0",t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testCOUNTBagNullCheck() throws Exception {
  DataBag b=null;
  Tuple t=TupleFactory.getInstance().newTuple(b);
  EvalFunc<Long> count=new COUNT();
  assertNull(count.exec(t));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAVG() throws Exception {
  String[] avgTypes={"AVG","DoubleAvg","LongAvg","IntAvg","FloatAvg","BigDecimalAvg","BigIntegerAvg"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    Object output=avg.exec(tup);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(avgTypes[k])).toPlainString());
    }
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(avgTypes[k]),0.00001);
    }
    assertNull(avg.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCharArrayToNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArrayToIntAndLongScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Long> map=new HashMap<Integer,Long>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      long value=rand.nextInt(100);
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input2.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.INTEGER,DataType.LONG};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input2.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.LONG) {
          Long expected=map.get(key);
          if (value != null) {
            Long actual=Long.parseLong(value);
            assertEquals(expected,actual);
          }
 else {
            assertEquals(expected,null);
          }
        }
        if (type == DataType.INTEGER) {
          Integer expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).intValue();
          }
          if (value != null) {
            Integer actual=Integer.parseInt(value);
            assertEquals(expected,actual);
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input2.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArray2FloatAndDoubleScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Double> map=new HashMap<Integer,Double>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      double value=rand.nextDouble() * 100;
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input1.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.DOUBLE,DataType.FLOAT};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input1.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.DOUBLE) {
          Double expected=map.get(key);
          if (value != null) {
            assertEquals(expected,(Double)Double.parseDouble(value));
          }
 else {
            assertNull(expected);
          }
        }
        if (type == DataType.FLOAT) {
          Float expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).floatValue();
          }
          if (value != null) {
            assertEquals(expected,(Float)Float.parseFloat(value));
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input1.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCast() throws ExecException {
  POCast cast=new POCast(newOperatorKey(),-1);
  POProject proj=new POProject(newOperatorKey(),-1,0);
  proj.setResultType(DataType.CHARARRAY);
  List<PhysicalOperator> inputs=new ArrayList<PhysicalOperator>();
  inputs.add(proj);
  cast.setInputs(inputs);
  String[] items={"12.0","-13.2","0.1f","1.3e2","zjf",MaxDouble.toString(),MinDouble.toString()};
  Double[] doubleExpected={12.0,-13.2,0.1,1.3e2,null,MaxDouble,MinDouble};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Double actual=(Double)cast.getNextDouble().result;
    if (doubleExpected[i] != null) {
      assertEquals(doubleExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"12.0","-13.2","0.1f","1.3e2",MaxFloat.toString(),MinFloat.toString(),"zjf"};
  Float[] floatExpected={12.0f,-13.2f,0.1f,1.3e2f,MaxFloat,MinFloat,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Float actual=(Float)cast.getNextFloat().result;
    if (floatExpected[i] != null) {
      assertEquals(floatExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxLong.toString(),MinLong.toString(),"df1.2"};
  Long[] longExpected={1L,-1L,12L,12L,MaxLong,MinLong,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Long actual=(Long)cast.getNextLong().result;
    if (longExpected[i] != null) {
      assertEquals(longExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxInteger.toString(),MinInteger.toString(),"ff4332"};
  Integer[] intExpected={1,-1,12,12,MaxInteger,MinInteger,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Integer actual=(Integer)cast.getNextInteger().result;
    if (intExpected[i] != null) {
      assertEquals(intExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCmdLineParser </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseLongShortLeftover3() throws ParseException {
  String[] args={"-a","--beta","5","--c","--"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('c',null,CmdLineParser.ValueExpected.OPTIONAL);
  assertEquals('a',p.getNextOpt());
  assertEquals('b',p.getNextOpt());
  Integer ii=p.getValInt();
  assertEquals(5,ii.intValue());
  assertEquals('c',p.getNextOpt());
  assertNull(p.getValInt());
  assertEquals(CmdLineParser.EndOfOpts,p.getNextOpt());
  String[] r=p.getRemainingArgs();
  assertNull(p.getRemainingArgs());
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseLongShortNoLeftover() throws ParseException {
  String[] args={"-a","--beta","beth","--c"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('c',null,CmdLineParser.ValueExpected.OPTIONAL);
  assertEquals('a',p.getNextOpt());
  assertEquals('b',p.getNextOpt());
  assertEquals("beth",p.getValStr());
  assertEquals('c',p.getNextOpt());
  assertNull(p.getValStr());
  assertEquals(CmdLineParser.EndOfOpts,p.getNextOpt());
  assertNull(p.getRemainingArgs());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConstExpr </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataByteArray() throws ExecException {
  DataByteArray inp=GenRandomData.genRandDBA(r);
  ce.setValue(inp);
  Result resba=ce.getNextDataByteArray();
  DataByteArray ret=(DataByteArray)resba.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resba=ce.getNextDataByteArray();
  ret=(DataByteArray)resba.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException {
  Tuple inp=GenRandomData.genRandSmallBagTuple(r,10,100);
  ce.setValue(inp);
  Result rest=ce.getNextTuple();
  Tuple ret=(Tuple)rest.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  rest=ce.getNextTuple();
  ret=(Tuple)rest.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextInteger() throws ExecException {
  Integer inp=r.nextInt();
  ce.setValue(inp);
  Result resi=ce.getNextInteger();
  Integer ret=(Integer)resi.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resi=ce.getNextInteger();
  ret=(Integer)resi.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextLong() throws ExecException {
  Long inp=r.nextLong();
  ce.setValue(inp);
  Result resl=ce.getNextLong();
  Long ret=(Long)resl.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resl=ce.getNextLong();
  ret=(Long)resl.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDouble() throws ExecException {
  Double inp=r.nextDouble();
  ce.setValue(inp);
  Result resd=ce.getNextDouble();
  Double ret=(Double)resd.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resd=ce.getNextDouble();
  ret=(Double)resd.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextFloat() throws ExecException {
  Float inp=r.nextFloat();
  ce.setValue(inp);
  Result resf=ce.getNextFloat();
  Float ret=(Float)resf.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resf=ce.getNextFloat();
  ret=(Float)resf.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextString() throws ExecException {
  String inp=GenRandomData.genRandString(r);
  ce.setValue(inp);
  Result ress=ce.getNextString();
  String ret=(String)ress.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  ress=ce.getNextString();
  ret=(String)ress.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextMap() throws ExecException {
  Map<String,Object> inp=GenRandomData.genRandMap(r,10);
  ce.setValue(inp);
  Result resm=ce.getNextMap();
  Map<Integer,String> ret=(Map)resm.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resm=ce.getNextMap();
  ret=(Map)resm.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextBoolean() throws ExecException {
  Boolean inp=r.nextBoolean();
  ce.setValue(inp);
  Result res=ce.getNextBoolean();
  Boolean ret=(Boolean)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextBoolean();
  ret=(Boolean)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataBag() throws ExecException {
  DataBag inp=GenRandomData.genRandSmallTupDataBag(r,10,100);
  ce.setValue(inp);
  Result res=ce.getNextDataBag();
  DataBag ret=(DataBag)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextDataBag();
  ret=(DataBag)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConversions </h4><pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOverflow() throws IOException, ParserException {
  Schema schema;
  ResourceFieldSchema rfs;
  Tuple tuple, convertedTuple;
  tuple=TupleFactory.getInstance().newTuple(1);
  schema=Utils.getSchemaFromString("t:tuple(a:int)");
  rfs=new ResourceSchema(schema).getFields()[0];
  tuple.set(0,Integer.valueOf(Integer.MAX_VALUE).longValue() + 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MIN_VALUE).longValue() - 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MAX_VALUE).doubleValue() + 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Integer.valueOf(Integer.MIN_VALUE).doubleValue() - 1);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to int: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  schema=Utils.getSchemaFromString("t:tuple(a:long)");
  rfs=new ResourceSchema(schema).getFields()[0];
  tuple.set(0,Long.valueOf(Long.MAX_VALUE).doubleValue() + 10000);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to long: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
  tuple.set(0,Long.valueOf(Long.MIN_VALUE).doubleValue() - 10000);
  convertedTuple=ps.getLoadCaster().bytesToTuple(tuple.toString().getBytes(),rfs);
  assertNull("Invalid cast to long: " + tuple.get(0) + " -> "+ convertedTuple.get(0),convertedTuple.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBoolean() throws IOException {
  String[] a={"true","True","TRUE","false","False","FALSE"};
  Boolean[] b={Boolean.TRUE,Boolean.TRUE,Boolean.TRUE,Boolean.FALSE,Boolean.FALSE,Boolean.FALSE};
  for (int i=0; i < b.length; ++i) {
    byte[] bytes=a[i].getBytes();
    assertEquals(b[i],ps.getLoadCaster().bytesToBoolean(bytes));
  }
  a=new String[]{"neither true nor false"};
  for (  String s : a) {
    byte[] bytes=s.getBytes();
    Boolean bool=ps.getLoadCaster().bytesToBoolean(bytes);
    assertNull(bool);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToTupleWithConversion() throws IOException {
  for (int i=0; i < 100; i++) {
    Tuple t=GenRandomData.genMixedTupleToConvert(r);
    ResourceFieldSchema fs=GenRandomData.getMixedTupleToConvertFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertTrue(convertedTuple.get(0) instanceof String);
    assertEquals(convertedTuple.get(0),((Integer)t.get(0)).toString());
    assertTrue(convertedTuple.get(1) instanceof Long);
    Integer origValue1=(Integer)t.get(1);
    assertEquals(convertedTuple.get(1),Long.valueOf(origValue1.longValue()));
    assertNull(convertedTuple.get(2));
    assertTrue(convertedTuple.get(3) instanceof Double);
    Float origValue3=(Float)t.get(3);
    assertEquals(((Double)convertedTuple.get(3)).doubleValue(),origValue3.doubleValue(),0.01);
    assertTrue(convertedTuple.get(4) instanceof Float);
    Double origValue4=(Double)t.get(4);
    assertEquals((Float)convertedTuple.get(4),origValue4.floatValue(),0.01);
    assertTrue(convertedTuple.get(5) instanceof String);
    assertEquals(convertedTuple.get(5),t.get(5));
    assertNull(convertedTuple.get(6));
    assertNull(convertedTuple.get(7));
    assertNull(convertedTuple.get(8));
    assertTrue(convertedTuple.get(9) instanceof Boolean);
    String origValue9=(String)t.get(9);
    assertEquals(Boolean.valueOf(origValue9),convertedTuple.get(9));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToLong() throws IOException {
  String[] a={"1703598819951657279 "," 999888123L  "," 1234 "," 1234","1234 ","1","-2345","123456789012345678","1.1","-23.45","21345345","3422342",""};
  Long[] la={1703598819951657279L,999888123L,1234L,1234L,1234L,1L,-2345L,123456789012345678L,1L,-23L,21345345L,3422342L};
  for (int i=0; i < la.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(la[i],ps.getLoadCaster().bytesToLong(b));
  }
  a=new String[]{"This is a long","1.0e1000","","    "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Long l=ps.getLoadCaster().bytesToLong(b);
    assertNull(l);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToComplexTypeMisc() throws IOException, ParserException {
  String s="(a,b";
  Schema schema=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Tuple t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
  s="{(a,b}";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  DataBag b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="{(a,b)";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="[ab]";
  schema=Utils.getSchemaFromString("m:map[chararray]");
  rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#b";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  Map.Entry<String,Object> entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertNull(entry.getValue());
  s="[#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#}";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#)";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertTrue(m.isEmpty());
  s="(a,b)";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertEquals(2,t.size());
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  s="[a#(1,2,3)]";
  schema=Utils.getSchemaFromString("m:map[]");
  rfs=new ResourceSchema(schema).getFields()[0];
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertTrue(entry.getValue() instanceof DataByteArray);
  assertEquals("(1,2,3)",entry.getValue().toString());
  s="(a,b,(123,456,{(1,2,3)}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertTrue(t.size() == 3);
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  assertTrue(t.get(2) instanceof DataByteArray);
  assertEquals("(123,456,{(1,2,3)})",t.get(2).toString());
  s="(a,b,(123,456,{(1,2,3}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToInteger() throws IOException {
  String[] a={"1234 "," 4321"," 12345 ","1","-2345","1234567","1.1","-23.45",""};
  Integer[] ia={1234,4321,12345,1,-2345,1234567,1,-23};
  for (int i=0; i < ia.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(ia[i],ps.getLoadCaster().bytesToInteger(b));
  }
  a=new String[]{"1234567890123456","This is an int","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Integer i=ps.getLoadCaster().bytesToInteger(b);
    assertNull(i);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToFloat() throws IOException {
  String[] a={"1","-2.345","12.12334567","1.02e-2",".23344","23.1234567897","12312.33","002312.33","1.02e-2",""};
  Float[] f={1f,-2.345f,12.12334567f,1.02e-2f,.23344f,23.1234567f,12312.33f,2312.33f,1.02e-2f};
  for (int j=0; j < f.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(f[j],ps.getLoadCaster().bytesToFloat(b));
  }
  a=new String[]{"1a.1","23.1234567a890123456","This is a float","","  "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Float fl=ps.getLoadCaster().bytesToFloat(b);
    assertNull(fl);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToDouble() throws IOException {
  String[] a={"1","-2.345","12.12334567890123456","1.02e12","-.23344",""};
  Double[] d={1.0,-2.345,12.12334567890123456,1.02e12,-.23344};
  for (int j=0; j < d.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(d[j],ps.getLoadCaster().bytesToDouble(b));
  }
  a=new String[]{"-0x1.1","-23a.45","This is a double","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Double dl=ps.getLoadCaster().bytesToDouble(b);
    assertNull(dl);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=giveMeOneOfEach();
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  for (int i=0; i < 2; i++) {
    Tuple after=tf.newTuple();
    after.readFields(in);
    Object o=after.get(0);
    assertTrue("isa Tuple",o instanceof Tuple);
    Tuple t3=(Tuple)o;
    o=t3.get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(3),(Integer)o);
    o=t3.get(1);
    assertTrue("isa Float",o instanceof Float);
    assertEquals(new Float(3.0),(Float)o);
    o=after.get(1);
    assertTrue("isa Bag",o instanceof DataBag);
    DataBag b=(DataBag)o;
    Iterator<Tuple> j=b.iterator();
    Tuple[] ts=new Tuple[2];
    assertTrue("first tuple in bag",j.hasNext());
    ts[0]=j.next();
    assertTrue("second tuple in bag",j.hasNext());
    ts[1]=j.next();
    o=ts[0].get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(4),(Integer)o);
    o=ts[1].get(0);
    assertTrue("isa String",o instanceof String);
    assertEquals("mary had a little lamb",(String)o);
    o=after.get(2);
    assertTrue("isa Map",o instanceof Map);
    Map<String,Object> m=(Map<String,Object>)o;
    assertEquals("world",(String)m.get("hello"));
    assertEquals("all",(String)m.get("goodbye"));
    assertNull(m.get("fred"));
    o=after.get(3);
    assertTrue("isa Integer",o instanceof Integer);
    Integer ii=(Integer)o;
    assertEquals(new Integer(42),ii);
    o=after.get(4);
    assertTrue("isa Long",o instanceof Long);
    Long l=(Long)o;
    assertEquals(new Long(5000000000L),l);
    o=after.get(5);
    assertTrue("isa Float",o instanceof Float);
    Float f=(Float)o;
    assertEquals(new Float(3.141592654),f);
    o=after.get(6);
    assertTrue("isa Double",o instanceof Double);
    Double d=(Double)o;
    assertEquals(new Double(2.99792458e8),d);
    o=after.get(7);
    assertTrue("isa Boolean",o instanceof Boolean);
    Boolean bool=(Boolean)o;
    assertTrue(bool);
    o=after.get(8);
    assertTrue("isa DataByteArray",o instanceof DataByteArray);
    DataByteArray ba=(DataByteArray)o;
    assertEquals(new DataByteArray("hello"),ba);
    o=after.get(9);
    assertTrue("isa String",o instanceof String);
    String s=(String)o;
    assertEquals("goodbye",s);
  }
  file.delete();
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteInternal() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple(1);
  InternalMap map=new InternalMap(2);
  map.put(new Integer(1),new String("world"));
  map.put(new Long(3L),new String("all"));
  t1.set(0,map);
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  Tuple after=tf.newTuple();
  after.readFields(in);
  Object o=after.get(0);
  assertTrue("isa InternalMap",o instanceof InternalMap);
  InternalMap m=(InternalMap)o;
  assertEquals("world",(String)m.get(new Integer(1)));
  assertEquals("all",(String)m.get(new Long(3L)));
  assertNull(m.get("fred"));
  file.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalFuncOutputAnnotation </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUnannotated(){
  EvalFunc<DataBag> myFunc=new UnannotatedFunc();
  assertNull(myFunc.outputSchema(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestExampleGenerator </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testJoin2() throws IOException, ExecException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A1 = load " + A + " as (x, y);");
  pigServer.registerQuery("B1 = load " + A + " as (x, y);");
  pigServer.registerQuery("E = join A1 by x, B1 by x;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("E");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLoaderWithContext() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " using "+ UDFContextTestLoaderWithSignature.class.getName()+ "('a') as (x, y);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("A");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilter() throws Exception {
  PigServer pigserver=new PigServer(pigContext);
  String query="A = load " + A + " using PigStorage() as (x : int, y : int);\n";
  pigserver.registerQuery(query);
  query="B = filter A by x > 10;";
  pigserver.registerQuery(query);
  Map<Operator,DataBag> derivedData=pigserver.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testForEachNestedBlock2() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x:int, y:int);");
  pigServer.registerQuery("B = group A by x;");
  pigServer.registerQuery("C = foreach B { FA = filter A by y == 6; DA = DISTINCT FA; generate group, COUNT(DA);};");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCross() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = load " + B.toString() + " as (x, y);");
  pigServer.registerQuery("C = CROSS A, B;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilter3() throws Exception {
  PigServer pigserver=new PigServer(pigContext);
  String query="A = load " + A + " using PigStorage() as (x : int, y : int);\n";
  pigserver.registerQuery(query);
  query="B = filter A by x > 10;";
  pigserver.registerQuery(query);
  query="C = FOREACH B GENERATE (x+1) as x1, (y+1) as y1;";
  pigserver.registerQuery(query);
  query="D = FOREACH C GENERATE (x1+1) as x2, (y1+1) as y2;";
  pigserver.registerQuery(query);
  query="E = DISTINCT D;";
  pigserver.registerQuery(query);
  Map<Operator,DataBag> derivedData=pigserver.getExamples("E");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDistinct() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = DISTINCT A;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilterWithIsNull() throws ExecException, IOException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " using PigStorage() as (x : int, y : int);");
  pigServer.registerQuery("B = filter A by x is not null;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilter2() throws Exception {
  PigServer pigserver=new PigServer(pigContext);
  String query="A = load " + A + " using PigStorage() as (x : int, y : int);\n";
  pigserver.registerQuery(query);
  query="B = filter A by x > 5 AND y < 6;";
  pigserver.registerQuery(query);
  Map<Operator,DataBag> derivedData=pigserver.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUnion() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = load " + B.toString() + " as (x, y);");
  pigServer.registerQuery("C = union A, B;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCogroupMultipleCols() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " as (x, y);");
  pigServer.registerQuery("B = load " + B + " as (x, y);");
  pigServer.registerQuery("C = cogroup A by (x, y), B by (x, y);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCogroup() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " as (x, y);");
  pigServer.registerQuery("B = load " + B + " as (x, y);");
  pigServer.registerQuery("C = cogroup A by x, B by x;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilterWithUDF() throws ExecException, IOException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " using PigStorage() as (x : int, y : int);");
  pigServer.registerQuery("B = group A by x;");
  pigServer.registerQuery("C = filter B by NOT IsEmpty(A.y);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOrderBy() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = order A by x;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testForeachWithTypeCastCounter() throws ExecException, IOException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " using PigStorage() as (x : int, y : int);");
  pigServer.registerQuery("B = foreach A generate x, (int)'InvalidInt';");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLimit() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = limit A 5;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testJoin() throws IOException, ExecException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A1 = load " + A + " as (x, y);");
  pigServer.registerQuery("B1 = load " + B + " as (x, y);");
  pigServer.registerQuery("E = join A1 by x, B1 by x;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("E");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilterGroupCountStore() throws Exception {
  File out=File.createTempFile("testFilterGroupCountStoreOutput","");
  out.deleteOnExit();
  out.delete();
  PigServer pigServer=new PigServer(pigContext);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = filter A by x < 5;");
  pigServer.registerQuery("C = group B by x;");
  pigServer.registerQuery("D = foreach C generate group as x, COUNT(B) as the_count;");
  pigServer.registerQuery("store D into '" + Util.encodeEscape(out.getAbsolutePath()) + "';");
  Map<Operator,DataBag> derivedData=pigServer.getExamples(null);
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGroup3() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x:int, y:int);");
  pigServer.registerQuery("B = FILTER A by x  > 3;");
  pigServer.registerQuery("C = group B by y;");
  pigServer.registerQuery("D = foreach C generate group, COUNT(B);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("D");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testForeachBinCondWithBooleanExp() throws ExecException, IOException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " using PigStorage() as (x : int, y : int);");
  pigServer.registerQuery("B = foreach A generate  (x + 1 > y ? 0 : 1);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGroup2() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x:int, y:int);");
  pigServer.registerQuery("B = group A by x;");
  pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilterUnion() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x:int, y:int);");
  pigServer.registerQuery("B = FILTER A by x  > 3;");
  pigServer.registerQuery("C = FILTER A by x < 3;");
  pigServer.registerQuery("D = UNION B, C;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("D");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGroup() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x, y);");
  pigServer.registerQuery("B = group A by x;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testForEachNestedBlock() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A.toString() + " as (x:int, y:int);");
  pigServer.registerQuery("B = group A by x;");
  pigServer.registerQuery("C = foreach B { FA = filter A by y == 6; generate group, COUNT(FA);};");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("C");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLoad() throws Exception {
  PigServer pigserver=new PigServer(pigContext);
  String query="A = load " + A + " using PigStorage() as (x : int, y : int);\n";
  pigserver.registerQuery(query);
  Map<Operator,DataBag> derivedData=pigserver.getExamples("A");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testForeach() throws ExecException, IOException {
  PigServer pigServer=new PigServer(pigContext);
  pigServer.registerQuery("A = load " + A + " using PigStorage() as (x : int, y : int);");
  pigServer.registerQuery("B = foreach A generate x + y as sum;");
  Map<Operator,DataBag> derivedData=pigServer.getExamples("B");
  assertNotNull(derivedData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFRJoinSch6() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  Schema frjSch=null, shjSch=null;
  pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1) using 'repl';");
  frjSch=pigServer.dumpSchema("C");
  assertNull(frjSch);
  pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1);");
  shjSch=pigServer.dumpSchema("C");
  assertNull(shjSch);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFRJoinSch4() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "';");
  Schema frjSch=null, shjSch=null;
  pigServer.registerQuery("D = join A by $0, B by $0, C by $0 using 'repl';");
  frjSch=pigServer.dumpSchema("D");
  assertNull(frjSch);
  pigServer.registerQuery("D = join A by $0, B by $0, C by $0;");
  shjSch=pigServer.dumpSchema("D");
  assertNull(shjSch);
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFRJoinSch2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  Schema frjSch=null, shjSch=null;
  pigServer.registerQuery("C = join A by $0, B by $0 using 'repl';");
  frjSch=pigServer.dumpSchema("C");
  assertNull(frjSch);
  pigServer.registerQuery("C = join A by $0, B by $0;");
  shjSch=pigServer.dumpSchema("C");
  assertNull(shjSch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFetch </h4><pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests whether 'pig.job.submitted.timestamp' has been set by FetchLauncher
 * @throws Exception
 */
@Test public void test7() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> justSomeRows=Lists.newArrayListWithCapacity(1);
  justSomeRows.add(tuple(1));
  data.set("justSomeRows",justSomeRows);
  pigServer.registerQuery("A = load 'justSomeRows' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate CurrentTime();");
  Iterator<Tuple> it=pigServer.openIterator("B");
  DateTime received=(DateTime)it.next().get(0);
  assertNotNull(received);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorage </h4><pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to if HBaseStorage handles different scans in a single MR job.
 * This can happen PIG loads two different aliases (as in a join or
 * union).
 */
@Test public void testHeterogeneousScans() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery(String.format(" b = load 'hbase://%s' using %s('%s %s') as (col_a:int, col_c);",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage",TESTCOLUMN_A,TESTCOLUMN_C));
  pig.registerQuery(" c = join a by col_a, b by col_a; ");
  Iterator<Tuple> it=pig.openIterator("c");
  int index=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    Assert.assertNotNull(t.get(2));
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  Assert.assertEquals(index,TEST_ROW_COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * load from hbase test
 * @throws IOException
 */
@Test public void testLoadFromHBase() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  LOG.info("QUERY: " + "a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Object col_d=t.get(3);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertNull(col_d);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInfixArithmetic </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 + $1, $1;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first + first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivide() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 / $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(1.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiply() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 * $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first * first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 - $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(0.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testJoinUnkownSchema() throws Exception {
  String script="a = load 'a.txt';" + "b = load 'b.txt'; " + "c = join a by $0, b by $0;";
  Util.registerMultiLineQuery(pigServer,script);
  Schema schema=pigServer.dumpSchema("c");
  assertNull(schema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLOLoadDeterminedSchema </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Loads a test file using ScriptSchemaTestLoader with a user defined schema
 * a,b,c.<br/>
 * Then tests the the ScriptSchemaTestLoader found the schema.
 * @throws IOException
 */
@Test public void testDeterminedSchema() throws IOException {
  FuncSpec funcSpec=new FuncSpec(ScriptSchemaTestLoader.class.getName() + "()");
  server.registerFunction(ScriptSchemaTestLoader.class.getName(),funcSpec);
  server.registerQuery("a = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' using "+ ScriptSchemaTestLoader.class.getName()+ "() as (a, b, c) ;");
  server.openIterator("a");
  Schema scriptSchema=ScriptSchemaTestLoader.getScriptSchema();
  assertNotNull(scriptSchema);
  assertEquals(3,scriptSchema.size());
  assertNotNull(scriptSchema.getField("a"));
  assertNotNull(scriptSchema.getField("b"));
  assertNotNull(scriptSchema.getField("c"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLimitSchemaStore </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLimitStoreSchema1() throws Exception {
  Util.createLocalInputFile("student",new String[]{"joe smith:18:3.5","amy brown:25:2.5","jim fox:20:4.0","leo fu:55:3.0"});
  pigServer.registerQuery("a = load 'student' using " + PigStorage.class.getName() + "(':') as (name, age, gpa);");
  pigServer.registerQuery("d = distinct a;");
  pigServer.registerQuery("lim = limit d 1;");
  String outFile="limitSchemaOut";
  Util.deleteDirectory(new File(outFile));
  pigServer.store("lim",outFile,"PigStorage('\\t', '-schema')");
  pigServer.dumpSchema("lim");
  pigServer.registerQuery("b = LOAD '" + outFile + "' using PigStorage('\\t', '-schema');");
  Schema genSchema=pigServer.dumpSchema("b");
  System.err.println(genSchema);
  Assert.assertNotNull(genSchema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMod </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Mod operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 % inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 % inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMonitoredUDF </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testTimeout() throws IOException {
  SimpleUDF udf=new SimpleUDF(1000);
  MonitoredUDFExecutor exec=new MonitoredUDFExecutor(udf);
  assertNull(exec.monitorExec(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiply </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Multiply operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 * inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 * inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 * inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 * inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-13 type-7 type-8 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDistinct() throws Exception {
  String testQuery="a = load 'd.txt' as (id, v1, v2);" + "b = load 'd.txt' as (id, v1, v2);" + "c = distinct a;"+ "d = union b, c;"+ "e = foreach d generate id, v1;"+ "store e into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(testQuery);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Operator o=iter.next();
    LogicalRelationalOperator lro=(LogicalRelationalOperator)o;
    if (lro == null || lro.getAlias() == null)     continue;
    if (lro.getAlias().equals("d")) {
      assertNotNull(lro.getSchema());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testPruneWithMapKey() throws Exception {
  String query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  LOLoad op=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Integer,Set<String>> annotation=(Map<Integer,Set<String>>)op.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  Set<String> s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
  query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = load 'd.txt' as (id, v1, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = load 'd.txt' as (id, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  List<Operator> ll=newLogicalPlan.getSources();
  assertEquals(2,ll.size());
  LOLoad loada=null;
  LOLoad loadb=null;
  for (  Operator opp : ll) {
    if (((LogicalRelationalOperator)opp).getAlias().equals("a")) {
      loada=(LOLoad)opp;
      continue;
    }
    if (((LogicalRelationalOperator)opp).getAlias().equals("b")) {
      loadb=(LOLoad)opp;
      continue;
    }
  }
  annotation=(Map<Integer,Set<String>>)loada.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNull(annotation);
  annotation=(Map<Integer,Set<String>>)loadb.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanFilterRule </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterRuleWith2And() throws Exception {
  prep();
  LogicalExpressionPlan p5=new LogicalExpressionPlan();
  LogicalExpression lp3=new ProjectExpression(p5,0,2,filter);
  LogicalExpression cont=new ConstantExpression(p5,new Integer(3));
  p5.add(lp3);
  p5.add(cont);
  LogicalExpression eq=new EqualExpression(p5,lp3,cont);
  LogicalExpression lp4=new ProjectExpression(p5,0,3,filter);
  LogicalExpression cont2=new ConstantExpression(p5,new Integer(3));
  p5.add(lp4);
  p5.add(cont2);
  LogicalExpression eq2=new EqualExpression(p5,lp4,cont2);
  LogicalExpression and1=new AndExpression(p5,eq,eq2);
  lp3=new ProjectExpression(p5,0,0,filter);
  lp4=new ProjectExpression(p5,0,3,filter);
  p5.add(lp3);
  p5.add(lp4);
  eq2=new EqualExpression(p5,lp3,lp4);
  LogicalExpression and2=new AndExpression(p5,and1,eq2);
  ((LOFilter)filter).setFilterPlan(p5);
  Rule r=new SplitFilter("SplitFilter");
  Set<Rule> s=new HashSet<Rule>();
  s.add(r);
  List<Set<Rule>> ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  MyPlanOptimizer optimizer=new MyPlanOptimizer(plan,ls,3);
  MyPlanTransformListener listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  Assert.assertEquals(plan.getPredecessors(filter).get(0),join);
  Operator next=plan.getSuccessors(filter).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(LOStore.class,next.getClass());
  OperatorPlan transformed=listener.getTransformed();
  Assert.assertEquals(transformed.size(),3);
  r=new PushUpFilter("PushUpFilter");
  s=new HashSet<Rule>();
  s.add(r);
  ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  optimizer=new MyPlanOptimizer(plan,ls,3);
  listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  next=plan.getSuccessors(load1).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(load2).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(join).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOStore.class);
  transformed=listener.getTransformed();
  Assert.assertEquals(transformed.size(),7);
  r=new MergeFilter("MergeFilter");
  s=new HashSet<Rule>();
  s.add(r);
  ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  optimizer=new MyPlanOptimizer(plan,ls,3);
  listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  next=plan.getSuccessors(load1).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(load2).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(join).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOStore.class);
  transformed=listener.getTransformed();
  Assert.assertNull(transformed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanListener </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaPatcher() throws FrontendException {
  SchemaPatcher patcher=new SchemaPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalSchema dschema=D.getSchema();
  assertEquals(1,dschema.size());
  LogicalSchema.LogicalFieldSchema y=dschema.getField(0);
  assertEquals("y",y.alias);
  assertEquals(2,y.uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionPatcher() throws FrontendException {
  ProjectionPatcher patcher=new ProjectionPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalExpressionPlan filterPlan=D.getFilterPlan();
  List<Operator> leaves=filterPlan.getSinks();
  assertEquals(2,leaves.size());
  ProjectExpression proj=null;
  for (  Operator leaf : leaves) {
    if (leaf instanceof ProjectExpression) {
      proj=(ProjectExpression)leaf;
      break;
    }
  }
  assertNotNull(proj);
  assertEquals(0,proj.getInputNum());
  assertEquals(0,proj.getColNum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace4() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  Operator filter3=new SillyOperator("filter3",plan);
  plan.replace(filter2,filter3);
  List<Operator> preds=plan.getPredecessors(filter3);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(filter1));
  List<Operator> succs=plan.getSuccessors(filter3);
  assertNull(succs);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace5() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  Operator load2=new SillyOperator("load2",plan);
  plan.replace(load1,load2);
  List<Operator> preds=plan.getPredecessors(load2);
  assertNull(preds);
  List<Operator> succs=plan.getSuccessors(load2);
  assertEquals(1,succs.size());
  assertTrue(succs.contains(filter1));
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRemove3() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  plan.removeAndReconnect(filter2);
  List<Operator> succs=plan.getSuccessors(filter2);
  assertNull(succs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPruneMapKeys </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan2() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(1,keys.size());
  assertEquals("name",keys.toArray(new String[0])[0]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan3() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate a#'age',b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(2,keys.size());
  assertTrue(keys.contains("name"));
  assertTrue(keys.contains("age"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan5() throws Exception {
  String query="a =load 'd.txt' as (a:chararray, b:int, c:float);" + "b = filter a by a == 'hello';" + "c = foreach b generate a,b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertNull(annotation);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNullConstant </h4><pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testExplicitCast() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate (int)null, (double)null, (chararray)null, (map[])null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testArithExpressions() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate x + null, x * null, x / null, x - null, null % x, " + "y + null, y * null, y / null, y - null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 9; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testComplexNullConstants() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate {(null)}, ['2'#null];");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  assertNull(((DataBag)t.get(0)).iterator().next().get(0));
  assertNull(((Map<String,Object>)t.get(1)).get("2"));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testConcatAndSize() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate SIZE(null), CONCAT(str, null), " + "CONCAT(null, str);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOBinCond </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondLongWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.LONG);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.LONG,new Long(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Long value=null;
    if (t.get(0) != null) {
      value=(Long)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDoubleWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DOUBLE);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DOUBLE,new Double(1.0));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Double value=null;
    if (t.get(0) != null) {
      value=(Double)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondIntWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.INTEGER);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.INTEGER,new Integer(1));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Integer value=null;
    Integer result;
    if (t.get(0) != null) {
      value=(Integer)t.get(0);
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
 else {
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
    int actual;
    if (value != null) {
      int expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDateTimeWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DATETIME);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DATETIME,new DateTime(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    DateTime value=null;
    if (t.get(0) != null) {
      value=(DateTime)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=value.equals(new DateTime(1L)) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPONegative </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegLongAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Long output=(Long)pn.getNextLong().result;
      assertNull(output);
    }
 else {
      Long expected=-(Long)t.get(0);
      long output=(Long)pn.getNextLong().result;
      assertEquals(expected.longValue(),output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegIntAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.INTEGER);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.INTEGER);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer output=(Integer)pn.getNextInteger().result;
      assertNull(output);
    }
 else {
      Integer expected=-(Integer)t.get(0);
      Integer output=(Integer)pn.getNextInteger().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegFloatAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float output=(Float)pn.getNextFloat().result;
      assertNull(output);
    }
 else {
      Float expected=-(Float)t.get(0);
      Float output=(Float)pn.getNextFloat().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegDoubleAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextDouble());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.DOUBLE);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.DOUBLE);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double output=(Double)pn.getNextDouble().result;
      assertNull(output);
    }
 else {
      Double expected=-(Double)t.get(0);
      Double output=(Double)pn.getNextDouble().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlan </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlanMR </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOSort </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (null, 10)
 * (1, 8 )
 * (3, 8 )
 * (null,null)
 * (1, null)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1WithNull() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 8 )
 * (1, null)
 * (1, 8 )
 * (null,null)
 * (null, 10)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2Null() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigRunner </h4><pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterExternalJar() throws Exception {
  String jarName=Util.findPigJarName();
  String[] args={"-Dpig.additional.jars=" + jarName,"-Dmapred.job.queue.name=default","-x",execType,"-e","A = load '" + INPUT_FILE + "';store A into '"+ OUTPUT_FILE+ "';\n"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  Util.deleteFile(cluster,OUTPUT_FILE);
  PigContext ctx=stats.getPigContext();
  assertNotNull(ctx);
  assertTrue(ctx.extraJars.contains(ClassLoader.getSystemResource(jarName)));
  assertTrue("default",ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME) != null && ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME).equals("default") || ctx.getProperties().getProperty("mapreduce.job.queuename") != null && ctx.getProperties().getProperty("mapreduce.job.queuename").equals("default"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDescribeForEachFlatten() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a';");
  pig.registerQuery("b = group a by $0;");
  pig.registerQuery("c = foreach b generate flatten(a);");
  Schema s=pig.dumpSchema("c");
  assertNull(s);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigProperties() throws Throwable {
  File propertyFile=new File(tempDir,"pig.properties");
  propertyFile.deleteOnExit();
  TestPigServer.registerNewResource(propertyFile.getAbsolutePath());
  File cliPropertyFile=new File("commandLine_pig.properties");
  cliPropertyFile.deleteOnExit();
  TestPigServer.registerNewResource(cliPropertyFile.getAbsolutePath());
  Properties properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("40000000",properties.getProperty("pig.spill.gc.activation.size"));
  assertNull(properties.getProperty("test123"));
  PrintWriter out=new PrintWriter(new FileWriter(propertyFile));
  out.println("test123=properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("properties",properties.getProperty("test123"));
  out=new PrintWriter(new FileWriter(cliPropertyFile));
  out.println("test123=cli_properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  PropertiesUtil.loadPropertiesFromFile(properties,"commandLine_pig.properties");
  assertEquals("cli_properties",properties.getProperty("test123"));
  propertyFile.delete();
  cliPropertyFile.delete();
}

</code></pre>

<br>
<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDescribeForeachNoSchema() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' ;");
  pig.registerQuery("b = foreach a generate *;");
  Schema dumpedSchema=pig.dumpSchema("b");
  assertNull(dumpedSchema);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  Schema origSchema=pig.dumpSchema("a");
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t');");
  Schema genSchema=pig.dumpSchema("b");
  Assert.assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
  String[] aliases={"foo","bar"};
  byte[] types={DataType.INTEGER,DataType.LONG};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  pig.registerQuery("c = LOAD '" + datadir + "aout' using PigStorage('\\t', '-schema') "+ "as (foo:int, bar:long);");
  Schema newGenSchema=pig.dumpSchema("c");
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,newGenSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is for testing source tagging option on PigStorage. When a user
 * specifies '-tagFile' as an option, PigStorage must prepend the input
 * source path to the tuple and "INPUT_FILE_NAME" to schema.
 * @throws Exception
 */
@Test public void testPigStorageSourceTagSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile');");
  Schema genSchema=pig.dumpSchema("b");
  String[] fileAliases={"INPUT_FILE_NAME","f1","f2"};
  byte[] fileTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(fileAliases,fileTypes);
  Assert.assertTrue("schema with -tagFile preprends INPUT_FILE_NAME",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagPath');");
  genSchema=pig.dumpSchema("b");
  String[] pathAliases={"INPUT_FILE_PATH","f1","f2"};
  byte[] pathTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(pathAliases,pathTypes);
  Assert.assertTrue("schema with -tagPath preprends INPUT_FILE_PATH",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile') "+ "as (input_file:chararray, foo:chararray, bar:int);");
  genSchema=pig.dumpSchema("b");
  String[] newAliases={"input_file","foo","bar"};
  byte[] newTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(newAliases,newTypes);
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,genSchema,true,false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPlanGeneration </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = order A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOSort loSort=(LOSort)lp.getPredecessors(loStore).get(0);
  Operator sortPlanLeaf=loSort.getSortColPlans().get(0).getSources().get(0);
  LogicalFieldSchema sortPlanFS=((LogicalExpression)sortPlanLeaf).getFieldSchema();
  assertNull(sortPlanFS);
  PhysicalPlan pp=Util.buildPhysicalPlanFromNewLP(lp,pc);
  POStore poStore=(POStore)pp.getLeaves().get(0);
  POSort poSort=(POSort)pp.getPredecessors(poStore).get(0);
  POProject poProject=(POProject)poSort.getSortPlans().get(0).getLeaves().get(0);
  assertEquals(DataType.TUPLE,poProject.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBagInnerPlan() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A { B1 = filter u by $1==0; generate B1;};" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertNull(tupleFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = group A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOCogroup loCoGroup=(LOCogroup)lp.getPredecessors(loStore).get(0);
  LogicalFieldSchema groupFieldSchema=loCoGroup.getSchema().getField(0);
  assertEquals(DataType.TUPLE,groupFieldSchema.type);
  assertNull(groupFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionFilterOptimizer() throws Exception {
  String query="a = load 'foo' using " + PartitionedLoader.class.getName() + "('name:chararray, dt:chararray', 'dt');\n"+ "b = filter a by dt=='2011';\n"+ "store b into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOLoad loLoad=(LOLoad)lp.getSources().get(0);
  LOStore loStore=(LOStore)lp.getSuccessors(loLoad).get(0);
  assertNotNull(((PartitionedLoader)loLoad.getLoadFunc()).getPartFilter());
  assertEquals("b",loStore.getAlias());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLoaderWithSchema() throws Exception {
  String query="a = load 'foo' using " + SchemaLoader.class.getName() + "('name,age,gpa');\n"+ "b = filter a by age==20;"+ "store b into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOLoad loLoad=(LOLoad)lp.getSources().get(0);
  LOFilter loFilter=(LOFilter)lp.getSuccessors(loLoad).get(0);
  LOStore loStore=(LOStore)lp.getSuccessors(loFilter).get(0);
  assertNull(lp.getSuccessors(loStore));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGenerateStar() throws Exception {
  String query="a = load 'x';" + "b = foreach a generate *;" + "store b into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  assertNull(loForEach.getSchema());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPruneColumn </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by $1, B by $1;");
  pigServer.registerQuery("D = foreach C generate AVG($1.$1);");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertNull(t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2.0",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("5.0",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitOutputWithForEach() throws Exception {
  Path output1=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  Path output2=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile5.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2, a3);");
  pigServer.registerQuery("B = foreach A generate a0, a1, a2;");
  pigServer.registerQuery("store B into '" + Util.generateURI(output1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("C = order B by a2;");
  pigServer.registerQuery("D = foreach C generate a2;");
  pigServer.registerQuery("store D into '" + Util.generateURI(output2.toString(),pigServer.getPigContext()) + "';");
  pigServer.executeBatch();
  BufferedReader reader1=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output1.toString(),pigServer.getPigContext().getProperties())));
  String line=reader1.readLine();
  assertEquals("1\t2\t3",line);
  line=reader1.readLine();
  assertEquals("2\t3\t4",line);
  assertNull(reader1.readLine());
  BufferedReader reader2=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output2.toString(),pigServer.getPigContext().getProperties())));
  line=reader2.readLine();
  assertEquals("3",line);
  line=reader2.readLine();
  assertEquals("4",line);
  assertNull(reader2.readLine());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $3"}));
  reader1.close();
  reader2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestReadToEndLoader </h4><pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testIsReaderForLastSplitClosed() throws Exception {
  final LoadFunc loadFunc=mock(LoadFunc.class);
  final InputFormat inputFormat=mock(InputFormat.class);
  final RecordReader recordReader=mock(RecordReader.class);
  final InputSplit inputSplit=mock(InputSplit.class);
  when(loadFunc.getInputFormat()).thenReturn(inputFormat);
  when(inputFormat.createRecordReader(any(InputSplit.class),any(TaskAttemptContext.class))).thenReturn(recordReader);
  when(inputFormat.getSplits(any(JobContext.class))).thenReturn(Arrays.asList(inputSplit));
  Configuration conf=new Configuration();
  ReadToEndLoader loader=new ReadToEndLoader(loadFunc,conf,"loc",0);
  Assert.assertNull(loader.getNext());
  verify(recordReader,times(1)).close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegexp </h4><pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMatches() throws ExecException {
  lt.setValue(new String("The quick sly fox jumped over the lazy brown dog"));
  rt.setValue(".*s.y.*");
  Result res=op.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
  lt.setValue(null);
  rt.setValue(".*s.y.*");
  res=op.getNextBoolean();
  assertNull(res.result);
  lt.setValue(new String("The quick sly fox jumped over the lazy brown dog"));
  rt.setValue(null);
  res=op.getNextBoolean();
  assertNull(res.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can turn a schema into a string and then parse it
 * back into a schema.
 */
@Test public void testToStringAndParse() throws Exception {
  ResourceSchema rs=new ResourceSchema();
  ResourceFieldSchema[] fields=new ResourceFieldSchema[13];
  byte[] types={DataType.INTEGER,DataType.LONG,DataType.FLOAT,DataType.DOUBLE,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.MAP,DataType.TUPLE,DataType.TUPLE,DataType.BAG,DataType.BAG,DataType.BOOLEAN,DataType.DATETIME};
  String[] names={"i","l","f","d","b","s","m","tschema","tnull","bschema","bnull","bb","dt"};
  for (int i=0; i < fields.length; i++) {
    fields[i]=new ResourceFieldSchema();
    fields[i].setName(names[i]);
    fields[i].setType(types[i]);
  }
  ResourceSchema tschema=new ResourceSchema();
  ResourceFieldSchema[] tfields=new ResourceFieldSchema[3];
  for (int i=0; i < 3; i++) {
    tfields[i]=new ResourceFieldSchema();
    tfields[i].setName(names[i]);
    tfields[i].setType(types[i]);
  }
  tschema.setFields(tfields);
  fields[7].setSchema(tschema);
  ResourceSchema bschema=new ResourceSchema();
  ResourceFieldSchema[] bfields=new ResourceFieldSchema[1];
  bfields[0]=new ResourceFieldSchema();
  bfields[0].setName("t");
  bfields[0].setType(DataType.TUPLE);
  ResourceSchema tbschema=new ResourceSchema();
  ResourceFieldSchema[] tbfields=new ResourceFieldSchema[3];
  for (int i=3; i < 6; i++) {
    tbfields[i - 3]=new ResourceFieldSchema();
    tbfields[i - 3].setName(names[i]);
    tbfields[i - 3].setType(types[i]);
  }
  tbschema.setFields(tbfields);
  bfields[0].setSchema(tbschema);
  bschema.setFields(bfields);
  fields[9].setSchema(bschema);
  rs.setFields(fields);
  String strSchema=rs.toString();
  assertEquals("i:int,l:long,f:float,d:double,b:bytearray,s:" + "chararray,m:[],tschema:(i:int,l:long,f:float)," + "tnull:(),bschema:{t:(d:double,b:bytearray,s:chararray)},bnull:{},bb:boolean,dt:datetime",strSchema);
  ResourceSchema after=new ResourceSchema(Utils.getSchemaFromString(strSchema));
  ResourceFieldSchema[] afterFields=after.getFields();
  assertEquals(13,afterFields.length);
  assertEquals("i",afterFields[0].getName());
  assertEquals(DataType.INTEGER,afterFields[0].getType());
  assertEquals("l",afterFields[1].getName());
  assertEquals(DataType.LONG,afterFields[1].getType());
  assertEquals("f",afterFields[2].getName());
  assertEquals(DataType.FLOAT,afterFields[2].getType());
  assertEquals("d",afterFields[3].getName());
  assertEquals(DataType.DOUBLE,afterFields[3].getType());
  assertEquals("b",afterFields[4].getName());
  assertEquals(DataType.BYTEARRAY,afterFields[4].getType());
  assertEquals("s",afterFields[5].getName());
  assertEquals(DataType.CHARARRAY,afterFields[5].getType());
  assertEquals("m",afterFields[6].getName());
  assertEquals(DataType.MAP,afterFields[6].getType());
  assertEquals("tschema",afterFields[7].getName());
  assertEquals(DataType.TUPLE,afterFields[7].getType());
  assertEquals("tnull",afterFields[8].getName());
  assertEquals(DataType.TUPLE,afterFields[8].getType());
  assertEquals("bschema",afterFields[9].getName());
  assertEquals(DataType.BAG,afterFields[9].getType());
  assertEquals("bnull",afterFields[10].getName());
  assertEquals(DataType.BAG,afterFields[10].getType());
  assertEquals("bb",afterFields[11].getName());
  assertEquals(DataType.BOOLEAN,afterFields[11].getType());
  assertEquals("dt",afterFields[12].getName());
  assertEquals(DataType.DATETIME,afterFields[12].getType());
  assertNotNull(afterFields[7].getSchema());
  ResourceFieldSchema[] tAfterFields=afterFields[7].getSchema().getFields();
  assertEquals(3,tAfterFields.length);
  assertEquals("i",tAfterFields[0].getName());
  assertEquals(DataType.INTEGER,tAfterFields[0].getType());
  assertEquals("l",tAfterFields[1].getName());
  assertEquals(DataType.LONG,tAfterFields[1].getType());
  assertEquals("f",tAfterFields[2].getName());
  assertEquals(DataType.FLOAT,tAfterFields[2].getType());
  assertNotNull(afterFields[9].getSchema());
  ResourceFieldSchema[] bAfterFields=afterFields[9].getSchema().getFields();
  assertEquals(1,bAfterFields.length);
  assertNotNull(bAfterFields[0].getSchema());
  ResourceFieldSchema[] tbAfterFields=bAfterFields[0].getSchema().getFields();
  assertEquals(3,tbAfterFields.length);
  assertEquals("d",tbAfterFields[0].getName());
  assertEquals(DataType.DOUBLE,tbAfterFields[0].getType());
  assertEquals("b",tbAfterFields[1].getName());
  assertEquals(DataType.BYTEARRAY,tbAfterFields[1].getType());
  assertEquals("s",tbAfterFields[2].getName());
  assertEquals(DataType.CHARARRAY,tbAfterFields[2].getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-7 type-2 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize1() throws Throwable {
  LogicalSchema a=Utils.parseSchema("a1:bytearray, b1:long, c1:long");
  LogicalSchema b=Utils.parseSchema("a2:bytearray, b2:long");
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  assertNull(mergedSchema);
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testParsingMapSchemasFromString() throws ParserException {
  assertNotNull(Utils.getSchemaFromString("b:[(a:int)]"));
  assertNotNull(Utils.getSchemaFromString("b:[someAlias: (b:int)]"));
  assertNotNull(Utils.getSchemaFromString("a:map[{bag: (a:int)}]"));
  assertNotNull(Utils.getSchemaFromString("a:map[someAlias: {bag: (a:int)}]"));
  assertNotNull(Utils.getSchemaFromString("a:map[chararray]"));
  assertNotNull(Utils.getSchemaFromString("a:map[someAlias: chararray]"));
  assertNotNull(Utils.getSchemaFromString("a:map[someAlias: (bar: {bag: (a:int)})]"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStringUDFs </h4><pre class="type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEndsWith() throws IOException {
  ENDSWITH endsWith=new ENDSWITH();
  Tuple testTuple1=Util.buildTuple("foo","bar");
  assertFalse("String suffix should not match",endsWith.exec(testTuple1));
  Tuple testTuple2=Util.buildTuple("foobaz","foo");
  assertFalse("String suffix should not match",endsWith.exec(testTuple2));
  Tuple testTuple3=Util.buildTuple("foobaz","baz");
  assertTrue("String suffix should match",endsWith.exec(testTuple3));
  Tuple testTuple4=Util.buildTuple(null,"bar");
  assertNull("Should return null",endsWith.exec(testTuple4));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrim() throws IOException {
  TRIM trim=new TRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces".trim(),trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("spaces both",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLtrim() throws IOException {
  LTRIM trim=new LTRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces",trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right    ",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("spaces both    ",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRtrim() throws IOException {
  RTRIM trim=new RTRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces",trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("    spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("    spaces both",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexOf() throws IOException {
  INDEXOF indexOf=new INDEXOF();
  Tuple testTuple=Util.buildTuple("xyz","");
  assertEquals(((Integer)"xyz".indexOf("")),indexOf.exec(testTuple));
  testTuple=Util.buildTuple(null,null);
  assertNull(indexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","y");
  assertEquals(((Integer)"xyz".indexOf("y")),indexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","abc");
  assertEquals(((Integer)"xyz".indexOf("abc")),indexOf.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringSubstr() throws IOException {
  Tuple testTuple=Util.buildTuple(null,0,2);
  assertNull("null is null",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("",0,2);
  assertEquals("empty string","",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("abcde",1,3);
  assertEquals("lowercase string","bc",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("abc",0,15);
  assertEquals("uppercase string","abc",stringSubstr_.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastIndexOf() throws IOException {
  LAST_INDEX_OF lastIndexOf=new LAST_INDEX_OF();
  Tuple testTuple=Util.buildTuple("xyz","");
  assertEquals(((Integer)"xyz".lastIndexOf("")),lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple(null,null);
  assertNull(lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyzyy","y");
  assertEquals(((Integer)"xyzyy".lastIndexOf("y")),lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","abc");
  assertEquals(((Integer)"xyz".lastIndexOf("abc")),lastIndexOf.exec(testTuple));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSubtract </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Subtract operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 - inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 - inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 - inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 - inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServerRegister() throws Exception {
  Util.createLocalInputFile("testRegisterScripts.jar",new String[]{"mary had a little lamb"});
  Util.createInputFile(cluster,"input1",new String[]{"abc:123","def:456","ghi:789"});
  File scriptFile=Util.createFile(new String[]{"register 'testRegisterScripts.jar';","a = load 'input1' using " + PigStorage.class.getName() + "(':');","b = foreach a generate $0;","store b into '/bla1';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServer() throws Exception {
  Util.createInputFile(cluster,"input",new String[]{"abc\t123","def\t456","ghi\t789"});
  File scriptFile=Util.createFile(new String[]{"a = load 'input' using " + PigStorage.class.getName() + "('\t');","b = foreach a generate $0;","store b into '/bla';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareNULL() throws Throwable {
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : (i : int));" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.TUPLE,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by t1 <= null;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityMapCast() throws Throwable {
  String query="a = load 'a' as (t : map[], col);" + "b = filter a by t != col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.MAP,castExp.getType());
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testLineage1() throws Throwable {
  String query="a = load 'a' as (field1: int, field2: float, field3: chararray );" + "b = foreach a generate field1 + 1.0;";
  CastExpression cast=getCastFromLastForeach(query);
  assertNull(cast.getFuncSpec());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityTupleCast() throws Throwable {
  String query="a = load 'a' as (t : (i : int, j : int), col);" + "b = filter a by t == col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.TUPLE,castExp.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFGroovy </h4><pre class="type-13 type-7 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroovyToPig() throws Exception {
  Object groovyObject=Boolean.TRUE;
  Object pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Boolean);
  assertEquals(true,pigObject);
  groovyObject=Byte.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Byte.MIN_VALUE,pigObject);
  groovyObject=Short.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Short.MIN_VALUE,pigObject);
  groovyObject=Integer.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals(Integer.MIN_VALUE,pigObject);
  groovyObject=Long.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Long);
  assertEquals(Long.MIN_VALUE,pigObject);
  groovyObject=BigInteger.TEN;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=Float.MIN_NORMAL;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Float);
  assertEquals(Float.MIN_NORMAL,pigObject);
  groovyObject=Double.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Double);
  assertEquals(Double.MIN_VALUE,pigObject);
  groovyObject=new BigDecimal("42.42");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject="Dans le cochon tout est bon !";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",pigObject);
  groovyObject="Surtout le jambon".getBytes("UTF-8");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataByteArray);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),((DataByteArray)pigObject).get());
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Pate";
  ((Object[])groovyObject)[1]="Henaff";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Pate",((Tuple)pigObject).get(0));
  assertEquals("Henaff",((Tuple)pigObject).get(1));
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Rillettes";
  ((Object[])groovyObject)[1]="Bordeau Chesnel";
  groovyObject=new groovy.lang.Tuple((Object[])groovyObject);
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Rillettes",((Tuple)pigObject).get(0));
  assertEquals("Bordeau Chesnel",((Tuple)pigObject).get(1));
  groovyObject=new ArrayList();
  ((List)groovyObject).add("Jaret");
  ((List)groovyObject).add("Filet Mignon");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataBag);
  assertEquals(2,((DataBag)pigObject).size());
  Iterator<Tuple> iter=((DataBag)pigObject).iterator();
  Set<String> values=new HashSet<String>();
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(1,t.size());
    values.add((String)t.get(0));
  }
  assertEquals(2,values.size());
  assertTrue(values.contains("Jaret"));
  assertTrue(values.contains("Filet Mignon"));
  groovyObject=new HashMap<String,String>();
  ((Map)groovyObject).put("Henaff","a bord");
  ((Map)groovyObject).put("Copains","comme cochons");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Map);
  assertEquals(2,((Map)pigObject).size());
  assertEquals("a bord",((Map)pigObject).get("Henaff"));
  assertEquals("comme cochons",((Map)pigObject).get("Copains"));
  groovyObject=TupleFactory.getInstance().newTuple(2);
  ((Tuple)groovyObject).set(0,"jambon");
  ((Tuple)groovyObject).set(1,"blanc");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new DefaultDataBag();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new org.joda.time.DateTime();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  groovyObject=null;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertNull(pigObject);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigToGroovy() throws Exception {
  Object pigObject=Boolean.TRUE;
  Object groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Boolean);
  assertEquals(true,groovyObject);
  pigObject=Integer.valueOf(42);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Integer);
  assertEquals(42,groovyObject);
  pigObject=Long.valueOf(0x100000000L);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Long);
  assertEquals(0x100000000L,groovyObject);
  pigObject=Float.MIN_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Float);
  assertEquals(Float.MIN_VALUE,groovyObject);
  pigObject=Double.MAX_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Double);
  assertEquals(Double.MAX_VALUE,groovyObject);
  pigObject="Dans le cochon tout est bon !";
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",groovyObject);
  pigObject=new DataByteArray("Surtout le jambon".getBytes("UTF-8"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof byte[]);
  assertNotSame(groovyObject,pigObject);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),(byte[])groovyObject);
  pigObject=new org.joda.time.DateTime();
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  pigObject=tuple("a","b","c");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(3,((groovy.lang.Tuple)groovyObject).size());
  assertEquals("a",((groovy.lang.Tuple)groovyObject).get(0));
  assertEquals("b",((groovy.lang.Tuple)groovyObject).get(1));
  assertEquals("c",((groovy.lang.Tuple)groovyObject).get(2));
  pigObject=bag(tuple("a"),tuple("b"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(2,((groovy.lang.Tuple)groovyObject).size());
  assertEquals(2L,((groovy.lang.Tuple)groovyObject).get(0));
  assertTrue(((groovy.lang.Tuple)groovyObject).get(1) instanceof Iterator);
  Iterator<groovy.lang.Tuple> iter=(Iterator)((groovy.lang.Tuple)groovyObject).get(1);
  groovy.lang.Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("a",t.get(0));
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("b",t.get(0));
  pigObject=new HashMap<String,String>();
  ((Map)pigObject).put("Pate","Henaff");
  ((Map)pigObject).put("Rillettes","Bordeau Chesnel");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Map);
  assertEquals(2,((Map)groovyObject).size());
  assertEquals("Henaff",((Map)groovyObject).get("Pate"));
  assertEquals("Bordeau Chesnel",((Map)groovyObject).get("Rillettes"));
  pigObject=BigInteger.ONE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=new BigDecimal("42.42");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=null;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertNull(groovyObject);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestPOPartialAggPlanTez </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezJobControlCompiler </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun2() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = group a by x;"+ "c = foreach b generate group, a;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(1,root.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(1,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root.getOutputVertices().get(0),leaf);
  assertEquals(root,leaf.getInputVertices().get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun3() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = load '"+ input2+ "' as (x:int, z:int);"+ "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(2,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root0=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  Vertex root1=compiledPlan.second.getVertex(roots.get(1).getOperatorKey().toString());
  assertNotNull(root0);
  assertNotNull(root1);
  assertEquals(0,root0.getInputVertices().size());
  assertEquals(1,root1.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(2,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root0.getOutputVertices().get(0),leaf);
  assertEquals(root1.getOutputVertices().get(0),leaf);
  assertTrue(leaf.getInputVertices().contains(root0));
  assertTrue(leaf.getInputVertices().contains(root1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = filter a by x > 0;"+ "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(0,root.getOutputVertices().size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
