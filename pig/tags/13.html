<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloPigCluster </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  loadTestData();
  final String loadFlights="flights = LOAD 'accumulo://flights?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String loadAirports="airports = LOAD 'accumulo://airports?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String joinQuery="joined = JOIN flights BY column_map#'origin', airports BY column_map#'code';";
  pig.registerQuery(loadFlights);
  pig.registerQuery(loadAirports);
  pig.registerQuery(joinQuery);
  Iterator<Tuple> it=pig.openIterator("joined");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Assert.assertEquals(4,t.size());
    Object o=t.get(1);
    Map<String,String> airport=null, flight=null;
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data1=(Map<String,String>)o;
    Assert.assertTrue(!data1.isEmpty());
    if (data1.containsKey("origin")) {
      flight=data1;
    }
 else     if (data1.containsKey("code")) {
      airport=data1;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    o=t.get(3);
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data2=(Map<String,String>)o;
    Assert.assertTrue(!data2.isEmpty());
    if (null == flight && data2.containsKey("origin")) {
      flight=data2;
    }
 else     if (null == airport && data2.containsKey("code")) {
      airport=data2;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    Assert.assertTrue(null != airport && null != flight);
    Assert.assertEquals(airport.get("code"),flight.get("origin"));
    i++;
  }
  Assert.assertEquals(6,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorage </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMultipleColumnsWithExpandedMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col2:");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(5,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col2","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col2","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col2","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col2","mapcol4"),"mapval4");
  for (int i=1; i < 5; i++) {
    update=colUpdates.get(i);
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.TestPigBytesRawComparator </h4><pre class="type-13 type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testByteArrayAlphabeticalOrderingByLength() throws Exception {
  for (int i=BinInterSedes.UNSIGNED_BYTE_MAX - 3; i < BinInterSedes.UNSIGNED_BYTE_MAX + 3; i++) {
    DataByteArray dba1=createRepeatedByteArray((byte)'2',i);
    DataByteArray dba2=createRepeatedByteArray((byte)'2',i + 1);
    assertTrue("ByteArray order changed at UNSIGNED_BYTE_MAX boundary",compareTwoObjectsAsNullableBytesWritables(dba1,dba2) < 0);
  }
  for (int i=BinInterSedes.UNSIGNED_SHORT_MAX - 3; i < BinInterSedes.UNSIGNED_SHORT_MAX + 3; i++) {
    DataByteArray dba1=createRepeatedByteArray((byte)'2',i);
    DataByteArray dba2=createRepeatedByteArray((byte)'2',i + 1);
    assertTrue("ByteArray order changed at UNSIGNED_SHORT_MAX boundary",compareTwoObjectsAsNullableBytesWritables(dba1,dba2) < 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJoinWithPruning() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "orc-file-11-format.orc'"+ " using OrcStorage();");
  pigServer.registerQuery("B = foreach A generate int1, string1;");
  pigServer.registerQuery("C = order B by int1;");
  pigServer.registerQuery("D = limit C 10;");
  pigServer.registerQuery("E = load '" + INPUT1 + "' as (e0:int, e1:chararray);");
  pigServer.registerQuery("F = join D by int1, E by e0;");
  Iterator<Tuple> iter=pigServer.openIterator("F");
  int count=0;
  Tuple t=null;
  while (iter.hasNext()) {
    t=iter.next();
    assertEquals(t.size(),4);
    count++;
  }
  assertEquals(count,10);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharVarchar() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "charvarchar.orc'"+ " using OrcStorage();");
  Schema schema=pigServer.dumpSchema("A");
  assertEquals(schema.size(),4);
  assertEquals(schema.getField(0).type,DataType.CHARARRAY);
  assertEquals(schema.getField(1).type,DataType.CHARARRAY);
  Iterator<Tuple> iter=pigServer.openIterator("A");
  int count=0;
  Tuple t=null;
  while (iter.hasNext()) {
    t=iter.next();
    assertEquals(t.size(),4);
    assertTrue(t.get(0) instanceof String);
    assertTrue(t.get(1) instanceof String);
    assertEquals(((String)t.get(1)).length(),20);
    count++;
  }
  assertEquals(count,10000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelationAliasInNestedForeachWhereUnspecified() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> values=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    values.add(tuple(i % 3 == 0 ? null : "a","b"));
  }
  data.set("foo",values);
  pigServer.registerQuery("raw_data = load 'foo' using mock.Storage() as (field_a:chararray, field_b:chararray);");
  pigServer.registerQuery("records = foreach raw_data {" + "  generated_field = (field_a is null ? '-' : field_b);" + "  GENERATE"+ "    field_a,"+ "    field_b,"+ "    generated_field; }");
  pigServer.registerQuery("use_records = foreach records generate generated_field, CONCAT(generated_field,generated_field);");
  Schema expectedSchema=Utils.getSchemaFromString("field_a:chararray, field_b:chararray, generated_field:chararray");
  assertEquals(expectedSchema,pigServer.dumpSchema("records"));
  for (Iterator<Tuple> it=pigServer.openIterator("records"); it.hasNext(); ) {
    Tuple t=it.next();
    String a=(String)t.get(0);
    String b=(String)t.get(1);
    assertEquals("b",b);
    if (a == null) {
      assertEquals("-",t.get(2));
    }
 else {
      assertEquals("a",a);
      assertEquals(b,t.get(2));
    }
  }
  for (Iterator<Tuple> it=pigServer.openIterator("use_records"); it.hasNext(); ) {
    Tuple t=it.next();
    String x=(String)t.get(0);
    assertEquals(x + x,t.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAST() throws IOException, RecognitionException {
  CharStream input=new QueryParserFileStream("test/org/apache/pig/parser/TestAST.pig");
  QueryLexer lexer=new QueryLexer(input);
  CommonTokenStream tokens=new CommonTokenStream(lexer);
  QueryParser parser=new QueryParser(tokens);
  QueryParser.query_return result=parser.query();
  Tree ast=(Tree)result.getTree();
  System.out.println(ast.toStringTree());
  TreePrinter.printTree((CommonTree)ast,0);
  Assert.assertEquals(0,lexer.getNumberOfSyntaxErrors());
  Assert.assertEquals(0,parser.getNumberOfSyntaxErrors());
  Assert.assertEquals("QUERY",ast.getText());
  Assert.assertEquals(5,ast.getChildCount());
  for (int i=0; i < ast.getChildCount(); i++) {
    Tree c=ast.getChild(i);
    Assert.assertEquals("STATEMENT",c.getText());
  }
  Tree stmt=ast.getChild(0);
  Assert.assertEquals("A",stmt.getChild(0).getText());
  Assert.assertTrue("LOAD".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(1);
  Assert.assertEquals("B",stmt.getChild(0).getText());
  Assert.assertTrue("FOREACH".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(2);
  Assert.assertEquals("C",stmt.getChild(0).getText());
  Assert.assertTrue("FILTER".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(3);
  Assert.assertEquals("D",stmt.getChild(0).getText());
  Assert.assertTrue("LIMIT".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(4);
  Assert.assertTrue("STORE".equalsIgnoreCase(stmt.getChild(0).getText()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.TestExtremalTupleByNthField </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMaxAccumulated() throws Exception {
  ExtremalTupleByNthField o=new ExtremalTupleByNthField("5","max");
  for (int j=0; j < 5; ++j) {
    for (int i=0; i < 100; i++) {
      Tuple t=TupleFactory.getInstance().newTuple();
      t.append(i + j);
      t.append(" " + (i + j));
      t.append(i + j);
      t.append(i + j);
      t.append(i + j);
      o.accumulate(t);
    }
    Tuple out=o.getValue();
    Assert.assertEquals(" " + (99 + j),(String)out.get(1));
    o.cleanup();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.TestToBagToTuple </h4><pre class="type-13 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void toBag() throws Exception {
  ToBag tb=new ToBag();
  Tuple input=TupleFactory.getInstance().newTuple();
  for (int i=0; i < 100; ++i) {
    input.append(i);
  }
  Set<Integer> s=new HashSet<Integer>();
  DataBag db=tb.exec(input);
  for (  Tuple t : db) {
    s.add((Integer)t.get(0));
  }
  Assert.assertEquals(100,s.size());
  for (int i=0; i < 100; ++i) {
    Assert.assertTrue(s.contains(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestAllLoader </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can filter by a logic partition based on a range, in this
 * case block<=2
 * @throws IOException
 */
@Test public void testLogicPartitionFilter() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(logicPartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('block<=2')"+ " as (q:float, p:float);");
  server.registerQuery("r = FOREACH a GENERATE q, p;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(2,t.size());
  }
  assertEquals(fileRecords * 2 * fileTypes.length,count);
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can read a date partitioned directory
 * @throws IOException
 * @throws ParseException
 */
@Test public void testDateParitionDir() throws IOException, ParseException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (q:float, p:float, daydate:chararray);");
  server.registerQuery("r = FOREACH a GENERATE daydate;");
  Iterator<Tuple> it=server.openIterator("r");
  DateFormat dateformat=new SimpleDateFormat("yyyy-MM-dd");
  Calendar cal=Calendar.getInstance();
  while (it.hasNext()) {
    Date date=dateformat.parse(it.next().get(0).toString());
    cal.setTime(date);
    assertEquals(2010,cal.get(Calendar.YEAR));
    assertEquals(10,cal.get(Calendar.MONTH));
  }
  readRecordsFromLoader(server,"a",fileRecords * datePartitions.length * fileTypes.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can extract only the partition column
 * @throws IOException
 */
@Test public void testLogicPartitionPartitionColumnExtract() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(logicPartitionDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (q:float, p:float, block:chararray);");
  server.registerQuery("r = foreach a generate block;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  Map<String,AtomicInteger> partitionCount=new HashMap<String,AtomicInteger>();
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(1,t.size());
    String key=t.get(0).toString();
    AtomicInteger ati=partitionCount.get(key);
    if (ati == null) {
      ati=new AtomicInteger(1);
      partitionCount.put(key,ati);
    }
 else {
      ati.incrementAndGet();
    }
  }
  for (  AtomicInteger ati : partitionCount.values()) {
    assertEquals(fileRecords * fileTypes.length,ati.get());
  }
  assertEquals(fileRecords * logicPartitions.length * fileTypes.length,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that we can filter a date partitioned directory by a date range
 * @throws IOException
 */
@Test public void testDateParitionFilterWithAsSchema() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('daydate >= \"2010-11-02\" and daydate <= \"2010-11-04\"') AS (q:float, p:float, daydate:chararray); ");
  server.registerQuery("r = FOREACH a GENERATE $0;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    assertEquals(1,t.size());
  }
  readRecordsFromLoader(server,"a",fileRecords * 3 * fileTypes.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can filter a date partitioned directory by a date range
 * @throws IOException
 */
@Test public void testDateParitionFilterWithoutSchema() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('daydate >= \"2010-11-02\" and daydate <= \"2010-11-04\"'); ");
  server.registerQuery("r = FOREACH a GENERATE $0;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    float f=Float.valueOf(t.get(0).toString());
    assertTrue(f < 1L);
    assertEquals(1,t.size());
  }
  readRecordsFromLoader(server,"a",fileRecords * 3 * fileTypes.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestHiveColumnarLoader </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYearMonthDayHourPartitionedFilesWithProjection() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(yearMonthDayHourPartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("f = FILTER a by year=='2010';");
  server.registerQuery("b = foreach f generate f1,f2;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(2,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(240,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testYearMonthDayHourPartitionedFilesWithProjectionAndPartitionColumns() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(yearMonthDayHourPartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("f = FILTER a by year=='2010';");
  server.registerQuery("r = foreach f generate year, f2, f3, month, day, hour;");
  server.registerQuery("b = ORDER r BY year, month, day, hour;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    System.out.println("Tuple: " + t);
    assertEquals(6,t.size());
    count++;
  }
  System.out.println("Count: " + count);
  Assert.assertEquals(240,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingMultipleNonPartitionedFiles() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedDir=simpleDataDir.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedDir) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = foreach a generate f1;");
  Iterator<Tuple> result=server.openIterator("b");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleDirFileCount * simpleRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingSingleFile() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = foreach a generate f1;");
  Iterator<Tuple> result=server.openIterator("b");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test1DayDatePartitionedFilesWithProjection() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string'" + ", '" + startingDate + ":"+ startingDate+ "')";
  System.out.println(funcSpecString);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  server.registerQuery("b = FOREACH a GENERATE f2 as p;");
  Iterator<Tuple> result=server.openIterator("b");
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(1,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(50,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumerOfColumnsWhenDatePartitionedFiles() throws IOException {
  int count=0;
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string'" + ", '" + startingDate + ":"+ endingDate+ "')";
  System.out.println(funcSpecString);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionedDir.getAbsolutePath()) + "' using "+ funcSpecString+ ";");
  Iterator<Tuple> result=server.openIterator("a");
  Tuple t=null;
  while ((t=result.next()) != null) {
    Assert.assertEquals(4,t.size());
    count++;
  }
  Assert.assertEquals(datePartitionedRowCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadingSingleFileNoProjections() throws IOException {
  String funcSpecString="org.apache.pig.piggybank.storage.HiveColumnarLoader('f1 string,f2 string,f3 string')";
  String singlePartitionedFile=simpleDataFile.getAbsolutePath();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerFunction("org.apache.pig.piggybank.storage.HiveColumnarLoader",new FuncSpec(funcSpecString));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(singlePartitionedFile) + "' using "+ funcSpecString+ ";");
  Iterator<Tuple> result=server.openIterator("a");
  int count=0;
  Tuple t=null;
  while ((t=result.next()) != null) {
    assertEquals(3,t.size());
    assertEquals(DataType.CHARARRAY,t.getType(0));
    count++;
  }
  Assert.assertEquals(simpleRowCount,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestSequenceFileLoader </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsNocast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      System.err.println("expect:---: " + EXPECTED[tupleCount][0]);
      assertEquals(EXPECTED[tupleCount][0],tuple.get(0).toString());
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1).toString());
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadsStringCast() throws IOException {
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(tmpFileName) + "' USING org.apache.pig.piggybank.storage.SequenceFileLoader() AS (key:long, val);");
  Iterator<?> it=pigServer.openIterator("A");
  int tupleCount=0;
  while (it.hasNext()) {
    Tuple tuple=(Tuple)it.next();
    if (tuple == null)     break;
 else {
      assertEquals(Long.parseLong(EXPECTED[tupleCount][0]),tuple.get(0));
      assertEquals(EXPECTED[tupleCount][1],tuple.get(1));
      tupleCount++;
    }
  }
  assertEquals(DATA.length,tupleCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema3() throws IOException {
  Schema complexType[]={Schema.createRecord(new ArrayList<Schema.Field>()),Schema.createArray(Schema.create(Schema.Type.INT)),Schema.createMap(Schema.create(Schema.Type.INT)),Schema.createUnion(new ArrayList<Schema>()),Schema.createFixed("fixed",null,null,1)};
  for (int i=0; i < complexType.length; i++) {
    Schema x=complexType[i];
    for (int j=0; j < complexType.length; j++) {
      Schema y=complexType[j];
      if (i != j) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x,y);
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x.getType() + " with "+ y.getType(),e.getMessage());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema2() throws IOException {
  Schema.Type primitiveType[]={Schema.Type.NULL,Schema.Type.BOOLEAN,Schema.Type.BYTES,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.ENUM,Schema.Type.STRING};
  Schema.Type expectedType[][]={{Schema.Type.NULL,null,null,null,null,null,null,null,null},{null,Schema.Type.BOOLEAN,null,null,null,null,null,null,null},{null,null,Schema.Type.BYTES,null,null,null,null,null,null},{null,null,null,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.LONG,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.ENUM,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING}};
  List<String> enumSymbols=new ArrayList<String>();
  enumSymbols.add("sym1");
  enumSymbols.add("sym2");
  Schema enumSchema=Schema.createEnum("enum",null,null,enumSymbols);
  for (int i=0; i < primitiveType.length; i++) {
    Schema.Type x=primitiveType[i];
    for (int j=0; j < primitiveType.length; j++) {
      Schema.Type y=primitiveType[j];
      if (expectedType[i][j] == null) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x + " with "+ y,e.getMessage());
        }
      }
 else {
        Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
        assertEquals(expectedType[i][j],z.getType());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithOr() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>3 or " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<2)?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithAdd() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A)+1.0;");
{
    HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
    expected.put(100,3.0);
    expected.put(200,2.0);
    expected.put(300,4.0);
    expected.put(400,2.0);
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Double)t.get(1));
    }
  }
{
    pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A)+org.apache.pig.test.utils.AccumulatorBagCount(A);");
    HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
    expected.put(100,4);
    expected.put(200,2);
    expected.put(300,6);
    expected.put(400,2);
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMod() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A) % 2;");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,1);
  expected.put(300,1);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, SUM(A.v), COUNT(A.v), MIN(A.v), MAX(A.v);");
  HashMap<Integer,Double[]> expected=new HashMap<Integer,Double[]>();
  expected.put(100,new Double[]{15.0,5.0,1.0,5.0});
  expected.put(200,new Double[]{6.3,3.0,1.1,3.1});
  expected.put(300,new Double[]{3.3,1.0,3.3,3.3});
  expected.put(400,new Double[]{null,0.0,null,null});
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Double[] v=expected.get((Integer)t.get(0));
    for (int i=0; i < v.length; i++) {
      if (v[i] != null) {
        assertEquals(v[i].doubleValue(),((Number)t.get(i + 1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(i + 1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltinAvg() throws IOException {
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,3.0);
  expected.put(200,2.1);
  expected.put(300,3.3);
  expected.put(400,null);
  String[] types={"double","float","int","long"};
  for (int i=0; i < types.length; i++) {
    if (i > 1) {
      expected.put(200,2.0);
      expected.put(300,3.0);
    }
    pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:"+ types[i]+ ");");
    pigServer.registerQuery("C = group A by id;");
    pigServer.registerQuery("D = foreach C generate group, AVG(A.v);");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      Double v=expected.get((Integer)t.get(0));
      if (v != null) {
        assertEquals(v.doubleValue(),((Number)t.get(1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithRegexp() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "(((chararray)org.apache.pig.test.utils.AccumulatorBagCount(A)) matches '1*' ?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithDistinct() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, f);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B { D = distinct A;" + "generate group, org.apache.pig.test.utils.AccumulatorBagCount(D)+1;};");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,2);
  expected.put(300,3);
  expected.put(400,2);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  int count=0;
  while (iter.hasNext()) {
    count++;
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  assertEquals(4,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinCondCheck() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("data1"));
  w.println("1\t11");
  w.println("2\t15");
  w.close();
  Util.copyFromLocalToCluster(cluster,"data1","data1");
  w=new PrintWriter(new FileWriter("data2"));
  w.println("1\t10");
  w.println("4\t11");
  w.println("5\t10");
  w.close();
  Util.copyFromLocalToCluster(cluster,"data2","data2");
  pigServer.registerQuery("A = load 'data1' as (x:int, y:int);");
  pigServer.registerQuery("B = load 'data2' as (x:int, z:int);");
  pigServer.registerQuery("C = cogroup A by x, B by x;");
  pigServer.registerQuery("D = foreach C generate group," + "SUM((IsEmpty(A.y) ? {(0)} : A.y)) + SUM((IsEmpty(B.z) ? {(0)} : B.z));");
  HashMap<Integer,Long> expected=new HashMap<Integer,Long>();
  expected.put(1,21l);
  expected.put(2,15l);
  expected.put(4,11l);
  expected.put(5,10l);
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Long)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithAnd() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>1 and " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<3)?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,1);
  expected.put(300,1);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMap() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE4 + "' as (id, url);");
  pigServer.registerQuery("B = group A by (id, url);");
  pigServer.registerQuery("C = foreach B generate COUNT(A)," + "org.apache.pig.test.utils.URLPARSE(group.url)#'url';");
  HashMap<Integer,String> expected=new HashMap<Integer,String>();
  expected.put(2,"http://ibm.com");
  expected.put(1,"http://yahoo.com");
  expected.put(1,"http://sun.com");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Long)t.get(0)),(String)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumBasic() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,1);
  expected.put(300,3);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.BagCount(A);");
  try {
    iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
    fail("accumulator should not be called.");
  }
 catch (  IOException e) {
  }
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("C = cogroup A by id, B by id;");
  pigServer.registerQuery("D = foreach C generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.AccumulatorBagCount(B);");
  HashMap<Integer,String> expected2=new HashMap<Integer,String>();
  expected2.put(100,"2,2");
  expected2.put(200,"1,1");
  expected2.put(300,"3,3");
  expected2.put(400,"1,1");
  iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected2.get((Integer)t.get(0)),t.get(1).toString() + "," + t.get(2).toString());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithSort() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, f);");
  pigServer.registerQuery("B = foreach A generate id, f, id as t;");
  pigServer.registerQuery("C = group B by id;");
  pigServer.registerQuery("D = foreach C { E = order B by f; F = E.f;" + "generate group, org.apache.pig.test.utils.AccumulativeSumBag(F);};");
  HashMap<Integer,String> expected=new HashMap<Integer,String>();
  expected.put(100,"(apple)(apple)");
  expected.put(200,"(orange)");
  expected.put(300,"(pear)(pear)(strawberry)");
  expected.put(400,"(apple)");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  int count=0;
  while (iter.hasNext()) {
    count++;
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(String)t.get(1));
  }
  assertEquals(4,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithNegative() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  -org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,-2);
  expected.put(200,-1);
  expected.put(300,-3);
  expected.put(400,-1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithIsNull() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "((chararray)org.apache.pig.test.utils.AccumulativeSumBag(A) is null?0:1);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,0);
  expected.put(200,0);
  expected.put(300,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithMinus() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group, " + " org.apache.pig.test.utils.AccumulatorBagCount(A)*3.0-org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,4.0);
  expected.put(200,2.0);
  expected.put(300,6.0);
  expected.put(400,2.0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Double)t.get(1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAccumWithDivide() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A)/2;");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,1);
  expected.put(200,0);
  expected.put(300,1);
  expected.put(400,0);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEval </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.out.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          nonNullCnt--;
          ps.println(j % 10 + ":");
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate group, COUNT($1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(1));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupReorderCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1), group ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleCount() throws Exception {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testSimpleCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid =  foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1);";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAlgebraicEvalLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupReorderCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1), group ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupUniqueColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0)         groupsize++;
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          groupsize--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupUniqueColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCountWithMultipleFields() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int k=0; k < nullFlags.length; k++) {
    System.err.println("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k]);
    int groupKeyWithNulls=0;
    if (nullFlags[k] == false) {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      for (int i=0; i < LOOP_COUNT; i++) {
        for (int j=0; j < LOOP_COUNT; j++) {
          ps.println(i + "\t" + i+ "\t"+ j % 2);
        }
      }
      ps.close();
    }
 else {
      PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
      Random r=new Random();
      for (int i=0; i < LOOP_COUNT; i++) {
        int rand=r.nextInt(LOOP_COUNT);
        if (rand <= (0.2 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + i + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.2 * LOOP_COUNT) && rand <= (0.4 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + "\t"+ j % 2);
          }
        }
 else         if (rand > (0.4 * LOOP_COUNT) && rand <= (0.6 * LOOP_COUNT)) {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println("\t" + "\t" + j % 2);
          }
          groupKeyWithNulls++;
        }
 else {
          for (int j=0; j < LOOP_COUNT; j++) {
            ps.println(i + "\t" + i+ "\t"+ j % 2);
          }
        }
      }
      ps.close();
    }
    pig.registerQuery(" a = group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') by ($0,$1);");
    pig.registerQuery("b = foreach a generate flatten(group), SUM($1.$2);");
    Iterator<Tuple> it=pig.openIterator("b");
    int count=0;
    System.err.println("XX Starting");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println("XX " + t);
      int sum=((Double)t.get(2)).intValue();
      if (t.get(0) == null && t.get(1) == null)       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],(LOOP_COUNT / 2) * groupKeyWithNulls,sum);
 else       assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT / 2,sum);
      count++;
    }
    System.err.println("XX done");
    if (groupKeyWithNulls == 0)     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT,count);
 else     assertEquals("Running testGroupCountWithMultipleFields with nullFlags set to " + nullFlags[k],LOOP_COUNT - groupKeyWithNulls + 1,count);
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleCount() throws Exception {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testSimpleCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid =  foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate COUNT($1);";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(0));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing testGroupCount with null flag:" + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') all) generate group, COUNT($1) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    Tuple t=it.next();
    Long count=DataType.toLong(t.get(1));
    assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],count.longValue(),LOOP_COUNT);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupDuplicateColumnCount() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    long groupsize=0;
    long nonNullCnt=0;
    if (nullFlags[i] == false) {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        ps.println(j % 10 + ":" + j);
      }
    }
 else {
      for (int j=0; j < LOOP_COUNT; j++) {
        if (j % 10 == 0) {
          groupsize++;
          nonNullCnt++;
        }
        if (j % 20 == 0) {
          ps.println(j % 10 + ":");
          nonNullCnt--;
        }
 else {
          ps.println(j % 10 + ":" + j);
        }
      }
    }
    ps.close();
    String query="myid = foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':')) by $0) generate group, COUNT($1.$1), COUNT($1.$0) ;";
    System.out.println(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("myid");
    tmpFile.delete();
    System.err.println("Output from testGroupDuplicateColumnCount");
    while (it.hasNext()) {
      Tuple t=it.next();
      System.err.println(t);
      String a=t.get(0).toString();
      Double group=Double.valueOf(a.toString());
      if (group == 0.0) {
        Long count=DataType.toLong(t.get(2));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],groupsize,count.longValue());
        count=DataType.toLong(t.get(1));
        assertEquals(this.getClass().getName() + "with nullFlags set to: " + nullFlags[i],nonNullCnt,count.longValue());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBZip </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the end-to-end writing and reading of a BZip file using absolute path with a trailing /.
 */
@Test public void testBzipInPig2() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  File in=folder.newFile("junit-in.bz2");
  File out=folder.newFile("junit-out.bz2");
  out.delete();
  String clusterOutput=Util.removeColon(out.getAbsolutePath());
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
  for (int i=1; i < 100; i++) {
    StringBuffer sb=new StringBuffer();
    sb.append(i).append("\n").append(-i).append("\n");
    byte bytes[]=sb.toString().getBytes();
    cos.write(bytes);
  }
  cos.close();
  pig.registerQuery("AA = load '" + Util.generateURI(in.getAbsolutePath(),pig.getPigContext()) + "';");
  pig.registerQuery("A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);");
  pig.registerQuery("store A into '" + Util.encodeEscape(clusterOutput) + "/';");
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pig.getPigContext().getProperties()));
  FileStatus[] outputFiles=fs.listStatus(new Path(clusterOutput),Util.getSuccessMarkerPathFilter());
  FSDataInputStream is=fs.open(outputFiles[0].getPath());
  CBZip2InputStream cis=new CBZip2InputStream(is,-1,out.length());
  assertEquals(100,cis.read(new byte[100]));
  cis.close();
  pig.registerQuery("B = load '" + Util.encodeEscape(clusterOutput) + "';");
  Iterator<Tuple> i=pig.openIterator("B");
  HashMap<Integer,Integer> map=new HashMap<Integer,Integer>();
  while (i.hasNext()) {
    Integer val=DataType.toInteger(i.next().get(0));
    map.put(val,val);
  }
  assertEquals(new Integer(99),new Integer(map.keySet().size()));
  for (int j=1; j < 100; j++) {
    assertEquals(new Integer(j),map.get(j));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the end-to-end writing and reading of a BZip file.
 */
@Test public void testBzipInPig() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  File in=folder.newFile("junit-in.bz2");
  File out=folder.newFile("junit-out.bz2");
  out.delete();
  String clusterOutput=Util.removeColon(out.getAbsolutePath());
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
  for (int i=1; i < 100; i++) {
    StringBuffer sb=new StringBuffer();
    sb.append(i).append("\n").append(-i).append("\n");
    byte bytes[]=sb.toString().getBytes();
    cos.write(bytes);
  }
  cos.close();
  pig.registerQuery("AA = load '" + Util.generateURI(in.getAbsolutePath(),pig.getPigContext()) + "';");
  pig.registerQuery("A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);");
  pig.registerQuery("store A into '" + Util.encodeEscape(clusterOutput) + "';");
  FileSystem fs=FileSystem.get(ConfigurationUtil.toConfiguration(pig.getPigContext().getProperties()));
  FileStatus[] outputFiles=fs.listStatus(new Path(clusterOutput),Util.getSuccessMarkerPathFilter());
  FSDataInputStream is=fs.open(outputFiles[0].getPath());
  CBZip2InputStream cis=new CBZip2InputStream(is,-1,out.length());
  assertEquals(100,cis.read(new byte[100]));
  cis.close();
  pig.registerQuery("B = load '" + Util.encodeEscape(clusterOutput) + "';");
  Iterator<Tuple> i=pig.openIterator("B");
  HashMap<Integer,Integer> map=new HashMap<Integer,Integer>();
  while (i.hasNext()) {
    Integer val=DataType.toInteger(i.next().get(0));
    map.put(val,val);
  }
  assertEquals(new Integer(99),new Integer(map.keySet().size()));
  for (int j=1; j < 100; j++) {
    assertEquals(new Integer(j),map.get(j));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that Pig's Bzip2TextInputFormat throws an IOException when the input files to be loaded are actually
 * a result of concatenating 2 or more bz2 files. It should not silently ignore part
 * of the input data.  When, hadoop's TextInpuFormat is used(PIG-3251), it should
 * successfully read this concatenated bzip file to the end.
 */
@Test public void testBZ2Concatenation() throws Exception {
  String[] inputData1=new String[]{"1\ta","2\taa"};
  String[] inputData2=new String[]{"1\tb","2\tbb"};
  String[] inputDataMerged=new String[]{"1\ta","2\taa","1\tb","2\tbb"};
  File in1=folder.newFile("junit-in1.bz2");
  String compressedInputFileName1=in1.getAbsolutePath();
  File in2=folder.newFile("junit-in2.bz2");
  String compressedInputFileName2=in2.getAbsolutePath();
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputDataMerged);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in1));
    for (int i=0; i < inputData1.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData1[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    CBZip2OutputStream cos2=new CBZip2OutputStream(new FileOutputStream(in2));
    for (int i=0; i < inputData2.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData2[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos2.write(bytes);
    }
    cos2.close();
    catInto(compressedInputFileName2,compressedInputFileName1);
    Util.copyFromLocalToCluster(cluster,compressedInputFileName1,compressedInputFileName1);
    String script="a = load '" + Util.encodeEscape(unCompressedInputFileName) + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(compressedInputFileName1) + "';";
    pig.registerQuery(script);
    try {
      Iterator<Tuple> it2=pig.openIterator("a");
      while (it1.hasNext()) {
        Tuple t1=it1.next();
        Tuple t2=it2.next();
        assertEquals(t1,t2);
      }
      assertFalse(it2.hasNext());
      assertEquals("IOException should be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"true");
    }
 catch (    IOException e) {
      assertEquals("IOException should only be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"false");
    }
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that '\n', '\r' and '\r\n' are treated as record delims when using
 * bzip just like they are when using uncompressed text
 */
@Test public void testRecordDelims() throws Exception {
  String[] inputData=new String[]{"1\t2\r3\t4","5\t6\r","7\t8","9\t10\r"};
  File in=folder.newFile("junit-in.bz2");
  String compressedInputFileName=in.getAbsolutePath();
  String clusterCompressedFilePath=Util.removeColon(compressedInputFileName);
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputData);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
    for (int i=0; i < inputData.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    Util.copyFromLocalToCluster(cluster,compressedInputFileName,clusterCompressedFilePath);
    String script="a = load '" + unCompressedInputFileName + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(clusterCompressedFilePath) + "';";
    pig.registerQuery(script);
    Iterator<Tuple> it2=pig.openIterator("a");
    while (it1.hasNext()) {
      Tuple t1=it1.next();
      Tuple t2=it2.next();
      assertEquals(t1,t2);
    }
    assertFalse(it2.hasNext());
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
    Util.deleteFile(cluster,clusterCompressedFilePath);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBestFitCast </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast10() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y:long, z);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast8() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast13() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast11() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "((float)y,(float)y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast15() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof DataByteArray);
    byte[] expected=Integer.toString(cnt + 1).getBytes();
    byte[] actual=((DataByteArray)((Tuple)t.get(0)).get(0)).get();
    assertEquals(expected.length,actual.length);
    for (int i=0; i < expected.length; i++) {
      assertEquals(expected[i],actual[i]);
    }
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast3() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x, y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast4() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Long);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Double);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast9() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:double, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast2() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test4() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast16() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof Integer);
    assertEquals(new Integer(cnt + 1),(Integer)((Tuple)t.get(0)).get(0));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBloom </h4><pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMap() throws Exception {
  String size="100";
  String numHash="3";
  String hashFunc="JENKINS";
  TupleFactory tf=TupleFactory.getInstance();
  BagFactory bf=BagFactory.getInstance();
  Tuple t=tf.newTuple(1);
  t.set(0,1);
  DataBag b=bf.newDefaultBag();
  b.add(t);
  Tuple input=tf.newTuple(b);
  BuildBloom.Initial map=new BuildBloom.Initial(hashFunc,"fixed",size,numHash);
  t=map.exec(input);
  Bloom bloom=new Bloom("bla");
  bloom.setFilter((DataByteArray)t.get(0));
  Tuple t1=tf.newTuple(1);
  t1.set(0,1);
  assertTrue(bloom.exec(t1));
  for (int i=100; i < 10; i++) {
    Tuple t2=tf.newTuple(1);
    t2.set(0,i);
    assertFalse(bloom.exec(t2));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSingleKey() throws Exception {
  String size="100";
  String numHash="3";
  String hashFunc="MURMUR";
  TupleFactory tf=TupleFactory.getInstance();
  BagFactory bf=BagFactory.getInstance();
  DataBag reducerBag=bf.newDefaultBag();
  for (int i=0; i < 3; i++) {
    DataBag combinerBag=bf.newDefaultBag();
    for (int j=0; j < 3; j++) {
      Tuple t=tf.newTuple(1);
      t.set(0,i * 10 + j);
      DataBag mapBag=bf.newDefaultBag();
      mapBag.add(t);
      Tuple input=tf.newTuple(mapBag);
      BuildBloom.Initial map=new BuildBloom.Initial(hashFunc,"fixed",size,numHash);
      combinerBag.add(map.exec(input));
    }
    Tuple t=tf.newTuple(1);
    t.set(0,combinerBag);
    BuildBloom.Intermediate combiner=new BuildBloom.Intermediate(hashFunc,"fixed",size,numHash);
    reducerBag.add(combiner.exec(t));
  }
  Tuple t=tf.newTuple(1);
  t.set(0,reducerBag);
  BuildBloom.Final reducer=new BuildBloom.Final(hashFunc,"fixed",size,numHash);
  DataByteArray dba=reducer.exec(t);
  Bloom bloom=new Bloom("bla");
  bloom.setFilter(dba);
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      Tuple t1=tf.newTuple(1);
      t1.set(0,i * 10 + j);
      assertTrue(bloom.exec(t1));
    }
  }
  for (int i=100; i < 10; i++) {
    Tuple t1=tf.newTuple(1);
    t1.set(0,i);
    assertFalse(bloom.exec(t1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultiKey() throws Exception {
  String numElements="10";
  String falsePositive="0.001";
  String hashFunc="murmur";
  TupleFactory tf=TupleFactory.getInstance();
  BagFactory bf=BagFactory.getInstance();
  String[][] strs={{"fred","joe","bob"},{"mary","sally","jane"},{"fido","spot","fluffly"}};
  DataBag reducerBag=bf.newDefaultBag();
  for (int i=0; i < 3; i++) {
    DataBag combinerBag=bf.newDefaultBag();
    for (int j=0; j < 3; j++) {
      Tuple t=tf.newTuple(2);
      t.set(0,i * 10 + j);
      t.set(1,strs[i][j]);
      DataBag mapBag=bf.newDefaultBag();
      mapBag.add(t);
      Tuple input=tf.newTuple(mapBag);
      BuildBloom.Initial map=new BuildBloom.Initial(hashFunc,numElements,falsePositive);
      combinerBag.add(map.exec(input));
    }
    Tuple t=tf.newTuple(1);
    t.set(0,combinerBag);
    BuildBloom.Intermediate combiner=new BuildBloom.Intermediate(hashFunc,numElements,falsePositive);
    reducerBag.add(combiner.exec(t));
  }
  Tuple t=tf.newTuple(1);
  t.set(0,reducerBag);
  BuildBloom.Final reducer=new BuildBloom.Final(hashFunc,numElements,falsePositive);
  DataByteArray dba=reducer.exec(t);
  Bloom bloom=new Bloom("bla");
  bloom.setFilter(dba);
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      Tuple t1=tf.newTuple(2);
      t1.set(0,i * 10 + j);
      t1.set(1,strs[i][j]);
      assertTrue(bloom.exec(t1));
    }
  }
  for (int i=100; i < 10; i++) {
    Tuple t1=tf.newTuple(2);
    t1.set(0,i);
    t1.set(1,"ichabod");
    assertFalse(bloom.exec(t1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCombiner() throws Exception {
  String size="100";
  String numHash="3";
  String hashFunc="jenkins";
  TupleFactory tf=TupleFactory.getInstance();
  BagFactory bf=BagFactory.getInstance();
  DataBag combinerBag=bf.newDefaultBag();
  for (int j=0; j < 3; j++) {
    Tuple t=tf.newTuple(1);
    t.set(0,10 + j);
    DataBag mapBag=bf.newDefaultBag();
    mapBag.add(t);
    Tuple input=tf.newTuple(mapBag);
    BuildBloom.Initial map=new BuildBloom.Initial(hashFunc,"fixed",size,numHash);
    combinerBag.add(map.exec(input));
  }
  Tuple t=tf.newTuple(1);
  t.set(0,combinerBag);
  BuildBloom.Intermediate combiner=new BuildBloom.Intermediate(hashFunc,"fixed",size,numHash);
  t=combiner.exec(t);
  Bloom bloom=new Bloom("bla");
  bloom.setFilter((DataByteArray)t.get(0));
  for (int j=0; j < 3; j++) {
    Tuple t1=tf.newTuple(1);
    t1.set(0,10 + j);
    assertTrue(bloom.exec(t1));
  }
  for (int i=100; i < 10; i++) {
    Tuple t2=tf.newTuple(1);
    t2.set(0,i);
    assertFalse(bloom.exec(t2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBoolean </h4><pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndNull() throws ExecException {
  setupAnd();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrNull() throws ExecException {
  setupOr();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonuniformTuplesInBagForBagToTupleUDF() throws Exception {
  Tuple t1=tf.newTuple(2);
  t1.set(0,"a");
  t1.set(1,5);
  Tuple t2=tf.newTuple(3);
  t2.set(0,"b");
  t2.set(1,6);
  t2.set(2,7);
  Tuple t3=tf.newTuple(4);
  t3.set(0,"c");
  t3.set(1,8);
  t3.set(2,9.7);
  t3.set(3,10);
  DataBag bag=bf.newDefaultBag();
  bag.add(t1);
  bag.add(t2);
  bag.add(t3);
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,bag);
  BagToTuple udf=new BagToTuple();
  Tuple outputTuple=udf.exec(udfInput);
  int totalExpectedSize=t1.size() + t2.size() + t3.size();
  assertEquals(totalExpectedSize,outputTuple.size());
  for (int i=0; i < t1.size(); i++) {
    assertEquals(t1.get(i),outputTuple.get(i));
  }
  for (int i=0; i < t2.size(); i++) {
    assertEquals(t2.get(i),outputTuple.get(t1.size() + i));
  }
  int startIndex=t1.size() + t2.size();
  for (int i=0; i < t3.size(); i++) {
    assertEquals(t3.get(i),outputTuple.get(startIndex + i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedDataElementsForBagToTupleUDF() throws Exception {
  DataBag inputBag=buildBagWithNestedTupleAndBag();
  BagToTuple udf=new BagToTuple();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,inputBag);
  Tuple outputTuple=udf.exec(udfInput);
  Iterator<Tuple> inputBagIterator=inputBag.iterator();
  Tuple firstTuple=inputBagIterator.next();
  for (int i=0; i < firstTuple.size(); i++) {
    assertEquals(firstTuple.get(i),outputTuple.get(i));
  }
  Tuple secondTuple=inputBagIterator.next();
  for (int i=0; i < secondTuple.size(); i++) {
    assertEquals(secondTuple.get(i),outputTuple.get(firstTuple.size() + i));
  }
  int startIndex=firstTuple.size() + secondTuple.size();
  Tuple thirdTuple=inputBagIterator.next();
  for (int i=0; i < thirdTuple.size(); i++) {
    assertEquals(thirdTuple.get(i),outputTuple.get(startIndex + i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicBagToTupleUDF() throws Exception {
  Tuple t1=tf.newTuple(2);
  t1.set(0,"a");
  t1.set(1,5);
  Tuple t2=tf.newTuple(2);
  t2.set(0,"c");
  t2.set(1,6);
  DataBag bag=bf.newDefaultBag();
  bag.add(t1);
  bag.add(t2);
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,bag);
  BagToTuple udf=new BagToTuple();
  Tuple result=udf.exec(udfInput);
  int totalExpectedSize=t1.size() + t2.size();
  assertEquals(totalExpectedSize,result.size());
  for (int i=0; i < t1.size(); i++) {
    assertEquals(t1.get(i),result.get(i));
  }
  for (int i=0; i < t2.size(); i++) {
    assertEquals(t2.get(i),result.get(t1.size() + i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMAX() throws Exception {
  String[] maxTypes={"MAX","LongMax","IntMax","FloatMax","BigDecimalMax","BigIntegerMax","StringMax","DateTimeMax"};
  for (int k=0; k < maxTypes.length; k++) {
    EvalFunc<?> max=evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=max.exec(tup);
    String msg="[Testing " + maxTypes[k] + " on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),output);
    assertNull(max.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDIFF() throws Exception {
  BagFactory bf=BagFactory.getInstance();
  TupleFactory tf=TupleFactory.getInstance();
  DataBag b1=bf.newDefaultBag();
  DataBag b2=bf.newDefaultBag();
  for (int i=0; i < 10; i++)   b1.add(tf.newTuple(new Integer(i)));
  for (int i=0; i < 10; i+=2)   b2.add(tf.newTuple(new Integer(i)));
  Tuple t=tf.newTuple(2);
  t.set(0,b1);
  t.set(1,b2);
  DIFF d=new DIFF();
  DataBag result=d.exec(t);
  assertEquals(5,result.size());
  Iterator<Tuple> i=result.iterator();
  int[] values=new int[5];
  for (int j=0; j < 5; j++)   values[j]=(Integer)i.next().get(0);
  Arrays.sort(values);
  for (int j=1; j < 10; j+=2)   assertEquals(j,values[j / 2]);
  t=tf.newTuple(2);
  t.set(0,new Integer(1));
  t.set(1,new Integer(1));
  result=d.exec(t);
  assertEquals(0,result.size());
  t=tf.newTuple(2);
  t.set(0,new Integer(1));
  t.set(1,new Integer(2));
  result=d.exec(t);
  assertEquals(2,result.size());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMFinal() throws Exception {
  String[] sumTypes={"SUMFinal","DoubleSumFinal","LongSumFinal","IntSumFinal","FloatSumFinal","BigDecimalSumFinal","BigIntegerSumFinal"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMIN() throws Exception {
  String[] minTypes={"MIN","LongMin","IntMin","FloatMin","BigDecimalMin","BigIntegerMin","StringMin","DateTimeMin"};
  for (int k=0; k < minTypes.length; k++) {
    EvalFunc<?> min=evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=min.exec(tup);
    String msg="[Testing " + minTypes[k] + " on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),output);
    assertNull(min.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called once - so initial is called
 * and then Intermediate and then final is called
 * @throws Exception
 */
@Test public void testAggSingleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag intermediateInputBg1=bagFactory.newDefaultBag();
      DataBag intermediateInputBg2=bagFactory.newDefaultBag();
      int i=0;
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        if (i < bg.size() / 2) {
          intermediateInputBg1.add((Tuple)aggInitial.exec(initialInputTuple));
        }
 else {
          intermediateInputBg2.add((Tuple)aggInitial.exec(initialInputTuple));
        }
        i++;
      }
      EvalFunc<?> avgIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      Tuple intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg1);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg2);
      finalInputBg.add((Tuple)avgIntermediate.exec(intermediateInputTuple));
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for single combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToBag() throws Exception {
  TOBAG tb=new TOBAG();
  Schema expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.INTEGER);
  Schema inputSch=new Schema();
  inputSch.add(new FieldSchema(null,DataType.INTEGER));
  assertEquals("schema of tobag when input has only ints",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema(null,DataType.INTEGER));
  assertEquals("schema of tobag when input has only ints",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema(null,DataType.LONG));
  expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.NULL);
  assertEquals("schema of tobag when input has ints and long",expectedSch,tb.outputSchema(inputSch));
  Schema tupInSchema=new Schema(new FieldSchema("x",DataType.CHARARRAY));
  inputSch=new Schema();
  inputSch.add(new FieldSchema("a",tupInSchema,DataType.TUPLE));
  Schema inputSchCp=new Schema(inputSch);
  inputSchCp.getField(0).alias=null;
  expectedSch=new Schema(new FieldSchema(null,inputSchCp,DataType.BAG));
  assertEquals("schema of tobag when input has cols of type tuple ",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema("b",tupInSchema,DataType.TUPLE));
  assertEquals("schema of tobag when input has cols of type tuple ",expectedSch,tb.outputSchema(inputSch));
  tupInSchema=new Schema(new FieldSchema("x",DataType.BYTEARRAY));
  inputSch.add(new FieldSchema("c",tupInSchema,DataType.TUPLE));
  expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.NULL);
  assertEquals("schema of tobag when input has cols of type tuple with diff inner schema",expectedSch,tb.outputSchema(inputSch));
  Tuple input=TupleFactory.getInstance().newTuple();
  for (int i=0; i < 100; ++i) {
    input.append(i);
  }
  input.append(null);
  Set<Integer> s=new HashSet<Integer>();
  DataBag db=tb.exec(input);
  for (  Tuple t : db) {
    s.add((Integer)t.get(0));
  }
  assertEquals(101,s.size());
  for (int i=0; i < 100; ++i) {
    assertTrue(s.contains(i));
  }
  assertTrue("null in tobag result",s.contains(null));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSUM() throws Exception {
  String[] sumTypes={"SUM","DoubleSum","LongSum","IntSum","FloatSum","BigDecimalSum","BigIntegerSum"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType == "Integer" || inputType == "Long") {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
    assertNull(sum.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLFPig() throws Exception {
  Util.createInputFile(cluster,"input.txt",new String[]{"this:is:delimited:by:a:colon\n"});
  int arity1=6;
  LoadFunc lf=new PigStorage(":");
  LoadFunc p1=new ReadToEndLoader(lf,ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f1=p1.getNext();
  assertTrue(f1.size() == arity1);
  Util.deleteFile(cluster,"input.txt");
  int LOOP_COUNT=100;
  String[] input=new String[LOOP_COUNT * LOOP_COUNT];
  int n=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j++) {
      input[n++]=(i + "\t" + i+ "\t"+ j % 2);
    }
  }
  Util.createInputFile(cluster,"input.txt",input);
  LoadFunc p15=new ReadToEndLoader(new PigStorage(),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  int count=0;
  while (true) {
    Tuple f15=p15.getNext();
    if (f15 == null)     break;
    count++;
    assertEquals(3,f15.size());
  }
  assertEquals(LOOP_COUNT * LOOP_COUNT,count);
  Util.deleteFile(cluster,"input.txt");
  String input2=":this:has:a:leading:colon\n";
  int arity2=6;
  Util.createInputFile(cluster,"input.txt",new String[]{input2});
  LoadFunc p2=new ReadToEndLoader(new PigStorage(":"),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f2=p2.getNext();
  assertTrue(f2.size() == arity2);
  Util.deleteFile(cluster,"input.txt");
  String input3="this:has:a:trailing:colon:\n";
  int arity3=6;
  Util.createInputFile(cluster,"input.txt",new String[]{input3});
  LoadFunc p3=new ReadToEndLoader(new PigStorage(":"),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f3=p3.getNext();
  assertTrue(f3.size() == arity3);
  Util.deleteFile(cluster,"input.txt");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGIntermediate() throws Exception {
  String[] avgTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    String inputType=getInputType(avgTypes[k]);
    Tuple tup=inputMap.get(inputType);
    DataBag bag=(DataBag)tup.get(0);
    DataBag bg=bagFactory.newDefaultBag();
    for (    Tuple t : bag) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (inputType == "BigDecimal") {
        newTuple.set(1,BigDecimal.ONE);
      }
 else       if (inputType == "BigInteger") {
        newTuple.set(1,BigInteger.ONE);
      }
 else {
        newTuple.set(1,new Long(1));
      }
      bg.add(newTuple);
    }
    Tuple intermediateInput=tupleFactory.newTuple();
    intermediateInput.append(bg);
    Object output=avg.exec(intermediateInput);
    if (inputType == "Long" || inputType == "Integer" || inputType == "IntegerAsLong") {
      Long l=(Long)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ l+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,getExpected(avgTypes[k]),l);
    }
 else     if (inputType == "BigDecimal") {
      BigDecimal f1=(BigDecimal)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),f1.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f1=(BigInteger)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,((BigInteger)getExpected(avgTypes[k])).toString(),f1.toString());
    }
 else {
      Double f1=(Double)((Tuple)output).get(0);
      String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ f1+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
      assertEquals(msg,(Double)getExpected(avgTypes[k]),f1,0.00001);
    }
    if (inputType == "BigDecimal") {
      BigDecimal f2=(BigDecimal)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toPlainString());
    }
 else     if (inputType == "BigInteger") {
      BigInteger f2=(BigInteger)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 4","4",f2.toString());
    }
 else {
      Long f2=(Long)((Tuple)output).get(1);
      assertEquals("[Testing " + avgTypes[k] + " on input type: "+ inputType+ "]Expected count to be 11",11,f2.longValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testURIwithCurlyBrace() throws Exception {
  String inputFileName="input.txt";
  String inputFileName1="part-1";
  Util.deleteFile(pigServer.getPigContext(),inputFileName);
  Util.deleteFile(pigServer.getPigContext(),inputFileName1);
  String[] inputData=new String[]{"1","a","r"};
  Util.createLocalInputFile(inputFileName,inputData);
  pigServer.registerQuery("a = load '" + inputFileName + "'AS (s:chararray);");
  pigServer.store("a",inputFileName1,"BinStorage");
  pigServer.registerQuery("b = load 'part-{1,2}' using BinStorage() AS (s:chararray);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  int i=0;
  while (it.hasNext()) {
    assertTrue(it.next().get(0).equals(inputData[i]));
    i++;
  }
  assertTrue(i == 3);
  Util.deleteFile(pigServer.getPigContext(),inputFileName);
  Util.deleteFile(pigServer.getPigContext(),inputFileName1);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeySet() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","code");
  Tuple input=TupleFactory.getInstance().newTuple(m);
  KEYSET keySet=new KEYSET();
  DataBag result=keySet.exec(input);
  Iterator<Tuple> i=result.iterator();
  assertEquals(result.size(),m.size());
  while (i.hasNext()) {
    Tuple t=i.next();
    assertTrue(m.containsKey((String)t.get(0)));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSUMIntermed() throws Exception {
  String[] sumTypes={"SUMIntermediate","DoubleSumIntermediate","LongSumIntermediate","IntSumIntermediate","FloatSumIntermediate","BigDecimalSumIntermediate","BigIntegerSumIntermediate"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ ((Tuple)output).get(0)+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType.equals("Integer") || inputType.equals("Long") || inputType.equals("IntegerAsLong")) {
      assertEquals(msg,(Long)((Tuple)output).get(0),(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal") {
      assertEquals(msg,((BigDecimal)((Tuple)output).get(0)).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
    }
 else     if (inputType == "BigInteger") {
      assertEquals(msg,((BigInteger)((Tuple)output).get(0)).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
    }
 else {
      assertEquals(msg,(Double)((Tuple)output).get(0),(Double)getExpected(sumTypes[k]),0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAVGFinal() throws Exception {
  String[] avgTypes={"AVGFinal","DoubleAvgFinal","LongAvgFinal","IntAvgFinal","FloatAvgFinal","BigDecimalAvgFinal","BigIntegerAvgFinal"};
  String[] avgIntermediateTypes={"AVGIntermediate","DoubleAvgIntermediate","LongAvgIntermediate","IntAvgIntermediate","FloatAvgIntermediate","BigDecimalAvgIntermediate","BigIntegerAvgIntermediate"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    EvalFunc<?> avgIntermediate=evalFuncMap.get(avgIntermediateTypes[k]);
    DataBag bg=(DataBag)tup.get(0);
    DataBag bg1=bagFactory.newDefaultBag();
    DataBag bg2=bagFactory.newDefaultBag();
    int i=0;
    for (    Tuple t : bg) {
      Tuple newTuple=tupleFactory.newTuple(2);
      newTuple.set(0,t.get(0));
      if (t.get(0) == null) {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ZERO);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ZERO);
        }
 else {
          newTuple.set(1,new Long(0));
        }
      }
 else {
        if (getInputType(avgTypes[k]) == "BigDecimal") {
          newTuple.set(1,BigDecimal.ONE);
        }
 else         if (getInputType(avgTypes[k]) == "BigInteger") {
          newTuple.set(1,BigInteger.ONE);
        }
 else {
          newTuple.set(1,new Long(1));
        }
      }
      if (i < 5) {
        bg1.add(newTuple);
      }
 else {
        bg2.add(newTuple);
      }
      i++;
    }
    Tuple intermediateInput1=tupleFactory.newTuple();
    intermediateInput1.append(bg1);
    Object output1=avgIntermediate.exec(intermediateInput1);
    Tuple intermediateInput2=tupleFactory.newTuple();
    intermediateInput2.append(bg2);
    Object output2=avgIntermediate.exec(intermediateInput2);
    DataBag bag=Util.createBag(new Tuple[]{(Tuple)output1,(Tuple)output2});
    Tuple finalTuple=TupleFactory.getInstance().newTuple(1);
    finalTuple.set(0,bag);
    Object output=avg.exec(finalTuple);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)getExpected(avgTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
    }
 else {
      assertEquals(msg,(Double)getExpected(avgTypes[k]),(Double)output,0.00001);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is not called - so initial is called
 * and then final is called
 * @throws Exception
 */
@Test public void testAggNoCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Final")) {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
 else {
        continue;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> avgInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      for (      Tuple tuple : bg) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        initialInputBg.add(tuple);
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        finalInputBg.add((Tuple)avgInitial.exec(initialInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for no combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test the case where the combiner is called more than once - so initial is called
 * and then Intermediate called couple of times and then final is called
 * @throws Exception
 */
@Test public void testAggMultipleCombine() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      Tuple tup=inputMap.get(getInputType(aggInitialTypes[k]));
      DataBag bg=(DataBag)tup.get(0);
      DataBag[] mapIntermediateInputBgs=new DataBag[4];
      for (int i=0; i < mapIntermediateInputBgs.length; i++) {
        mapIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      Iterator<Tuple> it=bg.iterator();
      for (int i=0; i < 4; i++) {
        for (int j=0; j < bg.size() / 4; j++) {
          DataBag initialInputBg=bagFactory.newDefaultBag();
          initialInputBg.add(it.next());
          Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
          mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
        }
        if (i == 3) {
          while (it.hasNext()) {
            DataBag initialInputBg=bagFactory.newDefaultBag();
            initialInputBg.add(it.next());
            Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
            mapIntermediateInputBgs[i].add((Tuple)aggInitial.exec(initialInputTuple));
          }
        }
      }
      EvalFunc<?> aggIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag[] reduceIntermediateInputBgs=new DataBag[2];
      for (int i=0; i < reduceIntermediateInputBgs.length; i++) {
        reduceIntermediateInputBgs[i]=bagFactory.newDefaultBag();
      }
      for (int i=0; i < 4; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(mapIntermediateInputBgs[i]);
        if (i < 2) {
          reduceIntermediateInputBgs[0].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
 else {
          reduceIntermediateInputBgs[1].add((Tuple)aggIntermediate.exec(intermediateInputTuple));
        }
      }
      DataBag finalInputBag=bagFactory.newDefaultBag();
      for (int i=0; i < 2; i++) {
        Tuple intermediateInputTuple=tupleFactory.newTuple(reduceIntermediateInputBgs[i]);
        finalInputBag.add((Tuple)aggIntermediate.exec(intermediateInputTuple));
      }
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBag);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      String msg="[Testing " + aggGroup[k] + " on input type: "+ getInputType(aggFinalTypes[k]);
      System.err.println(msg + " for multiple combiner case]");
      Object output=aggFinal.exec(finalInputTuple);
      msg+=" ( (output) " + output + " == "+ getExpected(aggFinalTypes[k])+ " (expected) )]";
      if (getExpected(aggFinalTypes[k]) instanceof Double) {
        assertEquals(msg,(Double)getExpected(aggFinalTypes[k]),(Double)output,0.00001);
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigDecimal) {
        assertEquals(msg,((BigDecimal)getExpected(aggFinalTypes[k])).toPlainString(),((BigDecimal)output).toPlainString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof BigInteger) {
        assertEquals(msg,((BigInteger)getExpected(aggFinalTypes[k])).toString(),((BigInteger)output).toString());
      }
 else       if (getExpected(aggFinalTypes[k]) instanceof DateTime) {
        assertEquals(msg,((DateTime)getExpected(aggFinalTypes[k])).getMillis(),((DateTime)output).getMillis());
      }
 else {
        assertEquals(msg,getExpected(aggFinalTypes[k]),output);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleSize() throws Exception {
  String inputFileName="TupleSizeIn.txt";
  String[] inputData=new String[]{"Don't call my name, don't call my name, Alejandro","I'm not your babe, I'm not your babe, Fernando","Don't wanna kiss, don't wanna touch","Just smoke my cigarette and hush","Don't call my name, don't call my name, Roberto"};
  File inputFile=Util.createInputFile("tmp",inputFileName,inputData);
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS value:chararray;");
  pigServer.registerQuery("=> foreach @ generate STRSPLIT(value, ' ') AS values;");
  pigServer.registerQuery("C = foreach @ generate values, SIZE(values) as cnt;");
  Iterator<Tuple> it=pigServer.openIterator("C");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals("Testing SIZE(<Tuple>): ",new Long(new StringTokenizer(inputData[i]).countTokens()),t.get(1));
    i++;
  }
  inputFile.delete();
  assertTrue(!it.hasNext());
  assertTrue(i == inputData.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAVG() throws Exception {
  String[] avgTypes={"AVG","DoubleAvg","LongAvg","IntAvg","FloatAvg","BigDecimalAvg","BigIntegerAvg"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    Object output=avg.exec(tup);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(avgTypes[k])).toPlainString());
    }
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(avgTypes[k]),0.00001);
    }
    assertNull(avg.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCharArrayToNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArrayToIntAndLongScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Long> map=new HashMap<Integer,Long>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      long value=rand.nextInt(100);
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input2.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.INTEGER,DataType.LONG};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input2.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.LONG) {
          Long expected=map.get(key);
          if (value != null) {
            Long actual=Long.parseLong(value);
            assertEquals(expected,actual);
          }
 else {
            assertEquals(expected,null);
          }
        }
        if (type == DataType.INTEGER) {
          Integer expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).intValue();
          }
          if (value != null) {
            Integer actual=Integer.parseInt(value);
            assertEquals(expected,actual);
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input2.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArray2FloatAndDoubleScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Double> map=new HashMap<Integer,Double>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      double value=rand.nextDouble() * 100;
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input1.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.DOUBLE,DataType.FLOAT};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input1.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.DOUBLE) {
          Double expected=map.get(key);
          if (value != null) {
            assertEquals(expected,(Double)Double.parseDouble(value));
          }
 else {
            assertNull(expected);
          }
        }
        if (type == DataType.FLOAT) {
          Float expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).floatValue();
          }
          if (value != null) {
            assertEquals(expected,(Float)Float.parseFloat(value));
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input1.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCast() throws ExecException {
  POCast cast=new POCast(newOperatorKey(),-1);
  POProject proj=new POProject(newOperatorKey(),-1,0);
  proj.setResultType(DataType.CHARARRAY);
  List<PhysicalOperator> inputs=new ArrayList<PhysicalOperator>();
  inputs.add(proj);
  cast.setInputs(inputs);
  String[] items={"12.0","-13.2","0.1f","1.3e2","zjf",MaxDouble.toString(),MinDouble.toString()};
  Double[] doubleExpected={12.0,-13.2,0.1,1.3e2,null,MaxDouble,MinDouble};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Double actual=(Double)cast.getNextDouble().result;
    if (doubleExpected[i] != null) {
      assertEquals(doubleExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"12.0","-13.2","0.1f","1.3e2",MaxFloat.toString(),MinFloat.toString(),"zjf"};
  Float[] floatExpected={12.0f,-13.2f,0.1f,1.3e2f,MaxFloat,MinFloat,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Float actual=(Float)cast.getNextFloat().result;
    if (floatExpected[i] != null) {
      assertEquals(floatExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxLong.toString(),MinLong.toString(),"df1.2"};
  Long[] longExpected={1L,-1L,12L,12L,MaxLong,MinLong,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Long actual=(Long)cast.getNextLong().result;
    if (longExpected[i] != null) {
      assertEquals(longExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxInteger.toString(),MinInteger.toString(),"ff4332"};
  Integer[] intExpected={1,-1,12,12,MaxInteger,MinInteger,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Integer actual=(Integer)cast.getNextInteger().result;
    if (intExpected[i] != null) {
      assertEquals(intExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCombiner </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctAggs1() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctAggs1Input.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctAggs1Input.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        x = distinct a.age;" + "        y = distinct a.gpa;"+ "        z = distinct a;"+ "        generate group, COUNT(x), SUM(x.age), SUM(y.gpa), SUM(a.age), "+ "                       SUM(a.gpa), COUNT(z.age), COUNT(z), SUM(z.age);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertTrue(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1",3L,57L,5.2,75L,9.4,3L,3L,57L});
  results.put("pig2",new Object[]{"pig2",1L,24L,7.8,48L,7.8,2L,2L,48L});
  results.put("pig5",new Object[]{"pig5",1L,45L,2.4,45L,2.4,1L,1L,45L});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctAggs1Input.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"forEachNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'forEachNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = a.age;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"forEachNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = distinct a;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCommit </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckin1() throws Exception {
  Tuple expected1=mTf.newTuple(2);
  Tuple expected2=mTf.newTuple(2);
  expected1.set(0,"independent");
  expected1.set(1,50.0);
  expected2.set(0,"democrat");
  expected2.set(1,125.5);
  File studentFile=Util.createInputFile("tmp","student",new String[]{"joe smith:18:3.5","amy brown:25:2.5","jim fox:20:4.0","leo fu:55:3.0"});
  File voterFile=Util.createInputFile("tmp","voter",new String[]{"amy brown,25,democrat,25.50","amy brown,25,democrat,100","jim fox,20,independent,50.0"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(studentFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(':') as (name, age, gpa);");
  pigServer.registerQuery("b = load '" + Util.encodeEscape(voterFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(',') as (name, age, registration, contributions);");
  pigServer.registerQuery("c = filter a by age < 50;");
  pigServer.registerQuery("d = filter b by age < 50;");
  pigServer.registerQuery("e = cogroup c by (name, age), d by (name, age);");
  pigServer.registerQuery("f = foreach @ generate flatten(c), flatten(d);");
  pigServer.registerQuery("g = group @ by registration;");
  pigServer.registerQuery("h = foreach @ generate (chararray)group, SUM(f.d::contributions);");
  pigServer.registerQuery("i = order @ by $1;");
  Iterator<Tuple> iter=pigServer.openIterator("i");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    count++;
    if (count == 1) {
      assertEquals(t.get(0),expected1.get(0));
      assertEquals(t.get(1),expected1.get(1));
    }
 else     if (count == 2) {
      assertEquals(t.get(0),expected2.get(0));
      assertEquals(t.get(1),expected2.get(1));
    }
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConversions </h4><pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBytesToMap() throws IOException {
  ResourceFieldSchema fs=GenRandomData.getRandMapFieldSchema();
  for (int i=0; i < MAX; i++) {
    Map<String,Object> m=GenRandomData.genRandMap(r,5);
    String expectedMapString=DataType.mapToString(m);
    Map<String,Object> convertedMap=ps.getLoadCaster().bytesToMap(expectedMapString.getBytes(),fs);
    assertTrue(TestHelper.mapEquals(m,convertedMap));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBoolean() throws IOException {
  String[] a={"true","True","TRUE","false","False","FALSE"};
  Boolean[] b={Boolean.TRUE,Boolean.TRUE,Boolean.TRUE,Boolean.FALSE,Boolean.FALSE,Boolean.FALSE};
  for (int i=0; i < b.length; ++i) {
    byte[] bytes=a[i].getBytes();
    assertEquals(b[i],ps.getLoadCaster().bytesToBoolean(bytes));
  }
  a=new String[]{"neither true nor false"};
  for (  String s : a) {
    byte[] bytes=s.getBytes();
    Boolean bool=ps.getLoadCaster().bytesToBoolean(bytes);
    assertNull(bool);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToTupleWithConversion() throws IOException {
  for (int i=0; i < 100; i++) {
    Tuple t=GenRandomData.genMixedTupleToConvert(r);
    ResourceFieldSchema fs=GenRandomData.getMixedTupleToConvertFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertTrue(convertedTuple.get(0) instanceof String);
    assertEquals(convertedTuple.get(0),((Integer)t.get(0)).toString());
    assertTrue(convertedTuple.get(1) instanceof Long);
    Integer origValue1=(Integer)t.get(1);
    assertEquals(convertedTuple.get(1),Long.valueOf(origValue1.longValue()));
    assertNull(convertedTuple.get(2));
    assertTrue(convertedTuple.get(3) instanceof Double);
    Float origValue3=(Float)t.get(3);
    assertEquals(((Double)convertedTuple.get(3)).doubleValue(),origValue3.doubleValue(),0.01);
    assertTrue(convertedTuple.get(4) instanceof Float);
    Double origValue4=(Double)t.get(4);
    assertEquals((Float)convertedTuple.get(4),origValue4.floatValue(),0.01);
    assertTrue(convertedTuple.get(5) instanceof String);
    assertEquals(convertedTuple.get(5),t.get(5));
    assertNull(convertedTuple.get(6));
    assertNull(convertedTuple.get(7));
    assertNull(convertedTuple.get(8));
    assertTrue(convertedTuple.get(9) instanceof Boolean);
    String origValue9=(String)t.get(9);
    assertEquals(Boolean.valueOf(origValue9),convertedTuple.get(9));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBytesToTuple() throws IOException {
  for (int i=0; i < MAX; i++) {
    Tuple t=GenRandomData.genRandSmallBagTextTuple(r,1,100);
    ResourceFieldSchema fs=GenRandomData.getSmallBagTextTupleFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertEquals(t,convertedTuple);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBytesToBag() throws IOException {
  ResourceFieldSchema fs=GenRandomData.getFullTupTextDataBagFieldSchema();
  for (int i=0; i < MAX; i++) {
    DataBag b=GenRandomData.genRandFullTupTextDataBag(r,5,100);
    DataBag convertedBag=ps.getLoadCaster().bytesToBag(b.toString().getBytes(),fs);
    assertTrue(b.equals(convertedBag));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToLong() throws IOException {
  String[] a={"1703598819951657279 "," 999888123L  "," 1234 "," 1234","1234 ","1","-2345","123456789012345678","1.1","-23.45","21345345","3422342",""};
  Long[] la={1703598819951657279L,999888123L,1234L,1234L,1234L,1L,-2345L,123456789012345678L,1L,-23L,21345345L,3422342L};
  for (int i=0; i < la.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(la[i],ps.getLoadCaster().bytesToLong(b));
  }
  a=new String[]{"This is a long","1.0e1000","","    "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Long l=ps.getLoadCaster().bytesToLong(b);
    assertNull(l);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToInteger() throws IOException {
  String[] a={"1234 "," 4321"," 12345 ","1","-2345","1234567","1.1","-23.45",""};
  Integer[] ia={1234,4321,12345,1,-2345,1234567,1,-23};
  for (int i=0; i < ia.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(ia[i],ps.getLoadCaster().bytesToInteger(b));
  }
  a=new String[]{"1234567890123456","This is an int","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Integer i=ps.getLoadCaster().bytesToInteger(b);
    assertNull(i);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBagWithConversion() throws IOException {
  DataBag b=GenRandomData.genFloatDataBag(r,5,100);
  ResourceFieldSchema fs=GenRandomData.getFloatDataBagFieldSchema(5);
  DataBag convertedBag=ps.getLoadCaster().bytesToBag(b.toString().getBytes(),fs);
  Iterator<Tuple> iter1=b.iterator();
  Iterator<Tuple> iter2=convertedBag.iterator();
  for (int i=0; i < 100; i++) {
    Tuple t1=(Tuple)iter1.next();
    assertTrue(iter2.hasNext());
    Tuple t2=(Tuple)iter2.next();
    for (int j=0; j < 5; j++) {
      assertTrue(t2.get(j) instanceof Integer);
      Integer expectedValue=((Float)t1.get(j)).intValue();
      assertEquals(expectedValue,t2.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToFloat() throws IOException {
  String[] a={"1","-2.345","12.12334567","1.02e-2",".23344","23.1234567897","12312.33","002312.33","1.02e-2",""};
  Float[] f={1f,-2.345f,12.12334567f,1.02e-2f,.23344f,23.1234567f,12312.33f,2312.33f,1.02e-2f};
  for (int j=0; j < f.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(f[j],ps.getLoadCaster().bytesToFloat(b));
  }
  a=new String[]{"1a.1","23.1234567a890123456","This is a float","","  "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Float fl=ps.getLoadCaster().bytesToFloat(b);
    assertNull(fl);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToDouble() throws IOException {
  String[] a={"1","-2.345","12.12334567890123456","1.02e12","-.23344",""};
  Double[] d={1.0,-2.345,12.12334567890123456,1.02e12,-.23344};
  for (int j=0; j < d.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(d[j],ps.getLoadCaster().bytesToDouble(b));
  }
  a=new String[]{"-0x1.1","-23a.45","This is a double","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Double dl=ps.getLoadCaster().bytesToDouble(b);
    assertNull(dl);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCounters </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapOnlyBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    if (t > 50)     count++;
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = foreach b generate $0 - 50;");
  ExecJob job=pigServer.store("c","output_map_only","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output_map_only",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output_map_only"),true);
  System.out.println("============================================");
  System.out.println("Test case Map Only");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(count,js.getMapOutputRecords());
    assertEquals(0,js.getReduceInputRecords());
    assertEquals(0,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapReduceOnly() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group;");
  ExecJob job=pigServer.store("c","output");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(MAX,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapReduceOnlyBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group;");
  ExecJob job=pigServer.store("c","output","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(MAX,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapOnly() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    if (t > 50)     count++;
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = foreach b generate $0 - 50;");
  ExecJob job=pigServer.store("c","output_map_only");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output_map_only",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output_map_only"),true);
  System.out.println("============================================");
  System.out.println("Test case Map Only");
  System.out.println("============================================");
  JobGraph jg=pigStats.getJobGraph();
  Iterator<JobStats> iter=jg.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(count,js.getMapOutputRecords());
    assertEquals(0,js.getReduceInputRecords());
    assertEquals(0,js.getReduceOutputRecords());
    System.out.println("Hdfs bytes written : " + js.getHdfsBytesWritten());
    assertEquals(filesize,js.getHdfsBytesWritten());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapCombineReduceBinStorage() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group, SUM(a.$1);");
  ExecJob job=pigServer.store("c","output","BinStorage");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapCombineReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(count,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapCombineReduce() throws IOException, ExecException {
  int count=0;
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  int[] nos=new int[10];
  for (int i=0; i < 10; i++)   nos[i]=0;
  for (int i=0; i < MAX; i++) {
    int index=r.nextInt(10);
    int value=r.nextInt(100);
    nos[index]+=value;
    pw.println(index + "\t" + value);
  }
  pw.close();
  for (int i=0; i < 10; i++) {
    if (nos[i] > 0)     count++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = group a by $0;");
  pigServer.registerQuery("c = foreach b generate group, SUM(a.$1);");
  ExecJob job=pigServer.store("c","output");
  PigStats pigStats=job.getStatistics();
  InputStream is=FileLocalizer.open(FileLocalizer.fullPath("output",pigServer.getPigContext()),pigServer.getPigContext());
  long filesize=0;
  while (is.read() != -1)   filesize++;
  is.close();
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("output"),true);
  System.out.println("============================================");
  System.out.println("Test case MapCombineReduce");
  System.out.println("============================================");
  JobGraph jp=pigStats.getJobGraph();
  Iterator<JobStats> iter=jp.iterator();
  while (iter.hasNext()) {
    MRJobStats js=(MRJobStats)iter.next();
    System.out.println("Map input records : " + js.getMapInputRecords());
    assertEquals(MAX,js.getMapInputRecords());
    System.out.println("Map output records : " + js.getMapOutputRecords());
    assertEquals(MAX,js.getMapOutputRecords());
    System.out.println("Reduce input records : " + js.getReduceInputRecords());
    assertEquals(count,js.getReduceInputRecords());
    System.out.println("Reduce output records : " + js.getReduceOutputRecords());
    assertEquals(count,js.getReduceOutputRecords());
  }
  System.out.println("Hdfs bytes written : " + pigStats.getBytesWritten());
  assertEquals(filesize,pigStats.getBytesWritten());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCustomPartitioner </h4><pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerDistinct() throws Exception {
  String[] input={"1\t1","2\t1","1\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerDistinct",input);
  String outputDir="tmp_testCustomPartitionerDistinct";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerDistinct' as (a0:int, a1:int);");
  pigServer.registerQuery("B = distinct A PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerDistinct");
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerGroups() throws Exception {
  String[] input={"1\t1","2\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerGroups",input);
  String outputDir="tmp_testCustomPartitionerGroup";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerGroups' as (a0:int, a1:int);");
  pigServer.registerQuery("B = group A by $0 PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerGroups");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBag </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  assertEquals("Size of distinct data bag is incorrect",rightAnswer.size(),b.size());
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTypedTupleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedFirstSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 373; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 321; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBagAccess </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonSpillableDataBag() throws Exception {
  String[][] tupleContents=new String[][]{{"a","b"},{"c","d"},{"e","f"}};
  NonSpillableDataBag bg=new NonSpillableDataBag();
  for (int i=0; i < tupleContents.length; i++) {
    bg.add(Util.createTuple(tupleContents[i]));
  }
  Iterator<Tuple> it=bg.iterator();
  int j=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals(Util.createTuple(tupleContents[j]),t);
    j++;
  }
  assertEquals(tupleContents.length,j);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBagConstantFlatten2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"somestring\t10\t{(a,10),(b,20)}"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (str:chararray, intval:int, bg:bag{t:tuple(s:chararray, i:int)});");
  pigServer.registerQuery("b = foreach a generate str, intval, flatten(bg);");
  pigServer.registerQuery("c = foreach b generate str, intval, s, i;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  int i=0;
  Object[][] results=new Object[][]{{"somestring",new Integer(10),"a",new Integer(10)},{"somestring",new Integer(10),"b",new Integer(20)}};
  Class[] resultClasses=new Class[]{String.class,Integer.class,String.class,Integer.class};
  while (it.hasNext()) {
    Tuple t=it.next();
    for (int j=0; j < resultClasses.length; j++) {
      assertEquals(results[i][j],t.get(j));
      assertEquals(resultClasses[j],t.get(j).getClass());
    }
    i++;
  }
  assertEquals(results.length,i);
  pigServer.registerQuery("c = foreach b generate str, intval, bg::s, bg::i;");
  it=pigServer.openIterator("c");
  i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    for (int j=0; j < resultClasses.length; j++) {
      assertEquals(results[i][j],t.get(j));
      assertEquals(resultClasses[j],t.get(j).getClass());
    }
    i++;
  }
  assertEquals(results.length,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagStoreLoad() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"a\tid1","a\tid2","a\tid3","b\tid4","b\tid5","b\tid6"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (s:chararray, id:chararray);");
  pigServer.registerQuery("b = group a by s;");
  Class[] loadStoreClasses=new Class[]{BinStorage.class,PigStorage.class};
  for (int i=0; i < loadStoreClasses.length; i++) {
    String output="TestDataBagAccess-testBagStoreLoad-" + loadStoreClasses[i].getName() + ".txt";
    pigServer.deleteFile(output);
    pigServer.store("b",output,loadStoreClasses[i].getName());
    pigServer.registerQuery("c = load '" + output + "' using "+ loadStoreClasses[i].getName()+ "() AS "+ "(gp: chararray, bg:bag { t: tuple (sReLoaded: chararray, idReLoaded: chararray)});;");
    Iterator<Tuple> it=pigServer.openIterator("c");
    MultiMap<Object,Object> results=new MultiMap<Object,Object>();
    results.put("a","id1");
    results.put("a","id2");
    results.put("a","id3");
    results.put("b","id4");
    results.put("b","id5");
    results.put("b","id6");
    int j=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      Object groupKey=t.get(0);
      DataBag groupBag=(DataBag)t.get(1);
      Iterator<Tuple> bgIt=groupBag.iterator();
      int k=0;
      while (bgIt.hasNext()) {
        HashMap<Object,Boolean> seen=new HashMap<Object,Boolean>();
        Tuple bgt=bgIt.next();
        assertTrue(bgt.get(0).equals(groupKey));
        Collection values=results.get(groupKey);
        assertTrue(values.contains(bgt.get(1)));
        if (seen.containsKey(bgt.get(1)))         fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate value ("+ bgt.get(1)+ ")");
 else         seen.put(bgt.get(1),true);
        k++;
      }
      assertEquals(3,k);
      j++;
    }
    assertEquals(results.keySet().size(),j);
    pigServer.registerQuery("d = foreach c generate gp, flatten(bg);");
    List<Tuple> resultTuples=new ArrayList<Tuple>();
    resultTuples.add(Util.createTuple(new String[]{"a","a","id1"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id2"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id3"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id4"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id5"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id6"}));
    it=pigServer.openIterator("d");
    j=0;
    HashMap<Tuple,Boolean> seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("e = foreach d generate gp, sReLoaded, idReLoaded;");
    it=pigServer.openIterator("e");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("f = foreach d generate $0, $1, $2;");
    it=pigServer.openIterator("f");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBagConstantAccess() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"sampledata\tnot_used"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("b = foreach a generate {(16, 4.0e-2, 'hello', -101)} as mybag:{t:(i: int, d: double, c: chararray, e : int)};");
  pigServer.registerQuery("c = foreach b generate mybag.i, mybag.d, mybag.c, mybag.e;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  Object[] results=new Object[]{new Integer(16),new Double(4.0e-2),"hello",new Integer(-101)};
  Class[] resultClasses=new Class[]{Integer.class,Double.class,String.class,Integer.class};
  assertEquals(results.length,t.size());
  for (int i=0; i < results.length; i++) {
    DataBag bag=(DataBag)t.get(i);
    assertEquals(results[i],bag.iterator().next().get(0));
    assertEquals(resultClasses[i],bag.iterator().next().get(0).getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=giveMeOneOfEach();
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  for (int i=0; i < 2; i++) {
    Tuple after=tf.newTuple();
    after.readFields(in);
    Object o=after.get(0);
    assertTrue("isa Tuple",o instanceof Tuple);
    Tuple t3=(Tuple)o;
    o=t3.get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(3),(Integer)o);
    o=t3.get(1);
    assertTrue("isa Float",o instanceof Float);
    assertEquals(new Float(3.0),(Float)o);
    o=after.get(1);
    assertTrue("isa Bag",o instanceof DataBag);
    DataBag b=(DataBag)o;
    Iterator<Tuple> j=b.iterator();
    Tuple[] ts=new Tuple[2];
    assertTrue("first tuple in bag",j.hasNext());
    ts[0]=j.next();
    assertTrue("second tuple in bag",j.hasNext());
    ts[1]=j.next();
    o=ts[0].get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(4),(Integer)o);
    o=ts[1].get(0);
    assertTrue("isa String",o instanceof String);
    assertEquals("mary had a little lamb",(String)o);
    o=after.get(2);
    assertTrue("isa Map",o instanceof Map);
    Map<String,Object> m=(Map<String,Object>)o;
    assertEquals("world",(String)m.get("hello"));
    assertEquals("all",(String)m.get("goodbye"));
    assertNull(m.get("fred"));
    o=after.get(3);
    assertTrue("isa Integer",o instanceof Integer);
    Integer ii=(Integer)o;
    assertEquals(new Integer(42),ii);
    o=after.get(4);
    assertTrue("isa Long",o instanceof Long);
    Long l=(Long)o;
    assertEquals(new Long(5000000000L),l);
    o=after.get(5);
    assertTrue("isa Float",o instanceof Float);
    Float f=(Float)o;
    assertEquals(new Float(3.141592654),f);
    o=after.get(6);
    assertTrue("isa Double",o instanceof Double);
    Double d=(Double)o;
    assertEquals(new Double(2.99792458e8),d);
    o=after.get(7);
    assertTrue("isa Boolean",o instanceof Boolean);
    Boolean bool=(Boolean)o;
    assertTrue(bool);
    o=after.get(8);
    assertTrue("isa DataByteArray",o instanceof DataByteArray);
    DataByteArray ba=(DataByteArray)o;
    assertEquals(new DataByteArray("hello"),ba);
    o=after.get(9);
    assertTrue("isa String",o instanceof String);
    String s=(String)o;
    assertEquals("goodbye",s);
  }
  file.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDefaultDateTimeZone </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalExecution() throws Exception {
  Iterator<Tuple> expectedItr=generateExpectedResults(DateTimeZone.forOffsetMillis(DateTimeZone.forID("+08:00").getOffset(null)));
  Properties config=new Properties();
  config.setProperty("pig.datetime.default.tz","+08:00");
  PigServer pig=new PigServer(Util.getLocalTestMode(),config);
  pig.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' as (test:datetime);");
  pig.registerQuery("b = filter a by test < ToDate('1970-01-04T00:00:00.000');");
  Iterator<Tuple> actualItr=pig.openIterator("b");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupWithInputFromGroup() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2","pigtester\t15\t1.2","pigtester2\t10\t1.2","pigtester3\t10\t1.2","pigtester3\t20\t1.2","pigtester3\t30\t1.2"});
  Map<String,Pair<Long,Long>> resultMap=new HashMap<String,Pair<Long,Long>>();
  resultMap.put("pigtester",new Pair<Long,Long>(25L,2L));
  resultMap.put("pigtester2",new Pair<Long,Long>(10L,1L));
  resultMap.put("pigtester3",new Pair<Long,Long>(60L,3L));
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("d = cogroup b by group, c by name;");
  pigServer.registerQuery("e = foreach d generate flatten(group), SUM(c.age), COUNT(c.name);");
  Iterator<Tuple> it=pigServer.openIterator("e");
  for (int i=0; i < resultMap.size(); i++) {
    Tuple t=it.next();
    Assert.assertEquals(true,resultMap.containsKey(t.get(0)));
    Pair<Long,Long> output=resultMap.get(t.get(0));
    Assert.assertEquals(output.first,t.get(1));
    Assert.assertEquals(output.second,t.get(2));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupAfterDistinct() throws Exception {
  String[] input1={"abc","abc","def","def","def","abc","def","ghi"};
  String[] input2={"ghi	4","rst	12344","uvw	1","xyz	4141"};
  Util.createInputFile(cluster,"table1",input1);
  Util.createInputFile(cluster,"table2",input2);
  pigServer.registerQuery("nonuniqtable1 = LOAD 'table1' AS (f1:chararray);");
  pigServer.registerQuery("table1 = DISTINCT nonuniqtable1;");
  pigServer.registerQuery("table2 = LOAD 'table2' AS (f1:chararray, f2:int);");
  pigServer.registerQuery("temp = COGROUP table1 BY f1 INNER, table2 BY f1;");
  Iterator<Tuple> it=pigServer.openIterator("temp");
  HashMap<String,Tuple> results=new HashMap<String,Tuple>();
  Object[] row=new Object[]{"abc",Util.createBagOfOneColumn(new String[]{"abc"}),mBf.newDefaultBag()};
  results.put("abc",Util.createTuple(row));
  row=new Object[]{"def",Util.createBagOfOneColumn(new String[]{"def"}),mBf.newDefaultBag()};
  results.put("def",Util.createTuple(row));
  Object[] thirdColContents=new Object[]{"ghi",4};
  Tuple t=Util.createTuple(thirdColContents);
  row=new Object[]{"ghi",Util.createBagOfOneColumn(new String[]{"ghi"}),Util.createBag(new Tuple[]{t})};
  results.put("ghi",Util.createTuple(row));
  while (it.hasNext()) {
    Tuple tup=it.next();
    List fields=tup.getAll();
    Tuple expected=results.get((String)fields.get(0));
    int i=0;
    for (    Object field : fields) {
      Assert.assertEquals(expected.get(i++),field);
    }
  }
  Util.deleteFile(cluster,"table1");
  Util.deleteFile(cluster,"table2");
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFunctionInsideFunction() throws Exception {
  File f1=Util.createFile(new String[]{"a:1","b:1","a:1"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigContext) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = foreach a generate 1-1/1;");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  for (int i=0; i < 3; i++) {
    Assert.assertEquals(0.0d,DataType.toDouble(iter.next().get(0)).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAlgebraicDistinctProgress() throws Exception {
  int inputSize=4004;
  Integer[] inp=new Integer[inputSize];
  String[] inpString=new String[inputSize];
  for (int i=0; i < inputSize; i+=2) {
    inp[i]=i / 2;
    inp[i + 1]=i / 2;
    inpString[i]=new Integer(i / 2).toString();
    inpString[i + 1]=new Integer(i / 2).toString();
  }
  Util.createInputFile(cluster,"table",inpString);
  pigServer.registerQuery("a = LOAD 'table' AS (i:int);");
  pigServer.registerQuery("b = group a ALL;");
  pigServer.registerQuery("c = foreach b {aa = DISTINCT a; generate COUNT(aa);};");
  Iterator<Tuple> it=pigServer.openIterator("c");
  Integer[] exp=new Integer[inputSize / 2];
  for (int j=0; j < inputSize / 2; ++j) {
    exp[j]=j;
  }
  DataBag expectedBag=Util.createBagOfOneColumn(exp);
  while (it.hasNext()) {
    Tuple tup=it.next();
    Long resultBagSize=(Long)tup.get(0);
    Assert.assertTrue(DataType.compare(expectedBag.size(),resultBagSize) == 0);
  }
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=Util.createFile(new String[]{"a:1","b:1","a:1"});
  File f2=Util.createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigContext) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigContext) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=Util.createTempFileDelOnExit("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigContext) + "') "+ "generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMapUDF() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate (double)mymap#'double' as d, (long)mymap#'long' + (float)mymap#'float' as float_sum, CONCAT((chararray) mymap#'string', ' World!'), mymap#'int' * 10, (bag{tuple()}) mymap#'bag' as mybag, (tuple()) mymap#'tuple' as mytuple, (map[])mymap#'map' as mapInMap, mymap#'dba' as dba;" + "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(1.0,(Double)t.get(0),0.01);
    Assert.assertEquals(2.0,(Float)t.get(1),0.01);
    Assert.assertTrue(((String)t.get(2)).equals("Hello World!"));
    Assert.assertEquals(new Integer(10),(Integer)t.get(3));
    Assert.assertEquals(1,((DataBag)t.get(4)).size());
    Assert.assertEquals(4,((Tuple)t.get(5)).size());
    Assert.assertEquals(2,((Map<String,Object>)t.get(6)).size());
    Assert.assertEquals(DataByteArray.class,t.get(7).getClass());
    Assert.assertEquals(8,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT * LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals(1,t.get(1));
  Assert.assertEquals(2,t.get(2));
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  String output="/pig/out/TestEvalPipeline-testBinStorageDetermineSchema";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);","p = load '" + output + "' using BinStorage() "+ "as (b, t2, m);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate COUNT(b), t2.a, t2.b as t2b, m#'key1', m#'key2', b;","q = foreach p generate COUNT(b), t2.$0, t2.$1, m#'key1', m#'key2', b;","q = foreach p generate COUNT($0), $1.$0, $1.$1, $2#'key1', $2#'key2', $0;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    it=pigServer.openIterator("q");
    t=it.next();
    Assert.assertEquals(new Long(2),t.get(0));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1,t.get(1));
    Assert.assertEquals(Integer.class,t.get(2).getClass());
    Assert.assertEquals(2,t.get(2));
    Assert.assertEquals("value1",t.get(3).toString());
    Assert.assertEquals("value2",t.get(4).toString());
    Assert.assertEquals(DefaultDataBag.class,t.get(5).getClass());
    DataBag bg=(DataBag)t.get(5);
    for (Iterator<Tuple> bit=bg.iterator(); bit.hasNext(); ) {
      Tuple bt=bit.next();
      Assert.assertEquals(String.class,bt.get(0).getClass());
      Assert.assertEquals(String.class,bt.get(1).getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigContext) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  String output="/pig/out/TestEvalPipeline-testBinStorageDetermineSchema2";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (name:chararray, age:int, gpa:double);","p = load '" + output + "' using BinStorage() "+ "as (name, age, gpa);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate name, age, gpa;","q = foreach p generate name, age, gpa;","q = foreach p generate $0, $1, $2;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    Iterator<Tuple> it=pigServer.openIterator("q");
    Tuple t=it.next();
    Assert.assertEquals("pigtester",t.get(0));
    Assert.assertEquals(String.class,t.get(0).getClass());
    Assert.assertEquals(10,t.get(1));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1.2,t.get(2));
    Assert.assertEquals(Double.class,t.get(2).getClass());
  }
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age:long, gpa:float);");
  pigServer.registerQuery("q = foreach p generate name, age, gpa;");
  Iterator<Tuple> it=pigServer.openIterator("q");
  Tuple t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(10L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1.2f,t.get(2));
  Assert.assertEquals(Float.class,t.get(2).getClass());
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age, gpa);");
  pigServer.registerQuery("q = foreach p generate name, age + 1L, (int)gpa;");
  it=pigServer.openIterator("q");
  t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(11L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals(Integer.class,t.get(2).getClass());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanWithExpressionAssignment() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = " + Identity.class.getName() + "(*);"+ "C5 = COUNT(C2);"+ "C6 = SUM(C2.$1);"+ "C7 = "+ TitleNGrams.class.getName()+ "(C3);"+ "C8 = MAX(C3.$1);"+ "generate (int)group, C4, C5, C6, C7, C8, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBinStorageWithLargeStrings() throws Exception {
  int testSize=100;
  String[] stringArray=new String[testSize];
  Random random=new Random();
  stringArray[0]=GenRandomData.genRandLargeString(random,65534);
  for (int i=1; i < stringArray.length; ++i) {
    if ((i % 25) == 0) {
      stringArray[i]=GenRandomData.genRandLargeString(random,65535 + i);
    }
 else {
      stringArray[i]=GenRandomData.genRandString(random);
    }
  }
  Util.createInputFile(cluster,"table",stringArray);
  pigServer.registerQuery("a = load 'table' using PigStorage() " + "as (c: chararray);");
  String output="/pig/out/TestEvalPipeline-testBinStorageLargeStrings";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("b = load '" + output + "' using BinStorage() "+ "as (c:chararray);");
  pigServer.registerQuery("c = foreach b generate c;");
  Iterator<Tuple> it=pigServer.openIterator("c");
  int counter=0;
  while (it.hasNext()) {
    Tuple tup=it.next();
    String resultString=(String)tup.get(0);
    String expectedString=stringArray[counter];
    Assert.assertTrue(expectedString.equals(resultString));
    ++counter;
  }
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=Util.createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=Util.createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigContext) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigContext) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlan() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "generate (int)group," + Identity.class.getName() + "(*), COUNT(C2), SUM(C2.$1),"+ TitleNGrams.class.getName()+ "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageWithCtrlChars() throws Exception {
  String[] inputData={"hello\u0001world","good\u0001morning","nice\u0001day"};
  Util.createInputFile(cluster,"testPigStorageWithCtrlCharsInput.txt",inputData);
  String script="a = load 'testPigStorageWithCtrlCharsInput.txt' using PigStorage('\u0001');" + "b = foreach a generate $0, CONCAT($0, '\u0005'), $1; " + "store b into 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001');"+ "c = load 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001') as (f1:chararray, f2:chararray, f3:chararray);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  HashMap<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("hello",(Tuple)Util.getPigConstant("('hello','hello\u0005','world')"));
  expectedResults.put("good",(Tuple)Util.getPigConstant("('good','good\u0005','morning')"));
  expectedResults.put("nice",(Tuple)Util.getPigConstant("('nice','nice\u0005','day')"));
  HashMap<String,Boolean> seen=new HashMap<String,Boolean>();
  int numRows=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String firstCol=(String)t.get(0);
    Assert.assertFalse(seen.containsKey(firstCol));
    seen.put(firstCol,true);
    Assert.assertEquals(expectedResults.get(firstCol),t);
    numRows++;
  }
  Assert.assertEquals(3,numRows);
  Util.deleteFile(cluster,"testPigStorageWithCtrlCharsInput.txt");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSortDesc() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num desc parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MAX_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum <= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSort() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MIN_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum >= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFwithStarInput() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "generate " + Identity.class.getName() + "(*);"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    Tuple t=(Tuple)tuple.get(0);
    Assert.assertEquals(DataByteArray.class,t.get(0).getClass());
    int group=Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
    Assert.assertEquals(numIdentity,group);
    Assert.assertTrue(t.get(1) instanceof DataBag);
    DataBag bag=(DataBag)t.get(1);
    Assert.assertEquals(10,bag.size());
    Assert.assertEquals(2,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema2() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  String output="./TestEvalPipeline-testBinStorageDetermineSchema2";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (name:chararray, age:int, gpa:double);","p = load '" + output + "' using BinStorage() "+ "as (name, age, gpa);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate name, age, gpa;","q = foreach p generate name, age, gpa;","q = foreach p generate $0, $1, $2;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    Iterator<Tuple> it=pigServer.openIterator("q");
    Tuple t=it.next();
    Assert.assertEquals("pigtester",t.get(0));
    Assert.assertEquals(String.class,t.get(0).getClass());
    Assert.assertEquals(10,t.get(1));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1.2,t.get(2));
    Assert.assertEquals(Double.class,t.get(2).getClass());
  }
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age:long, gpa:float);");
  pigServer.registerQuery("q = foreach p generate name, age, gpa;");
  Iterator<Tuple> it=pigServer.openIterator("q");
  Tuple t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(10L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1.2f,t.get(2));
  Assert.assertEquals(Float.class,t.get(2).getClass());
  pigServer.registerQuery("p = load '" + output + "' using BinStorage() "+ " as (name, age, gpa);");
  pigServer.registerQuery("q = foreach p generate name, age + 1L, (int)gpa;");
  it=pigServer.openIterator("q");
  t=it.next();
  Assert.assertEquals("pigtester",t.get(0));
  Assert.assertEquals(String.class,t.get(0).getClass());
  Assert.assertEquals(11L,t.get(1));
  Assert.assertEquals(Long.class,t.get(1).getClass());
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals(Integer.class,t.get(2).getClass());
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinStorageDetermineSchema() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"{(f1, f2),(f3, f4)}\t(1,2)\t[key1#value1,key2#value2]"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  pigServer.registerQuery("b = foreach a generate COUNT(b), t2.a, t2.b, m#'key1', m#'key2';");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Assert.assertEquals(new Long(2),t.get(0));
  Assert.assertEquals(1,t.get(1));
  Assert.assertEquals(2,t.get(2));
  Assert.assertEquals("value1",t.get(3).toString());
  Assert.assertEquals("value2",t.get(4).toString());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (b:bag{t:tuple(x:chararray,y:chararray)}, t2:tuple(a:int,b:int), m:map[]);");
  String output="./TestEvalPipeline-testBinStorageDetermineSchema";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  String[] loads={"p = load '" + output + "' using BinStorage() "+ "as (b:bag{t:tuple(x,y)}, t2:tuple(a,b), m:map[]);","p = load '" + output + "' using BinStorage() "+ "as (b, t2, m);","p = load '" + output + "' using BinStorage() ;"};
  String[] generates={"q = foreach p generate COUNT(b), t2.a, t2.b as t2b, m#'key1', m#'key2', b;","q = foreach p generate COUNT(b), t2.$0, t2.$1, m#'key1', m#'key2', b;","q = foreach p generate COUNT($0), $1.$0, $1.$1, $2#'key1', $2#'key2', $0;"};
  for (int i=0; i < loads.length; i++) {
    pigServer.registerQuery(loads[i]);
    pigServer.registerQuery(generates[i]);
    it=pigServer.openIterator("q");
    t=it.next();
    Assert.assertEquals(new Long(2),t.get(0));
    Assert.assertEquals(Integer.class,t.get(1).getClass());
    Assert.assertEquals(1,t.get(1));
    Assert.assertEquals(Integer.class,t.get(2).getClass());
    Assert.assertEquals(2,t.get(2));
    Assert.assertEquals("value1",t.get(3).toString());
    Assert.assertEquals("value2",t.get(4).toString());
    Assert.assertEquals(DefaultDataBag.class,t.get(5).getClass());
    DataBag bg=(DataBag)t.get(5);
    for (Iterator<Tuple> bit=bg.iterator(); bit.hasNext(); ) {
      Tuple bt=bit.next();
      Assert.assertEquals(String.class,bt.get(0).getClass());
      Assert.assertEquals(String.class,bt.get(1).getClass());
    }
  }
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFunctionInsideFunction() throws Exception {
  File f1=createFile(new String[]{"a:1","b:1","a:1"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = foreach a generate 1-1/1;");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  for (int i=0; i < 3; i++) {
    Assert.assertEquals(DataType.toDouble(iter.next().get(0)),0.0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCogroupWithInputFromGroup() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"pigtester\t10\t1.2","pigtester\t15\t1.2","pigtester2\t10\t1.2","pigtester3\t10\t1.2","pigtester3\t20\t1.2","pigtester3\t30\t1.2"});
  Map<String,Pair<Long,Long>> resultMap=new HashMap<String,Pair<Long,Long>>();
  resultMap.put("pigtester",new Pair<Long,Long>(25L,2L));
  resultMap.put("pigtester2",new Pair<Long,Long>(10L,1L));
  resultMap.put("pigtester3",new Pair<Long,Long>(60L,3L));
  pigServer.registerQuery("a = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = load '" + Util.encodeEscape(input.toString()) + "' using PigStorage() "+ "as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("d = cogroup b by group, c by name;");
  pigServer.registerQuery("e = foreach d generate flatten(group), SUM(c.age), COUNT(c.name);");
  Iterator<Tuple> it=pigServer.openIterator("e");
  for (int i=0; i < resultMap.size(); i++) {
    Tuple t=it.next();
    Assert.assertEquals(true,resultMap.containsKey(t.get(0)));
    Pair<Long,Long> output=resultMap.get(t.get(0));
    Assert.assertEquals(output.first,t.get(1));
    Assert.assertEquals(output.second,t.get(2));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=createFile(new String[]{"a:1","b:1","a:1"});
  File f2=createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigServer.getPigContext()) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigServer.getPigContext()) + "') generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFetch </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3() throws Exception {
  File scriptFile=null;
  try {
    String[] script={"A = load '" + Util.encodeEscape(inputFile1.getAbsolutePath()) + "' ","using PigStorage(' ') as (a:int, b: ","{t:(t1:int,t2:int,t3:int,t4:int,c:chararray)});","C = foreach A {","  temp1 = foreach b generate t1*100 as (key:int), ((t2+t3)*10) as (r:int);","  temp2 = filter temp1 by key < 400;","  temp3 = limit temp2 3;","  temp4 = foreach temp3 generate key-r as (id:int);","  temp5 = limit temp4 4;","  temp6 = filter temp5 by id < 100;","  generate flatten(temp6) as (id:int), a;","};","D = foreach C generate (","  case id % 4","    when 0 then true","    else false","  end",") as (check:boolean);"};
    scriptFile=Util.createLocalInputFile("testFetchTest3.pig",script);
    pigServer.registerScript(scriptFile.getAbsolutePath());
    Iterator<Tuple> it=pigServer.openIterator("D");
    while (it.hasNext()) {
      assertEquals(false,it.next().get(0));
      assertEquals(true,it.next().get(0));
    }
  }
  finally {
    if (scriptFile != null) {
      scriptFile.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilter </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    ConstantExpression c2=GenPhyOp.exprConst();
    c2.setValue(new Integer(0));
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,c2,DataType.INTEGER);
    POProject p3=GenPhyOp.exprProject(1);
    ConstantExpression c=GenPhyOp.exprConst();
    c.setValue(new Integer(1));
    EqualToExpr eq=GenPhyOp.compEqualToExpr(p3,c,DataType.INTEGER);
    POAnd and=GenPhyOp.compAndExpr(gt,eq);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(c2);
    ip.add(gt);
    ip.add(p3);
    ip.add(c);
    ip.add(eq);
    ip.add(and);
    ip.connect(p1,gt);
    ip.connect(c2,gt);
    ip.connect(p3,eq);
    ip.connect(c,eq);
    ip.connect(eq,and);
    ip.connect(gt,and);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
    assertEquals(1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue(it.hasNext());
    t=it.next();
    assertEquals(2,t.size());
    assertTrue(t.get(0) instanceof Integer);
    assertTrue(t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals(1,(int)i1);
    assertEquals(1,(int)i2);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testGetNextTuple() throws Exception {
  pass.attachInput(t);
  Result res=pass.getNextTuple();
  assertEquals(t,res.result);
  fail.attachInput(t);
  res=fail.getNextTuple();
  assertEquals(res.returnStatus,POStatus.STATUS_EOP);
  for (int i=0; i < nullFlags.length; i++) {
    int count=0;
    setUpProjFil(nullFlags[i]);
    while (true) {
      res=projFil.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_EOP)       break;
      count++;
      assertEquals(POStatus.STATUS_OK,res.returnStatus);
      Tuple output=(Tuple)res.result;
      assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",true,TestHelper.bagContains(inp,output));
      assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",true,(Integer)((Tuple)res.result).get(1) > 50);
    }
    assertEquals("Running testGetNextTuple with nullFlags set to " + nullFlags[i] + ":",getExpCount(inp),count);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    POProject p2=GenPhyOp.exprProject(1);
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,p2,DataType.INTEGER);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(p2);
    ip.add(gt);
    ip.connect(p1,gt);
    ip.connect(p2,gt);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",POStatus.STATUS_EOP,res.returnStatus);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",it.hasNext());
    t=it.next();
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",2,t.size());
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(0) instanceof Integer);
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,(int)i1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",0,(int)i2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpNumeric </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate (($0 < 10 or $0 < 9)?(($1 >= 5 and $1 >= 4) ? 2: 1) : 0);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Integer first=(Integer)t.get(0);
    count+=first;
    assertTrue(first == 1 || first == 2 || first == 0);
  }
  assertEquals("expected count of 15",15,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericLt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + ":" + (double)(i + 1));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (a: double, b:double);");
  String query="A = filter A by ($0 <= $1 and $0 < $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) < 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNumericEq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + ":" + (i - 1));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by ($0 == $1 and $0 <= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertEquals(first,second);
    String sfirst=t.get(0).toString();
    String ssecond=t.get(1).toString();
    assertFalse(sfirst.equals(ssecond));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericGte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else     if (i % 3 == 0) {
      ps.println(i - 1 + ":" + (double)(i));
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by ($0 > $1 or $0 >= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) >= 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericNeq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("1:1");
    }
 else {
      ps.println("2:3");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 != $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertFalse(first.equals(second));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericLte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else     if (i % 3 == 0) {
      ps.println(i - 1 + ":" + (double)(i));
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (a: double, b:double);");
  String query="A = filter A by ($0 <= $1 or $0 < $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) <= 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNumericGt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + 1 + ":"+ (double)(i));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':') as (f1: double, f2:double);");
  String query="A = filter A by ($0 > $1 and $0 >= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertTrue(first.compareTo(second) > 0);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate ($1 >= " + LOOP_COUNT + "-10?'1':'0');";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    if (first == 1)     count++;
 else     assertTrue(first == 0);
  }
  assertEquals("expected count of 10",10,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpString </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) > 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) < 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) >= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringNeq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("ab:ab");
    }
 else     if (i % 3 == 0) {
      ps.println("ab:abc");
      expectedCount++;
    }
 else {
      ps.println(":");
      ps.println("ab:");
      ps.println(":ab");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 neq $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertFalse(first.equals(second));
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringEq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("a:" + i);
      ps.println("a:");
      ps.println(":a");
      ps.println(":");
    }
 else {
      ps.println("ab:ab");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 eq $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    count++;
    assertEquals(first,second);
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) <= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterUDF </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterUDF() throws Exception {
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' as (x:int);");
  pigServer.registerQuery("B = filter A by " + MyFilterFunction.class.getName() + "($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,(Integer)t.get(0) > 10);
    ++cnt;
  }
  assertEquals(10,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFusingDefine2() throws Exception {
  File inputFile=createFile(new String[]{"www.paulisageek.com\t4","www.yahoo.com\t12344","google.com\t1","us2.amazon.com\t4141"});
  File filterFile=createFile(new String[]{"12344"});
  pigServer.registerQuery("define FILTER_CRITERION " + FILTERFROMFILE.class.getName() + "('"+ Util.generateURI(filterFile.toString(),pigServer.getPigContext())+ "');");
  pigServer.registerQuery("a = LOAD '" + Util.generateURI(inputFile.toString(),pigServer.getPigContext()) + "' as (url:chararray, numvisits:int);");
  pigServer.registerQuery("b = filter a by FILTER_CRITERION(numvisits) AND FILTER_CRITERION(numvisits);");
  Tuple expectedTuple=tf.newTuple();
  expectedTuple.append(new String("www.yahoo.com"));
  expectedTuple.append(new Integer("12344"));
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.equals(expectedTuple));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFilterUDFusingDefine() throws Exception {
  File inputFile=createFile(new String[]{"www.paulisageek.com\t4","www.yahoo.com\t12344","google.com\t1","us2.amazon.com\t4141"});
  File filterFile=createFile(new String[]{"12344"});
  pigServer.registerQuery("define FILTER_CRITERION " + FILTERFROMFILE.class.getName() + "('"+ Util.generateURI(filterFile.toString(),pigServer.getPigContext())+ "');");
  pigServer.registerQuery("a = LOAD '" + Util.generateURI(inputFile.toString(),pigServer.getPigContext()) + "' as (url:chararray, numvisits:int);");
  pigServer.registerQuery("b = filter a by FILTER_CRITERION(numvisits);");
  Tuple expectedTuple=tf.newTuple();
  expectedTuple.append(new String("www.yahoo.com"));
  expectedTuple.append(new Integer("12344"));
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.equals(expectedTuple));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEach </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException, IOException {
  int size=0;
  for (Result res=fe.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=fe.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    assertTrue(TestHelper.bagContains(projDB,t));
    ++size;
  }
  assertEquals(size,db.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlan </h4><pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInnerOrderBy() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    System.out.println("Running testInnerOrderBy with nullFlags set to :" + nullFlags[i]);
    File tmpFile=genDataSetFile1(nullFlags[i]);
    pig.registerQuery("a = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "'; ");
    pig.registerQuery("b = group a by $0; ");
    pig.registerQuery("c = foreach b { " + "     c1 = order $1 by *; " + "    generate flatten(c1); "+ "};");
    Iterator<Tuple> it=pig.openIterator("c");
    Tuple t=null;
    int count=0;
    while (it.hasNext()) {
      t=it.next();
      System.out.println(count + ":" + t);
      count++;
    }
    Assert.assertEquals(count,30);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlgebricFuncWithoutGroupBy() throws IOException, ParserException {
  String INPUT_FILE="test-sum.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\t{(1),(2),(3)}");
  w.println("20\t{(4),(5),(6),(7)}");
  w.println("30\t{(8),(9)}");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("a = load '" + INPUT_FILE + "' "+ "as (id:int, g:bag{t:tuple(u:int)});");
    pig.registerQuery("b = foreach a generate id, SUM(g);");
    Iterator<Tuple> iter=pig.openIterator("b");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,6L)","(20,22L)","(30,17L)"});
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
    }
    assertEquals(expectedResults.size(),counter);
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlanLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossTwoRelations() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10'),('user1','usa','user1','usa','30'),('user1','usa','user1','china','20')})","({('user2','usa','user2','usa','20'),('user2','usa','user2','usa','20')})","({('user3','singapore','user3','usa','10'),('user3','singapore','user3','singapore','20')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("C = cogroup user by uid, session by uid;");
  pig.registerQuery("D = foreach C {" + "crossed = cross user, session;" + "generate crossed;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInnerOrderBy() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Running testInnerOrderBy with nullFlags set to :" + nullFlags[i]);
    File tmpFile=genDataSetFile1(nullFlags[i]);
    pig.registerQuery("a = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "'; ");
    pig.registerQuery("b = group a by $0; ");
    pig.registerQuery("c = foreach b { " + "     c1 = order $1 by *; " + "    generate flatten(c1); "+ "};");
    Iterator<Tuple> it=pig.openIterator("c");
    Tuple t=null;
    int count=0;
    while (it.hasNext()) {
      t=it.next();
      System.out.println(count + ":" + t);
      count++;
    }
    assertEquals(count,30);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossTwoRelationsComplex() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10'),('user1','usa','user1','usa','30')})","({('user2','usa','user2','usa','20')})","({('user3','singapore','user3','singapore','20')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("C = cogroup user by uid, session by uid;");
  pig.registerQuery("D = foreach C {" + "distinct_session = distinct session;" + "crossed = cross user, distinct_session;"+ "filtered = filter crossed by user::region == distinct_session::region;"+ "generate filtered;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedCrossThreeRelations() throws Exception {
  File[] tmpFiles=generateDataSetFilesForNestedCross();
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('user1','usa','user1','usa','10','user1','admin','male'),('user1','usa','user1','usa','30','user1','admin','male'),('user1','usa','user1','china','20','user1','admin','male')})","({('user2','usa','user2','usa','20','user2','guest','male'),('user2','usa','user2','usa','20','user2','guest','male')})","({('user3','singapore','user3','usa','10','user3','user','female'),('user3','singapore','user3','singapore','20','user3','user','female')})","({})"});
  pig.registerQuery("user = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[0].toString(),pig.getPigContext())) + "' as (uid, region);");
  pig.registerQuery("session = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[1].toString(),pig.getPigContext())) + "' as (uid, region, duration);");
  pig.registerQuery("profile = load '" + Util.encodeEscape(Util.generateURI(tmpFiles[2].toString(),pig.getPigContext())) + "' as (uid, role, gender);");
  pig.registerQuery("C = cogroup user by uid, session by uid, profile by uid;");
  pig.registerQuery("D = foreach C {" + "crossed = cross user, session, profile;" + "generate crossed;"+ "}");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("D");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGrunt </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScriptMissingLastNewLine() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL);
  PigContext context=server.getPigContext();
  String strCmd="A = load 'bar';\nB = foreach A generate $0;";
  BufferedReader reader=new BufferedReader(new StringReader(strCmd));
  String substituted=context.doParamSubstitution(reader,null,null);
  BufferedReader pigInput=new BufferedReader(new StringReader(substituted));
  Grunt grunt=new Grunt(pigInput,context);
  int results[]=grunt.exec();
  for (int i=0; i < results.length; i++) {
    assertEquals(0,results[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using UTF-8 Plain Text format projecting column c
 * @throws IOException
 */
@Test public void testStoreToHBase_2_with_projection() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    int col_a=Integer.parseInt(new String(getColValue(result,TESTCOLUMN_A)));
    double col_b=Double.parseDouble(new String(getColValue(result,TESTCOLUMN_B)));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using UTF-8 Plain Text format, and store it
 * into 'TESTTABLE_2' using UTF-8 Plain Text format projecting column c
 * @throws IOException
 */
@Test public void testStoreToHBase_3_with_projection_no_caster() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  prepareTable(TESTTABLE_2,false,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.UTF8PlainText);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    String col_a=new String(getColValue(result,TESTCOLUMN_A));
    String col_b=new String(getColValue(result,TESTCOLUMN_B));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i + "",col_a);
    Assert.assertEquals(i + 0.0 + "",col_b);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase test including the row key as the first column
 * @throws IOException
 */
@Test public void testLoadFromHBaseWithRowKey() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBaseWithRowKey Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBaseWithRowKey done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_bytearray_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, " + timestamp + "l as timestamp:bytearray, col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with projection.
 */
@Test public void testLoadWithProjection_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE col_a, col_c;");
  Iterator<Tuple> it=pig.openIterator("b");
  int index=0;
  LOG.info("testLoadWithProjection_1 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    int col_a=(Integer)t.get(0);
    String col_c=(String)t.get(1);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals("Text_" + index,col_c);
    Assert.assertEquals(2,t.size());
    index++;
  }
  Assert.assertEquals(100,index);
  LOG.info("testLoadWithProjection_1 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_1' deleting odd row keys
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_delete() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, (boolean)(((int)rowKey) % 2), col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_1,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTombstone true')");
  HTable table=new HTable(conf,TESTTABLE_1);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int count=0;
  for (int i=0; iter.hasNext(); i=i + 2) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
    count++;
  }
  Assert.assertEquals(50,count);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lt and gt (10&lt;key&lt;30) and regex \\d[5]
 */
@Test public void testLoadWithParameters_5() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gt 10 -lt 30 -regex \\\\d[5]') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int[] expectedValues={15,25};
  int count=0;
  int countExpected=2;
  LOG.info("LoadFromHBaseWithParameters_5 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals(expectedValues[count] + "",rowKey);
    Assert.assertEquals(expectedValues[count],Integer.parseInt(col_a));
    Assert.assertEquals((double)expectedValues[count],Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + expectedValues[count],col_c);
    count++;
  }
  Assert.assertEquals(countExpected,count);
  LOG.info("LoadFromHBaseWithParameters_5 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with map parameters and multiple column prefixs
 */
@Test public void testLoadWithMap_3_col_prefix() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_* pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, pig_cf_map:map[], pig_prefix_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=t.get(0).toString();
    Map pig_cf_map=(Map)t.get(1);
    Map pig_prefix_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_prefix_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_prefix_cf_map.size());
    Assert.assertEquals(count,Integer.parseInt(pig_cf_map.get("col_a").toString()));
    Assert.assertEquals(count + 0.0,Double.parseDouble(pig_cf_map.get("col_b").toString()),1e-6);
    Assert.assertEquals("Text_" + count,((DataByteArray)pig_cf_map.get("col_c")).toString());
    Assert.assertEquals(3,pig_cf_map.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, " + timestamp + "l, col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with projection and the default caster.
 */
@Test public void testLoadWithProjection_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.UTF8PlainText);
  pig.registerQuery("b = FOREACH a GENERATE col_a, col_c;");
  Iterator<Tuple> it=pig.openIterator("b");
  int index=0;
  LOG.info("testLoadWithProjection_2 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    int col_a=(Integer)t.get(0);
    String col_c=(String)t.get(1);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals("Text_" + index,col_c);
    Assert.assertEquals(2,t.size());
    index++;
  }
  Assert.assertEquals(100,index);
  LOG.info("testLoadWithProjection_2 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat
 * @throws IOException
 */
@Test public void testStoreToHBase_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  pig.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,"true");
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.store("a","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  pig.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,"false");
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to if HBaseStorage handles different scans in a single MR job.
 * This can happen PIG loads two different aliases (as in a join or
 * union).
 */
@Test public void testHeterogeneousScans() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery(String.format(" b = load 'hbase://%s' using %s('%s %s') as (col_a:int, col_c);",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage",TESTCOLUMN_A,TESTCOLUMN_C));
  pig.registerQuery(" c = join a by col_a, b by col_a; ");
  Iterator<Tuple> it=pig.openIterator("c");
  int index=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    Assert.assertNotNull(t.get(2));
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  Assert.assertEquals(index,TEST_ROW_COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and with a
 * static column in different order
 */
@Test public void testLoadOrderWithFixedAndPrefixedCols() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_* pig:prefixed_col_d"+ "','-loadKey') as (rowKey:chararray, cols:map[], prefixed_col_d:chararray);");
  pig.registerQuery("b = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:prefixed_col_d pig:col_*"+ "','-loadKey') as (rowKey:chararray, prefixed_col_d:chararray, cols:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  Iterator<Tuple> it2=pig.openIterator("b");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext() && it2.hasNext()) {
    Tuple t=it.next();
    Tuple t2=it2.next();
    LOG.info("LoadFromHBase a:" + t);
    LOG.info("LoadFromHBase b:" + t2);
    String rowKey=(String)t.get(0);
    String rowKey2=(String)t2.get(0);
    Assert.assertEquals(rowKey,rowKey2);
    Assert.assertEquals(t.size(),t2.size());
    @SuppressWarnings("rawtypes") Map cols_a=(Map)t.get(1);
    @SuppressWarnings("rawtypes") Map cols_b=(Map)t2.get(2);
    Assert.assertEquals(cols_a.size(),cols_b.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test collected group
 * not much to test here since keys are unique
 * @throws IOException
 */
@Test public void testCollectedGroup() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.HBaseBinary);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("c = group a by rowKey USING 'collected';");
  pig.registerQuery("d = ORDER c BY group;");
  Iterator<Tuple> it=pig.openIterator("d");
  int count=0;
  LOG.info("CollectedGroup Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    int rowCount=0;
    DataBag rows=(DataBag)t.get(1);
    for (Iterator<Tuple> iter=rows.iterator(); iter.hasNext(); ) {
      Tuple row=iter.next();
      int col_a=(Integer)row.get(1);
      double col_b=(Double)row.get(2);
      String col_c=(String)row.get(3);
      Assert.assertEquals(count,col_a);
      Assert.assertEquals(count + 0.0,col_b,1e-6);
      Assert.assertEquals("Text_" + count,col_c);
      rowCount++;
    }
    Assert.assertEquals(1,rowCount);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("CollectedGroup done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters regex [2-3][4-5]
 */
@Test public void testLoadWithParameters_4() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -regex [2-3][4-5]') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int[] expectedValues={24,25,34,35};
  int count=0;
  int countExpected=4;
  LOG.info("LoadFromHBaseWithParameters_4 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals(expectedValues[count] + "",rowKey);
    Assert.assertEquals(expectedValues[count],Integer.parseInt(col_a));
    Assert.assertEquals((double)expectedValues[count],Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + expectedValues[count],col_c);
    count++;
  }
  Assert.assertEquals(countExpected,count);
  LOG.info("LoadFromHBaseWithParameters_4 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using UTF-8 Plain Text format
 * @throws IOException
 */
@Test public void testStoreToHBase_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.store("a",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=i + "";
    String rowKey=new String(result.getRow());
    int col_a=Integer.parseInt(new String(getColValue(result,TESTCOLUMN_A)));
    double col_b=Double.parseDouble(new String(getColValue(result,TESTCOLUMN_B)));
    String col_c=new String(getColValue(result,TESTCOLUMN_C));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and column prefix
 */
@Test public void testLoadWithMap_2_col_prefix() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=t.get(0).toString();
    Map pig_cf_map=(Map)t.get(1);
    Assert.assertEquals(2,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with map parameters
 */
@Test public void testLoadWithMap_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:"+ "','-loadKey -cacheBlocks true') as (rowKey, col_a, col_b, col_c, pig_cf_map);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Map pig_cf_map=(Map)t.get(4);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertEquals(5,pig_cf_map.size());
    Assert.assertEquals(count,Integer.parseInt(pig_cf_map.get("col_a").toString()));
    Assert.assertEquals(count + 0.0,Double.parseDouble(pig_cf_map.get("col_b").toString()),1e-6);
    Assert.assertEquals("Text_" + count,((DataByteArray)pig_cf_map.get("col_c")).toString());
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters limit
 */
@Test public void testLoadWithParameters_3() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -limit 10') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBaseWithParameters_3 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(10,count);
  LOG.info("LoadFromHBaseWithParameters_3 Starting");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat projecting out column c
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_projection() throws IOException {
  System.getProperties().setProperty("pig.usenewlogicalplan","false");
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery("b = FOREACH a GENERATE rowKey, col_a, col_b;");
  pig.store("b",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ "','-caster HBaseBinaryConverter')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase 'TESTTABLE_1' using HBaseBinary format, and store it into
 * 'TESTTABLE_2' using HBaseBinaryFormat setting the timestamp
 * @throws IOException
 */
@Test public void testStoreToHBase_1_with_datetime_timestamp() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,false,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  long timestamp=System.currentTimeMillis();
  pig.registerQuery("b = FOREACH a GENERATE rowKey, ToDate(" + timestamp + "l), col_a, col_b, col_c;");
  pig.store("b","hbase://" + TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage('" + TESTCOLUMN_A + " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-caster HBaseBinaryConverter -includeTimestamp true')");
  HTable table=new HTable(conf,TESTTABLE_2);
  ResultScanner scanner=table.getScanner(new Scan());
  Iterator<Result> iter=scanner.iterator();
  int i=0;
  for (i=0; iter.hasNext(); ++i) {
    Result result=iter.next();
    String v=String.valueOf(i);
    String rowKey=Bytes.toString(result.getRow());
    int col_a=Bytes.toInt(getColValue(result,TESTCOLUMN_A));
    double col_b=Bytes.toDouble(getColValue(result,TESTCOLUMN_B));
    String col_c=Bytes.toString(getColValue(result,TESTCOLUMN_C));
    long col_a_ts=getColTimestamp(result,TESTCOLUMN_A);
    long col_b_ts=getColTimestamp(result,TESTCOLUMN_B);
    long col_c_ts=getColTimestamp(result,TESTCOLUMN_C);
    Assert.assertEquals(timestamp,col_a_ts);
    Assert.assertEquals(timestamp,col_b_ts);
    Assert.assertEquals(timestamp,col_c_ts);
    Assert.assertEquals("00".substring(v.length()) + v,rowKey);
    Assert.assertEquals(i,col_a);
    Assert.assertEquals(i + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + i,col_c);
  }
  Assert.assertEquals(100,i);
  table.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and column prefix with a
 * static column
 */
@Test public void testLoadWithFixedAndPrefixedCols() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:sc pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, sc:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=(String)t.get(0);
    String col_a=t.get(1) != null ? t.get(1).toString() : null;
    Map pig_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    Assert.assertEquals(Integer.toString(count),col_a);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase using HBaseBinaryConverter
 */
@Test public void testHBaseBinaryConverter() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  scanTable1(pig,DataFormat.HBaseBinary);
  Iterator<Tuple> it=pig.openIterator("a");
  int index=0;
  LOG.info("testHBaseBinaryConverter Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  LOG.info("testHBaseBinaryConverter done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * * Test Load from hbase with map parameters and with a
 * static column
 */
@Test public void testLoadWithFixedAndPrefixedCols2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ "pig:col_a pig:prefixed_col_*"+ "','-loadKey') as (rowKey:chararray, col_a:chararray, pig_cf_map:map[]);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=(String)t.get(0);
    String col_a=t.get(1) != null ? t.get(1).toString() : null;
    Map pig_cf_map=(Map)t.get(2);
    Assert.assertEquals(3,t.size());
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals("PrefixedText_" + count,((DataByteArray)pig_cf_map.get("prefixed_col_d")).toString());
    Assert.assertEquals(1,pig_cf_map.size());
    Assert.assertEquals(Integer.toString(count),col_a);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test merge inner join with two tables
 * @throws IOException
 */
@Test public void testMergeJoin() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.HBaseBinary);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("b = load 'hbase://" + TESTTABLE_2 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -caster HBaseBinaryConverter') as (rowKey:chararray,col_a:int, col_b:double, col_c:chararray);");
  pig.registerQuery("c = join a by rowKey, b by rowKey USING 'merge';");
  pig.registerQuery("d = ORDER c BY a::rowKey;");
  Iterator<Tuple> it=pig.openIterator("d");
  int count=0;
  LOG.info("MergeJoin Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey);
    Assert.assertEquals(count,col_a);
    Assert.assertEquals(count + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    String rowKey2=(String)t.get(4);
    int col_a2=(Integer)t.get(5);
    double col_b2=(Double)t.get(6);
    String col_c2=(String)t.get(7);
    Assert.assertEquals("00".substring((count + "").length()) + count,rowKey2);
    Assert.assertEquals(count,col_a2);
    Assert.assertEquals(count + 0.0,col_b2,1e-6);
    Assert.assertEquals("Text_" + count,col_c2);
    count++;
  }
  Assert.assertEquals(count,TEST_ROW_COUNT);
  LOG.info("MergeJoin done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * load from hbase test
 * @throws IOException
 */
@Test public void testLoadFromHBase() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  LOG.info("QUERY: " + "a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Object col_d=t.get(3);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertNull(col_d);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lt and gt (00&lt;key&lt;99)
 */
@Test public void testLoadWithParameters_2() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gt 00 -lt 99') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  int next=1;
  LOG.info("LoadFromHBaseWithParameters_2 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((next + "").length()) + next,rowKey);
    Assert.assertEquals(next,Integer.parseInt(col_a));
    Assert.assertEquals(next + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + next,col_c);
    count++;
    next++;
  }
  Assert.assertEquals(TEST_ROW_COUNT - 2,count);
  LOG.info("LoadFromHBaseWithParameters_2 Starting");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Load from hbase with parameters lte and gte (01<=key<=98)
 */
@Test public void testLoadWithParameters_1() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "','-loadKey -gte 01 -lte 98') as (rowKey,col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  int next=1;
  LOG.info("LoadFromHBaseWithParameters_1 Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    LOG.info("LoadFromHBase " + t);
    String rowKey=((DataByteArray)t.get(0)).toString();
    String col_a=((DataByteArray)t.get(1)).toString();
    String col_b=((DataByteArray)t.get(2)).toString();
    String col_c=((DataByteArray)t.get(3)).toString();
    Assert.assertEquals("00".substring((next + "").length()) + next,rowKey);
    Assert.assertEquals(next,Integer.parseInt(col_a));
    Assert.assertEquals(next + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + next,col_c);
    count++;
    next++;
  }
  Assert.assertEquals(TEST_ROW_COUNT - 2,count);
  LOG.info("LoadFromHBaseWithParameters_1 done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * load from hbase test without hbase:// prefix
 * @throws IOException
 */
@Test public void testBackwardsCompatibility() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  pig.registerQuery("a = load '" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ "') as (col_a, col_b, col_c);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("BackwardsCompatibility Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("BackwardsCompatibility done");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestImplicitSplit </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitInCoGroup() throws Exception {
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInfixArithmetic </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 + $1, $1;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first + first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivide() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 / $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(1.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiply() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 * $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first * first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 - $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(0.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobSubmission </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSort() throws Throwable {
  String query="a = load 'input';" + "b = order a by $0 parallel 100;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isGlobalSort()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSkewJoin() throws Throwable {
  String query="a = load 'input';" + "b = load 'input';" + "c = join a by $0, b by $0 using 'skewed' parallel 100;"+ "store c into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isSkewedJoin()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFullOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 full outer, b by $0;";
    }
 else {
      script+="c = join a by $0 full, b by $0;";
    }
    script+="d = order c by $1, $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 full outer, b by $0;";
      }
 else {
        script+="c = join a by $0 full, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRightOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(null,null,null,'evening')","(null,null,'good','morning')","('hello',1,'hello','world')"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 right outer, b by $0;";
    }
 else {
      script+="c = join a by $0 right, b by $0;";
    }
    script+="d = order c by $3;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 right outer, b by $0;";
      }
 else {
        script+="c = join a by $0 right, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeftOuterJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('hello',1,'hello','world')","('bye',2,null,null)","(null,3,null,null)"});
  for (int i=0; i < 2; i++) {
    String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); ";
    if (i == 0) {
      script+="c = join a by $0 left outer, b by $0;";
    }
 else {
      script+="c = join a by $0 left, b by $0;";
    }
    script+="d = order c by $1;";
    Util.buildLp(pigServer,script);
    if (i == 0) {
      Util.registerMultiLineQuery(pigServer,script);
      Iterator<Tuple> it=pigServer.openIterator("d");
      int counter=0;
      while (it.hasNext()) {
        assertEquals(expectedResults.get(counter++),it.next());
      }
      assertEquals(expectedResults.size(),counter);
      script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; ";
      if (i == 0) {
        script+="c = join a by $0 left outer, b by $0;";
      }
 else {
        script+="c = join a by $0 left, b by $0;";
      }
      try {
        Util.registerMultiLineQuery(pigServer,script);
      }
 catch (      Exception e) {
        PigException pe=LogUtils.getPigException(e);
        assertEquals(1105,pe.getErrorCode());
      }
    }
  }
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinLocal </h4><pre class="type-13 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonRegularOuterJoinFailure() throws Exception {
  String query="a = load 'a.txt' as (n:chararray, a:int); " + "b = load 'b.txt' as (n:chararray, m:chararray); ";
  String[] types=new String[]{"left","right","full"};
  String[] joinTypes=new String[]{"replicated","repl"};
  for (int i=0; i < types.length; i++) {
    for (int j=0; j < joinTypes.length; j++) {
      boolean errCaught=false;
      try {
        String q=query + "d = join a by $0 " + types[i]+ " outer, b by $0 using '"+ joinTypes[j]+ "';"+ "store d into 'output';";
        Util.buildLp(pigServer,q);
      }
 catch (      Exception e) {
        errCaught=true;
        assertTrue(e.getMessage().contains("does not support (right|full) outer joins"));
      }
      assertEquals(i == 0 ? false : true,errCaught);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testMultiOuterJoinFailure() throws Exception {
  String[] types=new String[]{"left","right","full"};
  String query="a = load 'a.txt' as (n:chararray, a:int);\n" + "b = load 'b.txt' as (n:chararray, m:chararray);\n" + "c = load 'c.txt' as (n:chararray, m:chararray);\n";
  for (int i=0; i < types.length; i++) {
    boolean errCaught=false;
    try {
      String q=query + "d = join a by $0 " + types[i]+ " outer, b by $0, c by $0;"+ "store d into 'output';";
      Util.buildLp(pigServer,q);
    }
 catch (    Exception e) {
      errCaught=true;
      assertTrue(e.getMessage().contains("mismatched input ',' expecting SEMI_COLON"));
    }
    assertTrue(errCaught);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJsonLoaderStorage </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonLoaderNull() throws IOException {
  Iterator<Tuple> tuples=loadJson(nullJson);
  int count=0;
  while (tuples.hasNext()) {
    Tuple tuple=tuples.next();
    assertEquals(null,tuple.get(0));
    assertEquals(null,tuple.get(1));
    assertEquals(null,tuple.get(2));
    assertEquals(null,tuple.get(3));
    assertEquals(null,tuple.get(4));
    assertEquals(null,tuple.get(5));
    assertEquals(null,tuple.get(6));
    assertEquals(null,tuple.get(7));
    assertEquals(null,tuple.get(8));
    assertEquals(null,tuple.get(9));
    assertEquals(null,tuple.get(10));
    assertEquals(null,tuple.get(11));
    assertEquals(null,tuple.get(12));
    count++;
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoader() throws IOException {
  Iterator<Tuple> tuples=loadJson(json);
  int count=0;
  while (tuples.hasNext()) {
    Tuple tuple=tuples.next();
    assertEquals(Boolean.class,tuple.get(0).getClass());
    assertEquals(Integer.class,tuple.get(1).getClass());
    assertEquals(Long.class,tuple.get(2).getClass());
    assertEquals(Float.class,tuple.get(3).getClass());
    assertEquals(Double.class,tuple.get(4).getClass());
    assertEquals(DateTime.class,tuple.get(5).getClass());
    assertEquals("2013-01-02T03:04:05.123+03:00",tuple.get(5).toString());
    assertEquals(DataByteArray.class,tuple.get(6).getClass());
    assertEquals(String.class,tuple.get(7).getClass());
    assertEquals(BigInteger.class,tuple.get(8).getClass());
    assertEquals(BigDecimal.class,tuple.get(9).getClass());
    assertTrue(tuple.get(10) instanceof Map);
    assertEquals(String.class,((Map)tuple.get(10)).get("a").getClass());
    assertTrue(tuple.get(11) instanceof Tuple);
    assertEquals(Integer.class,((Tuple)tuple.get(11)).get(0).getClass());
    assertTrue(tuple.get(12) instanceof DataBag);
    DataBag bag=(DataBag)tuple.get(12);
    assertEquals(3,bag.size());
    Iterator<Tuple> bagTuples=bag.iterator();
    while (bagTuples.hasNext()) {
      assertEquals(Integer.class,bagTuples.next().get(0).getClass());
    }
    count++;
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJsonStorageLimit() throws Exception {
  String outPath=getTempOutputPath();
  Data data=Storage.resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4));
  pigServer.registerQuery("data = load 'foo' using mock.Storage() as (id:int);");
  pigServer.registerQuery("data = order data by id;");
  pigServer.registerQuery("data = limit data 2;");
  pigServer.registerQuery("store data into '" + outPath + "' using JsonStorage();");
  Path p=new Path(outPath);
  FileSystem fs=FileSystem.get(p.toUri(),new Configuration());
  Reader r=new InputStreamReader(fs.open(Util.getFirstPartFile(p)));
  BufferedReader br=new BufferedReader(r);
  String line=null;
  int count=0;
  while ((line=br.readLine()) != null) {
    count++;
    assertEquals("{\"id\":" + count + "}",line);
  }
  assertEquals(2,count);
  br.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestKeyTypeDiscoveryVisitor </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullJoin() throws Exception {
  String[] inputData=new String[]{"\t7\t8","\t8\t9","1\t20\t30","1\t20\t40"};
  Util.createInputFile(cluster,"a.txt",inputData);
  inputData=new String[]{"7\t2","1\t5","1\t10"};
  Util.createInputFile(cluster,"b.txt",inputData);
  String script="a = load 'a.txt' as (x:int, y:int, z:int);" + "b = load 'b.txt' as (x:int, y:int);" + "b_group = group b by x;"+ "b_sum = foreach b_group generate flatten(group) as x, SUM(b.y) as clicks;"+ "a_group = group a by (x, y);"+ "a_aggs = foreach a_group generate flatten(group) as (x, y), SUM(a.z) as zs;"+ "join_a_b = join b_sum by x, a_aggs by x;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("join_a_b");
  Object[] results=new Object[]{1,15L,1,20,70L};
  Tuple output=it.next();
  assertFalse(it.hasNext());
  assertEquals(results.length,output.size());
  for (int i=0; i < output.size(); i++) {
    assertEquals(results[i],output.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLargeFile </h4><pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOrder() throws Exception {
  System.out.println("Running testOrder...");
  int N=0, Nplus1=0;
  pig.registerQuery("A = load " + fileName + ";");
  pig.registerQuery("B = order A by $0;");
  Iterator<Tuple> B=pig.openIterator("B");
  if (B.hasNext()) {
    N=DataType.toInteger(B.next().get(0));
  }
  while (B.hasNext()) {
    Nplus1=DataType.toInteger(B.next().get(0));
    assertTrue("Expecting Nplus [" + Nplus1 + "] to be greater than or equal to N ["+ N+ "]",Nplus1 >= N);
    N=Nplus1;
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLargeFile() throws Exception {
  System.out.println("Running testLargeFile...");
  pig.registerQuery("A = load " + fileName + ";");
  pig.registerQuery("A = group A by $0;");
  pig.store("A",tmpFile1,"BinStorage()");
  pig.registerQuery("B = foreach A generate group, COUNT($1);");
  Iterator<Tuple> B=pig.openIterator("B");
  while (B.hasNext()) {
    Tuple temp=B.next();
    int index=DataType.toInteger(temp.get(0));
    int value=DataType.toInteger(temp.get(1));
    System.out.println("COUNT [" + index + "] = "+ COUNT[index]+ " B["+ index+ "] = "+ value);
    assertEquals(COUNT[index].intValue(),value);
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDistinct() throws Exception {
  System.out.println("Running testDistinct...");
  pig.registerQuery("A = load " + fileName + ";");
  pig.registerQuery("B = distinct A;");
  Iterator<Tuple> B=pig.openIterator("B");
  Integer[] COUNT_Test=new Integer[max_rand];
  Integer[] COUNT_Data=new Integer[max_rand];
  for (int i=0; i < max_rand; i++) {
    COUNT_Test[i]=0;
    if (COUNT[i] > 0) {
      COUNT_Data[i]=1;
    }
 else {
      COUNT_Data[i]=0;
    }
  }
  while (B.hasNext()) {
    int temp=DataType.toInteger(B.next().get(0));
    COUNT_Test[temp]++;
  }
  for (int i=0; i < max_rand; i++) {
    assertEquals(COUNT_Test[i].intValue(),COUNT_Data[i].intValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLimitAdjuster </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void simpleTest() throws Exception {
  String INPUT_FILE="input";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("1\torange");
  w.println("2\tapple");
  w.println("3\tcoconut");
  w.println("4\tmango");
  w.println("5\tgrape");
  w.println("6\tpear");
  w.close();
  Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
  pig.registerQuery("a = load '" + INPUT_FILE + "' as (x:int, y:chararray);");
  pig.registerQuery("b = order a by x parallel 2;");
  pig.registerQuery("c = limit b 1;");
  pig.registerQuery("d = foreach c generate y;");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('orange')"});
  Iterator<Tuple> iter=pig.openIterator("d");
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoad </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextTuple() throws IOException {
  pc=servers[0].getPigContext();
  String curDir=System.getProperty("user.dir");
  String inpDir=curDir + File.separatorChar + "test/org/apache/pig/test/data/InputFiles/";
  Util.copyFromLocalToCluster(cluster,inpDir + "passwd","passwd");
  FileSpec inpFSpec=new FileSpec("passwd",new FuncSpec(PigStorage.class.getName(),new String[]{":"}));
  POLoad ld=GenPhyOp.topLoadOp();
  ld.setLFile(inpFSpec);
  ld.setPc(pc);
  DataBag inpDB=DefaultBagFactory.getInstance().newDefaultBag();
  BufferedReader br=new BufferedReader(new FileReader("test/org/apache/pig/test/data/InputFiles/passwd"));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] flds=line.split(":",-1);
    Tuple t=new DefaultTuple();
    for (    String fld : flds) {
      t.append((fld.compareTo("") != 0 ? new DataByteArray(fld.getBytes()) : null));
    }
    inpDB.add(t);
  }
  Tuple t=null;
  int size=0;
  for (Result res=ld.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=ld.getNextTuple()) {
    assertEquals(true,TestHelper.bagContains(inpDB,(Tuple)res.result));
    ++size;
  }
  assertEquals(true,size == inpDB.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctionsWithNulls() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    if (i % 10 == 0) {
      ps.println("");
    }
 else {
      ps.println(i);
    }
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=(Tuple)it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreFunction() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 10; i++) {
    ps.println(i + "\t" + i);
  }
  ps.close();
  String query="foreach (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') generate $0,$1;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  pig.store("asdf_id","frog",MyStorage.class.getName() + "()");
  InputStream is=FileLocalizer.open("frog",pig.getPigContext());
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  String line;
  int i=0;
  while ((line=br.readLine()) != null) {
    assertEquals(line,Integer.toString(i) + '-' + Integer.toString(i));
    i++;
  }
  br.close();
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefinedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerFunction("foo",new FuncSpec(MyApply.class.getName() + "('foo')"));
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten(foo($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator it=pig.openIterator("asdf_id");
  tmpFile.delete();
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=(Tuple)it.next();
    assertEquals("foo",t.get(0).toString());
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(count,MyStorage.COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocalRearrange </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple1() throws ExecException, PlanException {
  setUp1();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    String key=(String)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(1,val.size());
    Tuple actualVal=new DefaultTuple();
    actualVal.append(key);
    actualVal.append(val.get(0));
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    assertTrue(TestHelper.bagContains(db,actualVal));
    String inpKey=(String)actualVal.get(0);
    assertEquals(0,inpKey.compareTo((String)t.get(1)));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple2() throws ExecException, PlanException {
  setUp2();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    Tuple key=(Tuple)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(0,val.size());
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    val=key;
    assertTrue(TestHelper.bagContains(db,val));
    Tuple inpKey=TupleFactory.getInstance().newTuple(2);
    inpKey.set(0,val.get(0));
    inpKey.set(1,val.get(1));
    assertEquals(inpKey,(Tuple)t.get(1));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapReduce </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQualifiedFunctionsWithNulls() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    if (i % 10 == 0) {
      ps.println("");
    }
 else {
      ps.println(i);
    }
  }
  ps.close();
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten("+ MyApply.class.getName()+ "($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals(t.get(0).toString(),"Got");
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(MyStorage.COUNT,count);
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This test checks records that align perfectly on
 * bzip block boundaries and hdfs block boundaries
 */
@Test public void testBZip2Aligned() throws Throwable {
  int offsets[]={219642,219643,219644,552019,552020};
  for (int i=1; i < offsets.length; i++) {
    Properties props=new Properties();
    for (    Entry<Object,Object> entry : cluster.getProperties().entrySet()) {
      props.put(entry.getKey(),entry.getValue());
    }
    props.setProperty(MRConfiguration.MAX_SPLIT_SIZE,Integer.toString(offsets[i]));
    PigContext pigContext=new PigContext(cluster.getExecType(),props);
    PigServer pig=new PigServer(pigContext);
    pig.registerQuery("a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/bzipTest.bz2",pig.getPigContext()) + "';");
    Iterator<Tuple> it=pig.openIterator("a");
    int count=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      String s=t.get(0).toString();
      s=s.substring(0,7);
      assertEquals("Using blocksize " + offsets[i] + " problem with "+ t,count,Integer.parseInt(s,16));
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreFunction() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 10; i++) {
    ps.println(i + "\t" + i);
  }
  ps.close();
  String query="foreach (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "') generate $0,$1;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  pig.store("asdf_id","frog",MyStorage.class.getName() + "()");
  InputStream is=FileLocalizer.open("frog",pig.getPigContext());
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  String line;
  int i=0;
  while ((line=br.readLine()) != null) {
    assertEquals(line,Integer.toString(i) + '-' + Integer.toString(i));
    i++;
  }
  br.close();
  try {
    pig.deleteFile("frog");
  }
 catch (  Exception e) {
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefinedFunctions() throws Throwable {
  File tmpFile=File.createTempFile("test",".txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 1; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerFunction("foo",new FuncSpec(MyApply.class.getName() + "('foo')"));
  String query="foreach (group (load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' using "+ MyStorage.class.getName()+ "()) by "+ MyGroup.class.getName()+ "('all')) generate flatten(foo($1)) ;";
  System.out.println(query);
  pig.registerQuery("asdf_id = " + query);
  Iterator<Tuple> it=pig.openIterator("asdf_id");
  tmpFile.delete();
  Tuple t;
  int count=0;
  while (it.hasNext()) {
    t=it.next();
    assertEquals("foo",t.get(0).toString());
    Integer.parseInt(t.get(1).toString());
    count++;
  }
  assertEquals(count,MyStorage.COUNT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapSideCogroup </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3Way() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("E = LOAD '" + INPUT_FILE3 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1, E by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)})","(2,{(2,2),(2,1),(2,3)},{(2,1),(2,2),(2,3)},{(2,1),(2,2),(2,3)})","(3,{(3,2),(3,3),(3,1)},{(3,1),(3,2),(3,3)},{(3,1),(3,2),(3,3)})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyDeltaFile() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + EMPTY_FILE + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{})","(2,{(2,1),(2,2),(2,3)},{})","(3,{(3,1),(3,2),(3,3)},{})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimple() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)})","(2,{(2,2),(2,1),(2,3)},{(2,1),(2,2),(2,3)})","(3,{(3,3),(3,2),(3,1)},{(3,1),(3,2),(3,3)})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiSplits() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + ","+ INPUT_FILE4+ "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(4,{(4,1),(4,2),(4,3)},{(4,1),(4,2),(4,3)})","(5,{(5,2),(5,1),(5,3)},{(5,1),(5,2),(5,3)})","(6,{(6,1),(6,2),(6,3)},{})","(7,{(7,1),(7,2),(7,3)},{})","(8,{(8,1),(8,2),(8,3)},{})","(9,{(9,1),(9,2),(9,3)},{})","(1,{(1,1),(1,2),(1,3)},{})","(2,{(2,1),(2,2),(2,3)},{})","(3,{(3,3),(3,2),(3,1)},{(3,1),(3,2),(3,3)})"};
  assertEquals(9,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 9; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataWithNullKeys() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + DATA_WITH_NULL_KEYS + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + DATA_WITH_NULL_KEYS + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  String[] results=new String[]{"(,{(,1),(,2),(,3)},{})","(,{},{(,1),(,2),(,3)})","(2,{(2,3),(2,1),(2,2)},{(2,1),(2,2),(2,3)})","(3,{(3,3),(3,1),(3,2)},{(3,1),(3,2),(3,3)})"};
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  assertEquals(4,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 4; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogrpOnMultiKeys() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:chararray);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:chararray);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by (c1,c2) , B by (c1,c2) using 'merge' ;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"((1,1),{(1,1)},{(1,1)})","((1,2),{(1,2)},{(1,2)})","((1,3),{(1,3)},{(1,3)})","((2,1),{(2,1)},{(2,1)})","((2,2),{(2,2)},{(2,2)})","((2,3),{(2,3)},{(2,3)})","((3,1),{(3,1)},{(3,1)})","((3,2),{(3,2)},{(3,2)})","((3,3),{(3,3)},{(3,3)})"};
  assertEquals(9,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 9; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQuery </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1171() throws Exception {
  String INPUT_FILE="abc";
  String[] inputData={"1\tapple\t3","2\torange\t4","3\tpersimmon\t5"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("A = load '" + INPUT_FILE + "' as (a:long, b, c);");
  myPig.registerQuery("A1 = Order A by a desc;");
  myPig.registerQuery("A2 = limit A1 1;");
  myPig.registerQuery("B = load '" + INPUT_FILE + "' as (a:long, b, c);");
  myPig.registerQuery("B1 = Order B by a desc;");
  myPig.registerQuery("B2 = limit B1 1;");
  myPig.registerQuery("C = cross A2, B2;");
  Iterator<Tuple> iter=myPig.openIterator("C");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(3L,'persimmon',5,3L,'persimmon',5)"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1169() throws Exception {
  String INPUT_FILE="abc";
  String[] inputData={"1\t2\t3","2\t3\t4","3\t4\t5","5\t6\t7","6\t7\t8"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("A = load '" + INPUT_FILE + "' as (a:int, b, c);");
  myPig.registerQuery("A1 = Order A by a desc;");
  myPig.registerQuery("A2 = limit A1 2;");
  myPig.registerQuery("store A1 into 'output1';");
  myPig.registerQuery("store A2 into 'output2';");
  myPig.executeBatch();
  myPig.registerQuery("B = load 'output2' as (a:int, b, c);");
  Iterator<Tuple> iter=myPig.openIterator("B");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(6,7,8)","(5,6,7)"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1438() throws Exception {
  String INPUT_FILE="abc";
  String[] inputData={"1\t2\t3","2\t3\t4","1\t2\t3","2\t3\t4","1\t2\t3"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("A = load '" + INPUT_FILE + "' as (col1:int, col2:int, col3:int);");
  myPig.registerQuery("B1 = foreach A generate col1, col2;");
  myPig.registerQuery("B2 = foreach A generate col2, col3;");
  myPig.registerQuery("C1 = distinct B1;");
  myPig.registerQuery("C2 = distinct B2;");
  myPig.registerQuery("D1 = foreach C1 generate col1, col2;");
  myPig.registerQuery("D2 = foreach C2 generate col2, col3;");
  myPig.registerQuery("store D1 into 'output1';");
  myPig.registerQuery("store D2 into 'output2';");
  myPig.executeBatch();
  myPig.registerQuery("E = load 'output1' as (a:int, b:int);");
  Iterator<Tuple> iter=myPig.openIterator("E");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,2)","(2,3)"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
  myPig.registerQuery("E = load 'output2' as (a:int, b:int);");
  iter=myPig.openIterator("E");
  expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(2,3)","(3,4)"});
  counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1157() throws Exception {
  String INPUT_FILE="abc";
  String INPUT_FILE_1="abc";
  String[] inputData={"1\tapple\t3","2\torange\t4","3\tpersimmon\t5"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("A = load '" + INPUT_FILE + "' as (a:long, b, c);");
  myPig.registerQuery("A1 = FOREACH A GENERATE a;");
  myPig.registerQuery("B = GROUP A1 BY a;");
  myPig.registerQuery("C = load '" + INPUT_FILE_1 + "' as (x:long, y);");
  myPig.registerQuery("D = JOIN C BY x, B BY group USING 'replicated';");
  myPig.registerQuery("E = JOIN A BY a, D by x USING 'replicated';");
  Iterator<Tuple> iter=myPig.openIterator("E");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,'apple',3,1L,'apple',1L,{(1L)})","(2L,'orange',4,2L,'orange',2L,{(2L)})","(3L,'persimmon',5,3L,'persimmon',3L,{(3L)})"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1068() throws Exception {
  String INPUT_FILE="pig-1068.txt";
  String[] inputData={"10\tapple\tlogin\tjar","20\torange\tlogin\tbox","30\tstrawberry\tquit\tbot"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("logs = load '" + INPUT_FILE + "' as (ts:int, id:chararray, command:chararray, comments:chararray);");
  myPig.registerQuery("SPLIT logs INTO logins IF command == 'login', all_quits IF command == 'quit';");
  myPig.registerQuery("login_info = FOREACH logins { GENERATE id as id, comments AS client; };");
  myPig.registerQuery("logins_grouped = GROUP login_info BY (id, client);");
  myPig.registerQuery("count_logins_by_client = FOREACH logins_grouped " + "{ generate group.id AS id, group.client AS client, COUNT($1) AS count; };");
  myPig.registerQuery("all_quits_grouped = GROUP all_quits BY id; ");
  myPig.registerQuery("quits = FOREACH all_quits_grouped { GENERATE FLATTEN(all_quits); };");
  myPig.registerQuery("joined_session_info = COGROUP quits BY id, count_logins_by_client BY id;");
  Iterator<Tuple> iter=myPig.openIterator("joined_session_info");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('apple',{},{('apple','jar',1L)})","('orange',{},{('orange','box',1L)})","('strawberry',{(30,'strawberry','quit','bot')},{})"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryJiraPig1252() throws Exception {
  String INPUT_FILE="abc";
  String[] inputData={"1\t2\t3","2\t3\t4","3\t\t5","5\t6\t6","6\t\t7"};
  Util.createLocalInputFile(INPUT_FILE,inputData);
  myPig.setBatchOn();
  myPig.registerQuery("A = load '" + INPUT_FILE + "' as (col1, col2, col3);");
  myPig.registerQuery("B = foreach A generate (chararray) col1, " + "(chararray) ((col2 is not null) ?  " + "col2 : (col3 < 6 ? col3 : '')) as splitcond;");
  myPig.registerQuery("split B into C if splitcond !=  '', D if splitcond == '';");
  myPig.registerQuery("E = group C by splitcond;");
  myPig.registerQuery("F = foreach E { orderedData = order C by $1, $0; generate flatten(orderedData); };");
  Iterator<Tuple> iter=myPig.openIterator("F");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,2)","(2,3)","(3,5)","(5,6)"});
  int counter=0;
  while (iter.hasNext()) {
    assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryBasic </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that MultiQuery optimization won't use user's output for
 * ScalarExpression (and get empty output) at the end
 */
@Test public void testMultiQueryWithScalarExpression() throws Exception {
  System.out.println("===== multi-query with ScalarExpression =====");
  String[] inputData={"john","henry","adam"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("b = group a ALL;");
  myPig.registerQuery("c = foreach b generate COUNT(a) as count;");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("z = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("y = foreach z generate uname, c.count;");
  myPig.registerQuery("store y into 'output2';");
  List<ExecJob> jobs=myPig.executeBatch();
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
  myPig.registerQuery("aa = load 'output2' as (uname:chararray, cnt:int) ;");
  Iterator<Tuple> it=myPig.openIterator("aa");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(3,t.get(1));
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiQueryWithSplitInMapAndMultiMerge() throws Exception {
  String[] toClean={"tmwsimam-input.txt","foo1","foo2","foo3","foo4"};
  for (int j=0; j < toClean.length; j++) {
    Util.deleteFile(new PigContext(Util.getLocalTestMode(),new Properties()),toClean[j]);
  }
  String[] inputData={"1	a	b	e	f	i	j	m	n","2	a	b	e	f	i	j	m	n","3	c	d	g	h	k	l	o	p","4	c	d	g	h	k	l	o	p"};
  Util.createLocalInputFile("tmwsimam-input.txt",inputData);
  String query="A = LOAD 'tmwsimam-input.txt' " + "as (f0:chararray, f1:chararray, f2:chararray, f3:chararray, " + "f4:chararray, f5:chararray, f6:chararray, f7:chararray, f8:chararray); "+ "B = FOREACH A GENERATE f0, f1, f2, f3, f4;"+ "B1 = foreach B generate f0, f1, f2;"+ "C = GROUP B1 BY (f1, f2);"+ "STORE C into 'foo1' using BinStorage();"+ "B2 = FOREACH B GENERATE f0, f3, f4;"+ "E = GROUP B2 BY (f3, f4);"+ "STORE E into 'foo2'  using BinStorage();"+ "F = FOREACH A GENERATE f0, f5, f6, f7, f8;"+ "F1 = FOREACH F GENERATE f0, f5, f6;"+ "G = GROUP F1 BY (f5, f6);"+ "STORE G into 'foo3'  using BinStorage();"+ "F2  = FOREACH F GENERATE f0, f7, f8;"+ "I = GROUP F2 BY (f7, f8);"+ "STORE I into 'foo4'  using BinStorage();"+ "explain;";
  myPig.setBatchOn();
  Util.registerMultiLineQuery(myPig,query);
  myPig.executeBatch();
  String templateLoad="a = load 'foo' using BinStorage();";
  Map<Tuple,DataBag> expectedResults=new HashMap<Tuple,DataBag>();
  expectedResults.put((Tuple)Util.getPigConstant("('a','b')"),(DataBag)Util.getPigConstant("{('1','a','b'),('2','a','b')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('c','d')"),(DataBag)Util.getPigConstant("{('3','c','d'),('4','c','d')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('e','f')"),(DataBag)Util.getPigConstant("{('1','e','f'),('2','e','f')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('g','h')"),(DataBag)Util.getPigConstant("{('3','g','h'),('4','g','h')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('i','j')"),(DataBag)Util.getPigConstant("{('1','i','j'),('2','i','j')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('k','l')"),(DataBag)Util.getPigConstant("{('3','k','l'),('4','k','l')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('m','n')"),(DataBag)Util.getPigConstant("{('1','m','n'),('2','m','n')}"));
  expectedResults.put((Tuple)Util.getPigConstant("('o','p')"),(DataBag)Util.getPigConstant("{('3','o','p'),('4','o','p')}"));
  String[] outputDirs={"foo1","foo2","foo3","foo4"};
  for (int k=0; k < outputDirs.length; k++) {
    myPig.registerQuery(templateLoad.replace("foo",outputDirs[k]));
    Iterator<Tuple> it=myPig.openIterator("a");
    int numTuples=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      assertEquals(expectedResults.get(t.get(0)),t.get(1));
      numTuples++;
    }
    assertEquals(numTuples,2);
  }
  for (int j=0; j < toClean.length; j++) {
    Util.deleteFile(new PigContext(Util.getLocalTestMode(),new Properties()),toClean[j]);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3WithDifferentMapDataTypes3() throws Exception {
  System.out.println("===== multi-query phase 3 with different map datatypes (3) =====");
  myPig.setBatchOn();
  String[] inputData={"john\t20\t3.4","john\t25\t3.4","henry\t23\t3.9","adam\t54\t2.9","henry\t21\t3.9"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.registerQuery("a = load 'queryInput.txt' " + "as (name:chararray, age:int, gpa:double);");
  myPig.registerQuery("b = group a all;");
  myPig.registerQuery("c = foreach b generate group, COUNT(a);");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("d = group a by (name, gpa);");
  myPig.registerQuery("e = foreach d generate flatten(group), MIN(a.age);");
  myPig.registerQuery("store e into 'output2';");
  myPig.executeBatch();
  myPig.registerQuery("a = load 'output1' as (grp:chararray, cnt:long) ;");
  Iterator<Tuple> it=myPig.openIterator("a");
  assertEquals(Util.getPigConstant("('all', 5l)"),it.next());
  assertFalse(it.hasNext());
  myPig.registerQuery("a = load 'output2' as (name:chararray, gpa:double, age:int);");
  it=myPig.openIterator("a");
  int i=0;
  Map<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("john",(Tuple)Util.getPigConstant("('john',3.4,20)"));
  expectedResults.put("adam",(Tuple)Util.getPigConstant("('adam',2.9,54)"));
  expectedResults.put("henry",(Tuple)Util.getPigConstant("('henry',3.9,21)"));
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(expectedResults.get(t.get(0)),t);
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryLocal </h4><pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMultiStoreWithConfig() throws Exception {
  System.out.println("===== test multi-query with competing config =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid < 5;");
  myPig.registerQuery("c = filter a by uid > 5;");
  myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1' using "+ PigStorageWithConfig.class.getName()+ "('test.key1', 'a');");
  myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2' using "+ PigStorageWithConfig.class.getName()+ "('test.key2', 'b');");
  myPig.executeBatch();
  myPig.discardBatch();
  FileSystem fs=FileSystem.getLocal(new Configuration());
  BufferedReader reader=new BufferedReader(new InputStreamReader(fs.open(Util.getFirstPartFile(new Path("file:///" + TMP_DIR + "/Pig-TestMultiQueryLocal1")))));
  String line;
  while ((line=reader.readLine()) != null) {
    Assert.assertTrue(line.endsWith("a"));
  }
  reader=new BufferedReader(new InputStreamReader(fs.open(Util.getFirstPartFile(new Path("file:///" + TMP_DIR + "/Pig-TestMultiQueryLocal2")))));
  while ((line=reader.readLine()) != null) {
    Assert.assertTrue(line.endsWith("b"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPartitionFilterPushDown </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test PIG-1267
 * @throws Exception
 */
@Test public void testColNameMapping5() throws Exception {
  TestLoader.partFilter=null;
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('mrkt:chararray, a1:chararray, a2:chararray, srcid:int, bcookie:chararray', "+ "'srcid');"+ "b = load 'bar' using "+ TestLoader.class.getName()+ "('dstid:int, b1:int, b2:int, srcid:int, bcookie:chararray, mrkt:chararray',"+ "'srcid');"+ "a1 = filter a by srcid == 10;"+ "b1 = filter b by srcid == 20;"+ "c = join a1 by bcookie, b1 by bcookie;"+ "d = foreach c generate $4 as bcookie:chararray, "+ "$5 as dstid:int, $0 as mrkt:chararray;"+ "store d into 'out';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(q);
  String partFilter=TestLoader.partFilter.toString();
  Assert.assertTrue("(srcid == 20)".equals(partFilter) || "(srcid == 10)".equals(partFilter));
  int counter=0;
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Assert.assertTrue(!(iter.next() instanceof LOFilter));
    counter++;
  }
  Assert.assertEquals(counter,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-13 type-7 type-8 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDistinct() throws Exception {
  String testQuery="a = load 'd.txt' as (id, v1, v2);" + "b = load 'd.txt' as (id, v1, v2);" + "c = distinct a;"+ "d = union b, c;"+ "e = foreach d generate id, v1;"+ "store e into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(testQuery);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Operator o=iter.next();
    LogicalRelationalOperator lro=(LogicalRelationalOperator)o;
    if (lro == null || lro.getAlias() == null)     continue;
    if (lro.getAlias().equals("d")) {
      assertNotNull(lro.getSchema());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanImplicitSplit </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testImplicitSplitInCoGroup() throws Exception {
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  pigServer.explain("f",System.out);
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanRule </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodeMatch() throws FrontendException {
  Operator f5=new OP_Filter("f5",plan);
  Operator f6=new OP_Filter("f6",plan);
  Operator s5=new OP_Store("s5",plan);
  Operator s6=new OP_Store("s6",plan);
  plan.add(f5);
  plan.add(f6);
  plan.add(s5);
  plan.add(s6);
  plan.connect(f5,s5);
  plan.connect(f6,s6);
  plan.connect(join,f5);
  plan.connect(join,f6);
  OperatorPlan pattern=new SillyPlan();
  Operator s1=new OP_Join("mmm1",pattern);
  Operator s2=new OP_Filter("mmm2",pattern);
  Operator s3=new OP_Filter("mmm3",pattern);
  Operator s4=new OP_Filter("mmm4",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.add(s4);
  pattern.connect(s1,s2);
  pattern.connect(s1,s3);
  pattern.connect(s1,s4);
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(3,l.get(0).getSinks().size());
  assertEquals(4,l.get(0).size());
  Operator m1, m2;
  m1=l.get(0).getSources().get(0);
  assertEquals("j1",m1.getName());
  for (int i=0; i < 3; i++) {
    m2=l.get(0).getSinks().get(i);
    assertTrue(m2.getName().equals("f1") || m2.getName().equals("f5") || m2.getName().equals("f6"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNull </h4><pre class="type-13 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testOperator() throws ExecException {
  int TRIALS=10;
  byte[] types=DataType.genAllTypes();
  Map<Byte,String> map=DataType.genTypeToNameMap();
  long t1=System.currentTimeMillis();
  for (  byte b : types) {
    for (int i=0; i < TRIALS; i++) {
      assertTrue(test(b));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNullConstant </h4><pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testExplicitCast() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate (int)null, (double)null, (chararray)null, (map[])null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testArithExpressions() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate x + null, x * null, x / null, x - null, null % x, " + "y + null, y * null, y / null, y - null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 9; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinCond() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate (2 > 1? null : 1), ( 2 < 1 ? null : 1), (2 > 1 ? 1 : null), ( 2 < 1 ? 1 : null);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Object[] result=new Object[]{null,1,1,null};
  for (int i=0; i < 4; i++) {
    assertEquals(result[i],t.get(i));
  }
  pigServer.registerQuery("b = foreach a generate (null is null ? 1 : 2), ( null is not null ? 2 : 1);");
  it=pigServer.openIterator("b");
  t=it.next();
  for (int i=0; i < 2; i++) {
    assertEquals(1,t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testForeachGenerate() throws ExecException, IOException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double);");
  pigServer.registerQuery("b = foreach a generate x, null, y, null;");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  Object[] result=new Object[]{10,null,11.0,null};
  for (int i=0; i < 4; i++) {
    assertEquals(result[i],t.get(i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOuterJoin() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo_left",tuple(10,"will_join"),tuple(11,"will_not_join"));
  data.set("foo_right",tuple(10,"will_join"),tuple(12,"will_not_join"));
  pigServer.registerQuery("a = load 'foo_left' using mock.Storage() as (x:int, y:chararray);");
  pigServer.registerQuery("b = load 'foo_right' using mock.Storage() as (u:int, v:chararray);");
  pigServer.registerQuery("c = cogroup a by x, b by u;");
  pigServer.registerQuery("d = foreach c generate flatten((SIZE(a) == 0 ? null: a)), flatten((SIZE(b) == 0 ? null : b));");
  Iterator<Tuple> it=pigServer.openIterator("d");
  Object[][] results=new Object[][]{{10,"will_join",10,"will_join"},{11,"will_not_join",null},{null,12,"will_not_join"}};
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Object[] result=results[i++];
    assertEquals(result.length,t.size());
    for (int j=0; j < result.length; j++) {
      assertEquals(result[j],t.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testConcatAndSize() throws IOException, ExecException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate SIZE(null), CONCAT(str, null), " + "CONCAT(null, str);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple t=it.next();
  for (int i=0; i < 3; i++) {
    assertNull(t.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOrderBy </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByGroup() throws Exception {
  tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < 100; i++) {
    ps.println(i);
  }
  ps.close();
  pig.registerQuery("a = load 'file:" + tmpFile + "' as (f1:int);");
  pig.registerQuery("b = group a by $0;");
  pig.registerQuery("c = order b by group;");
  Iterator<Tuple> iter=pig.openIterator("c");
  int count=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(count,tuple.get(0));
    count++;
  }
  assertEquals(count,100);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByDateTimeColumn() throws Exception {
  File tmpFile=genDataSetFileForOrderByDateTimeColumn();
  List<Tuple> expectedResults=new ArrayList<Tuple>();
  expectedResults.add(Util.buildTuple("value3",null));
  expectedResults.add(Util.buildTuple("value4",null));
  expectedResults.add(Util.buildTuple("value10",null));
  expectedResults.add(Util.buildTuple("value2",new DateTime("1970-01-01T00:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value6",new DateTime("1970-01-01T00:00:01.000Z")));
  expectedResults.add(Util.buildTuple("value7",new DateTime("1970-01-01T00:00:01.000Z")));
  expectedResults.add(Util.buildTuple("value1",new DateTime("1970-01-01T00:01:00.000Z")));
  expectedResults.add(Util.buildTuple("value5",new DateTime("1970-01-01T01:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value8",new DateTime("1970-01-02T00:00:00.000Z")));
  expectedResults.add(Util.buildTuple("value9",new DateTime("1970-02-01T00:00:00.000Z")));
  pig.registerQuery("blah = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' as (data:chararray, test:datetime);");
  pig.registerQuery("ordered = order blah by test;");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("ordered");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrderByBooleanColumn() throws Exception {
  File tmpFile=genDataSetFileForOrderByBooleanColumn();
  List<Tuple> expectedResults=new ArrayList<Tuple>();
  expectedResults.add(Util.buildTuple("value3",null));
  expectedResults.add(Util.buildTuple("value4",null));
  expectedResults.add(Util.buildTuple("value10",null));
  expectedResults.add(Util.buildTuple("value2",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value6",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value7",Boolean.FALSE));
  expectedResults.add(Util.buildTuple("value1",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value5",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value8",Boolean.TRUE));
  expectedResults.add(Util.buildTuple("value9",Boolean.TRUE));
  pig.registerQuery("blah = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "' as (data:chararray, test:boolean);");
  pig.registerQuery("ordered = order blah by test;");
  Iterator<Tuple> expectedItr=expectedResults.iterator();
  Iterator<Tuple> actualItr=pig.openIterator("ordered");
  while (expectedItr.hasNext() && actualItr.hasNext()) {
    Tuple expectedTuple=expectedItr.next();
    Tuple actualTuple=actualItr.next();
    assertEquals(expectedTuple,actualTuple);
  }
  assertEquals(expectedItr.hasNext(),actualItr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOBinCond </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithFloat() throws ExecException, PlanException {
  bag=getBag(DataType.FLOAT);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.FLOAT,new Float(1.0f));
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    testHelper.getPlan().attachInput(t);
    Float value=(Float)t.get(0);
    int expected=(value.floatValue() == 1.0f) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPOBinCondWithBoolean() throws ExecException, PlanException {
  bag=getBag(DataType.BOOLEAN);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.BOOLEAN,Boolean.TRUE);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    testHelper.getPlan().attachInput(t);
    Boolean value=(Boolean)t.get(0);
    int expected=(value.booleanValue() == true) ? 1 : 0;
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int actual=result.intValue();
    assertEquals(expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOCast </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBooleanToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextBoolean());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=(Boolean)t.get(0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Boolean)t.get(0)) ? Integer.valueOf(1) : Integer.valueOf(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Boolean)t.get(0)) ? Long.valueOf(1L) : Long.valueOf(0L);
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Boolean)t.get(0)) ? Float.valueOf(1.0F) : Float.valueOf(0.0F);
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Boolean)t.get(0)) ? Double.valueOf(1.0D) : Double.valueOf(0.0D);
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Boolean)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Boolean)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BAG);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataBag b=(DataBag)t.get(0);
    Result res=op.getNextDataBag();
    assertEquals(b,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:float)}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Float);
        assertTrue(((Float)(expectedBagTuple.get(1))).floatValue() == (Float)(convertedBagTuple.get(1)));
      }
    }
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Integer);
        assertTrue(((Integer)(expectedBagTuple.get(1))) == (Integer)(convertedBagTuple.get(1)));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFloatToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0F : r.nextFloat());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.FLOAT);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Float)t.get(0)) != 0.0F);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Float)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Float)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Float)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Float)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Float)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Float)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Float)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float result=(Float)op.getNextFloat().result;
      assertEquals(null,result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0L : r.nextLong());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.LONG);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Long)t.get(0)) != 0L);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Long)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Long)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Long)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Long)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(t.get(0));
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Long)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Long)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0 : r.nextInt());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.INTEGER);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf((Integer)t.get(0) != 0);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=(Integer)t.get(0);
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Integer)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Integer)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Integer)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Integer)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Integer)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Integer)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? 0.0D : r.nextDouble());
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DOUBLE);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=Boolean.valueOf(((Double)t.get(0)) != 0.0D);
    Result res=op.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(b,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=((Double)t.get(0)).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=((Double)t.get(0)).floatValue();
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=((Double)t.get(0)).longValue();
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=((Double)t.get(0)).doubleValue();
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=new DateTime(((Double)t.get(0)).longValue());
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((Double)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((Double)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateTimeToOther() throws IOException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i == 0 ? new DateTime(0L) : new DateTime(r.nextLong()));
    bag.add(t);
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  LoadFunc load=new TestLoader();
  op.setFuncSpec(new FuncSpec(load.getClass().getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.DATETIME);
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Boolean b=null;
    Result res=op.getNextBoolean();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Integer i=new Long(((DateTime)t.get(0)).getMillis()).intValue();
    Result res=op.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(i,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Float f=new Float(Long.valueOf(((DateTime)t.get(0)).getMillis()).floatValue());
    Result res=op.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(f,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Long l=new Long(((DateTime)t.get(0)).getMillis());
    Result res=op.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(l,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Double d=new Double(Long.valueOf(((DateTime)t.get(0)).getMillis()).doubleValue());
    Result res=op.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(d,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DateTime dt=(DateTime)t.get(0);
    Result res=op.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dt,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDateTime();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dt,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    String str=((DateTime)t.get(0)).toString();
    Result res=op.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(str,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(str,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataByteArray dba=new DataByteArray(((DateTime)t.get(0)).toString().getBytes());
    Result res=op.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(dba,res.result);
    }
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataByteArray();
    if (res.returnStatus == POStatus.STATUS_OK)     assertEquals(dba,res.result);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextMap();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextTuple();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
{
    planToTestBACasts.attachInput(dummyTuple);
    try {
      opWithInputTypeAsBA.getNextDataBag();
    }
 catch (    Exception e) {
      assertEquals(ExecException.class,e.getClass());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullToOther() throws PlanException, ExecException {
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=TupleFactory.getInstance().newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BOOLEAN);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Boolean result=(Boolean)op.getNextBoolean().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.INTEGER);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.FLOAT);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer result=(Integer)op.getNextInteger().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DOUBLE);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double result=(Double)op.getNextDouble().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.DATETIME);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      DateTime result=(DateTime)op.getNextDateTime().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.CHARARRAY);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      String result=(String)op.getNextString().result;
      assertEquals(null,result);
    }
  }
  prj.setResultType(DataType.BYTEARRAY);
  TupleFactory tf=TupleFactory.getInstance();
{
    Tuple t=tf.newTuple();
    t.append(new DataByteArray((new Integer(r.nextInt())).toString().getBytes()));
    plan.attachInput(t);
    if (t.get(0) == null) {
      DataByteArray result=(DataByteArray)op.getNextString().result;
      assertEquals(null,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testValueTypesChanged() throws IOException {
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < MAX; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    if (i % 6 == 0)     t.append(r.nextBoolean());
    if (i % 6 == 1)     t.append(r.nextInt());
    if (i % 6 == 2)     t.append(r.nextLong());
    if (i % 6 == 3)     t.append(r.nextDouble());
    if (i % 6 == 4)     t.append(r.nextFloat());
    if (i % 6 == 5)     t.append(r.nextLong());
    bag.add(t);
  }
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    planToTestBACasts.attachInput(t);
    Object toCast=t.get(0);
    Boolean b=DataType.toBoolean(toCast);
    Result res=opWithInputTypeAsBA.getNextBoolean();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(b,res.result);
    }
    Integer i=DataType.toInteger(toCast);
    res=opWithInputTypeAsBA.getNextInteger();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(i,res.result);
    }
    Long l=DataType.toLong(toCast);
    res=opWithInputTypeAsBA.getNextLong();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(l,res.result);
    }
    Float f=DataType.toFloat(toCast);
    res=opWithInputTypeAsBA.getNextFloat();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(f,res.result);
    }
    Double d=DataType.toDouble(toCast);
    res=opWithInputTypeAsBA.getNextDouble();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(d,res.result);
    }
    if (!(toCast instanceof Boolean)) {
      DateTime dt=DataType.toDateTime(toCast);
      res=opWithInputTypeAsBA.getNextDateTime();
      if (res.returnStatus == POStatus.STATUS_OK) {
        assertEquals(dt,res.result);
      }
    }
    String s=DataType.toString(toCast);
    res=opWithInputTypeAsBA.getNextString();
    if (res.returnStatus == POStatus.STATUS_OK) {
      assertEquals(s,res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOGenerate </h4><pre class="type-13 type-7 type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testJoin() throws Exception {
  ExpressionOperator prj1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  ExpressionOperator prj2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  prj1.setResultType(DataType.BAG);
  prj2.setResultType(DataType.BAG);
  List<Boolean> toBeFlattened=new LinkedList<Boolean>();
  toBeFlattened.add(true);
  toBeFlattened.add(true);
  PhysicalPlan plan1=new PhysicalPlan();
  plan1.add(prj1);
  PhysicalPlan plan2=new PhysicalPlan();
  plan2.add(prj2);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  inputs.add(plan1);
  inputs.add(plan2);
  PhysicalOperator poGen=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toBeFlattened);
  for (  Tuple t : cogroup) {
    poGen.attachInput(t);
    Result output=poGen.getNextTuple();
    while (output.result != null && output.returnStatus != POStatus.STATUS_EOP) {
      Tuple tObtained=(Tuple)output.result;
      assertTrue(tObtained.get(0).toString().equals(tObtained.get(2).toString()));
      output=poGen.getNextTuple();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOMapLookUp </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapLookUp() throws PlanException, ExecException {
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  POMapLookUp op=new POMapLookUp(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(op);
  plan.add(prj);
  plan.connect(prj,op);
  for (int i=0; i < 10; i++) {
    map=GenRandomData.genRandMap(r,10);
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(map);
    for (    Map.Entry<String,Object> e : map.entrySet()) {
      op.setLookUpKey(e.getKey());
      plan.attachInput(t);
      Result res=op.getNextMap();
      assertEquals(e.getValue(),res.result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPONegative </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPONegType() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  File f=Util.createInputFile("tmp","",new String[]{"a","b","c"});
  pig.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(f.toString(),pig.getPigContext())) + "';");
  pig.registerQuery("b = foreach a generate SIZE(-1);");
  Iterator<Tuple> it=pig.openIterator("b");
  int i=0;
  while (it.hasNext()) {
    assertEquals(1L,it.next().get(0));
    i++;
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegLongAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Long output=(Long)pn.getNextLong().result;
      assertNull(output);
    }
 else {
      Long expected=-(Long)t.get(0);
      long output=(Long)pn.getNextLong().result;
      assertEquals(expected.longValue(),output);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegFloatAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float output=(Float)pn.getNextFloat().result;
      assertNull(output);
    }
 else {
      Float expected=-(Float)t.get(0);
      Float output=(Float)pn.getNextFloat().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAgg </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill1() throws Exception {
  Result res;
  for (long i=1; i <= 15; i++) {
    Tuple t=tuple(1,tuple(i));
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  assertFalse(spilled.isDone());
  res=partAggOp.getNextTuple();
  assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  expectedValues.add(tuple(1,tuple(120L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  parentPlan.endOfAllInput=true;
  res=partAggOp.getNextTuple();
  do {
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertTrue(expectedValues.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill2() throws Exception {
  Result res=null;
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  for (long i=1; i <= 2001; i++) {
    Tuple t=tuple(i,tuple(i));
    expectedValues.add(t);
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  long i=0;
  res=partAggOp.getNextTuple();
  do {
    assertFalse(spilled.isDone());
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    i++;
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertEquals(2002,i);
  assertTrue(expectedValues.isEmpty());
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGroupAll() throws Exception {
  createPOPartialPlan(1,true);
  Result res;
  for (long i=1; i <= 10010; i++) {
    Tuple t=tuple("all",tuple(i));
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  parentPlan.endOfAllInput=true;
  res=partAggOp.getNextTuple();
  assertEquals(tuple("all",tuple(50105055L)),res.result);
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  res=partAggOp.getNextTuple();
  assertEquals(POStatus.STATUS_EOP,res.returnStatus);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscaping() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputEscape.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult2.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMacroDef() throws Exception {
  log.info("Starting test testMacroDef() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input6.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult6.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileComboDuplicate() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFileDuplicates.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdnameAsParamDeclare() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputCmdnameAsParamDeclare.pig","sh \\$cmd.sh \\$date","\\$cmd.bat \\$date",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSameParamInMultipleFiles() throws Exception {
  log.info("Starting test testSameParamInMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile3.txt",basedir + "/ConfFile2.txt",basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamCurlySyntax() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input7.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult7.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParam() throws Exception {
  log.info("Starting test testCmdlineParam() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamPriortoDeclare() throws Exception {
  log.info("Starting test testCmdlineParamPriortoDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"param='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultCmdLnPriorDeclare.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionInFuncArgs() throws Exception {
  log.info("Starting test testSubstitutionInFuncArgs()");
  final String queryString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": $debug,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"$name\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  final String expectedString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": 5,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"TestRecord\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(queryString.getBytes("UTF-8"))));
  pigOStream=new FileWriter(basedir + "/output26.pig");
  String[] arg={"debug = '5'","name = 'TestRecord'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output26.pig");
  InputStream expected=new ByteArrayInputStream(expectedString.getBytes("UTF-8"));
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(expected));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareDefaultComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDefault.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexVals() throws Exception {
  log.info("Starting test testComplexVals() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input5.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"loadfile = /user/pig/tests/data/singlefile/textdoc.txt"};
  String[] argFiles={basedir + "/ConfFileComplexVal.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult3.txt");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithDollarSign() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDollarSign.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"filter=\"($0 == 'x') and ($1 == 'y')\""};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDollarSign.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommentWithParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputComment.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultComment.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamWithInlineCmd() throws Exception {
  log.info("Starting test testCmdlineParamWithInlineCmd() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=`perl -e \"print qq@20080228\\n20070101@\" | head -n 1`"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleCmdlineParam() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='092487'","date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand() throws Exception {
  log.info("Starting test testShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/input4.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDefault.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParamsFromMultipleFiles() throws Exception {
  log.info("Starting test testFileParamsFromMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt",basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinValue() throws Exception {
  log.info("Starting test  testSubstitutionWithinValue()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputSubstitutionWithinValue.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsinSingleLine() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstituteWithinLiteral() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParam() throws Exception {
  log.info("Starting test  testFileParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeclareScope() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleDeclares.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultMulDecs.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoVars() throws Exception {
  log.info("Starting test testNoVars() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputNoVars.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/inputNoVars.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinShellCommand() throws Exception {
  log.info("Starting test testSubstitutionWithinShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputSubstitutionWithinShellCommand.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsFromSingleFile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileSameParamMultipleTimes.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigContext </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportList() throws Exception {
  String FILE_SEPARATOR=System.getProperty("file.separator");
  File tmpDir=File.createTempFile("test","");
  tmpDir.delete();
  tmpDir.mkdir();
  File udf1Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf1");
  udf1Dir.mkdirs();
  File udf2Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf2");
  udf2Dir.mkdirs();
  String udf1Src=new String("package com.xxx.udf1;\n" + "import java.io.IOException;\n" + "import org.apache.pig.EvalFunc;\n"+ "import org.apache.pig.data.Tuple;\n"+ "public class TestUDF1 extends EvalFunc<Integer>{\n"+ "public Integer exec(Tuple input) throws IOException {\n"+ "return 1;}\n"+ "}");
  String udf2Src=new String("package com.xxx.udf2;\n" + "import org.apache.pig.builtin.PigStorage;\n" + "public class TestUDF2 extends PigStorage { }\n");
  JavaCompilerHelper javaCompilerHelper=new JavaCompilerHelper();
  javaCompilerHelper.compile(tmpDir.getAbsolutePath(),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf1.TestUDF1",udf1Src),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf2.TestUDF2",udf2Src));
  String jarName="TestUDFJar.jar";
  String jarFile=tmpDir.getAbsolutePath() + FILE_SEPARATOR + jarName;
  int status=Util.executeJavaCommand("jar -cf " + jarFile + " -C "+ tmpDir.getAbsolutePath()+ " "+ "com");
  assertEquals(0,status);
  Util.resetStateForExecModeSwitch();
  PigContext localPigContext=new PigContext(cluster.getExecType(),properties);
  localPigContext.getProperties().setProperty("pig.additional.jars",jarFile);
  PigServer pigServer=new PigServer(localPigContext);
  PigContext.initializeImportList("com.xxx.udf1:com.xxx.udf2.");
  ArrayList<String> importList=PigContext.getPackageImportList();
  assertEquals(6,importList.size());
  assertEquals("",importList.get(0));
  assertEquals("com.xxx.udf1.",importList.get(1));
  assertEquals("com.xxx.udf2.",importList.get(2));
  assertEquals("java.lang.",importList.get(3));
  assertEquals("org.apache.pig.builtin.",importList.get(4));
  assertEquals("org.apache.pig.impl.builtin.",importList.get(5));
  Object udf=PigContext.instantiateFuncFromSpec("TestUDF1");
  assertTrue(udf.getClass().toString().endsWith("com.xxx.udf1.TestUDF1"));
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  tmpFile.delete();
  String clusterTmpPath=Util.removeColon(tmpFile.getCanonicalPath());
  String localInput[]=new String[LOOP_COUNT];
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    localInput[i]=Integer.toString(rand);
  }
  Util.createInputFile(cluster,clusterTmpPath,localInput);
  FileLocalizer.deleteTempFiles();
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterTmpPath) + "' using TestUDF2() AS (num:chararray);");
  pigServer.registerQuery("B = foreach A generate TestUDF1(num);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.get(0) instanceof Integer);
    assertEquals(Integer.valueOf(1),(Integer)t.get(0));
  }
  Util.deleteFile(cluster,clusterTmpPath);
  Util.deleteDirectory(tmpDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigRunner </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void MQDepJobFailedTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (name:chararray, a1:int, a2:int);");
  w.println("store A into '" + OUTPUT_FILE_2 + "';");
  w.println("B = FOREACH A GENERATE org.apache.pig.test.utils.UPPER(name);");
  w.println("C= order B by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    Iterator<JobStats> iter=stats.getJobGraph().iterator();
    while (iter.hasNext()) {
      JobStats js=iter.next();
      if (execType.equals("tez")) {
        assertEquals(js.getState().name(),"FAILED");
      }
 else {
        if (js.getState().name().equals("FAILED")) {
          List<Operator> ops=stats.getJobGraph().getSuccessors(js);
          for (          Operator op : ops) {
            assertEquals(((JobStats)op).getState().toString(),"UNKNOWN");
          }
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTempFile() throws Exception {
  PigContext context=new PigContext(Util.getLocalTestMode(),new Properties());
  context.connect();
  for (int i=0; i < 100; i++) {
    String file=FileLocalizer.getTemporaryPath(context).toString();
    assertTrue("not a temp file: " + file,PigStatsUtil.isTempFile(file));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigScriptParser </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefineUDF() throws Exception {
  PigServer ps=new PigServer(ExecType.LOCAL);
  String inputData[]={"dshfdskfwww.xyz.com/sportsjoadfjdslpdshfdskfwww.xyz.com/sportsjoadfjdsl","kas;dka;sd","jsjsjwww.xyz.com/sports","jsdLSJDcom/sports","wwwJxyzMcom/sports"};
  File f=Util.createFile(inputData);
  String[] queryLines=new String[]{"define minelogs org.apache.pig.test.RegexGroupCount('www\\\\.xyz\\\\.com/sports');","A = load '" + Util.generateURI(f.getAbsolutePath(),ps.getPigContext()) + "'  using PigStorage() as (source : chararray);","B = foreach A generate minelogs(source) as sportslogs;"};
  for (  String line : queryLines) {
    ps.registerQuery(line);
  }
  Iterator<Tuple> it=ps.openIterator("B");
  int[] expectedResults=new int[]{2,0,1,0,0};
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals(expectedResults[i++],t.get(0));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParamSubstitution() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  Map<String,String> params=new HashMap<String,String>();
  params.put("input","test/org/apache/pig/test/data/passwd");
  File scriptFile=Util.createFile(new String[]{"a = load '$input' using PigStorage(':');"});
  pig.registerScript(scriptFile.getAbsolutePath(),params);
  Iterator<Tuple> iter=pig.openIterator("a");
  int index=0;
  List<Tuple> expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  List<String> paramFile=new ArrayList<String>();
  paramFile.add(Util.createFile(new String[]{"input=test/org/apache/pig/test/data/passwd2"}).getAbsolutePath());
  pig.registerScript(scriptFile.getAbsolutePath(),paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd2",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(scriptFile.getAbsolutePath(),params,paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRegisterScriptFromStream() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  Map<String,String> params=new HashMap<String,String>();
  params.put("input","test/org/apache/pig/test/data/passwd");
  String script="a = load '$input' using PigStorage(':');";
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),params);
  Iterator<Tuple> iter=pig.openIterator("a");
  int index=0;
  List<Tuple> expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  List<String> paramFile=new ArrayList<String>();
  paramFile.add(Util.createFile(new String[]{"input=test/org/apache/pig/test/data/passwd2"}).getAbsolutePath());
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd2",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
  pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")),params,paramFile);
  iter=pig.openIterator("a");
  index=0;
  expectedTuples=Util.readFile2TupleList("test/org/apache/pig/test/data/passwd",":");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    assertEquals(tuple.get(0).toString(),expectedTuples.get(index).get(0).toString());
    index++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaConversion2() throws Exception {
  pig.registerQuery("A = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);");
  pig.registerQuery("B = group A by f1;");
  Schema origSchema=pig.dumpSchema("B");
  ResourceSchema rs1=new ResourceSchema(origSchema);
  pig.registerQuery("STORE B into '" + datadir + "cout' using PigStorage('\\t', '-schema');");
  pig.registerQuery("C = LOAD '" + datadir + "cout' using PigStorage('\\t', '-schema');");
  Schema genSchema=pig.dumpSchema("C");
  ResourceSchema rs2=new ResourceSchema(genSchema);
  Assert.assertTrue("generated schema equals original",ResourceSchema.equals(rs1,rs2));
  pig.registerQuery("C1 = LOAD '" + datadir + "cout' as (a0:chararray, A: {t: (f1:chararray, f2:int) } );");
  pig.registerQuery("D = foreach C1 generate a0, SUM(A.f2);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A',23L)","('B',7L)","('C',11L)","('D',10L)"});
  Iterator<Tuple> iter=pig.openIterator("D");
  int counter=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockBoundary() throws ExecException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  Properties properties=cluster.getProperties();
  Properties props=new Properties();
  for (  Entry<Object,Object> entry : properties.entrySet()) {
    props.put(entry.getKey(),entry.getValue());
  }
  props.setProperty(MRConfiguration.MAX_SPLIT_SIZE,"20");
  Util.resetStateForExecModeSwitch();
  PigServer pigServer=new PigServer(cluster.getExecType(),props);
  String[] inputs={"abcdefgh1","abcdefgh2","abcdefgh3","abcdefgh4","abcdefgh5","abcdefgh6","abcdefgh7","abcdefgh8","abcdefgh9"};
  String[] expected={"(abcdefgh1)","(abcdefgh2)","(abcdefgh3)","(abcdefgh4)","(abcdefgh5)","(abcdefgh6)","(abcdefgh7)","(abcdefgh8)","(abcdefgh9)"};
  System.setProperty("pig.overrideBlockSize","20");
  String INPUT_FILE="tmp.txt";
  try {
    PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
    for (    String s : inputs) {
      w.println(s);
    }
    w.close();
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pigServer.registerQuery("a = load '" + INPUT_FILE + "';");
    Iterator<Tuple> iter=pigServer.openIterator("a");
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expected[counter++].toString(),iter.next().toString());
    }
    assertEquals(expected.length,counter);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
 finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
    cluster.shutDown();
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigStorageSchemaWithOverwrite() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);";
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A',1L)","('B',2L)","('C',3L)","('D',2L)","('A',5L)","('B',5L)","('C',8L)","('A',8L)","('D',8L)","('A',9L)"});
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage(',')");
  pig.store("a",datadir + "aout","PigStorage(',', '--overwrite true')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage(',');");
  Iterator<Tuple> iter=pig.openIterator("b");
  int counter=0;
  while (iter.hasNext()) {
    String tuple=iter.next().toString();
    Assert.assertEquals(expectedResults.get(counter++).toString(),tuple);
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPigStorageSourceTagValue() throws Exception {
  final String storeFileName="part-m-00000";
  pigContext.connect();
  String query="a = LOAD '" + datadir + "' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile');");
  pig.registerQuery("c = foreach b generate INPUT_FILE_NAME;");
  Iterator<Tuple> iter=pig.openIterator("c");
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    String inputFileName=(String)tuple.get(0);
    assertEquals("tagFile value must be part-m-00000",inputFileName,storeFileName);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaConversion() throws Exception {
  Util.createLocalInputFile(datadir + "originput2",new String[]{"1","2","3","2","5","5","8","8","8","9"});
  pig.registerQuery("A = LOAD '" + datadir + "originput2' using PigStorage('\\t') "+ "as (f:int);");
  pig.registerQuery("B = group A by f;");
  Schema origSchema=pig.dumpSchema("B");
  ResourceSchema rs1=new ResourceSchema(origSchema);
  pig.registerQuery("STORE B into '" + datadir + "bout' using PigStorage('\\t', '-schema');");
  pig.registerQuery("C = LOAD '" + datadir + "bout' using PigStorage('\\t', '-schema');");
  Schema genSchema=pig.dumpSchema("C");
  ResourceSchema rs2=new ResourceSchema(genSchema);
  Assert.assertTrue("generated schema equals original",ResourceSchema.equals(rs1,rs2));
  pig.registerQuery("C1 = LOAD '" + datadir + "bout' as (a0:int, A: {t: (f:int) } );");
  pig.registerQuery("D = foreach C1 generate a0, SUM(A);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,1L)","(2,4L)","(3,3L)","(5,10L)","(8,24L)","(9,9L)"});
  Iterator<Tuple> iter=pig.openIterator("D");
  int counter=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigTupleRawComparator </h4><pre class="type-13 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomTuples() throws IOException {
  Random rand=new Random(SEED);
  for (int i=0; i < TUPLE_NUMBER; i++) {
    NullableTuple t=new NullableTuple(getRandomTuple(rand));
    int res=compareHelper(prototype,t,comparator);
    assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPinOptions </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPinnedJoinOption() throws Exception {
  String[] joinTypes={"hash","repl","merge","skewed","default"};
  String[] expectedJoinTypes={"HASH","REPLICATED","MERGE","SKEWED","HASH"};
  for (int i=0; i < joinTypes.length; i++) {
    pigServer.setBatchOn();
    pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("b = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("c = join a by foo, b by foo using '" + joinTypes[i] + "';");
    pigServer.registerQuery("store c into 'tmp2';");
    LOJoin op=(LOJoin)TestPigStats.getLogicalPlan(pigServer).findByAlias("c");
    assertTrue("did " + joinTypes[i] + " join get pinned? ",op.isPinnedOption(LOJoin.OPTION_JOIN));
    assertEquals("did the right join type get set? ",((LOJoin)op).getJoinType().toString(),expectedJoinTypes[i]);
    pigServer.discardBatch();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestProject </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMissingCols2() throws Exception {
  String inputFileName="TestProject-testMissingCols2-input.txt";
  String input[]={"1\t(hello,world)","2\t(good,bye)"};
  Util.createLocalInputFile(inputFileName,input);
  String query="a = load '" + inputFileName + "' as (i:int, "+ "t:tuple(s1:chararray, s2:chararray, s3:chararray));"+ "b = foreach a generate t.(s2,s3);";
  PigServer ps=new PigServer(Util.getLocalTestMode());
  Util.registerMultiLineQuery(ps,query);
  Iterator<Tuple> it=ps.openIterator("b");
  Tuple[] expectedResults=new Tuple[]{(Tuple)Util.getPigConstant("((null, null))"),(Tuple)Util.getPigConstant("((null, null))")};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMissingCols1() throws Exception {
  String inputFileName="TestProject-testMissingCols1-input.txt";
  String input[]={"hello\tworld","good\tbye"};
  Util.createLocalInputFile(inputFileName,input);
  String query="a = load '" + inputFileName + "' as (s1:chararray, s2:chararray, extra:chararray);"+ "b = foreach a generate s1, s2, extra;";
  PigServer ps=new PigServer(Util.getLocalTestMode());
  Util.registerMultiLineQuery(ps,query);
  Iterator<Tuple> it=ps.openIterator("b");
  Tuple[] expectedResults=new Tuple[]{(Tuple)Util.getPigConstant("('hello', 'world', null)"),(Tuple)Util.getPigConstant("('good', 'bye', null)")};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextTupleMultipleProjectionsWithNull() throws IOException, ExecException {
  t=tRandomAndNull;
  proj.attachInput(t);
  proj.setOverloaded(true);
  int j=0;
  ArrayList<Integer> cols=new ArrayList<Integer>();
  while (true) {
    cols.add(j);
    cols.add(j + 1);
    proj.setColumns(cols);
    res=proj.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_EOP)     break;
    TupleFactory tupleFactory=TupleFactory.getInstance();
    ArrayList objList=new ArrayList();
    objList.add(t.get(j));
    objList.add(t.get(j + 1));
    Tuple expectedResult=tupleFactory.newTuple(objList);
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(expectedResult,res.result);
    ++j;
    cols.clear();
  }
  proj.attachInput(t);
  proj.setColumn(8);
  proj.setOverloaded(false);
  res=proj.getNextTuple();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertEquals(t.get(8),res.result);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextMultipleProjections() throws ExecException, IOException {
  t=tRandom;
  ArrayList<Integer> cols=new ArrayList<Integer>();
  proj.attachInput(t);
  for (int j=0; j < t.size() - 1; j++) {
    proj.attachInput(t);
    cols.add(j);
    cols.add(j + 1);
    proj.setColumns(cols);
    res=proj.getNext();
    TupleFactory tupleFactory=TupleFactory.getInstance();
    ArrayList objList=new ArrayList();
    objList.add(t.get(j));
    objList.add(t.get(j + 1));
    Tuple expectedResult=tupleFactory.newTuple(objList);
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(expectedResult,res.result);
    cols.clear();
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNext() throws ExecException, IOException {
  t=tRandom;
  proj.attachInput(t);
  for (int j=0; j < t.size(); j++) {
    proj.attachInput(t);
    proj.setColumn(j);
    res=proj.getNext();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(t.get(j),res.result);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextMultipleProjectionsWithNull() throws ExecException, IOException {
  t=tRandomAndNull;
  ArrayList<Integer> cols=new ArrayList<Integer>();
  proj.attachInput(t);
  for (int j=0; j < t.size() - 1; j++) {
    proj.attachInput(t);
    cols.add(j);
    cols.add(j + 1);
    proj.setColumns(cols);
    res=proj.getNext();
    TupleFactory tupleFactory=TupleFactory.getInstance();
    ArrayList objList=new ArrayList();
    objList.add(t.get(j));
    objList.add(t.get(j + 1));
    Tuple expectedResult=tupleFactory.newTuple(objList);
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(expectedResult,res.result);
    cols.clear();
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullTupleCols() throws Exception {
  String inputFileName="TestProject-testNullTupleCols-input.txt";
  String input[]={"1\t(hello,world)","2\t(good)","3"};
  Util.createLocalInputFile(inputFileName,input);
  String query="a = load '" + inputFileName + "' as (i:int, "+ "t:tuple(s1:chararray, s2:chararray));"+ "b = foreach a generate t.s1, t.s2;";
  PigServer ps=new PigServer(Util.getLocalTestMode());
  Util.registerMultiLineQuery(ps,query);
  Iterator<Tuple> it=ps.openIterator("b");
  Tuple[] expectedResults=new Tuple[]{(Tuple)Util.getPigConstant("('hello', 'world')"),(Tuple)Util.getPigConstant("(null, null)"),(Tuple)Util.getPigConstant("(null, null)")};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextWithNull() throws ExecException, IOException {
  t=tRandomAndNull;
  proj.attachInput(t);
  for (int j=0; j < t.size(); j++) {
    proj.attachInput(t);
    proj.setColumn(j);
    res=proj.getNext();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(t.get(j),res.result);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextTupleMultipleProjections() throws IOException, ExecException {
  t=tRandom;
  proj.attachInput(t);
  proj.setOverloaded(true);
  int j=0;
  ArrayList<Integer> cols=new ArrayList<Integer>();
  while (true) {
    cols.add(j);
    cols.add(j + 1);
    proj.setColumns(cols);
    res=proj.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_EOP)     break;
    TupleFactory tupleFactory=TupleFactory.getInstance();
    ArrayList objList=new ArrayList();
    objList.add(t.get(j));
    objList.add(t.get(j + 1));
    Tuple expectedResult=tupleFactory.newTuple(objList);
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertEquals(expectedResult,res.result);
    ++j;
    cols.clear();
  }
  proj.attachInput(t);
  proj.setColumn(8);
  proj.setOverloaded(false);
  res=proj.getNextTuple();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertEquals(t.get(8),res.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRelationToExprProject </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterCount1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        filter_notone = filter test by (col2!=1);"+ "        generate group as col1, COUNT(filter_one) as cnt_one, COUNT(filter_notone) as cnt_notone;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Tuple[] expected=new DefaultTuple[2];
  expected[0]=(Tuple)Util.getPigConstant("(1,1L,1L)");
  expected[1]=(Tuple)Util.getPigConstant("(2,2L,0L)");
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertTrue(expected[j].equals(results[j]));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterCount2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple("a","hello"),tuple("a","goodbye"),tuple("b","goodbye"),tuple("c","hello"),tuple("c","hello"),tuple("c","hello"),tuple("d","what"));
  String query="A = load 'foo' using mock.Storage() as ( id:chararray, str:chararray );" + "B = group A by ( id );" + "Cfiltered = foreach B {"+ "        D = filter A by ("+ "                str matches 'hello'"+ "                );"+ "        matchedcount = COUNT(D);"+ "        generate"+ "                group,"+ "                matchedcount as matchedcount,"+ "                A.str;"+ "        };";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("Cfiltered");
  Map<String,Tuple> expected=new HashMap<String,Tuple>();
  expected.put("a",(Tuple)Util.getPigConstant("('a',1L,{('hello'),('goodbye')})"));
  expected.put("b",(Tuple)Util.getPigConstant("('b',0L,{('goodbye')})"));
  expected.put("c",(Tuple)Util.getPigConstant("('c',3L,{('hello'),('hello'),('hello')})"));
  expected.put("d",(Tuple)Util.getPigConstant("('d',0L,{('what')})"));
  int i=0;
  while (it.hasNext()) {
    Tuple actual=it.next();
    assertEquals(expected.get(actual.get(0)),actual);
    i++;
  }
  assertEquals(4,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterCount3() throws IOException, ParserException {
  String query="TESTDATA =  load '" + TEST_FILTER_COUNT3_INPUT + "' using PigStorage() as (timestamp:chararray, testid:chararray, userid: chararray, sessionid:chararray, value:long, flag:int);"+ "TESTDATA_FILTERED = filter TESTDATA by (timestamp gte '1230800400000' and timestamp lt '1230804000000' and value != 0);"+ "TESTDATA_GROUP = group TESTDATA_FILTERED by testid;"+ "TESTDATA_AGG = foreach TESTDATA_GROUP {"+ "                        A = filter TESTDATA_FILTERED by (userid eq sessionid);"+ "                        C = distinct A.userid;"+ "                        generate group as testid, COUNT(TESTDATA_FILTERED) as counttestdata, COUNT(C) as distcount, SUM(TESTDATA_FILTERED.flag) as total_flags;"+ "                }"+ "TESTDATA_AGG_1 = group TESTDATA_AGG ALL;"+ "TESTDATA_AGG_2 = foreach TESTDATA_AGG_1 generate COUNT(TESTDATA_AGG);";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("TESTDATA_AGG_2");
  int i=0;
  while (it.hasNext()) {
    Tuple actual=it.next();
    assertEquals(20l,actual.get(0));
    i++;
  }
  assertEquals(1,i);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate filter_one;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("({(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("({(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(new Integer(1),occurences);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate group, filter_one;};";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("(1,{(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("(2,{(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(new Integer(3));
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(Integer.valueOf(1),occurences);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  assertEquals("num fields",aliases.length,rsSchema.getFields().length);
  ResourceSchema.ResourceFieldSchema[] fields=rsSchema.getFields();
  for (int i=0; i < fields.length; i++) {
    assertEquals(fields[i].getName(),aliases[i]);
    assertEquals(fields[i].getType(),types[i]);
  }
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSampleOptimizer </h4><pre class="type-13 type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEndToEnd() throws Exception {
  PigServer pigServer=new PigServer(pc);
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(3);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' using PigStorage() AS (num:int);");
  pigServer.registerQuery("B = order A by num desc;");
  Iterator<Tuple> result=pigServer.openIterator("B");
  Integer prevNum=null;
  while (result.hasNext()) {
    Integer curNum=(Integer)result.next().get(0);
    if (null != prevNum)     assertTrue(curNum.compareTo(prevNum) <= 0);
    prevNum=curNum;
  }
  tmpFile.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByUDFSet() throws Exception {
  String query="a = load 'input1' using BinStorage();" + "b = order a by $0;" + "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  assertTrue(mrOper.UDFs.size() == 1);
  assertTrue(mrOper.UDFs.contains("BinStorage"));
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    assertTrue(mrOper.UDFs.size() == 2);
    assertTrue(mrOper.UDFs.contains("BinStorage"));
    assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
    ++count;
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSchemaSerialization() throws IOException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String inputFileName="testSchemaSerialization-input.txt";
  String[] inputData=new String[]{"foo\t1","hello\t2"};
  Util.createInputFile(cluster,inputFileName,inputData);
  String script="a = load '" + inputFileName + "' as (f1:chararray, f2:int);"+ " b = group a all; c = foreach b generate org.apache.pig.test.InputSchemaUDF(a);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals("{a: {(f1: chararray,f2: int)}}",t.get(0));
  }
  cluster.shutDown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestShortcuts </h4><pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDumpWithPreviousRelation() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> expected=Sets.newHashSet(tuple("a"),tuple("b"),tuple("c"));
  data.set("foo",Utils.getSchemaFromString("x:chararray"),expected);
  pigServer.registerQuery("=> load 'foo' using mock.Storage();");
  Iterator<Tuple> op=pigServer.openIterator("@");
  while (op.hasNext()) {
    assertTrue(expected.remove(op.next()));
  }
  assertFalse(op.hasNext());
  assertTrue(expected.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStore </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreComplexDataWithNull() throws Exception {
  Tuple inputTuple=GenRandomData.genRandSmallBagTextTupleWithNulls(new Random(),10,100);
  inpDB=DefaultBagFactory.getInstance().newDefaultBag();
  inpDB.add(inputTuple);
  storeAndCopyLocally(inpDB);
  PigStorage ps=new PigStorage("\t");
  BufferedReader br=new BufferedReader(new FileReader(outputFileName));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    System.err.println("Complex data: ");
    System.err.println(line);
    String[] flds=line.split("\t",-1);
    Tuple t=new DefaultTuple();
    ResourceFieldSchema stringfs=new ResourceFieldSchema();
    stringfs.setType(DataType.CHARARRAY);
    ResourceFieldSchema intfs=new ResourceFieldSchema();
    intfs.setType(DataType.INTEGER);
    ResourceFieldSchema bytefs=new ResourceFieldSchema();
    bytefs.setType(DataType.BYTEARRAY);
    ResourceSchema tupleSchema=new ResourceSchema();
    tupleSchema.setFields(new ResourceFieldSchema[]{stringfs,intfs});
    ResourceFieldSchema tuplefs=new ResourceFieldSchema();
    tuplefs.setSchema(tupleSchema);
    tuplefs.setType(DataType.TUPLE);
    ResourceSchema bagSchema=new ResourceSchema();
    bagSchema.setFields(new ResourceFieldSchema[]{tuplefs});
    ResourceFieldSchema bagfs=new ResourceFieldSchema();
    bagfs.setSchema(bagSchema);
    bagfs.setType(DataType.BAG);
    ResourceSchema mapSchema=new ResourceSchema();
    mapSchema.setFields(new ResourceFieldSchema[]{bytefs});
    ResourceFieldSchema mapfs=new ResourceFieldSchema();
    mapfs.setSchema(mapSchema);
    mapfs.setType(DataType.MAP);
    t.append(flds[0].compareTo("") != 0 ? ps.getLoadCaster().bytesToBag(flds[0].getBytes(),bagfs) : null);
    t.append(flds[1].compareTo("") != 0 ? new DataByteArray(flds[1].getBytes()) : null);
    t.append(flds[2].compareTo("") != 0 ? ps.getLoadCaster().bytesToCharArray(flds[2].getBytes()) : null);
    t.append(flds[3].compareTo("") != 0 ? ps.getLoadCaster().bytesToDouble(flds[3].getBytes()) : null);
    t.append(flds[4].compareTo("") != 0 ? ps.getLoadCaster().bytesToFloat(flds[4].getBytes()) : null);
    t.append(flds[5].compareTo("") != 0 ? ps.getLoadCaster().bytesToInteger(flds[5].getBytes()) : null);
    t.append(flds[6].compareTo("") != 0 ? ps.getLoadCaster().bytesToLong(flds[6].getBytes()) : null);
    t.append(flds[7].compareTo("") != 0 ? ps.getLoadCaster().bytesToMap(flds[7].getBytes(),mapfs) : null);
    t.append(flds[8].compareTo("") != 0 ? ps.getLoadCaster().bytesToTuple(flds[8].getBytes(),tuplefs) : null);
    t.append(flds[9].compareTo("") != 0 ? ps.getLoadCaster().bytesToBoolean(flds[9].getBytes()) : null);
    t.append(flds[10].compareTo("") != 0 ? ps.getLoadCaster().bytesToDateTime(flds[10].getBytes()) : null);
    t.append(flds[11].compareTo("") != 0 ? ps.getLoadCaster().bytesToCharArray(flds[10].getBytes()) : null);
    assertEquals(inputTuple,t);
  }
  br.close();
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStore() throws Exception {
  inpDB=GenRandomData.genRandSmallTupDataBag(new Random(),10,100);
  storeAndCopyLocally(inpDB);
  int size=0;
  BufferedReader br=new BufferedReader(new FileReader(outputFileName));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] flds=line.split("\t",-1);
    Tuple t=new DefaultTuple();
    t.append(flds[0].compareTo("") != 0 ? flds[0] : null);
    t.append(flds[1].compareTo("") != 0 ? Integer.parseInt(flds[1]) : null);
    System.err.println("Simple data: ");
    System.err.println(line);
    System.err.println("t: ");
    System.err.println(t);
    assertTrue(TestHelper.bagContains(inpDB,t));
    ++size;
  }
  assertEquals(size,inpDB.size());
  br.close();
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreComplexData() throws Exception {
  inpDB=GenRandomData.genRandFullTupTextDataBag(new Random(),10,100);
  storeAndCopyLocally(inpDB);
  PigStorage ps=new PigStorage("\t");
  int size=0;
  BufferedReader br=new BufferedReader(new FileReader(outputFileName));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] flds=line.split("\t",-1);
    Tuple t=new DefaultTuple();
    ResourceFieldSchema mapfs=GenRandomData.getRandMapFieldSchema();
    ResourceFieldSchema bagfs=GenRandomData.getSmallTupDataBagFieldSchema();
    ResourceFieldSchema tuplefs=GenRandomData.getSmallTupleFieldSchema();
    t.append(flds[0].compareTo("") != 0 ? ps.getLoadCaster().bytesToBag(flds[0].getBytes(),bagfs) : null);
    t.append(flds[1].compareTo("") != 0 ? new DataByteArray(flds[1].getBytes()) : null);
    t.append(flds[2].compareTo("") != 0 ? ps.getLoadCaster().bytesToCharArray(flds[2].getBytes()) : null);
    t.append(flds[3].compareTo("") != 0 ? ps.getLoadCaster().bytesToDouble(flds[3].getBytes()) : null);
    t.append(flds[4].compareTo("") != 0 ? ps.getLoadCaster().bytesToFloat(flds[4].getBytes()) : null);
    t.append(flds[5].compareTo("") != 0 ? ps.getLoadCaster().bytesToInteger(flds[5].getBytes()) : null);
    t.append(flds[6].compareTo("") != 0 ? ps.getLoadCaster().bytesToLong(flds[6].getBytes()) : null);
    t.append(flds[7].compareTo("") != 0 ? ps.getLoadCaster().bytesToMap(flds[7].getBytes(),mapfs) : null);
    t.append(flds[8].compareTo("") != 0 ? ps.getLoadCaster().bytesToTuple(flds[8].getBytes(),tuplefs) : null);
    t.append(flds[9].compareTo("") != 0 ? ps.getLoadCaster().bytesToBoolean(flds[9].getBytes()) : null);
    t.append(flds[10].compareTo("") != 0 ? ps.getLoadCaster().bytesToDateTime(flds[10].getBytes()) : null);
    assertEquals(true,TestHelper.bagContains(inpDB,t));
    ++size;
  }
  assertEquals(true,size == inpDB.size());
  br.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStoreBase </h4><pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSuccessFileCreation2() throws Exception {
  try {
    String[] inputData=new String[]{"hello\tworld","hi\tworld","bye\tworld"};
    System.err.println("XXX: " + TestStore.FailUDF.class.getName());
    String multiStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hello';"+ "b = foreach b generate "+ FAIL_UDF_NAME+ "($0);"+ "c = filter a by $0 == 'hi';"+ "d = filter a by $0 == 'bye';"+ "store b into '"+ outputFileName+ "_1';"+ "store c into '"+ outputFileName+ "_2';"+ "store d into '"+ outputFileName+ "_3';";
    String singleStoreScript="a = load '" + inputFileName + "';"+ "b = foreach a generate "+ FAIL_UDF_NAME+ "($0);"+ "store b into '"+ outputFileName+ "_1';";
    for (    boolean isPropertySet : new boolean[]{true,false}) {
      for (      boolean isMultiStore : new boolean[]{true,false}) {
        String script=(isMultiStore ? multiStoreScript : singleStoreScript);
        if (mode.isLocal()) {
          ps.getPigContext().getProperties().setProperty(MAP_MAX_ATTEMPTS,"1");
        }
        ps.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,Boolean.toString(isPropertySet));
        Util.deleteFile(ps.getPigContext(),TESTDIR);
        ps.setBatchOn();
        Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
        Util.registerMultiLineQuery(ps,script);
        try {
          ps.executeBatch();
        }
 catch (        IOException ioe) {
          if (!ioe.getMessage().equals("FailUDFException")) {
            throw ioe;
          }
        }
        for (int i=1; i <= (isMultiStore ? 3 : 1); i++) {
          String sucFile=outputFileName + "_" + i+ "/"+ MapReduceLauncher.SUCCEEDED_FILE_NAME;
          assertEquals("Checking if _SUCCESS file exists in " + mode + " mode",false,Util.exists(ps.getPigContext(),sucFile));
        }
      }
    }
  }
  finally {
    Util.deleteFile(ps.getPigContext(),TESTDIR);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether "part-m-00000" file is created on empty output when{@link PigConfiguration#PIG_OUTPUT_LAZY} is set and if LazyOutputFormat is
 * supported by Hadoop.
 * The test covers multi store and single store case in local and mapreduce mode
 * @throws IOException
 */
@Test public void testEmptyPartFileCreation() throws Exception {
  boolean isLazyOutputPresent=true;
  try {
    Class<?> clazz=PigContext.resolveClassName("org.apache.hadoop.mapreduce.lib.output.LazyOutputFormat");
    clazz.getMethod("setOutputFormatClass",Job.class,Class.class);
  }
 catch (  Exception e) {
    isLazyOutputPresent=false;
  }
  Assume.assumeTrue("LazyOutputFormat couldn't be loaded, test is skipped",isLazyOutputPresent);
  try {
    String[] inputData=new String[]{"hello\tworld","hi\tworld","bye\tworld"};
    String multiStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hey';"+ "c = filter a by $1 == 'globe';"+ "d = limit a 2;"+ "e = foreach d generate *, 'x';"+ "f = filter e by $3 == 'y';"+ "store b into '"+ outputFileName+ "_1';"+ "store c into '"+ outputFileName+ "_2';"+ "store f into '"+ outputFileName+ "_3';";
    String singleStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hey';"+ "store b into '"+ outputFileName+ "_1';";
    for (    boolean isMultiStore : new boolean[]{true,false}) {
      if (isMultiStore && (mode.isLocal() || mode.equals(ExecType.MAPREDUCE))) {
        continue;
      }
      String script=(isMultiStore ? multiStoreScript : singleStoreScript);
      ps.getPigContext().getProperties().setProperty(PigConfiguration.PIG_OUTPUT_LAZY,"true");
      Util.deleteFile(ps.getPigContext(),TESTDIR);
      ps.setBatchOn();
      Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
      Util.registerMultiLineQuery(ps,script);
      ps.executeBatch();
      Configuration conf=ConfigurationUtil.toConfiguration(ps.getPigContext().getProperties());
      for (int i=1; i <= (isMultiStore ? 3 : 1); i++) {
        assertEquals("For an empty output part-m-00000 should not exist in " + mode + " mode",null,getFirstOutputFile(conf,new Path(outputFileName + "_" + i),mode,true));
      }
    }
  }
  finally {
    Util.deleteFile(ps.getPigContext(),TESTDIR);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSuccessFileCreation1() throws Exception {
  try {
    String[] inputData=new String[]{"hello\tworld","hi\tworld","bye\tworld"};
    String multiStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hello';"+ "c = filter a by $0 == 'hi';"+ "d = filter a by $0 == 'bye';"+ "store b into '"+ outputFileName+ "_1';"+ "store c into '"+ outputFileName+ "_2';"+ "store d into '"+ outputFileName+ "_3';";
    String singleStoreScript="a = load '" + inputFileName + "';"+ "store a into '"+ outputFileName+ "_1';";
    for (    boolean isPropertySet : new boolean[]{true,false}) {
      for (      boolean isMultiStore : new boolean[]{true,false}) {
        String script=(isMultiStore ? multiStoreScript : singleStoreScript);
        ps.getPigContext().getProperties().setProperty(MRConfiguration.FILEOUTPUTCOMMITTER_MARKSUCCESSFULJOBS,Boolean.toString(isPropertySet));
        Util.deleteFile(ps.getPigContext(),TESTDIR);
        ps.setBatchOn();
        Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
        Util.registerMultiLineQuery(ps,script);
        ps.executeBatch();
        for (int i=1; i <= (isMultiStore ? 3 : 1); i++) {
          String sucFile=outputFileName + "_" + i+ "/"+ MapReduceLauncher.SUCCEEDED_FILE_NAME;
          assertEquals("Checking if _SUCCESS file exists in " + mode + " mode",isPropertySet,Util.exists(ps.getPigContext(),sucFile));
        }
      }
    }
  }
  finally {
    Util.deleteFile(ps.getPigContext(),TESTDIR);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStoreOld </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleStore() throws Exception {
  pig.registerQuery("A = load " + fileName + ";");
  pig.store("A",tmpFile1);
  pig.registerQuery("B = load " + tmpFile1 + ";");
  Iterator<Tuple> iter=pig.openIterator("B");
  int i=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(DataType.toInteger(t.get(0)).intValue(),i);
    assertEquals(DataType.toInteger(t.get(1)).intValue(),i);
    i++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreamingLocal </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinTwoStreamingRelations() throws Exception {
  ArrayList<String> list=new ArrayList<String>();
  for (int i=0; i < 10000; i++) {
    list.add("A," + i);
  }
  File input=Util.createInputFile("tmp","",list.toArray(new String[0]));
  Tuple expected=TupleFactory.getInstance().newTuple(4);
  expected.set(0,"A");
  expected.set(1,0);
  expected.set(2,"A");
  expected.set(3,0);
  pigServer.registerQuery("A = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',') as (a0, a1);");
  pigServer.registerQuery("B = stream A through `head -1` as (a0, a1);");
  pigServer.registerQuery("C = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',') as (a0, a1);");
  pigServer.registerQuery("D = stream C through `head -1` as (a0, a1);");
  pigServer.registerQuery("E = join B by a0, D by a0;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  int count=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expected.toString(),iter.next().toString());
    count++;
  }
  Assert.assertTrue(count == 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitInCoGroupUncompressed() throws Exception {
  resetLog(InterStorage.class);
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
  assertTrue(checkLogFileMessage(new String[]{InterStorage.useLog}));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTFileRecordReader() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("1.txt"));
  for (int i=0; i < 30; i++) {
    w.println("1\tthis is a test for compression of temp files");
  }
  w.close();
  Util.copyFromLocalToCluster(cluster,"1.txt","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter("tfile.pig"));
  w1.println("A = load '1.txt' as (a0:int, a1:chararray);");
  w1.println("B = group A by a0;");
  w1.println("store B into 'tfile' using org.apache.pig.impl.io.TFileStorage();");
  w1.close();
  PrintWriter w2=new PrintWriter(new FileWriter("tfile2.pig"));
  w2.println("A = load 'tfile' using org.apache.pig.impl.io.TFileStorage() as (a:int, b:bag{(b0:int, b1:chararray)});");
  w2.println("B = foreach A generate flatten($1);");
  w2.println("store B into '2.txt';");
  w2.close();
  try {
    String[] args={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile.pig"};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    String[] args2={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile2.pig"};
    PigStats stats2=PigRunner.run(args2,null);
    assertTrue(stats2.isSuccessful());
    OutputStats os=stats2.result("B");
    Iterator<Tuple> iter=os.iterator();
    int count=0;
    String expected="(1,this is a test for compression of temp files)";
    while (iter.hasNext()) {
      count++;
      assertEquals(expected,iter.next().toString());
    }
    assertEquals(30,count);
  }
  finally {
    new File("tfile.pig").delete();
    new File("tfile2.pig").delete();
    new File("1.txt").delete();
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTFileRecordWriterReaderAndProgress() throws Exception {
  File tFile=File.createTempFile("test","tfile");
  Path basicTFile=new Path(tFile.getAbsolutePath());
  tFile.delete();
  Configuration conf=new Configuration();
  conf.set("tfile.io.chunk.size","100");
  conf.set("fs.default.name","file:///");
  for (  String codec : new String[]{"none","gz"}) {
    System.err.println("Testing RecordWriter/Reader with codec: " + codec);
    try {
      TFileRecordWriter writer=new TFileRecordWriter(basicTFile,codec,conf);
      Tuple tuple=TupleFactory.getInstance().newTuple(1);
      int LOOP_SIZE=25000;
      for (int i=0; i <= LOOP_SIZE; i++) {
        String key=String.format("%010d",i);
        tuple.set(0,key);
        writer.write(null,tuple);
      }
      writer.close(null);
      int size=(int)tFile.length();
      FileSplit split=new FileSplit(basicTFile,0,size,null);
      TFileRecordReader reader=new TFileRecordReader();
      reader.initialize(split,HadoopShims.createTaskAttemptContext(conf,HadoopShims.createTaskAttemptID("jt",1,true,1,1)));
      float progress=0, lastprogress=0;
      int curval=0, prevval=-1;
      while (reader.nextKeyValue()) {
        Tuple t=(Tuple)reader.getCurrentValue();
        curval=Integer.valueOf((String)t.get(0));
        assertEquals("Unexpected Value",curval,prevval + 1);
        prevval=curval;
        progress=reader.getProgress();
        if (progress != lastprogress) {
          System.err.println("progress: " + progress);
        }
        assertTrue("Progress is not positive",progress > 0);
        assertTrue("Progress is not increasing",progress >= lastprogress);
        lastprogress=progress;
      }
      assertEquals("Last value does not match",curval,LOOP_SIZE);
      reader.close();
    }
  finally {
      tFile.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTuple </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTupleSerDe() throws Exception {
  for (int i=0; i < 1000; i++) {
    Tuple t=mTupleFactory.newTuple(i);
    for (int j=0; j < i; j++) {
      t.set(j,Integer.valueOf(random.nextInt()));
    }
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    DataOutput out=new DataOutputStream(baos);
    bis.writeDatum(out,t);
    DataInput in=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
    Tuple t2=(Tuple)bis.readDatum(in);
    assertEquals(t,t2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookupCast() throws Exception {
  String input[]={"[k1#hello,k2#bye]","[k1#good,k2#morning]"};
  PigServer ps=new PigServer(ExecType.LOCAL);
  File f=org.apache.pig.test.Util.createInputFile("test",".txt",input);
  String inputFileName=Util.generateURI(f.getAbsolutePath(),ps.getPigContext());
  String query="a= load '" + inputFileName + "' as (m);"+ " b = foreach a generate m#'k1';";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
  query="a= load '" + inputFileName + "' as (m:[]);"+ "b = foreach a generate m#'k1';";
  LOForEach foreach=getForeachFromPlan(query);
  LOGenerate loGen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  Operator outExp=loGen.getOutputPlans().get(0).getSources().get(0);
  assertFalse("outExp is not cast",outExp instanceof CastExpression);
  ps.registerQuery("a = load '" + inputFileName + "' as (m);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  Iterator<Tuple> it=ps.openIterator("b");
  String[] expectedResults=new String[]{"(hello)","(good)"};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
  ps.registerQuery("a = load '" + inputFileName + "' as (m:[]);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  it=ps.openIterator("b");
  expectedResults=new String[]{"(hello)","(good)"};
  i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDF </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFReturnMap_MapReduceMode() throws Exception {
  Util.createInputFile(cluster,"a.txt",new String[]{"dummy","dummy"});
  FileLocalizer.deleteTempFiles();
  PigServer pig=new PigServer(cluster.getExecType(),cluster.getProperties());
  pig.registerQuery("A = LOAD 'a.txt';");
  pig.registerQuery("B = FOREACH A GENERATE org.apache.pig.test.utils.MyUDFReturnMap();");
  Iterator<Tuple> iterator=pig.openIterator("B");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    @SuppressWarnings("unchecked") Map<Object,Object> result=(Map<Object,Object>)tuple.get(0);
    assertEquals(result,MyUDFReturnMap.map);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHelperEvalFunc() throws Exception {
  String pref="org.apache.pig.test.utils.HelperEvalFuncUtils$";
  String[][] UDF={{pref + "BasicSUM",pref + "AccSUM",pref + "AlgSUM","SUM"},{pref + "BasicCOUNT",pref + "AccCOUNT",pref + "AlgCOUNT","COUNT"},{"BasLCWC","AccLCWC","AlgLCWC","5*COUNT"}};
  String input="udf_test_helper_eval_func.txt";
  Util.createLocalInputFile(input,new String[]{"1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15"});
  for (  String[] udfs : UDF) {
    for (int i=0; i < udfs.length - 1; i++) {
      String query="DEFINE BasLCWC " + pref + "BasicLongCountWithConstructor('5');";
      query+="DEFINE AccLCWC " + pref + " AccLongCountWithConstructor('5');";
      query+="DEFINE AlgLCWC " + pref + "AlgLongCountWithConstructor('5');";
      query+="A = load '" + input + "' as (x:int);";
      query+="B = foreach (group A all) generate ";
      for (      String s : Arrays.copyOfRange(udfs,i,udfs.length - 1)) {
        query+=s + "(A),";
      }
      query+=udfs[udfs.length - 1] + "(A);";
      PigServer pigServer=new PigServer(Util.getLocalTestMode());
      pigServer.registerQuery(query);
      Iterator<Tuple> it=pigServer.openIterator("B");
      while (it.hasNext()) {
        Tuple t=it.next();
        Long val=(Long)t.get(0);
        for (int j=1; j < i; j++) {
          assertEquals(val,t.get(j));
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFReturnMap_LocalMode() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(TempScriptFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("B");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    @SuppressWarnings("unchecked") Map<Object,Object> result=(Map<Object,Object>)tuple.get(0);
    assertEquals(result,MyUDFReturnMap.map);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFContext </h4><pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFContext() throws Exception {
  File a=Util.createInputFile("inp1","txt",new String[]{"dumb"});
  File b=Util.createInputFile("inp2","txt",new String[]{"dumber"});
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] statement={"A = LOAD '" + Util.encodeEscape(a.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('joe');","B = LOAD '" + Util.encodeEscape(b.getAbsolutePath()) + "' USING org.apache.pig.test.utils.UDFContextTestLoader('jane');","C = union A, B;","D = FOREACH C GENERATE $0, $1, org.apache.pig.test.utils.UDFContextTestEvalFunc($0), " + "org.apache.pig.test.utils.UDFContextTestEvalFunc2($0);"};
  File tmpFile=File.createTempFile("temp_jira_851",".pig");
  FileWriter writer=new FileWriter(tmpFile);
  for (  String line : statement) {
    writer.write(line + "\n");
  }
  writer.close();
  pig.registerScript(tmpFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("D");
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    if ("dumb".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"joe");
    }
 else     if ("dumber".equals(tuple.get(0).toString())) {
      assertEquals(tuple.get(1).toString(),"jane");
    }
    assertEquals(Integer.valueOf(tuple.get(2).toString()),new Integer(5));
    assertEquals(tuple.get(3).toString(),"five");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFGroovy </h4><pre class="type-13 type-7 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroovyToPig() throws Exception {
  Object groovyObject=Boolean.TRUE;
  Object pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Boolean);
  assertEquals(true,pigObject);
  groovyObject=Byte.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Byte.MIN_VALUE,pigObject);
  groovyObject=Short.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Short.MIN_VALUE,pigObject);
  groovyObject=Integer.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals(Integer.MIN_VALUE,pigObject);
  groovyObject=Long.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Long);
  assertEquals(Long.MIN_VALUE,pigObject);
  groovyObject=BigInteger.TEN;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=Float.MIN_NORMAL;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Float);
  assertEquals(Float.MIN_NORMAL,pigObject);
  groovyObject=Double.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Double);
  assertEquals(Double.MIN_VALUE,pigObject);
  groovyObject=new BigDecimal("42.42");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject="Dans le cochon tout est bon !";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",pigObject);
  groovyObject="Surtout le jambon".getBytes("UTF-8");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataByteArray);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),((DataByteArray)pigObject).get());
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Pate";
  ((Object[])groovyObject)[1]="Henaff";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Pate",((Tuple)pigObject).get(0));
  assertEquals("Henaff",((Tuple)pigObject).get(1));
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Rillettes";
  ((Object[])groovyObject)[1]="Bordeau Chesnel";
  groovyObject=new groovy.lang.Tuple((Object[])groovyObject);
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Rillettes",((Tuple)pigObject).get(0));
  assertEquals("Bordeau Chesnel",((Tuple)pigObject).get(1));
  groovyObject=new ArrayList();
  ((List)groovyObject).add("Jaret");
  ((List)groovyObject).add("Filet Mignon");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataBag);
  assertEquals(2,((DataBag)pigObject).size());
  Iterator<Tuple> iter=((DataBag)pigObject).iterator();
  Set<String> values=new HashSet<String>();
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(1,t.size());
    values.add((String)t.get(0));
  }
  assertEquals(2,values.size());
  assertTrue(values.contains("Jaret"));
  assertTrue(values.contains("Filet Mignon"));
  groovyObject=new HashMap<String,String>();
  ((Map)groovyObject).put("Henaff","a bord");
  ((Map)groovyObject).put("Copains","comme cochons");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Map);
  assertEquals(2,((Map)pigObject).size());
  assertEquals("a bord",((Map)pigObject).get("Henaff"));
  assertEquals("comme cochons",((Map)pigObject).get("Copains"));
  groovyObject=TupleFactory.getInstance().newTuple(2);
  ((Tuple)groovyObject).set(0,"jambon");
  ((Tuple)groovyObject).set(1,"blanc");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new DefaultDataBag();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new org.joda.time.DateTime();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  groovyObject=null;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertNull(pigObject);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFWithoutParameter </h4><pre class="type-13 type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUDFWithoutParameter() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerScript(TempScriptFile.getAbsolutePath());
  Iterator<Tuple> iterator=pig.openIterator("B");
  int index=0;
  while (iterator.hasNext()) {
    Tuple tuple=iterator.next();
    index++;
    int result=(Integer)tuple.get(0);
    assertEquals(result,index);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnion </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaMergeWithBag() throws Exception {
  File f1=Util.createInputFile("tmp","input1.txt",new String[]{"dummy"});
  File f2=Util.createInputFile("tmp","input2.txt",new String[]{"dummy"});
  Util.registerMultiLineQuery(pigServer,"a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "';"+ "b = load '"+ Util.encodeEscape(f2.getAbsolutePath())+ "';"+ "c = foreach a generate 1, {(1, 'str1')};"+ "d = foreach b generate 2, {(2, 'str2')};"+ "e = union c,d;"+ "");
  Iterator<Tuple> it=pigServer.openIterator("e");
  Object[] expected=new Object[]{Util.getPigConstant("(1, {(1, 'str1')})"),Util.getPigConstant("(2, {(2, 'str2')})")};
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertEquals(expected[j],results[j]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezLauncher </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + INPUT_FILE + "' as (x:int, y:chararray);"+ "b = filter a by x > 100;"+ "c = foreach b generate y;"+ "d = group c all;"+ "store d into '"+ OUTPUT_FILE+ "';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  TezLauncher launcher=new TezLauncher();
  PigStats pigStats=launcher.launchPig(pp,"testRun1",pc);
  assertTrue(pigStats.isSuccessful());
  assertEquals(1,pigStats.getInputStats().size());
  assertEquals(INPUT_FILE,pigStats.getInputStats().get(0).getName());
  assertEquals(1,pigStats.getOutputStats().size());
  assertEquals(OUTPUT_FILE,pigStats.getOutputStats().get(0).getName());
  query="m = load '" + OUTPUT_FILE + "' as (a:chararray, b:{(y:chararray)});";
  pigServer=new PigServer(pc);
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("m");
  Tuple result=iter.next();
  assertEquals(result.get(0).toString(),"all");
  Iterator<Tuple> innerIter=((DataBag)result.get(1)).iterator();
  int count=0;
  while (innerIter.hasNext()) {
    assertTrue(Arrays.asList(OUTPUT_RECORDS).contains(innerIter.next().toString()));
    count++;
  }
  assertEquals(count,OUTPUT_RECORDS.length);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
