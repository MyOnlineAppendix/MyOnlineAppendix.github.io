<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAbstractAccumuloStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetLoadLocation() throws IOException, ParseException {
  AbstractAccumuloStorage s=getAbstractAccumuloStorage();
  Job actual=new Job();
  s.setLocation(getDefaultLoadLocation(),actual);
  Configuration actualConf=actual.getConfiguration();
  Job expected=getDefaultExpectedLoadJob();
  Configuration expectedConf=expected.getConfiguration();
  s.loadDependentJars(expectedConf);
  assertConfigurationsEqual(expectedConf,actualConf);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetStoreLocation() throws IOException, ParseException {
  AbstractAccumuloStorage s=getAbstractAccumuloStorage();
  Job actual=new Job();
  s.setStoreLocation(getDefaultStoreLocation(),actual);
  Configuration actualConf=actual.getConfiguration();
  Job expected=getDefaultExpectedStoreJob();
  Configuration expectedConf=expected.getConfiguration();
  s.loadDependentJars(expectedConf);
  assertConfigurationsEqual(expectedConf,actualConf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorage </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ClassCastException.class) public void testWriteLiteralAsMapWithAsterisk() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("*");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  storage.getMutations(t).size();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ClassCastException.class) public void testWriteLiteralAsMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage();
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  storage.getMutations(t).size();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.hbase.TestHBaseStorageFiltering </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncrementBytes(){
  doIncrementTest(Bytes.toBytes(0x03),Bytes.toBytes(0x04));
  doIncrementTest(new byte[]{0,1,0},new byte[]{0,1,1});
  doIncrementTest(new byte[]{127},new byte[]{-128});
  doIncrementTest(new byte[]{-1},new byte[]{-1,0});
  doIncrementTest(new byte[]{-1,-1},new byte[]{-1,-1,0});
  doIncrementTest(new byte[]{0,-1,-1},new byte[]{1,0,0});
  doIncrementTest(Bytes.toBytes(0xFFFFFFFF),new byte[]{-1,-1,-1,-1,0});
  doIncrementTest(Bytes.toBytes(Long.MAX_VALUE),new byte[]{-128,0,0,0,0,0,0,0});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPrefix() throws Exception {
  Filter filter=getHBaseStorageFilter("cf1:foo*");
  List<Filter> childFilters=assertFilterList(filter,FilterList.Operator.MUST_PASS_ALL,1);
  childFilters=assertFilterList(childFilters.get(0),FilterList.Operator.MUST_PASS_ONE,1);
  childFilters=assertFilterList(childFilters.get(0),FilterList.Operator.MUST_PASS_ALL,2);
  assertFamilyFilter(childFilters.get(0),CompareFilter.CompareOp.EQUAL,"cf1");
  childFilters=assertFilterList(childFilters.get(1),FilterList.Operator.MUST_PASS_ONE,1);
  assertPrefixFilter(childFilters.get(0),"foo");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncrementStrings(){
  doIncrementTest("100","101");
  doIncrementTest("0001","0002");
  doIncrementTest("aaaccccc","aaaccccd");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestAvroStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecursiveRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recursiveRecord.avro";
  testAvroStorage(false,basedir + "code/pig/recursive_tests.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-n this.is.ignored.in.a.loadFunc","AVROSTORAGE_OUT_1","recordsSubSchemaNullable","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecursiveRecordsOptionOn() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recursiveRecord.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchemaNullable.avro";
  testAvroStorage(true,basedir + "code/pig/recursive_tests.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-r","AVROSTORAGE_OUT_1","recordsSubSchemaNullable","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectionWithSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/projectionTestWithSchema.avro";
  testAvroStorage(true,basedir + "code/pig/projection_test_with_schema.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-f " + basedir + "schema/records.avsc","AVROSTORAGE_OUT_1","projectionTest","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMaps() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMaps.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMaps.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeparatedByComma() throws Exception {
  final String temp=basedir + "data/avro/uncompressed/testdirectory/part-m-0000";
  StringBuffer sb=new StringBuffer();
  sb.append(temp + "0.avro");
  for (int i=1; i <= 7; ++i) {
    sb.append(",");
    sb.append(temp + String.valueOf(i) + ".avro");
  }
  final String input=sb.toString();
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadDeflateCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/compressed/deflate/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMapsOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMapsOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMapsOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithRepeatedSubRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordWithRepeatedSubRecords.avro";
  final String check=basedir + "data/avro/uncompressed/recordWithRepeatedSubRecords.avro";
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordWithRepeatedSubRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchemaFromFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_blank_first_args.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_2","-f " + basedir + "schema/recordsSubSchema.avsc"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadTrevniRecords() throws Exception {
  final String input=basedir + "data/trevni/uncompressed/simpleRecordsTrevni.trevni";
  final String check=basedir + "data/avro/uncompressed/simpleRecordsTrevni.avro";
  testAvroStorage(true,basedir + "code/pig/trevni_to_avro.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleUnderscore() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsWithDoubleUnderscores.avro";
  testAvroStorage(true,basedir + "code/pig/namesWithDoubleColons.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","recordsWithDoubleUnderscores","AVROSTORAGE_OUT_2","-d -n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithEnums() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithEnums.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithEnums.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchemaFromClass() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_IN_2","-c org.apache.pig.builtin.avro.code.java.RecordPojo","AVROSTORAGE_OUT_1","''","AVROSTORAGE_OUT_2","-c org.apache.pig.builtin.avro.code.java.RecordPojo"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadGlob() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory/part-m-0000*";
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfArrays.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfArrays.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ai1_ao2.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin -f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_1",loadFileIntoString(basedir + "schema/recordsSubSchema.avsc")));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMapsOfArrayOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMapsOfArrayOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMapsOfArrayOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialLoadGlob() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory/part-m-0000{0,2,4,6}.avro";
  final String check=basedir + "data/avro/uncompressed/evenFileNameTestDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjection() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/projectionTest.avro";
  testAvroStorage(true,basedir + "code/pig/projection_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","projectionTest","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfStringArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfStringArrays.avro";
  testAvroStorage(true,basedir + "code/pig/dump.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfStringArrays.avsc","OUTFILE",createOutputName()));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleUnderscoreNoFlag() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  testAvroStorage(false,basedir + "code/pig/namesWithDoubleColons.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","recordsWithDoubleUnderscores","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithSimpleUnion() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithSimpleUnion.avro";
  final String check=basedir + "data/avro/uncompressed/recordsWithSimpleUnionOutput.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin -f " + basedir + "schema/recordsSubSchema.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfArraysOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfArraysOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfArraysOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadSnappyCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/compressed/snappy/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchemaFromFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","AVROSTORAGE_IN_2","-f " + basedir + "schema/records.avsc"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  final String schema=loadFileIntoString(basedir + "schema/records.avsc");
  testAvroStorage(true,basedir + "code/pig/identity_ai1_ao2.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","AVROSTORAGE_IN_1",schema));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreSnappyCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/compressed/snappy/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_codec.pig",ImmutableMap.<String,String>builder().put("INFILE",input).put("OUTFILE",createOutputName()).put("AVROSTORAGE_OUT_1","records").put("AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin").put("CODEC","snappy").put("LEVEL","6").build());
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithNullableUnions() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithNullableUnions.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithNullableUnions.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDates() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPigWithDates.avro";
  testAvroStorage(true,basedir + "code/pig/with_dates.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/arrays.avro";
  final String check=basedir + "data/avro/uncompressed/arraysAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","arrays","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithFixed() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithFixed.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithFixed.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchemaFromExampleFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_blank_first_args.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_2","-e " + basedir + "data/avro/uncompressed/recordsSubSchema.avro"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreDeflateCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/compressed/deflate/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_codec.pig",ImmutableMap.<String,String>builder().put("INFILE",input).put("OUTFILE",createOutputName()).put("AVROSTORAGE_OUT_1","records").put("AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin").put("CODEC","deflate").put("LEVEL","6").build());
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadAndSaveTrevniRecords() throws Exception {
  final String input=basedir + "data/trevni/uncompressed/simpleRecordsTrevni.trevni";
  final String check=basedir + "data/avro/uncompressed/simpleRecordsTrevni.avro";
  testAvroStorage(true,basedir + "code/pig/trevni_to_trevni.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName() + "Trevni"));
  testAvroStorage(true,basedir + "code/pig/trevni_to_avro.pig",ImmutableMap.of("INFILE",createOutputName() + "Trevni","AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadDirectory() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory";
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleLoadStore() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "orc-file-11-format.orc'"+ " using OrcStorage();");
  pigServer.registerQuery("store A into '" + OUTPUT1 + "' using OrcStorage();");
  pigServer.registerQuery("B = load '" + OUTPUT1 + "' using OrcStorage();");
  verifyData(new Path(basedir + "orc-file-11-format.orc"),pigServer.openIterator("B"),fs,7500);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStoragePushdown </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownBoolean() throws Exception {
  testPredicatePushdown(INPUT,"f1 == true",2500,1200000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownFloatDouble() throws Exception {
  testPredicatePushdown(INPUT,"f6 == 100.0 and f7 > 2000.00000001",167,1600000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownByteShort() throws Exception {
  testPredicatePushdown(INPUT,"f2 != 5 or f3 == 100",3500,1200000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownTimestamp() throws Exception {
  testPredicatePushdown(INPUT,"f10 >= ToDate('20100101', 'yyyyMMdd', 'UTC')",3000,400000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownVarchar() throws Exception {
  testPredicatePushdown(basedir + "charvarchar.orc","$1 == 'alice allen         '",19,18000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownIntLongString() throws Exception {
  testPredicatePushdown(INPUT,"f4 >= 980 and f4 < 1010 and (f5 == 100 or f9 is not null)",20,1200000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownChar() throws Exception {
  testPredicatePushdown(basedir + "charvarchar.orc","$0 == 'ulysses thompson'",18,18000);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPredicatePushdownBigDecimal() throws Exception {
  testPredicatePushdown(INPUT,"f11 < (bigdecimal)'1000000000';",2500,1600000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.data.TestSchemaTuple </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeJoinWithSchemaTuple() throws Exception {
  testJoinType("merge",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFRJoinWithSchemaTuple() throws Exception {
  testJoinType("replicated",false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.data.utils.TestMethodHelper </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplementation() throws NoSuchMethodException {
  Method t1=ITest.class.getMethod("t1");
  Method t2=ITest.class.getMethod("t2");
  shouldBe(t1,Test1.class,true);
  shouldBe(t2,Test1.class,true);
  shouldBe(t1,Test2.class,false);
  shouldBe(t2,Test2.class,true);
  shouldBe(t1,Test3.class,true);
  shouldBe(t2,Test3.class,true);
  shouldBe(t1,Test4.class,false);
  shouldBe(t2,Test4.class,true);
  shouldBe(t1,Test5.class,false);
  shouldBe(t2,Test5.class,false);
  shouldBe(t1,Test6.class,true);
  shouldBe(t2,Test6.class,false);
  shouldBe(t1,Test7.class,false);
  shouldBe(t2,Test7.class,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestAstValidator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultilineFunctionArgument() throws RecognitionException, ParsingFailureException, IOException {
  String query="LOAD 'testIn' \n" + "USING PigStorage ('\n');";
  ParserTestingUtils.validateAst(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestColumnAliasConversion </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.$1, $0; "+ "D = store C into 'output';";
  validate(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test6() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = foreach A generate $1, $1000; " + "C = store B into 'output';";
  validate(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = foreach A generate u, $1, w; " + "C = store B into 'output';";
  verify(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test3() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { R = a; P = c * 2; Q = P + d; S = R.u; T = limit S 100; generate Q, R, S, T, c + d/5; };" + "store B into 'y';";
  verify(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, y), v, w; " + "C = store B into 'output';";
  verify(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test5() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{} ); " + "B = foreach A generate u.$100; " + "C = store B into 'output';";
  validate(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test4() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, $1), $1, w; " + "C = store B into 'output';";
  validate(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestErrorHandling </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName3() throws IOException {
  String query="a = load 'x' as (tuple_0:tuple(int,int),(int,int));";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName4() throws IOException {
  String query="a = load 'x' as (bag_0:bag{},{});";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName5() throws IOException {
  String query="a = load 'x' as ([],map_0:map[]);";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName6() throws IOException {
  String query="a = load 'x' as (int,int,int,val_3,val_2);";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName1() throws IOException {
  String query="a = load 'x' as (int,val_0);";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAutomaticallyGivenSchemaName2() throws IOException {
  String query="a = load 'x' as ((int,int),tuple_0:tuple(int,int));";
  String failMsg="Duplicated alias in schema";
  shouldFailWithMessage(query,failMsg);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank03() throws Exception {
  String query="A = load 'test02' using PigStorage(',') as (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "B = rank A;" + "store B into 'rank03_test';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test5() throws Exception {
  String query="define myudf org.apache.pig.builtin.PigStorage( ',' );" + "A = load 'x' using myudf;" + "store A into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast2() throws Exception {
  generateLogicalPlan("sds = LOAD '/my/data/location' AS (simpleFields:map[], mapFields:map[], listMapFields:map[]); " + "queries_rand = FOREACH sds GENERATE (CHARARRAY) (mapFields#'page_params'#'query') AS query_string;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean1() throws Exception {
  generateLogicalPlan("A = load 'INPUT_FILE' as (id:int, fruit);" + "B = group A by id;" + "C = foreach B generate group,  "+ "((org.apache.pig.test.utils.AccumulatorBagCount(A)>1 and "+ "org.apache.pig.test.utils.AccumulatorBagCount(A)<3)?0:1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConstantWithNegativeValue() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray);" + "B = foreach A generate u, { ( -1, -15L, -3.5, -4.03F, -2.3e3 ) };" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test14() throws Exception {
  String query="a = load 'x1' using PigStorage() as (name, age:int, gpa);" + "b = load 'x2' as (name, age, registration, contributions);" + "e = cogroup a by name, b by name parallel 8;"+ "f = foreach e generate group,  SUM(a.age) as s;"+ "g = filter f by s>0;"+ "store g into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubeBasic() throws Exception {
  String query="a = load 'input' as (x:chararray,y:chararray,z:long);" + "b = cube a by cube(x,y);" + "c = foreach b generate flatten(group) as (x,y), COUNT(cube) as count, SUM(cube.z) as total;"+ "store c into 'output';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test6() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = group A by ( a, $2 );" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank02() throws Exception {
  String query="A = LOAD 'data4' AS (name:chararray,surname:chararray,sales:double,code:int);" + "C = rank A by sales DENSE;" + "store C into 'rank02_test';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapCast() throws Exception {
  generateLogicalPlan("a = load 'testSimpleMapCast' as (m);" + "b = foreach a generate ([int])m;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoin1() throws Exception {
  generateLogicalPlan("A = load 'hat' as (m:map[]);" + "B = filter A by m#'cond'==1;" + "C = filter B by m#'key1'==1;"+ "D = filter B by m#'key2'==2;"+ "E = join C by m#'key1', D by m#'key1';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test13() throws Exception {
  String query="define CMD `perl PigStreaming.pl` ship('" + Util.encodeEscape(command.toString()) + "') stderr('CMD');"+ "A = load 'x';"+ "C = stream A through CMD;"+ "store C into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccumWithRegexp() throws Exception {
  generateLogicalPlan("A = load 'AccumulatorInput.txt' as (id:int, fruit);" + "B = group A by id;" + "C = foreach B generate group,  (((chararray)org.apache.pig.test.utils.AccumulatorBagCount(A)) matches '1*' ?0:1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter4() throws Exception {
  generateLogicalPlan("b = filter (load 'd.txt' as (id:int, v1, v2)) by (id > 3) AND (v1 is null);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank05() throws Exception {
  String query="A = load 'test02' using PigStorage(',') as (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "D = rank A by postalcode DENSE;" + "store D into 'rank05_test';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test3() throws Exception {
  String query="a = load '1.txt'  as (name, age, gpa);" + "b = group a by name PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner2;" + "c = foreach b generate group, COUNT(a.age);"+ "store c into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NonProjectExpressionException.class) public void testNegative1() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { S = c * 2; T = limit S 100; generate T; };" + "store B into 'y';";
  ParserTestingUtils.generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapsideGroupByMultipleColumns() throws Exception {
  generateLogicalPlan("A = LOAD 'MapSideGroupInput.txt' using org.apache.pig.test.TestCollectedGroup$DummyCollectableLoader() as (id, name, grade);" + "B = group A by (id, name) using 'collected';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test25() throws Exception {
  String query="A = (load 'x' as ( u:int, v:long, w:bytearray)); " + "B = (distinct A partition by org.apache.pig.Identity); " + "C = (sample B 0.49); "+ "D = (order C by $0, $1); "+ "E = (load 'y' as (d1, d2)); "+ "F = (union onschema D, E); "+ "G = (load 'z' as (g1:int, g2:tuple(g21, g22))); "+ "H = (cross F, G); "+ "split H into I if 10 > 5, J if 'world' eq 'hello', K if 77 <= 200; "+ "L = (store J into 'output');";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test12() throws Exception {
  String query="define CMD `perl GroupBy.pl '\t' 0 1` ship('" + Util.encodeEscape(command.toString()) + "');"+ "A = load 'x';"+ "B = group A by $0;"+ "C = foreach B {"+ "   D = order A by $1; "+ "   generate flatten(D);"+ "};"+ "E = stream C through CMD;"+ "store E into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInlineOpInGroup() throws Exception {
  String query="a = load 'data1' as (x:int); \n" + "a_1 = filter (group a by x) by COUNT(a) > 0;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyTupConst() throws Exception {
  generateLogicalPlan("a = foreach (load 'b') generate ({});");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast1() throws Exception {
  String query="data = LOAD 'data.txt' AS (num:CHARARRAY);" + "numbers = FOREACH data GENERATE (INT) num;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter3() throws Exception {
  generateLogicalPlan("A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = filter A by u is not null;\n");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test4() throws Exception {
  String query="A = load 'x'; " + "B = mapreduce '" + "myjar.jar"+ "' "+ "Store A into 'table_testNativeMRJobSimple_input' "+ "Load 'table_testNativeMRJobSimple_output' "+ "`org.apache.pig.test.utils.WordCount -files "+ "file "+ "table_testNativeMRJobSimple_input table_testNativeMRJobSimple_output "+ "stopworld.file"+ "`;"+ "C = Store B into 'output';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank04() throws Exception {
  String query="A = load 'test02' using PigStorage(',') as (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "C = rank A by postalcode DESC;" + "store C into 'rank04_test';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test19() throws Exception {
  String query="A = load 'x' as (u:map[], v);\n" + "B = foreach A { T = (chararray)u#'hello'#'world'; generate T; };";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test24() throws Exception {
  String query="a = (load 'x1' using PigStorage() as (name, age:int, gpa));" + "b = (load 'x2' as (name, age, registration, contributions));" + "e = (cogroup a by name, b by name parallel 8);"+ "f = (foreach e generate group,  SUM(a.age) as s);"+ "g = (filter f by s>0);"+ "(store g into 'y');";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test11() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { T = limit a 100; generate T; };" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapUDF() throws Exception {
  generateLogicalPlan("A = LOAD 'someData';" + "B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;"+ "C = foreach B {"+ "generate (double)mymap#'double' as d, "+ "(long)mymap#'long' + (float)mymap#'float' as float_sum, "+ "CONCAT((chararray) mymap#'string', ' World!'), "+ "mymap#'int' * 10, "+ "(bag{tuple()}) mymap#'bag' as mybag, "+ "(tuple()) mymap#'tuple' as mytuple, "+ "(map[])mymap#'map' as mapInMap, "+ "mymap#'dba' as dba;"+ "};");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter2() throws Exception {
  generateLogicalPlan("A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = filter A by u is null;\n");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test9() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { R = a; S = R.u; T = limit S 100; generate S, T, c + d/5; };" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test18() throws Exception {
  String query="A = load 'x';\n" + "C = group (foreach A generate $0 parallel 5) all;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean5() throws Exception {
  generateLogicalPlan("a = load '1.txt' as (a0, a1);" + "b = foreach a generate (a0 is null ? 0 : 2);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test23() throws Exception {
  String query="a = (load 'x1' using PigStorage() as (name, age, gpa));" + "b = (group a all);" + "c = (foreach b generate AVG(a.age) as avg); "+ "d = (load 'x2' using PigStorage() as (name, age, registration, contributions));"+ "e = (group d all);"+ "f = (foreach e generate AVG(d.age) as avg);"+ "y = (foreach a generate age/c.avg, age/f.avg);"+ "store y into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank07() throws Exception {
  String query="A = load 'data' as (x:int,y:chararray,z:int,rz:chararray);" + "C = rank A by x ASC, y DESC;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test10() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { S = a; T = limit S 100; generate T; };" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test1() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = limit A 100; " + "C = filter B by 2 > 1; "+ "D = load 'y' as (d1, d2); "+ "E = join C by ( $0, $1 ), D by ( d1, d2 ) using 'replicated' parallel 16; "+ "F = store E into 'output';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubeAfterForeach() throws Exception {
  String query="a = load 'input' as (x:chararray,y:chararray,z:long);" + "b = foreach a generate x as type,y as location,z as number;" + "c = cube b by cube(type,location);"+ "d = foreach c generate flatten(group) as (type,location), COUNT(cube) as count, SUM(cube.number) as total;"+ "store d into 'd';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter1() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = filter A by 2 > 1;\n" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test17() throws Exception {
  String query="store ( load 'x' ) into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean4() throws Exception {
  generateLogicalPlan("a = load '1.txt' as (a0, a1);" + "b = foreach a generate (a0 is not null ? 0 : 1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = distinct A partition by org.apache.pig.Identity; " + "C = sample B 0.49; "+ "D = order C by $0, $1; "+ "E = load 'y' as (d1, d2); "+ "F = union onschema D, E; "+ "G = load 'z' as (g1:int, g2:tuple(g21, g22)); "+ "H = cross F, G; "+ "split H into I if 10 > 5, J if 'world' eq 'hello', K if 77 <= 200; "+ "L = store J into 'output';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank06() throws Exception {
  String query="A = load 'data' as (x:int,y:chararray,z:int,rz:chararray);" + "C = rank A by x..rz;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22() throws Exception {
  String query="A = (load 'x' as (u, v));\n" + "B = (group (foreach A generate $0 parallel 5) all);";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConstant() throws Exception {
  generateLogicalPlan("a = load 'foo' as (x:int, y:double, str:chararray);" + "b = foreach a generate {(null)}, ['2'#null];");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean3() throws Exception {
  generateLogicalPlan("A = load 'INPUT_FILE' as (id:int, fruit);" + "B = filter A by id < 5 and ( fruit neq 'cabbage' or id == 17 );");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank01() throws Exception {
  String query="A = LOAD 'data4' AS (name:chararray,surname:chararray,sales:double,code:int);" + "B = rank A by sales;" + "store B into 'rank01_test';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test16() throws Exception {
  String query="AA = load 'x';" + "A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);" + "store A into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = foreach A generate a, $2;" + "store B into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubeMultipleIAlias() throws Exception {
  String query="a = load 'input' as (x:chararray,y:chararray,z:long);" + "a = load 'input' as (x,y:chararray,z:long);" + "a = load 'input' as (x:chararray,y:chararray,z:long);"+ "b = cube a by rollup(x,y);"+ "c = foreach b generate flatten(group) as (x,y), COUNT(cube) as count, SUM(cube.z) as total;"+ "store c into 'c';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScopedAlias() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray);" + "B = load 'y' as ( u:int, x:int, y:chararray);" + "C = join A by u, B by u;"+ "D = foreach C generate A::u, B::u, v, x;"+ "store D into 'z';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComplexCast() throws Exception {
  generateLogicalPlan("a = load 'testComplexCast' as (m);" + "b = foreach a generate ([{(i:int,j:int)}])m;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test21() throws Exception {
  String query="A = load 'x' as (u, v);\n" + "B = foreach A { S = u; T = org.apache.pig.builtin.TOMAP(); generate S, T;};";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean2() throws Exception {
  generateLogicalPlan("A = load 'INPUT_FILE' as (id:int, fruit);" + "B = group A by id;" + "C = foreach B generate group,  "+ "((org.apache.pig.test.utils.AccumulatorBagCount(A)>3 or "+ "org.apache.pig.test.utils.AccumulatorBagCount(A)<2)?0:1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test8() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = group A by a;" + "C = foreach B { S = A.b; generate S; };"+ "store C into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test15() throws Exception {
  String query="a = load 'x1' using PigStorage() as (name, age, gpa);" + "b = group a all;" + "c = foreach b generate AVG(a.age) as avg; "+ "d = load 'x2' using PigStorage() as (name, age, registration, contributions);"+ "e = group d all;"+ "f = foreach e generate AVG(d.age) as avg;"+ "y = foreach a generate age/c.avg, age/f.avg;"+ "store y into 'y';";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultilineFunctionArgument() throws Exception {
  String query="LOAD 'testIn' \n" + "USING PigStorage ('\n');";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test20() throws Exception {
  String query="A = load 'x' using PigStorage() as (a:int,b:chararray);\n" + "B = foreach A { C = TOMAP()#'key1'; generate C as C; };";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank08() throws Exception {
  String query="A = load 'data' as (x:int,y:chararray,z:int,rz:chararray);" + "C = rank A;";
  generateLogicalPlan(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultilineFunctionArguments() throws RecognitionException, IOException {
  final String pre="STORE data INTO 'testOut' \n" + "USING PigStorage (\n";
  String lotsOfNewLines="'{\"debug\": 5,\n" + "  \"data\": \"/user/lguo/testOut/ComponentActTracking4/part-m-00000.avro\",\n" + "  \"field0\": \"int\",\n"+ "  \"field1\": \"def:browser_id\",\n"+ "  \"field3\": \"def:act_content\" }\n '\n";
  String[] queries={lotsOfNewLines,"'notsplitatall'","'see you\nnext line'","'surrounded \n by spaces'","'\nleading newline'","'trailing newline\n'","'\n'","'repeated\n\n\n\n\n\n\n\n\nnewlines'","'also\ris\rsupported\r'"};
  final String post=");";
  for (  String q : queries) {
    shouldPass(pre + q + post);
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative3() throws IOException, RecognitionException {
  shouldFail("A = load 'x';B = (A) as (a:int, b:long);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStar1() throws Exception {
  shouldPass("B = FOREACH A GENERATE *, MyUDF(name, age);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectRange1() throws Exception {
  shouldPass("F = foreach IN generate (int)col0, col1 .. col3; ");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast3() throws Exception {
  shouldPass("B = FOREACH A GENERATE (bag{tuple(long)})fld; ");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test3() throws IOException, RecognitionException {
  String query="a = load '1.txt' as (a0);" + "b = foreach a generate flatten( (bag{tuple(map[])})a0 ) as b0:map[];" + "c = foreach b generate (long)b0#'key1';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubePositive2() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d);" + "y = cube x by rollup(*), rollup($2..$3);" + "z = foreach y generate flatten(group) as (a, b, c, d), COUNT(x) as count;"+ "store z into 'cube_output';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive8() throws IOException, RecognitionException {
  String query="A = load 'data' as (x:int, y:chararray, z:int, rz:chararray);";
  query+="B = rank A by x DESC,y ASC DENSE;";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative3() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x (a, b, c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNull1() throws Exception {
  shouldPass("B = FOREACH A GENERATE a, null;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartition() throws Exception {
  shouldPass("B = group A by $0 PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 2;");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative5() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by (a, b, c), CUBE(c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStar2() throws Exception {
  shouldPass("C = FOREACH A GENERATE name, age, MyUDF(*);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast4() throws Exception {
  shouldPass("B = FOREACH A GENERATE (map[])fld;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubePositive3() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d);" + "y = cube x by cube($0, $1);" + "z = foreach y generate flatten(group) as (a, b), COUNT(x) as count;"+ "store z into 'cube_output';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2() throws IOException, RecognitionException {
  shouldPass("A = load '/Users/gates/test/data/studenttab10'; B = foreach A generate ( $0 == 0 ? 1 : 0 );");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplit2() throws Exception {
  shouldPass("SPLIT logs INTO logins IF command == 'login', all_quits IF command == 'quit';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive7() throws IOException, RecognitionException {
  String query="A = load 'data' as (x:int, y:chararray, z:int, rz:chararray);";
  query+="B = rank A by x DESC DENSE;";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative2() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; B=(A);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNull2() throws Exception {
  shouldPass("D = FOREACH C GENERATE FLATTEN((IsEmpty(A) ? null : A)), FLATTEN((IsEmpty(B) ? null : B));");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative4() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by (a, b, c), UDF(c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroup1() throws Exception {
  shouldPass("B = group A by ( a, $2 );");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test9() throws IOException, RecognitionException {
  String query="a = load 'x' as (u,v);" + "b = load 'y' as (u,w);" + "c = join a by u, b by u;"+ "d = foreach c generate a::u, b::u, w;";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative5() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; D = group A by $0:long;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast6() throws Exception {
  shouldPass("X = FOREACH B GENERATE group, (chararray)COUNT(A) AS total;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast5() throws Exception {
  shouldPass("E = foreach D generate userid, clicks/(double)C.total, cnt;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive6() throws IOException, RecognitionException {
  String query="A = load 'data' as (x:int, y:chararray, z:int, rz:chararray);";
  query+="B = rank A by *;";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplit1() throws Exception {
  shouldPass("split a into b if id > 3, c if id < 3, d otherwise;");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative1() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "cube = cube x by (a, b, c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative4() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; B = ( filter A by $0 == 0 ) as (a:bytearray, b:long);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast7() throws Exception {
  shouldPass("B = FOREACH A GENERATE a + (int)null;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test8() throws IOException, RecognitionException {
  String query="a = load '/user/pig/tests/data/singlefile/studenttab10k';" + "b = group a by $0;" + "c = foreach b {c1 = order $1 by $1; generate flatten(c1), MAX($1.$1); };"+ "store c into '/user/pig/out/jianyong.1297305352/Order_17.out';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive5() throws IOException, RecognitionException {
  String query="A = load 'data' as (x:int, y:chararray, z:int, rz:chararray);";
  query+="B = rank A by x..z;";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative2() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by a, b, c;";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunction1() throws Exception {
  shouldPass("B = foreach A generate org.apache.pig.builtin.CONCAT(b, c);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7() throws IOException, RecognitionException {
  String query="a = load '/user/pig/tests/data/singlefile/studenttab10k';" + "b = group a by $0;" + "c = foreach b {c1 = order $1 by * using org.apache.pig.test.udf.orderby.OrdDesc; generate flatten(c1); };"+ "store c into '/user/pig/out/jianyong.1297305352/Order_15.out';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test10() throws IOException, RecognitionException {
  String query="a = load 'x' as (name, age, gpa);" + "b = FOREACH C GENERATE group, flatten( ( 1 == 2 ? 2 : 3 ) );" + " store b into 'y'; ";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast8() throws Exception {
  shouldPass("a = load '1.txt' as(map[int]); --Map value is int");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter1() throws Exception {
  shouldPass("E = FILTER D BY not IsEmpty(B);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive4() throws IOException, RecognitionException {
  shouldPass("B = rank A by x, y ASC, w DESC, z ASC;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjection2() throws Exception {
  shouldPass("a = group (load '/var/folders/bs/cy3sndf95ng5ljgy5nxs1j080000gn/T/test6322762304144938425txt') by ($0,$1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunction2() throws Exception {
  shouldPass("B = foreach A generate org.apache.pig.builtin.CONCAT(b, c, 'x', 'y');");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test11() throws IOException, RecognitionException {
  String query="a = load 'repl' as (name, age, gpa);" + "b = FOREACH C GENERATE group, flatten( ( 1 == 2 ? 2 : 3 ) );" + " store b into 'skewed'; ";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative6() throws IOException, RecognitionException {
  shouldFail("A = load '/Users/gates/test/data/studenttab10'; B = foreach A generate $0, 3.0e10.1;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast9() throws Exception {
  shouldPass("b = foreach a generate (map[(i:int)])a0; -- Map value is tuple");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive2() throws IOException, RecognitionException {
  shouldPass("B = rank A by x;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test6() throws IOException, RecognitionException {
  String query="a = load '/user/pig/tests/data/singlefile/studentnulltab10k' as (name:chararray, age:int, gpa:double);" + "b = foreach a generate (int)((int)gpa/((int)gpa - 1)) as norm_gpa:int;" + "c = foreach b generate (norm_gpa is not null? norm_gpa: 0);"+ "store c into '/user/pig/out/jianyong.1297229709/Types_37.out';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjection1() throws Exception {
  shouldPass("b = foreach a generate flatten(group), SUM($1.$2);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive3() throws IOException, RecognitionException {
  shouldPass("B = rank A by x DESC;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFunction3() throws Exception {
  shouldPass("B = foreach A generate flatten(myudfs.Swap(name, age)), gpa;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter2() throws Exception {
  shouldPass("C = filter B by 2 > 1;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast10() throws Exception {
  shouldPass("b = stream a through `cat` as (m:map[{(i:int,j:chararray)}]); -- Map value is bag");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative6() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by CUBE(a, b, c), y, ROLLUP(c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectRange3() throws Exception {
  shouldPass("J = join IN1 by $0 .. $3, IN2 by $0 .. $3; ");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test5() throws IOException, RecognitionException {
  String query="a = load 'x' as (name, age, gpa);" + "b = foreach a generate name, age +  2L, 3.125F, 3.4e2;" + " store b into 'y'; ";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive1() throws IOException, RecognitionException {
  shouldPass("B = rank A;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectRange4() throws Exception {
  shouldPass("g = group l1 by b .. c; ");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean2() throws Exception {
  shouldPass("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>3 or " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<2)?0:1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNull3() throws Exception {
  shouldPass("B = FOREACH A GENERATE a + null;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullInBinCondNoSpace() throws IOException {
  String query="a = load '1.txt' as (a0, a1);" + "b = foreach a generate (a0==0?null:2);";
  PigServer pig=new PigServer(ExecType.LOCAL);
  Util.registerMultiLineQuery(pig,query);
  pig.explain("b",System.out);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter3() throws Exception {
  shouldPass("C = filter B by a is null;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast1() throws Exception {
  shouldPass("B = FOREACH A GENERATE (int)$0 + 1;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNegative1() throws IOException, RecognitionException {
  shouldPass("A = load 'x'; B=A;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectRange2() throws Exception {
  shouldPass("SORT = order IN by col2 .. col3, col0, col4 ..; ");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast2() throws Exception {
  shouldPass("B = FOREACH A GENERATE (tuple(int,int,float))fld;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCubePositive1() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d);" + "y = cube x by cube(a, b, c);" + "z = foreach y generate flatten(group) as (a, b, c), COUNT(x) as count;"+ "store z into 'cube_output';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test4() throws IOException, RecognitionException {
  String query="a = load '1.txt'  as (name, age, gpa); b = group a by name;" + "c = foreach b generate group, COUNT(a.age);" + "store c into 'y';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter4() throws Exception {
  shouldPass("C = filter B by a is not null;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSlowQuery() throws Exception {
  String query="A = load 'A.txt' using PigStorage() AS (m: int);";
  query+="B = FOREACH A { days_str = (chararray) (m == 1 ? 31: (m == 2 ? 28: (m == 3 ? 31: (m == 4 ? 30: (m == 5 ? 31: (m == 6 ? 30: (m == 7 ? 31: (m == 8 ? 31: (m == 9 ? 30: (m == 10 ? 31: (m == 11 ? 30:31))))))))))); GENERATE days_str as days_str; }";
  query+="store B into 'B';";
  shouldPass(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBoolean1() throws Exception {
  shouldPass("C = foreach B generate group,  " + "((org.apache.pig.test.utils.AccumulatorBagCount(A)>1 and " + "org.apache.pig.test.utils.AccumulatorBagCount(A)<3)?0:1);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankPositive9() throws IOException, RecognitionException {
  String query="A = load 'data' as (x:int, y:chararray, z:int, rz:chararray);";
  query+="B = rank A by * DENSE;";
  shouldPass(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestSchemaAliasVisitor </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = foreach A generate u, v, $0 as x, u as z; " + "C = store B into 'output';";
  validate(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestStuff </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testNegativeNumCharsToDelete() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Replace me now!");
  t.set(1,0);
  t.set(2,-2);
  t.set(3,"test");
  udf.exec(t);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testIndexOutOfBounds() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Replace me now!");
  t.set(1,-1);
  t.set(2,2);
  t.set(3,"test");
  udf.exec(t);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testArgumentCountMismatch() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(1);
  t.set(0,"some_val");
  udf.exec(t);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.TestSearchQuery </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSearchQuery() throws Exception {
  String[] searchUrls={"http://www.google.co.in/advanced_search?q=google+Advanced+Query&hl=en","http://www.google.co.in/search?hl=en&as_q=google+simple+Query&as_epq=&as_oq=&as_eq=&num=10&lr=&as_filetype=&ft=i&as_sitesearch=&as_qdr=all&as_rights=&as_occt=any&cr=&as_nlo=&as_nhi=&safe=images","http://search.live.com/results.aspx?q=live+Query&go=&form=QBRE","http://search.aol.com/aol/search?s_it=searchbox.webhome&q=aol+query","http://search.yahoo.com/search;_ylt=A0geu8zce8NJQxYBmgal87UF?p=Yahoo+query&fr=sfp&fr2=&iscqry="};
  String[] queries={"google advanced query","google simple query","live query","aol query","yahoo query"};
  SearchQuery sq=new SearchQuery();
  Tuple tuple=DefaultTupleFactory.getInstance().newTuple(1);
  for (int i=0; i < searchUrls.length; i++) {
    tuple.set(0,searchUrls[i]);
    super.assertEquals(sq.exec(tuple),queries[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestAllLoader </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can load files with the correct loaders as per file content.
 * @throws IOException
 */
@Test public void testFilesByContentDir() throws IOException {
  server.shutdown();
  configuration.setProperty(LoadFuncHelper.FILE_EXTENSION_LOADERS,contentLoaders);
  server=new PigServer(ExecType.LOCAL,configuration);
  server.setBatchOn();
  server.registerFunction(allLoaderName,new FuncSpec(allLoaderFuncSpec));
  server.registerQuery("a = LOAD '" + Util.encodeEscape(filesByContentDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (p:float, q:float);");
  readRecordsFromLoader(server,"a",fileRecords);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can read a tagged logic partitioned directory
 * @throws IOException
 */
@Test public void testTaggedLogicPartitionDir() throws IOException {
  server.shutdown();
  configuration.setProperty(LoadFuncHelper.FILE_EXTENSION_LOADERS,taggedExtensionLoaders);
  server=new PigServer(ExecType.LOCAL,configuration);
  server.setBatchOn();
  server.registerFunction(allLoaderName,new FuncSpec(allLoaderFuncSpec));
  int i=0;
  for (  String tag : tags) {
    String schema=taggedSchemas[i++];
    server.registerQuery(tag + " = LOAD '" + Util.encodeEscape(taggedLogicPartitionDir.getAbsolutePath())+ "/"+ tag+ "' using "+ allLoaderFuncSpec+ " as "+ schema+ ";");
    readRecordsFromLoader(server,tag,fileRecords * logicPartitions.length * fileTypes.length);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can read from a simple directory
 * @throws IOException
 */
@Test public void testSimpleDir() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(simpleDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (q:float, p:float);");
  readRecordsFromLoader(server,"a",fileRecords * fileTypes.length);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that we can read a logic partitioned directory
 * @throws IOException
 */
@Test public void testLogicPartitionDir() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(logicPartitionDir.getAbsolutePath()) + "' using "+ allLoaderFuncSpec+ " as (q:float, p:float);");
  readRecordsFromLoader(server,"a",fileRecords * logicPartitions.length * fileTypes.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestCSVExcelStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTabDelimiter() throws IOException {
  String script="e = LOAD '" + testFileTabName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage('\t', 'YES_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrTabYesMultilineResultTuples,"e");
  String testOutFileName=createOutputFileName();
  script="STORE e INTO '" + testOutFileName + "' USING "+ "org.apache.pig.piggybank.storage.CSVExcelStorage('\t', 'YES_MULTILINE');";
  pig.registerQuery(script);
  script="f = LOAD '" + testOutFileName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage('\t', 'YES_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrTabYesMultilineResultTuples,"f");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiline() throws IOException {
  String script="a = LOAD '" + testFileCommaName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrCommaYesMultilineResultTuples,"a");
  String testOutFileName=createOutputFileName();
  script="STORE a INTO '" + testOutFileName + "' USING "+ "org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE', 'UNIX');";
  pig.registerQuery(script);
  script="b = LOAD '" + testOutFileName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'YES_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrCommaYesMultilineResultTuples,"b");
  script="c = LOAD '" + testOutFileName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'NO_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrCommaNoMultilineResultTuples,"c");
  testOutFileName=createOutputFileName();
  script="STORE c INTO '" + testOutFileName + "' USING "+ "org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'NO_MULTILINE', 'UNIX');";
  pig.registerQuery(script);
  script="d = LOAD '" + testOutFileName + "' "+ "USING org.apache.pig.piggybank.storage.CSVExcelStorage(',', 'NO_MULTILINE');";
  pig.registerQuery(script);
  compareExpectedActual(testStrCommaNoMultilineResultTuples,"d");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestFixedWidthLoader </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void doesNotSupportObjectTypes() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'-5, 9-21, 25-29, 33-40, 44, 48-52, 55-74, 78-82, 83-90', 'SKIP_HEADER', 'i: (j: int, k: int)'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void columnEndLessThanStart() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'5-0', 'SKIP_HEADER', 'i: int'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void fewerColumnsThanSchemaFields() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'1-5, 9-21, 25-29, 33-40', 'SKIP_HEADER', 'i: int, l: long, f: float, d: double, bit: int, c: chararray, b: bytearray') "+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void columnStartsAtZero() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'0-5', 'SKIP_HEADER', 'i: int'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestMultiStorage </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiStorage() throws IOException {
  final String LOAD="A = LOAD '" + INPUT_FILE + "' as (id, name, n);";
  final String MULTI_STORE_CLUSTER="STORE A INTO 'mr-out' USING " + "org.apache.pig.piggybank.storage.MultiStorage('mr-out', '1');";
  final String MULTI_STORE_LOCAL="STORE A INTO 'dummy' USING " + "org.apache.pig.piggybank.storage.MultiStorage('local-out', '1');";
  System.out.print("Testing in LOCAL mode: ...");
  System.out.println("Succeeded!");
  System.out.print("Testing in CLUSTER mode: ...");
  testMultiStorage(Mode.cluster,"mr-out",LOAD,MULTI_STORE_CLUSTER);
  System.out.println("Succeeded!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlob4() throws IOException {
  String output=outbasedir + "testGlob4";
  String expected=basedir + "expected_test_dir_1_2.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir12AllFiles) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserDefinedLoadSchema() throws IOException {
  PigSchema2Avro.setTupleIndex(2);
  String output=outbasedir + "testUserDefinedLoadSchema";
  String expected=basedir + "expected_testUserDefinedLoadSchema.avro";
  String customSchema="{\"type\": \"record\", \"name\": \"employee\", \"fields\": [ " + "{ \"default\": \"***\", \"type\": \"string\", \"name\": \"name\" }, " + "{ \"name\": \"address\", \"type\": { "+ "\"type\": \"record\", \"name\": \"addressDetails\", \"fields\": [ "+ "{ \"default\": 0, \"type\": \"int\", \"name\": \"customField1\" }, "+ "{ \"default\": 0, \"type\": \"int\", \"name\": \"customField2\" }, "+ "{ \"default\": 0, \"type\": \"int\", \"name\": \"customField3\" } "+ "] "+ "} } "+ "] } ";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + testUserDefinedLoadSchemaFile + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('schema', '"+ customSchema+ "');"," o = ORDER in BY name;"," STORE o INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCorruptedFile1() throws IOException {
  String output=outbasedir + "testCorruptedFile1";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testCorruptedFile) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  testAvroStorage(true,queries);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlob5() throws IOException {
  String output=outbasedir + "testGlob5";
  String expected=basedir + "expected_test_dir_1_2.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir21AllFiles) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleSchemas2() throws IOException {
  String output=outbasedir + "testMultipleSchemas2";
  String expected=basedir + "expected_testMultipleSchemas2.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testMultipleSchemas2File) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('multiple_schemas');"," f = FOREACH in GENERATE ($0 is not null ? (chararray)$0 : '')," + "                         ($1 is not null ? (chararray)$1 : '')," + "                         ($2 is not null ? (chararray)$2 : ''),"+ "                         ($3 is not null ? (chararray)$3 : ''),"+ "                         ($4 is not null ? (chararray)$4 : ''),"+ "                         ($5 is not null ? (chararray)$5 : '');"," c = FOREACH f GENERATE StringConcat( $0, $1, $2, $3, $4, $5 );"," o = ORDER c BY $0;"," STORE o INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('schema', '\"string\"');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordInMap() throws IOException {
  String output=outbasedir + "testRecursiveRecordInMap";
  String expected=testRecursiveRecordInMap;
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInMap) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '"+ recursiveRecordInMap+ "' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCorruptedFile2() throws IOException {
  String output=outbasedir + "testCorruptedFile2";
  String expected=basedir + "expected_testCorruptedFile.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testCorruptedFile) + "'"+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ('ignore_bad_files');"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFileWithNoExtension() throws IOException {
  PigSchema2Avro.setTupleIndex(4);
  String output=outbasedir + "testFileWithNoExtension";
  String expected=basedir + "expected_testFileWithNoExtension.avro";
  deleteDirectory(new File(output));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testNoExtensionFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," avro1 = FILTER avro BY member_id > 1211;"," avro2 = FOREACH avro1 GENERATE member_id, browser_id, tracking_time, act_content ;"," STORE avro2 INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"data\":  \""+ Util.encodeEscape(testNoExtensionFile)+ "\" ,"+ "  \"field0\": \"int\", "+ " \"field1\":  \"def:browser_id\", "+ "  \"field3\": \"def:act_content\" "+ " }');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlob2() throws IOException {
  String output=outbasedir + "testGlob2";
  String expected=basedir + "expected_test_dir_1.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir1Files123) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleSchemas1() throws IOException {
  String output=outbasedir + "testMultipleSchemas1";
  String expected=basedir + "expected_testMultipleSchemas1.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testMultipleSchemas1File) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('multiple_schemas');"," s = FOREACH in GENERATE StringConcat($0);"," o = ORDER s BY $0;"," STORE o INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ('schema', '\"string\"');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayWithSchemaURI() throws IOException {
  String output=outbasedir + "testArrayWithSchemaURI";
  String expected=basedir + "expected_testArrayWithSchemaURI.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ( "+ "   'schema_uri', '"+ Util.encodeEscape(testArraySchema)+ "'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayWithSame() throws IOException {
  String output=outbasedir + "testArrayWithSame";
  String expected=basedir + "expected_testArrayWithSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ( "+ "   'same', '"+ Util.encodeEscape(testArrayFile)+ "'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordWithNoAvroSchema() throws IOException {
  String output=outbasedir + "testRecursiveRecordWithNoAvroSchema";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check' );"};
  testAvroStorage(true,queries);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlob3() throws IOException {
  String output=outbasedir + "testGlob3";
  String expected=basedir + "expected_test_dir_1.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir1Files321) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayWithSnappyCompression() throws IOException {
  String output=outbasedir + "testArrayWithSnappyCompression";
  String expected=basedir + "expected_testArrayDefault.avro";
  deleteDirectory(new File(output));
  Properties properties=new Properties();
  properties.setProperty(MRConfiguration.OUTPUT_COMPRESS,"true");
  properties.setProperty(MRConfiguration.OUTPUT_COMPRESSION_CODEC,"org.apache.hadoop.io.compress.SnappyCodec");
  properties.setProperty("avro.output.codec","snappy");
  PigServer pigServer=new PigServer(ExecType.LOCAL,properties);
  pigServer.setBatchOn();
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  for (  String query : queries) {
    pigServer.registerQuery(query);
  }
  pigServer.executeBatch();
  verifyResults(output,expected,"snappy");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComma2() throws IOException {
  String output=outbasedir + "testComma2";
  String expected=basedir + "expected_test_dir_1_2.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testCommaSeparated2) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithFieldSchemaFromTextWithSchemaFile2() throws IOException {
  PigSchema2Avro.setTupleIndex(1);
  String output=outbasedir + "testRecordWithFieldSchemaFromTextWithSchemaFile2";
  String expected=basedir + "expected_testRecordWithFieldSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testTextFile) + "' AS (member_id:int, browser_id:chararray, tracking_time:long, act_content:bag{inner:tuple(key:chararray, value:chararray)});"," avro1 = FILTER avro BY member_id > 1211;"," avro2 = FOREACH avro1 GENERATE member_id, browser_id, tracking_time, act_content ;"," STORE avro2 INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'schema_file', '"+ Util.encodeEscape(testRecordSchema)+ "',"+ "'field0','int',"+ "'field1','def:browser_id',"+ "'field3','def:act_content'"+ ");"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayDefault() throws IOException {
  String output=outbasedir + "testArrayDefault";
  String expected=basedir + "expected_testArrayDefault.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleFieldTuples() throws IOException {
  String output=outbasedir + "testSingleFieldTuples";
  String expected=basedir + "expected_testSingleFieldTuples.avro";
  deleteDirectory(new File(output));
  String[] queries={" messages = LOAD '" + Util.encodeEscape(testSingleTupleBagFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," a = foreach (group messages by user_id) { sorted = order messages by message_id DESC; GENERATE group AS user_id, sorted AS messages; };"," STORE a INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  testAvroStorage(queries);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComma1() throws IOException {
  String output=outbasedir + "testComma1";
  String expected=basedir + "expected_test_dir_1.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testCommaSeparated1) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordReference3() throws IOException {
  String output=outbasedir + "testRecursiveRecordReference3";
  String expected=basedir + "expected_testRecursiveRecordReference3.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," third = FOREACH in GENERATE $1.$1.$0 AS value;"," filtered = FILTER third BY value is not null;"," STORE filtered INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '\"int\"' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDir() throws IOException {
  String output=outbasedir + "testDir";
  String expected=basedir + "expected_testDir.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir1) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlob1() throws IOException {
  String output=outbasedir + "testGlob1";
  String expected=basedir + "expected_testDir.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testDir1AllFiles) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithSplitFromText() throws IOException {
  PigSchema2Avro.setTupleIndex(0);
  String output1=outbasedir + "testRecordSplitFromText1";
  String output2=outbasedir + "testRecordSplitFromText2";
  String expected1=basedir + "expected_testRecordSplitFromText1.avro";
  String expected2=basedir + "expected_testRecordSplitFromText2.avro";
  deleteDirectory(new File(output1));
  deleteDirectory(new File(output2));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testTextFile) + "' AS (member_id:int, browser_id:chararray, tracking_time:long, act_content:bag{inner:tuple(key:chararray, value:chararray)});"," groups = GROUP avro BY member_id;"," sc = FOREACH groups GENERATE group AS key, COUNT(avro) AS cnt;"," STORE sc INTO '" + output1 + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"index\": 1, "+ "  \"schema\": {\"type\":\"record\", "+ " \"name\":\"result\", "+ " \"fields\":[ {\"name\":\"member_id\",\"type\":\"int\"}, "+ "{\"name\":\"count\", \"type\":\"long\"} "+ "]"+ "}"+ " }');"," STORE sc INTO '" + output2 + " 'USING org.apache.pig.piggybank.storage.avro.AvroStorage ('index', '2');"};
  testAvroStorage(queries);
  verifyResults(output1,expected1);
  verifyResults(output2,expected2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordInRecord() throws IOException {
  String output=outbasedir + "testRecursiveRecordInRecord";
  String expected=testRecursiveRecordInRecord;
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInRecord) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '"+ Util.encodeEscape(recursiveRecordInRecord)+ "' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordReference2() throws IOException {
  String output=outbasedir + "testRecursiveRecordReference2";
  String expected=basedir + "expected_testRecursiveRecordReference2.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," second = FOREACH in GENERATE $1.$0 AS value;"," filtered = FILTER second BY value is not null;"," STORE filtered INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '\"int\"' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordInArray() throws IOException {
  String output=outbasedir + "testRecursiveRecordInArray";
  String expected=testRecursiveRecordInArray;
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInArray) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '"+ recursiveRecordInArray+ "' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayWithNotNull() throws IOException {
  String output=outbasedir + "testArrayWithNotNull";
  String expected=basedir + "expected_testArrayWithSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ( "+ "   '{\"nullable\": false }'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithSplit() throws IOException {
  PigSchema2Avro.setTupleIndex(0);
  String output1=outbasedir + "testRecordSplit1";
  String output2=outbasedir + "testRecordSplit2";
  String expected1=basedir + "expected_testRecordSplit1.avro";
  String expected2=basedir + "expected_testRecordSplit2.avro";
  deleteDirectory(new File(output1));
  deleteDirectory(new File(output2));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testRecordFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," groups = GROUP avro BY member_id;"," sc = FOREACH groups GENERATE group AS key, COUNT(avro) AS cnt;"," STORE sc INTO '" + output1 + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"index\": 1, "+ "  \"schema\": {\"type\":\"record\", "+ " \"name\":\"result\", "+ "  \"fields\":[ {\"name\":\"member_id\",\"type\":\"int\"}, "+ "{\"name\":\"count\", \"type\":\"long\"} "+ "]"+ "}"+ " }');"," STORE sc INTO '" + output2 + " 'USING org.apache.pig.piggybank.storage.avro.AvroStorage ('index', '2');"};
  testAvroStorage(queries);
  verifyResults(output1,expected1);
  verifyResults(output2,expected2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithFieldSchema() throws IOException {
  PigSchema2Avro.setTupleIndex(1);
  String output=outbasedir + "testRecordWithFieldSchema";
  String expected=basedir + "expected_testRecordWithFieldSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testRecordFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," avro1 = FILTER avro BY member_id > 1211;"," avro2 = FOREACH avro1 GENERATE member_id, browser_id, tracking_time, act_content ;"," STORE avro2 INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"data\":  \""+ Util.encodeEscape(testRecordFile)+ "\" ,"+ "  \"field0\": \"int\", "+ " \"field1\":  \"def:browser_id\", "+ "  \"field3\": \"def:act_content\" "+ " }');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordReference1() throws IOException {
  String output=outbasedir + "testRecursiveRecordReference1";
  String expected=basedir + "expected_testRecursiveRecordReference1.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," first = FOREACH in GENERATE $0 AS value;"," filtered = FILTER first BY value is not null;"," STORE filtered INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '\"int\"' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordInUnion() throws IOException {
  String output=outbasedir + "testRecursiveRecordInUnion";
  String expected=testRecursiveRecordInUnion;
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema', '"+ recursiveRecordInUnion+ "' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecursiveRecordWithSame() throws IOException {
  String output=outbasedir + "testRecursiveRecordWithSame";
  String expected=testRecursiveRecordInUnion;
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'same', '"+ Util.encodeEscape(testRecursiveRecordInUnion)+ "' );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArrayWithSchema() throws IOException {
  String output=outbasedir + "testArrayWithSchema";
  String expected=basedir + "expected_testArrayWithSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testArrayFile) + " ' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ( "+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithFieldSchemaFromTextWithSchemaFile() throws IOException {
  PigSchema2Avro.setTupleIndex(1);
  String output=outbasedir + "testRecordWithFieldSchemaFromTextWithSchemaFile";
  String expected=basedir + "expected_testRecordWithFieldSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testTextFile) + "' AS (member_id:int, browser_id:chararray, tracking_time:long, act_content:bag{inner:tuple(key:chararray, value:chararray)});"," avro1 = FILTER avro BY member_id > 1211;"," avro2 = FOREACH avro1 GENERATE member_id, browser_id, tracking_time, act_content ;"," STORE avro2 INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"schema_file\":  \""+ Util.encodeEscape(testRecordSchema)+ "\" ,"+ "  \"field0\": \"int\", "+ " \"field1\":  \"def:browser_id\", "+ "  \"field3\": \"def:act_content\" "+ " }');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefaultValueSchemaWrite() throws IOException {
  String output=outbasedir + "testDefaultValueSchemaWrite";
  String expected=basedir + "expected_testDefaultSchemaWrite.avro";
  Data data=resetData(pigServerLocal);
  data.set("testDefaultValueSchemaWrite",tuple(0,115,115000,115000.1),tuple(1,116,116000,116000.1),tuple(2,117,117000,117000.1),tuple(3,118,118000,118000.1),tuple(4,119,119000,119000.1));
  deleteDirectory(new File(output));
  String[] queries={" a = LOAD 'testDefaultValueSchemaWrite' USING mock.Storage as  " + " (id: int, intval:int, longval:long, floatval:float);"," b = foreach a generate id, longval, floatval;"," c = order b by id;"," STORE c INTO '" + output + "' USING "+ " org.apache.pig.piggybank.storage.avro.AvroStorage (' { \"debug\" : 5, \"schema\" : "+ " {  \"name\" : \"rmyrecord\", \"type\" : \"record\",  \"fields\" : [ { \"name\" : \"id\", "+ " \"type\" : \"int\" , \"default\" : 0 }, {  \"name\" : \"longval\",  \"type\" : \"long\","+ " \"default\" : 0 }, { \"name\" : \"floatval\", \"type\" : \"float\", \"default\" : 1.0 } ] } } "+ " ');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRecordWithFieldSchemaFromText() throws IOException {
  PigSchema2Avro.setTupleIndex(1);
  String output=outbasedir + "testRecordWithFieldSchemaFromText";
  String expected=basedir + "expected_testRecordWithFieldSchema.avro";
  deleteDirectory(new File(output));
  String[] queries={" avro = LOAD '" + Util.encodeEscape(testTextFile) + "' AS (member_id:int, browser_id:chararray, tracking_time:long, act_content:bag{inner:tuple(key:chararray, value:chararray)});"," avro1 = FILTER avro BY member_id > 1211;"," avro2 = FOREACH avro1 GENERATE member_id, browser_id, tracking_time, act_content ;"," STORE avro2 INTO '" + output + "' "+ " USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "'{\"data\":  \""+ Util.encodeEscape(testRecordFile)+ "\" ,"+ "  \"field0\": \"int\", "+ " \"field1\":  \"def:browser_id\", "+ "  \"field3\": \"def:act_content\" "+ " }');"};
  testAvroStorage(queries);
  verifyResults(output,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccumulatorOff() throws IOException {
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_OPT_ACCUMULATOR,"false");
  pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group," + "org.apache.pig.test.utils.AccumulativeSumBag(A);");
  checkAccumulatorOff("C");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_OPT_ACCUMULATOR,"true");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * see PIG-1963.
 * If there is a POSort or PODistinct still remaining in the plan
 * (after secondary sort optimization), accumulative mode can't
 * be used as they are blocking operators
 * @throws IOException
 */
@Test public void testAccumulatorOffOnSort() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B " + "{ " + "  o1 = order A by fruit;"+ "  o2 = order A by fruit desc;"+ "  generate  org.apache.pig.test.utils.AccumulativeSumBag(o1.fruit), "+ "                  org.apache.pig.test.utils.AccumulativeSumBag(o2.fruit); "+ "};");
  checkAccumulatorOff("C");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * see PIG-1911 .
 * accumulator udf reading from a nested relational op. generate projects
 * only the accumulator udf.
 * @throws IOException
 * @throws ParseException
 */
@Test public void testAccumAfterNestedOp() throws IOException, ParserException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B " + "{ o = order A by id; " + "  generate org.apache.pig.test.utils.AccumulatorBagCount(o);}; ");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(2)","(1)","(3)","(1)"});
  Util.checkQueryOutputsAfterSort(iter,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccumCountStar() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, COUNT_STAR(A.id);");
  pigServer.openIterator("D");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * see PIG-1963.
 * If there is a POSort or PODistinct still remaining in the plan
 * (after secondary sort optimization), accumulative mode can't
 * be used as they are blocking operators
 * @throws IOException
 */
@Test public void testAccumulatorOffOnDistinct() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE2 + "' as (id:int, fruit, category);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B " + "{ " + "  o1 = order A by fruit;"+ "  d2 = distinct A.category;"+ "  generate  org.apache.pig.test.utils.AccumulativeSumBag(o1.fruit), "+ "                  org.apache.pig.test.utils.AccumulativeSumBag(d2); "+ "};");
  checkAccumulatorOff("C");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccumWithTOP() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("D = foreach B { C = TOP(5, 0, A); generate flatten(C); }");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  List<Tuple> expected=Util.getTuplesFromConstantTupleStrings(new String[]{"(200,1.1)","(200,2.1)","(300,3.3)","(400,null)","(400,null)"});
  Util.checkQueryOutputsAfterSort(iter,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccumWithMultiBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, c:chararray);");
  pigServer.registerQuery("C = group A by 1;");
  pigServer.registerQuery("D = foreach C generate SUM(A.id), 1+SUM(A.id)+SUM(A.id);");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    t.get(0).toString().equals("1700");
    t.get(1).toString().equals("3401");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAssert </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that alias is not assignable to the ASSERT operator
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testNegativeWithAlias() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  try {
    pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
    pigServer.registerQuery("B = ASSERT A BY i > 1 , 'i should be greater than 1';");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Syntax error, unexpected symbol at or near 'B'");
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBZip </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where a bzip block ends exactly at the end of the input
 * split and has more data which results in overcounting (record duplication)
 * in Pig 0.6
 */
@Test public void testBlockHeaderEndingAtSplitOverCounting() throws IOException {
  String inputFileName="test/org/apache/pig/test/data/blockHeaderEndsAt136500.txt.bz2";
  Long expectedCount=1041046L;
  int splitSize=136500;
  try {
    Util.copyFromLocalToCluster(cluster,inputFileName,inputFileName);
    testCount(inputFileName,expectedCount,splitSize,"PigStorage()");
  }
  finally {
    Util.deleteFile(cluster,inputFileName);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBz2() throws Exception {
  String[] inputData=new String[]{"1\t2\r3\t4","5\t6\r","7\t8","9\t10\r"};
  File in=folder.newFile("junit-in.bz2");
  String compressedInputFileName=in.getAbsolutePath();
  String clusterCompressedFilePath=Util.removeColon(compressedInputFileName);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
    for (int i=0; i < inputData.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    Util.copyFromLocalToCluster(cluster,compressedInputFileName,clusterCompressedFilePath);
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    String script="a = load '" + Util.encodeEscape(clusterCompressedFilePath) + "';";
    pig.registerQuery(script);
    pig.registerQuery("store a into 'intermediate.bz';");
    pig.registerQuery("b = load 'intermediate.bz';");
    Iterator<Tuple> it2=pig.openIterator("b");
    while (it2.hasNext()) {
      it2.next();
    }
  }
  finally {
    Util.deleteFile(cluster,"intermediate.bz");
    Util.deleteFile(cluster,"final.bz");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where a bzip block ends exactly at the end of the input
 * split (byte aligned with the last byte) and the last byte is a carriage
 * return.
 */
@Test public void testBlockHeaderEndingWithCR() throws IOException {
  String inputFileName="test/org/apache/pig/test/data/blockEndingInCR.txt.bz2";
  Long expectedCount=82094L;
  try {
    int splitSize=136498;
    Util.copyFromLocalToCluster(cluster,inputFileName,inputFileName);
    testCount(inputFileName,expectedCount,splitSize,"PigStorage()");
  }
  finally {
    Util.deleteFile(cluster,inputFileName);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests the case where a bzip block ends exactly at the end of the {@link InputSplit}with the block header ending a few bits into the last byte of current
 * InputSplit. This case results in dropped records in Pig 0.6 release
 * This test also tests that bzip files couple of dirs deep can be read by
 * specifying the top level dir.
 */
@Test public void testBlockHeaderEndingAtSplitNotByteAligned() throws IOException {
  String inputFileName="test/org/apache/pig/test/data/bzipdir1.bz2";
  Long expectedCount=74999L;
  int splitSize=136500;
  try {
    Util.copyFromLocalToCluster(cluster,inputFileName,inputFileName);
    testCount(inputFileName,expectedCount,splitSize,"PigStorage()");
    testCount(inputFileName,expectedCount,splitSize,"TextLoader()");
  }
  finally {
    Util.deleteFile(cluster,inputFileName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBinInterSedes </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test sedes tuple of diff sizes
 * @throws IOException
 */
@Test public void testTupleWriteReadDiffSizes() throws IOException {
  Tuple smallTuple=createTupleWithManyCols(1000);
  testTupleSedes(smallTuple);
  Tuple largeTuple=createTupleWithManyCols(100 * 1000);
  testTupleSedes(largeTuple);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test sedes  with maps of diff sizes
 * @throws IOException
 */
@Test public void testTupleWriteReadMapDiffSizes() throws IOException {
  Tuple tuple=TupleFactory.getInstance().newTuple();
  Map<String,Object> tinyMap=createMap(10);
  Map<String,Object> smallMap=createMap(1000);
  Map<String,Object> largeMap=createMap(100 * 1024);
  tuple.append(tinyMap);
  tuple.append(smallMap);
  tuple.append(largeMap);
  testTupleSedes(tuple);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test sedes of int of diff sizes
 * @throws IOException
 */
@Test public void testTupleWriteReadIntDiffSizes() throws IOException {
  Tuple tuple=TupleFactory.getInstance().newTuple();
  tuple.append(new Integer(0));
  tuple.append(new Integer(1));
  tuple.append(new Integer(125));
  tuple.append(new Integer(1024));
  tuple.append(new Integer(1024 * 1024 * 1024));
  testTupleSedes(tuple);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test sedes of bytearray, string of diff sizes
 * @throws IOException
 */
@Test public void testTupleWriteReadByteArrStringDiffSizes() throws IOException {
  Tuple tuple=TupleFactory.getInstance().newTuple();
  byte[] tinyBA=new byte[10];
  byte[] smallBA=new byte[1000];
  byte[] largeBytearray=new byte[80000];
  for (int i=0; i < largeBytearray.length; i++) {
    largeBytearray[i]='1';
  }
  tuple.append(new DataByteArray(tinyBA));
  tuple.append(new DataByteArray(smallBA));
  tuple.append(new DataByteArray(largeBytearray));
  testTupleSedes(tuple);
  tuple=TupleFactory.getInstance().newTuple();
  tuple.append(new String(""));
  tuple.append(new String("x"));
  tuple.append(new String(largeBytearray));
  testTupleSedes(tuple);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleWriteReadLongDiffSizes() throws IOException {
  Random r=new Random(100L);
  Tuple tuple=TupleFactory.getInstance().newTuple();
  tuple.append(new Long(0));
  tuple.append(new Long(1));
  tuple.append(new Long(-1));
  tuple.append(new Long(300));
  tuple.append(new Long(600));
  tuple.append(new Long(10000));
  tuple.append(new Long(-10000));
  tuple.append(new Long(5000000000000000000L));
  tuple.append(new Long(-5000000000000000000L));
  for (int i=0; i < 100000; i++) {
    tuple.append(new Long(r.nextLong()));
  }
  testTupleSedes(tuple);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * See PIG-2936. The purpose of this test is to ensure that Tuples are being serialized in
 * the specific way that we expect.
 */
@Test public void testTupleSerializationSpecific() throws Exception {
  byte[] flags={BinInterSedes.TUPLE_0,BinInterSedes.TUPLE_1,BinInterSedes.TUPLE_2,BinInterSedes.TUPLE_3,BinInterSedes.TUPLE_4,BinInterSedes.TUPLE_5,BinInterSedes.TUPLE_6,BinInterSedes.TUPLE_7,BinInterSedes.TUPLE_8,BinInterSedes.TUPLE_9};
  for (int i=0; i < flags.length; i++) {
    Tuple t=mTupleFactory.newTuple(i);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    DataOutput out=new DataOutputStream(baos);
    out.writeByte(flags[i]);
    for (int j=0; j < i; j++) {
      Integer val=Integer.valueOf(random.nextInt());
      bis.writeDatum(out,val);
      t.set(j,val);
    }
    testSerTuple(t,baos.toByteArray());
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test sedes  with bags of diff sizes
 * @throws IOException
 */
@Test public void testTupleWriteReadBagDiffSizes() throws IOException {
  Tuple tuple=TupleFactory.getInstance().newTuple();
  DataBag tinyBag=createBag(10);
  DataBag smallBag=createBag(1000);
  DataBag largeBag=createBag(100 * 1024);
  tuple.append(tinyBag);
  tuple.append(smallBag);
  tuple.append(largeBag);
  testTupleSedes(tuple);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBinaryExpressionOps </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArithmeticOperators() throws Exception {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("A = LOAD '" + INPUT_1 + "' AS (id:chararray, val:long);");
  pig.registerQuery("B = LOAD '" + INPUT_2 + "' AS (id:chararray, val:long);");
  pig.registerQuery("C = COGROUP A BY id, B BY id;");
  pig.registerQuery("D = FOREACH C GENERATE group, SUM(B.val), SUM(A.val), " + "(SUM(A.val) - SUM(B.val)), (SUM(A.val) + SUM(B.val)), " + "(SUM(A.val) * SUM(B.val)), (SUM(A.val) / SUM(B.val)), "+ "(SUM(A.val) % SUM(B.val)), (SUM(A.val) < 0 ? SUM(A.val) : SUM(B.val));");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('id1',2L,null,null,null,null,null,null,null)","('id2',2L,10L,8L,12L,20L,5L,0L,2L)"});
  Iterator<Tuple> iter=pig.openIterator("D");
  Util.checkQueryOutputsAfterSort(iter,expectedResults);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBlackAndWhitelistValidator </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is to test the script fails when used with {@link PigServer}, which
 * uses {@link QueryParser} and not the {@link GruntParser}
 */
@Test(expected=FrontendException.class) public void testWhitelistWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_WHITELIST,"load");
  PigServer pigServer=new PigServer(ctx);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This test must pass as we allow load, store, filter to be a part of the
 * whitelist. The logical plan being checked in this test contains these
 * operators only.
 * @throws Exception
 */
@Test public void testWhitelist1() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_WHITELIST,"load, store,filter");
  LogicalPlan plan=generateLogicalPlan("foo","bar",ctx.getDfs());
  LogicalRelationalNodeValidator executor=new BlackAndWhitelistValidator(ctx,plan);
  executor.validate();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test mkdirs fails if its disallowed via the blacklist
 */
@Test(expected=FrontendException.class) public void testBlacklistMkdirWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"mkdir");
  PigServer pigServer=new PigServer(ctx);
  pigServer.mkdirs("foo");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is to test the script fails when used with {@link PigServer}, which
 * uses {@link QueryParser} and not the {@link GruntParser}
 */
@Test(expected=FrontendException.class) public void testBlacklistWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"order");
  PigServer pigServer=new PigServer(ctx);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test deleteFile fails if its disallowed via the blacklist
 */
@Test(expected=FrontendException.class) public void testBlacklistRemoveWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"rm");
  PigServer pigServer=new PigServer(ctx);
  pigServer.deleteFile("foo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=org.apache.pig.backend.executionengine.ExecException.class) public void testInvalidInputToBagToTupleUDF() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,tf.newTuple());
  BagToTuple udf=new BagToTuple();
  udf.exec(udfInput);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=org.apache.pig.backend.executionengine.ExecException.class) public void testInvalidInputForBagToStringUDF() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,tf.newTuple());
  BagToString udf=new BagToString();
  udf.exec(udfInput);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=java.lang.RuntimeException.class) public void testInvalidOutputSchemaForBagToTupleStringUDF() throws Exception {
  FieldSchema tupSch=new FieldSchema(null,DataType.TUPLE);
  tupSch.schema=new Schema();
  tupSch.schema.add(new FieldSchema(null,DataType.INTEGER));
  tupSch.schema.add(new FieldSchema(null,DataType.CHARARRAY));
  FieldSchema bagSch=new FieldSchema(null,DataType.BAG);
  bagSch.schema=new Schema(tupSch);
  Schema inputSch=new Schema();
  inputSch.add(bagSch);
  inputSch.add(new FieldSchema(null,DataType.DOUBLE));
  BagToString udf=new BagToString();
  udf.outputSchema(inputSch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where an empty bag is given as input to
 * the Initial function and the output is fed to Intermediate
 * function whose output is fed to the Final function
 * @throws Exception
 */
@Test public void testAggEmptyBagWithCombiner() throws Exception {
  for (  String[] aggGroup : aggs) {
    String[] aggFinalTypes=null;
    String[] aggInitialTypes=null;
    String[] aggIntermediateTypes=null;
    for (    String stage : stages) {
      String[] aggTypesArray=null;
      if (stage.equals("Initial")) {
        aggInitialTypes=new String[aggGroup.length];
        aggTypesArray=aggInitialTypes;
      }
 else       if (stage.equals("Intermediate")) {
        aggIntermediateTypes=new String[aggGroup.length];
        aggTypesArray=aggIntermediateTypes;
      }
 else {
        aggFinalTypes=new String[aggGroup.length];
        aggTypesArray=aggFinalTypes;
      }
      for (int i=0; i < aggTypesArray.length; i++) {
        aggTypesArray[i]=aggGroup[i] + stage;
      }
    }
    for (int k=0; k < aggFinalTypes.length; k++) {
      EvalFunc<?> aggInitial=evalFuncMap.get(aggInitialTypes[k]);
      DataBag intermediateInputBg1=bagFactory.newDefaultBag();
      DataBag intermediateInputBg2=bagFactory.newDefaultBag();
      Tuple outputTuple=null;
      for (int i=0; i < 10; i++) {
        DataBag initialInputBg=bagFactory.newDefaultBag();
        Tuple initialInputTuple=tupleFactory.newTuple(initialInputBg);
        if (i < 5) {
          outputTuple=(Tuple)aggInitial.exec(initialInputTuple);
          checkZeroOrNull(aggInitial,outputTuple.get(0));
          intermediateInputBg1.add(outputTuple);
        }
 else {
          outputTuple=(Tuple)aggInitial.exec(initialInputTuple);
          checkZeroOrNull(aggInitial,outputTuple.get(0));
          intermediateInputBg2.add(outputTuple);
        }
      }
      EvalFunc<?> aggIntermediate=evalFuncMap.get(aggIntermediateTypes[k]);
      DataBag finalInputBg=bagFactory.newDefaultBag();
      Tuple intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg1);
      outputTuple=(Tuple)aggIntermediate.exec(intermediateInputTuple);
      checkZeroOrNull(aggIntermediate,outputTuple.get(0));
      finalInputBg.add(outputTuple);
      intermediateInputTuple=tupleFactory.newTuple(intermediateInputBg2);
      outputTuple=(Tuple)aggIntermediate.exec(intermediateInputTuple);
      checkZeroOrNull(aggIntermediate,outputTuple.get(0));
      finalInputBg.add(outputTuple);
      Tuple finalInputTuple=tupleFactory.newTuple(finalInputBg);
      EvalFunc<?> aggFinal=evalFuncMap.get(aggFinalTypes[k]);
      Object output=aggFinal.exec(finalInputTuple);
      checkZeroOrNull(aggFinal,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMINAccumulate() throws Exception {
  String[] minTypes={"MIN","LongMin","IntMin","FloatMin","BigDecimalMin","BigIntegerMin","StringMin","DateTimeMin"};
  for (int k=0; k < minTypes.length; k++) {
    Accumulator<?> min=(Accumulator<?>)evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple[] tuples=inputMapForAccumulate.get(inputType);
    for (    Tuple tup : tuples)     min.accumulate(tup);
    Object output=min.getValue();
    String msg="[Testing " + minTypes[k] + " accumulate on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),output);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMINIntermediate() throws Exception {
  String[] minTypes={"MINIntermediate","LongMinIntermediate","IntMinIntermediate","FloatMinIntermediate","BigDecimalMinIntermediate","BigIntegerMinIntermediate","StringMinIntermediate","DateTimeMinIntermediate"};
  for (int k=0; k < minTypes.length; k++) {
    EvalFunc<?> min=evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=min.exec(tup);
    String msg="[Testing " + minTypes[k] + " on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ ((Tuple)output).get(0)+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),((Tuple)output).get(0));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUniqueID() throws Exception {
  Util.resetStateForExecModeSwitch();
  String inputFileName="testUniqueID.txt";
  Util.createInputFile(cluster,inputFileName,new String[]{"1\n2\n3\n4\n5\n1\n2\n3\n4\n5\n"});
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.getPigContext().getProperties().setProperty("mapred.max.split.size","10");
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","true");
  pigServer.registerQuery("A = load '" + inputFileName + "' as (name);");
  pigServer.registerQuery("B = foreach A generate name, UniqueID();");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  iter.next().get(1).equals("0-0");
  iter.next().get(1).equals("0-1");
  iter.next().get(1).equals("0-2");
  iter.next().get(1).equals("0-3");
  iter.next().get(1).equals("0-4");
  iter.next().get(1).equals("1-0");
  iter.next().get(1).equals("1-1");
  iter.next().get(1).equals("1-1");
  iter.next().get(1).equals("1-2");
  iter.next().get(1).equals("1-3");
  iter.next().get(1).equals("1-4");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMAXAccumulate() throws Exception {
  String[] maxTypes={"MAX","LongMax","IntMax","FloatMax","BigDecimalMax","BigIntegerMax","StringMax","DateTimeMax"};
  for (int k=0; k < maxTypes.length; k++) {
    Accumulator<?> max=(Accumulator<?>)evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple[] tuples=inputMapForAccumulate.get(inputType);
    for (    Tuple tup : tuples)     max.accumulate(tup);
    Object output=max.getValue();
    String msg="[Testing " + maxTypes[k] + " accumulate on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),output);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMAXFinal() throws Exception {
  String[] maxTypes={"MAXFinal","LongMaxFinal","IntMaxFinal","FloatMaxFinal","BigDecimalMaxFinal","BigIntegerMaxFinal","StringMaxFinal","DateTimeMaxFinal"};
  for (int k=0; k < maxTypes.length; k++) {
    EvalFunc<?> max=evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=max.exec(tup);
    String msg="[Testing " + maxTypes[k] + " on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),output);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the case where an empty bag is given as input to the non
 * combiner version of aggregate functions
 * @throws Exception if there are issues executing the aggregate function
 */
@Test public void testAggEmptyBag() throws Exception {
  for (  String[] aggGroup : aggs) {
    for (int k=0; k < aggGroup.length; k++) {
      EvalFunc<?> agg=evalFuncMap.get(aggGroup[k]);
      DataBag inputBag=bagFactory.newDefaultBag();
      Tuple inputTuple=tupleFactory.newTuple(inputBag);
      Object output=agg.exec(inputTuple);
      checkZeroOrNull(agg,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMAXIntermed() throws Exception {
  String[] maxTypes={"MAXIntermediate","LongMaxIntermediate","IntMaxIntermediate","FloatMaxIntermediate","BigDecimalMaxIntermediate","BigIntegerMaxIntermediate","StringMaxIntermediate","DateTimeMaxIntermediate"};
  for (int k=0; k < maxTypes.length; k++) {
    EvalFunc<?> max=evalFuncMap.get(maxTypes[k]);
    String inputType=getInputType(maxTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=max.exec(tup);
    String msg="[Testing " + maxTypes[k] + " on input type: "+ getInputType(maxTypes[k])+ " ( (output) "+ ((Tuple)output).get(0)+ " == "+ getExpected(maxTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(maxTypes[k]),((Tuple)output).get(0));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMINFinal() throws Exception {
  String[] minTypes={"MINFinal","LongMinFinal","IntMinFinal","FloatMinFinal","BigDecimalMinFinal","BigIntegerMinFinal","StringMinFinal","DateTimeMinFinal"};
  for (int k=0; k < minTypes.length; k++) {
    EvalFunc<?> min=evalFuncMap.get(minTypes[k]);
    String inputType=getInputType(minTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=min.exec(tup);
    String msg="[Testing " + minTypes[k] + " on input type: "+ getInputType(minTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(minTypes[k])+ " (expected) )]";
    assertForInputType(inputType,msg,getExpected(minTypes[k]),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltinInvoker </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testManyConcat() throws Exception {
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : chardata) {
    String str=(String)t.get(0);
    expected.add(mTupleFactory.newTuple(str + str + str+ str));
  }
  pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate invoke(invoke(invoke(x)concat(x))concat(x))concat(x);");
  pigServer.registerQuery("store b into 'res' using mock.Storage();");
  List<Tuple> results=data.get("res");
  dataIsEqual(expected,results);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValueOf() throws Exception {
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : charintdata) {
    String str=(String)t.get(0);
    expected.add(mTupleFactory.newTuple(Integer.valueOf(str)));
  }
  pigServer.registerQuery("a = load 'charintdata' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate invoke&Integer.valueOf(x);");
  pigServer.registerQuery("store b into 'res' using mock.Storage();");
  List<Tuple> results=data.get("res");
  dataIsEqual(expected,results);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConcat() throws Exception {
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : chardata) {
    String str=(String)t.get(0);
    expected.add(mTupleFactory.newTuple(str + str));
  }
  pigServer.registerQuery("a = load 'chardata' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate invoke(x)concat(x);");
  pigServer.registerQuery("store b into 'res' using mock.Storage();");
  List<Tuple> results=data.get("res");
  dataIsEqual(expected,results);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringSize() throws Exception {
  Set<Tuple> input=Sets.newHashSet();
  Set<Tuple> expected=Sets.newHashSet();
  for (int i=0; i < 1000; i++) {
    String val=Integer.toString(r.nextInt());
    input.add(tuple(val));
    expected.add(tuple(val,val.length()));
  }
  data.set("foo",Utils.getSchemaFromString("x:chararray"),input);
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate $0, invoke($0)length();");
  pigServer.registerQuery("store b into 'bar' using mock.Storage();");
  dataIsEqual(expected,data.get("bar"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCmdLineParser </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegister(){
  String[] args={"a","b","c"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('c',null,CmdLineParser.ValueExpected.OPTIONAL);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NumberFormatException.class) public void testParseValueStrForInt() throws ParseException {
  String[] args={"-alpha","b"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  p.getNextOpt();
  Integer ii=p.getValInt();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCombiner </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnCluster() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  String inputFileName=runTest(pigServer);
  Util.deleteFile(cluster,inputFileName);
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupByLimit() throws Exception {
  String input[]={"ABC 1","ABC 2","DEF 1","XYZ 1","XYZ 2","XYZ 3"};
  Util.createInputFile(cluster,"testGroupLimit.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'testGroupLimit.txt'  using PigStorage(' ') " + "as (str:chararray, num1:int) ;");
  pigServer.registerQuery("b = group a by str;");
  pigServer.registerQuery("c = foreach b  generate group, COUNT(a.num1) ; ");
  pigServer.registerQuery("d = limit c 2 ; ");
  checkCombinerUsed(pigServer,"d",true);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"('ABC',2L)","('DEF',1L)"});
  Iterator<Tuple> it=pigServer.openIterator("d");
  Util.checkQueryOutputsAfterSort(it,expectedRes);
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocal() throws Exception {
  FileLocalizer.deleteTempFiles();
  runTest(new PigServer("local"));
  FileLocalizer.deleteTempFiles();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupElements() throws Exception {
  String input[]={"ABC\t1\ta\t1","ABC\t1\tb\t2","ABC\t1\ta\t3","ABC\t2\tb\t4","DEF\t1\td\t1","XYZ\t1\tx\t2"};
  Util.createInputFile(cluster,"testGroupElements.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'testGroupElements.txt' as (str:chararray, num1:int, alph : chararray, num2 : int);");
  pigServer.registerQuery("b = group a by (str, num1);");
  pigServer.registerQuery("c = foreach b  generate flatten(group), COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",true);
  pigServer.registerQuery("c = foreach b  generate group, COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",true);
  pigServer.registerQuery("c = foreach b  generate group, a,  COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",false);
  pigServer.registerQuery("c = foreach b  generate group, a.num2,  COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",false);
  pigServer.registerQuery("c = foreach b  generate group.$0, group.$1, COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",true);
  pigServer.registerQuery("c = foreach b  generate group.$0, group.$1 + COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",true);
  pigServer.registerQuery("c = foreach b  generate group.str, group.$1, COUNT(a.alph), SUM(a.num2); ");
  checkCombinerUsed(pigServer,"c",true);
  pigServer.registerQuery("c = foreach b  generate group.str, group.$1, COUNT(a.alph), SUM(a.num2), " + " (group.num1 == 1 ? (COUNT(a.num2) + 1)  : (SUM(a.num2) + 10)) ; ");
  checkCombinerUsed(pigServer,"c",true);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"('ABC',1,3L,6L,4L)","('ABC',2,1L,4L,14L)","('DEF',1,1L,1L,2L)","('XYZ',1,1L,2L,2L)"});
  Iterator<Tuple> it=pigServer.openIterator("c");
  Util.checkQueryOutputsAfterSort(it,expectedRes);
  Util.deleteFile(cluster,"distinctAggs1Input.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConstantCalculator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test() throws Exception {
  assertQuerySame("b = filter (load 'd.txt' as (id:int, v1, v2)) by id > 3+5;" + "store b into 'empty';","b = filter (load 'd.txt' as (id:int, v1, v2)) by id > 8;" + "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (id:int, v1, v2)) generate id * (3 * 5);" + "store b into 'empty';","b = foreach (load 'd.txt' as (id:int, v1, v2)) generate id * 15;" + "store b into 'empty';");
  assertQuerySame("b = filter (load 'd.txt' as (id:int, v1, v2)) by 5 + 1 > 3 and -1 < 4;" + "store b into 'empty';","b = filter (load 'd.txt' as (id:int, v1, v2)) by true;" + "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (d:double)) generate (int)5.0;" + "store b into 'empty';","b = foreach (load 'd.txt' as (d:double)) generate 5;" + "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (d:double)) generate ((int)15.89 + 5) * 5 / 25 % 3;" + "store b into 'empty';","b = foreach (load 'd.txt' as (d:double)) generate 1;" + "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (v1)) generate UPPER(CONCAT('a', CONCAT('b', 'c'), 'd'));" + "store b into 'empty';","b = foreach (load 'd.txt' as (v1)) generate 'ABCD';" + "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (v1)) generate " + NoCalc.class.getName() + "('2');"+ "store b into 'empty';","b = foreach (load 'd.txt' as (v1)) generate " + NoCalc.class.getName() + "('2');"+ "store b into 'empty';");
  assertQuerySame("b = foreach (load 'd.txt' as (v1)) generate " + StringSpecified.class.getName() + "();"+ "store b into 'empty';","b = foreach (load 'd.txt' as (v1)) generate '1';" + "store b into 'empty';");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCounters </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedInputCounters() throws Exception {
  testInputCounters("skewed");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinInputCounters() throws Exception {
  testInputCounters("join");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupInputCounters() throws Exception {
  testInputCounters("cogroup");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinInputCounters() throws Exception {
  testInputCounters("self-join");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBag </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataBagIterIdempotent() throws Exception {
  DataBag bg0=new DefaultDataBag();
  processDataBag(bg0,true);
  DataBag bg1=new DistinctDataBag();
  processDataBag(bg1,true);
  DataBag bg2=new InternalDistinctBag();
  processDataBag(bg2,true);
  DataBag bg3=new InternalSortedBag();
  processDataBag(bg3,true);
  DataBag bg4=new SortedDataBag(null);
  processDataBag(bg4,true);
  DataBag bg5=new InternalCachedBag(0,0);
  processDataBag(bg5,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestTuple() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  int[][] input1={{1,2,3,4,5},{1,2,3,4,5},{1,2,3,4,5},{1,2,3,4,5},{1,2,3,4,5}};
  int[][] input2={{1,2},{1,2}};
  Tuple n1=Util.loadNestTuple(tf.newTuple(input1.length),input1);
  Tuple n2=tf.newTuple();
  n2=Util.loadNestTuple(tf.newTuple(input2.length),input2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapConversion() throws Exception {
  Map<Integer,Float> map=new HashMap<Integer,Float>();
  DataType.toMap(map);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEqualTo </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBooleanAndNullValues() throws Exception {
  checkNullValues(DataType.BOOLEAN,Boolean.TRUE);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestErrorHandlingStoreFunc </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Pig job succeeds even with errors within threshold
 */
@Test public void testStorerWithErrorInLimit() throws Exception {
  updatePigProperties(true,3L,0.4);
  runTest(JOB_STATUS.COMPLETED);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Pig job fails if errors exceed min errors and threshold
 */
@Test public void testStorerWithErrorOutExceedingLimit() throws Exception {
  updatePigProperties(true,2L,0.3);
  runTest(JOB_STATUS.FAILED);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Pig Job with multiple stores.
 * @throws Exception
 */
@Test public void testMultiStore() throws Exception {
  updatePigProperties(true,3L,0.4);
  pigServer.getPigContext().getProperties().put(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  Data data=Storage.resetData(pigServer);
  final Collection<Tuple> list=Lists.newArrayList();
  int rows=10;
  for (int i=0; i < rows; i++) {
    Tuple t=TupleFactory.getInstance().newTuple();
    t.append(i);
    t.append("a" + i);
    list.add(t);
  }
  data.set("in","id:int,name:chararray",list);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD 'in' USING mock.Storage();");
  String storeAQuery="store A into '" + tempDir.getAbsolutePath() + "/output' using "+ TestErroroneousStoreFunc.class.getName()+ "();";
  pigServer.registerQuery(storeAQuery);
  pigServer.registerQuery("B = FILTER A by id >0;");
  String storeBQuery="store B into '" + tempDir.getAbsolutePath() + "/output2' using "+ TestErroroneousStoreFunc2.class.getName()+ "();";
  pigServer.registerQuery(storeBQuery);
  if (pigServer.executeBatch().get(0).getStatus() != JOB_STATUS.COMPLETED) {
    throw new RuntimeException("Job failed",pigServer.executeBatch().get(0).getException());
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Pig Job fails on error if the config is set to false
 * @throws Exception
 */
@Test public void testStorerWithConfigNotEnabled() throws Exception {
  updatePigProperties(false,3L,0.3);
  runTest(JOB_STATUS.FAILED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSort() throws Exception {
  testSortDistinct(false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Exception {
  testSortDistinct(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByLimitJoin() throws Exception {
  String[] input1={"1\t1","1\t2"};
  Util.createInputFile(cluster,"table_testOrderByLimitJoin",input1);
  pigServer.registerQuery("a = load 'table_testOrderByLimitJoin' as (a0, a1);");
  pigServer.registerQuery("b = group a by a0;");
  pigServer.registerQuery("c = foreach b generate group as c0, COUNT(a) as c1;");
  pigServer.registerQuery("d = order c by c1 parallel 2;");
  pigServer.registerQuery("e = limit d 10;");
  pigServer.registerQuery("f = join e by c0, a by a0;");
  Iterator<Tuple> iter=pigServer.openIterator("f");
  String[] expected=new String[]{"(1,2,1,1)","(1,2,1,2)"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pigServer.dumpSchema("f")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyBagIterator() throws Exception {
  String[] input1={"1","1","1"};
  String[] input2={"2","2"};
  Util.createInputFile(cluster,"input1",input1);
  Util.createInputFile(cluster,"input2",input2);
  pigServer.registerQuery("A = load 'input1' as (a1:int);");
  pigServer.registerQuery("B = load 'input2' as (b1:int);");
  pigServer.registerQuery("C = COGROUP A by a1, B by b1;");
  pigServer.registerQuery("C1 = foreach C { Alim = limit A 1; Blim = limit B 1; generate Alim, Blim; };");
  pigServer.registerQuery("D1 = FOREACH C1 generate Alim,Blim, (IsEmpty(Alim)? 0:1), (IsEmpty(Blim)? 0:1), COUNT(Alim), COUNT(Blim);");
  Iterator<Tuple> iter=pigServer.openIterator("D1");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"({(1)},{},1,0,1L,0L)","({},{(2)},0,1,0L,1L)"});
  Util.checkQueryOutputsAfterSort(iter,expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDereferencePartialAlias() throws Exception {
  pigServer.registerQuery("a = load '1.txt' as (a0:int, a1);");
  pigServer.registerQuery("b = group a by a0;");
  pigServer.registerQuery("c = foreach b generate flatten(a);");
  pigServer.registerQuery("d = cogroup c by (a0);");
  pigServer.registerQuery("e = foreach d generate c.a0 as e0;");
  pigServer.registerQuery("f = foreach e generate e0;");
  pigServer.explain("f",System.out);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitFlatten() throws Exception {
  String[] input={"1\tA","1\tB","2\tC","3\tD","3\tE","3\tF"};
  Util.createInputFile(cluster,"table_testLimitFlatten",input);
  pigServer.registerQuery("data = load 'table_testLimitFlatten' as (k,v);");
  pigServer.registerQuery("grouped = GROUP data BY k;");
  pigServer.registerQuery("selected = LIMIT grouped 2;");
  pigServer.registerQuery("flattened = FOREACH selected GENERATE FLATTEN (data);");
  Iterator<Tuple> iter=pigServer.openIterator("flattened");
  String[] expected=new String[]{"(1,A)","(1,B)","(2,C)"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pigServer.dumpSchema("flattened")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortWithUDF() throws Exception {
  testSortDistinct(false,true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Exception {
  testSortDistinct(true,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFinish </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFinishInReduceMR() throws Exception {
  String inputFileName=setUp(cluster.getExecType());
  String expectedFileName="testFinishInReduceMR-finish.txt";
  pigServer.registerQuery("define MYUDF " + MyEvalFunction.class.getName() + "('MAPREDUCE','"+ expectedFileName+ "');");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputFileName) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("a1 = group a by $1;");
  pigServer.registerQuery("b = foreach a1 generate MYUDF" + "(*);");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    iter.next();
  }
  checkAndCleanup(cluster.getExecType(),expectedFileName,inputFileName);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFinishInMapLoc() throws Exception {
  String inputFileName=setUp(ExecType.LOCAL);
  String expectedFileName="testFinishInMapLoc-finish.txt";
  pigServer.registerQuery("define MYUDF " + MyEvalFunction.class.getName() + "('LOCAL','"+ expectedFileName+ "');");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputFileName) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = foreach a generate MYUDF" + "(*);");
  pigServer.openIterator("b");
  checkAndCleanup(ExecType.LOCAL,expectedFileName,inputFileName);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFinishInReduceLoc() throws Exception {
  String inputFileName=setUp(ExecType.LOCAL);
  String expectedFileName="testFinishInReduceLoc-finish.txt";
  pigServer.registerQuery("define MYUDF " + MyEvalFunction.class.getName() + "('LOCAL','"+ expectedFileName+ "');");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputFileName) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("a1 = group a by $1;");
  pigServer.registerQuery("b = foreach a1 generate MYUDF" + "(*);");
  pigServer.openIterator("b");
  checkAndCleanup(ExecType.LOCAL,expectedFileName,inputFileName);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFinishInMapMR() throws Exception {
  String inputFileName=setUp(cluster.getExecType());
  String expectedFileName="testFinishInMapMR-finish.txt";
  pigServer.registerQuery("define MYUDF " + MyEvalFunction.class.getName() + "('MAPREDUCE','"+ expectedFileName+ "');");
  pigServer.registerQuery("a = load '" + Util.encodeEscape(inputFileName) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = foreach a generate MYUDF" + "(*);");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  while (iter.hasNext()) {
    iter.next();
  }
  checkAndCleanup(cluster.getExecType(),expectedFileName,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlanLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInnerLimit() throws Exception {
  File tmpFile=genDataSetFileOneGroup();
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = group a by $0; ");
  pig.registerQuery("c = foreach b { " + "     c1 = limit $1 5; " + "    generate COUNT(c1); "+ "};");
  Iterator<Tuple> it=pig.openIterator("c");
  List<Tuple> expected=Util.getTuplesFromConstantTupleStrings(new String[]{"(5L)","(5L)","(3L)"});
  Util.checkQueryOutputsAfterSort(it,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGTOrEqual </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGreaterThan </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGroupConstParallel </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test parallelism for group by constant
 * @throws Throwable
 */
@Test public void testGroupConstWithParallel() throws Throwable {
  PigContext pc=new PigContext(cluster.getExecType(),cluster.getProperties());
  pc.defaultParallel=100;
  pc.connect();
  String query="a = load '" + INPUT_FILE + "';\n"+ "b = group a by 1;"+ "store b into 'output';";
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  checkGroupConstWithParallelResult(pp,pc);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test parallelism for group by column
 * @throws Throwable
 */
@Test public void testGroupNonConstWithParallel() throws Throwable {
  PigContext pc=new PigContext(cluster.getExecType(),cluster.getProperties());
  pc.defaultParallel=100;
  pc.connect();
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String query="a = load '" + INPUT_FILE + "';\n"+ "b = group a by $0;"+ "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  checkGroupNonConstWithParallelResult(pp,pc);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test parallelism for group all
 * @throws Exception
 */
@Test public void testGroupAllWithParallel() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:chararray);");
  pigServer.registerQuery("B = group A all parallel 5;");
{
    Iterator<Tuple> iter=pigServer.openIterator("B");
    List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"('all',{('one'),('two'),('two')})"});
    Util.checkQueryOutputsAfterSort(iter,expectedRes);
    JobGraph jGraph=PigStats.get().getJobGraph();
    checkGroupAllWithParallelGraphResult(jGraph);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGrunt </h4><pre class="type-20 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeepGoing() throws Throwable {
  Assume.assumeTrue("Skip this test for TEZ",Util.isMapredExecType(cluster.getExecType()));
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String filename=Util.generateURI("file:test/org/apache/pig/test/data/passwd",context);
  String strCmd="rmf bar;" + "rmf foo;" + "rmf baz;"+ "A = load '" + filename + "';"+ "B = foreach A generate 1;"+ "C = foreach A generate 0/0;"+ "store B into 'foo';"+ "store C into 'bar';"+ "A = load '"+ filename+ "';"+ "B = stream A through `false`;"+ "store B into 'baz';"+ "cat bar;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingWordWithAsInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast); " + "b = group a by foo; c = foreach b {generate SUM(a.fast);};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript2() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate2.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * PIG-2084
 * Check if only statements used in query are validated, in non-interactive
 * /non-check mode. There is an  'unused' statement in query that would otherise
 * fail the validation.
 * Primary purpose of test is to verify that check not happening for
 * every statement.
 * @throws Throwable
 */
@Test public void testExplainScriptIsEachStatementValidated() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate);" + "b = foreach a generate foo + 'x' + 1;" + "c = foreach a generate foo, fast;"+ "explain c; ";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckScriptSyntaxWithSemiColonUDFErr() throws Throwable {
  String query="a = load 'i1' as (f1:chararray);" + "c = foreach a generate REGEX_EXTRACT(f1, '.;' ,1); dump c;";
  ArrayList<String> msgs=new ArrayList<String>();
  validate(query,true,msgs.toArray(new String[0]));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainEmpty() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); run " + basedir + "/testsubnested_run.pig; explain";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingWordWithAsInForeachWithOutBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast); " + "b = group a by foo; c = foreach b generate SUM(a.fast);\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckScriptSyntaxErr() throws Throwable {
  String query="a = load '1.txt' ;  fs -rmr foo; mv foo bar; dump a;" + "store a into 'input-copy.txt' ; dump a; a = load '2.txt' as " + "(b:chararay);explain a; rm foo; store a into 'bar';";
  String[] cmds=new String[]{"'fs'","'mv'","'dump'"};
  ArrayList<String> msgs=new ArrayList<String>();
  for (  String c : cmds) {
    msgs.add(c + " statement is ignored while processing " + "'explain -script' or '-check'");
  }
  msgs.add("Syntax error");
  validate(query,false,msgs.toArray(new String[0]));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagConstantWithSchema() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'; b = foreach a generate " + "{(1, '1', 0.4f),(2, '2', 0.45)} as " + "b: bag{t:(i: int, c:chararray, d: double)};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainDot() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); explain -dot -script " + basedir + "/testsubnested_run.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCD() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="mkdir /tmp;" + "mkdir /tmp/foo;" + "cd /tmp;"+ "rmf bar; rmf foo/baz;"+ "copyFromLocal test/org/apache/pig/test/data/passwd bar;"+ "a = load 'bar';"+ "cd foo;"+ "store a into 'baz';"+ "cd /;"+ "rm /tmp/bar; rm /tmp/foo/baz;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainOut() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); explain -out /tmp -script " + basedir + "/testsubnested_run.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopyFromLocal() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="copyFromLocal README.txt sh_copy ;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagConstant() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'; b = foreach a generate {(1, '1', 0.4f),(2, '2', 0.45)};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingAsGenerateInForeachWithOutBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); " + "b = group a by foo; c = foreach b generate " + "{(1, '1', 0.4f),(2, '2', 0.45)} "+ "as b: bag{t:(i: int, cease:chararray, degenerate: double)}, "+ "SUM(a.fast) as fast, a.regenerate as degenerated;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-20 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrate() throws Throwable {
  Assume.assumeTrue("Skip this test for TEZ. See PIG-3993",Util.isMapredExecType(cluster.getExecType()));
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="rmf bla;" + "a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/passwd",context) + "';"+ "e = group a by $0;"+ "f = foreach e generate group, COUNT($1);"+ "store f into 'bla';"+ "f1 = load 'bla' as (f:chararray);"+ "g = order f1 by $0;"+ "illustrate g;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFileCmds() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="rmf bar; rmf baz;" + "a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/passwd",context) + "';"+ "store a into 'bar';"+ "cp bar baz;"+ "rm bar; rm baz;"+ "store a into 'baz';"+ "store a into 'bar';"+ "rm baz; rm bar;"+ "store a into 'baz';"+ "mv baz bar;"+ "b = load 'bar';"+ "store b into 'baz';"+ "cat baz;"+ "rm baz;"+ "rm bar;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainBrief() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); explain -brief -script " + basedir + "/testsubnested_run.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript7() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate7.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainScript() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); explain -script " + basedir + "/testsubnested_run.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckScript() throws Throwable {
  String query="rmf input-copy.txt; cat 'foo'; a = load '1.txt' ; " + "aliases;illustrate a; copyFromLocal foo bar; copyToLocal foo bar; " + "describe a; mkdir foo; run bar.pig; exec bar.pig; cp foo bar; "+ "explain a;cd 'bar'; pwd; ls ; fs -ls ; fs -rmr foo; mv foo bar; "+ "dump a;store a into 'input-copy.txt' ; a = load '2.txt' as (b);"+ "explain a; rm foo; store a into 'bar';";
  String[] cmds=new String[]{"'rm/rmf'","'cp'","'cat'","'cd'","'pwd'","'copyFromLocal'","'copyToLocal'","'describe'","'ls'","'mkdir'","'illustrate'","'run/exec'","'fs'","'aliases'","'mv'","'dump'"};
  ArrayList<String> msgs=new ArrayList<String>();
  for (  String c : cmds) {
    msgs.add(c + " statement is ignored while processing " + "'explain -script' or '-check'");
  }
  validate(query,true,msgs.toArray(new String[0]));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingAsInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast); " + "b = group a by foo; c = foreach b " + "{generate SUM(a.fast) as fast;};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagConstantInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'; " + "b = foreach a {generate {(1, '1', 0.4f),(2, '2', 0.45)};};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingAsInForeachWithOutBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast); " + "b = group a by foo; c = foreach b generate SUM(a.fast) as fast;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRunStatmentNested() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); run " + basedir + "/testsubnested_run.pig; explain bar";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript6() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate6.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingGenerateInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); " + "b = group a by foo; c = foreach b {generate a.regenerate;};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagConstantWithSchemaInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'; " + "b = foreach a {generate {(1, '1', 0.4f),(2, '2', 0.45)} " + "as b: bag{t:(i: int, c:chararray, d: double)};};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRunStatment() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate);" + " run -param LIMIT=5 -param_file " + basedir + "/test_broken.ppf "+ basedir+ "/testsub.pig; explain bar";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckScriptTypeCheckErr() throws Throwable {
  String query="a = load 'foo.pig' as (s:chararray); dump a; explain a; " + "store a into 'foobar'; b = foreach a generate " + "(s == 2 ? 1 : 2.0); store b into 'bar';";
  String[] cmds=new String[]{"'dump'"};
  ArrayList<String> msgs=new ArrayList<String>();
  for (  String c : cmds) {
    msgs.add(c + " statement is ignored while processing " + "'explain -script' or '-check'");
  }
  msgs.add("incompatible types in Equal Operator");
  validate(query,false,msgs.toArray(new String[0]));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDump() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="rmf bla;" + "a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/passwd",context) + "';"+ "e = group a by $0;"+ "f = foreach e generate group, COUNT($1);"+ "store f into 'bla';"+ "f1 = load 'bla';"+ "g = order f1 by $1;"+ "dump g;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingWordWithAsInForeachWithOutBlock2() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="cash = load 'foo' as (foo, fast); " + "b = foreach cash generate fast * 2.0;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagSchema() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1' as (b: bag{t:(i: int, c:chararray, f: float)});\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript5() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate5.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckScriptTypeCheckErrNoStoreDump() throws Throwable {
  String query="a = load 'foo.pig' as (s:chararray); " + "b = foreach a generate $1;";
  String msg="Trying to access non-existent column";
  validateGruntCheckFail(query,msg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript4() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate4.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingGenerateInForeachWithOutBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); " + "b = group a by foo; c = foreach b generate a.regenerate;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateScript3() throws Throwable {
  PigServer server=new PigServer(ExecType.LOCAL,new Properties());
  PigContext context=server.getPigContext();
  String strCmd="illustrate -script " + basedir + "/illustrate3.pig;";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParsingAsGenerateInForeachBlock() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'foo' as (foo, fast, regenerate); " + "b = group a by foo; c = foreach b {generate " + "{(1, '1', 0.4f),(2, '2', 0.45)} "+ "as b: bag{t:(i: int, cease:chararray, degenerate: double)}, "+ "SUM(a.fast) as fast, a.regenerate as degenerated;};\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialExecution() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  FileLocalizer.setInitialized(false);
  String strCmd="rmf bar; rmf baz; " + "a = load '" + Util.generateURI("file:test/org/apache/pig/test/data/passwd",context) + "';"+ "store a into 'bar'; exec; a = load 'bar'; store a into 'baz';\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFsCommand() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="fs -ls /;" + "fs -mkdir /fstmp;" + "fs -mkdir /fstmp/foo;"+ "cd /fstmp;"+ "fs -copyFromLocal test/org/apache/pig/test/data/passwd bar;"+ "a = load 'bar';"+ "cd foo;"+ "store a into 'baz';"+ "cd /;"+ "fs -ls .;"+ "fs -rmr /fstmp/foo/baz;"+ "cd";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorageParams </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithCommas2() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a,  foo:b , foo:c");
  doColumnParseTest(storage,"foo:a","foo:b","foo:c");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithCommas1() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a,foo:b,foo:c");
  doColumnParseTest(storage,"foo:a","foo:b","foo:c");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithDelim() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a%foo:b % foo:c,d","-delim %");
  doColumnParseTest(storage,"foo:a","foo:b","foo:c,d");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithSpaces1() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a foo:b foo:c");
  doColumnParseTest(storage,"foo:a","foo:b","foo:c");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithSpaces2() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a foo:b  foo:c");
  doColumnParseTest(storage,"foo:a","foo:b","foo:c");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnParsingWithDelimWithSpaces() throws IOException, ParseException {
  HBaseStorage storage=new HBaseStorage("foo:a%foo:b % foo:c,d","-delim % -ignoreWhitespace false");
  doColumnParseTest(storage,"foo:a","foo:b "," foo:c,d");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputFileValidator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocalModeInputPositive() throws Throwable {
  String inputfile=generateTempFile().getAbsolutePath();
  String outputfile=generateNonExistenceTempFile().getAbsolutePath();
  LogicalPlan plan=genNewLoadStorePlan(inputfile,outputfile,ctx.getFs());
  InputOutputFileValidatorVisitor visitor=new InputOutputFileValidatorVisitor(plan,ctx);
  visitor.visit();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=VisitorException.class) public void testLocalModeNegative2() throws Throwable {
  String inputfile=generateTempFile().getAbsolutePath();
  String outputfile=generateTempFile().getAbsolutePath();
  LogicalPlan plan=genNewLoadStorePlan(inputfile,outputfile,ctx.getDfs());
  InputOutputFileValidatorVisitor visitor=new InputOutputFileValidatorVisitor(plan,ctx);
  visitor.visit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputMiniClusterFileValidator </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapReduceModeInputPositive() throws Throwable {
  String inputfile=createHadoopTempFile(ctx);
  String outputfile=createHadoopNonExistenceTempFile(ctx);
  LogicalPlan plan=genNewLoadStorePlan(inputfile,outputfile,ctx.getDfs());
  InputOutputFileValidatorVisitor executor=new InputOutputFileValidatorVisitor(plan,ctx);
  executor.visit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInstantiateFunc </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInstantiate1() throws Throwable {
  PigContext.instantiateFuncFromSpec(TEST_CLASS);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInstantiate3() throws Throwable {
  PigContext.instantiateFuncFromSpec(TEST_CLASS + "('a','b','c')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInstantiate2() throws Throwable {
  PigContext.instantiateFuncFromSpec(TEST_CLASS + "('a','b')");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobSubmission </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJobControlCompilerErr() throws Exception {
  String query="a = load '/passwd' as (a1:bag{(t:chararray)});" + "b = order a by a1;" + "store b into 'output';";
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  checkJobControlCompilerErrResult(pp,pc);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefaultParallel() throws Throwable {
  pc.defaultParallel=100;
  String query="a = load '/passwd';" + "b = group a by $0;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  checkDefaultParallelResult(pp,pc);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-20 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReducerNumEstimation() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ",Util.isMapredExecType(cluster.getExecType()));
  Configuration conf=HBaseConfiguration.create(new Configuration());
  HBaseTestingUtility util=new HBaseTestingUtility(conf);
  int clientPort=util.startMiniZKCluster().getClientPort();
  util.startMiniHBaseCluster(1,1);
  String query="a = load '/passwd';" + "b = group a by $0;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  pc.getConf().setProperty("pig.exec.reducers.bytes.per.reducer","100");
  pc.getConf().setProperty("pig.exec.reducers.max","10");
  pc.getConf().setProperty(HConstants.ZOOKEEPER_CLIENT_PORT,Integer.toString(clientPort));
  ConfigurationValidator.validatePigProperties(pc.getProperties());
  conf=ConfigurationUtil.toConfiguration(pc.getProperties());
  JobControlCompiler jcc=new JobControlCompiler(pc,conf);
  JobControl jc=jcc.compile(mrPlan,"Test");
  Job job=jc.getWaitingJobs().get(0);
  long reducer=Math.min((long)Math.ceil(new File("test/org/apache/pig/test/data/passwd").length() / 100.0),10);
  Util.assertParallelValues(-1,-1,reducer,reducer,job.getJobConf());
  query="a = load '/passwd';" + "b = group a by $0 PARALLEL 2;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlan(pp,pc);
  pc.getConf().setProperty("pig.exec.reducers.bytes.per.reducer","100");
  pc.getConf().setProperty("pig.exec.reducers.max","10");
  ConfigurationValidator.validatePigProperties(pc.getProperties());
  conf=ConfigurationUtil.toConfiguration(pc.getProperties());
  jcc=new JobControlCompiler(pc,conf);
  jc=jcc.compile(mrPlan,"Test");
  job=jc.getWaitingJobs().get(0);
  Util.assertParallelValues(-1,2,-1,2,job.getJobConf());
  final byte[] COLUMNFAMILY=Bytes.toBytes("pig");
  util.createTable(Bytes.toBytesBinary("test_table"),COLUMNFAMILY);
  query="a = load 'hbase://test_table' using org.apache.pig.backend.hadoop.hbase.HBaseStorage('c:f1 c:f2');" + "b = group a by $0 ;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlan(pp,pc);
  pc.getConf().setProperty("pig.exec.reducers.bytes.per.reducer","100");
  pc.getConf().setProperty("pig.exec.reducers.max","10");
  ConfigurationValidator.validatePigProperties(pc.getProperties());
  conf=ConfigurationUtil.toConfiguration(pc.getProperties());
  jcc=new JobControlCompiler(pc,conf);
  jc=jcc.compile(mrPlan,"Test");
  job=jc.getWaitingJobs().get(0);
  Util.assertParallelValues(-1,-1,1,1,job.getJobConf());
  util.deleteTable(Bytes.toBytesBinary("test_table"));
  MiniHBaseCluster hbc=util.getHBaseCluster();
  if (hbc != null) {
    hbc.shutdown();
    hbc.join();
  }
  util.shutdownMiniZKCluster();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinNullTupleFieldKey() throws Exception {
  String[] input1={"1\t","2\taa"};
  String[] input2={"1\t","2\taa"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  String script="a = load '" + Util.encodeEscape(firstInput) + "' as (a1:int, a2:chararray);"+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (b1:int, b2:chararray);"+ "c = join a by (a1, a2), b by (b1, b2);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(2,'aa',2,'aa')"});
  Util.checkQueryOutputs(it,expectedResults);
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinTupleFieldKey() throws Exception {
  String[] input1={"(1,a)","(2,aa)"};
  String[] input2={"(1,b)","(2,bb)"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  String script="a = load '" + Util.encodeEscape(firstInput) + "' as (a:tuple(a1:int, a2:chararray));"+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (b:tuple(b1:int, b2:chararray));"+ "c = join a by a.a1, b by b.b1;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"((1,'a'),(1,'b'))","((2,'aa'),(2,'bb'))"});
  Util.checkQueryOutputsAfterSort(it,expectedResults);
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinSmoke </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinOuter() throws IOException {
  pigServer.registerQuery("A = LOAD '" + SKEW_INPUT_FILE5 + "' as (id,name);");
  pigServer.registerQuery("B = LOAD '" + SKEW_INPUT_FILE5 + "' as (id,name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by id left, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by id right, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by id full, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLTOrEqual </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLessThan </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLimitVariable </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testLimitVariableException1() throws Throwable {
  String query="a = load '" + inputFile.getName() + "';"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = order a by $0 DESC;"+ "e = limit d $0;";
  Util.registerMultiLineQuery(pigServer,query);
  try {
    pigServer.openIterator("e");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,ScalarVariableValidator.ERR_MSG_SCALAR);
    throw fe;
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedLimitVariable1() throws Throwable {
  String query="a = load '" + inputFile.getName() + "' as (id:int, num:int);"+ "b = group a by num;"+ "c = foreach b generate COUNT(a) as ntup;"+ "d = group c all;"+ "e = foreach d generate MIN(c.ntup) AS min;"+ "f = foreach b {"+ " g = order a by id ASC;"+ " h = limit g e.min;"+ " generate FLATTEN(h);"+ "}";
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,11)","(2,3)","(3,10)","(6,15)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitVariable1() throws IOException {
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"" + true);
  String query="a = load '" + inputFile.getName() + "' as (f1:int, f2:int);"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = order a by $0 DESC;"+ "e = limit d c.sum/2;"+ "f = group e all;"+ "g = foreach f generate AVG(e.$0), SUM(e.$1);";
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("g");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(5.0,36)"});
  Util.checkQueryOutputs(it,expectedRes);
  pigServer.getPigContext().getProperties().remove(PigConfiguration.PIG_EXEC_MAP_PARTAGG);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitVariable2() throws IOException {
  String query="a = load '" + inputFile.getName() + "' as (id, num);"+ "b = filter a by id == 2;"+ "c = order a by id ASC;"+ "d = limit c b.num;"+ "e = limit c b.num * 2;";
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> itD=pigServer.openIterator("d");
  List<Tuple> expectedResD=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,11)","(2,3)","(3,10)"});
  Util.checkQueryOutputs(itD,expectedResD);
  Iterator<Tuple> itE=pigServer.openIterator("e");
  List<Tuple> expectedResE=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,11)","(2,3)","(3,10)","(4,11)","(5,10)","(6,15)"});
  Util.checkQueryOutputs(itE,expectedResE);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitVariable3() throws IOException {
  String query="a = load '" + inputFile.getName() + "' ;"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = order a by $0 ASC;"+ "e = limit d 1 * c.sum;";
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> itE=pigServer.openIterator("e");
  List<Tuple> expectedResE=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,11)","(2,3)","(3,10)","(4,11)","(5,10)","(6,15)"});
  Util.checkQueryOutputs(itE,expectedResE);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testZeroLimitVariable() throws Throwable {
  String query="a = load '" + inputFile.getName() + "';"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = limit a c.sum - c.sum; ";
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("d");
  List<Tuple> emptyresult=new ArrayList<Tuple>(0);
  Util.checkQueryOutputsAfterSort(it,emptyresult);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitVariable4() throws IOException {
  String query="a = load '" + inputFile.getName() + "' as (x:int, y:int);"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = order a by $0 DESC;"+ "e = filter d by $0 != 4;"+ "f = limit e c.sum/2;";
  try {
    HashSet<String> disabledOptimizerRules=new HashSet<String>();
    disabledOptimizerRules.add("PushUpFilter");
    pigServer.getPigContext().getProperties().setProperty(PigImplConstants.PIG_OPTIMIZER_RULES_KEY,ObjectSerializer.serialize(disabledOptimizerRules));
    Util.registerMultiLineQuery(pigServer,query);
    Iterator<Tuple> it=pigServer.openIterator("f");
    List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(6,15)","(5,10)","(3,10)"});
    Util.checkQueryOutputs(it,expectedRes);
  }
  finally {
    pigServer.getPigContext().getProperties().remove(PigImplConstants.PIG_OPTIMIZER_RULES_KEY);
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testLimitVariableException2() throws Throwable {
  String query="a = load '" + inputFile.getName() + "' as (id:int, num:chararray);"+ "b = filter a by num == '3';"+ "c = foreach b generate num as falsenum;"+ "d = order a by id DESC;"+ "e = limit d c.falsenum;";
  Util.registerMultiLineQuery(pigServer,query);
  try {
    pigServer.openIterator("e");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Limit's expression must evaluate to Long or Integer");
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoad </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbs() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    boolean noConversionExpected=true;
    checkLoadPath("/tmp/test","/tmp/test",noConversionExpected);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString2() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("t?s*,test","/tmp/t?s*,/tmp/test");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testCommaSeparatedString3() throws Exception {
  PigServer pig=servers[0];
  pc=pig.getPigContext();
  boolean noConversionExpected=true;
  checkLoadPath("hdfs:/tmp/test,hdfs:/tmp/test2,hdfs:/tmp/test3","hdfs:/tmp/test,hdfs:/tmp/test2,hdfs:/tmp/test3",noConversionExpected);
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testCommaSeparatedString3-input1.txt","/tmp/TestLoad-testCommaSeparatedString3-input2.txt"};
  String inputString="hdfs:" + inputFileNames[0] + ",hdfs:"+ inputFileNames[1];
  testLoadingMultipleFiles(inputFileNames,inputString);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString5() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("/usr/pig/{a,c},usr/pig/b","/usr/pig/{a,c},/tmp/usr/pig/b");
  }
  String loadLocationString="/tmp/TestLoad-testCommaSeparatedStringMixed-input{1,2}.txt," + "TestLoad-testCommaSeparatedStringMixed-input3.txt";
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testCommaSeparatedStringMixed-input1.txt","/tmp/TestLoad-testCommaSeparatedStringMixed-input2.txt","/tmp/TestLoad-testCommaSeparatedStringMixed-input3.txt"};
  pc=servers[0].getPigContext();
  testLoadingMultipleFiles(inputFileNames,loadLocationString);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString4() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/{a,c},usr/pig/b","/tmp/usr/pig/{a,c},/tmp/usr/pig/b");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString6() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/{a,c},/usr/pig/b","/tmp/usr/pig/{a,c},/usr/pig/b");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbsScheme() throws Exception {
  pc=servers[0].getPigContext();
  boolean noConversionExpected=true;
  checkLoadPath("hdfs:/tmp/test","hdfs:/tmp/test",noConversionExpected);
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testLoadRemoteAbsSchema-input.txt"};
  testLoadingMultipleFiles(inputFileNames,"hdfs:" + inputFileNames[0]);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteRel() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("test","/tmp/test");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlobChars() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("t?s*","/tmp/t?s*");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/a,usr/pig/b","/tmp/usr/pig/a,/tmp/usr/pig/b");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteRelScheme() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("test","/tmp/test");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbsAuth() throws Exception {
  pc=servers[0].getPigContext();
  checkLoadPath(cluster.getFileSystem().getUri() + "/test","/test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteNormalize() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    boolean noConversionExpected=true;
    checkLoadPath("/tmp/foo/../././","/tmp/foo/.././.",noConversionExpected);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoaderStorerShipCacheFiles </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShipAvroLoader() throws Exception {
  String query="a = load '1.txt' as (name:chararray, age:int, gpa:double);" + "store a into 'ooo' using AvroStorage();";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  String[] expectedJars=new String[]{"avro-1","avro-mapred-"};
  checkPlan(pp,expectedJars,2,pigServer.getPigContext());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShipOrcLoader() throws Exception {
  String query="a = load 'test/org/apache/pig/builtin/orc/orc-file-11-format.orc' using OrcStorage();" + "store a into 'ooo';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  String hadoopVersion="20S";
  if (Utils.isHadoop23() || Utils.isHadoop2()) {
    hadoopVersion="23";
  }
  String[] expectedJars=new String[]{"hive-common","hive-exec","hive-serde","hive-shims-0." + hadoopVersion,"hive-shims-common","kryo"};
  checkPlan(pp,expectedJars,6,pigServer.getPigContext());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShipOrcStorer() throws Exception {
  String query="a = load '1.txt' as (name:chararray, age:int, gpa:double);" + "store a into 'ooo' using OrcStorage;";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  String hadoopVersion="20S";
  if (Utils.isHadoop23() || Utils.isHadoop2()) {
    hadoopVersion="23";
  }
  String[] expectedJars=new String[]{"hive-common","hive-exec","hive-serde","hive-shims-0." + hadoopVersion,"hive-shims-common","kryo"};
  checkPlan(pp,expectedJars,6,pigServer.getPigContext());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShipJsonLoader() throws Exception {
  String query="a = load '1.txt' as (name:chararray, age:int, gpa:double);" + "b = order a by name;" + "store b into 'ooo' using JsonStorage();";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  String[] expectedJars=new String[]{"jackson-core-"};
  checkPlan(pp,expectedJars,1,pigServer.getPigContext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreFunctionWithNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,true);
  storeFunction(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefinedFunctionsNoNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,false);
  definedFunctions(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefinedFunctionsWithNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,true);
  definedFunctions(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreFunctionNoNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,false);
  storeFunction(data);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal2 </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPig800Distinct() throws Exception {
  File fp1=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t1}");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("B = foreach A generate flatten(" + Pig800Udf.class.getName() + "($0));");
  pig.registerQuery("C = distinct B;");
  Iterator<Tuple> iter=pig.openIterator("C");
  fp1.delete();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion2() throws Exception {
  File tmpFile1=genDataSetFile(false,30);
  File tmpFile2=genDataSetFile(false,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("a1 = foreach a generate $0, $1; ");
  pig.registerQuery("b1 = foreach b generate $0, $1; ");
  pig.registerQuery("c = union a1, b1; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPig800Sort() throws Exception {
  File fp1=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t1}");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("B = foreach A generate flatten(" + Pig800Udf.class.getName() + "($0));");
  pig.registerQuery("C = order B by $0;");
  Iterator<Tuple> iter=pig.openIterator("C");
  fp1.delete();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion1WithNulls() throws Exception {
  File tmpFile1=genDataSetFile(true,30);
  File tmpFile2=genDataSetFile(true,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("c = union a, b; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion1() throws Exception {
  File tmpFile1=genDataSetFile(false,30);
  File tmpFile2=genDataSetFile(false,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("c = union a, b; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion2WithNulls() throws Exception {
  File tmpFile1=genDataSetFile(true,30);
  File tmpFile2=genDataSetFile(true,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("a1 = foreach a generate $0, $1; ");
  pig.registerQuery("b1 = foreach b generate $0, $1; ");
  pig.registerQuery("c = union a1, b1; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogToPhyCompiler </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion() throws Exception {
  checkAgainstGolden("A = union (load 'a'), (load 'b'), (load 'c');" + "store A into 'output';","Union.gld",false,"testUnion");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArithmetic() throws Exception {
  checkAgainstGolden("A = foreach (load 'A') generate $0 + $1 + 5, $0 - 5 - $1, 'hello';" + "store A into 'output';","Arithmetic.gld",true,"testArithmetic");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSort() throws Exception {
  checkAgainstGolden("store (order (load 'a') by $0) into 'output';","Sort.gld",false,"testSort");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComparison() throws Exception {
  checkAgainstGolden("A = filter (load 'a' using " + PigStorage.class.getName() + "(':')) by $0 + $1 > ($0 - $1) * (4 / 2);"+ "store A into 'output';","Comparison.gld",true,"testComparison");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBinCond() throws Exception {
  checkAgainstGolden("A = foreach (load 'a') generate ($1 == '3'? $2 + $3 : $2 - $3) ;" + "store A into 'output';","BinCond.gld",false,"testBinCond");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimit() throws Exception {
  checkAgainstGolden("store( limit (load 'a') 5 ) into 'output';","Limit.gld",false,"testLimit");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroup() throws Exception {
  checkAgainstGolden("A = cogroup (load 'a') by ($0 + $1, $0 - $1), (load 'b') by ($0 + $1, $0 - $1);" + "store A into 'output';","Cogroup.gld",false,"testCogroup");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Exception {
  checkAgainstGolden("store( distinct (load 'a') ) into 'output';","Distinct.gld",false,"testDistinct");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComplexForeach() throws Exception {
  checkAgainstGolden("C = foreach (load 'a' as  (a:bag{} ) ) {" + "B = FILTER $0 BY ($1 == $2);" + "generate B;"+ "};"+ "store C into 'output';","ComplexForeach.gld",false,"testComplexForeach");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGenerate() throws Exception {
  checkAgainstGolden("A = foreach (load 'a') generate ($1+$2), ($1-$2), ($1*$2), ($1/$2), ((int)$1%(int)$2), -($1) ;" + "store A into 'output';","Generate.gld",false,"testGenerate");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogicalPlanBuilder </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery40() throws Exception {
  String query="a = FILTER (load 'a') BY IsEmpty($2);";
  buildPlan(query + "a = FILTER (load 'a') BY (IsEmpty($2) AND ($3 == $2));");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery71() throws Exception {
  String q="split (load 'a') into x if $0 > '7', y if $0 < '7';" + "b = foreach x generate $0;" + "c = foreach y generate $1;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery84() throws Exception {
  String q="a = load 'input1' as (name, age, gpa);" + "b = filter a by age < '20';" + "c = group b by (name,age);"+ "d = foreach c {"+ "cf = filter b by gpa < '3.0';"+ "cp = cf.$2;"+ "cd = distinct cp;"+ "co = order cd by gpa;"+ "generate group, flatten(co);"+ "};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery36() throws Exception {
  String query="foreach (cogroup ( load 'a' as (col1, col2)) by col1) generate $1.(col2, col1);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery3() throws Exception {
  String query="foreach (cogroup (load 'a' as (u:int)) by $0, (load 'b' as (v:int) ) by $0) generate org.apache.pig.builtin.AVG($1);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery105() throws Exception {
  String query="a = load 'st10k' as (name, age, gpa);" + "b = group a by name;" + "c = foreach b generate flatten(group), COUNT(a) as cnt;"+ "d = foreach c generate group;"+ "store d into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery67() throws Exception {
  String q=" a = load 'input1' as (name, age, gpa);" + " b = foreach a generate age, age * 10L, gpa/0.2f, {(16, 4.0e-2, 'hello')};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery10() throws Exception {
  String query="foreach (cogroup (load 'a') by ($1), (load 'b') by ($1)) generate $1.$1, $2.$1 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery23() throws Exception {
  String query="A = load 'a';" + "B = load 'b';" + "C = cogroup A by ($1), B by ($1);"+ "foreach C { "+ "A = Distinct A; "+ "B = FILTER A BY $1 < 'z'; "+ "C = FILTER A BY $2 == $3;"+ "B = ORDER B BY $1;"+ "GENERATE A, FLATTEN(B.$0);"+ "};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery96() throws Exception {
  String query="a = load 'input' as (name, age, gpa);" + "b = filter a by age < 20;" + "c = group b by age;"+ "d = foreach c {"+ "cf = filter b by gpa < 3.0;"+ "cd = distinct cf.gpa;"+ "co = order cd by $0;"+ "generate group, flatten(co);"+ "};"+ "store d into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOForEach foreach=(LOForEach)lp.getPredecessors(store).get(0);
  LogicalPlan foreachPlans=foreach.getInnerPlan();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery65() throws Exception {
  String q="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);" + "c = cogroup a by (name, age), b by (name, height);"+ "d = foreach c generate group.name, a.name as aName, b.name as bname;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * User generate functions must be in default package Bug 831620 - fixed
 */
@Test public void testQuery17() throws Exception {
  String query="foreach (load 'A')" + "generate " + TestApplyFunc.class.getName() + "($1);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery70() throws Exception {
  String q=" a = load 'input1';" + " b = foreach a generate ['10'#'hello', '4.0e-2'#10L, '0.5f'#(1), 'world'#42, '42'#{('guide')}] as mymap:map[];" + " c = foreach b generate mymap#'10';";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery83() throws Exception {
  String q="a = load 'input1' as (name, age, gpa);" + "b = filter a by age < '20';" + "c = group b by (name,age);"+ "d = foreach c {"+ "cf = filter b by gpa < '3.0';"+ "cp = cf.gpa;"+ "cd = distinct cp;"+ "co = order cd by gpa;"+ "generate group, flatten(co);"+ "};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsOuterJoin() throws Exception {
  String query="a = load 'a' as (x:int, y:chararray);" + "b = load 'b' as (u:int, v:chararray);" + "c = cogroup a by x, b by u;"+ "d = foreach c generate flatten((SIZE(a) == 0 ? null : a)), "+ "flatten((SIZE(b) == 0 ? null : b));"+ "store d into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery35() throws Exception {
  String query="foreach (load 'a' as (col1, col2)) generate col1, col2 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery2() throws Exception {
  String query="foreach (load 'a' using " + PigStorage.class.getName() + "(':')) generate $1, 'aoeuaoeu' ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery22() throws Exception {
  String query="A = load 'a';" + "B = load 'b';" + "C = cogroup A by ($1), B by ($1);"+ "foreach C { "+ "B = order B by $0; "+ "generate FLATTEN(A), B.($1, $2, $3) ;"+ "};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery73() throws Exception {
  String q="split (load 'a') into x if $0 > '7', y if $0 < '7';" + "b = filter x by $0 matches '^fred.*';" + "c = foreach y generate $0, ($0 matches 'yuri.*' ? $1 - 10 : $1);";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQueryFail93() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = group a by name;" + "c = foreach b generate flatten(a);"+ "d = foreach c generate name;"+ "e = foreach d generate a::name;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery42() throws Exception {
  String q="a = load 'a';" + "b = foreach a generate $0 as url, $1 as ranking;" + "foreach b generate url;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery60() throws Exception {
  String query="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);" + "c = cross a,b;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery12() throws Exception {
  String query="foreach (load 'a' using " + PigStorage.class.getName() + "() as (v: long, u:bag{T:tuple(t:double)} ) ) generate AVG($1) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery25() throws Exception {
  String query="foreach (load 'a' as (u:bag{}, v, w) ) {" + "B = FILTER $0 BY (($1 == $2) AND ('a' < 'b'));" + "generate B;"+ "};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreUdfConstructorArgDefine() throws Exception {
  String query="define PS PigStorage(':');" + " a = load 'a' using PS as (x:int, y:double, str:chararray);" + " b = filter a by IsEmpty(*);"+ " store b into 'x' using PS;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery38() throws Exception {
  String query="c = cross (load 'a'), (load 'b');";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery91() throws Exception {
  String query="a = load 'myfile' as (name:Chararray, age:Int, gpa:Float);" + "b = group a by name;";
  buildPlan(query + "c = foreach b generate SUM(a.age) + SUM(a.gpa);");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery5() throws Exception {
  String query="foreach (group (load 'a') ALL) generate $1 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery43() throws Exception {
  String q="a = load 'a' as (url,hitCount);" + "b = load 'a' as (url,ranking);" + "c = cogroup a by url, b by url;"+ "d = foreach c generate group,flatten(a),flatten(b);"+ "e = foreach d generate group, a::url, b::url, b::ranking;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery69() throws Exception {
  String q=" a = load 'input1';" + " b = foreach a generate {(16, 4.0e-2, 'hello'), (0.5f, 'another tuple', 12L, (1))};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsArithExprs() throws Exception {
  String query="a = load 'a' as (x:int, y:double);" + "b = foreach a generate x + null, x * null, x / null, x - null, null % x, " + "y + null, y * null, y / null, y - null;"+ "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCast() throws Exception {
  String query="a = load 'one.txt' as (x,y); " + "b = foreach a generate (int)$0, (double)$1;" + "c = group b by $0;"+ "store c into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery19() throws Exception {
  String query="a = load 'a';" + "b = filter a by $1 == '3';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery72() throws Exception {
  String q="split (load 'a') into x if $0 > 7, y if $0 < 7;" + "b = foreach x generate (int)$0;" + "c = foreach y generate (bag{})$1;"+ "d = foreach y generate (int)($2/2);"+ "e = foreach y generate (bag{tuple(int, float)})($2);"+ "f = foreach x generate (tuple(int, float))($3);"+ "g = foreach x generate (tuple())($4);"+ "h = foreach x generate (chararray)($5);";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery24() throws Exception {
  String query="a = load 'a';" + "foreach a generate (($0 == $1) ? 'a' : $2), $4 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery4() throws Exception {
  String query="foreach (load 'a' as (u:int, v:bag{T:tuple(t:double)})) generate AVG($1) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery68() throws Exception {
  String q=" a = load 'input1';" + " b = foreach a generate 10, {(16, 4.0e-2, 'hello'), (0.5f, 12l, 'another tuple')};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery11() throws Exception {
  String query=" foreach (group (load 'a' as (u:int)) by $0, (load 'b' as (v:long)) by $0) generate group, AVG($1) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery62() throws Exception {
  String query="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);" + "c = cross a,b;"+ "d = order c by b::name, height, a::gpa;"+ "e = order a by name, age, gpa desc;"+ "f = order a by $0 asc, age, gpa desc;"+ "g = order a by * asc;"+ "h = cogroup a by name, b by name;"+ "i = foreach h {i1 = order a by *; generate i1;};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery75() throws Exception {
  String q="a = union (load 'a'), (load 'b'), (load 'c');";
  buildPlan(q + "b = foreach a {generate $0;};");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery88() throws Exception {
  String query="a = load 'myfile';" + "b = group a by $0;" + "c = order b by $1 ;"+ "store c into 'output';";
  LogicalPlan lp=buildPlan(query);
  Operator store=lp.getSinks().get(0);
  LOSort sort=(LOSort)lp.getPredecessors(store).get(0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery93() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = group a by name;" + "c = foreach b generate flatten(a);"+ "d = foreach c generate name;"+ "e = foreach d generate name;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery58() throws Exception {
  String query="a = load 'a' as (name, age, gpa);" + "b = group a by name;" + "foreach b {d = a.name; generate group, d;};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsBincond2() throws Exception {
  String query="a = load 'a' as (x:int, y:double);" + "b = foreach a generate (null is null ? 1 : 2), ( null is not null ? 2 : 1);" + "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadUdfConstructorArgDefine() throws Exception {
  String query="define PS PigStorage(':');" + "a = load 'a' using PS as (x:int, y:double, str:chararray);" + "b = filter a by IsEmpty(*);"+ " store b into 'x' using PS;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery14() throws Exception {
  String query="foreach (group (load 'a') by ($6, $7)) generate flatten(group) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery80() throws Exception {
  String q="a = load 'input1' as (name, age, gpa);" + "b = filter a by age < '20';" + "c = group b by age;"+ "d = foreach c {"+ "cf = filter b by gpa < '3.0';"+ "cp = cf.gpa;"+ "cd = distinct cp;"+ "co = order cd by gpa;"+ "generate group, flatten(co);"+ "};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery27() throws Exception {
  String query="foreach (load 'a' as (u, v:bag{}, w, x:bag{}, y) ){" + "A = DISTINCT $3.$1;" + " generate " + TestApplyFunc.class.getName() + "($2, $1.($1, $4));"+ "};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery89() throws Exception {
  String query="a = load 'myfile';" + "b = foreach a generate $0, $100;" + "c = load 'myfile' as (i: int);"+ "d = foreach c generate $0 as zero, i;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery32() throws Exception {
  String query="foreach (load 'myfile' as (col1, col2 : tuple(sub1, sub2), col3 : tuple(bag1))) generate col1 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery7() throws Exception {
  String query="foreach (load 'a' using " + PigStorage.class.getName() + "()) generate $1 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery74() throws Exception {
  String q="a = load 'a' as (field1: int, field2: long);" + "b = load 'a' as (field1: bytearray, field2: double);" + "c = group a by field1, b by field1;"+ "d = cogroup a by ((field1+field2)*field1), b by field1;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery30() throws Exception {
  String query="load 'myfile' using " + TestStorageFunc.class.getName() + "() as (col1, col2);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery39() throws Exception {
  String query="a = load 'a' as (url, host, ranking:double);" + "b = group a by (url,host); " + "c = foreach b generate flatten(group.url), SUM(a.ranking) as totalRank;";
  buildPlan(query);
  query+="d = filter c by totalRank > 10;" + "e = foreach d generate totalRank;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery92() throws Exception {
  String query="a = load 'myfile' as (name, age, gpa);" + "b = group a by name;" + "c = foreach b { "+ " alias = name#'alias'; "+ " af = alias#'first'; "+ " al = alias#'last'; "+ " generate SUM(a.age) + SUM(a.gpa); "+ "};";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery61() throws Exception {
  String query="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);" + "c = union a,b;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery100() throws Exception {
  String query="define FUNC ARITY();";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery13() throws Exception {
  String query="foreach (cogroup (load 'a') ALL) generate group ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery26() throws Exception {
  String query="foreach (load 'a') generate  ((NOT (($1 == $2) OR ('a' < 'b'))) ? 'a' : $2), 'x' ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadUdfDefine() throws Exception {
  String query="define PS PigStorage();" + "a = load 'a' using PS as (x:int, y:double, str:chararray);" + "b = filter a by IsEmpty(*);"+ " store b into 'x' using PS;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery31() throws Exception {
  String query="load 'myfile' as (col1, col2);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery6() throws Exception {
  String query="foreach (group (load 'a') by $1) generate group, '1' ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery44() throws Exception {
  String q="a = load 'a' as (url, pagerank);" + "b = load 'b' as (url, query, ranking);" + "c = cogroup a by (pagerank#'nonspam', url) , b by (ranking, url) ;"+ "foreach c generate group.url;";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsBincond1() throws Exception {
  String query="a = load 'a' as (x:int, y:double);" + "b = foreach a generate (2 > 1? null : 1), ( 2 < 1 ? null : 1), " + "(2 > 1 ? 1 : null), ( 2 < 1 ? 1 : null);"+ "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsConcatSize() throws Exception {
  String query="a = load 'a' as (x:int, y:double, str:chararray);" + "b = foreach a generate SIZE(null), CONCAT(str, null), " + "CONCAT(null, str);"+ "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery57() throws Exception {
  String query="foreach (load 'a' as (u:int, v:long, w:int)) generate ($1+$2), ($1-$2), ($1*$2), ($1/$2), ($1%$2), -($1) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterUdfDefine() throws Exception {
  String query="define isempty IsEmpty();" + "a = load 'a' as (x:int, y:double, str:chararray);" + "b = filter a by isempty(*);"+ "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery64() throws Exception {
  String query="a = load 'a' as (name: chararray, details: tuple(age, gpa), mymap: map[]);" + "c = load 'a' as (name, details: bag{mytuple: tuple(age: int, gpa)});" + "b = group a by details;"+ "d = foreach b generate group.age;"+ "e = foreach a generate name, details;"+ "f = LOAD 'myfile' AS (garage: bag{tuple1: tuple(num_tools: int)}, links: bag{tuple2: tuple(websites: chararray)}, page: bag{something_stupid: tuple(yeah_double: double)}, coordinates: bag{another_tuple: tuple(ok_float: float, bite_the_array: bytearray, bag_of_unknown: bag{})});";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery29() throws Exception {
  String query="load 'myfile' using " + TestStorageFunc.class.getName() + "() as (col1);";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery82() throws Exception {
  String q="a = load 'myfile';" + "b = group a by $0;" + "c = foreach b {"+ "c1 = order $1 by *;"+ "c2 = $1.$0;"+ "generate flatten(c1), c2;"+ "};";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandomEmptyConst() throws Exception {
  buildPlan("a = foreach (load 'b') generate {({})}; store a into 'output';");
  buildPlan("a = foreach (load 'b') generate ({()}); store a into 'output';");
  buildPlan("a = foreach (load 'b') generate {(),()}; store a into 'output';");
  buildPlan("a = foreach (load 'b') generate ({},{}); store a into 'output';");
  buildPlan("a = foreach (load 'b') generate ((),()); store a into 'output';");
  buildPlan("a = foreach (load 'b') generate ([],[]); store a into 'output';");
  buildPlan("a = foreach (load 'b') generate {({},{})}; store a into 'output';");
  buildPlan("a = foreach (load 'b') generate {([],[])}; store a into 'output';");
  buildPlan("a = foreach (load 'b') generate (({},{})); store a into 'output';");
  buildPlan("a = foreach (load 'b') generate (([],[])); store a into 'output';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery1() throws Exception {
  String query="foreach (load 'a') generate $1,$2;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery103() throws Exception {
  buildPlan("a = load 'a';" + "store a into 'out' using PigStorage();");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReservedWordsInFunctionNames() throws Exception {
  String[] keywords={"define","load","filter","foreach","matches","order","arrange","distinct","cogroup","join","cross","union","split","into","if","all","any","as","by","using","inner","outer","parallel","partition","group","and","or","not","generate","flatten","eval","asc","desc","int","long","float","double","chararray","bytearray","bag","tuple","map","is","null","stream","through","store","ship","cache","input","output","stderr","stdin","stdout","limit","sample","left","right","full","eq","gt","lt","gte","lte","neq"};
  for (  String keyword : keywords) {
    String query="define FUNC org.apache." + keyword + "();";
    LogicalPlan lp=buildPlan(query);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery21() throws Exception {
  String query="A = load 'a';" + "B = load 'b';" + "foreach (cogroup A by ($1), B by ($1)) generate A, flatten(B.($1, $2, $3));";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullConsForEachGenerate() throws Exception {
  String query="a = load 'a' as (x:int, y:double);" + "b = foreach a generate x, null, y, null;" + "store b into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery34() throws Exception {
  String query="A = load 'a' as (aCol1, aCol2 : tuple(subCol1, subCol2));" + "A = filter A by aCol1 == '1';" + "B = load 'b' as (bCol1, bCol2);"+ "foreach (cogroup A by (aCol1), B by bCol1 ) generate A.aCol2, B.bCol2 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery63() throws Exception {
  String query="a = load 'a' as (name, details: tuple(age, gpa));" + "b = group a by details;" + "d = foreach b generate group.age;"+ "e = foreach a generate name, details;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery76() throws Exception {
  String q="split (load 'a') into x if $0 > '7', y if $0 < '7';" + "b = filter x by $0 IS NULL;" + "c = filter y by $0 IS NOT NULL;"+ "d = foreach b generate $0, ($1 IS NULL ? 0 : $1 - 7);"+ "e = foreach c generate $0, ($1 IS NOT NULL ? $1 - 5 : 0);";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery28() throws Exception {
  String query="foreach (load 'a') generate " + TestApplyFunc.class.getName() + "($2, "+ TestApplyFunc.class.getName()+ "($2.$3));";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery81() throws Exception {
  String q="a = load 'input1' using PigStorage() as (name, age, gpa);" + "split a into b if name lt 'f', c if (name gte 'f' and name lte 'h'), d if name gt 'h';";
  buildPlan(q);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery94() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = load 'two' as (name, age, somethingelse);" + "c = cogroup a by name, b by name;"+ "d = foreach c generate flatten(a), flatten(b);"+ "e = foreach d generate a::name, b::name;"+ "f = foreach d generate gpa, somethingelse;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitWithLong() throws Exception {
  buildPlan("limit (load 'a') 100L;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreUdfDefine() throws Exception {
  String query="define PS PigStorage();" + "a = load 'a' using PS as (x:int, y:double, str:chararray);" + "b = filter a by IsEmpty(*);"+ "store b into 'x' using PS;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery59() throws Exception {
  String query="a = load 'a' as (name, age, gpa);" + "b = load 'b' as (name, height);" + "c = join a by name, b by name;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery102() throws Exception {
  buildPlan("a = load 'a';" + "store a into 'out';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery15() throws Exception {
  String query=" foreach (load 'a') generate $1, 'hello', $3 ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery20() throws Exception {
  String query="foreach (load 'a') generate ($1 == '3'? $2 : $3) ;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery77() throws Exception {
  buildPlan("limit (load 'a') 100;");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCastAlias() throws Exception {
  String query="a = load 'one.txt' as (x,y); " + "b =  foreach a generate (int)x, (double)y;" + "c = group b by x;"+ "store c into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuery33() throws Exception {
  String query="A = load 'a' as (aCol1, aCol2);" + "B = load 'b' as (bCol1, bCol2);" + "C = cogroup A by (aCol1), B by bCol1;"+ "foreach C generate group, A.aCol1;";
  buildPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitMultipleOutput() throws Exception {
  String query=" a = load '1.txt' as (a0:int, a1:int, a2:int);" + " b = group a by a0;" + " c = foreach b { c1 = limit a 10; c2 =  distinct c1.a1; c3 = distinct c1.a2; generate c2, c3;};"+ " store c into 'output';";
  buildPlan(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRCompiler </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that POSortedDistinct gets printed as POSortedDistinct
 * @throws Exception
 */
@Test public void testSortedDistinctInForeach() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan grpChain1=GenPhyOp.loadedGrpChain();
  php.merge(grpChain1);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  PhysicalPlan inplan=new PhysicalPlan();
  PODistinct op1=new POSortedDistinct(new OperatorKey("",r.nextLong()),-1,null);
  inplan.addAsLeaf(op1);
  inputs.add(inplan);
  List<Boolean> toFlattens=new ArrayList<Boolean>();
  toFlattens.add(false);
  POForEach pofe=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toFlattens);
  php.addAsLeaf(pofe);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC19.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpl1() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POLoad lA=GenPhyOp.topLoadOp();
  POSplit spl=GenPhyOp.topSplitOp();
  php.add(lA);
  php.add(spl);
  php.connect(lA,spl);
  POFilter fl1=GenPhyOp.topFilterOp();
  POFilter fl2=GenPhyOp.topFilterOp();
  php.add(fl1);
  php.add(fl2);
  php.connect(spl,fl1);
  php.connect(spl,fl2);
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lr2=GenPhyOp.topLocalRearrangeOp();
  php.add(lr1);
  php.add(lr2);
  php.connect(fl1,lr1);
  php.connect(fl2,lr2);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.add(gr);
  php.connect(lr1,gr);
  php.connect(lr2,gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.add(pk);
  php.connect(gr,pk);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(pk,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC12.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim5() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  PhysicalPlan ldFil2=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.merge(ldFil2);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(un,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC5.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim7() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lr2=GenPhyOp.topLocalRearrangeOp();
  ldGrpChain1.addAsLeaf(lr1);
  ldGrpChain2.addAsLeaf(lr2);
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.connect(ldFil1.getLeaves().get(0),gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.addAsLeaf(pk);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC7.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpl2() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POLoad lA=GenPhyOp.topLoadOp();
  POSplit spl=GenPhyOp.topSplitOp();
  php.add(lA);
  php.add(spl);
  php.connect(lA,spl);
  POFilter fl1=GenPhyOp.topFilterOp();
  POFilter fl2=GenPhyOp.topFilterOp();
  php.add(fl1);
  php.add(fl2);
  php.connect(spl,fl1);
  php.connect(spl,fl2);
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lr2=GenPhyOp.topLocalRearrangeOp();
  php.add(lr1);
  php.add(lr2);
  php.connect(fl1,lr1);
  php.connect(fl2,lr2);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.addAsLeaf(pk);
  POSplit sp2=GenPhyOp.topSplitOp();
  php.addAsLeaf(sp2);
  POFilter fl3=GenPhyOp.topFilterOp();
  POFilter fl4=GenPhyOp.topFilterOp();
  php.add(fl3);
  php.add(fl4);
  php.connect(sp2,fl3);
  php.connect(sp2,fl4);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC13.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortUDF1() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  String funcName=WeirdComparator.class.getName();
  POUserComparisonFunc comparator=new POUserComparisonFunc(new OperatorKey("",r.nextLong()),-1,null,new FuncSpec(funcName));
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,ldFil1.getLeaves(),null,new ArrayList<Boolean>(),comparator);
  sort.setRequestedParallelism(20);
  PhysicalPlan nesSortPlan=new PhysicalPlan();
  POProject topPrj=new POProject(new OperatorKey("",r.nextLong()));
  topPrj.setColumn(1);
  topPrj.setOverloaded(true);
  topPrj.setResultType(DataType.TUPLE);
  nesSortPlan.add(topPrj);
  POProject prjStar2=new POProject(new OperatorKey("",r.nextLong()));
  prjStar2.setResultType(DataType.TUPLE);
  prjStar2.setStar(true);
  nesSortPlan.add(prjStar2);
  nesSortPlan.connect(topPrj,prjStar2);
  List<PhysicalPlan> nesSortPlanLst=new ArrayList<PhysicalPlan>();
  nesSortPlanLst.add(nesSortPlan);
  sort.setSortPlans(nesSortPlanLst);
  php.add(sort);
  php.connect(ldFil1.getLeaves().get(0),sort);
  List<String> udfs=new ArrayList<String>();
  udfs.add(COUNT.class.getName());
  udfs.add(SUM.class.getName());
  POForEach fe3=GenPhyOp.topForEachOPWithUDF(udfs);
  php.add(fe3);
  php.connect(sort,fe3);
  PhysicalPlan grpChain1=GenPhyOp.grpChain();
  php.merge(grpChain1);
  php.connect(fe3,grpChain1.getRoots().get(0));
  udfs.clear();
  udfs.add(AVG.class.getName());
  POForEach fe4=GenPhyOp.topForEachOPWithUDF(udfs);
  php.addAsLeaf(fe4);
  PhysicalPlan grpChain2=GenPhyOp.grpChain();
  php.merge(grpChain2);
  php.connect(fe4,grpChain2.getRoots().get(0));
  udfs.clear();
  udfs.add(GFCross.class.getName() + "('1')");
  POForEach fe5=GenPhyOp.topForEachOPWithUDF(udfs);
  php.addAsLeaf(fe5);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC15.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun1() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan part1=new PhysicalPlan();
  POLoad lC=GenPhyOp.topLoadOp();
  POFilter fC=GenPhyOp.topFilterOp();
  fC.setRequestedParallelism(20);
  POLocalRearrange lrC=GenPhyOp.topLocalRearrangeOp();
  lrC.setRequestedParallelism(10);
  POGlobalRearrange grC=GenPhyOp.topGlobalRearrangeOp();
  POPackage pkC=GenPhyOp.topPackageOp();
  part1.add(lC);
  part1.add(fC);
  part1.connect(lC,fC);
  part1.add(lrC);
  part1.connect(fC,lrC);
  part1.add(grC);
  part1.connect(lrC,grC);
  part1.add(pkC);
  part1.connect(grC,pkC);
  POPackage pkD=GenPhyOp.topPackageOp();
  pkD.setRequestedParallelism(20);
  POLocalRearrange lrD=GenPhyOp.topLocalRearrangeOp();
  lrD.setRequestedParallelism(30);
  POGlobalRearrange grD=GenPhyOp.topGlobalRearrangeOp();
  POLoad lD=GenPhyOp.topLoadOp();
  part1.add(lD);
  part1.add(lrD);
  part1.connect(lD,lrD);
  part1.add(grD);
  part1.connect(lrD,grD);
  part1.add(pkD);
  part1.connect(grD,pkD);
  POPackage pkCD=GenPhyOp.topPackageOp();
  POLocalRearrange lrCD1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lrCD2=GenPhyOp.topLocalRearrangeOp();
  POGlobalRearrange grCD=GenPhyOp.topGlobalRearrangeOp();
  part1.add(lrCD1);
  part1.add(lrCD2);
  part1.connect(pkC,lrCD1);
  part1.connect(pkD,lrCD2);
  part1.add(grCD);
  part1.connect(lrCD1,grCD);
  part1.connect(lrCD2,grCD);
  part1.add(pkCD);
  part1.connect(grCD,pkCD);
  POLoad lA=GenPhyOp.topLoadOp();
  POLoad lB=GenPhyOp.topLoadOp();
  POFilter fA=GenPhyOp.topFilterOp();
  POLocalRearrange lrA=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lrB=GenPhyOp.topLocalRearrangeOp();
  POGlobalRearrange grAB=GenPhyOp.topGlobalRearrangeOp();
  POPackage pkAB=GenPhyOp.topPackageOp();
  POFilter fAB=GenPhyOp.topFilterOp();
  POUnion unABC=GenPhyOp.topUnionOp();
  php.add(lA);
  php.add(lB);
  php.add(fA);
  php.connect(lA,fA);
  php.add(lrA);
  php.add(lrB);
  php.connect(fA,lrA);
  php.connect(lB,lrB);
  php.add(grAB);
  php.connect(lrA,grAB);
  php.connect(lrB,grAB);
  php.add(pkAB);
  php.connect(grAB,pkAB);
  php.add(fAB);
  php.connect(pkAB,fAB);
  php.merge(part1);
  List<PhysicalOperator> leaves=new ArrayList<PhysicalOperator>();
  for (  PhysicalOperator phyOp : php.getLeaves()) {
    leaves.add(phyOp);
  }
  php.add(unABC);
  for (  PhysicalOperator physicalOperator : leaves) {
    php.connect(physicalOperator,unABC);
  }
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(unABC,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC10.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim6() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lr2=GenPhyOp.topLocalRearrangeOp();
  ldGrpChain1.addAsLeaf(lr1);
  ldGrpChain2.addAsLeaf(lr2);
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.addAsLeaf(pk);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC6.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim3() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.connect(ldFil1.getLeaves().get(0),un);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(un,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC3.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim4() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  PhysicalPlan ldFil2=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.connect(ldFil1.getLeaves().get(0),un);
  php.merge(ldFil2);
  php.connect(ldFil2.getLeaves().get(0),un);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(un,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC4.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim1() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POLoad ld=GenPhyOp.topLoadOp();
  php.add(ld);
  PhysicalPlan grpChain1=GenPhyOp.grpChain();
  php.merge(grpChain1);
  php.connect(ld,grpChain1.getRoots().get(0));
  PhysicalOperator leaf=php.getLeaves().get(0);
  PhysicalPlan grpChain2=GenPhyOp.grpChain();
  php.merge(grpChain2);
  php.connect(leaf,grpChain2.getRoots().get(0));
  leaf=php.getLeaves().get(0);
  POFilter fl=GenPhyOp.topFilterOp();
  php.add(fl);
  php.connect(leaf,fl);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(fl,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim2() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(un,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim8() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldGrpChain1=GenPhyOp.loadedGrpChain();
  PhysicalPlan ldGrpChain2=GenPhyOp.loadedGrpChain();
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lr2=GenPhyOp.topLocalRearrangeOp();
  ldGrpChain1.addAsLeaf(lr1);
  ldGrpChain2.addAsLeaf(lr2);
  php.merge(ldGrpChain1);
  php.merge(ldGrpChain2);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  PhysicalPlan ldFil2=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.connect(ldFil1.getLeaves().get(0),gr);
  php.merge(ldFil2);
  php.connect(ldFil2.getLeaves().get(0),gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.addAsLeaf(pk);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC8.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpl3() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POLoad lA=GenPhyOp.topLoadOp();
  POSplit spl=GenPhyOp.topSplitOp();
  php.add(lA);
  php.add(spl);
  php.connect(lA,spl);
  POFilter fl1=GenPhyOp.topFilterOp();
  fl1.setRequestedParallelism(10);
  POFilter fl2=GenPhyOp.topFilterOp();
  fl2.setRequestedParallelism(20);
  php.add(fl1);
  php.add(fl2);
  php.connect(spl,fl1);
  php.connect(spl,fl2);
  POSplit sp11=GenPhyOp.topSplitOp();
  POSplit sp21=GenPhyOp.topSplitOp();
  php.add(sp11);
  php.add(sp21);
  php.connect(fl1,sp11);
  php.connect(fl2,sp21);
  POFilter fl11=GenPhyOp.topFilterOp();
  fl11.setRequestedParallelism(10);
  POFilter fl21=GenPhyOp.topFilterOp();
  fl21.setRequestedParallelism(20);
  POFilter fl22=GenPhyOp.topFilterOp();
  fl22.setRequestedParallelism(30);
  php.add(fl11);
  php.add(fl21);
  php.add(fl22);
  php.connect(sp11,fl11);
  php.connect(sp21,fl21);
  php.connect(sp21,fl22);
  POLocalRearrange lr1=GenPhyOp.topLocalRearrangeOp();
  lr1.setRequestedParallelism(40);
  POLocalRearrange lr21=GenPhyOp.topLocalRearrangeOp();
  lr21.setRequestedParallelism(15);
  POLocalRearrange lr22=GenPhyOp.topLocalRearrangeOp();
  lr22.setRequestedParallelism(35);
  php.add(lr1);
  php.add(lr21);
  php.add(lr22);
  php.connect(fl11,lr1);
  php.connect(fl21,lr21);
  php.connect(fl22,lr22);
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  POPackage pk=GenPhyOp.topPackageOp();
  pk.setRequestedParallelism(25);
  php.addAsLeaf(pk);
  POSplit sp2=GenPhyOp.topSplitOp();
  php.addAsLeaf(sp2);
  POFilter fl3=GenPhyOp.topFilterOp();
  fl3.setRequestedParallelism(100);
  POFilter fl4=GenPhyOp.topFilterOp();
  fl4.setRequestedParallelism(80);
  php.add(fl3);
  php.add(fl4);
  php.connect(sp2,fl3);
  php.connect(sp2,fl4);
  POUnion un=GenPhyOp.topUnionOp();
  php.addAsLeaf(un);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC14.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun2() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan part1=new PhysicalPlan();
  POLoad lC=GenPhyOp.topLoadOp();
  POFilter fC=GenPhyOp.topFilterOp();
  POLocalRearrange lrC=GenPhyOp.topLocalRearrangeOp();
  POGlobalRearrange grC=GenPhyOp.topGlobalRearrangeOp();
  POPackage pkC=GenPhyOp.topPackageOp();
  part1.add(lC);
  part1.add(fC);
  part1.connect(lC,fC);
  part1.add(lrC);
  part1.connect(fC,lrC);
  part1.add(grC);
  part1.connect(lrC,grC);
  part1.add(pkC);
  part1.connect(grC,pkC);
  POPackage pkD=GenPhyOp.topPackageOp();
  POLocalRearrange lrD=GenPhyOp.topLocalRearrangeOp();
  POGlobalRearrange grD=GenPhyOp.topGlobalRearrangeOp();
  POLoad lD=GenPhyOp.topLoadOp();
  part1.add(lD);
  part1.add(lrD);
  part1.connect(lD,lrD);
  part1.add(grD);
  part1.connect(lrD,grD);
  part1.add(pkD);
  part1.connect(grD,pkD);
  part1.connect(pkD,grC);
  POLoad lA=GenPhyOp.topLoadOp();
  POLoad lB=GenPhyOp.topLoadOp();
  POFilter fA=GenPhyOp.topFilterOp();
  POLocalRearrange lrA=GenPhyOp.topLocalRearrangeOp();
  POLocalRearrange lrB=GenPhyOp.topLocalRearrangeOp();
  POGlobalRearrange grAB=GenPhyOp.topGlobalRearrangeOp();
  POPackage pkAB=GenPhyOp.topPackageOp();
  POFilter fAB=GenPhyOp.topFilterOp();
  POUnion unABC=GenPhyOp.topUnionOp();
  php.add(lA);
  php.add(lB);
  php.add(fA);
  php.connect(lA,fA);
  php.add(lrA);
  php.add(lrB);
  php.connect(fA,lrA);
  php.connect(lB,lrB);
  php.add(grAB);
  php.connect(lrA,grAB);
  php.connect(lrB,grAB);
  php.add(pkAB);
  php.connect(grAB,pkAB);
  php.add(fAB);
  php.connect(pkAB,fAB);
  php.merge(part1);
  List<PhysicalOperator> leaves=new ArrayList<PhysicalOperator>();
  for (  PhysicalOperator phyOp : php.getLeaves()) {
    leaves.add(phyOp);
  }
  php.add(unABC);
  for (  PhysicalOperator physicalOperator : leaves) {
    php.connect(physicalOperator,unABC);
  }
  POStore st=GenPhyOp.topStoreOp();
  php.add(st);
  php.connect(unABC,st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC11.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSim9() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POGlobalRearrange gr=GenPhyOp.topGlobalRearrangeOp();
  php.addAsLeaf(gr);
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  PhysicalPlan ldFil2=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  php.connect(ldFil1.getLeaves().get(0),gr);
  php.merge(ldFil2);
  php.connect(ldFil2.getLeaves().get(0),gr);
  POPackage pk=GenPhyOp.topPackageOp();
  php.addAsLeaf(pk);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC9.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimit() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  POLoad lC=GenPhyOp.topLoadOp();
  php.add(lC);
  POLimit op=new POLimit(new OperatorKey("",r.nextLong()),-1,null);
  php.add(op);
  php.connect(lC,op);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC17.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct1() throws Exception {
  PhysicalPlan php=new PhysicalPlan();
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  php.merge(ldFil1);
  PODistinct op=new PODistinct(new OperatorKey("",r.nextLong()),-1,null);
  php.addAsLeaf(op);
  PhysicalPlan grpChain1=GenPhyOp.grpChain();
  php.merge(grpChain1);
  php.connect(op,grpChain1.getRoots().get(0));
  PODistinct op1=new PODistinct(new OperatorKey("",r.nextLong()),-1,null);
  php.addAsLeaf(op1);
  POStore st=GenPhyOp.topStoreOp();
  php.addAsLeaf(st);
  run(php,"test/org/apache/pig/test/data/GoldenFiles/MRC16.gld");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRExecutionEngine </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ExecException.class) public void testJobConfGeneration() throws ExecException {
  Configuration conf=new Configuration(false);
  conf.set("foo","bar");
  PigContext pigContext=new PigContext(ExecType.MAPREDUCE,conf);
  pigContext.connect();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRJobStats </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetOuputSizeUsingNonFileBasedStorage3() throws Exception {
  Configuration conf=new Configuration();
  conf.set(PigStatsOutputSizeReader.OUTPUT_SIZE_READER_KEY,"bad_output_size_reader");
  UDFContext.getUDFContext().setClientSystemProps(new Properties());
  JobStats.getOutputSize(createPOStoreForNonFileBasedSystem(new HBaseStorage("colName"),conf),conf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMacroExpansion </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test22() throws Exception {
  String macro="a = load '1.txt' as ( u : bag{}, v : bag{tuple(x, y)} );" + "b = load '2.x' as ( t : {}, u : {(r,s)}, v : bag{ T : tuple( x, y ) }, w : bag{(z1, z2)} );" + "c = load '3.x' as p : int;";
  String expected="macro_mymacro_a_0 = load '1.txt' as (u:bag{}, v:bag{T:(x, y)});\n" + "macro_mymacro_b_0 = load '2.x' as (t:bag{}, u:bag{T:(r, s)}, v:bag{T:(x, y)}, w:bag{T:(z1, z2)});\n" + "macro_mymacro_c_0 = load '3.x' as p:int;\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test35() throws Exception {
  String query="a = load 'testComplexCast' as (m);" + "b = foreach a generate ([{(i:int,j:int)}])m;";
  String expected="macro_mymacro_a_0 = load 'testComplexCast' as m;\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate (map[bag{T:(i:int, j:int)}])m;\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void noReturnTest2() throws Exception {
  String macro="define group_and_count(myinput, myoutput) returns void {\n" + "    D = load '$myinput';\n" + "    store D into '$myoutput';\n"+ "};\n";
  String script="group_and_count('myfile.txt', '/tmp/myoutput');\n";
  String expected="macro_group_and_count_D_0 = load 'myfile.txt';\n" + "store macro_group_and_count_D_0 INTO '/tmp/myoutput';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommentInMacro() throws Exception {
  String query="a = load 'testComplexCast' as (m);\n" + " /* this is a test } and \n" + " and test ***/\n"+ " -- this is another test } \n"+ "b = foreach a generate ([{(i:int,j:int)}])m;";
  String expected="macro_mymacro_a_0 = load 'testComplexCast' as m;\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate (map[bag{T:(i:int, j:int)}])m;\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest4() throws Throwable {
  String macro="define group_and_count (A,C) returns B {\n" + "    $B = JOIN $A BY user, $C BY user;\n" + "    define test_macro() returns dummy { a = load '1.txt'; };\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: macro 'group_and_count' contains macro definition.\n" + "macro content: \n" + "    $B = JOIN $A BY user, $C BY user;\n"+ "    define test_macro() returns dummy { a = load '1.txt'; };\n";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test18() throws Exception {
  String macro="define mymacro() returns void {" + "a = load '/user/pig/tests/data/singlefile/studenttab10k';" + "b = group a by $0;"+ "c = foreach b {c1 = order $1 by *; generate flatten(c1); };"+ "store c into '/user/pig/out/jianyong.1297305352/Order_15.out';};";
  String script=macro + "mymacro();\n";
  String expected="macro_mymacro_a_0 = load '/user/pig/tests/data/singlefile/studenttab10k';\n" + "macro_mymacro_b_0 = group macro_mymacro_a_0 by ($0);\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 { c1 = order $1 BY *;  generate flatten(c1) ; } ;\n"+ "store macro_mymacro_c_0 INTO '/user/pig/out/jianyong.1297305352/Order_15.out';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test36() throws Exception {
  createFile("mymacro.pig"," ");
  String query="import 'mymacro.pig';" + "define macro1() returns void {}; " + "A = load '1.txt' as (a0:int, a1:chararray);"+ "macro1();"+ "B = group A by a0;"+ "store B into 'output';";
  String expected="A = load '1.txt' as (a0:int, a1:chararray);\n" + "B = group A by (a0);\n" + "store B INTO 'output';\n";
  verify(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test3() throws Exception {
  String query="a = load '1.txt'  as (name, age, gpa);" + "b = group a by name PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner2;" + "c = foreach b generate group, COUNT(a.age);"+ "store c into 'y';";
  String expected="macro_mymacro_a_0 = load '1.txt' as (name, age, gpa);\n" + "macro_mymacro_b_0 = group macro_mymacro_a_0 by (name) PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner2;\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 generate group, COUNT(macro_mymacro_a_0.(age));\n"+ "store macro_mymacro_c_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void foreachTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    $B = foreach $A generate $0, $2;\n" + "    C = group $A by $0;\n"+ "    X = FOREACH C GENERATE group, SUM ($A.$1);\n"+ "    Y = FOREACH C GENERATE group, FLATTEN($A);\n"+ "    Z = FOREACH C GENERATE FLATTEN($A.($0, $2)), FLATTEN($A.age);\n"+ "    X = FOREACH $A GENERATE $1+$2 AS f1:int;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age:int, zip:int);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age:int, zip:int);\n" + "gamma = foreach alpha generate $0, $2;\n" + "macro_group_and_count_C_0 = group alpha by ($0);\n"+ "macro_group_and_count_X_0 = FOREACH macro_group_and_count_C_0 GENERATE group, SUM(alpha.($1));\n"+ "macro_group_and_count_Y_0 = FOREACH macro_group_and_count_C_0 GENERATE group, FLATTEN(alpha) ;\n"+ "macro_group_and_count_Z_0 = FOREACH macro_group_and_count_C_0 GENERATE FLATTEN(alpha.($0, $2)) , FLATTEN(alpha.(age)) ;\n"+ "macro_group_and_count_X_0 = FOREACH alpha GENERATE $1 + $2 AS f1:int;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void recursiveMacrosTest() throws Exception {
  String macro1="define group_and_partition (A, group_key, reducers) returns B {\n" + "    C = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "    $B = foreach_count(C, $A);"+ "};\n";
  String macro2="define foreach_count(A, C) returns B {\n" + "    $B = foreach $A generate group, COUNT($C);\n" + "};\n";
  String script=macro2 + macro1 + "alpha = load 'users' as (user, age, zip);\n"+ "gamma = group_and_partition (alpha, user, 23);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_partition_C_0 = group alpha by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "gamma = foreach macro_group_and_partition_C_0 generate group, COUNT(alpha);\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void streamTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    $B = STREAM $A THROUGH `stream.pl -n 5`;\n" + "    DEFINE mycmd `stream.pl -n 5`;\n"+ "    $B = STREAM $A THROUGH mycmd;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = STREAM alpha THROUGH `stream.pl -n 5`;\n" + "DEFINE mycmd `stream.pl -n 5`;\n"+ "gamma = STREAM alpha THROUGH mycmd;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test21() throws Exception {
  String macro="a = load '1.txt' as ( u:tuple(p, q), v, w : int );" + "b = foreach a generate * as ( x, y, z ), flatten( u ) as ( r, s ), flatten( v ) as d, w + 5 as e:int;";
  String expected="macro_mymacro_a_0 = load '1.txt' as (u:(p, q), v, w:int);\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate  * AS (x, y, z), flatten(u)  AS (r, s), flatten(v)  AS d, w + 5 AS e:int;\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void crossTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    $B = CROSS $A, $C partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = group_and_count (alpha, beta);\n"+ "delta = group_and_count (beta, alpha);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = CROSS alpha, beta partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "delta = CROSS beta, alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void mapreduceTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    $B = MAPREDUCE 'wordcount.jar' STORE $A INTO 'inputDir' LOAD 'outputDir' " + "AS (word:chararray, count: int) `org.myorg.WordCount inputDir outputDir`;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = MAPREDUCE 'wordcount.jar' STORE alpha INTO 'inputDir' LOAD 'outputDir' AS (word:chararray, count:int) `org.myorg.WordCount inputDir outputDir`;\n" + "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test34() throws Exception {
  String query="a = load 'testComplexLoad' as (m:map[bag{(i:int,j:int)}]);";
  String expected="macro_mymacro_a_0 = load 'testComplexLoad' as m:map[bag{T:(i:int, j:int)}];\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScopedAlias() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray);" + "B = load 'y' as ( u:int, x:int, y:chararray);" + "C = join A by u, B by u;"+ "D = foreach C generate A::u, B::u, v, x;"+ "store D into 'z';";
  String expected="macro_mymacro_A_0 = load 'x' as (u:int, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = load 'y' as (u:int, x:int, y:chararray);\n" + "macro_mymacro_C_0 = join macro_mymacro_A_0 by (u), macro_mymacro_B_0 by (u);\n"+ "macro_mymacro_D_0 = foreach macro_mymacro_C_0 generate macro_mymacro_A_0::u, macro_mymacro_B_0::u, v, x;\n"+ "store macro_mymacro_D_0 INTO 'z';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sequenceMacrosTest() throws Exception {
  String macro1="define foreach_count(A, C) returns B {\n" + "    $B = foreach $A generate group, COUNT($C);\n" + "};\n";
  String macro2="define group_and_partition (A, group_key, reducers) returns B {\n" + "    $B = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "};\n";
  String script=macro1 + macro2 + "alpha = load 'users' as (user, age, zip);\n"+ "beta = group_and_partition (alpha, user, 20);\n"+ "gamma = foreach_count(beta, alpha);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = group alpha by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 20;\n" + "gamma = foreach beta generate group, COUNT(alpha);\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void defineTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    DEFINE CMD `perl PigStreaming.pl - nameMap` input(stdin using PigStreaming(',')) output(stdout using PigStreaming(','));\n" + "    DEFINE mycmd `stream_cmd input file.dat`;\n"+ "    DEFINE Z `stream.pl` stderr('<dir>' limit 100);\n"+ "    $B = STREAM $A THROUGH CMD;\n"+ "    D = STREAM $A THROUGH mycmd;\n"+ "    F = STREAM $A THROUGH Z;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "DEFINE CMD `perl PigStreaming.pl - nameMap` input(stdin USING PigStreaming(',')) output (stdout USING PigStreaming(','));\n" + "DEFINE mycmd `stream_cmd input file.dat`;\n"+ "DEFINE Z `stream.pl` stderr ('<dir>' LIMIT 100);\n"+ "gamma = STREAM alpha THROUGH CMD;\n"+ "macro_group_and_count_D_0 = STREAM alpha THROUGH mycmd;\n"+ "macro_group_and_count_F_0 = STREAM alpha THROUGH Z;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test17() throws Exception {
  String macro="a = load '/user/pig/tests/data/singlefile/studentnulltab10k' as (name:chararray, age:int, gpa:double);" + "b = foreach a generate (int)((int)gpa/((int)gpa - 1)) as norm_gpa:int;" + "c = foreach b generate (norm_gpa is not null? norm_gpa: 0);"+ "store c into '/user/pig/out/jianyong.1297229709/Types_37.out';";
  String expected="macro_mymacro_a_0 = load '/user/pig/tests/data/singlefile/studentnulltab10k' as (name:chararray, age:int, gpa:double);\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate (int)((int)gpa / ((int)gpa - 1)) AS norm_gpa:int;\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 generate  (norm_gpa IS not null ? norm_gpa : 0) ;\n"+ "store macro_mymacro_c_0 INTO '/user/pig/out/jianyong.1297229709/Types_37.out';\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest5() throws Throwable {
  String macro="define group_and_count (A,C) returns B {\n" + "    B = JOIN $A BY user, $C BY user;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro 'group_and_count' missing return alias: B";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDeclareInMacroFile() throws Exception {
  String macro;
  if (Util.WINDOWS) {
    macro="%declare ECHOED_MULTIPLIER `echo $MULTIPLIER`" + "DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $ECHOED_MULTIPLIER;\n"+ "};";
  }
 else {
    macro="%declare ECHOED_MULTIPLIER `echo \"$MULTIPLIER\"`" + "DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $ECHOED_MULTIPLIER;\n"+ "};";
  }
  createFile("my_macro.pig",macro);
  String script="%default MULTIPLIER 5\n" + "IMPORT 'my_macro.pig';\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n"+ "mult = MultiplyMacro(data);\n"+ "STORE mult INTO 'multiplied.out' USING PigStorage();";
  String expected="data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "mult = FOREACH data GENERATE $0 * 5;\n" + "STORE mult INTO 'multiplied.out' USING PigStorage();\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = distinct A partition by org.apache.pig.test.utils.SimpleCustomPartitioner; " + "C = sample B 0.49; "+ "D = order C by $0, $1; "+ "E = load 'y' as (d1, d2); "+ "F = union onschema D, E; "+ "G = load 'z' as (g1:int, g2:tuple(g21, g22)); "+ "H = cross F, G; "+ "split H into I if 10 > 5, J if 'world' eq 'hello', K if 77 <= 200; "+ "L = store J into 'output';";
  String expected="macro_mymacro_A_0 = load 'x' as (u:int, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = distinct macro_mymacro_A_0 partition BY org.apache.pig.test.utils.SimpleCustomPartitioner;\n" + "macro_mymacro_C_0 = sample macro_mymacro_B_0 0.49;\n"+ "macro_mymacro_D_0 = order macro_mymacro_C_0 BY $0, $1;\n"+ "macro_mymacro_E_0 = load 'y' as (d1, d2);\n"+ "macro_mymacro_F_0 = union onschema macro_mymacro_D_0, macro_mymacro_E_0;\n"+ "macro_mymacro_G_0 = load 'z' as (g1:int, g2:(g21, g22));\n"+ "macro_mymacro_H_0 = cross macro_mymacro_F_0, macro_mymacro_G_0;\n"+ "split macro_mymacro_H_0 INTO macro_mymacro_I_0 IF 10 > 5, macro_mymacro_J_0 IF 'world' eq 'hello', macro_mymacro_K_0 IF 77 <= 200;\n"+ "macro_mymacro_L_0 = store macro_mymacro_J_0 INTO 'output';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void defineTest2() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    DEFINE CMD `perl stream.pl data.gz` SHIP('" + Util.encodeEscape(command.toString()) + "') CACHE('"+ Util.encodeEscape(command.toString())+ "');\n"+ "    $B = STREAM $A THROUGH CMD;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  verify(macro + script);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test33() throws Exception {
  String query="a = load 'testSimpleMapCast' as (m);" + "b = foreach a generate ([int])m;";
  String expected="macro_mymacro_a_0 = load 'testSimpleMapCast' as m;\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate (map[int])m;\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test6() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = group A by ( a, $2 );" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:int, b, c:chararray);\n" + "macro_mymacro_B_0 = group macro_mymacro_A_0 by (a, $2);\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupicatedMacroNameTest() throws Throwable {
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user, 23);\n" + "delta = group_and_count (alpha, age, 32);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expectedErr="Reason: Duplicated macro name 'group_and_count'";
  validateFailure(groupAndCountMacro + groupAndCountMacro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nestedTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    C = group $A by $0;\n" + "    $B = FOREACH C { \n"+ "       FA = FILTER $A BY user == 'www.xyz.org';\n"+ "       PA = FA.age;\n"+ "       DA = DISTINCT PA;\n"+ "       GENERATE group, COUNT(DA);\n"+ "   }\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_count_C_0 = group alpha by ($0);\n" + "gamma = FOREACH macro_group_and_count_C_0 { FA = FILTER alpha BY user == 'www.xyz.org'; PA = FA.(age); DA = DISTINCT PA;  GENERATE group, COUNT(DA); } ;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nestedMacrosTest() throws Exception {
  String macro1="define test ( in, out, x ) returns void {\n" + "a = load '$in' as (name, age, gpa);\n" + "b = group a by gpa;\n"+ "c = foreach b generate group, COUNT(a.$x);\n"+ "store c into '$out';\n"+ "};\n";
  String macro2="define test2( in, out ) returns void {\n" + "test( '$in', '$out', 'name' );\n" + "test( '$in', '$out.1', 'age' );\n"+ "test( '$in', '$out.2', 'gpa' );\n"+ "};\n";
  String script="test2('studenttab10k', 'myoutput');";
  String expected="macro_test2_macro_test_a_0_0 = load 'studenttab10k' as (name, age, gpa);\n" + "macro_test2_macro_test_b_0_0 = group macro_test2_macro_test_a_0_0 by (gpa);\n" + "macro_test2_macro_test_c_0_0 = foreach macro_test2_macro_test_b_0_0 generate group, COUNT(macro_test2_macro_test_a_0_0.(name));\n"+ "store macro_test2_macro_test_c_0_0 INTO 'myoutput';\n"+ "macro_test2_macro_test_a_1_0 = load 'studenttab10k' as (name, age, gpa);\n"+ "macro_test2_macro_test_b_1_0 = group macro_test2_macro_test_a_1_0 by (gpa);\n"+ "macro_test2_macro_test_c_1_0 = foreach macro_test2_macro_test_b_1_0 generate group, COUNT(macro_test2_macro_test_a_1_0.(age));\n"+ "store macro_test2_macro_test_c_1_0 INTO 'myoutput.1';\n"+ "macro_test2_macro_test_a_2_0 = load 'studenttab10k' as (name, age, gpa);\n"+ "macro_test2_macro_test_b_2_0 = group macro_test2_macro_test_a_2_0 by (gpa);\n"+ "macro_test2_macro_test_c_2_0 = foreach macro_test2_macro_test_b_2_0 generate group, COUNT(macro_test2_macro_test_a_2_0.(gpa));\n"+ "store macro_test2_macro_test_c_2_0 INTO 'myoutput.2';\n";
  verify(macro1 + macro2 + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test20() throws Exception {
  String macro="a = load 'x' as (u,v);" + "b = load 'y' as (u,w);" + "c = join a by u, b by u;"+ "d = foreach c generate a::u, b::u, w;";
  String expected="macro_mymacro_a_0 = load 'x' as (u, v);\n" + "macro_mymacro_b_0 = load 'y' as (u, w);\n" + "macro_mymacro_c_0 = join macro_mymacro_a_0 by (u), macro_mymacro_b_0 by (u);\n"+ "macro_mymacro_d_0 = foreach macro_mymacro_c_0 generate macro_mymacro_a_0::u, macro_mymacro_b_0::u, w;\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test29() throws Exception {
  String content="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.$1, $0; "+ "D = store C into 'output';";
  String expected="macro_mymacro_A_0 = load 'x';\n" + "macro_mymacro_B_0 = load 'y' as (u:int, v:chararray);\n" + "macro_mymacro_C_0 = foreach macro_mymacro_A_0 generate macro_mymacro_B_0.($1), $0;\n"+ "macro_mymacro_D_0 = store macro_mymacro_C_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void storeTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    $B = CROSS $A, $C partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "    STORE $A INTO 'myoutput' USING PigStorage ('*');\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = group_and_count (alpha, beta);\n"+ "delta = group_and_count (beta, alpha);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = CROSS alpha, beta partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "STORE alpha INTO 'myoutput' USING PigStorage('*');\n"+ "delta = CROSS beta, alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "STORE beta INTO 'myoutput' USING PigStorage('*');\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cogroupTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    D = cogroup $A by user, $C by user parallel 50;\n" + "    $B = cogroup $A by user inner, $C by user inner parallel 50;\n"+ "    Y = COGROUP $A BY (user, age), $C by (user, view) USING 'merge';\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = group_and_count (alpha, beta);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "macro_group_and_count_D_0 = cogroup alpha by (user), beta by (user) parallel 50;\n"+ "gamma = cogroup alpha by (user) inner, beta by (user) inner parallel 50;\n"+ "macro_group_and_count_Y_0 = COGROUP alpha BY (user, age), beta by (user, view) USING 'merge';\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test5() throws Exception {
  String query="define myudf org.apache.pig.builtin.PigStorage( ',' );" + "A = load 'x' using myudf;" + "store A into 'y';";
  String expected="define myudf org.apache.pig.builtin.PigStorage(',');\n" + "macro_mymacro_A_0 = load 'x' USING myudf;\n" + "store macro_mymacro_A_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void loadTest() throws Exception {
  String macro="define group_and_count (path) returns B {\n" + "    D = load 'myfile.txt' using PigStorage('\t') AS (name:chararray, age:int, gpa:float);\n" + "    $B = load '$path' using PigStorage('\t') AS (F:tuple(f1:int,f2:int,f3:int),T:tuple(t1:chararray,t2:int));\n"+ "    E = load 'myfile.txt' using org.apache.pig.builtin.PigStorage('\t') AS (B:bag{T:tuple(t1:int, t2:int, t3:int)});\n"+ "    F = load 'myfile.txt' using org.apache.pig.builtin.PigStorage('\t') AS (T1:tuple(f1:int, f2:int), B:bag{T2:tuple(t1:float,t2:float)}, M:map[]);\n"+ "};\n";
  String script="gamma = group_and_count (myfile);\n" + "delta = group_and_count (mydir);\n" + "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="macro_group_and_count_D_0 = load 'myfile.txt' USING PigStorage('\t') AS (name:chararray, age:int, gpa:float);\n" + "gamma = load 'myfile' USING PigStorage('\t') AS (F:(f1:int, f2:int, f3:int), T:(t1:chararray, t2:int));\n" + "macro_group_and_count_E_0 = load 'myfile.txt' USING org.apache.pig.builtin.PigStorage('\t') AS B:bag{T:(t1:int, t2:int, t3:int)};\n"+ "macro_group_and_count_F_0 = load 'myfile.txt' USING org.apache.pig.builtin.PigStorage('\t') AS (T1:(f1:int, f2:int), B:bag{T:(t1:float, t2:float)}, M:map[]);\n"+ "macro_group_and_count_D_1 = load 'myfile.txt' USING PigStorage('\t') AS (name:chararray, age:int, gpa:float);\n"+ "delta = load 'mydir' USING PigStorage('\t') AS (F:(f1:int, f2:int, f3:int), T:(t1:chararray, t2:int));\n"+ "macro_group_and_count_E_1 = load 'myfile.txt' USING org.apache.pig.builtin.PigStorage('\t') AS B:bag{T:(t1:int, t2:int, t3:int)};\n"+ "macro_group_and_count_F_1 = load 'myfile.txt' USING org.apache.pig.builtin.PigStorage('\t') AS (T1:(f1:int, f2:int), B:bag{T:(t1:float, t2:float)}, M:map[]);\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedImport() throws Exception {
  String nested_macros="DEFINE NestedMultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $MULTIPLIER;\n" + "};\n"+ "DEFINE LogarithmMacro(numbers) RETURNS logs {\n"+ "    $logs = FOREACH $numbers GENERATE LOG($0);\n"+ "};\n";
  createFile("nested_macros.pig",nested_macros);
  String macro="%default MULTIPLIER 5\n" + "IMPORT 'nested_macros.pig';" + "DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n"+ "    $multiplied = NestedMultiplyMacro($numbers);\n"+ "};";
  createFile("my_macros.pig",macro);
  String script="IMPORT 'my_macro.pig';\n" + "IMPORT 'nested_macros.pig';\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n"+ "mult = MultiplyMacro(data);\n"+ "logs = LogarithmMacro(mult);\n"+ "STORE logs INTO 'result.out' USING PigStorage();";
  String expected="data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "mult = FOREACH data GENERATE $0 * 5;\n" + "logs = FOREACH mult GENERATE LOG($0);\n"+ "STORE logs INTO 'result.out' USING PigStorage();\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void limitTest() throws Exception {
  String macro="define group_and_count (A,group_key, size) returns B {\n" + "    $B = limit $A $size;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user, 20);\n" + "delta = group_and_count (alpha, age, 39);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = limit alpha 20;\n" + "delta = limit alpha 39;\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void splitTest() throws Exception {
  String macro="define group_and_count (A,key) returns B {\n" + "    SPLIT $A INTO $B IF $key<7, Y IF $key==5, Z IF ($key<6 OR $key>6);\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, age);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "SPLIT alpha INTO gamma IF age < 7, macro_group_and_count_Y_0 IF age == 5, macro_group_and_count_Z_0 IF (age < 6) OR (age > 6);\n" + "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest6() throws Throwable {
  String macro="define group_and_count (A,C) returns B {\n" + "    B = JOIN $A BY $B, $C BY user;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro 'group_and_count' missing return alias: B";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test16() throws Exception {
  String query="AA = load '/user/pig/tests/data/singlefile/studenttab10k';" + "A = foreach (group (filter AA by $0 > 0) all) generate flatten($1);" + "store A into '/user/pig/out/jianyong.1297323675/Scalar_4.out';";
  String expected="macro_mymacro_AA_0 = load '/user/pig/tests/data/singlefile/studenttab10k';\n" + "macro_mymacro_A_0 = foreach  (group  (filter macro_mymacro_AA_0 BY ($0 > 0))  all)  generate flatten($1) ;\n" + "store macro_mymacro_A_0 INTO '/user/pig/out/jianyong.1297323675/Scalar_4.out';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void recursiveMacrosTest2() throws Exception {
  String macro1="define foreach_count(A, C) returns B {\n" + "    $B = foreach $A generate group, COUNT($C);\n" + "};\n";
  String macro2="define group_and_partition (A, group_key, reducers) returns B {\n" + "    C = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "    $B = foreach_count(C, $A);\n"+ "};\n";
  String macro3="define load_and_group() returns B {\n" + "   alpha = load 'users' as (user, age, zip);\n" + "   $B = group_and_partition(alpha, user, 30);\n"+ "};\n";
  String script=macro1 + macro2 + macro3+ "gamma = load_and_group ();\n"+ "store gamma into 'byuser';\n";
  String expected="macro_load_and_group_alpha_0 = load 'users' as (user, age, zip);\n" + "macro_load_and_group_macro_group_and_partition_C_0_0 = group macro_load_and_group_alpha_0 by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 30;\n" + "gamma = foreach macro_load_and_group_macro_group_and_partition_C_0_0 generate group, COUNT(macro_load_and_group_alpha_0);\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test32() throws Exception {
  String query="a = load 'testSimpleMapKeyLookup' as (m:map[int]);" + "b = foreach a generate m#'key';";
  String expected="macro_mymacro_a_0 = load 'testSimpleMapKeyLookup' as m:map[int];\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate m#'key';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefaultInMacroFile() throws Exception {
  String macro="%default MULTIPLIER 5\n" + "DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $MULTIPLIER;\n"+ "};";
  createFile("my_macro.pig",macro);
  String script="IMPORT 'my_macro.pig';\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n" + "mult = MultiplyMacro(data);\n"+ "STORE mult INTO 'multiplied.out' USING PigStorage();";
  String expected="data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "mult = FOREACH data GENERATE $0 * 5;\n" + "STORE mult INTO 'multiplied.out' USING PigStorage();\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void outerTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    $B = JOIN $A BY user right outer, $C BY user partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "    D = JOIN $A BY user LEFT, $C BY user;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = JOIN alpha BY (user) right outer, beta BY (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "macro_group_and_count_D_0 = JOIN alpha BY (user) LEFT, beta BY (user);\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void caseInsensitiveTest() throws Exception {
  String macro="DEFINE group_and_count (A,group_key) RETURNS B {\n" + "    D = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n" + "    $B = foreach D generate group, COUNT($A);\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user);\n" + "delta = group_and_count (alpha, age);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_count_D_0 = group alpha by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n" + "gamma = foreach macro_group_and_count_D_0 generate group, COUNT(alpha);\n"+ "macro_group_and_count_D_1 = group alpha by (age) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n"+ "delta = foreach macro_group_and_count_D_1 generate group, COUNT(alpha);\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParamPassedToMacroInPigscript() throws Exception {
  String macro="DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $MULTIPLIER;\n" + "};";
  String script="%default MULTIPLIER 5\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n" + "mult = MultiplyMacro(data);\n"+ "STORE mult INTO 'multiplied.out' USING PigStorage();";
  String expected="data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "mult = FOREACH data GENERATE $0 * 5;\n" + "STORE mult INTO 'multiplied.out' USING PigStorage();\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test4() throws Exception {
  String query="A = load 'x'; " + "B = mapreduce '" + "myjar.jar"+ "' "+ "Store A into 'table_testNativeMRJobSimple_input' "+ "Load 'table_testNativeMRJobSimple_output' "+ "`org.apache.pig.test.utils.WordCount -files "+ "file "+ "table_testNativeMRJobSimple_input table_testNativeMRJobSimple_output "+ "stopworld.file"+ "`;"+ "C = Store B into 'output';";
  String expected="macro_mymacro_A_0 = load 'x';\n" + "macro_mymacro_B_0 = mapreduce 'myjar.jar' Store macro_mymacro_A_0 INTO 'table_testNativeMRJobSimple_input' Load 'table_testNativeMRJobSimple_output' `org.apache.pig.test.utils.WordCount -files file table_testNativeMRJobSimple_input table_testNativeMRJobSimple_output stopworld.file`;\n" + "macro_mymacro_C_0 = Store macro_mymacro_B_0 INTO 'output';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test15() throws Exception {
  String query="a = load '/user/pig/tests/data/singlefile/studenttab10k' using PigStorage() as (name, age, gpa);" + "b = group a all;" + "c = foreach b generate AVG(a.age) as avg; "+ "d = load '/user/pig/tests/data/singlefile/votertab10k' using PigStorage() as (name, age, registration, contributions);"+ "e = group d all;"+ "f = foreach e generate AVG(d.age) as avg;"+ "y = foreach a generate age/c.avg, age/f.avg;"+ "store y into '/user/pig/out/jianyong.1297323675/Scalar_4.out';";
  String expected="macro_mymacro_a_0 = load '/user/pig/tests/data/singlefile/studenttab10k' USING PigStorage() as (name, age, gpa);\n" + "macro_mymacro_b_0 = group macro_mymacro_a_0 all;\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 generate AVG(macro_mymacro_a_0.(age)) AS avg;\n"+ "macro_mymacro_d_0 = load '/user/pig/tests/data/singlefile/votertab10k' USING PigStorage() as (name, age, registration, contributions);\n"+ "macro_mymacro_e_0 = group macro_mymacro_d_0 all;\n"+ "macro_mymacro_f_0 = foreach macro_mymacro_e_0 generate AVG(macro_mymacro_d_0.(age)) AS avg;\n"+ "macro_mymacro_y_0 = foreach macro_mymacro_a_0 generate age / macro_mymacro_c_0.(avg), age / macro_mymacro_f_0.(avg);\n"+ "store macro_mymacro_y_0 INTO '/user/pig/out/jianyong.1297323675/Scalar_4.out';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void recursiveMacrosTest3() throws Exception {
  String macro1="define group_and_partition (A, group_key, reducers) returns B, D  {\n" + "    C = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "    $B, $D = foreach_count(C, $A);"+ "};\n";
  String macro2="define foreach_count(A, C) returns B, D {\n" + "   $B = foreach $A generate group, COUNT($C);\n" + "   $D = foreach $A generate group, COUNT($C);\n"+ "};\n";
  String script=macro2 + macro1 + "alpha = load 'users' as (user, age, zip);\n"+ "gamma, beta = group_and_partition (alpha, user, 23);\n"+ "store beta into 'byage';\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_partition_C_0 = group alpha by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "gamma = foreach macro_group_and_partition_C_0 generate group, COUNT(alpha);\n"+ "beta = foreach macro_group_and_partition_C_0 generate group, COUNT(alpha);\n"+ "store beta INTO 'byage';\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test28() throws Exception {
  String content="A = load 'x'; " + "B = foreach A generate $1, $1000; " + "C = store B into 'output';";
  String expected="macro_mymacro_A_0 = load 'x';\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 generate $1, $1000;\n" + "macro_mymacro_C_0 = store macro_mymacro_B_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest7() throws Throwable {
  String macro="define toBytearray(in, intermediate) returns e {\n" + "b = load '$in' as (name:chararray, age:long, gpa: float);\n" + "d = load '$intermediate' using BinStorage() as (b:bag{t:tuple(x,y,z)}, t2:tuple(a,b,c));\n"+ "$e = foreach d generate COUNT(b), t2.a, t2.b, t2.c;};\n";
  String script="f = toBytearray ('data', 'output1');\n";
  String expectedErr="pig script failed to validate: Macro doesn't support user defined schema " + "that contains name that conflicts with alias name: b\n" + "macro content: \n"+ "b = load 'data' as (name:chararray, age:long, gpa: float);\n"+ "d = load 'output1' using BinStorage() as (b:bag{t:tuple(x,y,z)}, t2:tuple(a,b,c));\n"+ "f = foreach d generate COUNT(b), t2.a, t2.b, t2.c;\n";
  validateFailure(macro + script,expectedErr,"pig script failed to validate:");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test8() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = group A by a;" + "C = foreach B { S = A.b; generate S; };"+ "store C into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:int, b, c:chararray);\n" + "macro_mymacro_B_0 = group macro_mymacro_A_0 by (a);\n" + "macro_mymacro_C_0 = foreach macro_mymacro_B_0 { S = macro_mymacro_A_0.(b);  generate S; } ;\n"+ "store macro_mymacro_C_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMacroAliasConversion() throws Exception {
  String macro="define my_macro (X,key) returns Y {\n" + "$Y = filter $X by $key>0;\n" + "};\n";
  String script="A = load 'sometext1' using TextLoader() as (row1) ;\n" + "E = my_macro (A, $0);\n" + "store E into 'byrow1';\n";
  String expected="A = load 'sometext1' USING TextLoader() as row1;\n" + "E = filter A BY ($0 > 0);\n" + "store E INTO 'byrow1';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void importTwoFilesTest() throws Exception {
  String macro1="define group_and_count (A, reducers) returns B {\n" + "    $B = distinct $A partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "};\n";
  String macro2="define distinct_with_reducer(A, reducers) returns B {\n" + "    $B = distinct $A partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "};\n";
  createFile("mytest4.pig",macro1);
  createFile("mytest5.pig",macro2);
  String script="import 'mytest4.pig';\n" + "import 'mytest5.pig';\n" + "alpha = load 'users' as (user, age, zip);\n"+ "gamma = group_and_count (alpha, 23);\n"+ "beta = distinct_with_reducer(alpha, 32);\n"+ "store beta into 'byage';\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "beta = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 32;\n"+ "store beta INTO 'byage';\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void noSemiColonTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    $B = FILTER $A BY ($1 == 8) OR (NOT ($0+$2 > $1));\n" + "}\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = FILTER alpha BY (($1 == 8) OR ( NOT ($0 + $2 > $1)));\n" + "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest() throws Throwable {
  String macro="define group_and_count (A,group_key, size) returns B {\n" + "    $B = limit $A $size;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, 20);\n" + "store gamma into 'byuser';\n";
  String expectedErr="Reason: Expected number of parameters: 3 actual number of inputs: 2";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void noReturnTest() throws Exception {
  String macro="define group_and_count() returns void {\n" + "    D = load 'myfile.txt' using PigStorage() AS (a0:int, a1:int, a2:int);\n" + "    store D into 'myoutput';\n"+ "};\n";
  String script="group_and_count();\n";
  String expected="macro_group_and_count_D_0 = load 'myfile.txt' USING PigStorage() AS (a0:int, a1:int, a2:int);\n" + "store macro_group_and_count_D_0 INTO 'myoutput';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNegativeNumber() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = filter A by 2 > -1; ";
  String expected="macro_mymacro_A_0 = load 'x' as (u:int, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = filter macro_mymacro_A_0 BY (2 > -1);\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = filter A by 2 > 1; ";
  String expected="macro_mymacro_A_0 = load 'x' as (u:int, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = filter macro_mymacro_A_0 BY (2 > 1);\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void unionTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    D = union $A, $C;\n" + "    $B = union onschema $A, $C;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "gamma = group_and_count (alpha, beta);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, page, view);\n" + "macro_group_and_count_D_0 = union alpha, beta;\n"+ "gamma = union onschema alpha, beta;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void checkReturnAliasTest1() throws Throwable {
  String macro="define group_and_count_1 (A,C) returns B {\n" + "    /* this is a test $B and \n" + "    $B = JOIN $A BY user, $C BY user; */\n"+ "    B = JOIN $A BY user, $C BY user;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count_1 (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro 'group_and_count_1' missing return alias: B";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test31() throws Exception {
  String content="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.v, $0; "+ "D = store C into 'output';";
  String expected="macro_mymacro_A_0 = load 'x';\n" + "macro_mymacro_B_0 = load 'y' as (u:int, v:chararray);\n" + "macro_mymacro_C_0 = foreach macro_mymacro_A_0 generate macro_mymacro_B_0.(v), $0;\n"+ "macro_mymacro_D_0 = store macro_mymacro_C_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void typecastTest() throws Exception {
  String macro="a = load '1.txt' as (a0);" + "b = foreach a generate flatten( (bag{tuple(map[])})a0 ) as b0:map[];" + "c = foreach b generate (long)b0#'key1';";
  String expected="macro_mymacro_a_0 = load '1.txt' as a0;\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate flatten((bag{tuple(map[])})a0)  AS b0:map[];\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 generate (long)b0#'key1';\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void splitOtherwiseTest() throws Exception {
  String macro="define group_and_count (A,key) returns B {\n" + "SPLIT $A INTO $B IF $key<7, Y IF $key==5, Z OTHERWISE;\n" + "};\n";
  String script="alpha = load 'users' as (f1:int);\n" + "gamma = group_and_count (alpha, f1);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as f1:int;\n" + "SPLIT alpha INTO gamma IF f1 < 7, macro_group_and_count_Y_0 IF f1 == 5, macro_group_and_count_Z_0 OTHERWISE;\n" + "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void simpleImportTest() throws Exception {
  createFile("mytest.pig",groupAndCountMacro);
  String script="import 'mytest.pig';\n" + "alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user, 23);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest8() throws Throwable {
  String macro="define toBytearray(in, intermediate) returns e {\n" + "b = load '$in' as (name:chararray, age:long, gpa: float);\n" + "d = foreach b generate $0 as b:bag{t:tuple(x,y,z)};\n"+ "$e = foreach d generate COUNT(b), t2.a, t2.b, t2.c;};\n";
  String script="f = toBytearray ('data', 'output1');\n";
  String expectedErr="pig script failed to validate: Macro doesn't support user defined schema " + "that contains name that conflicts with alias name: b\n" + "macro content: \n"+ "b = load 'data' as (name:chararray, age:long, gpa: float);\n"+ "d = foreach b generate $0 as b:bag{t:tuple(x,y,z)};\n"+ "f = foreach d generate COUNT(b), t2.a, t2.b, t2.c;\n";
  validateFailure(macro + script,expectedErr,"pig script failed to validate:");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test14() throws Exception {
  String query="a = load '/user/pig/tests/data/singlefile/studenttab10k' using PigStorage() as (name, age:int, gpa);" + "b = load '/user/pig/tests/data/singlefile/votertab10k' as (name, age, registration, contributions);" + "e = cogroup a by name, b by name parallel 8;"+ "f = foreach e generate group,  SUM(a.age) as s;"+ "g = filter f by s>0;"+ "store g into '/user/pig/out/jianyong.1297323675/Accumulator_1.out';";
  String expected="macro_mymacro_a_0 = load '/user/pig/tests/data/singlefile/studenttab10k' USING PigStorage() as (name, age:int, gpa);\n" + "macro_mymacro_b_0 = load '/user/pig/tests/data/singlefile/votertab10k' as (name, age, registration, contributions);\n" + "macro_mymacro_e_0 = cogroup macro_mymacro_a_0 by (name), macro_mymacro_b_0 by (name) parallel 8;\n"+ "macro_mymacro_f_0 = foreach macro_mymacro_e_0 generate group, SUM(macro_mymacro_a_0.(age)) AS s;\n"+ "macro_mymacro_g_0 = filter macro_mymacro_f_0 BY (s > 0);\n"+ "store macro_mymacro_g_0 INTO '/user/pig/out/jianyong.1297323675/Accumulator_1.out';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void filterTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    $B = FILTER $A BY ($1 == 8) OR (NOT ($0+$2 > $1));\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = FILTER alpha BY (($1 == 8) OR ( NOT ($0 + $2 > $1)));\n" + "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test27() throws Exception {
  String content="A = load 'x' as ( u:bag{} ); " + "B = foreach A generate u.$100; " + "C = store B into 'output';";
  String expected="macro_mymacro_A_0 = load 'x' as u:bag{};\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 generate u.($100);\n" + "macro_mymacro_C_0 = store macro_mymacro_B_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void checkReturnAliasTest2() throws Throwable {
  String macro="define group_and_count_2 (A,C) returns B {\n" + "    -- $B = JOIN $A BY user, $C BY user; \n" + "    --$B = JOIN $A BY user, $C BY user; \n"+ "    B = JOIN $A BY user, $C BY user;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count_2 (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro 'group_and_count_2' missing return alias: B";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegister() throws Exception {
  String udfs="@outputSchema(\"result: int\")\n" + "def some_udf(number):\n" + "    return number + 1\n"+ "\n";
  createFile("my_udfs.py",udfs);
  String macro="REGISTER 'my_udfs.py' USING jython AS macro_udfs;\n" + "DEFINE ApplyUDF(numbers) RETURNS result {\n" + "    $result = FOREACH $numbers GENERATE macro_udfs.some_udf($0);\n"+ "};";
  createFile("my_macro.pig",macro);
  String script="IMPORT 'my_macro.pig';\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n" + "result = ApplyUDF(data);\n"+ "STORE result INTO 'result.out' USING PigStorage();";
  String expected="REGISTER 'my_udfs.py' USING jython AS macro_udfs;\n" + "data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "result = FOREACH data GENERATE macro_udfs.some_udf($0);\n"+ "STORE result INTO 'result.out' USING PigStorage();\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7() throws Exception {
  String query="A = load 'x' as ( a : int, b, c : chararray );" + "B = foreach A generate a, $2;" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:int, b, c:chararray);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 generate a, $2;\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test12() throws Exception {
  String query="define CMD `perl GroupBy.pl '\t' 0 1` ship('" + Util.encodeEscape(command.toString()) + "');"+ "A = load '/user/pig/tests/data/singlefile/studenttab10k';"+ "B = group A by $0;"+ "C = foreach B {"+ "   D = order A by $1; "+ "   generate flatten(D);"+ "};"+ "E = stream C through CMD;"+ "store E into '/user/pig/out/jianyong.1297238871/ComputeSpec_8.out';";
  testMacro(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bincondTest() throws Exception {
  String macro="define group_and_count (A) returns B {\n" + "    X = FOREACH $A GENERATE f1, f2, f0%f2;\n" + "    Y = FOREACH $A GENERATE f2, (f2==1?1:COUNT(B));\n"+ "    Z = FILTER $A BY f1 is not null;\n"+ "    $B = FILTER $A BY (f1 matches '.*apache.*');\n"+ "};\n";
  String script="alpha = LOAD 'data' AS (f0:long, f1:chararray, f2:int, B:bag{T:tuple(t1:int,t2:int)});\n" + "gamma = group_and_count (alpha);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = LOAD 'data' AS (f0:long, f1:chararray, f2:int, B:bag{T:(t1:int, t2:int)});\n" + "macro_group_and_count_X_0 = FOREACH alpha GENERATE f1, f2, f0 % f2;\n" + "macro_group_and_count_Y_0 = FOREACH alpha GENERATE f2,  (f2 == 1 ? 1 : COUNT(B)) ;\n"+ "macro_group_and_count_Z_0 = FILTER alpha BY (f1 IS not null);\n"+ "gamma = FILTER alpha BY (f1 matches '.*apache.*');\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void multiOutputsTest() throws Exception {
  String macro="define group_and_count (A,C) returns B, D {\n" + "    $B = JOIN $A BY user, $C BY user using 'replicated' partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "    $D = JOIN $A BY $0, $C BY $1 using 'skewed' parallel 5;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma, sigma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n"+ "store sigma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = JOIN alpha BY (user), beta BY (user) USING 'replicated' partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "sigma = JOIN alpha BY ($0), beta BY ($1) USING 'skewed' parallel 5;\n"+ "store gamma INTO 'byuser';\n"+ "store sigma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test30() throws Exception {
  String content="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.$1, $0; "+ "D = store C into 'output';";
  String expected="macro_mymacro_A_0 = load 'x';\n" + "macro_mymacro_B_0 = load 'y' as (u:int, v:chararray);\n" + "macro_mymacro_C_0 = foreach macro_mymacro_A_0 generate macro_mymacro_B_0.($1), $0;\n"+ "macro_mymacro_D_0 = store macro_mymacro_C_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParamPassedToMacroInSeparateFile() throws Exception {
  String macro="DEFINE MultiplyMacro(numbers) RETURNS multiplied {\n" + "    $multiplied = FOREACH $numbers GENERATE $0 * $MULTIPLIER;\n" + "};";
  createFile("my_macro.pig",macro);
  String script="%default MULTIPLIER 5\n" + "IMPORT 'my_macro.pig';\n" + "data = LOAD '1234.txt' USING PigStorage() AS (i: int);\n"+ "mult = MultiplyMacro(data);\n"+ "STORE mult INTO 'multiplied.out' USING PigStorage();";
  String expected="data = LOAD '1234.txt' USING PigStorage() AS i:int;\n" + "mult = FOREACH data GENERATE $0 * 5;\n" + "STORE mult INTO 'multiplied.out' USING PigStorage();\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void joinTest() throws Exception {
  String macro="define group_and_count (A,C) returns B {\n" + "    $B = JOIN $A BY user, $C BY user using 'replicated' partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n" + "    $B = JOIN $A BY $0, $C BY $1 using 'skewed' parallel 5;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = JOIN alpha BY (user), beta BY (user) USING 'replicated' partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 5;\n"+ "gamma = JOIN alpha BY ($0), beta BY ($1) USING 'skewed' parallel 5;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test13() throws Exception {
  String query="define CMD `perl PigStreaming.pl` ship('" + Util.encodeEscape(command.toString()) + "') stderr('CMD');"+ "A = load '/user/pig/tests/data/singlefile/studenttab10k';"+ "C = stream A through CMD;"+ "store C into '/user/pig/out/jianyong.1297238871/StreamingPerformance_1.out';";
  testMacro(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest9() throws Throwable {
  String macro="define test( out1,out2 ){ A = load 'x' as (u:int, v:int); $B = filter A by u < 3 and v < 20; }";
  String expectedErr="<file myscript.pig, line 1, column 24>  mismatched input '{' expecting RETURNS";
  validateFailure(macro,expectedErr,"<file");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test26() throws Exception {
  String content="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, $1), $1, w; " + "C = store B into 'output';";
  String expected="macro_mymacro_A_0 = load 'x' as (u:bag{T:(x, y)}, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 generate u.(x, $1), $1, w;\n" + "macro_mymacro_C_0 = store macro_mymacro_B_0 INTO 'output';\n";
  testMacro(content,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void importTwoMacrosTest() throws Exception {
  String macro="define group_and_count (A, reducers) returns B {\n" + "    $B = distinct $A partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "};\n"+ "define distinct_with_reducer(A, reducers) returns B {\n"+ "    $B = distinct $A partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n"+ "};\n";
  createFile("mytest.pig",macro);
  String script="import 'mytest.pig';\n" + "alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, 23);\n"+ "beta = distinct_with_reducer(alpha, 32);\n"+ "store beta into 'byage';\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "beta = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 32;\n"+ "store beta INTO 'byage';\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void checkReturnAliasTest3() throws Throwable {
  String macro="define group_and_count_2 (A,C) returns B {\n" + "    -- D = JOIN $A BY user, $C BY user; \n" + "    --D = JOIN $A BY user, $C BY user; \n"+ "    $B = JOIN $A BY user, $C BY user;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count_2 (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = JOIN alpha BY (user), beta BY (user);\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void distinctTest() throws Exception {
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user, 23);\n" + "delta = group_and_count (alpha, age, 32);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n" + "delta = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 32;\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(groupAndCountMacro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test11() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { T = limit a 100; generate T; };" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:bag{T:(u, v)}, c:int, d:long);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 { T = limit a 100;  generate T; } ;\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test24() throws Exception {
  String macro="A = load 'x' as ( u:bag{tuple(x, y)}, v:long, w:bytearray); " + "B = foreach A generate u.(x, y), v, w; " + "C = store B into 'output';";
  String expected="macro_mymacro_A_0 = load 'x' as (u:bag{T:(x, y)}, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 generate u.(x, y), v, w;\n" + "macro_mymacro_C_0 = store macro_mymacro_B_0 INTO 'output';\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void firstTest() throws Exception {
  String macro="define group_and_count (A,group_key) returns B {\n" + "    D = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n" + "    $B = foreach D generate group, COUNT($A);\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user);\n" + "delta = group_and_count (alpha, age);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_count_D_0 = group alpha by (user) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n" + "gamma = foreach macro_group_and_count_D_0 generate group, COUNT(alpha);\n"+ "macro_group_and_count_D_1 = group alpha by (age) partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 50;\n"+ "delta = foreach macro_group_and_count_D_1 generate group, COUNT(alpha);\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void orderbyTest() throws Exception {
  String macro="define group_and_count (A,f1,f2) returns B {\n" + "    $B = ORDER $A BY $f1 ASC, $f2 DESC PARALLEL 3;\n" + "    C = ORDER $A BY * ASC PARALLEL 3;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user, age);\n" + "delta = group_and_count (alpha, age, zip);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = ORDER alpha BY user ASC, age DESC PARALLEL 3;\n" + "macro_group_and_count_C_0 = ORDER alpha BY * ASC PARALLEL 3;\n"+ "delta = ORDER alpha BY age ASC, zip DESC PARALLEL 3;\n"+ "macro_group_and_count_C_1 = ORDER alpha BY * ASC PARALLEL 3;\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest2() throws Throwable {
  String macro="define group_and_count (A,group_key, size) returns B {\n" + "    $B = limit $A $size;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count ();\n" + "store gamma into 'byuser';\n";
  String expectedErr="Reason: Expected number of parameters: 3 actual number of inputs: 0";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void groupTest() throws Exception {
  String macro="define group_and_count (A,group_key) returns B {\n" + "    D = group $A by $group_key parallel 50;\n" + "    $B = foreach D generate group, COUNT($A);\n"+ "    X = GROUP $A BY $group_key USING 'collected';\n"+ "    Y = GROUP $A BY ($group_key, age) USING 'merge';\n"+ "    Z = GROUP $A ALL;"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, user);\n" + "store gamma into 'byuser';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "macro_group_and_count_D_0 = group alpha by (user) parallel 50;\n" + "gamma = foreach macro_group_and_count_D_0 generate group, COUNT(alpha);\n"+ "macro_group_and_count_X_0 = GROUP alpha BY (user) USING 'collected';\n"+ "macro_group_and_count_Y_0 = GROUP alpha BY (user, age) USING 'merge';\n"+ "macro_group_and_count_Z_0 = GROUP alpha ALL;\n"+ "store gamma INTO 'byuser';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test25() throws Exception {
  String macro="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { R = a; P = c * 2; Q = P + d; S = R.u; T = limit S 100; generate Q, R, S, T, c + d/5; };" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:bag{T:(u, v)}, c:int, d:long);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 { R = a; P = c * 2; Q = P + d; S = R.(u); T = limit S 100;  generate Q, R, S, T, c + d / 5; } ;\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void lineNumberTest1() throws Throwable {
  StringBuilder sb=new StringBuilder();
  sb.append("-- Given daily input and a particular year, analyze how\n").append("-- stock prices changed on days dividends were paid out.\n");
  sb.append("define dividend_analysis (daily, year, daily_symbol, daily_open, daily_close)\n" + "returns analyzed {\n" + "divs          = load 'NYSE_dividends' as (exchange:chararray,\n"+ "            symbol:chararray, date:chararray, dividends:float);\n"+ "divsthisyear  = filter divs by date matches '$year-.*';\n"+ "dailythisyear = filter $daily by date matches '$year-.*';\n"+ "jnd           = join divsthisyear by symbol, dailythisyear by $daily_symbol;\n"+ "$analyzed     = foreach jnd generate $daily_symbol, $daily_close - $daily_open;\n"+ "};\n");
  sb.append("daily   = load 'NYSE_daily' as (exchange:chararray, symbol:chararray,\n" + "date:chararray, open:float, high:float, low:float, close:float,\n" + "volume:int, adj_close:float);\n"+ "results = dividend_analysis(daily, '2009', 'symbol', 'open', 'close');\n"+ "store results into 'output';\n");
  String expectedErr="at expanding macro 'dividend_analysis' (myscript.pig:15)\n" + "<file myscript.pig, line 10, column 35> Invalid field projection. Projected field [symbol] " + "does not exist in schema:";
  validateFailure(sb.toString(),expectedErr,"at");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test1() throws Exception {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = limit A 100; " + "C = filter B by 2 > 1; "+ "D = load 'y' as (d1, d2); "+ "E = join C by ( $0, $1 ), D by ( d1, d2 ) using 'replicated' parallel 16; "+ "F = store E into 'output';";
  String expected="macro_mymacro_A_0 = load 'x' as (u:int, v:long, w:bytearray);\n" + "macro_mymacro_B_0 = limit macro_mymacro_A_0 100;\n" + "macro_mymacro_C_0 = filter macro_mymacro_B_0 BY (2 > 1);\n"+ "macro_mymacro_D_0 = load 'y' as (d1, d2);\n"+ "macro_mymacro_E_0 = join macro_mymacro_C_0 by ($0, $1), macro_mymacro_D_0 by (d1, d2) USING 'replicated' parallel 16;\n"+ "macro_mymacro_F_0 = store macro_mymacro_E_0 INTO 'output';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void selfRecursiveTest() throws Throwable {
  String macro1="define group_and_partition (A, group_key, reducers) returns B {\n" + "    C = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "    $B = group_and_partition(C, age, 34);"+ "};\n";
  String script=macro1 + "alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_partition (alpha, user, 23);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro can't be defined circularly.";
  validateFailure(script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test9() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { R = a; S = R.u; T = limit S 100; generate S, T, c + d/5; };" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:bag{T:(u, v)}, c:int, d:long);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 { R = a; S = R.(u); T = limit S 100;  generate S, T, c + d / 5; } ;\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test10() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { S = a; T = limit S 100; generate T; };" + "store B into 'y';";
  String expected="macro_mymacro_A_0 = load 'x' as (a:bag{T:(u, v)}, c:int, d:long);\n" + "macro_mymacro_B_0 = foreach macro_mymacro_A_0 { S = a; T = limit S 100;  generate T; } ;\n" + "store macro_mymacro_B_0 INTO 'y';\n";
  testMacro(query,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test23() throws Exception {
  String macro="a = load '1.txt' as ( u:tuple(p, q), v, w : int );" + "b = foreach a generate * as ( x, y, z ), flatten( u ) as ( r, s ), flatten( v ) as d, w + 5 as e:int;";
  String expected="macro_mymacro_a_0 = load '1.txt' as (u:(p, q), v, w:int);\n" + "macro_mymacro_b_0 = foreach macro_mymacro_a_0 generate  * AS (x, y, z), flatten(u)  AS (r, s), flatten(v)  AS d, w + 5 AS e:int;\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cyclicRecursiveTest() throws Throwable {
  String macro1="define group_and_partition (A, group_key, reducers) returns B {\n" + "    C = group $A by $group_key partition by org.apache.pig.test.utils.SimpleCustomPartitioner parallel $reducers;\n" + "    $B = foreach_count(C, $A);"+ "};\n";
  String macro2="define foreach_count(A, C) returns B {\n" + "    $B = foreach $A generate group, COUNT($C);\n" + "    D = group_and_partition($C, age, 23);"+ "};\n";
  String script=macro2 + macro1 + "alpha = load 'users' as (user, age, zip);\n"+ "gamma = group_and_partition (alpha, user, 23);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Macro can't be defined circularly.";
  validateFailure(script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void noParamTest() throws Exception {
  String macro="define group_and_count() returns B {\n" + "    D = load 'myfile.txt' using PigStorage('\t') AS (a0:int, a1:int, a2:int);\n" + "    $B = FILTER D BY ($1 == 8) OR (NOT ($0+$2 > $1));\n"+ "};\n";
  String script="delta = group_and_count();\n" + "store delta into 'byage';\n";
  String expected="macro_group_and_count_D_0 = load 'myfile.txt' USING PigStorage('\t') AS (a0:int, a1:int, a2:int);\n" + "delta = FILTER macro_group_and_count_D_0 BY (($1 == 8) OR ( NOT ($0 + $2 > $1)));\n" + "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test19() throws Exception {
  String macro="a = load '/user/pig/tests/data/singlefile/studenttab10k';" + "b = group a by $0;" + "c = foreach b {c1 = order $1 by $1; generate flatten(c1), MAX($1.$1); };"+ "store c into '/user/pig/out/jianyong.1297305352/Order_17.out';";
  String expected="macro_mymacro_a_0 = load '/user/pig/tests/data/singlefile/studenttab10k';\n" + "macro_mymacro_b_0 = group macro_mymacro_a_0 by ($0);\n" + "macro_mymacro_c_0 = foreach macro_mymacro_b_0 { c1 = order $1 BY $1;  generate flatten(c1) , MAX($1.($1)); } ;\n"+ "store macro_mymacro_c_0 INTO '/user/pig/out/jianyong.1297305352/Order_17.out';\n";
  testMacro(macro,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void negativeTest3() throws Throwable {
  String macro="define group_and_count (A,C) returns B, D {\n" + "    $B = JOIN $A BY user, $C BY user;\n" + "    $D = JOIN $A BY $0, $C BY $1 using 'skewed' parallel 5;\n"+ "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "beta = load 'links' as (user, link, view);\n" + "gamma = group_and_count (alpha,beta);\n"+ "store gamma into 'byuser';\n";
  String expectedErr="Reason: Expected number of return aliases: 2 actual number of return values: 1";
  validateFailure(macro + script,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test37() throws Exception {
  createFile("mytest.pig",groupAndCountMacro);
  String script="set default_parallel 10\n" + "import 'mytest.pig';\n" + "alpha = load 'users' as (user, age, zip);\n"+ "ls\n"+ "gamma = group_and_count (alpha, user, 23);\n"+ "fs -copyFromLocal test test2\n"+ "store gamma into 'byuser';\n";
  String expected="set default_parallel 10\n" + "alpha = load 'users' as (user, age, zip);\n" + "ls\n"+ "gamma = distinct alpha partition BY org.apache.pig.test.utils.SimpleCustomPartitioner parallel 23;\n"+ "fs -copyFromLocal test test2\n"+ "store gamma INTO 'byuser';\n";
  verify(script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sampleTest() throws Exception {
  String macro="define group_and_count (A, rate) returns B {\n" + "    $B = sample $A $rate;\n" + "};\n";
  String script="alpha = load 'users' as (user, age, zip);\n" + "gamma = group_and_count (alpha, 0.01);\n" + "delta = group_and_count (alpha, 0.002);\n"+ "store gamma into 'byuser';\n"+ "store delta into 'byage';\n";
  String expected="alpha = load 'users' as (user, age, zip);\n" + "gamma = sample alpha 0.01;\n" + "delta = sample alpha 0.002;\n"+ "store gamma INTO 'byuser';\n"+ "store delta INTO 'byage';\n";
  verify(macro + script,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void lineNumberTest2() throws Throwable {
  StringBuilder sb=new StringBuilder();
  sb.append("-- Given daily input and a particular year, analyze how\n").append("-- stock prices changed on days dividends were paid out.\n");
  sb.append("define dividend_analysis (daily, year, daily_symbol, daily_open, daily_close)\n" + "returns analyzed {\n" + "divs          = load 'NYSE_dividends' as (exchange:chararray,\n"+ "            symbol:chararray, date:chararray, dividends:float);\n"+ "divsthisyear  = filter divs by date matches '$year-.*';\n"+ "dailythisyear = filter $daily by date matches '$year-.*';\n"+ "jnd           = join divsthisyear by symbol, dailythisyear by $daily_symbol;\n"+ "$analyzed     = foreach jnd generate $daily_symbol, $daily_close - $daily_open;\n"+ "};\n");
  sb.append("define addition_macro (daily, year, daily_symbol, daily_open, daily_close) returns B {\n" + "$B = dividend_analysis($daily, '$year', '$daily_symbol', '$daily_open', '$daily_close');\n" + "};\n");
  sb.append("daily   = load 'NYSE_daily' as (exchange:chararray, symbol:chararray,\n" + "date:chararray, open:float, high:float, low:float, close:float,\n" + "volume:int, adj_close:float);\n"+ "results = addition_macro(daily, '2009', 'symbol', 'open', 'close');\n"+ "store results into 'output';\n");
  String expectedErr="at expanding macro 'addition_macro' (myscript.pig:18)\n" + "at expanding macro 'dividend_analysis' (myscript.pig:13)\n" + "<file myscript.pig, line 10, column 35> Invalid field projection. Projected field [symbol] "+ "does not exist in schema:";
  validateFailure(sb.toString(),expectedErr,"at");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapReduce </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreFunctionNoNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,false);
  storeFunction(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreFunctionWithNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,true);
  storeFunction(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefinedFunctionsWithNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,true);
  definedFunctions(data);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDefinedFunctionsNoNulls() throws Throwable {
  String[][] data=genDataSetFile1(10,false);
  definedFunctions(data);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapReduce2 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion1WithNulls() throws Exception {
  File tmpFile1=genDataSetFile(true,30);
  File tmpFile2=genDataSetFile(true,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("c = union a, b; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion2WithNulls() throws Exception {
  File tmpFile1=genDataSetFile(true,30);
  File tmpFile2=genDataSetFile(true,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("a1 = foreach a generate $0, $1; ");
  pig.registerQuery("b1 = foreach b generate $0, $1; ");
  pig.registerQuery("c = union a1, b1; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion1() throws Exception {
  File tmpFile1=genDataSetFile(false,30);
  File tmpFile2=genDataSetFile(false,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("c = union a, b; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnion2() throws Exception {
  File tmpFile1=genDataSetFile(false,30);
  File tmpFile2=genDataSetFile(false,50);
  pig.registerQuery("a = load '" + Util.generateURI(tmpFile1.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("b = load '" + Util.generateURI(tmpFile2.toString(),pig.getPigContext()) + "'; ");
  pig.registerQuery("a1 = foreach a generate $0, $1; ");
  pig.registerQuery("b1 = foreach b generate $0, $1; ");
  pig.registerQuery("c = union a1, b1; ");
  verifyUnion("c",30 + 50);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoin </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeJoinWithOrderAndSplit() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, n);\n"+ "B = LOAD '"+ INPUT_FILE+ "' as (id, name);\n"+ "C = ORDER A by $0 parallel 5;\n"+ "D = join A by id, C by id using 'merge';\n"+ "store D into '/dev/null/1';";
  Util.buildPp(pigServer,query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeJoinWithOrder() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, n);\n"+ "B = LOAD '"+ INPUT_FILE+ "' as (id, name);\n"+ "C = ORDER B by $0 parallel 5;\n"+ "D = join A by id, C by id using 'merge';\n"+ "store D into '/dev/null/1';";
  Util.buildPp(pigServer,query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQuery </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryJiraPig4480() throws Exception {
  Storage.Data data=Storage.resetData(myPig);
  data.set("inputLocation",Storage.tuple(1,Storage.bag(Storage.tuple("hello"),Storage.tuple("world"),Storage.tuple("program"))),Storage.tuple(2,Storage.bag(Storage.tuple("my"),Storage.tuple("world"))));
  myPig.setBatchOn();
  myPig.registerQuery("A = load 'inputLocation' using mock.Storage() as (a:int, b:bag{(c:chararray)});");
  myPig.registerQuery("A = foreach A generate a, flatten(b);");
  myPig.registerQuery("A1 = foreach A generate a;");
  myPig.registerQuery("A1 = distinct A1;");
  myPig.registerQuery("A2 = filter A by c == 'world';");
  myPig.registerQuery("A2 = ORDER A2 by a parallel 2;");
  myPig.registerQuery("store A1 into 'output1' using mock.Storage();");
  myPig.registerQuery("store A2 into 'output2' using mock.Storage();");
  myPig.executeBatch();
  List<Tuple> actualResults=data.get("output1");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1)","(2)"});
  Util.checkQueryOutputs(actualResults.iterator(),expectedResults);
  actualResults=data.get("output2");
  expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1, 'world')","(2, 'world')"});
  Util.checkQueryOutputs(actualResults.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryJiraPig4493() throws Exception {
  Storage.Data data=Storage.resetData(myPig);
  data.set("inputLocation",Storage.tuple("1","Dyson"),Storage.tuple("2","Miele"),Storage.tuple("3","Black & Decker"));
  myPig.setBatchOn();
  myPig.registerQuery("A = load 'inputLocation' using mock.Storage();");
  myPig.registerQuery("A = foreach A generate (int)$0 as a, (chararray)$1 as b;");
  myPig.registerQuery("A1 = FILTER A by b matches '.*[a-zA-Z] *& *[a-zA-Z].*';");
  myPig.registerQuery("A1 = FOREACH A1 generate a, REPLACE(b,'&','and')  as b;");
  myPig.registerQuery("A = UNION A1, A;");
  myPig.registerQuery("A = FOREACH A generate a, LOWER(b) as b;");
  myPig.registerQuery("A2 = GROUP A by a;");
  myPig.registerQuery("A2 = FOREACH A2 generate group, COUNT(A) as cnt;");
  myPig.registerQuery("store A2 into 'output1' using mock.Storage();");
  myPig.registerQuery("A = FILTER A BY b is not null and b != '';");
  myPig.registerQuery("store A into 'output2' using mock.Storage();");
  myPig.executeBatch();
  List<Tuple> actualResults=data.get("output1");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1, 1L)","(2, 1L)","(3, 2L)"});
  Util.checkQueryOutputsAfterSort(actualResults.iterator(),expectedResults);
  actualResults=data.get("output2");
  expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1, 'dyson')","(2, 'miele')","(3, 'black & decker')","(3, 'black and decker')"});
  Util.checkQueryOutputsAfterSort(actualResults.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryJiraPig4170() throws Exception {
  Storage.Data data=Storage.resetData(myPig);
  data.set("inputLocation",Storage.tuple(1,"hello"),Storage.tuple(2,"world"));
  myPig.setBatchOn();
  myPig.registerQuery("A = load 'inputLocation' using mock.Storage() as (a:int, b:chararray);");
  myPig.registerQuery("A1 = group A by a;");
  myPig.registerQuery("A2 = group A by b;");
  myPig.registerQuery("store A1 into 'output1' using mock.Storage();");
  myPig.registerQuery("store A2 into 'output2' using mock.Storage();");
  myPig.executeBatch();
  myPig.registerQuery("A = load 'output1' using mock.Storage() as (a:int, c:bag{(i:int, s:chararray)});");
  Iterator<Tuple> iter=myPig.openIterator("A");
  iter.next().toString().equals("(1,{(1,hello)})");
  iter.next().toString().equals("(2,{(2,world)})");
  myPig.registerQuery("A = load 'output2' using mock.Storage() as (b:chararray, c:bag{(i:int, s:chararray)});");
  iter=myPig.openIterator("A");
  iter.next().toString().equals("(hello,{(1,hello)})");
  iter.next().toString().equals("(world,{(2,world)})");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryBasic </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithTwoStores2Execs() throws Exception {
  System.out.println("===== multi-query with 2 stores execs =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid > 5;");
  myPig.executeBatch();
  myPig.registerQuery("store b into 'output1';");
  myPig.executeBatch();
  myPig.registerQuery("c = group b by gid;");
  myPig.registerQuery("store c into 'output2';");
  myPig.executeBatch();
  myPig.discardBatch();
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithThreeStores2() throws Exception {
  System.out.println("===== multi-query with 3 stores (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid > 5;");
  myPig.registerQuery("store b into 'output1';");
  myPig.registerQuery("c = filter b by uid > 10;");
  myPig.registerQuery("store c into 'output2';");
  myPig.registerQuery("d = filter c by uid > 15;");
  myPig.registerQuery("store d into 'output3';");
  myPig.executeBatch();
  myPig.discardBatch();
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithTwoLoads2() throws Exception {
  System.out.println("===== multi-query with two loads (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = load 'passwd2' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("c = filter a by uid > 5;");
  myPig.registerQuery("d = filter b by uid > 10;");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("store d into 'output2';");
  myPig.registerQuery("e = cogroup c by uid, d by uid;");
  myPig.registerQuery("store e into 'output3';");
  myPig.executeBatch();
  myPig.discardBatch();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryLocal </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithThreeStores2() throws Exception {
  System.out.println("===== test multi-query with 3 stores (2) =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("c = filter b by uid > 10;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.registerQuery("d = filter c by uid > 15;");
    myPig.registerQuery("store d into '" + TMP_DIR + "/Pig-TestMultiQueryLocal3';");
    myPig.executeBatch();
    myPig.discardBatch();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-20 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithIllustrate() throws Exception {
  Assume.assumeTrue("illustrate does not work in tez (PIG-3993)",!Util.getLocalTestMode().toString().startsWith("TEZ"));
  System.out.println("===== test multi-query with illustrate =====");
  try {
    String script="a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "illustrate b;"+ "store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    myPig.getPigContext().getProperties().setProperty("pig.usenewlogicalplan","true");
    parser.parseStopOnError();
  }
  finally {
    deleteOutputFiles();
    myPig.getPigContext().getProperties().setProperty("pig.usenewlogicalplan","false");
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithTwoStores2Execs() throws Exception {
  System.out.println("===== test multi-query with 2 stores (2) =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.executeBatch();
    myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.executeBatch();
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.executeBatch();
    myPig.discardBatch();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyExecute() throws Exception {
  System.out.println("=== test empty execute ===");
  myPig.setBatchOn();
  myPig.executeBatch();
  myPig.executeBatch();
  myPig.discardBatch();
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithTwoLoads2() throws Exception {
  System.out.println("===== test multi-query with two loads (2) =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = load 'test/org/apache/pig/test/data/passwd2' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("c = filter a by uid > 5;");
    myPig.registerQuery("d = filter b by uid > 10;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("store d into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.registerQuery("e = cogroup c by uid, d by uid;");
    myPig.registerQuery("store e into '" + TMP_DIR + "/Pig-TestMultiQueryLocal3';");
    myPig.executeBatch();
    myPig.discardBatch();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithNoStore2() throws Exception {
  System.out.println("===== test multi-query with no store (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid > 5;");
  myPig.registerQuery("group b by gid;");
  myPig.executeBatch();
  myPig.discardBatch();
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithExplain() throws Exception {
  System.out.println("===== test multi-query with explain =====");
  try {
    String script="a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "explain b;"+ "store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithNoStore() throws Exception {
  System.out.println("===== test multi-query with no store =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
  myPig.registerQuery("b = filter a by uid > 5;");
  myPig.registerQuery("group b by gid;");
  LogicalPlan lp=checkLogicalPlan(0,0,0);
  checkPhysicalPlan(lp,0,0,0);
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithTwoStores2() throws Exception {
  System.out.println("===== test multi-query with 2 stores (2) =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid > 5;");
    myPig.registerQuery("store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';");
    myPig.registerQuery("c = group b by gid;");
    myPig.registerQuery("store c into '" + TMP_DIR + "/Pig-TestMultiQueryLocal2';");
    myPig.executeBatch();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithDescribe() throws Exception {
  System.out.println("===== test multi-query with describe =====");
  try {
    String script="a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "describe b;"+ "store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithDump() throws Exception {
  System.out.println("===== test multi-query with dump =====");
  try {
    String script="a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);" + "b = filter a by uid > 5;"+ "dump b;"+ "store b into '" + TMP_DIR + "/Pig-TestMultiQueryLocal1';\n";
    GruntParser parser=new GruntParser(new StringReader(script),myPig);
    parser.setInteractive(false);
    parser.parseStopOnError();
  }
  finally {
    deleteOutputFiles();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNestedForeach </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachInnerFilter() throws Exception {
  String[] input={"1\t2","2\t7","1\t3"};
  Util.createInputFile(cluster,"table_nf_filter",input);
  pig.registerQuery("a = load 'table_nf_filter' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { " + " c1 = filter a by a1 >= 3; " + " c2 = foreach c1 generate a1; "+ " generate c2; "+ " }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(3)})","({(7)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachProj() throws Exception {
  String[] input={"1\t2","2\t7","1\t3"};
  Util.createInputFile(cluster,"table_nf_proj",input);
  pig.registerQuery("a = load 'table_nf_proj' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { c1 = foreach a generate a1; generate c1; }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(2),(3)})","({(7)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachUDF() throws Exception {
  String[] input={"1\thello","2\tpig","1\tworld"};
  Util.createInputFile(cluster,"table_nf_udf",input);
  pig.registerQuery("a = load 'table_nf_udf' as (a0:int, a1:chararray);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { c1 = foreach a generate UPPER(a1); generate c1; }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(HELLO),(WORLD)})","({(PIG)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachExpression() throws Exception {
  String[] input={"1\t2","2\t7","1\t3"};
  Util.createInputFile(cluster,"table_nf_expr",input);
  pig.registerQuery("a = load 'table_nf_expr' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { c1 = foreach a generate 2 * a1; generate c1; }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(4),(6)})","({(14)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeach() throws Exception {
  String[] input={"1\t2\t3","2\t5\t2"};
  Util.createInputFile(cluster,"table_nf_project",input);
  pig.registerQuery("A = load 'table_nf_project' as (a,b,c:chararray);");
  pig.registerQuery("B = GROUP A BY a;");
  pig.registerQuery("C = foreach B {tmp = A.a;generate A, tmp; };");
  pig.registerQuery("D = foreach C generate A.(a,b) as v;");
  Iterator<Tuple> iter=pig.openIterator("D");
  String[] expected=new String[]{"({(1,2)})","({(2,5)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("D")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachFlatten() throws Exception {
  String[] input={"1\thello world pig","2\thadoop world","1\thello pig"};
  Util.createInputFile(cluster,"table_nf_flatten",input);
  pig.registerQuery("a = load 'table_nf_flatten' as (a0:int, a1:chararray);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { c1 = foreach a generate FLATTEN(TOKENIZE(a1)); generate c1; }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(hello),(world),(pig),(hello),(pig)})","({(hadoop),(world)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedForeachInnerOrder() throws Exception {
  String[] input={"1\t3","2\t7","1\t2"};
  Util.createInputFile(cluster,"table_nf_order",input);
  pig.registerQuery("a = load 'table_nf_order' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  pig.registerQuery("c = foreach b { " + " c1 = order a by a1; " + " c2 = foreach c1 generate a1; "+ " generate c2; "+ " }\n");
  Iterator<Tuple> iter=pig.openIterator("c");
  String[] expected=new String[]{"({(2),(3)})","({(7)})"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pig.dumpSchema("c")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPartitionFilterPushDown </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns -
 * This testcase has two partition col conditions  with OR +  non parition
 * col conditions
 */
@Test public void testMixed6() throws Exception {
  String q=query + "b = filter a by " + "dstid == 30 and (srcid == 10 or mrkt == 'us') and name == 'foo';"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"((dstid == 30) and ((srcid == 10) or (mrkt == 'us')))","(name == 'foo')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter only contains condition on partition cols
 * @throws Exception
 */
@Test public void testOnlyPartFilter1() throws Exception {
  String q=query + "b = filter a by srcid > 20 and mrkt == 'us';" + "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"((srcid > 20) and (mrkt == 'us'))",null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter does not contain any condition on partition cols
 * @throws Exception
 */
@Test public void testNoPartFilter() throws Exception {
  String q=query + "b = filter a by age == 20 and name == 'foo';" + "store b into 'out';";
  test(q,Arrays.asList("srcid"),null,"((age == 20) and (name == 'foo'))");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns -
 * This testcase has two partition col conditions  with OR +  non parition
 * col conditions
 */
@Test public void testMixed5() throws Exception {
  String q=query + "b = filter a by " + "(srcid == 10 or mrkt == 'us') and name == 'foo' and "+ "dstid == 30;"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"(((srcid == 10) or (mrkt == 'us')) and (dstid == 30))","(name == 'foo')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter only contains condition on partition cols
 * @throws Exception
 */
@Test public void testOnlyPartFilter2() throws Exception {
  String q=query + "b = filter a by mrkt == 'us';" + "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"(mrkt == 'us')",null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAndORConditionPartitionKeyCol() throws Exception {
  String q="b = filter a by (srcid == 10 and dstid == 5) " + "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7);" + "store b into 'out';";
  test(query + q,Arrays.asList("srcid","dstid"),"((((srcid == 10) and (dstid == 5)) " + "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))",null);
  q="b = filter a by ((srcid == 10 and dstid == 5) " + "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7)) and mrkt == 'US';" + "store b into 'out';";
  test(query + q,Arrays.asList("srcid","dstid"),"((((srcid == 10) and (dstid == 5)) " + "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))","(mrkt == 'US')");
  testFull(query2 + q,"((((srcid == 10) and (dstid == 5)) " + "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))","(mrkt == 'US')",false);
  q=query + "b = filter a by ((srcid == 10 and dstid == 5) " + "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7)) and srcid is null;"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid"),"((((srcid == 10) and (dstid == 5)) " + "or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))","(srcid is null)",true);
  q=query + "b = filter a by (srcid is null and dstid == 5) " + "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7);"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid"),"(((dstid == 5) or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))","(((srcid is null) or ((srcid == 11) and (dstid == 6))) or ((srcid == 12) and (dstid == 7)))",true);
  q=query + "b = filter a by (mrkt == 'US' or mrkt == 'UK') and (srcid == 11 or srcid == 10);" + "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"(((mrkt == 'US') or (mrkt == 'UK')) and ((srcid == 11) or (srcid == 10)))",null);
  test(q,Arrays.asList("srcid"),"((srcid == 11) or (srcid == 10))","((mrkt == 'US') or (mrkt == 'UK'))");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter only contains condition on partition cols
 * @throws Exception
 */
@Test public void testOnlyPartFilter3() throws Exception {
  String q=query + "b = filter a by srcid == 20 or mrkt == 'us';" + "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"((srcid == 20) or (mrkt == 'us'))",null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilteredPlanWithLogToPhyTranslator() throws Exception {
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray', 'srcid') as (f1, f2);"+ "b = filter a by (f1 < 5 or (f1 == 10 and f2 == 'UK'));"+ "store b into 'out';";
  testFull(q,"((srcid < 5) or (srcid == 10))","((f1 < 5) or (f2 == 'UK'))",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that pig sends correct partition column names in setPartitionFilter
 * when the user has a schema in the load statement which renames partition
 * columns
 * @throws Exception
 */
@Test public void testColNameMapping1() throws Exception {
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray, dstid:int, name:chararray, age:int', "+ "'srcid,mrkt') as (f1, f2, f3, f4, f5);"+ "b = filter a by "+ "(f5 >= 20 and f2 == 'us') and (f1 == 10 and f3 == 15);"+ "store b into 'out';";
  testFull(q,"((mrkt == 'us') and (srcid == 10))","((f5 >= 20) and (f3 == 15))",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrWithNonPartitionCondition() throws Exception {
  String q=query + "b = filter a by " + "(srcid == 1 and mrkt == '2' and dstid == 3) "+ "or (srcid == 4 and mrkt == '5' and dstid == 6) "+ "or (srcid == 7 and mrkt == '8' and dstid == 9) "+ "or (name is null);"+ "store b into 'out';";
  negativeTest(q,Arrays.asList("srcid","mrkt","dstid"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that pig sends correct partition column names in setPartitionFilter
 * when the user has a schema in the load statement which renames partition
 * columns - in this test case there is no condition on partition columns
 * - so setPartitionFilter() should not be called and the filter condition
 * should remain as is.
 * @throws Exception
 */
@Test public void testColNameMapping2() throws Exception {
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray, dstid:int, name:chararray, age:int', "+ "'srcid') as (f1, f2, f3, f4, f5);"+ "b = filter a by "+ "f5 >= 20 and f2 == 'us' and f3 == 15;"+ "store b into 'out';";
  testFull(q,null,"(((f5 >= 20) and (f2 == 'us')) and (f3 == 15))",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that pig sends correct partition column names in setPartitionFilter
 * when the user has a schema in the load statement which renames partition
 * columns - in this test case the filter only has conditions on partition
 * columns
 * @throws Exception
 */
@Test public void testColNameMapping3() throws Exception {
  String query="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray, dstid:int, name:chararray, age:int', "+ "'srcid,mrkt,dstid,age') as (f1, f2, f3, f4, f5);"+ "b = filter a by "+ "(f5 >= 20 or f2 == 'us') and (f1 == 10 and f3 == 15);"+ "store b into 'out';";
  testFull(query,"(((age >= 20) or (mrkt == 'us')) and ((srcid == 10) and " + "(dstid == 15)))",null,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test PIG-3395 Large filter expression makes Pig hang
 * @throws Exception
 */
@Test public void testLargeAndOrCondition() throws Exception {
  String q=query + "b = filter a by " + "(srcid == 1 and mrkt == '2' and dstid == 3) "+ "or (srcid == 4 and mrkt == '5' and dstid == 6) "+ "or (srcid == 7 and mrkt == '8' and dstid == 9) "+ "or (srcid == 10 and mrkt == '11' and dstid == 12) "+ "or (srcid == 13 and mrkt == '14' and dstid == 15) "+ "or (srcid == 16 and mrkt == '17' and dstid == 18) "+ "or (srcid == 19 and mrkt == '20' and dstid == 21) "+ "or (srcid == 22 and mrkt == '23' and dstid == 24) "+ "or (srcid == 25 and mrkt == '26' and dstid == 27) "+ "or (srcid == 28 and mrkt == '29' and dstid == 30) "+ "or (srcid == 31 and mrkt == '32' and dstid == 33) "+ "or (srcid == 34 and mrkt == '35' and dstid == 36) "+ "or (srcid == 37 and mrkt == '38' and dstid == 39) "+ "or (srcid == 40 and mrkt == '41' and dstid == 42) "+ "or (srcid == 43 and mrkt == '44' and dstid == 45) "+ "or (srcid == 46 and mrkt == '47' and dstid == 48) "+ "or (srcid == 49 and mrkt == '50' and dstid == 51) "+ "or (srcid == 52 and mrkt == '53' and dstid == 54) "+ "or (srcid == 55 and mrkt == '56' and dstid == 57) "+ "or (srcid == 58 and mrkt == '59' and dstid == 60) "+ "or (srcid == 61 and mrkt == '62' and dstid == 63) "+ "or (srcid == 64 and mrkt == '65' and dstid == 66) "+ "or (srcid == 67 and mrkt == '68' and dstid == 69);"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt","dstid"),"(((((((((((((((((((((((((srcid == 1) and (mrkt == '2')) and (dstid == 3)) " + "or (((srcid == 4) and (mrkt == '5')) and (dstid == 6))) " + "or (((srcid == 7) and (mrkt == '8')) and (dstid == 9))) "+ "or (((srcid == 10) and (mrkt == '11')) and (dstid == 12))) "+ "or (((srcid == 13) and (mrkt == '14')) and (dstid == 15))) "+ "or (((srcid == 16) and (mrkt == '17')) and (dstid == 18))) "+ "or (((srcid == 19) and (mrkt == '20')) and (dstid == 21))) "+ "or (((srcid == 22) and (mrkt == '23')) and (dstid == 24))) "+ "or (((srcid == 25) and (mrkt == '26')) and (dstid == 27))) "+ "or (((srcid == 28) and (mrkt == '29')) and (dstid == 30))) "+ "or (((srcid == 31) and (mrkt == '32')) and (dstid == 33))) "+ "or (((srcid == 34) and (mrkt == '35')) and (dstid == 36))) "+ "or (((srcid == 37) and (mrkt == '38')) and (dstid == 39))) "+ "or (((srcid == 40) and (mrkt == '41')) and (dstid == 42))) "+ "or (((srcid == 43) and (mrkt == '44')) and (dstid == 45))) "+ "or (((srcid == 46) and (mrkt == '47')) and (dstid == 48))) "+ "or (((srcid == 49) and (mrkt == '50')) and (dstid == 51))) "+ "or (((srcid == 52) and (mrkt == '53')) and (dstid == 54))) "+ "or (((srcid == 55) and (mrkt == '56')) and (dstid == 57))) "+ "or (((srcid == 58) and (mrkt == '59')) and (dstid == 60))) "+ "or (((srcid == 61) and (mrkt == '62')) and (dstid == 63))) "+ "or (((srcid == 64) and (mrkt == '65')) and (dstid == 66))) "+ "or (((srcid == 67) and (mrkt == '68')) and (dstid == 69)))",null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns
 */
@Test public void testMixed2() throws Exception {
  String q=query + "b = filter a by " + "(age >= 20 and  mrkt == 'us') and (srcid == 10 and "+ "dstid == 15);"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"((mrkt == 'us') and ((srcid == 10) and (dstid == 15)))","(age >= 20)");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns
 */
@Test public void testMixed1() throws Exception {
  String q=query + "b = filter a by " + "(age < 20 and  mrkt == 'us') and (srcid == 10 and "+ "name == 'foo');"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"((mrkt == 'us') and (srcid == 10))","((age < 20) and (name == 'foo'))");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns. This testcase also tests arithmetic
 * in partition column conditions
 */
@Test public void testMixedArith() throws Exception {
  String q=query + "b = filter a by " + "mrkt == 'us' and srcid * 10 == 150 + 20 and age != 15;"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"((mrkt == 'us') and ((srcid * 10) == (150 + 20)))","(age != 15)");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that pig sends correct partition column names in setPartitionFilter
 * when the user has a schema in the load statement which renames partition
 * columns - in this test case the schema in load statement is a prefix
 * (with columns renamed) of the schema returned by{@link LoadMetadata#getSchema(String,Configuration)}
 * @throws Exception
 */
@Test public void testColNameMapping4() throws Exception {
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('srcid:int, mrkt:chararray, dstid:int, name:chararray, age:int', "+ "'srcid,mrkt') as (f1:int, f2:chararray, f3:int, name:chararray, age:int);"+ "b = filter a by "+ "(age >= 20 and f2 == 'us') and (f1 == 10 and f3 == 15);"+ "store b into 'out';";
  testFull(q,"((mrkt == 'us') and (srcid == 10))","((age >= 20) and (f3 == 15))",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where there is a single expression on partition columns in
 * the filter expression along with an expression on non partition column
 * @throws Exception
 */
@Test public void testSimpleMixed() throws Exception {
  String q=query + "b = filter a by srcid == 10 and name == 'foo';" + "store b into 'out';";
  test(q,Arrays.asList("srcid"),"(srcid == 10)","(name == 'foo')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns - this testcase also has a condition
 * based on comparison of two partition columns
 */
@Test public void testMixed4() throws Exception {
  String q=query + "b = filter a by " + "age >= 20 and  mrkt == 'us' and name == 'foo' and "+ "srcid == dstid;"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"((mrkt == 'us') and (srcid == dstid))","((age >= 20) and (name == 'foo'))");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test PIG-2778 Add matches operator to predicate pushdown
 * @throws Exception
 */
@Test public void testMatchOpPushDown() throws Exception {
  String q=query + "b = filter a by name matches 'foo*';" + "store b into 'out';";
  test(q,Arrays.asList("name"),"(name matches 'foo*')",null);
  q=query + "b = filter a by name matches 'foo*';" + "store b into 'out';";
  test(q,Arrays.asList("srcid"),null,"(name matches 'foo*')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where there is a single expression on partition columns in the
 * filter expression along with an expression on non partition column of
 * type map
 * @throws Exception
 */
@Test public void testMixedNonPartitionTypeMap() throws Exception {
  String q=query + "b = filter a by srcid == 10 and browser#'type' == 'IE';" + "store b into 'out';";
  test(q,Arrays.asList("srcid"),"(srcid == 10)","(browser#'type' == IE)",true);
  q=query + "b = filter a by srcid == 10 and browser#'type' == 'IE' and " + "browser#'version'#'major' == '8.0';"+ "store b into 'out';";
  test(q,Arrays.asList("srcid"),"(srcid == 10)","((browser#'type' == IE) and " + "(browser#'version'#'major' == 8.0))",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where filter has both conditions on partition cols and non
 * partition cols and the filter condition will be split to extract the
 * conditions on partition columns
 */
@Test public void testMixed3() throws Exception {
  String q=query + "b = filter a by " + "age >= 20 and  mrkt == 'us' and srcid == 10;"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","dstid","mrkt"),"((mrkt == 'us') and (srcid == 10))","(age >= 20)");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test case where there is a single expression on partition columns in the
 * filter expression along with an expression on non partition column of
 * type tuple
 * @throws Exception
 */
@Test public void testMixedNonPartitionTypeTuple() throws Exception {
  String q=query + "b = filter a by srcid == 10 and location.country == 'US';" + "store b into 'out';";
  test(q,Arrays.asList("srcid"),"(srcid == 10)","(location.$0 == US)",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAndORConditionMixedCol() throws Exception {
  String q="b = filter a by (srcid == 10 and dstid == 5) " + "or (srcid == 11 and dstid == 6) or (srcid == 12 and dstid == 7) " + "or (srcid == 13 and dstid == 8);"+ "store b into 'out';";
  test(query + q,Arrays.asList("srcid"),"((((srcid == 10) or (srcid == 11)) or (srcid == 12)) or (srcid == 13))","(((((srcid == 10) or (srcid == 11)) or (srcid == 12)) or (dstid == 8)) " + "and ((((((srcid == 10) or (srcid == 11)) or (dstid == 7)) and " + "(((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) "+ "and ((dstid == 5) or (dstid == 6)))) or "+ "(srcid == 12)) and ((((srcid == 10) or (dstid == 6)) "+ "and (((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (dstid == 7)))) or (srcid == 13)) "+ "and (((((srcid == 10) or (srcid == 11)) or (dstid == 7)) and (((((srcid == 10) or (dstid == 6)) "+ "and (((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (srcid == 12)) "+ "and ((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (dstid == 7)))) or (dstid == 8))))");
  q=query + "b = filter a by ((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) " + "or (srcid == 12 and dstid == 7)) and mrkt == 'US';"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"((((srcid == 10) or (srcid == 11)) or (srcid == 12)) and (mrkt == 'US'))","((((srcid == 10) or (srcid == 11)) or (dstid == 7)) and (((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) " + "and ((dstid == 5) or (dstid == 6)))) or (srcid == 12)) and ((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) " + "and ((dstid == 5) or (dstid == 6)))) or (dstid == 7))))");
  q=query + "b = filter a by (mrkt == 'US' or mrkt == 'UK') and " + "((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) "+ "or (srcid == 12 and dstid == 7));"+ "store b into 'out';";
  test(q,Arrays.asList("srcid","mrkt"),"(((mrkt == 'US') or (mrkt == 'UK')) and (((srcid == 10) or (srcid == 11)) or (srcid == 12)))","((((srcid == 10) or (srcid == 11)) or (dstid == 7)) and (((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (srcid == 12)) and ((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (dstid == 7))))");
  q=query + "b = filter a by ((srcid == 10 and dstid == 5) or (srcid == 11 and dstid == 6) " + "or (srcid == 12 and dstid == 7)) and mrkt == 'US';"+ "store b into 'out';";
  test(q,Arrays.asList("srcid"),"(((srcid == 10) or (srcid == 11)) or (srcid == 12))","(((((srcid == 10) or (srcid == 11)) or (dstid == 7)) " + "and (((((srcid == 10) or (dstid == 6)) and " + "(((dstid == 5) or (srcid == 11)) and ((dstid == 5) or (dstid == 6)))) or (srcid == 12)) "+ "and ((((srcid == 10) or (dstid == 6)) and (((dstid == 5) or (srcid == 11)) "+ "and ((dstid == 5) or (dstid == 6)))) or (dstid == 7)))) and (mrkt == 'US'))");
  q=query + "b = filter a by (mrkt == 'US' or mrkt == 'UK') and " + "(srcid == 11 or srcid == 10) and (dstid == 5 or dstid == 6);"+ "store b into 'out';";
  test(q,Arrays.asList("srcid"),"((srcid == 11) or (srcid == 10))","(((mrkt == 'US') or (mrkt == 'UK')) and ((dstid == 5) or (dstid == 6)))");
  test(q,Arrays.asList("mrkt"),"((mrkt == 'US') or (mrkt == 'UK'))","(((srcid == 11) or (srcid == 10)) and ((dstid == 5) or (dstid == 6)))");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPushDownForeachFlatten </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testForeachJoinWithUserDefinedSchemaAndPruning() throws Exception {
  String query="a = load '1.txt' as (a0:int, a1, a2:bag{});" + "b = load '2.txt' as (b0:int, b1);" + "c = foreach a generate a0, flatten(a2) as (q1, q2);"+ "d = join c by a0, b by b0;"+ "e = foreach d generate a0, q1, q2;"+ "f = foreach e generate a0, (int)q1, (int)q2;"+ "store f into 'output';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlanWithPruning(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNotEqualTo </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleAndNullValues() throws Exception {
  checkNullValues(DataType.DOUBLE,new Double(1.0));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFloatAndNullValues() throws Exception {
  checkNullValues(DataType.FLOAT,new Float(1.0f));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStringAndNullValues() throws Exception {
  checkNullValues(DataType.CHARARRAY,new String("b"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBooleanAndNullValues() throws Exception {
  checkNullValues(DataType.BOOLEAN,Boolean.TRUE);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIntegerAndNullValues() throws Exception {
  checkNullValues(DataType.INTEGER,new Integer(1));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongAndNullValues() throws Exception {
  checkNullValues(DataType.LONG,new Long(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDateTimeAndNullValues() throws Exception {
  checkNullValues(DataType.DATETIME,new DateTime(1L));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDataByteArrayAndNullValues() throws Exception {
  checkNullValues(DataType.BYTEARRAY,new DataByteArray("b"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNullConstant </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testMapNullKeyFailure() throws IOException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate [null#'2'];");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNumberOfReducers </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * For 550B file and 300B per reducer, it estimates 2 #reducers.
 * @throws Exception
 */
@Test public void testOrderByEstimate() throws Exception {
  verifyOrderBy(300,-1,-1,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify parallel 1, so it should use
 * 1 reducer.
 * @throws Exception
 */
@Test public void testOrderByEstimate2Parallel1() throws Exception {
  verifyOrderBy(300,-1,1,1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify parallel 4, so it should use
 * 4 reducer.
 * TODO we need verify that the sample job generates 4 partitions instead of
 * 2.
 * @throws Exception
 */
@Test public void testSkewJoinEstimate2Parallel4() throws Exception {
  verifySkewJoin(600,-1,4,4);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify parallel 4, so it should use
 * 4 reducer.
 * TODO we need verify that the sample job generates 4 partitions instead of
 * 2.
 * @throws Exception
 */
@Test public void testOrderByEstimate2Parallel4() throws Exception {
  verifyOrderBy(300,-1,4,4);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 6 reducers but we specify default parallel 2, so it
 * should use 2 reducer. Also, the sampler should generate 2 partitions,
 * instead of 6, otherwise the next job will fail.
 * @throws Exception
 */
@Test public void testSkewJoinEstimate6Default2() throws Exception {
  verifySkewJoin(200,2,-1,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify parallel 1, so it should use
 * 1 reducer.
 * @throws Exception
 */
@Test public void testSkewJoinEstimate2Parallel1() throws Exception {
  verifySkewJoin(600,-1,1,1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * For two 550B files and 600B per reducer, it estimates 2 #reducers.
 * @throws Exception
 */
@Test public void testSkewJoinEstimate() throws Exception {
  verifySkewJoin(600,-1,-1,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 6 reducers but we specify default parallel 2, so it
 * should use 2 reducer. Also, the sampler should generate 2 partitions,
 * instead of 6, otherwise the next job will fail.
 * @throws Exception
 */
@Test public void testOrderByEstimate6Default2() throws Exception {
  verifyOrderBy(100,2,-1,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify default parallel 1, so it
 * should use 1 reducer.
 * @throws Exception
 */
@Test public void testOrderByEstimate2Default1() throws Exception {
  verifyOrderBy(300,1,-1,1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Pig will estimate 2 reducers but we specify default parallel 1, so it
 * should use 1 reducer.
 * @throws Exception
 */
@Test public void testSkewJoinEstimate2Default1() throws Exception {
  verifySkewJoin(600,1,-1,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOptimizeLimit </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit9Optimizer() throws Exception {
  String query="A = load 'myfile';" + "B = order A by $0;" + "C = limit B 10;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan9.dot");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit7Optimizer() throws Exception {
  String query="A = load 'myfile1';" + "B = foreach A generate flatten($0);" + "C = limit B 100;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan7.dot");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit11Optimizer() throws Exception {
  String query="B = foreach (limit (order (load 'myfile' AS (a0, a1, a2)) by $1) 10) generate $0;";
  LogicalPlan plan=Util.buildLp(pigServer,query);
  optimizePlan(plan);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit3Optimizer() throws Exception {
  String query="A = load 'myfile1';" + "B = load 'myfile2';" + "C = cross A, B;"+ "D = limit C 100;"+ "store D into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan3.dot");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit4Optimizer() throws Exception {
  String query="A = load 'myfile1';" + "B = group A by $0;" + "C = foreach B generate flatten(A);"+ "D = limit C 100;"+ "store D into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan4.dot");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit8Optimizer() throws Exception {
  String query="A = load 'myfile';" + "B = order A by $0;" + "C = limit B 10;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan8.dot");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOPLimit1Optimizer() throws Exception {
  String query="A = load 'myfile';" + "B = order A by $0;" + "C = limit B 100;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  ;
  optimizePlan(newLogicalPlan);
  compareWithGoldenFile(newLogicalPlan,FILE_BASE_LOCATION + "new-optlimitplan1.dot");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOrderBy </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col21_NoUsing() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2, $1; generate flatten(D); };",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col2_Using() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $2 USING org.apache.pig.test.OrdAsc;",true);
  verify("myid = order (load 'file:" + tmpFile + "') BY $2 USING org.apache.pig.test.OrdDesc;",false);
  verify("myid = order (load 'file:" + tmpFile + "') BY $2 USING org.apache.pig.test.OrdDescNumeric;",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col21_Using() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $2, $1 USING org.apache.pig.test.OrdAsc;",true);
  verify("myid = order (load 'file:" + tmpFile + "') BY $2, $1 USING org.apache.pig.test.OrdDesc;",false);
  verify("myid = order (load 'file:" + tmpFile + "') BY $2, $1 USING org.apache.pig.test.OrdDescNumeric;",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col1_NoUsing() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $1;",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col1_Using() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $1 USING "+ "org.apache.pig.test.OrdAsc; generate flatten(D); };",false);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $1 USING "+ "org.apache.pig.test.OrdDesc; generate flatten(D); };",true);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $1 USING "+ "org.apache.pig.test.OrdDescNumeric; generate flatten(D); };",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Star_NoUsing() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY *;",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col2_Using() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2 USING "+ "org.apache.pig.test.OrdAsc; generate flatten(D); };",true);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2 USING "+ "org.apache.pig.test.OrdDesc; generate flatten(D); };",false);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2 USING "+ "org.apache.pig.test.OrdDescNumeric; generate flatten(D); };",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col2_NoUsing() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $2;",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col1_Using() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $1 USING org.apache.pig.test.OrdAsc;",false);
  verify("myid = order (load 'file:" + tmpFile + "') BY $1 USING org.apache.pig.test.OrdDesc;",true);
  verify("myid = order (load 'file:" + tmpFile + "') BY $1 USING org.apache.pig.test.OrdDescNumeric;",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col21_Using() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2, $1 USING "+ "org.apache.pig.test.OrdAsc; generate flatten(D); };",true);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2, $1 USING "+ "org.apache.pig.test.OrdDesc; generate flatten(D); };",false);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2, $1 USING "+ "org.apache.pig.test.OrdDescNumeric; generate flatten(D); };",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col2_NoUsing() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $2; generate flatten(D); };",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col21_NoUsing() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY $2, $1;",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Star_Using() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY * USING "+ "org.apache.pig.test.OrdAsc; generate flatten(D); };",false);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY * USING "+ "org.apache.pig.test.OrdDesc; generate flatten(D); };",true);
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY * USING "+ "org.apache.pig.test.OrdDescNumeric; generate flatten(D); };",true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Star_NoUsing() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY *; generate flatten(D); };",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedOrderBy_Col1_NoUsing() throws Exception {
  verify("myid = foreach (group (load 'file:" + tmpFile + "') by $0) { D = ORDER $1 BY $1; generate flatten(D); };",false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Star_Using() throws Exception {
  verify("myid = order (load 'file:" + tmpFile + "') BY * USING org.apache.pig.test.OrdAsc;",false);
  verify("myid = order (load 'file:" + tmpFile + "') BY * USING org.apache.pig.test.OrdDesc;",true);
  verify("myid = order (load 'file:" + tmpFile + "') BY * USING org.apache.pig.test.OrdDescNumeric;",true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOrderBy2 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col0_DESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo1' using mock.Storage()) BY $0 DESC ;",new int[]{0},new boolean[]{true});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col1Col0_DESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo3' using mock.Storage()) BY $1 DESC, $0 DESC ;",new int[]{1,0},new boolean[]{true,true});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col0Col1_DESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo2' using mock.Storage()) BY $0 DESC, $1 DESC ;",new int[]{0,1},new boolean[]{true,true});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col0Col1_NoUsing() throws Exception {
  runTest("myid = order (load 'foo2' using mock.Storage()) BY $0, $1 ;",new int[]{0,1},new boolean[]{false,false});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col1Col0_NoUsing() throws Exception {
  runTest("myid = order (load 'foo3' using mock.Storage()) BY $1, $0 ;",new int[]{1,0},new boolean[]{false,false});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col1_ASC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo1' using mock.Storage()) BY $1 ASC ;",new int[]{1},new boolean[]{false});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Star_NoUsing() throws Exception {
  runTest("myid = order (load 'foo3' using mock.Storage()) BY * ; ",new int[]{0,1},new boolean[]{false,false});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Col0_ASC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo1' using mock.Storage()) BY $0;",new int[]{0},new boolean[]{false});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col1_DESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo1' using mock.Storage()) BY $1 DESC ;",new int[]{1},new boolean[]{true});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLevelOrderBy_Star_DESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo3' using mock.Storage()) BY * DESC ; ",new int[]{0,1},new boolean[]{true,true});
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTopLeveleeOrderBy_Col1Col0_ASCDESC_NoUsing() throws Exception {
  runTest("myid = order (load 'foo3' using mock.Storage()) BY $1 ASC, $0 DESC ;",new int[]{1,0},new boolean[]{false,true});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestOrderBy3 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexesAsc() throws Exception {
  testIndexes(true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValuesDESC() throws Exception {
  testNames(false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValuesASC() throws Exception {
  testNames(true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIndexesDesc() throws Exception {
  testIndexes(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPODistinct </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictWithIntAndNullValues() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt(MAX_VALUE));
    input.add(t);
    t=tf.newTuple();
    t.append(null);
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictArityWithNullValues() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    if (r.nextInt(MAX_VALUE) % 3 == 0) {
      t.append(null);
    }
    t.append(r.nextInt(MAX_VALUE));
    t.append(r.nextInt(MAX_VALUE));
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictWithNullValues() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    t.append(null);
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictWithIntNullValues() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt(MAX_VALUE));
    t.append(null);
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictWithNullIntValues() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    t.append(null);
    t.append(r.nextInt(MAX_VALUE));
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPODistictWithInt() throws ExecException {
  input=BagFactory.getInstance().newDefaultBag();
  TupleFactory tf=TupleFactory.getInstance();
  for (int i=0; i < MAX_SAMPLES; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt(MAX_VALUE));
    input.add(t);
  }
  confirmDistinct();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAgg </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInput4() throws Exception {
  String[] inputTups={"(1,(1L))","(2,(2L))","(null,(2L))"};
  String[] outputTups={"(1,(1L))","(2,(2L))","(null,(2L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiInput1HashMemEmpty() throws Exception {
  String[] inputTups={"(1,(1L))","(2,(2L))","(1,(2L))"};
  String[] outputTups={"(1,(3L))","(2,(2L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInput3() throws Exception {
  String[] inputTups={"(null,(1L))","(null,(2L))","(null,(2L))"};
  String[] outputTups={"(null,(5L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiVals() throws Exception {
  createPOPartialPlan(2);
  String[] inputTups={"(1,(1L),(2L))","(2,(2L),(1L))","(1,(2L),(2L))"};
  String[] outputTups={"(1,(3L),(4L))","(2,(2L),(1L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInputMultiInput1HashMemEmpty() throws Exception {
  String[] inputTups={"(null,(1L))","(null,(2L))","(null,(2L))"};
  String[] outputTups={"(null,(5L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialOneInput3() throws ExecException, ParserException {
  String[] tups1={"(1,(null))"};
  Tuple t=Util.getTuplesFromConstantTupleStrings(tups1).get(0);
  checkSingleRow(t);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiValCheckNotDisabled() throws Exception {
  int numKeys=500;
  int numVals=3;
  createPOPartialPlan(numVals);
  String vals=Strings.repeat(",(1L)",numVals);
  int numInputs=(10000 + numKeys * 2 - 1) / numKeys * numKeys;
  String[] inputTups=new String[numInputs];
  for (int i=0; i < numInputs; i++) {
    inputTups[i]="(" + (i % numKeys) + vals+ ")";
  }
  int expectedVal=numInputs / numKeys;
  vals=Strings.repeat(",(" + expectedVal + "L)",numVals);
  String[] outputTups=new String[numKeys];
  for (int i=0; i < numKeys; i++) {
    outputTups[i]="(" + i + vals+ ")";
  }
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInputHashMemEmpty2() throws Exception {
  String[] inputTups={"(1,(1L))","(2,(2L))","(1,(2L))"};
  String[] outputTups={"(1,(1L))","(2,(2L))","(1,(2L))"};
  checkInputAndOutput(inputTups,outputTups,true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialOneInput2() throws ExecException, ParserException {
  String[] tups1={"(null,(2L))"};
  Tuple t=Util.getTuplesFromConstantTupleStrings(tups1).get(0);
  checkSingleRow(t);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInputHashMemEmpty1() throws Exception {
  String[] inputTups={"(1,(1L))","(2,(2L))","(null,(2L))"};
  String[] outputTups={"(1,(1L))","(2,(2L))","(null,(2L))"};
  checkInputAndOutput(inputTups,outputTups,true);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialOneInput1() throws ExecException, ParserException {
  String[] tups1={"(1,(2L))"};
  Tuple t=Util.getTuplesFromConstantTupleStrings(tups1).get(0);
  checkSingleRow(t);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInput2() throws Exception {
  String[] inputTups={"(1,(1L))","(2,(2L))","(1,(2L))"};
  String[] outputTups={"(1,(3L))","(2,(2L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialMultiInput1() throws Exception {
  String[] inputTups={"(1,(1L))","(1,(2L))","(2,(1L))"};
  String[] outputTups={"(1,(3L))","(2,(1L))"};
  checkInputAndOutput(inputTups,outputTups,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOSort </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescInt() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortDescInt(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescString() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortDescString(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscString() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortAscString(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAsc() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortAscInt(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscStringWithNull() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortAscString(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortUDFWithNull() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortUDFWithNull(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortUDF() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortUDFWithNull(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortAscInt(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescStringWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortDescString(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescIntWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortDescInt(input);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOUserFunc </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUDFCompare() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,2,100);
  udfCompare(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlgebraicAVG() throws IOException, ExecException {
  Integer input[]={1,2,3,4,5,6,7,8,9,10};
  algebraicAVG(input,55.0,10L,110.0,20L,5.5);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlgebraicAVGWithNulls() throws IOException, ExecException {
  Integer input[]={1,2,3,4,null,6,7,8,9,10};
  algebraicAVG(input,50.0,10L,100.0,20L,5.0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserFuncArityWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  userFuncArity(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserFuncArity() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  userFuncArity(input);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUDFCompareWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,2,100);
  udfCompare(input);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPackage </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOperator() throws ExecException, IOException {
  byte[] types=DataType.genAllTypes();
  for (  byte b : types) {
    if (b == DataType.GENERIC_WRITABLECOMPARABLE) {
      continue;
    }
    System.out.println("Type " + DataType.findTypeName(b));
    int NUM_TRIALS=10;
    boolean[] inner1={false,false};
    for (int i=0; i < NUM_TRIALS; i++)     pickTest(b,inner1);
    boolean[] inner2={true,false};
    for (int i=0; i < NUM_TRIALS; i++)     pickTest(b,inner2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyCommentLineinConfigfile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileWithEmptyComments.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidLinesinConfigfile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileWithValidLines.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParser </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testLoadingNonexistentFile() throws Exception {
  for (  ExecType execType : execTypes) {
    setUp(execType);
    pigServer.registerQuery("vals = load 'nonexistentfile';");
    pigServer.openIterator("vals");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigContext </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Setting properties through PigServer constructor directly.
 */
@Test public void testSetProperties_way_num02() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),getProperties());
  registerAndStore(pigServer);
  check_asserts(pigServer);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Passing an already configured pigContext in PigServer constructor.
 */
@Test public void testSetProperties_way_num01() throws Exception {
  PigServer pigServer=new PigServer(pigContext);
  registerAndStore(pigServer);
  check_asserts(pigServer);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * using connect() method.
 */
@Test public void testSetProperties_way_num03() throws Exception {
  pigContext.connect();
  PigServer pigServer=new PigServer(pigContext);
  registerAndStore(pigServer);
  check_asserts(pigServer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigScriptParser </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParserWithEscapeCharacters() throws Exception {
  PigContext pigContext=new PigContext(ExecType.LOCAL,new Properties());
  PigServer pigServer=new PigServer(pigContext);
  pigContext.connect();
  String tempFile=this.prepareTempFile();
  String query=String.format("A = LOAD '%s';",Util.encodeEscape(tempFile));
  Util.buildLp(pigServer,query);
{
    String q=query + "B = filter A by $0 eq 'This is a test string';";
    checkParsedConstContent(pigServer,pigContext,q,"This is a test string");
  }
{
    String q=query + "B = filter A by $0 eq 'This is a test \\'string';";
    checkParsedConstContent(pigServer,pigContext,q,"This is a test 'string");
  }
{
    String q=query + "B = filter A by $0 eq 'This is a test \\\\.string';";
    checkParsedConstContent(pigServer,pigContext,q,"This is a test \\.string");
  }
{
    String q=query + "B = filter A by $0 eq 'This is a test \\nstring';";
    checkParsedConstContent(pigServer,pigContext,q,"This is a test \nstring");
  }
{
    String q=query + "B = filter A by $0 eq 'This is a test \\uD30C\\uC774string';";
    checkParsedConstContent(pigServer,pigContext,q,"This is a test \uD30C\uC774string");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitWithNotEvalCondition() throws Exception {
  String defineQ="define minelogs org.apache.pig.test.RegexGroupCount('www\\\\.xyz\\\\.com/sports');";
  String defineL="a = load 'nosuchfile' " + " using PigStorage() as (source : chararray);";
  String defineSplit="SPLIT a INTO a1 IF (minelogs(source) > 0 ), a2 IF (NOT (minelogs(source)>0));";
  PigServer ps=new PigServer(ExecType.LOCAL);
  ps.registerQuery(defineQ);
  ps.registerQuery(defineL);
  ps.registerQuery(defineSplit);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegisterJarRemoteScript() throws Throwable {
  if (Util.WINDOWS) {
    properties.setProperty("pig.jars.relative.to.dfs","true");
    String jarName=JarManager.findContainingJar(org.codehaus.jackson.JsonParser.class);
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerJar(jarName);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarResolution() throws Throwable {
  registerScalarScript(false,"a: int,every: {(b: int)},even: int,odd: {(b: int)}");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarPrecedence() throws Throwable {
  registerScalarScript(true,"a: int,every: {(b: int)},even: {(b: int)},odd: {(b: int)}");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkipParseInRegisterForBatch() throws Throwable {
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    _testSkipParseInRegisterForBatch(false,8,4);
    _testSkipParseInRegisterForBatch(true,5,1);
    _testParseBatchWithScripting(5,1);
  }
 else {
    _testSkipParseInRegisterForBatch(false,10,4);
    _testSkipParseInRegisterForBatch(true,7,1);
    _testParseBatchWithScripting(7,1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStats </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPigStatsAlias() throws Exception {
  try {
    PigServer pig=new PigServer(Util.getLocalTestMode());
    pig.setBatchOn();
    pig.registerQuery("A = load 'input' as (name, age, gpa);");
    pig.registerQuery("B = group A by name;");
    pig.registerQuery("C = foreach B generate group, COUNT(A);");
    pig.registerQuery("D = order C by $1;");
    pig.registerQuery("E = limit D 10;");
    pig.registerQuery("store E into 'alias_output';");
    LogicalPlan lp=getLogicalPlan(pig);
    lp.optimize(pig.getPigContext());
    PhysicalPlan pp=((HExecutionEngine)pig.getPigContext().getExecutionEngine()).compile(lp,null);
    checkPigStatsAlias(pp,pig.getPigContext());
  }
  finally {
    File outputfile=new File("alias_output");
    if (outputfile.exists()) {
      deleteDirectory(outputfile);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSchemaDataNotMatchWITHCast() throws Exception {
  pig.registerQuery("A = LOAD '" + datadir + "originput' using PigStorage(',') as (x:chararray);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A')","('B')","('C')","('D')","('A')","('B')","('C')","('A')","('D')","('A')"});
  assertAliasIs("A",expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSchemaDataNotMatchNOCast() throws Exception {
  pig.registerQuery("A = LOAD '" + datadir + "originput' using PigStorage(',') as (x:bytearray);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A')","('B')","('C')","('D')","('A')","('B')","('C')","('A')","('D')","('A')"});
  assertAliasIs("A",expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSchemaDataNotMatchAsEXTRACoumns() throws Exception {
  pig.registerQuery("A = LOAD '" + datadir + "originput' using PigStorage(',') as (x,y,z);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A',1,NULL)","('B',2,NULL)","('C',3,NULL)","('D',2,NULL)","('A',5,NULL)","('B',5,NULL)","('C',8,NULL)","('A',8,NULL)","('D',8,NULL)","('A',9,NULL)"});
  assertAliasIs("A",expectedResults);
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * See PIG-1830
 * @throws IOException
 */
@Test public void testByteArrayConversion() throws IOException {
  Util.createLocalInputFile(datadir + "originput2",new String[]{"peter\t1","samir\t2","michael\t4","peter\t2","peter\t4","samir\t1","john\t"});
  Util.createLocalInputFile(datadir + ".pig_schema",new String[]{"{\"fields\":[{\"name\":\"name\",\"type\":55,\"schema\":null," + "\"description\":\"autogenerated from Pig Field Schema\"}," + "{\"name\":\"val\",\"type\":10,\"schema\":null,\"description\":"+ "\"autogenerated from Pig Field Schema\"}],\"version\":0,"+ "\"sortKeys\":[],\"sortKeyOrders\":[]}"});
  pig.registerQuery("Events = LOAD '" + datadir + "originput2' USING PigStorage('\\t', '-schema');");
  pig.registerQuery("Sessions = GROUP Events BY name;");
  Iterator<Tuple> sessions=pig.openIterator("Sessions");
  while (sessions.hasNext()) {
    System.out.println(sessions.next());
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=Exception.class) public void testPigStorageSchemaFailureWithoutOverwrite() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage(',')");
  pig.store("a",datadir + "aout","PigStorage(',')");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPlanGeneration </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDanglingNestedNode() throws Exception {
  String query="a = load 'b.txt' AS (id:chararray, num:int); " + "b = group a by id;" + "c = foreach b {"+ "  d = order a by num DESC;"+ "  n = COUNT(a);"+ "  e = limit d 1;"+ "  generate n;"+ "};";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestProjectRange </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeOrderByWSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " o = order l1 by  .. $2 DESC ;";
    compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"o");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={false,false,false};
    checkNumExpressionPlansForSort(lp,3,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " o = order l1 by  $3 ..  ;";
    compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"o");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true,true};
    checkNumExpressionPlansForSort(lp,2,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " o = order l1 by  d .. DESC  ;";
    compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"o");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={false,false};
    checkNumExpressionPlansForSort(lp,2,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " f = foreach l1 generate *;"+ " o = order f by  $0 .. c ASC  ;"+ " lim = limit o 10; ;";
    compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"lim");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true,true,true};
    checkNumExpressionPlansForSort(lp,3,isAsc);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " o = order l1 by $0 .. $4  ;";
  compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"o");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={true,true,true,true,true};
  checkNumExpressionPlansForSort(lp,5,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("o");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30,40,50)","(11,21,31,41,51)"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test nested order-by without schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testRangeOrderByNestedNOSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " g = group l1 by $0;"+ " f = foreach g { o = order l1 by  .. $2 DESC; generate group, o;}";
    String expectedSchStr="g : bytearray, o: {t : ()}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={false,false,false};
    checkNumExpressionPlansForSort(lp,3,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " g = group l1 by $0;"+ " f = foreach g { o = order l1 by  $3 .. ; generate group, o;}";
    String expectedSchStr="g : bytearray, o: {t : ()}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true};
    checkNumExpressionPlansForSort(lp,1,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " g = group l1 by $1;"+ " f = foreach g { o = order l1 by  $2 .. $3 ASC, $1 .. $2 DESC; generate group, o;}";
    String expectedSchStr="g : bytearray, o: {t : ()}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true,true,false,false};
    checkNumExpressionPlansForSort(lp,4,isAsc);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " g = group l1 by 1;"+ " f = foreach g { o = order l1 by  $2 .. $3 desc; generate group, o;}";
  String expectedSchStr="g : int, o: {t : ()}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  compileAndCompareSchema(expectedSch,query,"f");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={false,false};
  checkNumExpressionPlansForSort(lp,2,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,{(11,21,31,41,51),(10,20,30,40,50)})"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test project-range in foreach with limits on both sides
 * @throws IOException
 * @throws ParserException
 */
@Test public void testFullRangeForeachWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate a .. c as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate $0 .. $2 as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate $0 .. c as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate b .. d as (bb, cc, dd);";
  compileAndCompareSchema("bb : float, cc : int, dd : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate b .. b as (bb), $2 .. $2;";
  compileAndCompareSchema("bb : float, c : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int, d : int, e : int);"+ "f = foreach l1 generate a .. c, d .. e ;";
  compileAndCompareSchema("a : int, b : int, c : int, d : int, e : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int, d : int, e : int);"+ "f = foreach l1 generate a .. c ;";
  compileAndCompareSchema("a : int, b : int, c : int",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30)","(11,21,31)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * -ve test cases
 * @throws IOException
 * @throws ParserException
 */
@Test public void testNegativeForeachNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "f = foreach l1 generate  $3 .. $1;";
  Util.checkExceptionMessage(query,"f","start column appears after end column in range projection");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' ;"+ "f = foreach l1 generate  a .. b;";
  Util.checkExceptionMessage(query,"f","Invalid field projection. Projected field [a] does not exist.");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test foreach without schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testStartRangeForeachNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "f = foreach l1 generate ..$3  as (a,b,c,d);";
  compileAndCompareSchema("a : bytearray,b : bytearray,c : bytearray,d : bytearray",query,"f");
  Util.registerMultiLineQuery(pigServer,query);
  pigServer.explain("f",System.err);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"('10','20','30','40')","('11','21','31','41')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeCoGroupNegNoSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "';"+ "  g = cogroup l1 by  ($0 ..  ),  l2 by ($0 .. );";
  Util.checkExceptionMessage(query,"g","Cogroup/Group by '*' or 'x..' " + "(range of columns to the end) " + "is only allowed if the input has a schema");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeGroupMixNOSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "  g = group l1 by  .. $2;";
    String expectedSchStr="g : (duma, dumb, dumc), l1: {t : ()}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    setAliasesToNull(expectedSch.getField(0).schema);
    compileAndCompareSchema(expectedSch,query,"g");
    LogicalPlan lp=createAndProcessLPlan(query);
    checkNumExpressionPlansForGroup(lp,3);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "  g = group l1 by  $3 .. $3;";
    String expectedSchStr="g : bytearray, l1: {t : ()}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"g");
    LogicalPlan lp=createAndProcessLPlan(query);
    checkNumExpressionPlansForGroup(lp,1);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "  g = group l1 by  $2 .. ;";
  String expectedSchStr="grp: (), l1: {t : ()}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  compileAndCompareSchema(expectedSch,query,"g");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForGroup(lp,1);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((30,40,50),{(10,20,30,40,50)})","((31,41,51),{(11,21,31,41,51)})"});
  Iterator<Tuple> it=pigServer.openIterator("g");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeOrderByStartNegNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " o = order l1 by $3 .. DESC, $1;";
  Util.checkExceptionMessage(query,"o","Project-range to end (eg. x..)" + " is supported in order-by only as last sort column");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeJoinMixWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : int, b : long, c : int, d : int, e : int);"+ "  j = join l1 by  (a + b, c .. d, e.. ),  l2 by ($0 + $1, c..d, $4..);";
  String expectedSchStr="l1::a: int, l1::b: long, l1::c: int, l1::d: int, l1::e: int," + "l2::a: int, l2::b: long, l2::c: int, l2::d: int, l2::e: int";
  compileAndCompareSchema(expectedSchStr,query,"j");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForJoin(lp,4);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30,40,50,10,20,30,40,50)","(11,21,31,41,51,11,21,31,41,51)"});
  Iterator<Tuple> it=pigServer.openIterator("j");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test foreach without schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testMixRangeForeachNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "f = foreach l1 generate ..$0 as (first), $4.. as (last), $3 ..,  .. $1 ;";
  compileAndCompareSchema((Schema)null,query,"f");
  Util.registerMultiLineQuery(pigServer,query);
  pigServer.explain("f",System.err);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"('10','50','40','50','10','20')","('11','51','41','51','11','21')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeGroupWSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by   d ..,  l2 by d ..;";
    String expectedSchStr="grp: (d: int,e : int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}," + "l2: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"g");
    LogicalPlan lp=createAndProcessLPlan(query);
    checkNumExpressionPlansForGroup(lp,2);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by   c .. $3,  l2 by $3..$4;";
    String expectedSchStr="grp: (c: int,d : int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}," + "l2: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"g");
    LogicalPlan lp=createAndProcessLPlan(query);
    checkNumExpressionPlansForGroup(lp,2);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by   .. c,  l2 by .. c;";
  String expectedSchStr="grp: (a: int,b: long,c: int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}," + "l2: {t : (a: int,b: long,c: int,d: int,e: int)}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  compileAndCompareSchema(expectedSch,query,"g");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForGroup(lp,3);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((10,20,30),{(10,20,30,40,50)},{(10,20,30,40,50)})","((11,21,31),{(11,21,31,41,51)},{(11,21,31,41,51)})"});
  Iterator<Tuple> it=pigServer.openIterator("g");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeCoGroupMixWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by  (a + b, c .. d, e.. ),  l2 by ($0 + $1, c..d, $4..);";
  String expectedSchStr="grp: (x : long, c :int , d :int, e : int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}," + "l2: {t : (a: int,b: long,c: int,d: int,e: int)}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  expectedSch.getField(0).schema.getField(0).alias=null;
  compileAndCompareSchema(expectedSch,query,"g");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForGroup(lp,4);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((30,30,40,50),{(10,20,30,40,50)},{(10,20,30,40,50)})","((32,31,41,51),{(11,21,31,41,51)},{(11,21,31,41,51)})"});
  Iterator<Tuple> it=pigServer.openIterator("g");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test nested order-by with schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testRangeOrderByNestedWSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " g = group l1 by a;"+ " f = foreach g { o = order l1 by  .. $2 DESC; generate group, o;}";
    String expectedSchStr="g : int,o: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={false,false,false};
    checkNumExpressionPlansForSort(lp,3,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " g = group l1 by a;"+ " f = foreach g { o = order l1 by  d .. ; generate group, o;}";
    String expectedSchStr="g : int,o: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true,true};
    checkNumExpressionPlansForSort(lp,2,isAsc);
  }
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " g = group l1 by a;"+ " f = foreach g { o = order l1 by  $2 .. $3 ASC, $1..c DESC; generate group, o;}";
    String expectedSchStr="g : int,o: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"f");
    LogicalPlan lp=createAndProcessLPlan(query);
    boolean[] isAsc={true,true,false,false};
    checkNumExpressionPlansForSort(lp,4,isAsc);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " g = group l1 by a;"+ " f = foreach g { o = order l1 by  $2 .. $3 DESC, $1 ASC; generate group, o;}";
  String expectedSchStr="g : int,o: {t : (a: int,b: long,c: int,d: int,e: int)}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  compileAndCompareSchema(expectedSch,query,"f");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={false,false,true};
  checkNumExpressionPlansForSort(lp,3,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,{(10,20,30,40,50)})","(11,{(11,21,31,41,51)})"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeGroupMixWSchema() throws IOException, ParserException {
  String query;
{
    query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by  b .. c;";
    String expectedSchStr="grp: (b : long, c :int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}";
    Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
    compileAndCompareSchema(expectedSch,query,"g");
    LogicalPlan lp=createAndProcessLPlan(query);
    checkNumExpressionPlansForGroup(lp,2);
  }
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ "  g = group l1 by  $2 .. ;"+ "  lim = limit g 2;";
  String expectedSchStr="grp: (c :int , d :int, e : int)," + "l1: {t : (a: int,b: long,c: int,d: int,e: int)}";
  Schema expectedSch=getCleanedGroupSchema(expectedSchStr);
  compileAndCompareSchema(expectedSch,query,"lim");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForGroup(lp,3);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((30,40,50),{(10,20L,30,40,50)})","((31,41,51),{(11,21L,31,41,51)})"});
  Iterator<Tuple> it=pigServer.openIterator("lim");
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeOrderByMixWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : long, c : int, d : int, e : int);"+ " o = order l1 by  b .. c, d .. DESC,  a DESC;";
  compileAndCompareSchema("a : int, b : long, c : int, d : int, e : int",query,"o");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={true,true,false,false,false};
  checkNumExpressionPlansForSort(lp,5,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  Iterator<Tuple> it=pigServer.openIterator("o");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30,40,50)","(11,21,31,41,51)"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test multiple different types of range-project with foreach
 * @throws IOException
 * @throws ParserException
 */
@Test public void testMixRangeForeachWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  .. b, c .. d, d .. as (aa, bb);";
  compileAndCompareSchema("a : int, b : float, c : int, d : int, aa : int, bb : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int, d : long, e : int);"+ "f = foreach l1 generate ..$0 as (first), e.. as (last), d ..,  .. b ;";
  compileAndCompareSchema("first : int, last : int, d : long, e : int, a : int, b : int",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,50,40L,50,10,20)","(11,51,41L,51,11,21)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test project-range in foreach with starting limit
 * @throws IOException
 * @throws ParserException
 */
@Test public void testEndRangeForeachWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  .. c as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  .. $2 as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  .. $0 as (aa, bb, cc);";
  compileAndCompareSchema("aa : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  .. c as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : float, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int, d : long, e : int);"+ "f = foreach l1 generate  .. $3 ;";
  compileAndCompareSchema("a : int, b : int, c : int, d : long",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30,40L)","(11,21,31,41L)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test foreach without schema - with some operations after the foreach
 * @throws IOException
 * @throws ParserException
 */
@Test public void testRangeForeachWFilterNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "f = foreach l1 generate ..$0 as (first), $4.. as (last), $3 ..,  .. $1 ;"+ " fil = filter f by $0 > 10;";
  Util.registerMultiLineQuery(pigServer,query);
  pigServer.explain("fil",System.err);
  Iterator<Tuple> it=pigServer.openIterator("fil");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"('11','51','41','51','11','21')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeJoinMixNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "  l2 = load '"+ INP_FILE_5FIELDS+ "';"+ "  j = join l1 by  $0 .. $3,  l2 by $0 .. $3;";
  compileAndCompareSchema((Schema)null,query,"j");
  LogicalPlan lp=createAndProcessLPlan(query);
  checkNumExpressionPlansForJoin(lp,4);
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20,30,40,50,10,20,30,40,50)","(11,21,31,41,51,11,21,31,41,51)"});
  Iterator<Tuple> it=pigServer.openIterator("j");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * -ve test cases
 * @throws IOException
 * @throws ParserException
 */
@Test public void testNegativeForeachWSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  $3 .. $1;";
  Util.checkExceptionMessage(query,"f","start column appears after end column in range projection");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  c .. b;";
  Util.checkExceptionMessage(query,"f","start column appears after end column in range projection");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeOrderByMixNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " o = order l1 by  $1 .. $2 DESC,  $0 , $4 .. DESC;";
  compileAndCompareSchema((Schema)null,query,"o");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={false,false,true,false};
  checkNumExpressionPlansForSort(lp,4,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  pigServer.explain("o",System.err);
  Iterator<Tuple> it=pigServer.openIterator("o");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(11,21,31,41,51)","(10,20,30,40,50)"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test project-range in foreach with start limit
 * @throws IOException
 * @throws ParserException
 */
@Test public void testStartRangeForeachWSchema() throws IOException, ParserException {
  String query="  l1 = load '" + INP_FILE_5FIELDS + "' "+ "as (a : int, b : float, c : int, d : int, e : int);"+ "f = foreach l1 generate  c ..  as (aa, bb, cc);";
  compileAndCompareSchema("aa : int, bb : int, cc : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' "+ "as (a : int, b : int, c : int, d : long, e : int);"+ "f = foreach l1 generate  $1 ..  ;";
  compileAndCompareSchema("b : int, c : int, d : long, e : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' "+ "as (a : int, b : int, c : int, d : long, e : int);"+ "f = foreach l1 generate  e ..  ;";
  compileAndCompareSchema("e : int",query,"f");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' "+ "as (a : int, b : long, c : int, d : int, e : int);"+ "f = foreach l1 generate  c ..  as (aa, bb, cc), b .. ;";
  compileAndCompareSchema("aa : int, bb : int, cc : int, b : long, c : int, d : int, e : int",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(30,40,50,20L,30,40,50)","(31,41,51,21L,31,41,51)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRangeOrderByStartNOSchema() throws IOException, ParserException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ " o = order l1 by $3 .. DESC;";
  compileAndCompareSchema((Schema)null,query,"o");
  LogicalPlan lp=createAndProcessLPlan(query);
  boolean[] isAsc={false};
  checkNumExpressionPlansForSort(lp,1,isAsc);
  Util.registerMultiLineQuery(pigServer,query);
  pigServer.explain("o",System.err);
  Iterator<Tuple> it=pigServer.openIterator("o");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(11,21,31,41,51)","(10,20,30,40,50)"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestProjectStarRangeInUdf </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjMixExpand1() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int);"+ "f = foreach l1 generate TOBAG(*, $0 .. $2) as tt;";
  compileAndCompareSchema("tt : {(NullAlias : int)}",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"({(10),(20),(30),(10),(20),(30)})","({(11),(21),(31),(11),(21),(31)})"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInFilter1() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int);"+ "f = filter l1 by SUM(TOBAG((a == 10 ? 100 : 0), *)) == 130;";
  compileAndCompareSchema("a : int, b : int",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,20)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeachLookup2() throws IOException {
  String query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int);"+ "f = foreach l1 generate TOTUPLE(b .. ) as tb;"+ "f2 = foreach f generate tb.b as b2, tb.c as c2;"+ "f3 = foreach f2 generate b2, b2 + c2 as bc2;";
  compileAndCompareSchema("b2 : int, bc2 : int",query,"f3");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test project-range in foreach with limits on both sides
 * @throws IOException
 * @throws ParseException
 */
@Test public void testProjRangeExpandInForeach() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a, b : chararray, c : chararray, d);"+ "f = foreach l1 generate CONCAT($1 .. $2) as ct;";
  compileAndCompareSchema("ct : chararray",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"('2030')","('2131')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjRangeExpandInJoin() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : chararray, b : chararray, c : chararray, d);"+ "f1 = foreach l1 generate a, b, c, '1' as num;"+ "l2 = load '"+ INP_FILE_5FIELDS+ "' as (a : chararray, b : chararray, c : chararray, d);"+ "f2 = foreach l1 generate c, a, b, '2' as num;"+ "j = join f1 by CONCAT($0 .. $1), f2 by CONCAT(a .. b);";
  String schStr="f1::a : chararray, f1::b : chararray, f1::c : chararray, f1::num : chararray," + "f2::c : chararray, f2::a : chararray, f2::b : chararray, f2::num : chararray";
  compileAndCompareSchema(schStr,query,"j");
  Iterator<Tuple> it=pigServer.openIterator("j");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"('10', '20', '30', '1', '30', '10', '20', '2')","('11', '21', '31', '1', '31', '11', '21', '2')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeach2() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int);"+ "f = foreach l1 generate TOTUPLE(*) as tb;";
  compileAndCompareSchema("tb : (a : int, b : int, c : int)",query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((10,20,30))","((11,21,31))"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeach1Multi() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a, b, c);"+ "f = foreach l1 generate CONCAT(*) as ct;";
  compileAndCompareSchema("ct : bytearray",query,"f");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeach1() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a, b);"+ "f = foreach l1 generate CONCAT(*) as ct;";
  compileAndCompareSchema("ct : bytearray",query,"f");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeach1NegativeNoSchema() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' ;"+ "f = foreach l1 generate CONCAT(*) as ct;";
  Util.checkExceptionMessage(query,"f","Could not infer the matching function for " + "org.apache.pig.builtin.CONCAT");
  query="  l1 = load '" + INP_FILE_5FIELDS + "' ;"+ "f = foreach l1 generate SIZE(*) as ct;";
  Util.checkExceptionMessage(query,"f","Could not infer the matching function for " + "org.apache.pig.builtin.SIZE");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjRangeExpandInFilterNoSchema1() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' ;"+ "f = filter l1 by SUM(TOBAG($0 .. $1)) == 30;";
  compileAndCompareSchema((Schema)null,query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"('10','20','30','40','50')"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjStarExpandInForeachLookup1() throws IOException {
  String query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int);"+ "f = foreach l1 generate TOTUPLE(*) as tb;"+ "f2 = foreach f generate tb.a, tb.b;";
  compileAndCompareSchema("a : int, b : int",query,"f2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjMixExpand2NoSchema() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' ;"+ "f = foreach l1 generate TOTUPLE(1, $0 .. $1, 2+3, $2 .. , $4 -1) as tt;";
  compileAndCompareSchema("tt :()",query,"f");
  pigServer.explain("f",System.out);
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"((1,'10','20',5,'30','40','50',49))","((1,'11','21',5,'31','41','51',50))"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjMixExpand3() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : chararray, d : chararray);"+ "f = foreach l1 generate TOTUPLE($0 .. $1, CONCAT($2 .. )) as tt;";
  String schStr="tt : (a : int, b : int, NullAlias : chararray)";
  compileAndCompareSchema(schStr,query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((10,20,'3040'))","((11,21,'3141'))"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjMixExpand1NoSchema() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "';"+ "f = foreach l1 generate TOBAG(*, $0 .. $2) as tt;";
  Schema sch=Utils.getSchemaFromString("tt : {(NullALias)}");
  sch.getField(0).schema.getField(0).schema.getField(0).alias=null;
  sch.getField(0).schema.getField(0).schema.getField(0).type=DataType.NULL;
  compileAndCompareSchema(sch,query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStringAsByteArray(new String[]{"({('10'),('20'),('30'),('40'),('50'),('10'),('20'),('30')})","({('11'),('21'),('31'),('41'),('51'),('11'),('21'),('31')})"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjMixExpand2() throws IOException {
  String query;
  query="  l1 = load '" + INP_FILE_5FIELDS + "' as (a : int, b : int, c : int, d : int);"+ "f = foreach l1 generate TOTUPLE(1, $0 .. $1, 2+3, $2 .. , d - 1) as tt;";
  String schStr="tt : (NullAliasA : int, a : int, b : int," + " NullAliasB : int, c : int, d : int, NullAliasC : int)";
  compileAndCompareSchema(schStr,query,"f");
  Iterator<Tuple> it=pigServer.openIterator("f");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"((1,10,20,5,30,40,39))","((1,11,21,5,31,41,40))"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRank1 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank01RankBy() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f3;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"C",3,"M")),tf.newTuple(ImmutableList.of((long)2,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)5,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)5,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)5,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)10,"F",8,"T")),tf.newTuple(ImmutableList.of((long)11,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank07RankBy() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f1..f3;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"C",3,"M")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)7,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)10,"F",8,"T")),tf.newTuple(ImmutableList.of((long)11,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank06RankBy() throws IOException {
  String query="A = LOAD 'test02' USING mock.Storage() AS (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "C = rank A by $0..$2;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"David","Campbell",8,6,2,3,3587378.426,98055)),tf.newTuple(ImmutableList.of((long)2,"Garrett","Vargas",4,1,1,1,1764938.986,98027)),tf.newTuple(ImmutableList.of((long)3,"Jae","Pak",12,6,2,4,5015682.375,98055)),tf.newTuple(ImmutableList.of((long)4,"Jillian","Carson",3,1,1,1,3857163.633,98027)),tf.newTuple(ImmutableList.of((long)5,"Jose","Saraiva",7,6,2,2,3189356.247,98055)),tf.newTuple(ImmutableList.of((long)6,"Linda","Mitchell",2,1,1,1,5200475.231,98027)),tf.newTuple(ImmutableList.of((long)7,"Lynn","Tsoflias",10,6,2,3,1758385.926,98055)),tf.newTuple(ImmutableList.of((long)8,"Michael","Blythe",1,1,1,1,4557045.046,98027)),tf.newTuple(ImmutableList.of((long)9,"Rachel","Valdez",11,6,2,4,2241204.042,98055)),tf.newTuple(ImmutableList.of((long)10,"Ranjit","Varkey Chudukatil",13,6,2,4,3827950.238,98055)),tf.newTuple(ImmutableList.of((long)11,"Shu","Ito",6,6,2,2,3018725.486,98055)),tf.newTuple(ImmutableList.of((long)12,"Tete","Mensa-Annan",9,6,2,3,1931620.184,98055)),tf.newTuple(ImmutableList.of((long)13,"Tsvi","Reiter",5,1,1,2,2811012.715,98027)));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank01RowNumber() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"C",3,"M")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)6,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)7,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)9,"F",8,"T")),tf.newTuple(ImmutableList.of((long)10,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)11,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank02RankBy() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f2 ASC;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"C",3,"M")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)7,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)8,"F",8,"T")),tf.newTuple(ImmutableList.of((long)11,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank03RankBy() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f1 DESC;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"G",10,"V")),tf.newTuple(ImmutableList.of((long)2,"F",8,"T")),tf.newTuple(ImmutableList.of((long)2,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)2,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)2,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)6,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)6,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)8,"D",4,"P")),tf.newTuple(ImmutableList.of((long)9,"C",3,"M")),tf.newTuple(ImmutableList.of((long)10,"B",2,"N")),tf.newTuple(ImmutableList.of((long)11,"A",1,"N")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank04RankBy() throws IOException {
  String query="A = LOAD 'test02' USING mock.Storage() AS (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "C = rank A by postalcode;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"Michael","Blythe",1,1,1,1,4557045.046,98027)),tf.newTuple(ImmutableList.of((long)1,"Linda","Mitchell",2,1,1,1,5200475.231,98027)),tf.newTuple(ImmutableList.of((long)1,"Jillian","Carson",3,1,1,1,3857163.633,98027)),tf.newTuple(ImmutableList.of((long)1,"Garrett","Vargas",4,1,1,1,1764938.986,98027)),tf.newTuple(ImmutableList.of((long)1,"Tsvi","Reiter",5,1,1,2,2811012.715,98027)),tf.newTuple(ImmutableList.of((long)6,"Shu","Ito",6,6,2,2,3018725.486,98055)),tf.newTuple(ImmutableList.of((long)6,"Jose","Saraiva",7,6,2,2,3189356.247,98055)),tf.newTuple(ImmutableList.of((long)6,"David","Campbell",8,6,2,3,3587378.426,98055)),tf.newTuple(ImmutableList.of((long)6,"Tete","Mensa-Annan",9,6,2,3,1931620.184,98055)),tf.newTuple(ImmutableList.of((long)6,"Lynn","Tsoflias",10,6,2,3,1758385.926,98055)),tf.newTuple(ImmutableList.of((long)6,"Rachel","Valdez",11,6,2,4,2241204.042,98055)),tf.newTuple(ImmutableList.of((long)6,"Jae","Pak",12,6,2,4,5015682.375,98055)),tf.newTuple(ImmutableList.of((long)6,"Ranjit","Varkey Chudukatil",13,6,2,4,3827950.238,98055)));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank05RankBy() throws IOException {
  String query="A = LOAD 'test02' USING mock.Storage() AS (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "C = rank A by *;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"David","Campbell",8,6,2,3,3587378.426,98055)),tf.newTuple(ImmutableList.of((long)2,"Garrett","Vargas",4,1,1,1,1764938.986,98027)),tf.newTuple(ImmutableList.of((long)3,"Jae","Pak",12,6,2,4,5015682.375,98055)),tf.newTuple(ImmutableList.of((long)4,"Jillian","Carson",3,1,1,1,3857163.633,98027)),tf.newTuple(ImmutableList.of((long)5,"Jose","Saraiva",7,6,2,2,3189356.247,98055)),tf.newTuple(ImmutableList.of((long)6,"Linda","Mitchell",2,1,1,1,5200475.231,98027)),tf.newTuple(ImmutableList.of((long)7,"Lynn","Tsoflias",10,6,2,3,1758385.926,98055)),tf.newTuple(ImmutableList.of((long)8,"Michael","Blythe",1,1,1,1,4557045.046,98027)),tf.newTuple(ImmutableList.of((long)9,"Rachel","Valdez",11,6,2,4,2241204.042,98055)),tf.newTuple(ImmutableList.of((long)10,"Ranjit","Varkey Chudukatil",13,6,2,4,3827950.238,98055)),tf.newTuple(ImmutableList.of((long)11,"Shu","Ito",6,6,2,2,3018725.486,98055)),tf.newTuple(ImmutableList.of((long)12,"Tete","Mensa-Annan",9,6,2,3,1931620.184,98055)),tf.newTuple(ImmutableList.of((long)13,"Tsvi","Reiter",5,1,1,2,2811012.715,98027)));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank02RowNumber() throws IOException {
  String query="A = LOAD 'test02' USING mock.Storage() AS (firstname:chararray,lastname:chararray,rownumberPrev:int,rankPrev:int,denserankPrev:int,quartilePrev:int,sales:double,postalcode:int);" + "B = rank A;" + "store B into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"Michael","Blythe",1,1,1,1,4557045.046,98027)),tf.newTuple(ImmutableList.of((long)2,"Linda","Mitchell",2,1,1,1,5200475.231,98027)),tf.newTuple(ImmutableList.of((long)3,"Jillian","Carson",3,1,1,1,3857163.633,98027)),tf.newTuple(ImmutableList.of((long)4,"Garrett","Vargas",4,1,1,1,1764938.986,98027)),tf.newTuple(ImmutableList.of((long)5,"Tsvi","Reiter",5,1,1,2,2811012.715,98027)),tf.newTuple(ImmutableList.of((long)6,"Shu","Ito",6,6,2,2,3018725.486,98055)),tf.newTuple(ImmutableList.of((long)7,"Jose","Saraiva",7,6,2,2,3189356.247,98055)),tf.newTuple(ImmutableList.of((long)8,"David","Campbell",8,6,2,3,3587378.426,98055)),tf.newTuple(ImmutableList.of((long)9,"Tete","Mensa-Annan",9,6,2,3,1931620.184,98055)),tf.newTuple(ImmutableList.of((long)10,"Lynn","Tsoflias",10,6,2,3,1758385.926,98055)),tf.newTuple(ImmutableList.of((long)11,"Rachel","Valdez",11,6,2,4,2241204.042,98055)),tf.newTuple(ImmutableList.of((long)12,"Jae","Pak",12,6,2,4,5015682.375,98055)),tf.newTuple(ImmutableList.of((long)13,"Ranjit","Varkey Chudukatil",13,6,2,4,3827950.238,98055)));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRank2 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank04RankByDense() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f1, f2 DESC DENSE;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"C",3,"M")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)5,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"T")),tf.newTuple(ImmutableList.of((long)7,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)8,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank02RankByDense() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f2 ASC DENSE;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"C",3,"M")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)5,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)6,"F",8,"T")),tf.newTuple(ImmutableList.of((long)7,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank01RankByDense() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f3 DENSE;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"C",3,"M")),tf.newTuple(ImmutableList.of((long)2,"A",1,"N")),tf.newTuple(ImmutableList.of((long)2,"B",2,"N")),tf.newTuple(ImmutableList.of((long)3,"D",4,"P")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)4,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)4,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)4,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)4,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)5,"F",8,"T")),tf.newTuple(ImmutableList.of((long)6,"G",10,"V")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank03RankByDense() throws IOException {
  String query="A = LOAD 'test01' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);" + "C = rank A by f1 DESC DENSE;" + "store C into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of((long)1,"G",10,"V")),tf.newTuple(ImmutableList.of((long)2,"F",8,"T")),tf.newTuple(ImmutableList.of((long)2,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)2,"F",8,"Q")),tf.newTuple(ImmutableList.of((long)2,"F",7,"Q")),tf.newTuple(ImmutableList.of((long)3,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)3,"E",4,"Q")),tf.newTuple(ImmutableList.of((long)4,"D",4,"P")),tf.newTuple(ImmutableList.of((long)5,"C",3,"M")),tf.newTuple(ImmutableList.of((long)6,"B",2,"N")),tf.newTuple(ImmutableList.of((long)7,"A",1,"N")));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRank3 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankWithSplitInReduce() throws Exception {
  String query="R1 = LOAD 'testsplit' USING mock.Storage() AS (a:int,b:int);" + "R1 = ORDER R1 by b;" + "R2 = rank R1 by a ;"+ "R3 = rank R1;"+ "R4 = union R2, R3;"+ "store R4 into 'R4' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,3,1)","(2L,1,2)","(3L,1,2)","(4L,2,3)","(5L,2,4)","(1L,1,2)","(1L,1,2)","(3L,2,4)","(3L,2,3)","(5L,3,1)"});
  Util.checkQueryOutputsAfterSort(data.get("R4"),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankCascade() throws IOException {
  String query="R1 = LOAD 'testcascade' USING mock.Storage() AS (a:long,b:long,c:long);" + "R2 = rank R1 by a ASC,b ASC DENSE;" + "R3 = rank R2 by a ASC,c DESC DENSE;"+ "R4 = rank R3 by b DESC,c ASC DENSE;"+ "R5 = rank R4 by b DESC,a ASC;"+ "R6 = rank R5 by c ASC,b DESC;"+ "R7 = order R6 by a ASC,c DESC,b DESC;"+ "R8 = rank R7;"+ "store R8 into 'result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of(tf.newTuple(ImmutableList.of(1L,21L,5L,7L,1L,1L,0L,8L,8L)),tf.newTuple(ImmutableList.of(2L,26L,2L,3L,2L,5L,1L,9L,10L)),tf.newTuple(ImmutableList.of(3L,30L,24L,21L,2L,3L,1L,3L,10L)),tf.newTuple(ImmutableList.of(4L,6L,10L,8L,3L,4L,1L,7L,2L)),tf.newTuple(ImmutableList.of(5L,8L,28L,25L,3L,2L,1L,0L,2L)),tf.newTuple(ImmutableList.of(6L,28L,11L,12L,4L,6L,2L,7L,10L)),tf.newTuple(ImmutableList.of(7L,9L,26L,22L,5L,7L,3L,2L,3L)),tf.newTuple(ImmutableList.of(8L,5L,6L,5L,6L,8L,3L,8L,1L)),tf.newTuple(ImmutableList.of(9L,29L,16L,15L,7L,9L,4L,6L,10L)),tf.newTuple(ImmutableList.of(10L,18L,12L,10L,8L,11L,5L,7L,6L)),tf.newTuple(ImmutableList.of(11L,14L,17L,14L,9L,10L,5L,6L,5L)),tf.newTuple(ImmutableList.of(12L,6L,12L,8L,10L,11L,5L,7L,2L)),tf.newTuple(ImmutableList.of(13L,2L,17L,13L,11L,10L,5L,6L,0L)),tf.newTuple(ImmutableList.of(14L,26L,3L,3L,12L,14L,6L,9L,10L)),tf.newTuple(ImmutableList.of(15L,15L,20L,18L,13L,13L,6L,4L,5L)),tf.newTuple(ImmutableList.of(16L,3L,29L,24L,14L,12L,6L,0L,0L)),tf.newTuple(ImmutableList.of(17L,23L,21L,19L,15L,16L,7L,4L,8L)),tf.newTuple(ImmutableList.of(18L,19L,19L,16L,16L,17L,7L,5L,6L)),tf.newTuple(ImmutableList.of(19L,20L,30L,26L,16L,15L,7L,0L,6L)),tf.newTuple(ImmutableList.of(20L,12L,21L,17L,17L,16L,7L,4L,4L)),tf.newTuple(ImmutableList.of(21L,4L,1L,1L,18L,19L,7L,10L,1L)),tf.newTuple(ImmutableList.of(22L,1L,7L,4L,19L,18L,7L,8L,0L)),tf.newTuple(ImmutableList.of(23L,24L,14L,11L,20L,21L,8L,7L,9L)),tf.newTuple(ImmutableList.of(24L,16L,25L,20L,21L,20L,8L,3L,5L)),tf.newTuple(ImmutableList.of(25L,25L,27L,23L,22L,22L,9L,1L,9L)),tf.newTuple(ImmutableList.of(26L,21L,8L,7L,23L,25L,9L,8L,8L)),tf.newTuple(ImmutableList.of(27L,17L,4L,2L,24L,26L,9L,9L,6L)),tf.newTuple(ImmutableList.of(28L,10L,8L,6L,25L,25L,9L,8L,4L)),tf.newTuple(ImmutableList.of(29L,11L,15L,9L,25L,24L,9L,7L,4L)),tf.newTuple(ImmutableList.of(30L,12L,23L,17L,25L,23L,9L,4L,4L)));
  verifyExpected(data.get("result"),expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankWithSplitInMap() throws Exception {
  String query="R1 = LOAD 'testsplit' USING mock.Storage() AS (a:int,b:int);" + "R2 = rank R1 by a ;" + "R3 = rank R1 ;"+ "R4 = union R2, R3;"+ "store R4 into 'R4' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,1,2)","(2L,1,2)","(3L,3,1)","(4L,2,4)","(5L,2,3)","(1L,1,2)","(1L,1,2)","(3L,2,3)","(3L,2,4)","(5L,3,1)"});
  Util.checkQueryOutputsAfterSort(data.get("R4"),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankEmptyRelation() throws Exception {
  String query="DATA = LOAD 'empty' USING mock.Storage();" + "A = rank DATA;" + "store A into 'empty_result' using mock.Storage();";
  Util.registerMultiLineQuery(pigServer,query);
  Multiset<Tuple> expected=ImmutableMultiset.of();
  verifyExpected(data.get("empty_result"),expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegisterParser </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testIllegalUriException() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("ivy:||org:mod:ver",null,null);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException3() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("test.jar","jython",null);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException2() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("ivy://org:mod:ver","jython","myfunc");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException1() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("test.jar","jython","myfunc");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegisteredJarVisibility </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegisteredJarVisibilityLocal() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),new Properties());
  testRegisteredJarVisibility(pigServer,INPUT_FILE.getAbsolutePath());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegisterJarVisibilityMR() throws IOException {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  testRegisteredJarVisibility(pigServer,INPUT_FILE.getAbsolutePath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: multiple fields for a bag
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY),new ResourceFieldSchema().setName("fld1").setType(DataType.DOUBLE),new ResourceFieldSchema().setName("fld2").setType(DataType.INTEGER)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: bag without tuple field
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema2() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSample </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_VariableAll() throws Exception {
  verify("a = LOAD '" + Util.encodeEscape(tmpfilepath) + "'; "+ "b = GROUP a all;"+ "c = FOREACH b GENERATE COUNT(a) AS count;"+ "myid = SAMPLE a 1.0 * (c.count / c.count) PARALLEL 2;",DATALEN,DATALEN);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_VariableSome() throws Exception {
  verify("a = LOAD '" + Util.encodeEscape(tmpfilepath) + "'; "+ "b = GROUP a all;"+ "c = FOREACH b GENERATE COUNT(a) AS count;"+ "myid = SAMPLE a (c.count / (2.0 * c.count) );",DATALEN / 3,DATALEN * 2 / 3);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_Some() throws Exception {
  verify("myid = sample (load '" + Util.encodeEscape(tmpfilepath) + "') 0.5;",DATALEN / 3,DATALEN * 2 / 3);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSampleScalarException() throws IOException {
  String query="a = load '" + Util.encodeEscape(tmpfilepath) + "';"+ "b = sample a $0;";
  Util.registerMultiLineQuery(pig,query);
  try {
    pig.openIterator("b");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,ScalarVariableValidator.ERR_MSG_SCALAR);
    throw fe;
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_None() throws Exception {
  verify("myid = sample (load '" + Util.encodeEscape(tmpfilepath) + "') 0.0;",0,0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_All() throws Exception {
  verify("myid = sample (load '" + Util.encodeEscape(tmpfilepath) + "') 1.0;",DATALEN,DATALEN);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSample_VariableNone() throws Exception {
  verify("a = LOAD '" + Util.encodeEscape(tmpfilepath) + "'; "+ "b = GROUP a all;"+ "c = FOREACH b GENERATE COUNT(a) AS count;"+ "myid = SAMPLE a (c.count - c.count);",0,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliasesLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarAliasesJoinClause() throws Exception {
  String[] inputA={"1\t5","2\t10","3\t20"};
  String[] inputB={"Total3\tthree","Total2\ttwo","Total1\tone"};
  String inputPathA=BUILD_TEST_TMP + "table_testScalarAliasesJoinClauseA";
  TestScalarAliases.createLocalInputFile(inputPathA,inputA);
  String inputPathB=BUILD_TEST_TMP + "table_testScalarAliasesJoinClauseB";
  TestScalarAliases.createLocalInputFile(inputPathB,inputB);
  pigServer.registerQuery("A = LOAD '" + inputPathA + "' as (a0, a1);");
  pigServer.registerQuery("G = group A all;");
  pigServer.registerQuery("C = foreach G generate COUNT(A) as count;");
  pigServer.registerQuery("B = LOAD '" + inputPathB + "' as (b0:chararray, b1:chararray);");
  pigServer.registerQuery("Y = join A by CONCAT('Total', (chararray)C.count), B by $0;");
  Iterator<Tuple> iter=pigServer.openIterator("Y");
  String[] expected=new String[]{"(1,5,Total3,three)","(2,10,Total3,three)","(3,20,Total3,three)"};
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(pigServer.dumpSchema("Y")));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarNullValue() throws Exception {
  Storage.Data data=Storage.resetData(pigServer);
  data.set("input",Storage.tuple("a",1),Storage.tuple("b",2));
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load 'input' using mock.Storage() as (a:chararray, b:int);");
  pigServer.registerQuery("B = FILTER A by a == 'c';");
  pigServer.registerQuery("C = FOREACH A generate a, b + B.b;");
  pigServer.registerQuery("store C into 'output' using mock.Storage();");
  pigServer.executeBatch();
  List<Tuple> actualResults=data.get("output");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('a', null)","('b', null)"});
  Util.checkQueryOutputsAfterSort(actualResults.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that a specific string is included in the error message when an
 * exception is thrown for using a relation in a
 * scalar context without projecting any columns out of it
 */
@Test public void testScalarWithNoProjection() throws Exception {
  String query="  A = load 'table_testScalarWithNoProjection' as (x, y);" + "  B = group A by x;" + "  C = foreach B generate COUNT(B);";
  Util.checkExceptionMessage(query,"C","A column needs to be projected from a relation" + " for it to be used as a scalar");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=SchemaMergeException.class) public void testMergeDifferentSize2() throws Throwable {
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  list2.add(new FieldSchema("2d",DataType.MAP));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptLanguage </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void fsTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","ret = Pig.fs(\"-rmr simple_out\")","if ret == 0:","\tprint 'success!'","else:","\traise 'fs command failed'"};
  runPigRunner("fsTest",script,false);
}

</code></pre>

<br>
<pre class="type-20 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateInScript() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ. See PIG-3993",Util.isMapredExecType(cluster.getExecType()));
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'testIllustrateInScript_table'","output = 'simple_out'","P = Pig.compileFromFile(\"\"\"testIllustrateInScript.pig\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\tprint 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  String[] pigLatin={"a = load '$input' as (a0:int,a1:int);","store a into '$output';","illustrate a"};
  Util.createInputFile(cluster,"testIllustrateInScript_table",input);
  Util.createLocalInputFile("testIllustrateInScript.pig",pigLatin);
  runSimpleScript("testIllustrateInScript",script);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDumpInScript() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'testDumpInScript_table'","output = 'simple_out'","P = Pig.compileFromFile(\"\"\"testDumpInScript.pig\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\tprint 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  String[] pigLatin={"a = load '$input' as (a0:int,a1:int);","store a into '$output';","dump a"};
  Util.createInputFile(cluster,"testDumpInScript_table",input);
  Util.createLocalInputFile("testDumpInScript.pig",pigLatin);
  runSimpleScript("testDumpInScript",script);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptUDF </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPythonNestedImportClassPath() throws Exception {
  testPythonNestedImport("build/classes","scriptC.py","scriptD.py");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * See Pig-1824, PIG-2433
 * test importing a second module/file from the local fs from within
 * the first module.
 * to use a jython install, the Lib dir must be in the jython search path
 * via env variable JYTHON_HOME=jy_home or JYTHONPATH=jy_home/Lib:... or
 * jython-standalone.jar should be in the classpath
 * Left in for now as we don't have paths to include other scripts in a
 * script in the e2e harness.
 * @throws Exception
 */
@Test public void testPythonNestedImportCwdInClassPath() throws Exception {
  testPythonNestedImport(".","scriptA.py","scriptB.py");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSecondarySort </h4><pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testForEachTwoInput() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  String expected[]={"((1,2),{(2,3),(2,4),(2,4),(2,4)})","((1,3),{(3,4)})","((2,3),{(3,4)})"};
  String clusterFilePath=Util.removeColon(tmpFile1.getCanonicalPath());
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),clusterFilePath);
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterFilePath) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by (a0, a1);");
  pigServer.registerQuery("C = foreach B { C1 = A.(a1,a2); generate group, C1;};");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Schema s=pigServer.dumpSchema("C");
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(s));
  Util.deleteFile(cluster,clusterFilePath);
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedSortEndToEnd1() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  String expected[]={"(2,{(2,3,4)})","(1,{(1,2,3),(1,2,4),(1,2,4),(1,2,4),(1,3,4)})"};
  String clusterPath=Util.removeColon(tmpFile1.getCanonicalPath());
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),clusterPath);
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterPath) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by $0 parallel 2;");
  pigServer.registerQuery("C = foreach B { D = limit A 10; E = order D by $1; generate group, E;};");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Schema s=pigServer.dumpSchema("C");
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(s));
  Util.deleteFile(cluster,clusterPath);
}

</code></pre>

<br>
<pre class="type-18 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNestedSortEndToEnd2() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t4\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t8\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  String expected[]={"(2,{(2,3,4)})","(1,{(1,8,4),(1,4,4),(1,3,4),(1,2,3),(1,2,4)})"};
  String clusterPath=Util.removeColon(tmpFile1.getCanonicalPath());
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),clusterPath);
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterPath) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by $0 parallel 2;");
  pigServer.registerQuery("C = foreach B { D = order A by a1 desc; generate group, D;};");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Schema s=pigServer.dumpSchema("C");
  Util.checkQueryOutputsAfterSortRecursive(iter,expected,org.apache.pig.newplan.logical.Util.translateSchema(s));
  Util.deleteFile(cluster,clusterPath);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestShortcuts </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is defined, exception is expected
 * @throws Throwable
 */
@Test(expected=ParseException.class) public void testIllustrateShortcutNoAliasDefined() throws Throwable {
  String cmd="\\i";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is defined earlier, empty output is expected. Note that
 * ParseException is thrown in interactive mode.
 * @throws Throwable
 */
@Test public void testExplainShortcutNoAliasDefined() throws Throwable {
  String cmd="\\e";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is passed, last alias should be illustrated
 * @throws Throwable
 */
@Test public void testIllustrateShortcutNoAlias() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = group a by $0;" + "\\i";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is passed, last alias should be dumped
 * @throws Throwable
 */
@Test public void testDumpShortcutNoAlias() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\d;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainShortcut() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\e b;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateShortcut() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = group a by $0;" + "\\i b;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateWithPreviousRelation() throws Throwable {
  String cmd="=> load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "illustrate @;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDumpShortcut() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\d b;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is define, then exception is expected
 * @throws Throwable
 */
@Test(expected=IOException.class) public void testDescribeShortcutNoAliasDefined() throws Throwable {
  String cmd="\\de";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainShortcutScript() throws Throwable {
  String cmd="\\e -script " + basedir + "/explainScript.pig;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDescribeShortcut() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\de b;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is defined, exception is expected
 * @throws Throwable
 */
@Test(expected=IOException.class) public void testDumpShortcutNoAliasDefined() throws Throwable {
  String cmd="\\d";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is passed, entire script should be explained
 * @throws Throwable
 */
@Test public void testExplainShortcutNoAlias() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\e;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExplainWithPreviousRelation() throws Throwable {
  String cmd="=> load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "explain @;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is passed, last alias should be described
 * @throws Throwable
 */
@Test public void testDescribeShortcutNoAlias() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = foreach a generate $0 as foo;" + "\\de;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIllustrateShortcutScript() throws Throwable {
  String cmd="\\i -script " + basedir + "/illustrate.pig;";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testQuit() throws Throwable {
  String cmd="a = load 'input' USING mock.Storage() as (x:chararray,y:chararray,z:long);" + "b = group a by $0;" + "\\q";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSkewedJoin </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinUDF() throws IOException {
  PartitionSkewedKeys udf=new PartitionSkewedKeys(new String[]{"0.1","2","1.txt"});
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(3);
  DataBag db=new DefaultDataBag();
  Tuple sample;
  for (int i=0; i <= 3; i++) {
    sample=TupleFactory.getInstance().newTuple();
    if (i != 3)     sample.append("1");
 else     sample.append("2");
    sample.append((long)200);
    if (i != 3)     sample.append((long)0);
 else     sample.append((long)30);
    db.add(sample);
  }
  t.append(db);
  Map<String,Object> output=udf.exec(t);
  DataBag parList=(DataBag)output.get(PartitionSkewedKeys.PARTITION_LIST);
  for (  Tuple par : parList) {
    if (par.get(0).equals("1")) {
      par.get(1).equals(0);
      par.get(2).equals(2);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinReducers() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = join A by id, B by id using 'skewed' parallel 1;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    dbfrj.add(iter.next());
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSkewedJoin3Way() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
  pigServer.registerQuery("C = LOAD '" + INPUT_FILE3 + "' as (id, name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("D = join A by id, B by id, C by id using 'skewed' parallel 5;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext())   dbfrj.add(iter.next());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinMapKey() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE4 + "' as (m:[]);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE4 + "' as (n:[]);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = join A by (chararray)m#'a100', B by (chararray)n#'a100' using 'skewed' parallel 20;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    dbfrj.add(iter.next());
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinOuter() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE5 + "' as (id,name);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' as (id,name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by id left, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by id right, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by id full, B by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplit </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSplitNondeterministic() throws IOException {
  String query="a = load '" + Util.encodeEscape(file.getAbsolutePath()) + "' as (id:int);"+ "split a into b if RANDOM() < 0.5, d otherwise;";
  try {
    Util.registerMultiLineQuery(pig,query);
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Can not use Otherwise in Split with an expression containing a @Nondeterministic UDF");
    throw fe;
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitMacro() throws IOException {
  String query="define split_into_two (A,key) returns B, C {" + "    SPLIT $A INTO $B IF $key<4, $C OTHERWISE;" + "};"+ "a = load '" + Util.encodeEscape(file.getAbsolutePath()) + "' as (id:int);"+ "B, C = split_into_two(a, id);";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("B");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1)","(2)","(3)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
  it=pig.openIterator("C");
  expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(4)","(5)","(6)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplit1() throws IOException {
  String query="a = load '" + Util.encodeEscape(file.getAbsolutePath()) + "' as (id:int);"+ "split a into b if id > 3, c if id < 3, d otherwise;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("d");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(3)"});
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplit2() throws IOException {
  String query="a = load '" + Util.encodeEscape(file.getAbsolutePath()) + "' as (id:int);"+ "split a into b if id % 2 == 0, d otherwise;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("d");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1)","(3)","(5)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplitStore </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test8() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.registerQuery("Store A1 into '" + FileLocalizer.getTemporaryPath(pigContext) + "';");
  pig.openIterator("A2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test7() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.openIterator("A2");
  pig.registerQuery("Store A1 into '" + FileLocalizer.getTemporaryPath(pigContext) + "';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test1() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.store("A1","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
  pig.store("A2","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test9() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.registerQuery("Store A2 into '" + FileLocalizer.getTemporaryPath(pigContext) + "';");
  pig.openIterator("A1");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test4() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.store("A1","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
  pig.openIterator("A2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test3() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.openIterator("A2");
  pig.store("A1","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test2() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.openIterator("A1");
  pig.store("A2","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test6() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.openIterator("A1");
  pig.registerQuery("Store A2 into '" + FileLocalizer.getTemporaryPath(pigContext) + "';");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test5() throws Exception {
  pig.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pig.getPigContext()) + "';");
  pig.registerQuery("Split A into A1 if $0<=10, A2 if $0>10;");
  pig.store("A2","'" + FileLocalizer.getTemporaryPath(pigContext) + "'");
  pig.openIterator("A1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStore </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteRelScheme() throws Exception {
  checkStorePath("test","/tmp/test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteRel() throws Exception {
  checkStorePath("test","/tmp/test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteNormalize() throws Exception {
  checkStorePath("/tmp/foo/../././","/tmp/foo/.././.");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteAbsAuth() throws Exception {
  checkStorePath("hdfs://localhost:9000/test","/test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteAbsScheme() throws Exception {
  checkStorePath("hdfs:/tmp/test","hdfs:/tmp/test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreRemoteAbs() throws Exception {
  checkStorePath("/tmp/test","/tmp/test");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreaming </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreamingWithUnixPipes() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","B","C","D","A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{1,2,3,2,5,5,8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("define CMD `" + simpleEchoStreamingCommand + " | "+ simpleEchoStreamingCommand+ "`;");
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream IP through CMD as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream IP through CMD;");
    }
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputShipSpecs() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(OUTFILE, \">\", $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","open(OUTFILE2, \">\", $ARGV[1]) or die \"Can't open \".$ARGV[1].\"!: $!\";","while (<STDIN>) {","  print OUTFILE \"$_\n\";","  print STDERR \"STDERR: $_\n\";","  print OUTFILE2 \"A,10\n\";","}"};
  File command=Util.createInputFile("script","pl",script);
  String[] expectedFirstFields=new String[]{"A","A","A","A","A","A"};
  Integer[] expectedSecondFields=new Integer[]{10,10,10,10,10,10};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define CMD `perl " + command.getName() + " foo bar` "+ "ship ('"+ Util.encodeEscape(command.toString())+ "') "+ "output('foo' using "+ PigStreaming.class.getName()+ "(','), "+ "'bar' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("OP = stream FILTERED_DATA through CMD;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "/bar"+ "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleOrderedReduceSideStreamingAfterFlatten() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1,2,3","B,2,4,5","C,3,1,2","D,2,5,2","A,5,5,1","B,5,7,4","C,8,9,2","A,8,4,5","D,8,8,3","A,9,2,5"});
  String[] expectedFirstFields=new String[]{"A","A","A","A","B","B","C","C","D","D"};
  Integer[] expectedSecondFields=new Integer[]{1,9,8,5,2,5,3,8,2,8};
  Integer[] expectedThirdFields=new Integer[]{2,2,4,5,4,7,1,9,5,8};
  Integer[] expectedFourthFields=new Integer[]{3,5,5,1,5,4,2,2,2,3};
  Tuple[] expectedResults=new Tuple[10];
  for (int i=0; i < expectedResults.length; ++i) {
    expectedResults[i]=tf.newTuple(4);
    expectedResults[i].set(0,expectedFirstFields[i]);
    expectedResults[i].set(1,expectedSecondFields[i]);
    expectedResults[i].set(2,expectedThirdFields[i]);
    expectedResults[i].set(3,expectedFourthFields[i]);
  }
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
  pigServer.registerQuery("S1 = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("S2 = stream S1 through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("GROUPED_DATA = group IP by $0;");
  pigServer.registerQuery("ORDERED_DATA = foreach GROUPED_DATA { " + "  D = order IP BY $2, $3;" + "  generate flatten(D);"+ "};");
  pigServer.registerQuery("S3 = stream ORDERED_DATA through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("OP = stream S3 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int, f2:int, f3:int);");
  Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreamingWithOutputSchema() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  Object[] expectedFirstFields=new String[]{"C","A","D","A"};
  Object[] expectedSecondFields=new Integer[]{8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    if (withTypes[i] == true) {
      pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "` as (f0, f1);");
    }
    pigServer.registerQuery("OP = filter STREAMED_DATA by f1 > 6;");
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputCacheSpecs() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command1=Util.createInputFile("script","pl",script);
  File command2=Util.createInputFile("script","pl",script);
  String c1=FileLocalizer.hadoopify(command1.toString(),pigServer.getPigContext());
  String c2=FileLocalizer.hadoopify(command2.toString(),pigServer.getPigContext());
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define CMD1 `perl script1.pl foo` " + "cache ('" + c1 + "#script1.pl') "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("define CMD2 `perl script2.pl bar` " + "cache ('" + c2 + "#script2.pl') "+ "input('bar' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA " + "through CMD1;");
  pigServer.registerQuery("OP = stream STREAMED_DATA through CMD2;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputShipSpecsWithUDFDefine() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(OUTFILE, \">\", $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","open(OUTFILE2, \">\", $ARGV[1]) or die \"Can't open \".$ARGV[1].\"!: $!\";","while (<STDIN>) {","  print OUTFILE \"$_\n\";","  print STDERR \"STDERR: $_\n\";","  print OUTFILE2 \"A,10\n\";","}"};
  File command=Util.createInputFile("script","pl",script);
  String[] expectedFirstFields=new String[]{"A","A","A","A","A","A"};
  Integer[] expectedSecondFields=new Integer[]{10,10,10,10,10,10};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define PS " + PigStreaming.class.getName() + "(',');");
  pigServer.registerQuery("define CMD `perl " + command.getName() + " foo bar` "+ "ship ('"+ Util.encodeEscape(command.toString())+ "') "+ "output('foo' using PS, "+ "'bar' using PS) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("OP = stream FILTERED_DATA through CMD;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "/bar"+ "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputShipSpecs() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command1=Util.createInputFile("script","pl",script);
  File command2=new File(testDataDir,"testInputShipSpecs.pl");
  Util.writeToFile(command2,script);
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define CMD1 `perl " + command1.getName() + " foo` "+ "ship ('"+ Util.encodeEscape(command1.toString())+ "') "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "output(stdout using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("define CMD2 `perl " + command2.getName() + " bar` "+ "ship ('"+ Util.encodeEscape(command2.toString())+ "') "+ "input('bar' using "+ PigStreaming.class.getName()+ "(',')) "+ "output(stdout using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA " + "through CMD1;");
  pigServer.registerQuery("OP = stream STREAMED_DATA through CMD2;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNegativeLoadStoreOptimization() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("define CMD `" + simpleEchoStreamingCommand + "` input(stdin using "+ PigStreamDump.class.getName()+ ");");
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "`;");
    }
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleReduceSideStreamingAfterFlatten() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","A","A","B","C","D"};
  Integer[] expectedSecondFields=new Integer[]{5,8,9,5,8,8};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    pigServer.registerQuery("GROUPED_DATA = group FILTERED_DATA by $0;");
    pigServer.registerQuery("FLATTENED_GROUPED_DATA = foreach GROUPED_DATA " + "generate flatten($1);");
    pigServer.registerQuery("S1 = stream FLATTENED_GROUPED_DATA through `" + simpleEchoStreamingCommand + "`;");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "`;");
    }
    Util.checkQueryOutputsAfterSort(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreaming() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    pigServer.registerQuery("S1 = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "`;");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "`;");
    }
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputShipSpecsWithUDFDefine() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command1=Util.createInputFile("script","pl",script);
  File command2=Util.createInputFile("script","pl",script);
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define PS " + PigStreaming.class.getName() + "(',');");
  pigServer.registerQuery("define CMD1 `perl " + command1.getName() + " foo` "+ "ship ('"+ Util.encodeEscape(command1.toString())+ "') "+ "input('foo' using PS )"+ "output(stdout using PS ) "+ "stderr();");
  pigServer.registerQuery("define CMD2 `perl " + command2.getName() + " bar` "+ "ship ('"+ Util.encodeEscape(command2.toString())+ "') "+ "input('bar' using PS ) "+ "output(stdout using PS ) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA " + "through CMD1;");
  pigServer.registerQuery("OP = stream STREAMED_DATA through CMD2;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * PIG-2973: Verify that JobConf is added to environment even when input to
 * the streaming binary is asynchronous (i.e. it is from a file).
 */
@Test public void testAddJobConfToEnvironmentWithASynchInput() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A"});
  Random rand=new Random();
  final int ENV_VAR_VALUE=rand.nextInt();
  final String ENV_VAR_NAME="MY_RANDOM_NUMBER";
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE, $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_,$ENV{'" + ENV_VAR_NAME + "'}\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command=Util.createInputFile("script","pl",script);
  String[] expectedFirstFields=new String[]{"A"};
  Integer[] expectedSecondFields=new Integer[]{ENV_VAR_VALUE};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.getPigContext().getProperties().setProperty(PIG_STREAMING_ENVIRONMENT,ENV_VAR_NAME);
  pigServer.getPigContext().getProperties().setProperty(ENV_VAR_NAME,Integer.toString(ENV_VAR_VALUE));
  pigServer.registerQuery("define CMD `perl " + command.getName() + " foo` "+ "ship ('"+ Util.encodeEscape(command.toString())+ "') "+ "input('foo' using "+ PigStreaming.class.getName()+ "()) "+ "output(stdout using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using PigStorage();");
  pigServer.registerQuery("STREAMED_DATA = stream IP through CMD;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("STREAMED_DATA",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputOutputSpecs() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","open(OUTFILE, \">\", $ARGV[1]) or die \"Can't open \".$ARGV[1].\"!: $!\";","open(OUTFILE2, \">\", $ARGV[2]) or die \"Can't open \".$ARGV[2].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print OUTFILE \"$_\n\";","  print STDERR \"STDERR: $_\n\";","  print OUTFILE2 \"$_\n\";","}"};
  File command=Util.createInputFile("script","pl",script);
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  Tuple[] expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
  pigServer.registerQuery("define CMD `perl " + command.getName() + " foo bar foobar` "+ "ship ('"+ Util.encodeEscape(command.toString())+ "') "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "output('bar', "+ "'foobar' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();");
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > 3;");
  pigServer.registerQuery("OP = stream FILTERED_DATA through CMD;");
  String output="/pig/out";
  pigServer.deleteFile(output);
  pigServer.store("OP",output,PigStorage.class.getName() + "(',')");
  pigServer.registerQuery("A = load '" + output + "/foobar"+ "' using PigStorage(',');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  List<Tuple> outputs=new ArrayList<Tuple>();
  while (iter.hasNext()) {
    outputs.add(iter.next());
  }
  Util.checkQueryOutputs(outputs.iterator(),expectedResults);
  pigServer.deleteFile(output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreamingLocal </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreaming() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{5,5,8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    pigServer.registerQuery("S1 = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "`;");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "`;");
    }
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreamingWithOutputSchema() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  Object[] expectedFirstFields=new String[]{"C","A","D","A"};
  Object[] expectedSecondFields=new Integer[]{8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    if (withTypes[i] == true) {
      pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("STREAMED_DATA = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "` as (f0, f1);");
    }
    pigServer.registerQuery("OP = filter STREAMED_DATA by f1 > 6;");
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLocalNegativeLoadStoreOptimization() throws Exception {
  testNegativeLoadStoreOptimization(Util.getLocalTestMode());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleReduceSideStreamingAfterFlatten() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","A","A","B","C","D"};
  Integer[] expectedSecondFields=new Integer[]{5,8,9,5,8,8};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
    pigServer.registerQuery("GROUPED_DATA = group FILTERED_DATA by $0;");
    pigServer.registerQuery("FLATTENED_GROUPED_DATA = foreach GROUPED_DATA " + "generate flatten($1);");
    pigServer.registerQuery("S1 = stream FLATTENED_GROUPED_DATA through `" + simpleEchoStreamingCommand + "`;");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream S1 through `" + simpleEchoStreamingCommand + "`;");
    }
    Util.checkQueryOutputsAfterSort(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleOrderedReduceSideStreamingAfterFlatten() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1,2,3","B,2,4,5","C,3,1,2","D,2,5,2","A,5,5,1","B,5,7,4","C,8,9,2","A,8,4,5","D,8,8,3","A,9,2,5"});
  String[] expectedFirstFields=new String[]{"A","A","A","A","B","B","C","C","D","D"};
  Integer[] expectedSecondFields=new Integer[]{1,9,8,5,2,5,3,8,2,8};
  Integer[] expectedThirdFields=new Integer[]{2,2,4,5,4,7,1,9,5,8};
  Integer[] expectedFourthFields=new Integer[]{3,5,5,1,5,4,2,2,2,3};
  Tuple[] expectedResults=new Tuple[10];
  for (int i=0; i < expectedResults.length; ++i) {
    expectedResults[i]=tf.newTuple(4);
    expectedResults[i].set(0,expectedFirstFields[i]);
    expectedResults[i].set(1,expectedSecondFields[i]);
    expectedResults[i].set(2,expectedThirdFields[i]);
    expectedResults[i].set(3,expectedFourthFields[i]);
  }
  pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
  pigServer.registerQuery("FILTERED_DATA = filter IP by $1 > '3';");
  pigServer.registerQuery("S1 = stream FILTERED_DATA through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("S2 = stream S1 through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("GROUPED_DATA = group IP by $0;");
  pigServer.registerQuery("ORDERED_DATA = foreach GROUPED_DATA { " + "  D = order IP BY $2, $3;" + "  generate flatten(D);"+ "};");
  pigServer.registerQuery("S3 = stream ORDERED_DATA through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("OP = stream S3 through `" + simpleEchoStreamingCommand + "` as (f0:chararray, f1:int, f2:int, f3:int);");
  Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleMapSideStreamingWithUnixPipes() throws Exception {
  File input=Util.createInputFile("tmp","",new String[]{"A,1","B,2","C,3","D,2","A,5","B,5","C,8","A,8","D,8","A,9"});
  String[] expectedFirstFields=new String[]{"A","B","C","D","A","B","C","A","D","A"};
  Integer[] expectedSecondFields=new Integer[]{1,2,3,2,5,5,8,8,8,9};
  boolean[] withTypes={true,false};
  for (int i=0; i < withTypes.length; i++) {
    Tuple[] expectedResults=null;
    if (withTypes[i] == true) {
      expectedResults=setupExpectedResults(expectedFirstFields,expectedSecondFields);
    }
 else {
      expectedResults=setupExpectedResults(Util.toDataByteArrays(expectedFirstFields),Util.toDataByteArrays(expectedSecondFields));
    }
    pigServer.registerQuery("define CMD `" + simpleEchoStreamingCommand + " | "+ simpleEchoStreamingCommand+ "`;");
    pigServer.registerQuery("IP = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',');");
    if (withTypes[i] == true) {
      pigServer.registerQuery("OP = stream IP through CMD as (f0:chararray, f1:int);");
    }
 else {
      pigServer.registerQuery("OP = stream IP through CMD;");
    }
    Util.checkQueryOutputs(pigServer.openIterator("OP"),expectedResults);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplicitSplitSeqFile() throws Exception {
  resetLog(SequenceFileInterStorage.class);
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_ENABLE_TEMP_FILE_COMPRESSION,"true");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_STORAGE,"seqfile");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_CODEC,"bzip2");
  testImplicitSplit(SequenceFileInterStorage.useLog);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplicitSplitInCoGroupTFile() throws Exception {
  resetLog(TFileStorage.class);
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_ENABLE_TEMP_FILE_COMPRESSION,"true");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_CODEC,"gz");
  testImplicitSplitInCoGroup(TFileStorage.useLog);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplicitSplitTFile() throws Exception {
  resetLog(TFileStorage.class);
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_ENABLE_TEMP_FILE_COMPRESSION,"true");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_CODEC,"gz");
  testImplicitSplit(TFileStorage.useLog);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplicitSplitInCoGroupSeqFile() throws Exception {
  resetLog(SequenceFileInterStorage.class);
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_ENABLE_TEMP_FILE_COMPRESSION,"true");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_STORAGE,"seqfile");
  pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_TEMP_FILE_COMPRESSION_CODEC,"bzip2");
  testImplicitSplitInCoGroup(SequenceFileInterStorage.useLog);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineageStar() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (name, age, gpa);" + "b = group a by *;" + "c = foreach b generate flatten(group);"+ "d = foreach c generate $0 + 1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupProjectStarLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate *;"+ "f = foreach d generate group, flatten(a), flatten(b) ;"+ "g = foreach f generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageNoSchemaDiffLoadFunc() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = union a , b;"+ "d = foreach c generate $1 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupLineageFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate group + 1, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,0);
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapLookupLineage3() throws Throwable {
  String query="a= load 'a' as (s, m, l);" + "b = foreach a generate flatten(l#'viewinfo') as viewinfo;" + "c = foreach b generate viewinfo#'pos' as position;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
  query+="d = foreach c generate (chararray)position;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using PigStorage('a');" + "c = join a by $0, b by $0;"+ "d = foreach c generate $1 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapCastLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1 : map[], field2: float );" + "b = foreach a generate (map[int])field1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test nested foreach with sort
 * @throws Throwable
 */
@Test public void testNestedSort() throws Throwable {
  String query="a = load 'x';" + "b = group a by $0;" + "c = foreach b "+ "       {c1 = order $1 by $1; generate $0 + 1, flatten(c1); };";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineageStarNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = group a by *;" + "c = foreach b generate flatten(group);"+ "d = foreach c generate $0 + 1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareEqualityMapIntegerFail() throws Throwable {
  String query="a = load 'a' as (t1 :map[], t2 : int);" + "b = filter a by t1 == t2;";
  String exMsg="In alias b, incompatible types in Equal " + "Operator left hand side:map right hand side:int";
  checkExceptionMessage(query,"b",exMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossLineageNoSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cross a , b;"+ "d = foreach c generate $1 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStreamingLineage1() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1: int, field2: float, field3: chararray );" + "b = stream a through `" + simpleEchoStreamingCommand + "`;"+ "c = foreach b generate $1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStreaming",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterWithInnerPlan3() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2",DataType.LONG));
    inputSchema1=new Schema(fsList1);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema((inputSchema1)));
  LogicalExpressionPlan innerPlan=new LogicalExpressionPlan();
  LOFilter filter1=new LOFilter(plan);
  filter1.setFilterPlan(innerPlan);
  ProjectExpression project1=new ProjectExpression(innerPlan,0,0,filter1);
  ProjectExpression project2=new ProjectExpression(innerPlan,0,1,filter1);
  AddExpression add1=new AddExpression(innerPlan,project1,project2);
  plan.add(load1);
  plan.add(filter1);
  plan.connect(load1,filter1);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  try {
    typeChecker.visit();
  }
 catch (  Exception t) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Expect error");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageDifferentSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray, field7 );" + "c = union a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupStreamingLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = stream a through `" + simpleEchoStreamingCommand + "` as (field4, field5, field6: chararray);"+ "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStreaming",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageMixSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('x') as (field1, field2: float, field3: chararray );" + "b = load 'a' using PigStorage('x');" + "c = union a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('x')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagDereference() throws FrontendException {
  String query="a= load '1.txt' as (a0);" + "b = foreach a generate flatten((bag{tuple(map[])})a0) as b0:map[];" + "c = foreach b generate (long)b0#'key1';";
  LogicalPlan plan=createAndProcessLPlan(query);
  checkLoaderInCasts(plan,PigStorage.class.getName());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupProjectStarLineageMixSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster();" + "c = cogroup a by field1, b by $0;"+ "d = foreach c generate *;"+ "f = foreach d generate group, flatten(a), flatten(b) ;"+ "g = foreach f generate $0, $1 + 1, $4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupDistinctLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = distinct d;"+ "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupStarLineageNoSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('x');" + "b = load 'b' using PigStorage('x');" + "c = cogroup a by *, b by *;";
  String exMsg="Cogroup/Group by '*' or 'x..' " + "(range of columns to the end) " + "is only allowed if the input has a schema";
  checkExceptionMessage(query,"c",exMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupLimitLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = limit d 100;"+ "f = foreach e generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupTopKLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by $2 desc;"+ "f = limit e 100;"+ "g = foreach f generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareMapFail() throws Throwable {
  String query="a = load 'a' as (t1 :map[], t2 : map[]);" + "b = filter a by t1 <= t2;";
  String exMsg="In alias b, incompatible types in LessThanEqual " + "Operator left hand side:map right hand side:map";
  checkExceptionMessage(query,"b",exMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSortStarLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by * desc;"+ "f = foreach e generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupLineage2NoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterWithInnerPlan2() throws Throwable {
  testFilterWithInnerPlan(DataType.INTEGER,DataType.BYTEARRAY);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupStreamingLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = stream a through `" + simpleEchoStreamingCommand + "`;"+ "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUDFNoInnerSchema() throws FrontendException {
  String query="a= load '1.txt';" + "b = foreach a generate " + TestUDFTupleNullInnerSchema.class.getName() + "($0);"+ "c = foreach b generate flatten($0);"+ "d = foreach c generate $0 + 1;";
  checkLastForeachCastLoadFunc(query,null,0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSortLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by $2 desc;"+ "f = foreach e generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExpressionTypeChecking9() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  TupleFactory tupleFactory=TupleFactory.getInstance();
  ArrayList innerObjList=new ArrayList();
  ArrayList objList=new ArrayList();
  innerObjList.add("10");
  innerObjList.add("3");
  innerObjList.add(7);
  innerObjList.add("17");
  Tuple innerTuple=tupleFactory.newTuple(innerObjList);
  objList.add("World");
  objList.add(42);
  objList.add(innerTuple);
  Tuple tuple=tupleFactory.newTuple(objList);
  ArrayList<Schema.FieldSchema> innerFss=new ArrayList<Schema.FieldSchema>();
  ArrayList<Schema.FieldSchema> fss=new ArrayList<Schema.FieldSchema>();
  ArrayList<Schema.FieldSchema> castFss=new ArrayList<Schema.FieldSchema>();
  Schema.FieldSchema stringFs=new Schema.FieldSchema(null,DataType.CHARARRAY);
  Schema.FieldSchema intFs=new Schema.FieldSchema(null,DataType.INTEGER);
  Schema.FieldSchema doubleFs=new Schema.FieldSchema(null,DataType.DOUBLE);
  innerFss.add(stringFs);
  innerFss.add(stringFs);
  innerFss.add(intFs);
  innerFss.add(stringFs);
  Schema innerTupleSchema=new Schema(innerFss);
  fss.add(stringFs);
  fss.add(intFs);
  fss.add(new Schema.FieldSchema(null,innerTupleSchema,DataType.TUPLE));
  Schema tupleSchema=new Schema(fss);
  castFss.add(stringFs);
  castFss.add(stringFs);
  castFss.add(doubleFs);
  castFss.add(intFs);
  Schema castSchema=new Schema(castFss);
  ConstantExpression constant1=new ConstantExpression(plan,innerTuple);
  ConstantExpression constant2=new ConstantExpression(plan,tuple);
  CastExpression cast1=new CastExpression(plan,constant1,org.apache.pig.newplan.logical.Util.translateFieldSchema(new FieldSchema(null,castSchema,DataType.TUPLE)));
  EqualExpression equal1=new EqualExpression(plan,cast1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  LogicalRelationalOperator dummyRelOp=createDummyRelOpWithAlias();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,dummyRelOp);
  expTypeChecker.visit();
  printMessageCollector(collector);
  if (collector.hasError()) {
    throw new Exception("Error expected");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCoGroupComplex() throws Exception {
  String query="l1 = load 'x' using PigStorage(':') as (a : (i : int),b,c);" + "l2 = load 'x' as (a,b,c);" + "cg = cogroup l1 by a, l2 by a;";
  createAndProcessLPlan(query);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageMixSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = union a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitLineage1NoSchema() throws Throwable {
  String query="a = load 'a';" + "split a into b if $0 > 1.0, c if $1 <= 1.0;" + "d = foreach b generate $1 + 1.0;"+ "e = foreach c generate $1 + 1.0;";
  LogicalPlan plan=createAndProcessLPlan(query);
  checkLoaderInCasts(plan,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TypeCheckerException.class) public void testRegexTypeChecking3() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,"Regex");
  RegexExpression regex=new RegexExpression(plan,constant1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  expTypeChecker.visit();
  printMessageCollector(collector);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTupleCastLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1 : tuple(i), field2: float);" + "b = foreach a generate (tuple(int))field1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSortLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by field4 desc;"+ "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a'  using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitLineage() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "split a into b if field1 > 1.0, c if field1 <= 1.0;";
  checkSplitLineage(query,"org.apache.pig.builtin.PigStorage","org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = group a by $0;" + "c = foreach b generate flatten(a);"+ "d = foreach c generate $0 + 1.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterWithInnerPlan1() throws Throwable {
  testFilterWithInnerPlan(DataType.INTEGER,DataType.LONG);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitLineageNoSchema() throws Throwable {
  String query="a = load 'a';" + "b = limit a 100;" + "c = foreach b generate $1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupLimitLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = limit d 100;"+ "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testColumnWithinNonTupleBag() throws IOException {
{
    String query=" l = load 'x' as (i : int);" + " f = foreach l generate i.$0; ";
    Util.checkExceptionMessage(query,"f","Referring to column(s) within a column of type " + "int is not allowed");
  }
{
    String query=" l = load 'x' as (i : map[]);" + " f = foreach l generate i.$0; ";
    Util.checkExceptionMessage(query,"f","Referring to column(s) within a column of type " + "map is not allowed");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterLineage() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = filter a by field1 > 1.0;";
  checkLastFilterCast(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLineageExpressionCasting() throws FrontendException {
  String query="A= LOAD 'data1' USING PigStorage() AS (u:int, v);" + "B = FILTER A by u < 50;" + "C = FOREACH B generate u + v;";
  LogicalPlan plan=createAndProcessLPlan(query);
  checkLoaderInCasts(plan,"PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapLookupLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = foreach a generate $0#'key1';" + "c = foreach b generate $0#'key2';";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
  query+="d = foreach c generate $0 + 1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupMapLookupLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = foreach d generate group, field1#'key' + 1, field4 + 2.0 ;";
  LogicalPlan plan=createAndProcessLPlan(query);
  LOForEach foreach=(LOForEach)plan.getSinks().get(0);
  LogicalExpressionPlan foreachPlan=((LOGenerate)foreach.getInnerPlan().getSinks().get(0)).getOutputPlans().get(1);
  LogicalExpression exOp=(LogicalExpression)foreachPlan.getSinks().get(0);
  if (!(exOp instanceof ProjectExpression))   exOp=(LogicalExpression)foreachPlan.getSinks().get(1);
  CastExpression cast1=(CastExpression)foreachPlan.getPredecessors(exOp).get(0);
  MapLookupExpression map=(MapLookupExpression)foreachPlan.getPredecessors(cast1).get(0);
  checkCastLoadFunc(cast1,"PigStorage('a')");
  CastExpression cast2=(CastExpression)foreachPlan.getPredecessors(map).get(0);
  checkCastLoadFunc(cast1,"PigStorage('a')");
  foreachPlan=((LOGenerate)foreach.getInnerPlan().getSinks().get(0)).getOutputPlans().get(2);
  exOp=(LogicalExpression)foreachPlan.getSinks().get(0);
  if (!(exOp instanceof ProjectExpression))   exOp=(LogicalExpression)foreachPlan.getSinks().get(1);
  CastExpression cast=(CastExpression)foreachPlan.getPredecessors(exOp).get(0);
  checkCastLoadFunc(cast,"org.apache.pig.test.PigStorageWithDifferentCaster('b')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortLineageNoSchema() throws Throwable {
  String query="a = load 'a';" + "b = order a by $1;" + "c = foreach b generate $1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterLineage1() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = filter a by field2 > 1.0;" + "c = foreach b generate field1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test various scenarios with two level map lookup
 */
@Test public void testTwolevelMapLookupLineage() throws Exception {
  List<String[]> queries=new ArrayList<String[]>();
  queries.add(new String[]{"sds = LOAD '/my/data/location' " + "AS (simpleFields:map[], mapFields:map[], listMapFields:map[]);","queries = FILTER sds BY mapFields#'page_params'#'query' " + "is NOT NULL;","queries_rand = FOREACH queries GENERATE " + "(CHARARRAY) (mapFields#'page_params'#'query') AS query_string;","queries_limit = LIMIT queries_rand 100;","STORE queries_limit INTO 'out';"});
  queries.add(new String[]{"sds = LOAD '/my/data/location'  " + "AS (simpleFields:map[], mapFields:map[], listMapFields:map[]);","queries_rand = FOREACH sds GENERATE " + "(CHARARRAY) (mapFields#'page_params'#'query') AS query_string;","queries = FILTER queries_rand BY query_string IS NOT null;","queries_limit = LIMIT queries 100;","STORE queries_limit INTO 'out';"});
  queries.add(new String[]{"sds = LOAD '/my/data/location'  " + "AS (simpleFields:map[], mapFields:map[], listMapFields:map[]);","params = FOREACH sds GENERATE " + "(map[]) (mapFields#'page_params') AS params;","queries = FOREACH params " + "GENERATE (CHARARRAY) (params#'query') AS query_string;","queries_filtered = FILTER queries BY query_string IS NOT null;","queries_limit = LIMIT queries_filtered 100;","STORE queries_limit INTO 'out';"});
  queries.add(new String[]{"sds = LOAD '/my/data/location'  " + "AS (simpleFields:map[], mapFields:map[], listMapFields:map[]);","params = FOREACH sds GENERATE" + " (map[]) (mapFields#'page_params') AS params;","queries = FOREACH params GENERATE " + "(CHARARRAY) (params#'query') AS query_string;","queries_limit = LIMIT queries 100;","STORE queries_limit INTO 'out';"});
  queries.add(new String[]{"sds = LOAD '/my/data/location'  " + "AS (simpleFields:map[], mapFields:map[], listMapFields:map[]);","params = FOREACH sds GENERATE " + "(map[]) (mapFields#'page_params') AS params;","queries = FOREACH params GENERATE " + "(CHARARRAY) (params#'query') AS query_string;","rand_queries = FOREACH queries GENERATE query_string as query;","queries_limit = LIMIT rand_queries 100;","STORE rand_queries INTO 'out';"});
  for (  String[] query : queries) {
    String fullQuery="";
    for (    String queryLine : query) {
      fullQuery+=" " + queryLine;
    }
    LogicalPlan lp=createAndProcessLPlan(fullQuery);
    checkLoaderInCasts(lp,"org.apache.pig.builtin.PigStorage");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitWithInnerPlan2() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1",DataType.BYTEARRAY));
    fsList1.add(new FieldSchema("field2",DataType.INTEGER));
    inputSchema1=new Schema(fsList1);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema((inputSchema1)));
  ;
  LOSplit split1=new LOSplit(plan);
  LOSplitOutput splitOutput1=new LOSplitOutput(plan);
  LOSplitOutput splitOutput2=new LOSplitOutput(plan);
  LogicalExpressionPlan innerPlan1=new LogicalExpressionPlan();
  ProjectExpression project11=new ProjectExpression(innerPlan1,0,0,splitOutput1);
  ProjectExpression project12=new ProjectExpression(innerPlan1,0,1,splitOutput1);
  NotEqualExpression notequal1=new NotEqualExpression(innerPlan1,project11,project12);
  LogicalExpressionPlan innerPlan2=new LogicalExpressionPlan();
  ProjectExpression project21=new ProjectExpression(innerPlan2,0,0,splitOutput1);
  ConstantExpression const21=new ConstantExpression(innerPlan2,26L);
  SubtractExpression subtract21=new SubtractExpression(innerPlan2,project21,const21);
  splitOutput1.setFilterPlan(innerPlan1);
  splitOutput2.setFilterPlan(innerPlan2);
  plan.add(load1);
  plan.add(split1);
  plan.add(splitOutput1);
  plan.add(splitOutput2);
  plan.connect(load1,split1);
  plan.connect(split1,splitOutput1);
  plan.connect(split1,splitOutput2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  try {
    typeChecker.visit();
  }
 catch (  Exception t) {
  }
  printMessageCollector(collector);
  if (!collector.hasError()) {
    throw new AssertionError("Error expected");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBagCastLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1 : bag{ t : tuple (i)}, field2: float);" + "b = foreach a generate (bag{tuple(int)})field1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cross a, b;"+ "d = foreach c generate field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareTupleFail() throws Throwable {
  String query="a = load 'a' as (t : (i : int, j : int));" + "b = filter a by t > (1,2);";
  String exMsg="In alias b, incompatible types in GreaterThan Operator" + " left hand side:tuple i:int,j:int " + " right hand side:tuple :int,:int";
  checkExceptionMessage(query,"b",exMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinLineageMixSchema() throws Throwable {
  String query="a = load 'a' using PigStorage() as (field1, field2: float, field3: chararray );" + "b = load 'a' using PigStorage();" + "c = join a by field1, b by $0;"+ "d = foreach c generate $3 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test nested foreach with distinct
 * @throws Throwable
 */
@Test public void testNestedDistinct() throws Throwable {
  String query="a = load '/user/pig/tests/data/singlefile/studenttab10k' as (name, age, gpa);" + "b = group a by name; " + "c = foreach b { aa = distinct a.age; generate group + 1, COUNT(aa); }";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageDifferentSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('\u0001') as (field1, field2: float, field3: chararray );" + "b = load 'a' using PigStorage('\u0001') as (field4, field5, field6: chararray, field7 );" + "c = union a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('\u0001')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupFilterLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = filter d by field4 > 5;"+ "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinLineageMixSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();" + "c = join a by field1, b by $0;"+ "d = foreach c generate $3 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterLineageNoSchema() throws Throwable {
  String query="a = load 'a';" + "b = filter a by $0 > 1.0;";
  checkLastFilterCast(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitLineageNoSchema() throws Throwable {
  String query="a = load 'a';" + "split a into b if $0 > 1.0, c if $1 <= 1.0;";
  checkSplitLineage(query,"org.apache.pig.builtin.PigStorage","org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupTopKLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by field1 desc;"+ "f = limit e 100;"+ "g = foreach f generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1 , field2: float, field3: chararray );" + " b = group a by field1;" + " c = foreach b generate flatten(a);"+ " d = foreach c generate field1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitLineage() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = limit a 100;" + "c = foreach b generate field1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupMultiColumnProjectLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, a.(field1, field2), b.(field4);"+ "e = foreach d generate group, flatten($1), flatten($2);"+ "f = foreach e generate group, field1 + 1, field4 + 2.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineage2NoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = group a by $0;" + "c = foreach b generate group + 1.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossLineageMixSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cross a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLineageMultipleLoader1() throws FrontendException {
  String query="A = LOAD 'data1' USING PigStorage() AS (u, v, w);" + "B = LOAD 'data2' USING TextLoader() AS (x, y);" + "C = JOIN A BY u, B BY x USING 'replicated';"+ "D = GROUP C BY (u, x);"+ "E = FOREACH D GENERATE (chararray)group.u, (int)group.x;";
  checkLastForeachCastLoadFunc(query,"PigStorage",0);
  checkLastForeachCastLoadFunc(query,"TextLoader",1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapLookupLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = foreach a generate field1#'key1' as map1;" + "c = foreach b generate map1#'key2' as keyval;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
  query+="d = foreach c generate keyval + 1;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinctLineageNoSchema() throws Throwable {
  String query="a = load 'a';" + "b = distinct a;" + "c = foreach b generate $1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupLineage2() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + " b = group a by field1;" + " c = foreach b generate group + 1.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossLineageMixSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using PigStorage('a');" + "c = cross a , b;"+ "d = foreach c generate $3 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSortStarLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = order d by * desc;"+ "f = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortLineage() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = order a by field1;" + "c = foreach b generate field1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * From JIRA 1482
 * @throws FrontendException
 */
@Test public void testLineageMultipleLoader2() throws FrontendException {
  String query="A = LOAD 'data1' USING PigStorage() AS (s, m, l);" + "B = FOREACH A GENERATE s#'k1' as v1, m#'k2' as v2, l#'k3' as v3;" + "C = FOREACH B GENERATE v1, (v2 == 'v2' ? 1L : 0L) as v2:long, (v3 == 'v3' ? 1 :0) as v3:int;"+ "D = LOAD 'data2' USING TextLoader() AS (a);"+ "E = JOIN C BY v1, D BY a USING 'replicated';"+ "F = GROUP E BY (v1, a);"+ "G = FOREACH F GENERATE (chararray)group.v1, group.a;";
  checkLastForeachCastLoadFunc(query,"PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupProjectStarLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate *;"+ "f = foreach d generate group, flatten(a), flatten(b) ;"+ "g = foreach f generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupFilterLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = filter d by $2 > 5;"+ "f = foreach e generate $1, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = join a by field1, b by field4;"+ "d = foreach c generate field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",0);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",1);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinLineageNoSchemaFail() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();" + "c = join a by $0, b by $0;"+ "d = foreach c generate $1 + 2.0 ;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using PigStorage('a');" + "c = cross a , b;"+ "d = foreach c generate $1 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSplitLineage1() throws Throwable {
  String query="a = load 'a' as (field1, field2, field3: chararray );" + "split a into b if field2 > 1.0, c if field2 <= 1.0;" + "d = foreach b generate field1 + 1.0;"+ "e = foreach c generate field1 + 1.0;";
  LogicalPlan plan=createAndProcessLPlan(query);
  checkLoaderInCasts(plan,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilterLineage1NoSchema() throws Throwable {
  String query="a = load 'a';" + "b = filter a by $0 > 1.0;" + "c = foreach b generate $1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSplitLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by field1, b by field4;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "split d into e if field4 > 'm', f if field6 > 'm' ;"+ "g = foreach e generate group, field1 + 1, field4 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using PigStorage('a');" + "c = union a , b;"+ "d = foreach c generate $1 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupStarLineage1() throws Throwable {
  String query="a = load 'a' using PigStorage('x') as (field1, field2: float, field3: chararray );" + "b = load 'b' using PigStorage('x') as (field4, field5, field6: chararray );" + "c = cogroup a by *, b by *;"+ "d = foreach c generate flatten(group), flatten($1), flatten($2);"+ "e = foreach d generate $0 + 1, a::field1 + 1, field4 + 2.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('x')",0);
  checkLastForeachCastLoadFunc(query,"PigStorage('x')",1);
  checkLastForeachCastLoadFunc(query,"PigStorage('x')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupStarLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'b' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = cogroup a by *, b by *;"+ "d = foreach c generate group, flatten($1), flatten($2);"+ "e = foreach d generate group, field1 + 1, field4 + 2.0;";
  checkLastForeachCastLoadFunc(query,"PigStorage('a')",1);
  checkLastForeachCastLoadFunc(query,"org.apache.pig.test.PigStorageWithDifferentCaster('b')",2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareBagFail() throws Throwable {
  String query="a = load 'a' as (t1 :bag{()}, t2 : bag{()});" + "b = filter a by t1 <= t2;";
  String exMsg="In alias b, incompatible types in LessThanEqual " + "Operator left hand side:bag :tuple()  right hand side:bag :tuple()";
  checkExceptionMessage(query,"b",exMsg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinctLineage() throws Throwable {
  String query="a = load 'a' as (field1, field2: float, field3: chararray );" + "b = distinct a;" + "c = foreach b generate field1 + 1.0;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStreamingLineage2() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1: int, field2: float, field3: chararray );" + "b = stream a through `" + simpleEchoStreamingCommand + "` as (f1, f2: float);"+ "c = foreach b generate f1 + 1.0, f2 + 4;";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStreaming",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLineage() throws Throwable {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b') as (field4, field5, field6: chararray );" + "c = union a , b;"+ "d = foreach c generate field2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupSplitLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster('b');" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "split d into e if $1 > 'm', f if $1 > 'm' ;"+ "g = foreach d generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoinIncompatType() throws IOException {
  String query="a = load '1.txt' as (a0:map [], a1:int);" + "b = load '2.txt' as (a0:int, a1:int);" + "c = join a by (a0, a1), b by (a0,a1);";
  String msg="join column no. 1 in relation no. 2 of  join statement" + " has datatype int which is incompatible with type of" + " corresponding column in earlier relation(s) in the statement";
  Util.checkExceptionMessage(query,"c",msg);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * In case of filter with tuple type
 */
@Test public void testLineageFilterWithTuple() throws FrontendException {
  String query="A= LOAD 'data1' USING PigStorage() AS (u, v, w:tuple(a,b));" + "B = FOREACH A generate v, w;" + "C = FILTER B by v < 50;"+ "D = FOREACH C generate (int)w.a;";
  checkLastForeachCastLoadFunc(query,"PigStorage",0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A special invalid case.
 */
@Test public void testLineageMultipleLoader3() throws FrontendException {
  String query="A = LOAD 'data1' USING PigStorage() AS (u, v, w);" + "B = LOAD 'data2' USING TextLoader() AS (x, y);" + "C = COGROUP A BY u, B by x;"+ "D = FOREACH C GENERATE (chararray)group;";
  checkWarning(query,CAST_LOAD_NOT_FOUND);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupDistinctLineageNoSchema() throws Throwable {
  String query="a = load 'a' using PigStorage('a');" + "b = load 'a' using org.apache.pig.test.PigStorageWithDifferentCaster();" + "c = cogroup a by $0, b by $0;"+ "d = foreach c generate group, flatten(a), flatten(b) ;"+ "e = distinct d;"+ "f = foreach e generate $0, $1 + 1, $2 + 2.0 ;";
  checkLastForeachCastLoadFunc(query,null,1);
  checkLastForeachCastLoadFunc(query,null,2);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCastEmptyInnerSchema() throws IOException, ParserException {
  final String INP_FILE="testCastEmptyInnerSchema.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INP_FILE));
  w.println("(1,2)");
  w.println("(2,3)");
  w.close();
  PigServer pigServer=new PigServer(LOCAL);
  String query="a = load '" + INP_FILE + "' as (t:tuple());"+ "b = foreach a generate (tuple(int, long))t;"+ "c = foreach b generate t.$0 + t.$1;";
  Util.registerMultiLineQuery(pigServer,query);
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(3L)","(5L)"});
  Iterator<Tuple> it=pigServer.openIterator("c");
  Util.checkQueryOutputs(it,expectedRes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDF </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEnsureProperSchema1() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerQuery("DEFINE goodSchema1 org.apache.pig.test.TestUDF$MirrorSchema('a:int');");
  pig.registerQuery("DEFINE goodSchema2 org.apache.pig.test.TestUDF$MirrorSchema('t:(a:int, b:int, c:int)');");
  pig.registerQuery("DEFINE goodSchema3 org.apache.pig.test.TestUDF$MirrorSchema('b:{(a:int, b:int, c:int)}');");
  pig.registerQuery("a = load 'thing';");
  pig.registerQuery("b = foreach a generate goodSchema1();");
  pig.registerQuery("c = foreach a generate goodSchema2();");
  pig.registerQuery("d = foreach a generate goodSchema3();");
  pig.dumpSchema("b");
  pig.dumpSchema("c");
  pig.dumpSchema("d");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testEnsureProperSchema2() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerQuery("DEFINE badSchema org.apache.pig.test.TestUDF$MirrorSchema('a:int, b:int, c:int');");
  pig.registerQuery("a = load 'thing';");
  pig.registerQuery("b = foreach a generate badSchema();");
  pig.dumpSchema("b");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUTF8 </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScriptParser() throws Throwable {
  String strCmd="--中文\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes("UTF-8"));
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),pigServer.getPigContext());
  grunt.exec();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnionOnSchema </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA on 3 inputs 
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchema3Inputs() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j : int); "+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (i : double, x : int); "+ "l3 = load '"+ INP_FILE_2NUM_1CHAR_1BAG+ "' as "+ "  (i : long, c : chararray, j : int "+ ", b : bag { t : tuple (c1 : int, c2 : chararray)} ); "+ "u = union onschema l1, l2, l3;";
  Util.registerMultiLineQuery(pig,query);
  pig.explain("u",System.out);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1.0,2,null,null,null)","(5.0,3,null,null,null)","(1.0,null,2,null,null)","(5.0,null,3,null,null)","(1.0,2,null,'abc',{(1,'a'),(1,'b')})","(5.0,3,null,'def',{(2,'a'),(2,'b')})"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA on two inputs with same column names, but different
 * numeric types - test type promotion
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaDiffNumType() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j : double);"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (i : long, j : float);"+ "u = union onschema l1, l2;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,2.0)","(5L,3.0)","(1L,2.0)","(5L,3.0)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA on two inputs , one input with additional columns
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaAdditionalColumn() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j : int);"+ "l2 = load '"+ INP_FILE_2NUM_1CHAR_1BAG+ "' as "+ "  (i : long, c : chararray, j : int "+ ", b : bag { t : tuple (c1 : int, c2 : chararray)}"+ ", t : tuple (tc1 : int, tc2 : chararray) );"+ "l3 = load '"+ INP_FILE_EMPTY+ "' as (i : int, x : long);"+ "u = union onschema l1, l2, l3;";
  Util.registerMultiLineQuery(pig,query);
  pig.explain("u",System.out);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,2,null,null,null,null)","(5L,3,null,null,null,null)","(1L,2,'abc',{(1,'a'),(1,'b')},(1,'c'),null)","(5L,3,'def',{(2,'a'),(2,'b')},(2,'c'),null)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA on two inputs with no common columns
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaNoCommonCols() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j : int);"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (x : long, y : float);"+ "u = union onschema l1, l2;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,2,null,null)","(5,3,null,null)","(null,null,1L,2.0F)","(null,null,5L,3.0F)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * negative test - test error on null alias in one of the FieldSchema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaNullAliasInFieldSchema() throws Exception {
  String expectedErr="Schema of relation f has a null fieldschema for " + "column(s). Schema ::long,y:float";
  String query="  l = load '" + INP_FILE_2NUMS + "' as (x : long, y : float);"+ "f = foreach l generate x+1, y;"+ "u = union onschema l, f;";
  checkSchemaEx(query,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test query with a union-onschema having another as input 
 * @throws IOException
 * @throws ParserException
 */
@Test public void testTwoUnions() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i : int, j : int);"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (i : long, j : int);"+ "u1 = union onschema l1, l2;"+ "l3 = load '"+ INP_FILE_2NUMS+ "' as (i : long, j : double);"+ "u2 = union onschema u1, l3;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("u2");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,2.0)","(5L,3.0)","(1L,2.0)","(5L,3.0)","(1L,2.0)","(5L,3.0)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * negative test - test error on no schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaNoSchema() throws Exception {
  String expectedErr="UNION ONSCHEMA cannot be used with " + "relations that have null schema";
  String query="  l1 = load '" + INP_FILE_2NUMS + "' ;"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (x : long, y : float);"+ "u = union onschema l1, l2;";
  checkSchemaEx(query,expectedErr);
  query="  l1 = load '" + INP_FILE_2NUMS + "' ;"+ "l2 = load '"+ INP_FILE_2NUMS+ "' ;"+ "u = union onschema l1, l2;";
  checkSchemaEx(query,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA where a common column has additional 'namespace' part
 * in the column name in one of the inputs.
 * Negative test case
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaScopedColumnNameNeg() throws Exception {
  String expectedErr="Found more than one match: l1::i, l2::i";
  String query_prefix="  l1 = load '/tmp/fn' as (i : int, j : long); " + "l2 = load '/tmp/fn' as (i : int, j : long); " + "cg = cogroup l1 by i, l2 by i;"+ "f = foreach cg generate flatten(l1), flatten(l2); "+ "l3 = load '/tmp/fn2' as (i : int, j : long); ";
  String query=query_prefix + "u = union onschema f, l3; ";
  checkSchemaEx(query,expectedErr);
  query=query_prefix + "u = union onschema l3, f; ";
  checkSchemaEx(query,expectedErr);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA with bytearray type 
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaByteArrayConversions() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query=" l1 = load '" + INP_FILE_2NUM_1CHAR_1BAG + "' as "+ "  (i : bytearray, x : bytearray, j : bytearray "+ ", b : bytearray); "+ "l2 = load '"+ INP_FILE_2NUM_1CHAR_1BAG+ "' as "+ "  (i : long, c : chararray, j : int "+ ", b : bag { t : tuple (c1 : int, c2 : chararray)} ); "+ "u = union onSchema l1, l2;";
  Util.registerMultiLineQuery(pig,query);
  pig.explain("u",System.out);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1L,null,2,{(1,'a'),(1,'b')},'abc')","(1L,'abc',2,{(1,'a'),(1,'b')},null)","(5L,null,3,{(2,'a'),(2,'b')},'def')","(5L,'def',3,{(2,'a'),(2,'b')},null)"});
  for (  Tuple t : expectedRes) {
    if (t.get(1) != null) {
      t.set(1,new DataByteArray(t.get(1).toString()));
    }
  }
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test UNION ONSCHEMA with cast from bytearray to another type
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaCastOnByteArray() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (i, j);"+ " f1 = foreach l1 generate (int)i, (int)j;"+ "u = union onschema f1, l1;";
  Util.registerMultiLineQuery(pig,query);
  Iterator<Tuple> it=pig.openIterator("u");
  List<Tuple> expectedRes=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,2)","(5,3)","(1,2)","(5,3)"});
  Util.checkQueryOutputsAfterSort(it,expectedRes);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * test union with incompatible types in schema
 * @throws IOException
 * @throws ParserException
 */
@Test public void testUnionOnSchemaIncompatibleTypes() throws Exception {
  String query="  l1 = load '" + INP_FILE_2NUMS + "' as (x : long, y : chararray);"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (x : long, y : float);"+ "u = union onschema l1, l2;";
  checkSchemaEquals(query,"x : long, y : bytearray");
  query="  l1 = load '" + INP_FILE_2NUMS + "' as (x : long, y : chararray);"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (x : map[ ], y : chararray);"+ "u = union onschema l1, l2;";
  checkSchemaEquals(query,"x : bytearray, y : chararray");
  query="  l1 = load '" + INP_FILE_2NUMS + "' as (x : long, b : bag { t : tuple (c1 : int, c2 : chararray)}  );"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (x : long, b : bag { t : tuple (c1 : long, c2 : chararray)} );"+ "u = union onschema l1, l2;";
  Schema sch=new Schema();
  sch.add(new FieldSchema("x",DataType.LONG));
  Schema bagInnerSchema=new Schema();
  bagInnerSchema.add(new FieldSchema(null,new Schema(),DataType.TUPLE));
  sch.add(new FieldSchema("b",bagInnerSchema,DataType.BAG));
  checkSchemaEquals(query,sch);
  query="  l1 = load '" + INP_FILE_2NUMS + "' as (t : tuple (c1 : int, c2 : chararray)  );"+ "l2 = load '"+ INP_FILE_2NUMS+ "' as (t : tuple (c1 : long, c2 : chararray) );"+ "u = union onschema l1, l2;";
  sch=new Schema();
  sch.add(new FieldSchema("t",new Schema(),DataType.TUPLE));
  checkSchemaEquals(query,sch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.pigunit.TestPigTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithUdf() throws ParseException, IOException {
  String[] script={"DEFINE TOKENIZE TOKENIZE();","data = LOAD 'top_queries_input_data.txt' AS (query:CHARARRAY, count:INT);","queries = FOREACH data GENERATE query, TOKENIZE(query) AS query_tokens;","queries_ordered = ORDER queries BY query DESC PARALLEL 1;","queries_limit = LIMIT queries_ordered 3;","STORE queries_limit INTO 'top_3_queries';"};
  test=new PigTest(script);
  String[] output={"(yahoo,{(yahoo)})","(yahoo,{(yahoo)})","(twitter,{(twitter)})"};
  test.assertOutput(output);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testImplicitNtoN() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput(output);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnyOrderOutputForAlias() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] reorderedExpectedOutput={"(twitter,7)","(yahoo,25)","(facebook,15)"};
  test.assertOutputAnyOrder("queries_limit",reorderedExpectedOutput);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOverride() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  test.override("queries_limit","queries_limit = LIMIT queries_ordered 2;");
  String[] output={"(yahoo,25)","(facebook,15)"};
  test.assertOutput(output);
}

</code></pre>

<br>
<pre class="type-10 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
- Is not executed with the test suite
"></span><br>
@Ignore("Not ready yet") @Test public void testWithMock() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  PigServer mockServer=null;
  Cluster mockCluster=null;
  test=new PigTest(PIG_SCRIPT,args,mockServer,mockCluster);
  test.assertOutput(new File("data/top_queries_expected_top_3.txt"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFileOutput() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  test.assertOutput(new File("test/data/pigunit/top_queries_expected_top_3.txt"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSubset() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] input={"yahoo\t10","twitter\t7","facebook\t10","yahoo\t15","facebook\t5","a\t1","b\t2","c\t3","d\t4","e\t5"};
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput("data",input,"queries_limit",output);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnyOrderOutput() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] reorderedExpectedOutput={"(twitter,7)","(yahoo,25)","(facebook,15)"};
  test.assertOutputAnyOrder(reorderedExpectedOutput);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDelimiter() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] input={"yahoo,10","twitter,7","facebook,10","yahoo,15","facebook,5","a,1","b,2","c,3","d,4","e,5"};
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput("data",input,"queries_limit",output,",");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMockedAliasWithDefaultDelimiter() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args,null,null);
  String[] mockData={"Apache\t99","Pig\t42","GitHub\t107","Google\t404"};
  test.mockAlias("queries_ordered",mockData,"(query: chararray,count: int)");
  String[] expectedOutput={"(Apache,99)","(Pig,42)","(GitHub,107)"};
  test.assertOutput(expectedOutput);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is a test for default bootup. PIG-2456
 * @throws Exception 
 */
@Test public void testDefaultBootup() throws Exception {
  Properties pigProps=PropertiesUtil.loadDefaultProperties();
  String bootupPath="/tmp/.temppigbootup";
  pigProps.setProperty("pig.load.default.statements",bootupPath);
  File bootupFile=new File(bootupPath);
  PrintWriter out=new PrintWriter(new FileWriter(bootupFile));
  out.println("data = LOAD 'top_queries_input_data.txt' AS (query:CHARARRAY, count:INT);");
  out.close();
  String[] script={"queries_group = GROUP data BY query PARALLEL 1;","queries_sum = FOREACH queries_group GENERATE group AS query, SUM(data.count) AS count;","queries_ordered = ORDER queries_sum BY count DESC PARALLEL 1;","queries_limit = LIMIT queries_ordered 3;","STORE queries_limit INTO 'top_3_queries';"};
  String scriptPath="/tmp/tempScript";
  File scriptFile=new File(scriptPath);
  out=new PrintWriter(new FileWriter(scriptFile));
  for (  String line : script) {
    out.println(line);
  }
  out.close();
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  PigServer pig=null;
  pig=new PigServer(Util.getLocalTestMode(),pigProps);
  final Cluster cluster=new Cluster(pig.getPigContext());
  test=new PigTest(scriptPath,args,pig,cluster);
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput("queries_limit",output);
  scriptFile.delete();
  bootupFile.delete();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInlinePigScript() throws ParseException, IOException {
  String[] script={"data = LOAD 'top_queries_input_data.txt' AS (query:CHARARRAY, count:INT);","queries_group = GROUP data BY query PARALLEL 1;","queries_sum = FOREACH queries_group GENERATE group AS query, SUM(data.count) AS count;","queries_ordered = ORDER queries_sum BY count DESC PARALLEL 1;","queries_limit = LIMIT queries_ordered 3;","STORE queries_limit INTO 'top_3_queries';"};
  test=new PigTest(script);
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput(output);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTextInput() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] input={"yahoo\t10","twitter\t7","facebook\t10","yahoo\t15","facebook\t5","a\t1","b\t2","c\t3","d\t4","e\t5"};
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput("data",input,"queries_limit",output);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMockedAliasWithDifferentDelimiter() throws Exception {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args,null,null);
  String[] mockData={"Apache,99","Pig,42","GitHub,107","Google,404"};
  test.mockAlias("queries_ordered",mockData,"(query: chararray,count: int)",",");
  String[] expectedOutput={"(Apache,99)","(Pig,42)","(GitHub,107)"};
  test.assertOutput(expectedOutput);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testArgFiles() throws ParseException, IOException {
  String[] argsFile={"test/data/pigunit/top_queries_params.txt"};
  test=new PigTest(PIG_SCRIPT,null,argsFile);
  test.assertOutput(new File("test/data/pigunit/top_queries_expected_top_3.txt"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNtoN() throws ParseException, IOException {
  String[] args={"n=3","reducers=1","input=top_queries_input_data.txt","output=top_3_queries"};
  test=new PigTest(PIG_SCRIPT,args);
  String[] output={"(yahoo,25)","(facebook,15)","(twitter,7)"};
  test.assertOutput("queries_limit",output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezCompiler </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithNestedSplit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "store b into 'file:///tmp/output/b';"+ "c = foreach b generate a.x, a.y;"+ "store c into 'file:///tmp/output/c';"+ "d = foreach b GENERATE FLATTEN(a);"+ "store d into 'file:///tmp/output/d';"+ "e = foreach d GENERATE a::x, a::y;"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-5.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-5-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-4.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-4-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-5.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-5-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplicatedJoinInReducer() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = group a by x;" + "b1 = foreach b generate group, COUNT(a.y);"+ "c = load 'file:///tmp/input2' as (x:int, z:int);"+ "d = join b1 by group, c by x using 'replicated';"+ "store d into 'file:///tmp/output/e';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-FRJoin-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinctAlgebraicUdfCombiner() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b { d = distinct a; generate COUNT(d); };"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Distinct-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-6.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-6-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitScalarOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = order a by x, y;" + "g = group a all;"+ "h = foreach g generate COUNT(a) as sum;"+ "c = limit b h.sum/2;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-3.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCross() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cross a, b;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "split a into a1 if x > 100, a2 otherwise;"+ "c = union onschema a1, a2, b;"+ "split c into d if x > 500, e otherwise;"+ "store a2 into 'file:///tmp/output/a2';"+ "store d into 'file:///tmp/output/d';"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-9.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-9-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x;"+ "d = foreach c generate $0, $1, $3;"+ "e = foreach c generate $0, $1, $2, $3;"+ "store c into 'file:///tmp/output/c';"+ "store d into 'file:///tmp/output/d';"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-4.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-4-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupWithAlgebraiceUDF() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cogroup a by x, b by x;"+ "d = foreach c generate group, COUNT(a.y), COUNT(b.z);"+ "store d into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cogroup-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByWithFilter() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = filter a by x == 1;" + "c = order b by x;"+ "STORE c INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossScalarSplit() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cross b, a;"+ "d = foreach c generate a.x, b.z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-3.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryMultipleScalar() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x == 5;" + "b = foreach b generate $0 as b1;"+ "c = filter a by x == 10;"+ "c = foreach c generate $0 as c1;"+ "d = group a by x;"+ "e = foreach d generate group, b.b1, c.c1;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-8.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-8-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByReadOnceLoadFunc() throws Exception {
  setProperty("pig.sort.readonce.loadfuncs","org.apache.pig.backend.hadoop.hbase.HBaseStorage,org.apache.pig.backend.hadoop.accumulo.AccumuloStorage");
  String query="a = load 'file:///tmp/input' using org.apache.pig.backend.hadoop.hbase.HBaseStorage(',') as (x:int, y:int);" + "b = order a by x;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-3.gld");
  setProperty("pig.sort.readonce.loadfuncs",null);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMulitQueryWithSplitSingleVertex() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "split a into b if x <= 5, c if x <= 10, d if x >10;" + "store b into 'file:///tmp/output/b';"+ "store c into 'file:///tmp/output/c';"+ "store d into 'file:///tmp/output/d';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-1.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-1-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = distinct a;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Distinct-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryScalar() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b generate group, COUNT(a) as cnt;"+ "SPLIT a into d if (2 * c.cnt) < y, e OTHERWISE;"+ "store d into 'file:///tmp/output1';"+ "store e into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-6.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-6-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinReplicated() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = filter a by x > 10;"+ "e = join b by x, c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-3.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplitReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-13.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-13-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-14.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-14-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplicatedJoinInMapper() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = load 'file:///tmp/input3' as (x:int, z:int);"+ "d = join a by x, b by x, c by x using 'replicated';"+ "store d into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-FRJoin-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankBy() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = rank a by x;" + "store b into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Rank-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnion() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, y:chararray);"+ "e = union onschema c, d;"+ "f = group e by x;"+ "store e into 'file:///tmp/output1';"+ "store f into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-10.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-10-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnionStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, y:chararray);"+ "e = union onschema c, d;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-11.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-11-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b generate group, COUNT(a.x);"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Group-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryMultipleReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = load 'file:///tmp/input' as (x:int, y:int);" + "c = join a by $0, b by $0 using 'replicated';"+ "d = join a by $1, b by $1 using 'replicated';"+ "e = union c,d;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-7.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-7-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-3.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-3-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMulitQueryWithSplitMultiVertex() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "split a into b if x <= 5, c if x <= 10, d if x >10;" + "split b into e if x < 3, f if x >= 3;"+ "b1 = group b by x;"+ "b2 = foreach b1 generate group, SUM(b.x);"+ "c1 = join c by x, b by x;"+ "c2 = group c by x;"+ "c3 = foreach c2 generate group, SUM(c.x);"+ "d1 = filter d by x == 5;"+ "e1 = order e by x;"+ "f1 = limit f 1;"+ "f2 = union d1, f1;"+ "store b1 into 'file:///tmp/output/b1';"+ "store b2 into 'file:///tmp/output/b2';"+ "store c1 into 'file:///tmp/output/c1';"+ "store c3 into 'file:///tmp/output/c1';"+ "store d1 into 'file:///tmp/output/d1';"+ "store e1 into 'file:///tmp/output/e1';"+ "store f1 into 'file:///tmp/output/f1';"+ "store f2 into 'file:///tmp/output/f2';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-2.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-2-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = limit a 10;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStream() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = stream a through `stream.pl -n 5`;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Stream-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinSkewed() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = join b by x, c by x using 'skewed';"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Join-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinUnionReplicated() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = union a, b;"+ "d = join b by x, c by x using 'replicated';"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-4.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = load 'file:///tmp/input' as (y:int, x:int);" + "c = union onschema a, b;"+ "d = group c by x;"+ "e = foreach d generate group, SUM(c.y);"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-2.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-2-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfCross() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = cross b, c;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLimit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = limit c 1;"+ "store d into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-8.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-8-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecondaryKeySort() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int, z:int);" + "b = group a by $0;" + "c = foreach b { d = limit a 10; e = order d by $1; f = order e by $0; generate group, f;};"+ "store c INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SecKeySort-1.gld");
  setProperty(PigConfiguration.PIG_EXEC_NO_SECONDARY_KEY,"true");
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SecKeySort-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = order c by x;"+ "store d into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-7.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-7-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleUnionSplitJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "b1 = foreach b generate *;"+ "b2 = foreach b generate *;"+ "b3 = union onschema b1, b2;"+ "c = filter a by x == 3;"+ "c1 = foreach c generate y, x;"+ "c2 = foreach c generate y, x;"+ "c3 = union c1, c2;"+ "a1 = union onschema b3, c3;"+ "store a1 into 'file:///tmp/output1';"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join a1 by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-12.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-12-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = filter a by x > 10;"+ "e = join b by x, c by x, d by x;"+ "store e into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = filter a by x > 0;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Filter-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "b = foreach b generate group, COUNT(a.x);"+ "c = group a by (x,y);"+ "c = foreach c generate group, COUNT(a.y);"+ "store b into 'file:///tmp/output/b';"+ "store c into 'file:///tmp/output/c';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-3.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-3-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderBy() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = order a by x;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x using 'skewed';"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SkewJoin-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = order a by x, y;" + "c = limit b 10;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = rank a;" + "store b into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Rank-1.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinFilter() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "a = filter a by x == 1;" + "b = load 'file:///tmp/input2' as (x:int, z:int);"+ "c = join a by x, b by x using 'skewed';"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SkewJoin-2.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplitSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-15.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-15-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-16.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-16-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionScalar() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = filter c by x == d.x;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-17.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-17-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = filter d by x == c.x;"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-18.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-18-OPTOFF.gld");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnSupportedStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  String oldSupported=getProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS);
  String oldUnSupported=getProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,PigStorage.class.getName());
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-OPTOFF.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,null);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS,OrcStorage.class.getName());
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output' using " + DummyStoreWithOutputFormat.class.getName() + "();";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-DummyStore-OPTOFF.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS,oldSupported);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,oldUnSupported);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
