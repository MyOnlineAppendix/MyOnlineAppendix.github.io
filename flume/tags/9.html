<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.flume.api.TestFailoverRpcClient </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test a bunch of servers closing the one we are writing to and bringing
 * another one back online.
 * @throws FlumeException
 * @throws EventDeliveryException
 * @throws InterruptedException
 */
@Test public void testFailover() throws FlumeException, EventDeliveryException, InterruptedException {
  FailoverRpcClient client=null;
  Server server1=RpcTestUtils.startServer(new OKAvroHandler());
  Server server2=RpcTestUtils.startServer(new OKAvroHandler());
  Server server3=RpcTestUtils.startServer(new OKAvroHandler());
  Properties props=new Properties();
  int s1Port=server1.getPort();
  int s2Port=server2.getPort();
  int s3Port=server3.getPort();
  props.put("client.type","default_failover");
  props.put("hosts","host1 host2 host3");
  props.put("hosts.host1","127.0.0.1:" + String.valueOf(s1Port));
  props.put("hosts.host2","127.0.0.1:" + String.valueOf(s2Port));
  props.put("hosts.host3","127.0.0.1:" + String.valueOf(s3Port));
  client=(FailoverRpcClient)RpcClientFactory.getInstance(props);
  List<Event> events=new ArrayList<Event>();
  for (int i=0; i < 50; i++) {
    events.add(EventBuilder.withBody("evt: " + i,Charset.forName("UTF8")));
  }
  client.appendBatch(events);
  Assert.assertEquals(client.getLastConnectedServerAddress(),new InetSocketAddress("127.0.0.1",server1.getPort()));
  server1.close();
  Thread.sleep(1000L);
  events=new ArrayList<Event>();
  for (int i=0; i < 50; i++) {
    events.add(EventBuilder.withBody("evt: " + i,Charset.forName("UTF8")));
  }
  client.appendBatch(events);
  Assert.assertEquals(new InetSocketAddress("localhost",server2.getPort()),client.getLastConnectedServerAddress());
  server2.close();
  Thread.sleep(1000L);
  client.append(EventBuilder.withBody("Had a sandwich?",Charset.forName("UTF8")));
  Assert.assertEquals(new InetSocketAddress("localhost",server3.getPort()),client.getLastConnectedServerAddress());
  Server server4=RpcTestUtils.startServer(new OKAvroHandler(),s2Port);
  server3.close();
  Thread.sleep(1000L);
  events=new ArrayList<Event>();
  for (int i=0; i < 50; i++) {
    events.add(EventBuilder.withBody("evt: " + i,Charset.forName("UTF8")));
  }
  client.appendBatch(events);
  Assert.assertEquals(new InetSocketAddress("localhost",s2Port),client.getLastConnectedServerAddress());
  Server server5=RpcTestUtils.startServer(new OKAvroHandler(),s1Port);
  client.append(EventBuilder.withBody("Had a mango?",Charset.forName("UTF8")));
  Assert.assertEquals(new InetSocketAddress("localhost",s2Port),client.getLastConnectedServerAddress());
  server4.close();
  Thread.sleep(1000L);
  events=new ArrayList<Event>();
  for (int i=0; i < 50; i++) {
    events.add(EventBuilder.withBody("evt: " + i,Charset.forName("UTF8")));
  }
  client.appendBatch(events);
  Assert.assertEquals(new InetSocketAddress("localhost",s1Port),client.getLastConnectedServerAddress());
  server5.close();
  Thread.sleep(1000L);
  Server server6=RpcTestUtils.startServer(new OKAvroHandler(),s1Port);
  client.append(EventBuilder.withBody("Had a whole watermelon?",Charset.forName("UTF8")));
  Assert.assertEquals(new InetSocketAddress("localhost",s1Port),client.getLastConnectedServerAddress());
  server6.close();
  Thread.sleep(1000L);
  Server server7=RpcTestUtils.startServer(new OKAvroHandler(),s3Port);
  events=new ArrayList<Event>();
  for (int i=0; i < 50; i++) {
    events.add(EventBuilder.withBody("evt: " + i,Charset.forName("UTF8")));
  }
  client.appendBatch(events);
  Assert.assertEquals(new InetSocketAddress("localhost",s3Port),client.getLastConnectedServerAddress());
  server7.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.api.TestLoadBalancingRpcClient </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRoundRobinDistribution() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","round_robin");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.append(getEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendCount();
      counts.add(handler.getAppendCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() == 1);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoHostFailover() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.append(getEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendCount());
    Assert.assertEquals(40,h2.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRandomDistributionBatch() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","random");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendBatchCount();
      counts.add(handler.getAppendBatchCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() > 2);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLbDefaultClientTwoHostsBatch() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(50,h1.getAppendBatchCount());
    Assert.assertEquals(50,h2.getAppendBatchCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that we can tolerate a host that is completely down.
 * @throws Exception
 */
@Test public void testTwoHostsOneDead() throws Exception {
  LOGGER.info("Running testTwoHostsOneDead...");
  Server s1=null;
  RpcClient c1=null, c2=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + 0);
    p.put("hosts.h2","127.0.0.1:" + s1.getPort());
    c1=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c1 instanceof LoadBalancingRpcClient);
    for (int i=0; i < 10; i++) {
      c1.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(10,h1.getAppendBatchCount());
    c2=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c2 instanceof LoadBalancingRpcClient);
    for (int i=0; i < 10; i++) {
      c2.append(getEvent(i));
    }
    Assert.assertEquals(10,h1.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (c1 != null)     c1.close();
    if (c2 != null)     c2.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffFailureRecovery() throws EventDeliveryException, InterruptedException {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    if (i == 1) {
      s.setFailed();
    }
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("recovery test".getBytes()));
  }
  hosts.get(1).setOK();
  Thread.sleep(3000);
  int numEvents=60;
  for (int i=0; i < numEvents; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(2 + (numEvents / 3),hosts.get(0).getAppendCount());
  Assert.assertEquals(0 + (numEvents / 3),hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + (numEvents / 3),hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoHostFailoverBatch() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendBatchCount());
    Assert.assertEquals(40,h2.getAppendBatchCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffIncreasingBackoffs() throws Exception {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    if (i == 1) {
      s.setFailed();
    }
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  Thread.sleep(2100);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  hosts.get(1).setOK();
  Thread.sleep(2100);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  Thread.sleep(2500);
  int numEvents=60;
  for (int i=0; i < numEvents; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(2 + 2 + 1+ (numEvents / 3),hosts.get(0).getAppendCount());
  Assert.assertEquals((numEvents / 3),hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + 1 + 2+ (numEvents / 3),hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffInitialFailure() throws EventDeliveryException {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  hosts.get(1).setFailed();
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  hosts.get(1).setOK();
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(1 + 2 + 1,hosts.get(0).getAppendCount());
  Assert.assertEquals(1,hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + 1 + 2,hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomBackoff() throws Exception {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","random");
  p.put("backoff","true");
  hosts.get(0).setFailed();
  hosts.get(2).setFailed();
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 50; i++) {
    c.append(EventBuilder.withBody(("test" + String.valueOf(i)).getBytes()));
  }
  Assert.assertEquals(50,hosts.get(1).getAppendCount());
  Assert.assertEquals(0,hosts.get(0).getAppendCount());
  Assert.assertEquals(0,hosts.get(2).getAppendCount());
  hosts.get(0).setOK();
  hosts.get(1).setFailed();
  try {
    c.append(EventBuilder.withBody("shouldfail".getBytes()));
    Assert.fail("Expected EventDeliveryException");
  }
 catch (  EventDeliveryException e) {
  }
  Thread.sleep(2500);
  for (int i=0; i < 50; i++) {
    c.append(EventBuilder.withBody(("test" + String.valueOf(i)).getBytes()));
  }
  Assert.assertEquals(50,hosts.get(0).getAppendCount());
  Assert.assertEquals(50,hosts.get(1).getAppendCount());
  Assert.assertEquals(0,hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-1 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=EventDeliveryException.class) public void testTwoHostFailoverThrowAfterClose() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.append(getEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendCount());
    Assert.assertEquals(40,h2.getAppendCount());
    if (c != null)     c.close();
    c.append(getEvent(3));
    Assert.fail();
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRoundRobinDistributionBatch() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","round_robin");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendBatchCount();
      counts.add(handler.getAppendBatchCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() == 1);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRandomDistribution() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","random");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.append(getEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendCount();
      counts.add(handler.getAppendCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() > 2);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLbDefaultClientTwoHosts() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      c.append(getEvent(i));
    }
    Assert.assertEquals(50,h1.getAppendCount());
    Assert.assertEquals(50,h2.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.api.TestRpcClientFactory </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThreeParamDeprecatedAppend() throws FlumeException, EventDeliveryException {
  RpcClient client=null;
  Server server=RpcTestUtils.startServer(new OKAvroHandler());
  try {
    client=RpcClientFactory.getInstance(localhost,server.getPort(),3);
    Assert.assertEquals("Batch size was specified",3,client.getBatchSize());
    client.append(EventBuilder.withBody("wheee!!!",Charset.forName("UTF8")));
  }
  finally {
    RpcTestUtils.stopServer(server);
    if (client != null)     client.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.auth.TestFlumeAuthenticator </h4><pre class="type-9 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlumeLoginPrincipalWithoutRealm() throws Exception {
  String principal="flume";
  File keytab=new File(workDir,"flume2.keytab");
  kdc.createPrincipal(keytab,principal);
  String expResult=principal + "@" + kdc.getRealm();
  FlumeAuthenticationUtil.clearCredentials();
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
  assertTrue(authenticator.isAuthenticated());
  String result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Initial login failed",expResult,result);
  authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
  result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Re-login failed",expResult,result);
  principal="alice";
  keytab=aliceKeytab;
  try {
    authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
    result=((KerberosAuthenticator)authenticator).getUserName();
    fail("Login should have failed with a new principal: " + result);
  }
 catch (  Exception ex) {
    assertTrue("Login with a new principal failed, but for an unexpected " + "reason: " + ex.getMessage(),ex.getMessage().contains("Cannot use multiple kerberos principals"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlumeLogin() throws IOException {
  String principal=flumePrincipal;
  String keytab=flumeKeytab.getAbsolutePath();
  String expResult=principal;
  FlumeAuthenticationUtil.clearCredentials();
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  assertTrue(authenticator.isAuthenticated());
  String result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Initial login failed",expResult,result);
  authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Re-login failed",expResult,result);
  principal=alicePrincipal;
  keytab=aliceKeytab.getAbsolutePath();
  try {
    authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
    result=((KerberosAuthenticator)authenticator).getUserName();
    fail("Login should have failed with a new principal: " + result);
  }
 catch (  Exception ex) {
    assertTrue("Login with a new principal failed, but for an unexpected " + "reason: " + ex.getMessage(),ex.getMessage().contains("Cannot use multiple kerberos principals"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNullLogin() throws IOException {
  String principal=null;
  String keytab=null;
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  assertFalse(authenticator.isAuthenticated());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProxyAs() throws IOException {
  String username="alice";
  String expResult=username;
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(null,null);
  String result=((UGIExecutor)(authenticator.proxyAs(username))).getUserName();
  assertEquals("Proxy as didn't generate the expected username",expResult,result);
  authenticator=FlumeAuthenticationUtil.getAuthenticator(flumePrincipal,flumeKeytab.getAbsolutePath());
  String login=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Login succeeded, but the principal doesn't match",flumePrincipal,login);
  result=((UGIExecutor)(authenticator.proxyAs(username))).getUserName();
  assertEquals("Proxy as didn't generate the expected username",expResult,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestMemoryChannelConcurrency </h4><pre class="type-9 type-13 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testConcurrentSinksAndSources() throws InterruptedException {
  final Channel channel=new MemoryChannel();
  Context context=new Context();
  context.put("keep-alive","1");
  context.put("capacity","100");
  context.put("transactionCapacity","100");
  Configurables.configure(channel,context);
  final ConcurrentHashMap<String,AtomicInteger> committedPuts=new ConcurrentHashMap<String,AtomicInteger>();
  final ConcurrentHashMap<String,AtomicInteger> committedTakes=new ConcurrentHashMap<String,AtomicInteger>();
  final int threadCount=100;
  final CountDownLatch startGate=new CountDownLatch(1);
  final CountDownLatch endGate=new CountDownLatch(threadCount);
  for (int i=0; i < threadCount / 2; i++) {
    Thread t=new Thread(){
      @Override public void run(){
        Long tid=Thread.currentThread().getId();
        String strtid=tid.toString();
        Random rng=new Random(tid);
        try {
          startGate.await();
        }
 catch (        InterruptedException e1) {
          Thread.currentThread().interrupt();
        }
        for (int j=0; j < 10; j++) {
          int events=rng.nextInt(5) + 1;
          Transaction tx=channel.getTransaction();
          tx.begin();
          for (int k=0; k < events; k++) {
            channel.put(EventBuilder.withBody(strtid.getBytes()));
          }
          if (rng.nextBoolean()) {
            try {
              tx.commit();
              AtomicInteger tcount=committedPuts.get(strtid);
              if (tcount == null) {
                committedPuts.put(strtid,new AtomicInteger(events));
              }
 else {
                tcount.addAndGet(events);
              }
            }
 catch (            ChannelException e) {
              System.out.print("puts commit failed");
              tx.rollback();
            }
          }
 else {
            tx.rollback();
          }
          tx.close();
        }
        endGate.countDown();
      }
    }
;
    t.start();
    final Integer takeMapLock=0;
    t=new Thread(){
      @Override public void run(){
        Random rng=new Random(Thread.currentThread().getId());
        try {
          startGate.await();
        }
 catch (        InterruptedException e1) {
          Thread.currentThread().interrupt();
        }
        for (int j=0; j < 10; j++) {
          int events=rng.nextInt(5) + 1;
          Transaction tx=channel.getTransaction();
          tx.begin();
          Event[] taken=new Event[events];
          int k;
          for (k=0; k < events; k++) {
            taken[k]=channel.take();
            if (taken[k] == null)             break;
          }
          if (rng.nextBoolean()) {
            try {
              tx.commit();
              for (              Event e : taken) {
                if (e == null)                 break;
                String index=new String(e.getBody());
synchronized (takeMapLock) {
                  AtomicInteger remain=committedTakes.get(index);
                  if (remain == null) {
                    committedTakes.put(index,new AtomicInteger(1));
                  }
 else {
                    remain.incrementAndGet();
                  }
                }
              }
            }
 catch (            ChannelException e) {
              System.out.print("takes commit failed");
              tx.rollback();
            }
          }
 else {
            tx.rollback();
          }
          tx.close();
        }
        endGate.countDown();
      }
    }
;
    t.start();
  }
  startGate.countDown();
  if (!endGate.await(20,TimeUnit.SECONDS)) {
    Assert.fail("Not all threads ended succesfully");
  }
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e;
  while ((e=channel.take()) != null) {
    String index=new String(e.getBody());
    AtomicInteger remain=committedPuts.get(index);
    int post=remain.decrementAndGet();
    if (post == 0) {
      committedPuts.remove(index);
    }
  }
  tx.commit();
  tx.close();
  for (  Entry<String,AtomicInteger> takes : committedTakes.entrySet()) {
    AtomicInteger count=committedPuts.get(takes.getKey());
    if (count == null)     Assert.fail("Putted data doesn't exist");
    if (count.get() != takes.getValue().get())     Assert.fail(String.format("Mismatched put and take counts expected %d had %d",count.get(),takes.getValue().get()));
    committedPuts.remove(takes.getKey());
  }
  if (!committedPuts.isEmpty())   Assert.fail("Puts still has entries remaining");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestMultiplexingChannelSelector </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoSelection() throws Exception {
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("default","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event noHeaderEvent=new MockEvent();
  List<Channel> reqCh1=selector.getRequiredChannels(noHeaderEvent);
  List<Channel> optCh1=selector.getOptionalChannels(noHeaderEvent);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertTrue(reqCh1.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh1.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh1.isEmpty());
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("someheader","foo");
  Event invalidHeaderEvent=new MockEvent();
  invalidHeaderEvent.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(invalidHeaderEvent);
  List<Channel> optCh2=selector.getOptionalChannels(invalidHeaderEvent);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertTrue(reqCh2.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh2.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh2.isEmpty());
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","bar1");
  Event unmatchedHeaderEvent=new MockEvent();
  unmatchedHeaderEvent.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(unmatchedHeaderEvent);
  List<Channel> optCh3=selector.getOptionalChannels(unmatchedHeaderEvent);
  Assert.assertEquals(2,reqCh3.size());
  Assert.assertTrue(reqCh3.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh3.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh3.isEmpty());
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  Event zebraEvent=new MockEvent();
  zebraEvent.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(zebraEvent);
  List<Channel> optCh4=selector.getOptionalChannels(zebraEvent);
  Assert.assertEquals(2,reqCh4.size());
  Assert.assertTrue(reqCh4.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh4.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh4.size() == 1);
  Assert.assertTrue(optCh4.get(0).getName().equals("ch2"));
  List<Channel> allChannels=selector.getAllChannels();
  Assert.assertTrue(allChannels.size() == 3);
  Assert.assertTrue(allChannels.get(0).getName().equals("ch1"));
  Assert.assertTrue(allChannels.get(1).getName().equals("ch2"));
  Assert.assertTrue(allChannels.get(2).getName().equals("ch3"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMandatory(){
  config.put("default","ch3");
  config.put("optional.foo","ch1 ch2");
  config.put("optional.zebra","ch2 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(1,reqCh1.size());
  Assert.assertEquals("ch3",reqCh1.get(0).getName());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertEquals(2,optCh1.size());
  Assert.assertEquals("ch1",optCh1.get(0).getName());
  Assert.assertEquals("ch2",optCh1.get(1).getName());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertEquals(1,reqCh4.size());
  Assert.assertTrue(reqCh4.get(0).getName().equals("ch3"));
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(1,optCh4.size());
  Assert.assertEquals("ch2",optCh4.get(0).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoDefault(){
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("mapping.zebra","ch2");
  config.put("optional.zebra","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertEquals("ch1",reqCh1.get(0).getName());
  Assert.assertEquals("ch2",reqCh1.get(1).getName());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertTrue(optCh1.size() == 1);
  Assert.assertEquals("ch3",optCh1.get(0).getName());
  Event event2=new MockEvent();
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("myheader","bar");
  event2.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(event2);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertEquals("ch2",reqCh2.get(0).getName());
  Assert.assertEquals("ch3",reqCh2.get(1).getName());
  List<Channel> optCh2=selector.getOptionalChannels(event2);
  Assert.assertTrue(optCh2.isEmpty());
  Event event3=new MockEvent();
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","xyz");
  event3.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(event3);
  Assert.assertEquals(3,reqCh3.size());
  Assert.assertEquals("ch1",reqCh3.get(0).getName());
  Assert.assertEquals("ch2",reqCh3.get(1).getName());
  Assert.assertEquals("ch3",reqCh3.get(2).getName());
  List<Channel> optCh3=selector.getOptionalChannels(event3);
  Assert.assertTrue(optCh3.isEmpty());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertEquals(1,reqCh4.size());
  Assert.assertEquals("ch2",reqCh4.get(0).getName());
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(2,optCh4.size());
  Assert.assertEquals("ch1",optCh4.get(0).getName());
  Assert.assertEquals("ch3",optCh4.get(1).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnlyOptional(){
  config.put("optional.foo","ch1 ch2");
  config.put("optional.zebra","ch2 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertTrue(reqCh1.isEmpty());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertEquals(2,optCh1.size());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertTrue(reqCh4.isEmpty());
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(2,optCh4.size());
  Assert.assertEquals("ch2",optCh4.get(0).getName());
  Assert.assertEquals("ch3",optCh4.get(1).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSelection() throws Exception {
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("default","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertTrue(reqCh1.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh1.get(1).getName().equals("ch2"));
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertTrue(optCh1.size() == 1);
  Assert.assertTrue(optCh1.get(0).getName().equals("ch3"));
  Event event2=new MockEvent();
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("myheader","bar");
  event2.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(event2);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertTrue(reqCh2.get(0).getName().equals("ch2"));
  Assert.assertTrue(reqCh2.get(1).getName().equals("ch3"));
  List<Channel> optCh2=selector.getOptionalChannels(event2);
  Assert.assertTrue(optCh2.isEmpty());
  Event event3=new MockEvent();
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","xyz");
  event3.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(event3);
  Assert.assertEquals(3,reqCh3.size());
  Assert.assertTrue(reqCh3.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh3.get(1).getName().equals("ch2"));
  Assert.assertTrue(reqCh3.get(2).getName().equals("ch3"));
  List<Channel> optCh3=selector.getOptionalChannels(event3);
  Assert.assertTrue(optCh3.size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestCheckpointRebuilder </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFastReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(50));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(50));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"checkpointBulder");
  channel.stop();
  File checkpointFile=new File(checkpointDir,"checkpoint");
  File metaDataFile=Serialization.getMetaDataFile(checkpointFile);
  File inflightTakesFile=new File(checkpointDir,"inflighttakes");
  File inflightPutsFile=new File(checkpointDir,"inflightputs");
  File queueSetDir=new File(checkpointDir,"queueset");
  Assert.assertTrue(checkpointFile.delete());
  Assert.assertTrue(metaDataFile.delete());
  Assert.assertTrue(inflightTakesFile.delete());
  Assert.assertTrue(inflightPutsFile.delete());
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpointFile,50,"test");
  FlumeEventQueue queue=new FlumeEventQueue(backingStore,inflightTakesFile,inflightPutsFile,queueSetDir);
  CheckpointRebuilder checkpointRebuilder=new CheckpointRebuilder(getAllLogs(dataDirs),queue,true);
  Assert.assertTrue(checkpointRebuilder.rebuild());
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestEventQueueBackingStoreFactory </h4><pre class="type-9 type-10 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCheckpointVersionNotEqualToMeta2() throws Exception {
  FileOutputStream os=null;
  try {
    EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
    backingStore.close();
    Assert.assertTrue(checkpoint.exists());
    Assert.assertTrue(Serialization.getMetaDataFile(checkpoint).length() != 0);
    FileInputStream is=new FileInputStream(Serialization.getMetaDataFile(checkpoint));
    ProtosFactory.Checkpoint meta=ProtosFactory.Checkpoint.parseDelimitedFrom(is);
    Assert.assertNotNull(meta);
    is.close();
    os=new FileOutputStream(Serialization.getMetaDataFile(checkpoint));
    meta.toBuilder().setVersion(2).build().writeDelimitedTo(os);
    os.flush();
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
  finally {
    os.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InvalidProtocolBufferException.class) public void testCorruptMeta() throws Throwable {
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  Assert.assertTrue(checkpoint.exists());
  File metaFile=Serialization.getMetaDataFile(checkpoint);
  Assert.assertTrue(metaFile.length() != 0);
  RandomAccessFile writer=new RandomAccessFile(metaFile,"rw");
  writer.seek(10);
  writer.writeLong(new Random().nextLong());
  writer.getFD().sync();
  writer.close();
  try {
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
 catch (  BadCheckpointException ex) {
    throw ex.getCause();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCheckpointOrderIdNotEqualToMeta2() throws Exception {
  FileOutputStream os=null;
  try {
    EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
    backingStore.close();
    Assert.assertTrue(checkpoint.exists());
    Assert.assertTrue(Serialization.getMetaDataFile(checkpoint).length() != 0);
    FileInputStream is=new FileInputStream(Serialization.getMetaDataFile(checkpoint));
    ProtosFactory.Checkpoint meta=ProtosFactory.Checkpoint.parseDelimitedFrom(is);
    Assert.assertNotNull(meta);
    is.close();
    os=new FileOutputStream(Serialization.getMetaDataFile(checkpoint));
    meta.toBuilder().setWriteOrderID(1).build().writeDelimitedTo(os);
    os.flush();
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
  finally {
    os.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testTruncateMeta() throws Exception {
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  Assert.assertTrue(checkpoint.exists());
  File metaFile=Serialization.getMetaDataFile(checkpoint);
  Assert.assertTrue(metaFile.length() != 0);
  RandomAccessFile writer=new RandomAccessFile(metaFile,"rw");
  writer.setLength(0);
  writer.getFD().sync();
  writer.close();
  backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestEventUtils </h4><pre class="type-9 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutEvent(){
  FlumeEvent event=new FlumeEvent(null,new byte[5]);
  Put put=new Put(1l,1l,event);
  Event returnEvent=EventUtils.getEventFromTransactionEvent(put);
  Assert.assertNotNull(returnEvent);
  Assert.assertEquals(5,returnEvent.getBody().length);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testInvalidEvent(){
  Take take=new Take(1l,1l);
  Event returnEvent=EventUtils.getEventFromTransactionEvent(take);
  Assert.assertNull(returnEvent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannel </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNegativeCapacities(){
  Map<String,String> parms=Maps.newHashMap();
  parms.put(FileChannelConfiguration.CAPACITY,"-3");
  parms.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"-1");
  parms.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"-2");
  FileChannel channel=createFileChannel(parms);
  Assert.assertTrue(field("capacity").ofType(Integer.class).in(channel).get() > 0);
  Assert.assertTrue(field("transactionCapacity").ofType(Integer.class).in(channel).get() > 0);
  Assert.assertTrue(field("checkpointInterval").ofType(Long.class).in(channel).get() > 0);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPutCheckpointCommitCheckpointReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"10000");
  FileChannel channel=createFileChannel(overrides);
  channel.start();
  Transaction tx=channel.getTransaction();
  Set<String> in=putWithoutCommit(channel,tx,"doubleCheckpoint",1);
  forceCheckpoint(channel);
  tx.commit();
  tx.close();
  forceCheckpoint(channel);
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,5);
  compareInputAndOut(in,out);
  channel.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPutForceCheckpointCommitReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"10000");
  FileChannel channel=createFileChannel(overrides);
  channel.start();
  Transaction tx=channel.getTransaction();
  Set<String> in=putWithoutCommit(channel,tx,"putWithoutCommit",1);
  forceCheckpoint(channel);
  tx.commit();
  tx.close();
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,1);
  compareInputAndOut(in,out);
  channel.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is here to make sure we can replay a full queue
 * when we have a PUT with a lower txid than the take which
 * made that PUT possible. Here we fill up the queue so
 * puts will block. Start the put (which assigns a txid)
 * and while it's blocking initiate a take. That will
 * allow the PUT to take place but at a lower txid
 * than the take and additionally with pre-FLUME-1432 with
 * the same timestamp. After FLUME-1432 the PUT will have a
 * lower txid but a higher write order id and we can see
 * which event occurred first.
 */
@Test public void testRaceFoundInFLUME1432() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.KEEP_ALIVE,String.valueOf(10L));
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(10));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(10));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  fillChannel(channel,"fillup");
  Future<String> put=Executors.newSingleThreadExecutor().submit(new Callable<String>(){
    @Override public String call() throws Exception {
      Set<String> result=putEvents(channel,"blocked-put",1,1);
      Assert.assertTrue(result.toString(),result.size() == 1);
      Iterator<String> iter=result.iterator();
      return iter.next();
    }
  }
);
  Thread.sleep(1000L);
  Set<String> result=takeEvents(channel,1,1);
  Assert.assertTrue(result.toString(),result.size() == 1);
  String putmsg=put.get();
  Assert.assertNotNull(putmsg);
  String takemsg=result.iterator().next();
  Assert.assertNotNull(takemsg);
  LOG.info("Got: put " + putmsg + ", take "+ takemsg);
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRollbackIncompleteTransaction() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,String.valueOf(Integer.MAX_VALUE));
  final FileChannel channel=createFileChannel(overrides);
  channel.start();
  FileBackedTransaction tx=(FileBackedTransaction)channel.getTransaction();
  InflightEventWrapper inflightPuts=field("inflightPuts").ofType(InflightEventWrapper.class).in(field("queue").ofType(FlumeEventQueue.class).in(tx).get()).get();
  tx.begin();
  for (int i=0; i < 100; i++) {
    channel.put(EventBuilder.withBody("TestEvent".getBytes()));
  }
  Assert.assertFalse(inflightPuts.getFileIDs().isEmpty());
  Assert.assertFalse(inflightPuts.getInFlightPointers().isEmpty());
  tx.rollback();
  tx.close();
  Assert.assertTrue(inflightPuts.getFileIDs().isEmpty());
  Assert.assertTrue(inflightPuts.getInFlightPointers().isEmpty());
  Assert.assertTrue(channel.getDepth() == 0);
  Set<String> in=putEvents(channel,"testing-rollbacks",100,100);
  tx=(FileBackedTransaction)channel.getTransaction();
  InflightEventWrapper inflightTakes=field("inflightTakes").ofType(InflightEventWrapper.class).in(field("queue").ofType(FlumeEventQueue.class).in(tx).get()).get();
  tx.begin();
  for (int i=0; i < 100; i++) {
    channel.take();
  }
  Assert.assertFalse(inflightTakes.getFileIDs().isEmpty());
  Assert.assertFalse(inflightTakes.getInFlightPointers().isEmpty());
  tx.rollback();
  tx.close();
  Assert.assertTrue(inflightTakes.getFileIDs().isEmpty());
  Assert.assertTrue(inflightTakes.getInFlightPointers().isEmpty());
  Assert.assertTrue(channel.getDepth() == in.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelRestart </h4><pre class="type-12 type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWithExtraLogs() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,"10");
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"10");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"extralogs");
  for (int i=0; i < dataDirs.length; i++) {
    File file=new File(dataDirs[i],Log.PREFIX + (1000 + i));
    Assert.assertTrue(file.createNewFile());
    Assert.assertTrue(file.length() == 0);
    File metaDataFile=Serialization.getMetaDataFile(file);
    File metaDataTempFile=Serialization.getMetaDataTempFile(metaDataFile);
    Assert.assertTrue(metaDataTempFile.createNewFile());
  }
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testDataFilesRequiredByBackupNotDeleted() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.USE_DUAL_CHECKPOINTS,"true");
  overrides.put(FileChannelConfiguration.MAX_FILE_SIZE,"1000");
  channel=createFileChannel(overrides);
  channel.start();
  String prefix="abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz";
  Assert.assertTrue(channel.isOpen());
  putEvents(channel,prefix,10,100);
  Set<String> origFiles=Sets.newHashSet();
  for (  File dir : dataDirs) {
    origFiles.addAll(Lists.newArrayList(dir.list()));
  }
  forceCheckpoint(channel);
  takeEvents(channel,10,50);
  long beforeSecondCheckpoint=System.currentTimeMillis();
  forceCheckpoint(channel);
  Set<String> newFiles=Sets.newHashSet();
  int olderThanCheckpoint=0;
  int totalMetaFiles=0;
  for (  File dir : dataDirs) {
    File[] metadataFiles=dir.listFiles(new FilenameFilter(){
      @Override public boolean accept(      File dir,      String name){
        if (name.endsWith(".meta")) {
          return true;
        }
        return false;
      }
    }
);
    totalMetaFiles=metadataFiles.length;
    for (    File metadataFile : metadataFiles) {
      if (metadataFile.lastModified() < beforeSecondCheckpoint) {
        olderThanCheckpoint++;
      }
    }
    newFiles.addAll(Lists.newArrayList(dir.list()));
  }
  Assert.assertTrue(olderThanCheckpoint > 0);
  Assert.assertTrue(totalMetaFiles != olderThanCheckpoint);
  Assert.assertTrue(newFiles.containsAll(origFiles));
  takeEvents(channel,10,50);
  forceCheckpoint(channel);
  newFiles=Sets.newHashSet();
  for (  File dir : dataDirs) {
    newFiles.addAll(Lists.newArrayList(dir.list()));
  }
  Assert.assertTrue(!newFiles.containsAll(origFiles));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelRollback </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollbackSimulatedCrashWithSink() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  int numEvents=100;
  LoggerSink sink=new LoggerSink();
  sink.setChannel(channel);
  CountingSinkRunner runner=new CountingSinkRunner(sink,numEvents - 1);
  runner.start();
  putEvents(channel,"rollback",10,numEvents);
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  byte[] bytes="rolled back".getBytes(Charsets.UTF_8);
  channel.put(EventBuilder.withBody(bytes));
  transaction.rollback();
  transaction.close();
  while (runner.isAlive()) {
    Thread.sleep(10L);
  }
  Assert.assertEquals(numEvents - 1,runner.getCount());
  for (  Exception ex : runner.getErrors()) {
    LOG.warn("Sink had error",ex);
  }
  Assert.assertEquals(Collections.EMPTY_LIST,runner.getErrors());
  channel.stop();
  channel=createFileChannel();
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,1,1);
  Assert.assertEquals(1,out.size());
  String s=out.iterator().next();
  Assert.assertTrue(s,s.startsWith("rollback-90-9"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFlumeEvent </h4><pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialization() throws IOException {
  Map<String,String> headers=Maps.newHashMap();
  headers.put("key","value");
  byte[] body="flume".getBytes(Charsets.UTF_8);
  FlumeEvent in=new FlumeEvent(headers,body);
  FlumeEvent out=FlumeEvent.from(TestUtils.toDataInput(in));
  Assert.assertEquals(headers,out.getHeaders());
  Assert.assertTrue(Arrays.equals(body,out.getBody()));
  in.setHeaders(null);
  in.setBody(null);
  out=FlumeEvent.from(TestUtils.toDataInput(in));
  Assert.assertEquals(Maps.newHashMap(),out.getHeaders());
  Assert.assertNull(out.getBody());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFlumeEventQueue </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTail1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCapacity() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,1,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertFalse(queue.addTail(pointer2));
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testWrappingCorrectly() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  int size=Integer.MAX_VALUE;
  for (int i=1; i <= size; i++) {
    if (!queue.addHead(new FlumeEventPointer(i,i))) {
      break;
    }
  }
  for (int i=queue.getSize() / 2; i > 0; i--) {
    Assert.assertNotNull(queue.removeHead(0));
  }
  for (int i=1; i <= size; i++) {
    if (!queue.addHead(new FlumeEventPointer(i,i))) {
      break;
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInflightTakes() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
  long txnID2=txnID1 + 1;
  queue.addTail(new FlumeEventPointer(1,1));
  queue.addTail(new FlumeEventPointer(2,1));
  queue.addTail(new FlumeEventPointer(2,2));
  queue.removeHead(txnID1);
  queue.removeHead(txnID2);
  queue.removeHead(txnID2);
  queue.checkpoint(true);
  TimeUnit.SECONDS.sleep(3L);
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightTakes();
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidCapacityNegative() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,-1,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadRemove1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.addHead(pointer1);
  Assert.assertTrue(queue.remove(pointer1));
  Assert.assertNull(queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailRemove1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
  Assert.assertNull(queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHead1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidCapacityZero() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,0,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnknownPointerDoesNotCauseSearch() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertFalse(queue.remove(pointer3));
  Assert.assertTrue(queue.remove(pointer1));
  Assert.assertTrue(queue.remove(pointer2));
  queue.replayComplete();
  Assert.assertEquals(2,queue.getSearchCount());
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testQueueIsEmptyAfterCreation() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertNull(queue.removeHead(0L));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCorruptInflightPuts() throws Exception {
  RandomAccessFile inflight=null;
  try {
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
    long txnID2=txnID1 + 1;
    queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
    queue.checkpoint(true);
    TimeUnit.SECONDS.sleep(3L);
    inflight=new RandomAccessFile(backingStoreSupplier.getInflightPuts(),"rw");
    inflight.seek(0);
    inflight.writeInt(new Random().nextInt());
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightPuts();
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
  }
  finally {
    inflight.close();
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailLarge() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  int size=500;
  Set<Integer> fileIDs=Sets.newHashSet();
  for (int i=1; i <= size; i++) {
    Assert.assertTrue(queue.addTail(new FlumeEventPointer(i,i)));
    fileIDs.add(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  for (int i=1; i <= size; i++) {
    Assert.assertEquals(new FlumeEventPointer(i,i),queue.removeHead(0));
    fileIDs.remove(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadRemove2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(pointer2,queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadLarge() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.replayComplete();
  int size=500;
  Set<Integer> fileIDs=Sets.newHashSet();
  for (int i=1; i <= size; i++) {
    Assert.assertTrue(queue.addHead(new FlumeEventPointer(i,i)));
    fileIDs.add(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  for (int i=size; i > 0; i--) {
    Assert.assertEquals(new FlumeEventPointer(i,i),queue.removeHead(0));
    fileIDs.remove(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailRemove2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertTrue(queue.addTail(pointer2));
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(pointer2,queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTail2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertTrue(queue.addTail(pointer2));
  Assert.assertEquals(Sets.newHashSet(1,2),queue.getFileIDs());
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(2),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCorruptInflightTakes() throws Exception {
  RandomAccessFile inflight=null;
  try {
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
    long txnID2=txnID1 + 1;
    queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
    queue.checkpoint(true);
    TimeUnit.SECONDS.sleep(3L);
    inflight=new RandomAccessFile(backingStoreSupplier.getInflightTakes(),"rw");
    inflight.seek(0);
    inflight.writeInt(new Random().nextInt());
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightTakes();
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
  }
  finally {
    inflight.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHead2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.replayComplete();
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertEquals(Sets.newHashSet(1,2),queue.getFileIDs());
  Assert.assertEquals(pointer2,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInflightPuts() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
  long txnID2=txnID1 + 1;
  queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
  queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
  queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
  queue.checkpoint(true);
  TimeUnit.SECONDS.sleep(3L);
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightPuts();
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLog </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCheckpointOnClose() throws Exception {
  log.close();
  log=new Log.Builder().setCheckpointInterval(1L).setMaxFileSize(MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setCheckpointOnClose(true).setChannelName("testLog").build();
  log.replay();
  FlumeEvent eventIn=TestUtils.newPersistableEvent();
  log.put(transactionID,eventIn);
  log.commitPut(transactionID);
  File checkPointMetaFile=FileUtils.listFiles(checkpointDir,new String[]{"meta"},false).iterator().next();
  long before=FileUtils.checksumCRC32(checkPointMetaFile);
  log.close();
  long after=FileUtils.checksumCRC32(checkPointMetaFile);
  Assert.assertFalse(before == after);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * After replay of the log, we should not find the event because the
 * put was rolled back
 */
@Test public void testPutRollback() throws IOException, InterruptedException {
  FlumeEvent eventIn=TestUtils.newPersistableEvent();
  long transactionID=++this.transactionID;
  log.put(transactionID,eventIn);
  log.rollback(transactionID);
  log.close();
  log=new Log.Builder().setCheckpointInterval(Long.MAX_VALUE).setMaxFileSize(FileChannelConfiguration.DEFAULT_MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setChannelName("testlog").build();
  log.replay();
  FlumeEventQueue queue=log.getFlumeEventQueue();
  Assert.assertNull(queue.removeHead(transactionID));
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLogs() throws IOException {
  File logDir=dataDirs[0];
  List<File> expected=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    File log=new File(logDir,Log.PREFIX + i);
    expected.add(log);
    Assert.assertTrue(log.isFile() || log.createNewFile());
    File metaDataFile=Serialization.getMetaDataFile(log);
    File metaDataTempFile=Serialization.getMetaDataTempFile(metaDataFile);
    File logGzip=new File(logDir,Log.PREFIX + i + ".gz");
    Assert.assertTrue(metaDataFile.isFile() || metaDataFile.createNewFile());
    Assert.assertTrue(metaDataTempFile.isFile() || metaDataTempFile.createNewFile());
    Assert.assertTrue(log.isFile() || logGzip.createNewFile());
  }
  List<File> actual=LogUtils.getLogs(logDir);
  LogUtils.sort(actual);
  LogUtils.sort(expected);
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLogFile </h4><pre class="type-12 type-9 type-13 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderTempMetaFile() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  File metadataFile=Serialization.getMetaDataFile(dataFile);
  File tempMetadataFile=Serialization.getMetaDataTempFile(dataFile);
  File oldMetadataFile=Serialization.getOldMetaDataFile(dataFile);
  oldMetadataFile.createNewFile();
  if (!metadataFile.renameTo(tempMetadataFile)) {
    Assert.fail("Renaming to meta.temp failed");
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  Assert.assertTrue(metadataFile.exists());
  Assert.assertFalse(tempMetadataFile.exists());
  Assert.assertFalse(oldMetadataFile.exists());
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderOldMetaFile() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  File metadataFile=Serialization.getMetaDataFile(dataFile);
  File oldMetadataFile=Serialization.getOldMetaDataFile(dataFile);
  if (!metadataFile.renameTo(oldMetadataFile)) {
    Assert.fail("Renaming to meta.old failed");
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  Assert.assertTrue(metadataFile.exists());
  Assert.assertFalse(oldMetadataFile.exists());
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReader() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutGet() throws InterruptedException, IOException {
  final List<Throwable> errors=Collections.synchronizedList(new ArrayList<Throwable>());
  ExecutorService executorService=Executors.newFixedThreadPool(10);
  CompletionService<Void> completionService=new ExecutorCompletionService<Void>(executorService);
  final LogFile.RandomReader logFileReader=LogFileFactory.getRandomReader(dataFile,null,true);
  for (int i=0; i < 1000; i++) {
synchronized (errors) {
      for (      Throwable throwable : errors) {
        Throwables.propagateIfInstanceOf(throwable,AssertionError.class);
      }
      for (      Throwable throwable : errors) {
        Throwables.propagate(throwable);
      }
    }
    final FlumeEvent eventIn=TestUtils.newPersistableEvent();
    final Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    final int offset=ptr.getOffset();
    completionService.submit(new Runnable(){
      @Override public void run(){
        try {
          FlumeEvent eventOut=logFileReader.get(offset);
          Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
          Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
        }
 catch (        Throwable throwable) {
synchronized (errors) {
            errors.add(throwable);
          }
        }
      }
    }
,null);
  }
  for (int i=0; i < 1000; i++) {
    completionService.take();
  }
  for (  Throwable throwable : errors) {
    Throwables.propagateIfInstanceOf(throwable,AssertionError.class);
  }
  for (  Throwable throwable : errors) {
    Throwables.propagate(throwable);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLogRecord </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSortOrder(){
  long now=System.currentTimeMillis();
  List<LogRecord> records=Lists.newArrayList();
  for (int i=0; i < 3; i++) {
    Commit commit=new Commit((long)i,now - i);
    LogRecord logRecord=new LogRecord(1,i,commit);
    records.add(logRecord);
  }
  LogRecord logRecord;
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),2 == logRecord.getOffset());
  records.remove(logRecord);
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),1 == logRecord.getOffset());
  records.remove(logRecord);
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),0 == logRecord.getOffset());
  records.remove(logRecord);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestTransactionEventRecordV2 </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRollbackSerialization() throws IOException {
  Rollback in=new Rollback(System.currentTimeMillis(),WriteOrderOracle.next());
  Rollback out=(Rollback)TransactionEventRecord.fromDataInputV2(toDataInput(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTakeSerialization() throws IOException {
  Take in=new Take(System.currentTimeMillis(),WriteOrderOracle.next(),10,20);
  Take out=(Take)TransactionEventRecord.fromDataInputV2(toDataInput(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getFileID(),out.getFileID());
  Assert.assertEquals(in.getOffset(),out.getOffset());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCommitSerialization() throws IOException {
  Commit in=new Commit(System.currentTimeMillis(),WriteOrderOracle.next());
  Commit out=(Commit)TransactionEventRecord.fromDataInputV2(toDataInput(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerialization() throws IOException {
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(new HashMap<String,String>(),new byte[0]));
  Put out=(Put)TransactionEventRecord.fromDataInputV2(toDataInput(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getEvent().getHeaders(),out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestTransactionEventRecordV3 </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTakeSerialization() throws IOException, CorruptEventException {
  Take in=new Take(System.currentTimeMillis(),WriteOrderOracle.next(),10,20);
  Take out=(Take)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getFileID(),out.getFileID());
  Assert.assertEquals(in.getOffset(),out.getOffset());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerialization() throws IOException, CorruptEventException {
  Map<String,String> headers=new HashMap<String,String>();
  headers.put("key","value");
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(headers,new byte[0]));
  Put out=(Put)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getEvent().getHeaders(),out.getEvent().getHeaders());
  Assert.assertEquals(headers,in.getEvent().getHeaders());
  Assert.assertEquals(headers,out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCommitSerialization() throws IOException, CorruptEventException {
  Commit in=new Commit(System.currentTimeMillis(),WriteOrderOracle.next());
  Commit out=(Commit)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerializationNullHeader() throws IOException, CorruptEventException {
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(null,new byte[0]));
  Put out=(Put)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertNull(in.getEvent().getHeaders());
  Assert.assertNotNull(out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRollbackSerialization() throws IOException, CorruptEventException {
  Rollback in=new Rollback(System.currentTimeMillis(),WriteOrderOracle.next());
  Rollback out=(Rollback)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.jdbc.BaseJdbcChannelProviderTest </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Creates 120 events split over 10 channels, stores them via multiple
 * simulated sources and consumes them via multiple simulated channels.
 */
@Test public void testEventWithSimulatedSourceAndSinks() throws Exception {
  provider=new JdbcChannelProviderImpl();
  provider.initialize(derbyCtx);
  Map<String,List<MockEvent>> eventMap=new HashMap<String,List<MockEvent>>();
  for (int i=1; i < 121; i++) {
    MockEvent me=MockEventUtils.generateMockEvent(i,i,i,61 % i,10);
    List<MockEvent> meList=eventMap.get(me.getChannel());
    if (meList == null) {
      meList=new ArrayList<MockEvent>();
      eventMap.put(me.getChannel(),meList);
    }
    meList.add(me);
  }
  List<MockSource> sourceList=new ArrayList<MockSource>();
  List<MockSink> sinkList=new ArrayList<MockSink>();
  for (  String channel : eventMap.keySet()) {
    List<MockEvent> meList=eventMap.get(channel);
    sourceList.add(new MockSource(channel,meList,provider));
    sinkList.add(new MockSink(channel,meList,provider));
  }
  ExecutorService sourceExecutor=Executors.newFixedThreadPool(10);
  ExecutorService sinkExecutor=Executors.newFixedThreadPool(10);
  List<Future<Integer>> srcResults=sourceExecutor.invokeAll(sourceList,300,TimeUnit.SECONDS);
  Thread.sleep(MockEventUtils.generateSleepInterval(3000));
  List<Future<Integer>> sinkResults=sinkExecutor.invokeAll(sinkList,300,TimeUnit.SECONDS);
  int srcCount=0;
  for (  Future<Integer> srcOutput : srcResults) {
    srcCount+=srcOutput.get();
  }
  Assert.assertEquals(120,srcCount);
  int sinkCount=0;
  for (  Future<Integer> sinkOutput : sinkResults) {
    sinkCount+=sinkOutput.get();
  }
  Assert.assertEquals(120,sinkCount);
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-11 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDerbyChannelCapacity(){
  provider=new JdbcChannelProviderImpl();
  derbyCtx.put(ConfigurationConstants.CONFIG_MAX_CAPACITY,"10");
  provider.initialize(derbyCtx);
  Set<MockEvent> events=new HashSet<MockEvent>();
  for (int i=1; i < 12; i++) {
    events.add(MockEventUtils.generateMockEvent(i,i,i,61 % i,1));
  }
  Iterator<MockEvent> meIt=events.iterator();
  int count=0;
  while (meIt.hasNext()) {
    count++;
    MockEvent me=meIt.next();
    String chName=me.getChannel();
    try {
      provider.persistEvent(chName,me);
      if (count == 11) {
        Assert.fail();
      }
    }
 catch (    JdbcChannelException ex) {
      Assert.assertEquals(11,count);
    }
    Event e=provider.removeEvent(chName);
    Assert.assertNotNull(e);
    provider.persistEvent(chName,me);
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * creates 80 events split over 5 channels, stores them
 */
@Test public void testPeristingEvents(){
  provider=new JdbcChannelProviderImpl();
  provider.initialize(derbyCtx);
  Map<String,List<MockEvent>> eventMap=new HashMap<String,List<MockEvent>>();
  Set<MockEvent> events=new HashSet<MockEvent>();
  for (int i=1; i < 81; i++) {
    events.add(MockEventUtils.generateMockEvent(i,i,i,61 % i,5));
  }
  Iterator<MockEvent> meIt=events.iterator();
  while (meIt.hasNext()) {
    MockEvent me=meIt.next();
    String chName=me.getChannel();
    List<MockEvent> eventList=eventMap.get(chName);
    if (eventList == null) {
      eventList=new ArrayList<MockEvent>();
      eventMap.put(chName,eventList);
    }
    eventList.add(me);
    provider.persistEvent(me.getChannel(),me);
  }
  for (  String chName : eventMap.keySet()) {
    List<MockEvent> meList=eventMap.get(chName);
    Iterator<MockEvent> it=meList.iterator();
    while (it.hasNext()) {
      MockEvent me=it.next();
      Event event=provider.removeEvent(chName);
      assertEquals(me,event);
    }
    Event nullEvent=provider.removeEvent(chName);
    Assert.assertNull(nullEvent);
  }
  provider.close();
  provider=null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.jdbc.TestDatabaseTypeEnum </h4><pre class="type-9 type-1 type-14 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseTypeLookup(){
  for (  String key : enumMap.keySet()) {
    DatabaseType type=enumMap.get(key);
    DatabaseType lookupType=DatabaseType.valueOf(key);
    String lookupTypeName=lookupType.getName();
    Assert.assertEquals(lookupTypeName,lookupType.toString());
    Assert.assertSame(type,lookupType);
    Assert.assertEquals(key,lookupTypeName);
    DatabaseType lookupType2=DatabaseType.getByName(key.toLowerCase(Locale.ENGLISH));
    Assert.assertSame(type,lookupType2);
  }
}

</code></pre>

<br>
<pre class="type-9 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testUnknonwnDatabaseTypeLookup(){
  String[] invalidTypes=new String[]{"foo","bar","abcd"};
  for (  String key : invalidTypes) {
    DatabaseType type=DatabaseType.getByName(key);
    Assert.assertSame(type,DatabaseType.OTHER);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.jdbc.TestTransactionIsolationLevelEnum </h4><pre class="type-9 type-1 type-14 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReverseLookup(){
  for (  String key : enumMap.keySet()) {
    TransactionIsolation txIsolation=enumMap.get(key);
    TransactionIsolation lookupTxIsolation=TransactionIsolation.valueOf(key);
    String lookupTxIsolationName=lookupTxIsolation.getName();
    Assert.assertEquals(lookupTxIsolationName,lookupTxIsolation.toString());
    Assert.assertSame(txIsolation,lookupTxIsolation);
    Assert.assertEquals(key,lookupTxIsolationName);
    TransactionIsolation lookupTxIsolation2=TransactionIsolation.getByName(key.toLowerCase(Locale.ENGLISH));
    Assert.assertSame(txIsolation,lookupTxIsolation2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestBufferedLineReader </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleRead() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  SimpleTextLineEventReader reader=new SimpleTextLineEventReader(new FileReader(f1));
  assertEquals("file1line1",bodyAsString(reader.readEvent()));
  assertEquals("file1line2",bodyAsString(reader.readEvent()));
  assertEquals("file1line3",bodyAsString(reader.readEvent()));
  assertEquals("file1line4",bodyAsString(reader.readEvent()));
  assertEquals("file1line5",bodyAsString(reader.readEvent()));
  assertEquals("file1line6",bodyAsString(reader.readEvent()));
  assertEquals("file1line7",bodyAsString(reader.readEvent()));
  assertEquals("file1line8",bodyAsString(reader.readEvent()));
  assertEquals(null,reader.readEvent());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsWithinAFile() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  SimpleTextLineEventReader reader=new SimpleTextLineEventReader(new FileReader(f1));
  List<String> out=bodiesAsStrings(reader.readEvents(5));
  assertEquals(5,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsAtFileBoundary() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  SimpleTextLineEventReader reader=new SimpleTextLineEventReader(new FileReader(f1));
  List<String> out=bodiesAsStrings(reader.readEvents(10));
  assertEquals(8,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
  assertTrue(out.contains("file1line6"));
  assertTrue(out.contains("file1line7"));
  assertTrue(out.contains("file1line8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestReliableSpoolingFileEventReader </h4><pre class="type-12 type-9 type-13 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepeatedCallsWithCommitOnSuccess() throws IOException {
  String trackerDirPath=SpoolDirectorySourceConfigurationConstants.DEFAULT_TRACKER_DIR;
  File trackerDir=new File(WORK_DIR,trackerDirPath);
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).trackerDirPath(trackerDirPath).build();
  final int expectedLines=0 + 1 + 2+ 3+ 1;
  int seenLines=0;
  for (int i=0; i < 10; i++) {
    List<Event> events=reader.readEvents(10);
    int numEvents=events.size();
    if (numEvents > 0) {
      seenLines+=numEvents;
      reader.commit();
      File[] files=trackerDir.listFiles();
      Assert.assertNotNull(files);
      Assert.assertTrue("Expected tracker files in tracker dir " + trackerDir.getAbsolutePath(),files.length > 0);
    }
  }
  Assert.assertEquals(expectedLines,seenLines);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileDeletion() throws IOException {
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).deletePolicy(DeletePolicy.IMMEDIATE.name()).build();
  List<File> before=listFiles(WORK_DIR);
  Assert.assertEquals("Expected 5, not: " + before,5,before.size());
  List<Event> events;
  do {
    events=reader.readEvents(10);
    reader.commit();
  }
 while (!events.isEmpty());
  List<File> after=listFiles(WORK_DIR);
  Assert.assertEquals("Expected 0, not: " + after,0,after.size());
  List<File> trackerFiles=listFiles(new File(WORK_DIR,SpoolDirectorySourceConfigurationConstants.DEFAULT_TRACKER_DIR));
  Assert.assertEquals("Expected 0, not: " + trackerFiles,0,trackerFiles.size());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsumeFileRandomlyNewFile() throws Exception {
  if (SystemUtils.IS_OS_WINDOWS) {
    return;
  }
  final ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).consumeOrder(ConsumeOrder.RANDOM).build();
  File fileName=new File(WORK_DIR,"new-file");
  FileUtils.write(fileName,"New file created in the end. Shoud be read randomly.\n");
  Set<String> expected=Sets.newHashSet();
  int totalFiles=WORK_DIR.listFiles().length;
  final Set<String> actual=Sets.newHashSet();
  ExecutorService executor=Executors.newSingleThreadExecutor();
  final Semaphore semaphore1=new Semaphore(0);
  final Semaphore semaphore2=new Semaphore(0);
  Future<Void> wait=executor.submit(new Callable<Void>(){
    @Override public Void call() throws Exception {
      readEventsForFilesInDir(WORK_DIR,reader,actual,semaphore1,semaphore2);
      return null;
    }
  }
);
  semaphore1.acquire();
  File finalFile=new File(WORK_DIR,"t-file");
  FileUtils.write(finalFile,"Last file");
  semaphore2.release();
  wait.get();
  int listFilesCount=((ReliableSpoolingFileEventReader)reader).getListFilesCount();
  finalFile.delete();
  createExpectedFromFilesInSetup(expected);
  expected.add("");
  expected.add("New file created in the end. Shoud be read randomly.");
  expected.add("Last file");
  Assert.assertTrue(listFilesCount < (totalFiles + 2));
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIgnorePattern() throws IOException {
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).ignorePattern("^file2$").deletePolicy(DeletePolicy.IMMEDIATE.toString()).build();
  List<File> before=listFiles(WORK_DIR);
  Assert.assertEquals("Expected 5, not: " + before,5,before.size());
  List<Event> events;
  do {
    events=reader.readEvents(10);
    reader.commit();
  }
 while (!events.isEmpty());
  List<File> after=listFiles(WORK_DIR);
  Assert.assertEquals("Expected 1, not: " + after,1,after.size());
  Assert.assertEquals("file2",after.get(0).getName());
  List<File> trackerFiles=listFiles(new File(WORK_DIR,SpoolDirectorySourceConfigurationConstants.DEFAULT_TRACKER_DIR));
  Assert.assertEquals("Expected 0, not: " + trackerFiles,0,trackerFiles.size());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRepeatedCallsWithCommitAlways() throws IOException {
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).build();
  final int expectedLines=0 + 1 + 2+ 3+ 1;
  int seenLines=0;
  for (int i=0; i < 10; i++) {
    List<Event> events=reader.readEvents(10);
    seenLines+=events.size();
    reader.commit();
  }
  Assert.assertEquals(expectedLines,seenLines);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testZeroByteTrackerFile() throws IOException {
  String trackerDirPath=SpoolDirectorySourceConfigurationConstants.DEFAULT_TRACKER_DIR;
  File trackerDir=new File(WORK_DIR,trackerDirPath);
  if (!trackerDir.exists()) {
    trackerDir.mkdir();
  }
  File trackerFile=new File(trackerDir,ReliableSpoolingFileEventReader.metaFileName);
  if (trackerFile.exists()) {
    trackerFile.delete();
  }
  trackerFile.createNewFile();
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).trackerDirPath(trackerDirPath).build();
  final int expectedLines=1;
  int seenLines=0;
  List<Event> events=reader.readEvents(10);
  int numEvents=events.size();
  if (numEvents > 0) {
    seenLines+=numEvents;
    reader.commit();
  }
  Assert.assertEquals(expectedLines,seenLines);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestSpoolingFileLineReader </h4><pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBehaviorWithEmptyFile() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file0");
  Files.touch(f1);
  ReliableSpoolingFileEventReader parser=getParser();
  File f2=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f2,Charsets.UTF_8);
  List<String> out=bodiesAsStrings(parser.readEvents(8));
  parser.commit();
  assertEquals(8,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
  assertTrue(out.contains("file1line6"));
  assertTrue(out.contains("file1line7"));
  assertTrue(out.contains("file1line8"));
  assertNull(parser.readEvent());
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue("Outfiles should have file0 & file1: " + outFiles,outFiles.contains(new File(tmpDir + "/file0" + completedSuffix)));
  assertTrue("Outfiles should have file0 & file1: " + outFiles,outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDestinationExistsAndSameFileWindows() throws IOException {
  System.setProperty("os.name","Some version of Windows");
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  File f1Completed=new File(tmpDir.getAbsolutePath() + "/file1" + completedSuffix);
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.write("file1line1\nfile1line2\n",f1Completed,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out=Lists.newArrayList();
  for (int i=0; i < 2; i++) {
    out.add(bodyAsString(parser.readEvent()));
    parser.commit();
  }
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  for (int i=0; i < 2; i++) {
    out.add(bodyAsString(parser.readEvent()));
    parser.commit();
  }
  assertEquals(4,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file2line1"));
  assertTrue(out.contains("file2line2"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsAcrossFileBoundary() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out1=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\nfile2line3\nfile2line4\n" + "file2line5\nfile2line6\nfile2line7\nfile2line8\n",f2,Charsets.UTF_8);
  List<String> out2=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  assertEquals(5,out1.size());
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  assertEquals(3,out2.size());
  assertTrue(out2.contains("file1line6"));
  assertTrue(out2.contains("file1line7"));
  assertTrue(out2.contains("file1line8"));
  assertEquals(5,out3.size());
  assertTrue(out3.contains("file2line1"));
  assertTrue(out3.contains("file2line2"));
  assertTrue(out3.contains("file2line3"));
  assertTrue(out3.contains("file2line4"));
  assertTrue(out3.contains("file2line5"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicSpooling() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  File f3=new File(tmpDir.getAbsolutePath() + "/file3");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  Files.write("file3line1\nfile3line2\n",f3,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out=Lists.newArrayList();
  for (int i=0; i < 6; i++) {
    logger.info("At line {}",i);
    String body=bodyAsString(parser.readEvent());
    logger.debug("Seen event with body: {}",body);
    out.add(body);
    parser.commit();
  }
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file2line1"));
  assertTrue(out.contains("file2line2"));
  assertTrue(out.contains("file3line1"));
  assertTrue(out.contains("file3line2"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(3,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file3")));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitiallyEmptyDirectory() throws IOException {
  ReliableSpoolingFileEventReader parser=getParser();
  assertNull(parser.readEvent());
  assertEquals(0,parser.readEvents(10).size());
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  List<String> out=bodiesAsStrings(parser.readEvents(2));
  parser.commit();
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  parser.readEvent();
  parser.commit();
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLineExceedsMaxLineLength() throws IOException {
  final int maxLineLength=12;
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n" + "reallyreallyreallyreallyLongLineHerefile1line9\n"+ "file1line10\nfile1line11\nfile1line12\nfile1line13\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser(maxLineLength);
  List<String> out1=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  parser.commit();
  List<String> out2=bodiesAsStrings(parser.readEvents(4));
  assertTrue(out2.contains("file1line6"));
  assertTrue(out2.contains("file1line7"));
  assertTrue(out2.contains("file1line8"));
  assertTrue(out2.contains("reallyreally"));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out3.contains("reallyreally"));
  assertTrue(out3.contains("LongLineHere"));
  assertTrue(out3.contains("file1line9"));
  assertTrue(out3.contains("file1line10"));
  assertTrue(out3.contains("file1line11"));
  parser.commit();
  List<String> out4=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out4.contains("file1line12"));
  assertTrue(out4.contains("file1line13"));
  assertEquals(2,out4.size());
  parser.commit();
  assertEquals(0,parser.readEvents(5).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.clients.log4jappender.TestLog4jAppender </h4><pre class="type-12 type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLog4jAppender() throws IOException {
  configureSource();
  PropertyConfigurator.configure(props);
  Logger logger=LogManager.getLogger(TestLog4jAppender.class);
  for (int count=0; count <= 1000; count++) {
    int level=((count % 5) + 1) * 10000;
    String msg="This is log message number" + String.valueOf(count);
    logger.log(Level.toLevel(level),msg);
    Transaction transaction=ch.getTransaction();
    transaction.begin();
    Event event=ch.take();
    Assert.assertNotNull(event);
    Assert.assertEquals(new String(event.getBody(),"UTF8"),msg);
    Map<String,String> hdrs=event.getHeaders();
    Assert.assertNotNull(hdrs.get(Log4jAvroHeaders.TIMESTAMP.toString()));
    Assert.assertEquals(Level.toLevel(level),Level.toLevel(Integer.valueOf(hdrs.get(Log4jAvroHeaders.LOG_LEVEL.toString()))));
    Assert.assertEquals(logger.getName(),hdrs.get(Log4jAvroHeaders.LOGGER_NAME.toString()));
    Assert.assertEquals("UTF8",hdrs.get(Log4jAvroHeaders.MESSAGE_ENCODING.toString()));
    transaction.commit();
    transaction.close();
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLayout() throws IOException {
  configureSource();
  props.put("log4j.appender.out2.layout","org.apache.log4j.PatternLayout");
  props.put("log4j.appender.out2.layout.ConversionPattern","%-5p [%t]: %m%n");
  PropertyConfigurator.configure(props);
  Logger logger=LogManager.getLogger(TestLog4jAppender.class);
  Thread.currentThread().setName("Log4jAppenderTest");
  for (int count=0; count <= 100; count++) {
    int level=((count % 5) + 1) * 10000;
    String msg="This is log message number" + String.valueOf(count);
    logger.log(Level.toLevel(level),msg);
    Transaction transaction=ch.getTransaction();
    transaction.begin();
    Event event=ch.take();
    Assert.assertNotNull(event);
    StringBuilder builder=new StringBuilder();
    builder.append("[").append("Log4jAppenderTest").append("]: ").append(msg);
    String eventBody=new String(event.getBody(),"UTF-8");
    String eventLevel=eventBody.split("\\s+")[0];
    Assert.assertEquals(Level.toLevel(level).toString(),eventLevel);
    Assert.assertEquals(new String(event.getBody(),"UTF8").trim().substring(eventLevel.length()).trim(),builder.toString());
    Map<String,String> hdrs=event.getHeaders();
    Assert.assertNotNull(hdrs.get(Log4jAvroHeaders.TIMESTAMP.toString()));
    Assert.assertEquals(Level.toLevel(level),Level.toLevel(Integer.parseInt(hdrs.get(Log4jAvroHeaders.LOG_LEVEL.toString()))));
    Assert.assertEquals(logger.getName(),hdrs.get(Log4jAvroHeaders.LOGGER_NAME.toString()));
    Assert.assertEquals("UTF8",hdrs.get(Log4jAvroHeaders.MESSAGE_ENCODING.toString()));
    transaction.commit();
    transaction.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.clients.log4jappender.TestLog4jAppenderWithAvro </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAvroReflect() throws IOException {
  loadProperties("flume-log4jtest-avro-reflect.properties");
  PropertyConfigurator.configure(props);
  Logger logger=LogManager.getLogger(TestLog4jAppenderWithAvro.class);
  String msg="This is log message number " + String.valueOf(0);
  AppEvent appEvent=new AppEvent();
  appEvent.setMessage(msg);
  logger.info(appEvent);
  Transaction transaction=ch.getTransaction();
  transaction.begin();
  Event event=ch.take();
  Assert.assertNotNull(event);
  Schema schema=ReflectData.get().getSchema(appEvent.getClass());
  ReflectDatumReader<AppEvent> reader=new ReflectDatumReader<AppEvent>(AppEvent.class);
  BinaryDecoder decoder=DecoderFactory.get().binaryDecoder(event.getBody(),null);
  AppEvent recordFromEvent=reader.read(null,decoder);
  Assert.assertEquals(msg,recordFromEvent.getMessage());
  Map<String,String> hdrs=event.getHeaders();
  Assert.assertNull(hdrs.get(Log4jAvroHeaders.MESSAGE_ENCODING.toString()));
  Assert.assertNull("Schema URL should not be set",hdrs.get(Log4jAvroHeaders.AVRO_SCHEMA_URL.toString()));
  Assert.assertEquals("Schema string should be set",schema.toString(),hdrs.get(Log4jAvroHeaders.AVRO_SCHEMA_LITERAL.toString()));
  transaction.commit();
  transaction.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.event.TestEventBuilder </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeaders(){
  Map<String,String> headers=new HashMap<String,String>();
  headers.put("one","1");
  headers.put("two","2");
  Event e1=EventBuilder.withBody("e1".getBytes(),headers);
  Assert.assertNotNull(e1);
  Assert.assertArrayEquals("e1 has the proper body","e1".getBytes(),e1.getBody());
  Assert.assertEquals("e1 has the proper headers",2,e1.getHeaders().size());
  Assert.assertEquals("e1 has a one key","1",e1.getHeaders().get("one"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.event.TestEventHelper </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPrintable(){
  SimpleEvent event=new SimpleEvent();
  event.setBody("Some text".getBytes());
  String eventDump=EventHelper.dumpEvent(event);
  System.out.println(eventDump);
  Assert.assertTrue(eventDump,eventDump.contains("Some text"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNonPrintable(){
  SimpleEvent event=new SimpleEvent();
  byte[] body=new byte[5];
  event.setBody(body);
  String eventDump=EventHelper.dumpEvent(event);
  Assert.assertTrue(eventDump,eventDump.contains("....."));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.formatter.output.TestBucketPath </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateRace(){
  Clock mockClock=mock(Clock.class);
  DateTimeFormatter parser=ISODateTimeFormat.dateTimeParser();
  long two=parser.parseMillis("2013-04-21T02:59:59-00:00");
  long three=parser.parseMillis("2013-04-21T03:00:00-00:00");
  when(mockClock.currentTimeMillis()).thenReturn(two,three);
  Clock origClock=BucketPath.getClock();
  BucketPath.setClock(mockClock);
  String pat="%H:%M";
  String escaped=BucketPath.escapeString(pat,new HashMap<String,String>(),TimeZone.getTimeZone("UTC"),true,Calendar.MINUTE,10,true);
  BucketPath.setClock(origClock);
  Assert.assertEquals("Race condition detected","02:50",escaped);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateFormatSeconds(){
  String test="%s";
  String escapedString=BucketPath.escapeString(test,headers,true,Calendar.SECOND,5);
  System.out.println("Escaped String: " + escapedString);
  Calendar cal2=Calendar.getInstance();
  cal2.set(2012,5,23,13,46,30);
  cal2.set(Calendar.MILLISECOND,0);
  String expectedString=String.valueOf(cal2.getTimeInMillis() / 1000);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateFormatHours(){
  String test="%c";
  String escapedString=BucketPath.escapeString(test,headers,true,Calendar.HOUR_OF_DAY,12);
  System.out.println("Escaped String: " + escapedString);
  Calendar cal2=Calendar.getInstance();
  cal2.set(2012,5,23,12,0,0);
  cal2.set(Calendar.MILLISECOND,0);
  SimpleDateFormat format=new SimpleDateFormat("EEE MMM d HH:mm:ss yyyy");
  Date d=new Date(cal2.getTimeInMillis());
  String expectedString=format.format(d);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateFormatCache(){
  TimeZone utcTimeZone=TimeZone.getTimeZone("UTC");
  String test="%c";
  BucketPath.escapeString(test,headers,utcTimeZone,false,Calendar.HOUR_OF_DAY,12,false);
  String escapedString=BucketPath.escapeString(test,headers,false,Calendar.HOUR_OF_DAY,12);
  System.out.println("Escaped String: " + escapedString);
  SimpleDateFormat format=new SimpleDateFormat("EEE MMM d HH:mm:ss yyyy");
  Date d=new Date(cal.getTimeInMillis());
  String expectedString=format.format(d);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateFormatTimeZone(){
  TimeZone utcTimeZone=TimeZone.getTimeZone("UTC");
  String test="%c";
  String escapedString=BucketPath.escapeString(test,headers,utcTimeZone,false,Calendar.HOUR_OF_DAY,12,false);
  System.out.println("Escaped String: " + escapedString);
  SimpleDateFormat format=new SimpleDateFormat("EEE MMM d HH:mm:ss yyyy");
  format.setTimeZone(utcTimeZone);
  Date d=new Date(cal.getTimeInMillis());
  String expectedString=format.format(d);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoRounding(){
  String test="%c";
  String escapedString=BucketPath.escapeString(test,headers,false,Calendar.HOUR_OF_DAY,12);
  System.out.println("Escaped String: " + escapedString);
  SimpleDateFormat format=new SimpleDateFormat("EEE MMM d HH:mm:ss yyyy");
  Date d=new Date(cal.getTimeInMillis());
  String expectedString=format.format(d);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoPadding(){
  Calendar calender;
  Map<String,String> calender_timestamp;
  calender=Calendar.getInstance();
  calender.set(2014,(5 - 1),3,13,46,33);
  calender_timestamp=new HashMap<String,String>();
  calender_timestamp.put("timestamp",String.valueOf(calender.getTimeInMillis()));
  SimpleDateFormat format=new SimpleDateFormat("M-d");
  String test="%n-%e";
  String escapedString=BucketPath.escapeString(test,calender_timestamp,false,Calendar.HOUR_OF_DAY,12);
  Date d=new Date(calender.getTimeInMillis());
  String expectedString=format.format(d);
  calender.set(2014,(11 - 1),13,13,46,33);
  calender_timestamp.put("timestamp",String.valueOf(calender.getTimeInMillis()));
  escapedString+=" " + BucketPath.escapeString(test,calender_timestamp,false,Calendar.HOUR_OF_DAY,12);
  System.out.println("Escaped String: " + escapedString);
  d=new Date(calender.getTimeInMillis());
  expectedString+=" " + format.format(d);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateFormatMinutes(){
  String test="%s";
  String escapedString=BucketPath.escapeString(test,headers,true,Calendar.MINUTE,5);
  System.out.println("Escaped String: " + escapedString);
  Calendar cal2=Calendar.getInstance();
  cal2.set(2012,5,23,13,45,0);
  cal2.set(Calendar.MILLISECOND,0);
  String expectedString=String.valueOf(cal2.getTimeInMillis() / 1000);
  System.out.println("Expected String: " + expectedString);
  Assert.assertEquals(expectedString,escapedString);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.instrumentation.TestMonitoredCounterGroup </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testChannelCounter() throws Exception {
  String name=getRandomName();
  ChannelCounter chc=new ChannelCounter(name);
  chc.register();
  ObjectName on=new ObjectName(CHANNEL_OBJ_NAME_PREFIX + name);
  assertChCounterState(on,0L,0L,0L,0L,0L);
  Assert.assertTrue("StartTime",getStartTime(on) == 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  chc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int numChannelSize=random.nextInt(MAX_BOUNDS);
  int numEventPutAttempt=random.nextInt(MAX_BOUNDS);
  int numEventTakeAttempt=random.nextInt(MAX_BOUNDS);
  int numEventPutSuccess=random.nextInt(MAX_BOUNDS);
  int numEventTakeSuccess=random.nextInt(MAX_BOUNDS);
  chc.setChannelSize(numChannelSize);
  for (int i=0; i < numEventPutAttempt; i++) {
    chc.incrementEventPutAttemptCount();
  }
  for (int i=0; i < numEventTakeAttempt; i++) {
    chc.incrementEventTakeAttemptCount();
  }
  chc.addToEventPutSuccessCount(numEventPutSuccess);
  chc.addToEventTakeSuccessCount(numEventTakeSuccess);
  assertChCounterState(on,numChannelSize,numEventPutAttempt,numEventTakeAttempt,numEventPutSuccess,numEventTakeSuccess);
  chc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertChCounterState(on,numChannelSize,numEventPutAttempt,numEventTakeAttempt,numEventPutSuccess,numEventTakeSuccess);
  Thread.sleep(5L);
  chc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertChCounterState(on,0L,0L,0L,0L,0L);
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSourceCounter() throws Exception {
  String name=getRandomName();
  SourceCounter srcc=new SourceCounter(name);
  srcc.register();
  ObjectName on=new ObjectName(SOURCE_OBJ_NAME_PREFIX + name);
  assertSrcCounterState(on,0L,0L,0L,0L,0L,0L);
  Assert.assertTrue("StartTime",getStartTime(on) == 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  srcc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int numEventReceived=random.nextInt(MAX_BOUNDS);
  int numEventAccepted=random.nextInt(MAX_BOUNDS);
  int numAppendReceived=random.nextInt(MAX_BOUNDS);
  int numAppendAccepted=random.nextInt(MAX_BOUNDS);
  int numAppendBatchReceived=random.nextInt(MAX_BOUNDS);
  int numAppendBatchAccepted=random.nextInt(MAX_BOUNDS);
  srcc.addToEventReceivedCount(numEventReceived);
  srcc.addToEventAcceptedCount(numEventAccepted);
  for (int i=0; i < numAppendReceived; i++) {
    srcc.incrementAppendReceivedCount();
  }
  for (int i=0; i < numAppendAccepted; i++) {
    srcc.incrementAppendAcceptedCount();
  }
  for (int i=0; i < numAppendBatchReceived; i++) {
    srcc.incrementAppendBatchReceivedCount();
  }
  for (int i=0; i < numAppendBatchAccepted; i++) {
    srcc.incrementAppendBatchAcceptedCount();
  }
  assertSrcCounterState(on,numEventReceived,numEventAccepted,numAppendReceived,numAppendAccepted,numAppendBatchReceived,numAppendBatchAccepted);
  srcc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertSrcCounterState(on,numEventReceived,numEventAccepted,numAppendReceived,numAppendAccepted,numAppendBatchReceived,numAppendBatchAccepted);
  Thread.sleep(5L);
  srcc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertSrcCounterState(on,0L,0L,0L,0L,0L,0L);
  int numEventReceived2=random.nextInt(MAX_BOUNDS);
  int numEventAccepted2=random.nextInt(MAX_BOUNDS);
  for (int i=0; i < numEventReceived2; i++) {
    srcc.incrementEventReceivedCount();
  }
  for (int i=0; i < numEventAccepted2; i++) {
    srcc.incrementEventAcceptedCount();
  }
  assertSrcCounterState(on,numEventReceived2,numEventAccepted2,0L,0L,0L,0L);
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSinkCounter() throws Exception {
  String name=getRandomName();
  SinkCounter skc=new SinkCounter(name);
  skc.register();
  ObjectName on=new ObjectName(SINK_OBJ_NAME_PREFIX + name);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,0L,0L);
  skc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int connCreated=random.nextInt(MAX_BOUNDS);
  int connClosed=random.nextInt(MAX_BOUNDS);
  int connFailed=random.nextInt(MAX_BOUNDS);
  int batchEmpty=random.nextInt(MAX_BOUNDS);
  int batchUnderflow=random.nextInt(MAX_BOUNDS);
  int batchComplete=random.nextInt(MAX_BOUNDS);
  int eventDrainAttempt=random.nextInt(MAX_BOUNDS);
  int eventDrainSuccess=random.nextInt(MAX_BOUNDS);
  for (int i=0; i < connCreated; i++) {
    skc.incrementConnectionCreatedCount();
  }
  for (int i=0; i < connClosed; i++) {
    skc.incrementConnectionClosedCount();
  }
  for (int i=0; i < connFailed; i++) {
    skc.incrementConnectionFailedCount();
  }
  for (int i=0; i < batchEmpty; i++) {
    skc.incrementBatchEmptyCount();
  }
  for (int i=0; i < batchUnderflow; i++) {
    skc.incrementBatchUnderflowCount();
  }
  for (int i=0; i < batchComplete; i++) {
    skc.incrementBatchCompleteCount();
  }
  for (int i=0; i < eventDrainAttempt; i++) {
    skc.incrementEventDrainAttemptCount();
  }
  for (int i=0; i < eventDrainSuccess; i++) {
    skc.incrementEventDrainSuccessCount();
  }
  assertSkCounterState(on,connCreated,connClosed,connFailed,batchEmpty,batchUnderflow,batchComplete,eventDrainAttempt,eventDrainSuccess);
  skc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertSkCounterState(on,connCreated,connClosed,connFailed,batchEmpty,batchUnderflow,batchComplete,eventDrainAttempt,eventDrainSuccess);
  Thread.sleep(5L);
  skc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,0L,0L);
  int eventDrainAttempt2=random.nextInt(MAX_BOUNDS);
  int eventDrainSuccess2=random.nextInt(MAX_BOUNDS);
  skc.addToEventDrainAttemptCount(eventDrainAttempt2);
  skc.addToEventDrainSuccessCount(eventDrainSuccess2);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,eventDrainAttempt2,eventDrainSuccess2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.instrumentation.util.TestJMXPollUtil </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testJMXPoll(){
  memChannel.setName("memChannel");
  pmemChannel.setName("pmemChannel");
  Context c=new Context();
  Configurables.configure(memChannel,c);
  Configurables.configure(pmemChannel,c);
  memChannel.start();
  pmemChannel.start();
  Transaction txn=memChannel.getTransaction();
  txn.begin();
  memChannel.put(EventBuilder.withBody("blah".getBytes()));
  memChannel.put(EventBuilder.withBody("blah".getBytes()));
  txn.commit();
  txn.close();
  txn=memChannel.getTransaction();
  txn.begin();
  memChannel.take();
  txn.commit();
  txn.close();
  Transaction txn2=pmemChannel.getTransaction();
  txn2.begin();
  pmemChannel.put(EventBuilder.withBody("blah".getBytes()));
  pmemChannel.put(EventBuilder.withBody("blah".getBytes()));
  txn2.commit();
  txn2.close();
  txn2=pmemChannel.getTransaction();
  txn2.begin();
  pmemChannel.take();
  txn2.commit();
  txn2.close();
  Map<String,Map<String,String>> mbeans=JMXPollUtil.getAllMBeans();
  Assert.assertNotNull(mbeans);
  Map<String,String> memBean=mbeans.get("CHANNEL.memChannel");
  Assert.assertNotNull(memBean);
  JMXTestUtils.checkChannelCounterParams(memBean);
  Map<String,String> pmemBean=mbeans.get("CHANNEL.pmemChannel");
  Assert.assertNotNull(pmemBean);
  JMXTestUtils.checkChannelCounterParams(pmemBean);
  memChannel.stop();
  pmemChannel.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.interceptor.TestCensoringInterceptor </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCensor(){
  MemoryChannel memCh=new MemoryChannel();
  memCh.configure(new Context());
  memCh.start();
  ChannelSelector cs=new ReplicatingChannelSelector();
  cs.setChannels(Lists.<Channel>newArrayList(memCh));
  ChannelProcessor cp=new ChannelProcessor(cs);
  Map<String,String> cfgMap=Maps.newHashMap();
  cfgMap.put("interceptors","a");
  String builderClass=CensoringInterceptor.Builder.class.getName();
  cfgMap.put("interceptors.a.type",builderClass);
  Context ctx=new Context(cfgMap);
  cp.configure(ctx);
  cp.initialize();
  Map<String,String> headers=Maps.newHashMap();
  String badWord="scribe";
  headers.put("Bad-Words",badWord);
  Event event1=EventBuilder.withBody("test",Charsets.UTF_8,headers);
  Assert.assertEquals(badWord,event1.getHeaders().get("Bad-Words"));
  cp.processEvent(event1);
  Transaction tx=memCh.getTransaction();
  tx.begin();
  Event event1a=memCh.take();
  Assert.assertNull(event1a.getHeaders().get("Bad-Words"));
  tx.commit();
  tx.close();
  cp.close();
  memCh.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.interceptor.TestRegexExtractorInterceptor </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldExtractAddHeadersForAllMatchGroupsIgnoringMissingIds() throws Exception {
  String body="2012-10-17 14:34:44,338";
  Context context=new Context();
  context.put(RegexExtractorInterceptor.REGEX,"^(\\d\\d\\d\\d-\\d\\d-\\d\\d\\s\\d\\d:\\d\\d)(:\\d\\d,\\d\\d\\d)");
  context.put(RegexExtractorInterceptor.SERIALIZERS,"s1");
  context.put(RegexExtractorInterceptor.SERIALIZERS + ".s1.name","timestamp");
  fixtureBuilder.configure(context);
  Interceptor fixture=fixtureBuilder.build();
  Event event=EventBuilder.withBody(body,Charsets.UTF_8);
  Event expected=EventBuilder.withBody(body,Charsets.UTF_8);
  expected.getHeaders().put("timestamp","2012-10-17 14:34");
  Event actual=fixture.intercept(event);
  Assert.assertArrayEquals(expected.getBody(),actual.getBody());
  Assert.assertEquals(expected.getHeaders(),actual.getHeaders());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldExtractAddHeadersUsingSpecifiedSerializer() throws Exception {
  long now=(System.currentTimeMillis() / 60000L) * 60000L;
  String pattern="yyyy-MM-dd HH:mm:ss,SSS";
  DateTimeFormatter formatter=DateTimeFormat.forPattern(pattern);
  String body=formatter.print(now);
  System.out.println(body);
  Context context=new Context();
  context.put(RegexExtractorInterceptor.REGEX,"^(\\d\\d\\d\\d-\\d\\d-\\d\\d\\s\\d\\d:\\d\\d)(:\\d\\d,\\d\\d\\d)");
  context.put(RegexExtractorInterceptor.SERIALIZERS,"s1 s2");
  String millisSerializers=RegexExtractorInterceptorMillisSerializer.class.getName();
  context.put(RegexExtractorInterceptor.SERIALIZERS + ".s1.type",millisSerializers);
  context.put(RegexExtractorInterceptor.SERIALIZERS + ".s1.name","timestamp");
  context.put(RegexExtractorInterceptor.SERIALIZERS + ".s1.pattern","yyyy-MM-dd HH:mm");
  context.put(RegexExtractorInterceptor.SERIALIZERS + ".s2.name","data");
  fixtureBuilder.configure(context);
  Interceptor fixture=fixtureBuilder.build();
  Event event=EventBuilder.withBody(body,Charsets.UTF_8);
  Event expected=EventBuilder.withBody(body,Charsets.UTF_8);
  expected.getHeaders().put("timestamp",String.valueOf(now));
  expected.getHeaders().put("data",":00,000");
  Event actual=fixture.intercept(event);
  Assert.assertArrayEquals(expected.getBody(),actual.getBody());
  Assert.assertEquals(expected.getHeaders(),actual.getHeaders());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.interceptor.TestRegexExtractorInterceptorMillisSerializer </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldReturnMillisFromPattern(){
  RegexExtractorInterceptorMillisSerializer fixture=new RegexExtractorInterceptorMillisSerializer();
  Context context=new Context();
  String pattern="yyyy-MM-dd HH:mm:ss";
  context.put("pattern",pattern);
  fixture.configure(context);
  DateTimeFormatter formatter=DateTimeFormat.forPattern(pattern);
  long time=(System.currentTimeMillis() / 1000L) * 1000L;
  Assert.assertEquals(String.valueOf(time),fixture.serialize(formatter.print(time)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.lifecycle.TestLifecycleController </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWaitForState() throws LifecycleException, InterruptedException {
  LifecycleAware delegate=new SleeperLifecycleDelegate();
  Assert.assertTrue(delegate.getLifecycleState().equals(LifecycleState.IDLE));
  delegate.start();
  boolean reached=LifecycleController.waitForState(delegate,LifecycleState.START,2000);
  Assert.assertEquals(true,reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
  delegate.stop();
  reached=LifecycleController.waitForState(delegate,LifecycleState.STOP,2000);
  Assert.assertEquals(true,reached);
  Assert.assertEquals(LifecycleState.STOP,delegate.getLifecycleState());
  delegate.start();
  reached=LifecycleController.waitForState(delegate,LifecycleState.IDLE,500);
  Assert.assertEquals(false,reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWaitForOneOf() throws LifecycleException, InterruptedException {
  LifecycleAware delegate=new SleeperLifecycleDelegate();
  Assert.assertEquals(LifecycleState.IDLE,delegate.getLifecycleState());
  delegate.start();
  boolean reached=LifecycleController.waitForOneOf(delegate,new LifecycleState[]{LifecycleState.STOP,LifecycleState.START},2000);
  Assert.assertTrue("Matched a state change",reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.node.TestAbstractConfigurationProvider </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSinkThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType="seq";
  String channelType="memory";
  String sinkType=UnconfigurableSink.class.getName();
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 1);
  Assert.assertTrue(config.getChannels().size() == 1);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testChannelThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType="seq";
  String channelType=UnconfigurableChannel.class.getName();
  String sinkType="null";
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 0);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSourceThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType=UnconfigurableSource.class.getName();
  String channelType="memory";
  String sinkType="null";
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 1);
  Assert.assertTrue(config.getSinkRunners().size() == 1);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnspecifiedChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,UnspecifiedChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof UnspecifiedChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof UnspecifiedChannel);
  Assert.assertSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusableChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,RecyclableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof RecyclableChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof RecyclableChannel);
  Assert.assertSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDispoableChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,DisposableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof DisposableChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof DisposableChannel);
  Assert.assertNotSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusableChannelNotReusedLater() throws Exception {
  String agentName="agent1";
  Map<String,String> propertiesReusable=getPropertiesForChannel(agentName,RecyclableChannel.class.getName());
  Map<String,String> propertiesDispoable=getPropertiesForChannel(agentName,DisposableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,propertiesReusable);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof RecyclableChannel);
  provider.setProperties(propertiesDispoable);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof DisposableChannel);
  provider.setProperties(propertiesReusable);
  MaterializedConfiguration config3=provider.getConfiguration();
  Channel channel3=config3.getChannels().values().iterator().next();
  Assert.assertTrue(channel3 instanceof RecyclableChannel);
  Assert.assertNotSame(channel1,channel3);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSourceAndSinkThrowExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType=UnconfigurableSource.class.getName();
  String channelType="memory";
  String sinkType=UnconfigurableSink.class.getName();
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 0);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.node.TestPollingPropertiesFileConfigurationProvider </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPolling() throws Exception {
  Thread.sleep(2000L);
  final List<MaterializedConfiguration> events=Lists.newArrayList();
  Object eventHandler=new Object(){
    @Subscribe public synchronized void handleConfigurationEvent(    MaterializedConfiguration event){
      events.add(event);
    }
  }
;
  eventBus.register(eventHandler);
  configFile.setLastModified(System.currentTimeMillis());
  Thread.sleep(2000L);
  Assert.assertEquals(String.valueOf(events),1,events.size());
  MaterializedConfiguration materializedConfiguration=events.remove(0);
  Assert.assertEquals(1,materializedConfiguration.getSourceRunners().size());
  Assert.assertEquals(1,materializedConfiguration.getSinkRunners().size());
  Assert.assertEquals(1,materializedConfiguration.getChannels().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.serialization.TestAvroEventDeserializer </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSchemaLiteral() throws IOException {
  File tempFile=newTestFile(true);
  String target=tempFile.getAbsolutePath();
  logger.info("Target: {}",target);
  TransientPositionTracker tracker=new TransientPositionTracker(target);
  Context context=new Context();
  context.put(AvroEventDeserializer.CONFIG_SCHEMA_TYPE_KEY,AvroEventDeserializer.AvroSchemaType.LITERAL.toString());
  ResettableInputStream in=new ResettableFileInputStream(tempFile,tracker);
  EventDeserializer des=new AvroEventDeserializer.Builder().build(context,in);
  Event event=des.readEvent();
  String eventSchema=event.getHeaders().get(AvroEventDeserializer.AVRO_SCHEMA_HEADER_LITERAL);
  Assert.assertEquals(schema.toString(),eventSchema);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSchemaHash() throws IOException, NoSuchAlgorithmException {
  File tempFile=newTestFile(true);
  String target=tempFile.getAbsolutePath();
  logger.info("Target: {}",target);
  TransientPositionTracker tracker=new TransientPositionTracker(target);
  Context context=new Context();
  context.put(AvroEventDeserializer.CONFIG_SCHEMA_TYPE_KEY,AvroEventDeserializer.AvroSchemaType.HASH.toString());
  ResettableInputStream in=new ResettableFileInputStream(tempFile,tracker);
  EventDeserializer des=new AvroEventDeserializer.Builder().build(context,in);
  Event event=des.readEvent();
  String eventSchemaHash=event.getHeaders().get(AvroEventDeserializer.AVRO_SCHEMA_HEADER_HASH);
  String expectedSchemaHash=Hex.encodeHexString(SchemaNormalization.parsingFingerprint("CRC-64-AVRO",schema));
  Assert.assertEquals(expectedSchemaHash,eventSchemaHash);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void resetTest() throws IOException {
  File tempFile=newTestFile(true);
  String target=tempFile.getAbsolutePath();
  logger.info("Target: {}",target);
  TransientPositionTracker tracker=new TransientPositionTracker(target);
  AvroEventDeserializer.Builder desBuilder=new AvroEventDeserializer.Builder();
  EventDeserializer deserializer=desBuilder.build(new Context(),new ResettableFileInputStream(tempFile,tracker));
  BinaryDecoder decoder=null;
  DatumReader<GenericRecord> reader=new GenericDatumReader<GenericRecord>(schema);
  decoder=DecoderFactory.get().binaryDecoder(deserializer.readEvent().getBody(),decoder);
  assertEquals("bar",reader.read(null,decoder).get("foo").toString());
  deserializer.reset();
  decoder=DecoderFactory.get().binaryDecoder(deserializer.readEvent().getBody(),decoder);
  assertEquals("bar",reader.read(null,decoder).get("foo").toString());
  deserializer.mark();
  decoder=DecoderFactory.get().binaryDecoder(deserializer.readEvent().getBody(),decoder);
  assertEquals("baz",reader.read(null,decoder).get("foo").toString());
  deserializer.reset();
  decoder=DecoderFactory.get().binaryDecoder(deserializer.readEvent().getBody(),decoder);
  assertEquals("baz",reader.read(null,decoder).get("foo").toString());
  assertNull(deserializer.readEvent());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.serialization.TestDurablePositionTracker </h4><pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGoodTrackerFile() throws IOException, URISyntaxException {
  String fileName="/TestResettableFileInputStream_1.avro";
  File trackerFile=new File(getClass().getResource(fileName).toURI());
  Assert.assertTrue(trackerFile.exists());
  PositionTracker tracker;
  tracker=new DurablePositionTracker(trackerFile,"foo");
  Assert.assertEquals(62,tracker.getPosition());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialTrackerFile() throws IOException, URISyntaxException {
  String fileName="/TestResettableFileInputStream_1.truncated.avro";
  File trackerFile=new File(getClass().getResource(fileName).toURI());
  Assert.assertTrue(trackerFile.exists());
  PositionTracker tracker;
  tracker=new DurablePositionTracker(trackerFile,"foo");
  Assert.assertEquals(25,tracker.getPosition());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicTracker() throws IOException {
  File metaFile=File.createTempFile(getClass().getName(),".meta");
  metaFile.delete();
  File dataFile=File.createTempFile(getClass().getName(),".data");
  Files.write("line 1\nline2\n",dataFile,Charsets.UTF_8);
  final long NEW_POS=7;
  PositionTracker tracker;
  tracker=new DurablePositionTracker(metaFile,dataFile.toString());
  Assert.assertEquals(0,tracker.getPosition());
  tracker.storePosition(NEW_POS);
  Assert.assertEquals(NEW_POS,tracker.getPosition());
  tracker.close();
  tracker=new DurablePositionTracker(metaFile,"foobar");
  Assert.assertEquals(NEW_POS,tracker.getPosition());
  Assert.assertEquals(dataFile.getAbsolutePath(),tracker.getTarget());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.serialization.TestResettableFileInputStream </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that we can process Shift_JIS lines that contain multi byte Japanese chars
 * even if they appear astride buffer boundaries.
 * @throws IOException
 */
@Test public void testShiftJisSurrogateCharRead() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write("1234567".getBytes(Charset.forName("Shift_JIS")));
  generateShiftJis2ByteSequence(out);
  Files.write(out.toByteArray(),file);
  ResettableInputStream in=initInputStream(8,Charset.forName("Shift_JIS"),DecodeErrorPolicy.FAIL);
  String result=readLine(in,8);
  assertEquals("1234567\u4E9C\n",result);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure a reset() brings us back to the default mark (beginning of file)
 * @throws IOException
 */
@Test public void testReset() throws IOException {
  String output=singleLineFileInit(file,Charsets.UTF_8);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  String result1=readLine(in,output.length());
  assertEquals(output,result1);
  in.reset();
  String result2=readLine(in,output.length());
  assertEquals(output,result2);
  String result3=readLine(in,output.length());
  assertNull("Should be null: " + result3,result3);
  in.close();
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that we can process UTF-16 lines that contain surrogate pairs, even
 * preceded by a Byte Order Mark (BOM).
 * @throws IOException
 */
@Test public void testUtf16BOMAndSurrogatePairRead() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  generateUtf16SurrogatePairSequence(out);
  Files.write(out.toByteArray(),file);
  ResettableInputStream in=initInputStream(8,Charsets.UTF_16,DecodeErrorPolicy.FAIL);
  String result=readLine(in,2);
  assertEquals("\uD83D\uDE18\n",result);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that surrogate pairs work well when resuming
 * reading. Specifically, this test brings up special situations
 * where a surrogate pair cannot be correctly decoded because
 * the second character is lost.
 * @throws IOException
 */
@Test public void testResumeWithSurrogatePairs() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write("foo".getBytes(Charsets.UTF_8));
  generateUtf8SurrogatePairSequence(out);
  out.write("bar".getBytes(Charsets.UTF_8));
  Files.write(out.toByteArray(),file);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  Assert.assertEquals('f',in.readChar());
  Assert.assertEquals('o',in.readChar());
  in.mark();
  Assert.assertEquals('o',in.readChar());
  Assert.assertEquals('\ud83d',in.readChar());
  in.reset();
  in.close();
  tracker.close();
  tracker=new DurablePositionTracker(meta,file.getPath());
  in=new ResettableFileInputStream(file,tracker);
  Assert.assertEquals('o',in.readChar());
  Assert.assertEquals('\ud83d',in.readChar());
  in.mark();
  in.close();
  tracker.close();
  tracker=new DurablePositionTracker(meta,file.getPath());
  in=new ResettableFileInputStream(file,tracker);
  Assert.assertEquals('b',in.readChar());
  Assert.assertEquals('a',in.readChar());
  Assert.assertEquals('r',in.readChar());
  Assert.assertEquals(-1,in.readChar());
  in.close();
  tracker.close();
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that we can process lines that contain multi byte characters in weird places
 * such as at the end of a buffer.
 * @throws IOException
 */
@Test public void testMultiByteCharRead() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write("1234567".getBytes(Charsets.UTF_8));
  generateUtf83ByteSequence(out);
  Files.write(out.toByteArray(),file);
  ResettableInputStream in=initInputStream(8,Charsets.UTF_8,DecodeErrorPolicy.FAIL);
  String result=readLine(in,8);
  assertEquals("1234567\u0A93\n",result);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws IOException {
  int NUM_LINES=1000;
  int LINE_LEN=1000;
  generateData(file,Charsets.UTF_8,NUM_LINES,LINE_LEN);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker,10 * LINE_LEN,Charsets.UTF_8,DecodeErrorPolicy.FAIL);
  String line="";
  for (int i=0; i < 9; i++) {
    line=readLine(in,LINE_LEN);
  }
  int lineNum=Integer.parseInt(line.substring(0,10));
  assertEquals(8,lineNum);
  long pos=in.tell();
  in.seek(pos - 2 * LINE_LEN);
  line=readLine(in,LINE_LEN);
  lineNum=Integer.parseInt(line.substring(0,10));
  assertEquals(7,lineNum);
  in.seek(in.tell() + LINE_LEN);
  line=readLine(in,LINE_LEN);
  lineNum=Integer.parseInt(line.substring(0,10));
  assertEquals(9,lineNum);
  in.seek(in.tell() + 20 * LINE_LEN);
  line=readLine(in,LINE_LEN);
  lineNum=Integer.parseInt(line.substring(0,10));
  assertEquals(30,lineNum);
  in.seek(in.tell() - 25 * LINE_LEN);
  line=readLine(in,LINE_LEN);
  lineNum=Integer.parseInt(line.substring(0,10));
  assertEquals(6,lineNum);
  in.seek(100 * LINE_LEN);
  in.seek(0);
  in.seek(9 * LINE_LEN);
  assertEquals(9,Integer.parseInt(readLine(in,LINE_LEN).substring(0,10)));
  assertEquals(10,Integer.parseInt(readLine(in,LINE_LEN).substring(0,10)));
  assertEquals(11,Integer.parseInt(readLine(in,LINE_LEN).substring(0,10)));
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that we can process UTF-8 lines that contain surrogate pairs
 * even if they appear astride buffer boundaries.
 * @throws IOException
 */
@Test public void testUtf8SurrogatePairRead() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write("1234567".getBytes(Charsets.UTF_8));
  generateUtf8SurrogatePairSequence(out);
  Files.write(out.toByteArray(),file);
  ResettableInputStream in=initInputStream(8,Charsets.UTF_8,DecodeErrorPolicy.FAIL);
  String result=readLine(in,9);
  assertEquals("1234567\uD83D\uDE18\n",result);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that marking and resetting works.
 * @throws IOException
 */
@Test public void testMarkReset() throws IOException {
  List<String> expected=multiLineFileInit(file,Charsets.UTF_8);
  int MAX_LEN=100;
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  String result0=readLine(in,MAX_LEN);
  assertEquals(expected.get(0),result0);
  in.reset();
  String result0a=readLine(in,MAX_LEN);
  assertEquals(expected.get(0),result0a);
  in.mark();
  String result1=readLine(in,MAX_LEN);
  assertEquals(expected.get(1),result1);
  in.reset();
  String result1a=readLine(in,MAX_LEN);
  assertEquals(expected.get(1),result1a);
  in.mark();
  in.close();
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that we can simply read bytes from a file using InputStream.read() method.
 * @throws IOException
 */
@Test public void testReadByte() throws IOException {
  byte[] bytes=new byte[255];
  for (int i=0; i < 255; i++) {
    bytes[i]=(byte)i;
  }
  Files.write(bytes,file);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  for (int i=0; i < 255; i++) {
    assertEquals(i,in.read());
  }
  assertEquals(-1,in.read());
  in.close();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that surrogate pairs work well with mark/reset.
 * @throws IOException
 */
@Test public void testMarkResetWithSurrogatePairs() throws IOException {
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write("foo".getBytes(Charsets.UTF_8));
  generateUtf8SurrogatePairSequence(out);
  out.write("bar".getBytes(Charsets.UTF_8));
  Files.write(out.toByteArray(),file);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  Assert.assertEquals('f',in.readChar());
  Assert.assertEquals('o',in.readChar());
  in.mark();
  Assert.assertEquals('o',in.readChar());
  Assert.assertEquals('\ud83d',in.readChar());
  in.reset();
  Assert.assertEquals('\ude18',in.readChar());
  Assert.assertEquals('o',in.readChar());
  Assert.assertEquals('\ud83d',in.readChar());
  in.mark();
  in.reset();
  Assert.assertEquals('\ude18',in.readChar());
  Assert.assertEquals('b',in.readChar());
  Assert.assertEquals('a',in.readChar());
  in.reset();
  Assert.assertEquals('b',in.readChar());
  Assert.assertEquals('a',in.readChar());
  Assert.assertEquals('r',in.readChar());
  Assert.assertEquals(-1,in.readChar());
  in.close();
  tracker.close();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that we can simply read bytes from a file.
 * @throws IOException
 */
@Test public void testBasicRead() throws IOException {
  String output=singleLineFileInit(file,Charsets.UTF_8);
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  String result=readLine(in,output.length());
  assertEquals(output,result);
  String afterEOF=readLine(in,output.length());
  assertNull(afterEOF);
  in.close();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResume() throws IOException {
  List<String> expected=multiLineFileInit(file,Charsets.UTF_8);
  int MAX_LEN=100;
  PositionTracker tracker=new DurablePositionTracker(meta,file.getPath());
  ResettableInputStream in=new ResettableFileInputStream(file,tracker);
  String result0=readLine(in,MAX_LEN);
  String result1=readLine(in,MAX_LEN);
  in.mark();
  String result2=readLine(in,MAX_LEN);
  Assert.assertEquals(expected.get(2),result2);
  String result3=readLine(in,MAX_LEN);
  Assert.assertEquals(expected.get(3),result3);
  in.close();
  tracker.close();
  tracker=new DurablePositionTracker(meta,file.getPath());
  in=new ResettableFileInputStream(file,tracker);
  String result2a=readLine(in,MAX_LEN);
  String result3a=readLine(in,MAX_LEN);
  Assert.assertEquals(result2,result2a);
  Assert.assertEquals(result3,result3a);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.SinkProcessorFactoryTest </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInstantiatingLoadBalancingSinkProcessor(){
  Context context=new Context();
  context.put("type",LoadBalancingSinkProcessor.class.getName());
  context.put("selector","random");
  SinkFactory sf=new DefaultSinkFactory();
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(sf.create("sink1","avro"));
  sinks.add(sf.create("sink2","avro"));
  SinkProcessor sp=SinkProcessorFactory.getProcessor(context,sinks);
  context.put("type","load_balance");
  SinkProcessor sp2=SinkProcessorFactory.getProcessor(context,sinks);
  Assert.assertEquals(sp.getClass(),sp2.getClass());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test(){
  Context context=new Context();
  context.put("type",FailoverSinkProcessor.class.getName());
  context.put("priority.sink1","1");
  context.put("priority.sink2","2");
  SinkFactory sf=new DefaultSinkFactory();
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(sf.create("sink1","avro"));
  sinks.add(sf.create("sink2","avro"));
  SinkProcessor sp=SinkProcessorFactory.getProcessor(context,sinks);
  context.put("type","failover");
  SinkProcessor sp2=SinkProcessorFactory.getProcessor(context,sinks);
  Assert.assertEquals(sp.getClass(),sp2.getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestFailoverSinkProcessor </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test failover by feeding events to the channel and verifying at various
 * stages that the number of events consumed by each sink matches expected
 * failover patterns
 * @throws InterruptedException
 */
@Test public void testFailover() throws InterruptedException {
  Channel ch=new MemoryChannel();
  ConsumeXSink s1=new ConsumeXSink(10);
  s1.setChannel(ch);
  s1.setName("s1");
  ConsumeXSink s2=new ConsumeXSink(50);
  s2.setChannel(ch);
  s2.setName("s2");
  ConsumeXSink s3=new ConsumeXSink(100);
  s3.setChannel(ch);
  s3.setName("s3");
  Context context=new Context();
  Configurables.configure(s1,context);
  Configurables.configure(s2,context);
  Configurables.configure(s3,context);
  Configurables.configure(ch,context);
  ch.start();
  List<Sink> sinks=new LinkedList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  SinkGroup group=new SinkGroup(sinks);
  Map<String,String> params=new HashMap<String,String>();
  params.put("sinks","s1 s2 s3");
  params.put("processor.type","failover");
  params.put("processor.priority.s1","3");
  params.put("processor.priority.s2","2");
  params.put("processor.priority.s3","1");
  params.put("processor.maxpenalty","10000");
  context.putAll(params);
  Configurables.configure(group,context);
  SinkRunner runner=new SinkRunner(group.getProcessor());
  runner.start();
  Assert.assertEquals(LifecycleState.START,s1.getLifecycleState());
  Assert.assertEquals(LifecycleState.START,s2.getLifecycleState());
  Assert.assertEquals(LifecycleState.START,s3.getLifecycleState());
  for (int i=0; i < 15; i++) {
    Transaction tx=ch.getTransaction();
    tx.begin();
    ch.put(EventBuilder.withBody("test".getBytes()));
    tx.commit();
    tx.close();
  }
  Thread.sleep(100);
  Assert.assertEquals(new Integer(10),s1.getWritten());
  Assert.assertEquals(new Integer(5),s2.getWritten());
  for (int i=0; i < 50; i++) {
    Transaction tx=ch.getTransaction();
    tx.begin();
    ch.put(EventBuilder.withBody("test".getBytes()));
    tx.commit();
    tx.close();
  }
  Thread.sleep(100);
  Assert.assertEquals(new Integer(50),s2.getWritten());
  Assert.assertEquals(new Integer(5),s3.getWritten());
  s2.setRemaining(20);
  Thread.sleep(5000);
  for (int i=0; i < 100; i++) {
    Transaction tx=ch.getTransaction();
    tx.begin();
    ch.put(EventBuilder.withBody("test".getBytes()));
    tx.commit();
    tx.close();
  }
  Thread.sleep(1000);
  Assert.assertEquals(new Integer(10),s1.getWritten());
  Assert.assertEquals(new Integer(70),s2.getWritten());
  Assert.assertEquals(new Integer(85),s3.getWritten());
  runner.stop();
  ch.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestLoadBalancingSinkProcessor </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundRobinBackoffIncreasingBackoffs() throws EventDeliveryException, InterruptedException {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=3 * n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  s2.setFail(true);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("round_robin",sinks,true);
  Status s=Status.READY;
  for (int i=0; i < 3 && s != Status.BACKOFF; i++) {
    s=lbsp.process();
  }
  Assert.assertEquals(0,s2.getEvents().size());
  Thread.sleep(2100);
  for (int i=0; i < 3 && s != Status.BACKOFF; i++) {
    s=lbsp.process();
  }
  Assert.assertEquals(0,s2.getEvents().size());
  s2.setFail(false);
  Thread.sleep(2100);
  for (int i=0; i < 3 && s != Status.BACKOFF; i++) {
    s=lbsp.process();
  }
  Assert.assertEquals(0,s2.getEvents().size());
  Thread.sleep(2100);
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertEquals(n + 2,s1.getEvents().size());
  Assert.assertEquals(n - 3,s2.getEvents().size());
  Assert.assertEquals(n + 1,s3.getEvents().size());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomBackoff() throws Exception {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  s1.setFail(true);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  s3.setFail(true);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("random",sinks,true);
  for (int i=0; i < 50; i++) {
    lbsp.process();
  }
  Assert.assertEquals(50,s2.getEvents().size());
  s2.setFail(true);
  s1.setFail(false);
  try {
    lbsp.process();
    Assert.fail("Expected EventDeliveryException");
  }
 catch (  EventDeliveryException e) {
  }
  Thread.sleep(2100);
  Sink.Status s=Sink.Status.READY;
  while (s != Sink.Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertEquals(50,s1.getEvents().size());
  Assert.assertEquals(50,s2.getEvents().size());
  Assert.assertEquals(0,s3.getEvents().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.TestElasticSearchDynamicSerializer </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundTrip() throws Exception {
  ElasticSearchDynamicSerializer fixture=new ElasticSearchDynamicSerializer();
  Context context=new Context();
  fixture.configure(context);
  String message="test body";
  Map<String,String> headers=Maps.newHashMap();
  headers.put("headerNameOne","headerValueOne");
  headers.put("headerNameTwo","headerValueTwo");
  headers.put("headerNameThree","headerValueThree");
  Event event=EventBuilder.withBody(message.getBytes(charset));
  event.setHeaders(headers);
  XContentBuilder expected=jsonBuilder().startObject();
  expected.field("body",new String(message.getBytes(),charset));
  for (  String headerName : headers.keySet()) {
    expected.field(headerName,new String(headers.get(headerName).getBytes(),charset));
  }
  expected.endObject();
  XContentBuilder actual=fixture.getContentBuilder(event);
  assertEquals(new String(expected.bytes().array()),new String(actual.bytes().array()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.TestElasticSearchLogStashEventSerializer </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldHandleInvalidJSONDuringComplexParsing() throws Exception {
  ElasticSearchLogStashEventSerializer fixture=new ElasticSearchLogStashEventSerializer();
  Context context=new Context();
  fixture.configure(context);
  String message="{flume: somethingnotvalid}";
  Map<String,String> headers=Maps.newHashMap();
  long timestamp=System.currentTimeMillis();
  headers.put("timestamp",String.valueOf(timestamp));
  headers.put("source","flume_tail_src");
  headers.put("host","test@localhost");
  headers.put("src_path","/tmp/test");
  headers.put("headerNameOne","headerValueOne");
  headers.put("headerNameTwo","headerValueTwo");
  headers.put("type","sometype");
  Event event=EventBuilder.withBody(message.getBytes(charset));
  event.setHeaders(headers);
  XContentBuilder expected=jsonBuilder().startObject();
  expected.field("@message",new String(message.getBytes(),charset));
  expected.field("@timestamp",new Date(timestamp));
  expected.field("@source","flume_tail_src");
  expected.field("@type","sometype");
  expected.field("@source_host","test@localhost");
  expected.field("@source_path","/tmp/test");
  expected.startObject("@fields");
  expected.field("timestamp",String.valueOf(timestamp));
  expected.field("src_path","/tmp/test");
  expected.field("host","test@localhost");
  expected.field("headerNameTwo","headerValueTwo");
  expected.field("source","flume_tail_src");
  expected.field("headerNameOne","headerValueOne");
  expected.field("type","sometype");
  expected.endObject();
  expected.endObject();
  XContentBuilder actual=fixture.getContentBuilder(event);
  JsonParser parser=new JsonParser();
  assertEquals(parser.parse(expected.string()),parser.parse(actual.string()));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundTrip() throws Exception {
  ElasticSearchLogStashEventSerializer fixture=new ElasticSearchLogStashEventSerializer();
  Context context=new Context();
  fixture.configure(context);
  String message="test body";
  Map<String,String> headers=Maps.newHashMap();
  long timestamp=System.currentTimeMillis();
  headers.put("timestamp",String.valueOf(timestamp));
  headers.put("source","flume_tail_src");
  headers.put("host","test@localhost");
  headers.put("src_path","/tmp/test");
  headers.put("headerNameOne","headerValueOne");
  headers.put("headerNameTwo","headerValueTwo");
  headers.put("type","sometype");
  Event event=EventBuilder.withBody(message.getBytes(charset));
  event.setHeaders(headers);
  XContentBuilder expected=jsonBuilder().startObject();
  expected.field("@message",new String(message.getBytes(),charset));
  expected.field("@timestamp",new Date(timestamp));
  expected.field("@source","flume_tail_src");
  expected.field("@type","sometype");
  expected.field("@source_host","test@localhost");
  expected.field("@source_path","/tmp/test");
  expected.startObject("@fields");
  expected.field("timestamp",String.valueOf(timestamp));
  expected.field("src_path","/tmp/test");
  expected.field("host","test@localhost");
  expected.field("headerNameTwo","headerValueTwo");
  expected.field("source","flume_tail_src");
  expected.field("headerNameOne","headerValueOne");
  expected.field("type","sometype");
  expected.endObject();
  expected.endObject();
  XContentBuilder actual=fixture.getContentBuilder(event);
  JsonParser parser=new JsonParser();
  assertEquals(parser.parse(expected.string()),parser.parse(actual.string()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.TestElasticSearchSink </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldAllowCustomElasticSearchIndexRequestBuilderFactory() throws Exception {
  parameters.put(SERIALIZER,CustomElasticSearchIndexRequestBuilderFactory.class.getName());
  fixture.configure(new Context(parameters));
  Channel channel=bindAndStartChannel(fixture);
  Transaction tx=channel.getTransaction();
  tx.begin();
  String body="{ foo: \"bar\" }";
  Event event=EventBuilder.withBody(body.getBytes());
  channel.put(event);
  tx.commit();
  tx.close();
  fixture.process();
  fixture.stop();
  assertEquals(fixture.getIndexName() + "-05_17_36_789",CustomElasticSearchIndexRequestBuilderFactory.actualIndexName);
  assertEquals(fixture.getIndexType(),CustomElasticSearchIndexRequestBuilderFactory.actualIndexType);
  assertArrayEquals(event.getBody(),CustomElasticSearchIndexRequestBuilderFactory.actualEventBody);
  assertTrue(CustomElasticSearchIndexRequestBuilderFactory.hasContext);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hbase.TestAsyncHBaseSink </h4><pre class="type-9 type-10 type-1 type-3 type-8 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This test must run last - it shuts down the minicluster :D
 * @throws Exception
 */
@Ignore("For dev builds only:" + "This test takes too long, and this has to be run after all other" + "tests, since it shuts down the minicluster. "+ "Comment out all other tests"+ "and uncomment this annotation to run this test.") @Test(expected=EventDeliveryException.class) public void testHBaseFailure() throws Exception {
  ctx.put("batchSize","2");
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=false;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  Assert.assertFalse(sink.isConfNull());
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  testUtility.shutdownMiniCluster();
  sink.process();
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneEventWithDefaults() throws Exception {
  Map<String,String> ctxMap=new HashMap<String,String>();
  ctxMap.put("table",tableName);
  ctxMap.put("columnFamily",columnFamily);
  ctxMap.put("serializer","org.apache.flume.sink.hbase.SimpleAsyncHbaseEventSerializer");
  ctxMap.put("keep-alive","0");
  ctxMap.put("timeout","10000");
  Context tmpctx=new Context();
  tmpctx.putAll(ctxMap);
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,tmpctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,tmpctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeEvents() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleBatches() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  ctx.put("batchSize","2");
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  int count=0;
  Status status=Status.READY;
  while (status != Status.BACKOFF) {
    count++;
    status=sink.process();
  }
  Assert.assertFalse(sink.isConfNull());
  sink.stop();
  Assert.assertEquals(2,count);
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneEvent() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FlumeException.class) public void testMissingTable() throws Exception {
  deleteTable=false;
  ctx.put("batchSize","2");
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  Assert.assertFalse(sink.isConfNull());
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  sink.process();
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithoutConfigurationObject() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  ctx.put("batchSize","2");
  ctx.put(HBaseSinkConfigurationConstants.ZK_QUORUM,ZKConfig.getZKQuorumServersString(testUtility.getConfiguration()));
  ctx.put(HBaseSinkConfigurationConstants.ZK_ZNODE_PARENT,testUtility.getConfiguration().get(HConstants.ZOOKEEPER_ZNODE_PARENT));
  AsyncHBaseSink sink=new AsyncHBaseSink();
  Configurables.configure(sink,ctx);
  ctx.put(HBaseSinkConfigurationConstants.ZK_QUORUM,null);
  ctx.put(HBaseSinkConfigurationConstants.ZK_ZNODE_PARENT,null);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  int count=0;
  Status status=Status.READY;
  while (status != Status.BACKOFF) {
    count++;
    status=sink.process();
  }
  Assert.assertTrue(sink.isConfNull());
  sink.stop();
  Assert.assertEquals(2,count);
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hbase.TestHBaseSink </h4><pre class="type-9 type-11 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FlumeException.class) public void testMissingTable() throws Exception {
  logger.info("Running testMissingTable()");
  initContextForSimpleHbaseEventSerializer();
  logger.info("Deleting table {}",tableName);
  testUtility.deleteTable(tableName.getBytes());
  ctx.put("batchSize","2");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  logger.info("Writing data into channel");
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  logger.info("Starting sink and processing events");
  try {
    logger.info("Calling sink.start()");
    sink.start();
    logger.error("Unexpected error: Calling sink.process()");
    sink.process();
    logger.error("Unexpected error: Calling sink.stop()");
    sink.stop();
  }
  finally {
    testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  }
  Assert.fail();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  sink.process();
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOneEvent() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  sink.process();
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransactionStateOnSerializationException() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  ctx.put("batchSize","1");
  ctx.put(HBaseSinkConfigurationConstants.CONFIG_SERIALIZER,"org.apache.flume.sink.hbase.MockSimpleHbaseEventSerializer");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + 0));
  channel.put(e);
  tx.commit();
  tx.close();
  try {
    MockSimpleHbaseEventSerializer.throwException=true;
    sink.process();
    Assert.fail("FlumeException expected from serilazer");
  }
 catch (  FlumeException ex) {
    Assert.assertEquals("Exception for testing",ex.getMessage());
  }
  MockSimpleHbaseEventSerializer.throwException=false;
  sink.process();
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-8 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This test must run last - it shuts down the minicluster :D
 * @throws Exception
 */
@Ignore("For dev builds only:" + "This test takes too long, and this has to be run after all other" + "tests, since it shuts down the minicluster. "+ "Comment out all other tests"+ "and uncomment this annotation to run this test.") @Test(expected=EventDeliveryException.class) public void testHBaseFailure() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  ctx.put("batchSize","2");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  testUtility.shutdownMiniCluster();
  sink.process();
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithoutConfigurationObject() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  Context tmpContext=new Context(ctx.getParameters());
  tmpContext.put("batchSize","2");
  tmpContext.put(HBaseSinkConfigurationConstants.ZK_QUORUM,ZKConfig.getZKQuorumServersString(conf));
  System.out.print(ctx.getString(HBaseSinkConfigurationConstants.ZK_QUORUM));
  tmpContext.put(HBaseSinkConfigurationConstants.ZK_ZNODE_PARENT,conf.get(HConstants.ZOOKEEPER_ZNODE_PARENT,HConstants.DEFAULT_ZOOKEEPER_ZNODE_PARENT));
  HBaseSink sink=new HBaseSink();
  Configurables.configure(sink,tmpContext);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  Status status=Status.READY;
  while (status != Status.BACKOFF) {
    status=sink.process();
  }
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransactionStateOnChannelException() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  ctx.put("batchSize","1");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  Channel channel=spy(new MemoryChannel());
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + 0));
  channel.put(e);
  tx.commit();
  tx.close();
  doThrow(new ChannelException("Mock Exception")).when(channel).take();
  try {
    sink.process();
    Assert.fail("take() method should throw exception");
  }
 catch (  ChannelException ex) {
    Assert.assertEquals("Mock Exception",ex.getMessage());
  }
  doReturn(e).when(channel).take();
  sink.process();
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOneEventWithDefaults() throws Exception {
  ctx=new Context();
  ctx.put("table",tableName);
  ctx.put("columnFamily",columnFamily);
  ctx.put("serializer",SimpleHbaseEventSerializer.class.getName());
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  sink.process();
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleBatches() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  ctx.put("batchSize","2");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  int count=0;
  while (sink.process() != Status.BACKOFF) {
    count++;
  }
  sink.stop();
  Assert.assertEquals(2,count);
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThreeEvents() throws Exception {
  initContextForSimpleHbaseEventSerializer();
  ctx.put("batchSize","3");
  HBaseSink sink=new HBaseSink(conf);
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  sink.stop();
  HTable table=new HTable(conf,tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hbase.TestRegexHbaseEventSerializer </h4><pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApacheRegex() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.REGEX_CONFIG,"([^ ]*) ([^ ]*) ([^ ]*) (-|\\[[^\\]]*\\]) \"([^ ]+) ([^ ]+)" + " ([^\"]+)\" (-|[0-9]*) (-|[0-9]*)(?: ([^ \"]*|\"[^\"]*\")" + " ([^ \"]*|\"[^\"]*\"))?");
  context.put(RegexHbaseEventSerializer.COL_NAME_CONFIG,"host,identity,user,time,method,request,protocol,status,size," + "referer,agent");
  s.configure(context);
  String logMsg="33.22.11.00 - - [20/May/2011:07:01:19 +0000] " + "\"GET /wp-admin/css/install.css HTTP/1.0\" 200 813 " + "\"http://www.cloudera.com/wp-admin/install.php\" \"Mozilla/5.0 (comp"+ "atible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)\"";
  Event e=EventBuilder.withBody(Bytes.toBytes(logMsg));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertEquals(1,s.getActions().size());
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 11);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertEquals("33.22.11.00",resultMap.get("host"));
  assertEquals("-",resultMap.get("identity"));
  assertEquals("-",resultMap.get("user"));
  assertEquals("[20/May/2011:07:01:19 +0000]",resultMap.get("time"));
  assertEquals("GET",resultMap.get("method"));
  assertEquals("/wp-admin/css/install.css",resultMap.get("request"));
  assertEquals("HTTP/1.0",resultMap.get("protocol"));
  assertEquals("200",resultMap.get("status"));
  assertEquals("813",resultMap.get("size"));
  assertEquals("\"http://www.cloudera.com/wp-admin/install.php\"",resultMap.get("referer"));
  assertEquals("\"Mozilla/5.0 (compatible; Yahoo! Slurp; " + "http://help.yahoo.com/help/us/ysearch/slurp)\"",resultMap.get("agent"));
  List<Increment> increments=s.getIncrements();
  assertEquals(0,increments.size());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowIndexKey() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.REGEX_CONFIG,"^([^\t]+)\t([^\t]+)\t" + "([^\t]+)$");
  context.put(RegexHbaseEventSerializer.COL_NAME_CONFIG,"col1,col2,ROW_KEY");
  context.put("rowKeyIndex","2");
  s.configure(context);
  String body="val1\tval2\trow1";
  Event e=EventBuilder.withBody(Bytes.toBytes(body));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  Put put=(Put)actions.get(0);
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 2);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertEquals("val1",resultMap.get("col1"));
  assertEquals("val2",resultMap.get("col2"));
  assertEquals("row1",Bytes.toString(put.getRow()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDepositHeaders() throws Exception {
  Charset charset=Charset.forName("KOI8-R");
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.DEPOSIT_HEADERS_CONFIG,"true");
  context.put(RegexHbaseEventSerializer.CHARSET_CONFIG,charset.toString());
  s.configure(context);
  String body="body";
  Map<String,String> headers=Maps.newHashMap();
  headers.put("header1","value1");
  headers.put("заголовок2","значение2");
  Event e=EventBuilder.withBody(Bytes.toBytes(body),headers);
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertEquals(1,s.getActions().size());
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 3);
  Map<String,byte[]> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier(),charset),kv.getValue());
  }
  assertEquals(body,new String(resultMap.get(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT),charset));
  assertEquals("value1",new String(resultMap.get("header1"),charset));
  assertArrayEquals("значение2".getBytes(charset),resultMap.get("заголовок2"));
  assertEquals("значение2".length(),resultMap.get("заголовок2").length);
  List<Increment> increments=s.getIncrements();
  assertEquals(0,increments.size());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultBehavior() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  s.configure(context);
  String logMsg="The sky is falling!";
  Event e=EventBuilder.withBody(Bytes.toBytes(logMsg));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertTrue(actions.size() == 1);
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 1);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertTrue(resultMap.containsKey(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT));
  assertEquals("The sky is falling!",resultMap.get(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestBucketWriter </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalRoller() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1;
  final int NUM_EVENTS=10;
  final AtomicBoolean calledBack=new AtomicBoolean(false);
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,new HDFSEventSink.WriterCallback(){
    @Override public void run(    String filePath){
      calledBack.set(true);
    }
  }
,null,30000,Executors.newSingleThreadExecutor(),0,0);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  long startNanos=System.nanoTime();
  for (int i=0; i < NUM_EVENTS - 1; i++) {
    bucketWriter.append(e);
  }
  Thread.sleep(2 * ROLL_INTERVAL * 1000L);
  Assert.assertTrue(bucketWriter.closed);
  Assert.assertTrue(calledBack.get());
  bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  bucketWriter.append(e);
  long elapsedMillis=TimeUnit.MILLISECONDS.convert(System.nanoTime() - startNanos,TimeUnit.NANOSECONDS);
  long elapsedSeconds=elapsedMillis / 1000L;
  logger.info("Time elapsed: {} milliseconds",elapsedMillis);
  logger.info("Number of events written: {}",hdfsWriter.getEventsWritten());
  logger.info("Number of bytes written: {}",hdfsWriter.getBytesWritten());
  logger.info("Number of files opened: {}",hdfsWriter.getFilesOpened());
  logger.info("Number of files closed: {}",hdfsWriter.getFilesClosed());
  Assert.assertEquals("events written",NUM_EVENTS,hdfsWriter.getEventsWritten());
  Assert.assertEquals("bytes written",e.getBody().length * NUM_EVENTS,hdfsWriter.getBytesWritten());
  Assert.assertEquals("files opened",2,hdfsWriter.getFilesOpened());
  Assert.assertEquals("files closed",1,hdfsWriter.getFilesClosed());
  logger.info("Waiting for roll...");
  Thread.sleep(2 * ROLL_INTERVAL * 1000L);
  logger.info("Number of files closed: {}",hdfsWriter.getFilesClosed());
  Assert.assertEquals("files closed",2,hdfsWriter.getFilesClosed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSCompressedDataStream </h4><pre class="type-9 type-10 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testGzipDurabilityWithSerializer() throws Exception {
  Context context=new Context();
  context.put("serializer","AVRO_EVENT");
  HDFSCompressedDataStream writer=new HDFSCompressedDataStream();
  writer.configure(context);
  writer.open(fileURI,factory.getCodec(new Path(fileURI)),SequenceFile.CompressionType.BLOCK);
  String[] bodies={"yarf!","yarfing!"};
  writeBodies(writer,bodies);
  int found=0;
  int expected=bodies.length;
  List<String> expectedBodies=Lists.newArrayList(bodies);
  GZIPInputStream cmpIn=new GZIPInputStream(new FileInputStream(file));
  DatumReader<GenericRecord> reader=new GenericDatumReader<GenericRecord>();
  DataFileStream<GenericRecord> avroStream=new DataFileStream<GenericRecord>(cmpIn,reader);
  GenericRecord record=new GenericData.Record(avroStream.getSchema());
  while (avroStream.hasNext()) {
    avroStream.next(record);
    CharsetDecoder decoder=Charsets.UTF_8.newDecoder();
    String bodyStr=decoder.decode((ByteBuffer)record.get("body")).toString();
    expectedBodies.remove(bodyStr);
    found++;
  }
  avroStream.close();
  cmpIn.close();
  Assert.assertTrue("Found = " + found + ", Expected = "+ expected+ ", Left = "+ expectedBodies.size()+ " "+ expectedBodies,expectedBodies.size() == 0);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGzipDurability() throws Exception {
  Context context=new Context();
  HDFSCompressedDataStream writer=new HDFSCompressedDataStream();
  writer.configure(context);
  writer.open(fileURI,factory.getCodec(new Path(fileURI)),SequenceFile.CompressionType.BLOCK);
  String[] bodies={"yarf!"};
  writeBodies(writer,bodies);
  byte[] buf=new byte[256];
  GZIPInputStream cmpIn=new GZIPInputStream(new FileInputStream(file));
  int len=cmpIn.read(buf);
  String result=new String(buf,0,len,Charsets.UTF_8);
  result=result.trim();
  Assert.assertEquals("input and output must match",bodies[0],result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSEventSink </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAvroAppend() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting...");
  final long rollCount=3;
  final long batchSize=2;
  final String fileName="FlumeData";
  String newPath=testPath + "/singleTextBucket";
  int totalEvents=0;
  int i=1, j=1;
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(newPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(rollCount));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.writeFormat","Text");
  context.put("hdfs.fileType","DataStream");
  context.put("serializer","AVRO_EVENT");
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  for (i=1; i < 4; i++) {
    Transaction txn=channel.getTransaction();
    txn.begin();
    for (j=1; j <= batchSize; j++) {
      Event event=new SimpleEvent();
      eventDate.clear();
      eventDate.set(2011,i,i,i,0);
      event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
      event.getHeaders().put("hostname","Host" + i);
      String body="Test." + i + "."+ j;
      event.setBody(body.getBytes());
      bodies.add(body);
      channel.put(event);
      totalEvents++;
    }
    txn.commit();
    txn.close();
    sink.process();
  }
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path fList[]=FileUtil.stat2Paths(dirStat);
  long expectedFiles=totalEvents / rollCount;
  if (totalEvents % rollCount > 0)   expectedFiles++;
  Assert.assertEquals("num files wrong, found: " + Lists.newArrayList(fList),expectedFiles,fList.length);
  verifyOutputAvroFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseOnIdle() throws IOException, EventDeliveryException, InterruptedException {
  String hdfsPath=testPath + "/idleClose";
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(hdfsPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",hdfsPath);
  context.put("hdfs.rollCount","0");
  context.put("hdfs.rollSize","0");
  context.put("hdfs.rollInterval","0");
  context.put("hdfs.batchSize","2");
  context.put("hdfs.idleTimeout","1");
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.start();
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 10; i++) {
    Event event=new SimpleEvent();
    event.setBody(("test event " + i).getBytes());
    channel.put(event);
  }
  txn.commit();
  txn.close();
  sink.process();
  sink.process();
  Thread.sleep(1001);
  sink.process();
  sink.process();
  Thread.sleep(500);
  sink.process();
  sink.process();
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path[] fList=FileUtil.stat2Paths(dirStat);
  Assert.assertEquals("Incorrect content of the directory " + StringUtils.join(fList,","),2,fList.length);
  Assert.assertTrue(!fList[0].getName().endsWith(".tmp") && !fList[1].getName().endsWith(".tmp"));
  fs.close();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTextAppend() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting...");
  final long rollCount=3;
  final long batchSize=2;
  final String fileName="FlumeData";
  String newPath=testPath + "/singleTextBucket";
  int totalEvents=0;
  int i=1, j=1;
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(newPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(rollCount));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.writeFormat","Text");
  context.put("hdfs.fileType","DataStream");
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  for (i=1; i < 4; i++) {
    Transaction txn=channel.getTransaction();
    txn.begin();
    for (j=1; j <= batchSize; j++) {
      Event event=new SimpleEvent();
      eventDate.clear();
      eventDate.set(2011,i,i,i,0);
      event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
      event.getHeaders().put("hostname","Host" + i);
      String body="Test." + i + "."+ j;
      event.setBody(body.getBytes());
      bodies.add(body);
      channel.put(event);
      totalEvents++;
    }
    txn.commit();
    txn.close();
    sink.process();
  }
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path fList[]=FileUtil.stat2Paths(dirStat);
  long expectedFiles=totalEvents / rollCount;
  if (totalEvents % rollCount > 0)   expectedFiles++;
  Assert.assertEquals("num files wrong, found: " + Lists.newArrayList(fList),expectedFiles,fList.length);
  verifyOutputTextFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleAppend() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting...");
  final String fileName="FlumeData";
  final long rollCount=5;
  final long batchSize=2;
  final int numBatches=4;
  String newPath=testPath + "/singleBucket";
  int totalEvents=0;
  int i=1, j=1;
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(newPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(rollCount));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  for (i=1; i < numBatches; i++) {
    Transaction txn=channel.getTransaction();
    txn.begin();
    for (j=1; j <= batchSize; j++) {
      Event event=new SimpleEvent();
      eventDate.clear();
      eventDate.set(2011,i,i,i,0);
      event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
      event.getHeaders().put("hostname","Host" + i);
      String body="Test." + i + "."+ j;
      event.setBody(body.getBytes());
      bodies.add(body);
      channel.put(event);
      totalEvents++;
    }
    txn.commit();
    txn.close();
    sink.process();
  }
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path fList[]=FileUtil.stat2Paths(dirStat);
  long expectedFiles=totalEvents / rollCount;
  if (totalEvents % rollCount > 0)   expectedFiles++;
  Assert.assertEquals("num files wrong, found: " + Lists.newArrayList(fList),expectedFiles,fList.length);
  verifyOutputSequenceFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleAppendLocalTime() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  final long currentTime=System.currentTimeMillis();
  Clock clk=new Clock(){
    @Override public long currentTimeMillis(){
      return currentTime;
    }
  }
;
  LOG.debug("Starting...");
  final String fileName="FlumeData";
  final long rollCount=5;
  final long batchSize=2;
  final int numBatches=4;
  String newPath=testPath + "/singleBucket/%s";
  String expectedPath=testPath + "/singleBucket/" + String.valueOf(currentTime / 1000);
  int totalEvents=0;
  int i=1, j=1;
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(expectedPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(rollCount));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.useLocalTimeStamp",String.valueOf(true));
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.setBucketClock(clk);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  for (i=1; i < numBatches; i++) {
    Transaction txn=channel.getTransaction();
    txn.begin();
    for (j=1; j <= batchSize; j++) {
      Event event=new SimpleEvent();
      eventDate.clear();
      eventDate.set(2011,i,i,i,0);
      event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
      event.getHeaders().put("hostname","Host" + i);
      String body="Test." + i + "."+ j;
      event.setBody(body.getBytes());
      bodies.add(body);
      channel.put(event);
      totalEvents++;
    }
    txn.commit();
    txn.close();
    sink.process();
  }
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path fList[]=FileUtil.stat2Paths(dirStat);
  long expectedFiles=totalEvents / rollCount;
  if (totalEvents % rollCount > 0)   expectedFiles++;
  Assert.assertEquals("num files wrong, found: " + Lists.newArrayList(fList),expectedFiles,fList.length);
  verifyOutputSequenceFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
  sink.setBucketClock(new SystemClock());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSEventSinkOnMiniCluster </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is a very basic test that writes one event to HDFS and reads it back.
 */
@Test public void simpleHDFSTest() throws EventDeliveryException, IOException {
  cluster=new MiniDFSCluster(new Configuration(),1,true,null);
  cluster.waitActive();
  String outputDir="/flume/simpleHDFSTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.DataStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  String EVENT_BODY="yarg!";
  channel.getTransaction().begin();
  try {
    channel.put(EventBuilder.withBody(EVENT_BODY,Charsets.UTF_8));
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  sink.process();
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  Assert.assertEquals("Only one file expected",1,statuses.length);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertEquals(EVENT_BODY,line);
  }
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is a very basic test that writes one event to HDFS and reads it back.
 */
@Test public void underReplicationTest() throws EventDeliveryException, IOException {
  Configuration conf=new Configuration();
  conf.set("dfs.replication",String.valueOf(3));
  cluster=new MiniDFSCluster(conf,3,true,null);
  cluster.waitActive();
  String outputDir="/flume/underReplicationTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.DataStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  channel.getTransaction().begin();
  try {
    channel.put(EventBuilder.withBody("yarg 1",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 2",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 3",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 4",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 5",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 5",Charsets.UTF_8));
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Same file.");
  sink.process();
  logger.info("Killing datanode #1...");
  cluster.stopDataNode(0);
  logger.info("Running process(). Create new file? (racy)");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertTrue(line.startsWith("yarg"));
  }
  Assert.assertTrue("4 or 5 files expected, found " + statuses.length,statuses.length == 4 || statuses.length == 5);
  System.out.println("There are " + statuses.length + " files.");
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Writes two events in GZIP-compressed serialize.
 */
@Test public void simpleHDFSGZipCompressedTest() throws EventDeliveryException, IOException {
  cluster=new MiniDFSCluster(new Configuration(),1,true,null);
  cluster.waitActive();
  String outputDir="/flume/simpleHDFSGZipCompressedTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.CompStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  sinkCtx.put("hdfs.codeC","gzip");
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  String EVENT_BODY_1="yarg1";
  String EVENT_BODY_2="yarg2";
  channel.getTransaction().begin();
  try {
    channel.put(EventBuilder.withBody(EVENT_BODY_1,Charsets.UTF_8));
    channel.put(EventBuilder.withBody(EVENT_BODY_2,Charsets.UTF_8));
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  sink.process();
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  Assert.assertEquals("Only one file expected",1,statuses.length);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(new GZIPInputStream(stream)));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertEquals(EVENT_BODY_1,line);
  }
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This is a very basic test that writes one event to HDFS and reads it back.
 */
@Ignore("This test is flakey and causes tests to fail pretty often.") @Test public void maxUnderReplicationTest() throws EventDeliveryException, IOException {
  Configuration conf=new Configuration();
  conf.set("dfs.replication",String.valueOf(3));
  cluster=new MiniDFSCluster(conf,3,true,null);
  cluster.waitActive();
  String outputDir="/flume/underReplicationTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.DataStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  channel.getTransaction().begin();
  try {
    for (int i=0; i < 50; i++) {
      channel.put(EventBuilder.withBody("yarg " + i,Charsets.UTF_8));
    }
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Same file.");
  sink.process();
  logger.info("Killing datanode #1...");
  cluster.stopDataNode(0);
  logger.info("Running process(). Create new file? (racy)");
  sink.process();
  for (int i=3; i < 50; i++) {
    logger.info("Running process().");
    sink.process();
  }
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertTrue(line.startsWith("yarg"));
  }
  System.out.println("There are " + statuses.length + " files.");
  Assert.assertEquals("31 files expected, found " + statuses.length,31,statuses.length);
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.kafka.KafkaSinkUtilTest </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetKafkaProperties(){
  Context context=new Context();
  context.put("kafka.serializer.class","override.default.serializer");
  context.put("kafka.fake.property","kafka.property.value");
  context.put("kafka.metadata.broker.list","bad-broker-list");
  context.put("brokerList","real-broker-list");
  Properties kafkaProps=KafkaSinkUtil.getKafkaProperties(context);
  assertEquals(kafkaProps.getProperty(KafkaSinkConstants.KEY_SERIALIZER_KEY),KafkaSinkConstants.DEFAULT_KEY_SERIALIZER);
  assertEquals(kafkaProps.getProperty(KafkaSinkConstants.MESSAGE_SERIALIZER_KEY),"override.default.serializer");
  assertEquals(kafkaProps.getProperty("fake.property"),"kafka.property.value");
  assertEquals(kafkaProps.getProperty("metadata.broker.list"),"real-broker-list");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.kite.TestDatasetSink </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimedFileRolling() throws EventDeliveryException, InterruptedException {
  config.put("kite.rollInterval","1");
  DatasetSink sink=sink(in,config);
  Dataset<GenericRecord> records=Datasets.load(FILE_DATASET_URI);
  sink.start();
  sink.process();
  Assert.assertEquals("Should have committed",0,remaining(in));
  Thread.sleep(1100);
  sink.process();
  Assert.assertEquals(Sets.newHashSet(expected),read(records));
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParquetDataset() throws EventDeliveryException {
  Datasets.delete(FILE_DATASET_URI);
  Dataset<GenericRecord> created=Datasets.create(FILE_DATASET_URI,new DatasetDescriptor.Builder(DESCRIPTOR).format("parquet").build());
  DatasetSink sink=sink(in,config);
  sink.start();
  sink.process();
  assertThrows("Transaction should still be open",IllegalStateException.class,new Callable(){
    @Override public Object call() throws EventDeliveryException {
      in.getTransaction().begin();
      return null;
    }
  }
);
  Assert.assertEquals("Should not have committed",0,read(created).size());
  sink.stop();
  Assert.assertEquals(Sets.newHashSet(expected),read(created));
  Assert.assertEquals("Should have committed",0,remaining(in));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseWriter() throws EventDeliveryException {
  config.put(DatasetSinkConstants.CONFIG_FLUSHABLE_COMMIT_ON_BATCH,Boolean.toString(false));
  config.put(DatasetSinkConstants.CONFIG_SYNCABLE_SYNC_ON_BATCH,Boolean.toString(false));
  DatasetSink sink=sink(in,config);
  sink.start();
  sink.process();
  sink.closeWriter();
  sink.commitTransaction();
  Assert.assertNull("Writer should be null",sink.getWriter());
  Assert.assertEquals("Should have committed",0,remaining(in));
  sink.stop();
  Assert.assertEquals(Sets.newHashSet(expected),read(Datasets.load(FILE_DATASET_URI)));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseAndCreateWriter() throws EventDeliveryException {
  config.put(DatasetSinkConstants.CONFIG_FLUSHABLE_COMMIT_ON_BATCH,Boolean.toString(false));
  config.put(DatasetSinkConstants.CONFIG_SYNCABLE_SYNC_ON_BATCH,Boolean.toString(false));
  DatasetSink sink=sink(in,config);
  sink.start();
  sink.process();
  sink.closeWriter();
  sink.commitTransaction();
  sink.createWriter();
  Assert.assertNotNull("Writer should not be null",sink.getWriter());
  Assert.assertEquals("Should have committed",0,remaining(in));
  sink.stop();
  Assert.assertEquals(Sets.newHashSet(expected),read(Datasets.load(FILE_DATASET_URI)));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerializedWithIncompatibleSchemasWithSavePolicy() throws EventDeliveryException {
  if (Datasets.exists(ERROR_DATASET_URI)) {
    Datasets.delete(ERROR_DATASET_URI);
  }
  config.put(DatasetSinkConstants.CONFIG_FAILURE_POLICY,DatasetSinkConstants.SAVE_FAILURE_POLICY);
  config.put(DatasetSinkConstants.CONFIG_KITE_ERROR_DATASET_URI,ERROR_DATASET_URI);
  final DatasetSink sink=sink(in,config);
  GenericRecordBuilder builder=new GenericRecordBuilder(INCOMPATIBLE_SCHEMA);
  GenericData.Record rec=builder.set("username","koala").build();
  Event badEvent=event(rec,INCOMPATIBLE_SCHEMA,SCHEMA_FILE,true);
  putToChannel(in,badEvent);
  sink.start();
  sink.process();
  sink.stop();
  Assert.assertEquals("Good records should have been written",Sets.newHashSet(expected),read(Datasets.load(FILE_DATASET_URI)));
  Assert.assertEquals("Should not have rolled back",0,remaining(in));
  Assert.assertEquals("Should have saved the bad event",Sets.newHashSet(AvroFlumeEvent.newBuilder().setBody(ByteBuffer.wrap(badEvent.getBody())).setHeaders(toUtf8Map(badEvent.getHeaders())).build()),read(Datasets.load(ERROR_DATASET_URI,AvroFlumeEvent.class)));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateWriter() throws EventDeliveryException {
  config.put(DatasetSinkConstants.CONFIG_FLUSHABLE_COMMIT_ON_BATCH,Boolean.toString(false));
  config.put(DatasetSinkConstants.CONFIG_SYNCABLE_SYNC_ON_BATCH,Boolean.toString(false));
  DatasetSink sink=sink(in,config);
  sink.start();
  sink.process();
  sink.commitTransaction();
  sink.createWriter();
  Assert.assertNotNull("Writer should not be null",sink.getWriter());
  Assert.assertEquals("Should have committed",0,remaining(in));
  sink.stop();
  Assert.assertEquals(0,read(Datasets.load(FILE_DATASET_URI)).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.solr.morphline.TestBlobHandler </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleEvent() throws Exception {
  byte[] json="foo".getBytes("UTF-8");
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  assertEquals(1,deserialized.size());
  Event e=deserialized.get(0);
  assertEquals(0,e.getHeaders().size());
  assertEquals("foo",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyEvent() throws Exception {
  byte[] json="".getBytes("UTF-8");
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  assertEquals(1,deserialized.size());
  Event e=deserialized.get(0);
  assertEquals(0,e.getHeaders().size());
  assertEquals("",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.solr.morphline.TestMorphlineInterceptor </h4><pre class="type-9 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGrokIfNotMatchDropEventDrop() throws Exception {
  Context context=new Context();
  context.put(MorphlineHandlerImpl.MORPHLINE_FILE_PARAM,RESOURCES_DIR + "/test-morphlines/grokIfNotMatchDropRecord.conf");
  String msg="<XXXXXXXXXXXXX164>Feb  4 10:46:14 syslog sshd[607]: Server listening on 0.0.0.0 port 22.";
  Event input=EventBuilder.withBody(null,ImmutableMap.of(Fields.MESSAGE,msg));
  Event actual=build(context).intercept(input);
  assertNull(actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestExecSource </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMonitoredCounterGroup() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  if (SystemUtils.IS_OS_WINDOWS) {
    runTestShellCmdHelper("powershell -ExecutionPolicy Unrestricted -command","foreach ($i in 1..5) { $i }",new String[]{"1","2","3","4","5"});
  }
 else {
    runTestShellCmdHelper("/bin/bash -c","for i in {1..5}; do echo $i;done",new String[]{"1","2","3","4","5"});
  }
  ObjectName objName=null;
  try {
    objName=new ObjectName("org.apache.flume.source" + ":type=" + source.getName());
    MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
    String strAtts[]={"Type","EventReceivedCount","EventAcceptedCount"};
    AttributeList attrList=mbeanServer.getAttributes(objName,strAtts);
    Assert.assertNotNull(attrList.get(0));
    Assert.assertEquals("Expected Value: Type","Type",((Attribute)attrList.get(0)).getName());
    Assert.assertEquals("Expected Value: SOURCE","SOURCE",((Attribute)attrList.get(0)).getValue());
    Assert.assertNotNull(attrList.get(1));
    Assert.assertEquals("Expected Value: EventReceivedCount","EventReceivedCount",((Attribute)attrList.get(1)).getName());
    Assert.assertEquals("Expected Value: 5","5",((Attribute)attrList.get(1)).getValue().toString());
    Assert.assertNotNull(attrList.get(2));
    Assert.assertEquals("Expected Value: EventAcceptedCount","EventAcceptedCount",((Attribute)attrList.get(2)).getName());
    Assert.assertEquals("Expected Value: 5","5",((Attribute)attrList.get(2)).getValue().toString());
  }
 catch (  Exception ex) {
    System.out.println("Unable to retreive the monitored counter: " + objName + ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testShellCommandEmbeddingAndEscaping() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  String fileName=SystemUtils.IS_OS_WINDOWS ? "src\\test\\resources\\test_command.ps1" : "src/test/resources/test_command.txt";
  BufferedReader reader=new BufferedReader(new FileReader(fileName));
  try {
    String shell=SystemUtils.IS_OS_WINDOWS ? "powershell -ExecutionPolicy Unrestricted -command" : "/bin/bash -c";
    String command1=reader.readLine();
    Assert.assertNotNull(command1);
    String[] output1=new String[]{"'1'","\"2\"","\\3","\\4"};
    runTestShellCmdHelper(shell,command1,output1);
    String command2=reader.readLine();
    Assert.assertNotNull(command2);
    String[] output2=new String[]{"1","2","3","4","5"};
    runTestShellCmdHelper(shell,command2,output2);
    String command3=reader.readLine();
    Assert.assertNotNull(command3);
    String[] output3=new String[]{"2","3","4","5","6"};
    runTestShellCmdHelper(shell,command3,output3);
  }
  finally {
    reader.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestMultiportSyslogTCPSource </h4><pre class="type-12 type-9 type-13 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Basic test to exercise multiple-port parsing.
 */
@Test public void testMultiplePorts() throws IOException, ParseException {
  MultiportSyslogTCPSource source=new MultiportSyslogTCPSource();
  Channel channel=new MemoryChannel();
  Context channelContext=new Context();
  channelContext.put("capacity",String.valueOf(2000));
  channelContext.put("transactionCapacity",String.valueOf(2000));
  Configurables.configure(channel,channelContext);
  List<Channel> channels=Lists.newArrayList();
  channels.add(channel);
  ChannelSelector rcs=new ReplicatingChannelSelector();
  rcs.setChannels(channels);
  source.setChannelProcessor(new ChannelProcessor(rcs));
  Context context=new Context();
  StringBuilder ports=new StringBuilder();
  for (int i=0; i < 1000; i++) {
    ports.append(String.valueOf(BASE_TEST_SYSLOG_PORT + i)).append(" ");
  }
  context.put(SyslogSourceConfigurationConstants.CONFIG_PORTS,ports.toString().trim());
  source.configure(context);
  source.start();
  Socket syslogSocket;
  for (int i=0; i < 1000; i++) {
    syslogSocket=new Socket(InetAddress.getLocalHost(),BASE_TEST_SYSLOG_PORT + i);
    syslogSocket.getOutputStream().write(getEvent(i));
    syslogSocket.close();
  }
  List<Event> channelEvents=new ArrayList<Event>();
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 1000; i++) {
    Event e=channel.take();
    if (e == null) {
      throw new NullPointerException("Event is null");
    }
    channelEvents.add(e);
  }
  try {
    txn.commit();
  }
 catch (  Throwable t) {
    txn.rollback();
  }
 finally {
    txn.close();
  }
  for (int i=0; i < 1000; i++) {
    Iterator<Event> iter=channelEvents.iterator();
    while (iter.hasNext()) {
      Event e=iter.next();
      Map<String,String> headers=e.getHeaders();
      Integer port=null;
      if (headers.containsKey(SyslogSourceConfigurationConstants.DEFAULT_PORT_HEADER)) {
        port=Integer.parseInt(headers.get(SyslogSourceConfigurationConstants.DEFAULT_PORT_HEADER));
      }
      iter.remove();
      Assert.assertEquals("Timestamps must match",String.valueOf(time.getMillis()),headers.get("timestamp"));
      String host2=headers.get("host");
      Assert.assertEquals(host1,host2);
      if (port != null) {
        int num=port - BASE_TEST_SYSLOG_PORT;
        Assert.assertEquals(data1 + " " + String.valueOf(num),new String(e.getBody()));
      }
    }
  }
  source.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the reassembly of a single line across multiple packets.
 */
@Test public void testFragmented() throws CharacterCodingException {
  final int maxLen=100;
  IoBuffer savedBuf=IoBuffer.allocate(maxLen);
  String origMsg="<1>- - blah blam foo\n";
  IoBuffer buf1=IoBuffer.wrap(origMsg.substring(0,11).getBytes(Charsets.UTF_8));
  IoBuffer buf2=IoBuffer.wrap(origMsg.substring(11,16).getBytes(Charsets.UTF_8));
  IoBuffer buf3=IoBuffer.wrap(origMsg.substring(16,21).getBytes(Charsets.UTF_8));
  LineSplitter lineSplitter=new LineSplitter(maxLen);
  ParsedBuffer parsedLine=new ParsedBuffer();
  Assert.assertFalse("Incomplete line should not be parsed",lineSplitter.parseLine(buf1,savedBuf,parsedLine));
  Assert.assertFalse("Incomplete line should not be parsed",lineSplitter.parseLine(buf2,savedBuf,parsedLine));
  Assert.assertTrue("Completed line should be parsed",lineSplitter.parseLine(buf3,savedBuf,parsedLine));
  Assert.assertEquals(origMsg.trim(),parsedLine.buffer.getString(Charsets.UTF_8.newDecoder()));
  parsedLine.buffer.rewind();
  MultiportSyslogTCPSource.MultiportSyslogHandler handler=new MultiportSyslogTCPSource.MultiportSyslogHandler(maxLen,100,null,null,SyslogSourceConfigurationConstants.DEFAULT_PORT_HEADER,new ThreadSafeDecoder(Charsets.UTF_8),new ConcurrentHashMap<Integer,ThreadSafeDecoder>(),null);
  Event event=handler.parseEvent(parsedLine,Charsets.UTF_8.newDecoder());
  String body=new String(event.getBody(),Charsets.UTF_8);
  Assert.assertEquals("Event body incorrect",origMsg.trim().substring(7),body);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that different charsets are parsed by different ports correctly.
 */
@Test public void testPortCharsetHandling() throws UnknownHostException, Exception {
  InetAddress localAddr=InetAddress.getLocalHost();
  DefaultIoSessionDataStructureFactory dsFactory=new DefaultIoSessionDataStructureFactory();
  int port1=10001;
  NioSession session1=mock(NioSession.class);
  session1.setAttributeMap(dsFactory.getAttributeMap(session1));
  SocketAddress sockAddr1=new InetSocketAddress(localAddr,port1);
  when(session1.getLocalAddress()).thenReturn(sockAddr1);
  int port2=10002;
  NioSession session2=mock(NioSession.class);
  session2.setAttributeMap(dsFactory.getAttributeMap(session2));
  SocketAddress sockAddr2=new InetSocketAddress(localAddr,port2);
  when(session2.getLocalAddress()).thenReturn(sockAddr2);
  ConcurrentMap<Integer,ThreadSafeDecoder> portCharsets=new ConcurrentHashMap<Integer,ThreadSafeDecoder>();
  portCharsets.put(port1,new ThreadSafeDecoder(Charsets.ISO_8859_1));
  portCharsets.put(port2,new ThreadSafeDecoder(Charsets.UTF_8));
  MemoryChannel chan=new MemoryChannel();
  chan.configure(new Context());
  chan.start();
  ReplicatingChannelSelector sel=new ReplicatingChannelSelector();
  sel.setChannels(Lists.<Channel>newArrayList(chan));
  ChannelProcessor chanProc=new ChannelProcessor(sel);
  MultiportSyslogHandler handler=new MultiportSyslogHandler(1000,10,chanProc,new SourceCounter("test"),"port",new ThreadSafeDecoder(Charsets.UTF_8),portCharsets,null);
  handler.sessionCreated(session1);
  handler.sessionCreated(session2);
  String header="<10>2012-08-17T02:14:00-07:00 192.168.1.110 ";
  String dangerousChars="þÿÀÁ";
  String msg;
  IoBuffer buf;
  Event evt;
  msg=header + dangerousChars + "\n";
  buf=IoBuffer.wrap(msg.getBytes(Charsets.ISO_8859_1));
  handler.messageReceived(session1,buf);
  evt=takeEvent(chan);
  Assert.assertNotNull("Event vanished!",evt);
  Assert.assertNull(evt.getHeaders().get(SyslogUtils.EVENT_STATUS));
  msg=header + dangerousChars + "\n";
  buf=IoBuffer.wrap(msg.getBytes(Charsets.ISO_8859_1));
  handler.messageReceived(session2,buf);
  evt=takeEvent(chan);
  Assert.assertNotNull("Event vanished!",evt);
  Assert.assertEquals("Expected invalid event due to character encoding",SyslogUtils.SyslogStatus.INVALID.getSyslogStatus(),evt.getHeaders().get(SyslogUtils.EVENT_STATUS));
  msg=header + dangerousChars + "\n";
  buf=IoBuffer.wrap(msg.getBytes(Charsets.UTF_8));
  handler.messageReceived(session2,buf);
  evt=takeEvent(chan);
  Assert.assertNotNull("Event vanished!",evt);
  Assert.assertNull(evt.getHeaders().get(SyslogUtils.EVENT_STATUS));
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test parser handling of different character sets.
 */
@Test public void testCharsetParsing() throws FileNotFoundException, IOException {
  String header="<10>2012-08-11T01:01:01Z localhost ";
  String enBody="Yarf yarf yarf";
  String enMsg=header + enBody;
  String frBody="Comment " + "\u00EA" + "tes-vous?";
  String frMsg=header + frBody;
  String esBody="¿Cómo estás?";
  String esMsg=header + esBody;
  MultiportSyslogHandler handler=new MultiportSyslogHandler(1000,10,new ChannelProcessor(new ReplicatingChannelSelector()),new SourceCounter("test"),"port",new ThreadSafeDecoder(Charsets.UTF_8),new ConcurrentHashMap<Integer,ThreadSafeDecoder>(),null);
  ParsedBuffer parsedBuf=new ParsedBuffer();
  parsedBuf.incomplete=false;
  String[] bodies={enBody,esBody,frBody};
  String[] msgs={enMsg,esMsg,frMsg};
  Charset[] charsets={Charsets.UTF_8,Charsets.ISO_8859_1};
  for (  Charset charset : charsets) {
    for (int i=0; i < msgs.length; i++) {
      String msg=msgs[i];
      String body=bodies[i];
      parsedBuf.buffer=IoBuffer.wrap(msg.getBytes(charset));
      Event evt=handler.parseEvent(parsedBuf,charset.newDecoder());
      String result=new String(evt.getBody(),charset);
      Assert.assertEquals(charset + " parse error: " + msg,body,result);
      Assert.assertNull(evt.getHeaders().get(SyslogUtils.EVENT_STATUS));
    }
  }
  byte[] badUtf8Seq=enMsg.getBytes(Charsets.ISO_8859_1);
  int badMsgLen=badUtf8Seq.length;
  badUtf8Seq[badMsgLen - 2]=(byte)0xFE;
  badUtf8Seq[badMsgLen - 1]=(byte)0xFF;
  parsedBuf.buffer=IoBuffer.wrap(badUtf8Seq);
  Event evt=handler.parseEvent(parsedBuf,Charsets.UTF_8.newDecoder());
  Assert.assertEquals("event body: " + new String(evt.getBody(),Charsets.ISO_8859_1) + " and my default charset = "+ Charset.defaultCharset()+ " with event = "+ evt,SyslogUtils.SyslogStatus.INVALID.getSyslogStatus(),evt.getHeaders().get(SyslogUtils.EVENT_STATUS));
  Assert.assertArrayEquals("Raw message data should be kept in body of event",badUtf8Seq,evt.getBody());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestNetcatSource </h4><pre class="type-12 type-9 type-13 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws InterruptedException, LifecycleException, EventDeliveryException {
  ExecutorService executor=Executors.newFixedThreadPool(3);
  boolean bound=false;
  for (int i=0; i < 100 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("bind","0.0.0.0");
      context.put("port","41414");
      context.put("ack-every-event",String.valueOf(ackEveryEvent));
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    FlumeException e) {
    }
  }
  Runnable clientRequestRunnable=new Runnable(){
    @Override public void run(){
      try {
        SocketChannel clientChannel=SocketChannel.open(new InetSocketAddress(41414));
        Writer writer=Channels.newWriter(clientChannel,"utf-8");
        BufferedReader reader=new BufferedReader(Channels.newReader(clientChannel,"utf-8"));
        writer.write("Test message\n");
        writer.flush();
        if (ackEveryEvent) {
          String response=reader.readLine();
          Assert.assertEquals("Server should return OK","OK",response);
        }
 else {
          Assert.assertFalse("Server should not return anything",reader.ready());
        }
        clientChannel.close();
      }
 catch (      IOException e) {
        logger.error("Caught exception: ",e);
      }
    }
  }
;
  ChannelSelector selector=source.getChannelProcessor().getSelector();
  Transaction tx=selector.getAllChannels().get(0).getTransaction();
  tx.begin();
  for (int i=0; i < 100; i++) {
    logger.info("Sending request");
    executor.submit(clientRequestRunnable);
    Event event=channel.take();
    Assert.assertNotNull(event);
    Assert.assertArrayEquals("Test message".getBytes(),event.getBody());
  }
  tx.commit();
  tx.close();
  executor.shutdown();
  while (!executor.isTerminated()) {
    executor.awaitTermination(500,TimeUnit.MILLISECONDS);
  }
  source.stop();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that line above MaxLineLength are discarded
 * @throws InterruptedException
 * @throws IOException
 */
@Test public void testMaxLineLengthwithAck() throws InterruptedException, IOException {
  String encoding="UTF-8";
  String ackEvent="OK";
  String ackErrorEvent="FAILED: Event exceeds the maximum length (10 chars, including newline)";
  startSource(encoding,"true","1","10");
  Socket netcatSocket=new Socket(localhost,selectedPort);
  LineIterator inputLineIterator=IOUtils.lineIterator(netcatSocket.getInputStream(),encoding);
  try {
    sendEvent(netcatSocket,"123456789",encoding);
    Assert.assertArrayEquals("Channel contained our event","123456789".getBytes(defaultCharset),getFlumeEvent());
    Assert.assertEquals("Socket contained the Ack",ackEvent,inputLineIterator.nextLine());
    sendEvent(netcatSocket,english,encoding);
    Assert.assertEquals("Channel does not contain an event",null,getRawFlumeEvent());
    Assert.assertEquals("Socket contained the Error Ack",ackErrorEvent,inputLineIterator.nextLine());
  }
  finally {
    netcatSocket.close();
    stopSource();
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test if an ack is sent for every event in the correct encoding
 * @throws InterruptedException
 * @throws IOException
 */
@Test public void testAck() throws InterruptedException, IOException {
  String encoding="UTF-8";
  String ackEvent="OK";
  startSource(encoding,"true","1","512");
  Socket netcatSocket=new Socket(localhost,selectedPort);
  LineIterator inputLineIterator=IOUtils.lineIterator(netcatSocket.getInputStream(),encoding);
  try {
    for (int i=0; i < 20; i++) {
      sendEvent(netcatSocket,english,encoding);
      Assert.assertArrayEquals("Channel contained our event",english.getBytes(defaultCharset),getFlumeEvent());
      Assert.assertEquals("Socket contained the Ack",ackEvent,inputLineIterator.nextLine());
    }
    for (int i=0; i < 20; i++) {
      sendEvent(netcatSocket,french,encoding);
      Assert.assertArrayEquals("Channel contained our event",french.getBytes(defaultCharset),getFlumeEvent());
      Assert.assertEquals("Socket contained the Ack",ackEvent,inputLineIterator.nextLine());
    }
  }
  finally {
    netcatSocket.close();
    stopSource();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestSpoolDirectorySource </h4><pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutBasenameHeader() throws IOException, InterruptedException {
  Context context=new Context();
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
  context.put(SpoolDirectorySourceConfigurationConstants.BASENAME_HEADER,"true");
  context.put(SpoolDirectorySourceConfigurationConstants.BASENAME_HEADER_KEY,"basenameHeaderKeyTest");
  Configurables.configure(source,context);
  source.start();
  while (source.getSourceCounter().getEventAcceptedCount() < 8) {
    Thread.sleep(10);
  }
  Transaction txn=channel.getTransaction();
  txn.begin();
  Event e=channel.take();
  Assert.assertNotNull("Event must not be null",e);
  Assert.assertNotNull("Event headers must not be null",e.getHeaders());
  Assert.assertNotNull(e.getHeaders().get("basenameHeaderKeyTest"));
  Assert.assertEquals(f1.getName(),e.getHeaders().get("basenameHeaderKeyTest"));
  txn.commit();
  txn.close();
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutFilenameHeader() throws IOException, InterruptedException {
  Context context=new Context();
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
  context.put(SpoolDirectorySourceConfigurationConstants.FILENAME_HEADER,"true");
  context.put(SpoolDirectorySourceConfigurationConstants.FILENAME_HEADER_KEY,"fileHeaderKeyTest");
  Configurables.configure(source,context);
  source.start();
  while (source.getSourceCounter().getEventAcceptedCount() < 8) {
    Thread.sleep(10);
  }
  Transaction txn=channel.getTransaction();
  txn.begin();
  Event e=channel.take();
  Assert.assertNotNull("Event must not be null",e);
  Assert.assertNotNull("Event headers must not be null",e.getHeaders());
  Assert.assertNotNull(e.getHeaders().get("fileHeaderKeyTest"));
  Assert.assertEquals(f1.getAbsolutePath(),e.getHeaders().get("fileHeaderKeyTest"));
  txn.commit();
  txn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestStressSource </h4><pre class="type-12 type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBatchEventsWithoutMatTotalEvents() throws InterruptedException, EventDeliveryException {
  StressSource source=new StressSource();
  source.setChannelProcessor(mockProcessor);
  Context context=new Context();
  context.put("batchSize","10");
  source.configure(context);
  source.start();
  for (int i=0; i < 10; i++) {
    Assert.assertFalse("StressSource with no maxTotalEvents should not return " + Status.BACKOFF,source.process() == Status.BACKOFF);
  }
  verify(mockProcessor,times(10)).processEventBatch(getLastProcessedEventList(source));
  long successfulEvents=getCounterGroup(source).get("events.successful");
  TestCase.assertTrue("Number of successful events should be 100 but was " + successfulEvents,successfulEvents == 100);
  long failedEvents=getCounterGroup(source).get("events.failed");
  TestCase.assertTrue("Number of failure events should be 0 but was " + failedEvents,failedEvents == 0);
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBatchEvents() throws InterruptedException, EventDeliveryException {
  StressSource source=new StressSource();
  source.setChannelProcessor(mockProcessor);
  Context context=new Context();
  context.put("maxTotalEvents","35");
  context.put("batchSize","10");
  source.configure(context);
  source.start();
  for (int i=0; i < 50; i++) {
    if (source.process() == Status.BACKOFF) {
      TestCase.assertTrue("Source should have sent all events in 4 batches",i == 4);
      break;
    }
    if (i < 3) {
      verify(mockProcessor,times(i + 1)).processEventBatch(getLastProcessedEventList(source));
    }
 else {
      verify(mockProcessor,times(1)).processEventBatch(getLastProcessedEventList(source));
    }
  }
  long successfulEvents=getCounterGroup(source).get("events.successful");
  TestCase.assertTrue("Number of successful events should be 35 but was " + successfulEvents,successfulEvents == 35);
  long failedEvents=getCounterGroup(source).get("events.failed");
  TestCase.assertTrue("Number of failure events should be 0 but was " + failedEvents,failedEvents == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.http.TestBLOBHandler </h4><pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testCSVData() throws Exception {
  Map requestParameterMap=new HashMap();
  requestParameterMap.put("param1",new String[]{"value1"});
  requestParameterMap.put("param2",new String[]{"value2"});
  HttpServletRequest req=mock(HttpServletRequest.class);
  final String csvData="a,b,c";
  ServletInputStream servletInputStream=new DelegatingServletInputStream(new ByteArrayInputStream(csvData.getBytes()));
  when(req.getInputStream()).thenReturn(servletInputStream);
  when(req.getParameterMap()).thenReturn(requestParameterMap);
  Context context=mock(Context.class);
  when(context.getString(BLOBHandler.MANDATORY_PARAMETERS,BLOBHandler.DEFAULT_MANDATORY_PARAMETERS)).thenReturn("param1,param2");
  handler.configure(context);
  List<Event> deserialized=handler.getEvents(req);
  assertEquals(1,deserialized.size());
  Event e=deserialized.get(0);
  assertEquals(new String(e.getBody()),csvData);
  assertEquals(e.getHeaders().get("param1"),"value1");
  assertEquals(e.getHeaders().get("param2"),"value2");
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testTabData() throws Exception {
  Map requestParameterMap=new HashMap();
  requestParameterMap.put("param1",new String[]{"value1"});
  HttpServletRequest req=mock(HttpServletRequest.class);
  final String tabData="a\tb\tc";
  ServletInputStream servletInputStream=new DelegatingServletInputStream(new ByteArrayInputStream(tabData.getBytes()));
  when(req.getInputStream()).thenReturn(servletInputStream);
  when(req.getParameterMap()).thenReturn(requestParameterMap);
  Context context=mock(Context.class);
  when(context.getString(BLOBHandler.MANDATORY_PARAMETERS,BLOBHandler.DEFAULT_MANDATORY_PARAMETERS)).thenReturn("param1");
  handler.configure(context);
  List<Event> deserialized=handler.getEvents(req);
  assertEquals(1,deserialized.size());
  Event e=deserialized.get(0);
  assertEquals(new String(e.getBody()),tabData);
  assertEquals(e.getHeaders().get("param1"),"value1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.http.TestJSONHandler </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoBody() throws Exception {
  String json="[{\"headers\" : {\"a\": \"b\"}}," + "{\"headers\" : {\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertTrue(e.getBody().length == 0);
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeserializarion() throws Exception {
  Type listType=new TypeToken<List<JSONEvent>>(){
  }
.getType();
  List<JSONEvent> events=Lists.newArrayList();
  Random rand=new Random();
  for (int i=1; i < 10; i++) {
    Map<String,String> input=Maps.newHashMap();
    for (int j=1; j < 10; j++) {
      input.put(String.valueOf(i) + String.valueOf(j),String.valueOf(i));
    }
    JSONEvent e=new JSONEvent();
    e.setBody(String.valueOf(rand.nextGaussian()).getBytes("UTF-8"));
    e.setHeaders(input);
    events.add(e);
  }
  Gson gson=new Gson();
  List<Event> deserialized=handler.getEvents(new FlumeHttpServletRequestWrapper(gson.toJson(events,listType)));
  int i=0;
  for (  Event e : deserialized) {
    Event current=events.get(i++);
    Assert.assertEquals(new String(current.getBody(),"UTF-8"),new String(e.getBody(),"UTF-8"));
    Assert.assertEquals(current.getHeaders(),e.getHeaders());
  }
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleEventsUTF32() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"},\"body\": \"random_body\"}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json,"UTF-32");
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-32"));
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-32"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleEventsUTF8() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"},\"body\": \"random_body\"}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json,"UTF-8");
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-8"));
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleEvent() throws Exception {
  String json="[{\"headers\" : {\"a\": \"b\"},\"body\": \"random_body\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleEventInArray() throws Exception {
  String json="[{\"headers\": {\"a\": \"b\"},\"body\": \"random_body\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscapedJSON() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"}}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"rand\\\"om_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertTrue(e.getBody().length == 0);
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("rand\"om_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleEvents() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"},\"body\": \"random_body\"}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-8"));
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleHTMLEvent() throws Exception {
  String json="[{\"headers\": {\"a\": \"b\"}," + "\"body\": \"<html><body>test</body></html>\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("<html><body>test</body></html>",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleEventsUTF16() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"},\"body\": \"random_body\"}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json,"UTF-16");
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-16"));
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-16"));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleLargeEvents() throws Exception {
  String json="[{\"headers\" : {\"a\": \"b\", \"a2\": \"b2\"," + "\"a3\": \"b3\",\"a4\": \"b4\"},\"body\": \"random_body\"}," + "{\"headers\" :{\"e\": \"f\",\"e2\": \"f2\","+ "\"e3\": \"f3\",\"e4\": \"f4\",\"e5\": \"f5\"},"+ "\"body\": \"random_body2\"},"+ "{\"headers\" :{\"q1\": \"b\",\"q2\": \"b2\",\"q3\": \"b3\",\"q4\": \"b4\"},"+ "\"body\": \"random_bodyq\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertNotNull(e);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertEquals("b2",e.getHeaders().get("a2"));
  Assert.assertEquals("b3",e.getHeaders().get("a3"));
  Assert.assertEquals("b4",e.getHeaders().get("a4"));
  Assert.assertEquals("random_body",new String(e.getBody(),"UTF-8"));
  e=deserialized.get(1);
  Assert.assertNotNull(e);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("f2",e.getHeaders().get("e2"));
  Assert.assertEquals("f3",e.getHeaders().get("e3"));
  Assert.assertEquals("f4",e.getHeaders().get("e4"));
  Assert.assertEquals("f5",e.getHeaders().get("e5"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-8"));
  e=deserialized.get(2);
  Assert.assertNotNull(e);
  Assert.assertEquals("b",e.getHeaders().get("q1"));
  Assert.assertEquals("b2",e.getHeaders().get("q2"));
  Assert.assertEquals("b3",e.getHeaders().get("q3"));
  Assert.assertEquals("b4",e.getHeaders().get("q4"));
  Assert.assertEquals("random_bodyq",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.kafka.TestKafkaSourceUtil </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testGetConsumer(){
  ConsumerConnector cc=KafkaSourceUtil.getConsumer(props);
  assertNotNull(cc);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKafkaConsumerProperties(){
  Context context=new Context();
  context.put("kafka.auto.commit.enable","override.default.autocommit");
  context.put("kafka.fake.property","kafka.property.value");
  context.put("kafka.zookeeper.connect","bad-zookeeper-list");
  context.put("zookeeperConnect","real-zookeeper-list");
  Properties kafkaProps=KafkaSourceUtil.getKafkaProperties(context);
  assertEquals(kafkaProps.getProperty(KafkaSourceConstants.GROUP_ID),KafkaSourceConstants.DEFAULT_GROUP_ID);
  assertEquals(kafkaProps.getProperty(KafkaSourceConstants.AUTO_COMMIT_ENABLED),"override.default.autocommit");
  assertEquals(kafkaProps.getProperty("fake.property"),"kafka.property.value");
  assertEquals(kafkaProps.getProperty("zookeeper.connect"),"real-zookeeper-list");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.taildir.TestTaildirEventReader </h4><pre class="type-9 type-13 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoadPositionFile() throws IOException {
  File f1=new File(tmpDir,"file1");
  File f2=new File(tmpDir,"file2");
  File f3=new File(tmpDir,"file3");
  Files.write("file1line1\nfile1line2\nfile1line3\n",f1,Charsets.UTF_8);
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  Files.write("file3line1\n",f3,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  Map<Long,TailFile> tailFiles=reader.getTailFiles();
  long pos=f2.length();
  int i=1;
  File posFile=new File(posFilePath);
  for (  TailFile tf : tailFiles.values()) {
    Files.append(i == 1 ? "[" : "",posFile,Charsets.UTF_8);
    Files.append(String.format("{\"inode\":%s,\"pos\":%s,\"file\":\"%s\"}",tf.getInode(),pos,tf.getPath()),posFile,Charsets.UTF_8);
    Files.append(i == 3 ? "]" : ",",posFile,Charsets.UTF_8);
    i++;
  }
  reader.loadPositionFile(posFilePath);
  for (  TailFile tf : tailFiles.values()) {
    if (tf.getPath().equals(tmpDir + "file3")) {
      assertEquals(0,tf.getPos());
    }
 else {
      assertEquals(pos,tf.getPos());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.taildir.TestTaildirSource </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileConsumeOrder() throws IOException {
  System.out.println(tmpDir.toString());
  File f1=new File(tmpDir,"file1");
  String line1="file1line1\n";
  String line2="file1line2\n";
  String line3="file1line3\n";
  Files.write(line1 + line2 + line3,f1,Charsets.UTF_8);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
  }
  String line1b="file2line1\n";
  String line2b="file2line2\n";
  String line3b="file2line3\n";
  File f2=new File(tmpDir,"file2");
  Files.write(line1b + line2b + line3b,f2,Charsets.UTF_8);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
  }
  String line1c="file3line1\n";
  String line2c="file3line2\n";
  String line3c="file3line3\n";
  File f3=new File(tmpDir,"file3");
  Files.write(line1c + line2c + line3c,f3,Charsets.UTF_8);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
  }
  String line1d="file4line1\n";
  String line2d="file4line2\n";
  String line3d="file4line3\n";
  File f4=new File(tmpDir,"file4");
  Files.write(line1d + line2d + line3d,f4,Charsets.UTF_8);
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
  }
  f3.setLastModified(System.currentTimeMillis());
  ArrayList<String> consumedOrder=Lists.newArrayList();
  Context context=new Context();
  context.put(POSITION_FILE,posFilePath);
  context.put(FILE_GROUPS,"g1");
  context.put(FILE_GROUPS_PREFIX + "g1",tmpDir.getAbsolutePath() + "/.*");
  Configurables.configure(source,context);
  source.start();
  source.process();
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 12; i++) {
    Event e=channel.take();
    String body=new String(e.getBody(),Charsets.UTF_8);
    consumedOrder.add(body);
  }
  txn.commit();
  txn.close();
  System.out.println(consumedOrder);
  ArrayList<String> expected=Lists.newArrayList(line1,line2,line3,line1b,line2b,line3b,line1d,line2d,line3d,line1c,line2c,line3c);
  for (int i=0; i != expected.size(); ++i) {
    expected.set(i,expected.get(i).trim());
  }
  assertArrayEquals("Files not consumed in expected order",expected.toArray(),consumedOrder.toArray());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.test.agent.TestFileChannel </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * File channel in/out test. Verifies that all events inserted into the
 * file channel are received by the sink in order.
 * The EXEC source creates 100 events where the event bodies have
 * sequential numbers. The source puts those events into the file channel,
 * and the FILE_ROLL The sink is expected to take all 100 events in FIFO
 * order.
 * @throws Exception
 */
@Test public void testInOut() throws Exception {
  LOGGER.debug("testInOut() started.");
  StagedInstall.getInstance().startAgent("a1",agentProps);
  TimeUnit.SECONDS.sleep(10);
  StringBuffer sb=new StringBuffer();
  for (int i=1; i <= 100; i++) {
    sb.append(i).append("\n");
  }
  String expectedOutput=sb.toString();
  LOGGER.info("Created expected output: " + expectedOutput);
  File[] sinkOutputDirChildren=sinkOutputDir.listFiles();
  Assert.assertEquals("Expected FILE_ROLL sink's dir to have only 1 child," + " but found " + sinkOutputDirChildren.length + " children.",1,sinkOutputDirChildren.length);
  File actualOutput=sinkOutputDirChildren[0];
  if (!Files.toString(actualOutput,Charsets.UTF_8).equals(expectedOutput)) {
    LOGGER.error("Actual output doesn't match expected output.\n");
    throw new AssertionError("FILE_ROLL sink's actual output doesn't " + "match expected output.");
  }
  LOGGER.debug("testInOut() ended.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.test.agent.TestSpooldirSource </h4><pre class="type-12 type-9 type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  File agentDir=StagedInstall.getInstance().getStageDir();
  LOGGER.debug("Using agent stage dir: {}",agentDir);
  File testDir=new File(agentDir,TestSpooldirSource.class.getName());
  assertTrue(testDir.mkdirs());
  File spoolParentDir=new File(testDir,"spools");
  assertTrue("Unable to create sink output dir: " + spoolParentDir.getPath(),spoolParentDir.mkdir());
  final int NUM_SOURCES=100;
  agentProps=new Properties();
  List<String> spooldirSrcNames=Lists.newArrayList();
  String channelName="mem-01";
  for (int i=0; i < NUM_SOURCES; i++) {
    String srcName=String.format("spooldir-%03d",i);
    File spoolDir=new File(spoolParentDir,srcName);
    assertTrue(spoolDir.mkdir());
    spooldirSrcNames.add(srcName);
    spoolDirs.add(spoolDir);
    agentProps.put(String.format("agent.sources.%s.type",srcName),"SPOOLDIR");
    agentProps.put(String.format("agent.sources.%s.spoolDir",srcName),spoolDir.getPath());
    agentProps.put(String.format("agent.sources.%s.channels",srcName),channelName);
  }
  agentProps.put("agent.channels.mem-01.type","MEMORY");
  agentProps.put("agent.channels.mem-01.capacity",String.valueOf(100000));
  sinkOutputDir=new File(testDir,"out");
  assertTrue("Unable to create sink output dir: " + sinkOutputDir.getPath(),sinkOutputDir.mkdir());
  agentProps.put("agent.sinks.roll-01.channel",channelName);
  agentProps.put("agent.sinks.roll-01.type","FILE_ROLL");
  agentProps.put("agent.sinks.roll-01.sink.directory",sinkOutputDir.getPath());
  agentProps.put("agent.sinks.roll-01.sink.rollInterval","0");
  agentProps.put("agent.sources",Joiner.on(" ").join(spooldirSrcNames));
  agentProps.put("agent.channels",channelName);
  agentProps.put("agent.sinks","roll-01");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.tools.TestTimestampRoundDownUtil </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundDownTimeStampMinutes(){
  Calendar cal=Calendar.getInstance();
  cal.clear();
  cal.set(2012,5,15,15,12,54);
  cal.set(Calendar.MILLISECOND,20);
  Calendar cal2=Calendar.getInstance();
  cal2.clear();
  cal2.set(2012,5,15,15,10,0);
  cal2.set(Calendar.MILLISECOND,0);
  long timeToVerify=cal2.getTimeInMillis();
  long ret=TimestampRoundDownUtil.roundDownTimeStampMinutes(cal.getTimeInMillis(),5);
  System.out.println("Cal 1: " + cal.toString());
  System.out.println("Cal 2: " + cal2.toString());
  Assert.assertEquals(timeToVerify,ret);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundDownTimeStampHours(){
  Calendar cal=Calendar.getInstance();
  cal.clear();
  cal.set(2012,5,15,15,12,54);
  cal.set(Calendar.MILLISECOND,20);
  Calendar cal2=Calendar.getInstance();
  cal2.clear();
  cal2.set(2012,5,15,14,0,0);
  cal2.set(Calendar.MILLISECOND,0);
  long timeToVerify=cal2.getTimeInMillis();
  long ret=TimestampRoundDownUtil.roundDownTimeStampHours(cal.getTimeInMillis(),2);
  System.out.println("Cal 1: " + ret);
  System.out.println("Cal 2: " + cal2.toString());
  Assert.assertEquals(timeToVerify,ret);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundDownTimeStampSeconds(){
  Calendar cal=Calendar.getInstance();
  cal.clear();
  cal.set(2012,5,15,15,12,54);
  cal.set(Calendar.MILLISECOND,20);
  Calendar cal2=Calendar.getInstance();
  cal2.clear();
  cal2.set(2012,5,15,15,12,0);
  cal2.set(Calendar.MILLISECOND,0);
  long timeToVerify=cal2.getTimeInMillis();
  long ret=TimestampRoundDownUtil.roundDownTimeStampSeconds(cal.getTimeInMillis(),60);
  System.out.println("Cal 1: " + cal.toString());
  System.out.println("Cal 2: " + cal2.toString());
  Assert.assertEquals(timeToVerify,ret);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
