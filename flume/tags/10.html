<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.flume.api.TestLoadBalancingRpcClient </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRoundRobinDistribution() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","round_robin");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.append(getEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendCount();
      counts.add(handler.getAppendCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() == 1);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoHostFailover() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.append(getEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendCount());
    Assert.assertEquals(40,h2.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRandomDistributionBatch() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","random");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendBatchCount();
      counts.add(handler.getAppendBatchCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() > 2);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLbDefaultClientTwoHostsBatch() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(50,h1.getAppendBatchCount());
    Assert.assertEquals(50,h2.getAppendBatchCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that we can tolerate a host that is completely down.
 * @throws Exception
 */
@Test public void testTwoHostsOneDead() throws Exception {
  LOGGER.info("Running testTwoHostsOneDead...");
  Server s1=null;
  RpcClient c1=null, c2=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + 0);
    p.put("hosts.h2","127.0.0.1:" + s1.getPort());
    c1=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c1 instanceof LoadBalancingRpcClient);
    for (int i=0; i < 10; i++) {
      c1.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(10,h1.getAppendBatchCount());
    c2=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c2 instanceof LoadBalancingRpcClient);
    for (int i=0; i < 10; i++) {
      c2.append(getEvent(i));
    }
    Assert.assertEquals(10,h1.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (c1 != null)     c1.close();
    if (c2 != null)     c2.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffFailureRecovery() throws EventDeliveryException, InterruptedException {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    if (i == 1) {
      s.setFailed();
    }
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("recovery test".getBytes()));
  }
  hosts.get(1).setOK();
  Thread.sleep(3000);
  int numEvents=60;
  for (int i=0; i < numEvents; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(2 + (numEvents / 3),hosts.get(0).getAppendCount());
  Assert.assertEquals(0 + (numEvents / 3),hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + (numEvents / 3),hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoHostFailoverBatch() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.appendBatch(getBatchedEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendBatchCount());
    Assert.assertEquals(40,h2.getAppendBatchCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffIncreasingBackoffs() throws Exception {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    if (i == 1) {
      s.setFailed();
    }
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  Thread.sleep(2100);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  hosts.get(1).setOK();
  Thread.sleep(2100);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(0,hosts.get(1).getAppendCount());
  Thread.sleep(2500);
  int numEvents=60;
  for (int i=0; i < numEvents; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(2 + 2 + 1+ (numEvents / 3),hosts.get(0).getAppendCount());
  Assert.assertEquals((numEvents / 3),hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + 1 + 2+ (numEvents / 3),hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundRobinBackoffInitialFailure() throws EventDeliveryException {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","round_robin");
  p.put("backoff","true");
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  hosts.get(1).setFailed();
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  hosts.get(1).setOK();
  for (int i=0; i < 3; i++) {
    c.append(EventBuilder.withBody("testing".getBytes()));
  }
  Assert.assertEquals(1 + 2 + 1,hosts.get(0).getAppendCount());
  Assert.assertEquals(1,hosts.get(1).getAppendCount());
  Assert.assertEquals(1 + 1 + 2,hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomBackoff() throws Exception {
  Properties p=new Properties();
  List<LoadBalancedAvroHandler> hosts=new ArrayList<LoadBalancedAvroHandler>();
  List<Server> servers=new ArrayList<Server>();
  StringBuilder hostList=new StringBuilder("");
  for (int i=0; i < 3; i++) {
    LoadBalancedAvroHandler s=new LoadBalancedAvroHandler();
    hosts.add(s);
    Server srv=RpcTestUtils.startServer(s);
    servers.add(srv);
    String name="h" + i;
    p.put("hosts." + name,"127.0.0.1:" + srv.getPort());
    hostList.append(name).append(" ");
  }
  p.put("hosts",hostList.toString().trim());
  p.put("client.type","default_loadbalance");
  p.put("host-selector","random");
  p.put("backoff","true");
  hosts.get(0).setFailed();
  hosts.get(2).setFailed();
  RpcClient c=RpcClientFactory.getInstance(p);
  Assert.assertTrue(c instanceof LoadBalancingRpcClient);
  for (int i=0; i < 50; i++) {
    c.append(EventBuilder.withBody(("test" + String.valueOf(i)).getBytes()));
  }
  Assert.assertEquals(50,hosts.get(1).getAppendCount());
  Assert.assertEquals(0,hosts.get(0).getAppendCount());
  Assert.assertEquals(0,hosts.get(2).getAppendCount());
  hosts.get(0).setOK();
  hosts.get(1).setFailed();
  try {
    c.append(EventBuilder.withBody("shouldfail".getBytes()));
    Assert.fail("Expected EventDeliveryException");
  }
 catch (  EventDeliveryException e) {
  }
  Thread.sleep(2500);
  for (int i=0; i < 50; i++) {
    c.append(EventBuilder.withBody(("test" + String.valueOf(i)).getBytes()));
  }
  Assert.assertEquals(50,hosts.get(0).getAppendCount());
  Assert.assertEquals(50,hosts.get(1).getAppendCount());
  Assert.assertEquals(0,hosts.get(2).getAppendCount());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-1 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=EventDeliveryException.class) public void testTwoHostFailoverThrowAfterClose() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      if (i == 20) {
        h2.setFailed();
      }
 else       if (i == 40) {
        h2.setOK();
      }
      c.append(getEvent(i));
    }
    Assert.assertEquals(60,h1.getAppendCount());
    Assert.assertEquals(40,h2.getAppendCount());
    if (c != null)     c.close();
    c.append(getEvent(3));
    Assert.fail();
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRoundRobinDistributionBatch() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","round_robin");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.appendBatch(getBatchedEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendBatchCount();
      counts.add(handler.getAppendBatchCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() == 1);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLbClientTenHostRandomDistribution() throws Exception {
  final int NUM_HOSTS=10;
  final int NUM_EVENTS=1000;
  Server[] s=new Server[NUM_HOSTS];
  LoadBalancedAvroHandler[] h=new LoadBalancedAvroHandler[NUM_HOSTS];
  RpcClient c=null;
  try {
    Properties p=new Properties();
    StringBuilder hostList=new StringBuilder("");
    for (int i=0; i < NUM_HOSTS; i++) {
      h[i]=new LoadBalancedAvroHandler();
      s[i]=RpcTestUtils.startServer(h[i]);
      String name="h" + i;
      p.put("hosts." + name,"127.0.0.1:" + s[i].getPort());
      hostList.append(name).append(" ");
    }
    p.put("hosts",hostList.toString().trim());
    p.put("client.type","default_loadbalance");
    p.put("host-selector","random");
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < NUM_EVENTS; i++) {
      c.append(getEvent(i));
    }
    Set<Integer> counts=new HashSet<Integer>();
    int total=0;
    for (    LoadBalancedAvroHandler handler : h) {
      total+=handler.getAppendCount();
      counts.add(handler.getAppendCount());
    }
    Assert.assertTrue("Very unusual distribution",counts.size() > 2);
    Assert.assertTrue("Missing events",total == NUM_EVENTS);
  }
  finally {
    for (int i=0; i < NUM_HOSTS; i++) {
      if (s[i] != null)       s[i].close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLbDefaultClientTwoHosts() throws Exception {
  Server s1=null, s2=null;
  RpcClient c=null;
  try {
    LoadBalancedAvroHandler h1=new LoadBalancedAvroHandler();
    LoadBalancedAvroHandler h2=new LoadBalancedAvroHandler();
    s1=RpcTestUtils.startServer(h1);
    s2=RpcTestUtils.startServer(h2);
    Properties p=new Properties();
    p.put("hosts","h1 h2");
    p.put("client.type","default_loadbalance");
    p.put("hosts.h1","127.0.0.1:" + s1.getPort());
    p.put("hosts.h2","127.0.0.1:" + s2.getPort());
    c=RpcClientFactory.getInstance(p);
    Assert.assertTrue(c instanceof LoadBalancingRpcClient);
    for (int i=0; i < 100; i++) {
      c.append(getEvent(i));
    }
    Assert.assertEquals(50,h1.getAppendCount());
    Assert.assertEquals(50,h2.getAppendCount());
  }
  finally {
    if (s1 != null)     s1.close();
    if (s2 != null)     s2.close();
    if (c != null)     c.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.api.TestNettyAvroRpcClient </h4><pre class="type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * First connect the client, then close the client, then send a request.
 * @throws FlumeException
 * @throws EventDeliveryException
 */
@Test(expected=EventDeliveryException.class) public void testClientClosedRequest() throws FlumeException, EventDeliveryException {
  NettyAvroRpcClient client=null;
  Server server=RpcTestUtils.startServer(new OKAvroHandler());
  try {
    client=RpcTestUtils.getStockLocalClient(server.getPort());
    client.close();
    Assert.assertFalse("Client should not be active",client.isActive());
    System.out.println("Yaya! I am not active after client close!");
    client.append(EventBuilder.withBody("hello",Charset.forName("UTF8")));
  }
  finally {
    RpcTestUtils.stopServer(server);
    if (client != null)     client.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * First connect the client, then shut down the server, then send a request.
 * @throws FlumeException
 * @throws EventDeliveryException
 * @throws InterruptedException
 */
@Test(expected=EventDeliveryException.class) public void testServerDisconnect() throws FlumeException, EventDeliveryException, InterruptedException {
  NettyAvroRpcClient client=null;
  Server server=RpcTestUtils.startServer(new OKAvroHandler());
  try {
    client=RpcTestUtils.getStockLocalClient(server.getPort());
    server.close();
    Thread.sleep(1000L);
    try {
      server.join();
    }
 catch (    InterruptedException ex) {
      logger.warn("Thread interrupted during join()",ex);
      Thread.currentThread().interrupt();
    }
    try {
      client.append(EventBuilder.withBody("hello",Charset.forName("UTF8")));
    }
  finally {
      Assert.assertFalse("Client should not be active",client.isActive());
    }
  }
  finally {
    RpcTestUtils.stopServer(server);
    if (client != null)     client.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.auth.TestFlumeAuthenticator </h4><pre class="type-9 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlumeLoginPrincipalWithoutRealm() throws Exception {
  String principal="flume";
  File keytab=new File(workDir,"flume2.keytab");
  kdc.createPrincipal(keytab,principal);
  String expResult=principal + "@" + kdc.getRealm();
  FlumeAuthenticationUtil.clearCredentials();
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
  assertTrue(authenticator.isAuthenticated());
  String result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Initial login failed",expResult,result);
  authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
  result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Re-login failed",expResult,result);
  principal="alice";
  keytab=aliceKeytab;
  try {
    authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab.getAbsolutePath());
    result=((KerberosAuthenticator)authenticator).getUserName();
    fail("Login should have failed with a new principal: " + result);
  }
 catch (  Exception ex) {
    assertTrue("Login with a new principal failed, but for an unexpected " + "reason: " + ex.getMessage(),ex.getMessage().contains("Cannot use multiple kerberos principals"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlumeLogin() throws IOException {
  String principal=flumePrincipal;
  String keytab=flumeKeytab.getAbsolutePath();
  String expResult=principal;
  FlumeAuthenticationUtil.clearCredentials();
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  assertTrue(authenticator.isAuthenticated());
  String result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Initial login failed",expResult,result);
  authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  result=((KerberosAuthenticator)authenticator).getUserName();
  assertEquals("Re-login failed",expResult,result);
  principal=alicePrincipal;
  keytab=aliceKeytab.getAbsolutePath();
  try {
    authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
    result=((KerberosAuthenticator)authenticator).getUserName();
    fail("Login should have failed with a new principal: " + result);
  }
 catch (  Exception ex) {
    assertTrue("Login with a new principal failed, but for an unexpected " + "reason: " + ex.getMessage(),ex.getMessage().contains("Cannot use multiple kerberos principals"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNullLogin() throws IOException {
  String principal=null;
  String keytab=null;
  FlumeAuthenticator authenticator=FlumeAuthenticationUtil.getAuthenticator(principal,keytab);
  assertFalse(authenticator.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestBasicChannelSemantics </h4><pre class="type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTake1() throws Exception {
  testIllegalState(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
  Transaction transaction=channel.getTransaction();
  testIllegalState(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
  transaction.begin();
  Assert.assertNull(channel.take());
  for (int i=0; i < 1000; ++i) {
    channel.put(events.get(i % events.size()));
  }
  Assert.assertNotNull(channel.take());
  testWrongThread(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
  testBasicExceptions(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
  testMode(TestChannel.Mode.SLEEP,new Runnable(){
    @Override public void run(){
      interruptTest(new Runnable(){
        @Override public void run(){
          Assert.assertNull(channel.take());
          Assert.assertTrue(Thread.interrupted());
        }
      }
);
    }
  }
);
  Assert.assertNotNull(channel.take());
  transaction.commit();
  testIllegalState(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
  transaction.close();
  testIllegalState(new Runnable(){
    @Override public void run(){
      channel.take();
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestChannelProcessor </h4><pre class="type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that we see the original NPE from the PreConditions check instead
 * of an auto-generated NPE, which could be masking something else.
 */
@Test public void testNullFromGetTransaction(){
  Channel ch=mock(Channel.class);
  when(ch.getTransaction()).thenReturn(null);
  ChannelSelector sel=new ReplicatingChannelSelector();
  sel.setChannels(Lists.newArrayList(ch));
  ChannelProcessor proc=new ChannelProcessor(sel);
  List<Event> events=Lists.newArrayList();
  events.add(EventBuilder.withBody("event 1",Charsets.UTF_8));
  boolean threw=false;
  try {
    proc.processEventBatch(events);
  }
 catch (  NullPointerException ex) {
    threw=true;
    Assert.assertNotNull("NPE must be manually thrown",ex.getMessage());
  }
  Assert.assertTrue("Must throw NPE",threw);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestChannelUtils </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHappyPath2(){
  ChannelUtils.take(channel);
  Assert.assertTrue(channel.wasLastTransactionCommitted());
  Assert.assertFalse(channel.wasLastTransactionRolledBack());
  Assert.assertTrue(channel.wasLastTransactionClosed());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHappyPath1(){
  ChannelUtils.put(channel,events.get(0));
  Assert.assertTrue(channel.wasLastTransactionCommitted());
  Assert.assertFalse(channel.wasLastTransactionRolledBack());
  Assert.assertTrue(channel.wasLastTransactionClosed());
}

</code></pre>

<br>
<pre class="type-12 type-10 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHappyPath5(){
  int rounds=10;
  for (int i=0; i < rounds; ++i) {
    ChannelUtils.put(channel,events);
  }
  for (int i=0; i < rounds; ++i) {
    List<Event> takenEvents=ChannelUtils.take(channel,events.size());
    Assert.assertTrue(takenEvents.size() == events.size());
    for (int j=0; j < events.size(); ++j) {
      Assert.assertSame(events.get(j),takenEvents.get(j));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestMemoryChannel </h4><pre class="type-12 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChannelResize(){
  Context context=new Context();
  Map<String,String> parms=new HashMap<String,String>();
  parms.put("capacity","5");
  parms.put("transactionCapacity","5");
  context.putAll(parms);
  Configurables.configure(channel,context);
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 5; i++) {
    channel.put(EventBuilder.withBody(String.format("test event %d",i).getBytes()));
  }
  transaction.commit();
  transaction.close();
  transaction=channel.getTransaction();
  boolean overflowed=false;
  try {
    transaction.begin();
    channel.put(EventBuilder.withBody("overflow event".getBytes()));
    transaction.commit();
  }
 catch (  ChannelException e) {
    overflowed=true;
    transaction.rollback();
  }
 finally {
    transaction.close();
  }
  Assert.assertTrue(overflowed);
  parms.put("capacity","6");
  context.putAll(parms);
  Configurables.configure(channel,context);
  transaction=channel.getTransaction();
  transaction.begin();
  channel.put(EventBuilder.withBody("extended capacity event".getBytes()));
  transaction.commit();
  transaction.close();
  parms.put("capacity","2");
  parms.put("transactionCapacity","2");
  context.putAll(parms);
  Configurables.configure(channel,context);
  for (int i=0; i < 6; i++) {
    transaction=channel.getTransaction();
    transaction.begin();
    Assert.assertNotNull(channel.take());
    transaction.commit();
    transaction.close();
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testNegativeCapacities(){
  Context context=new Context();
  Map<String,String> parms=new HashMap<String,String>();
  parms.put("capacity","-3");
  parms.put("transactionCapacity","-1");
  context.putAll(parms);
  Configurables.configure(channel,context);
  Assert.assertTrue(field("queue").ofType(LinkedBlockingDeque.class).in(channel).get().remainingCapacity() > 0);
  Assert.assertTrue(field("transCapacity").ofType(Integer.class).in(channel).get() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestMultiplexingChannelSelector </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoSelection() throws Exception {
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("default","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event noHeaderEvent=new MockEvent();
  List<Channel> reqCh1=selector.getRequiredChannels(noHeaderEvent);
  List<Channel> optCh1=selector.getOptionalChannels(noHeaderEvent);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertTrue(reqCh1.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh1.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh1.isEmpty());
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("someheader","foo");
  Event invalidHeaderEvent=new MockEvent();
  invalidHeaderEvent.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(invalidHeaderEvent);
  List<Channel> optCh2=selector.getOptionalChannels(invalidHeaderEvent);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertTrue(reqCh2.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh2.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh2.isEmpty());
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","bar1");
  Event unmatchedHeaderEvent=new MockEvent();
  unmatchedHeaderEvent.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(unmatchedHeaderEvent);
  List<Channel> optCh3=selector.getOptionalChannels(unmatchedHeaderEvent);
  Assert.assertEquals(2,reqCh3.size());
  Assert.assertTrue(reqCh3.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh3.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh3.isEmpty());
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  Event zebraEvent=new MockEvent();
  zebraEvent.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(zebraEvent);
  List<Channel> optCh4=selector.getOptionalChannels(zebraEvent);
  Assert.assertEquals(2,reqCh4.size());
  Assert.assertTrue(reqCh4.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh4.get(1).getName().equals("ch3"));
  Assert.assertTrue(optCh4.size() == 1);
  Assert.assertTrue(optCh4.get(0).getName().equals("ch2"));
  List<Channel> allChannels=selector.getAllChannels();
  Assert.assertTrue(allChannels.size() == 3);
  Assert.assertTrue(allChannels.get(0).getName().equals("ch1"));
  Assert.assertTrue(allChannels.get(1).getName().equals("ch2"));
  Assert.assertTrue(allChannels.get(2).getName().equals("ch3"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMandatory(){
  config.put("default","ch3");
  config.put("optional.foo","ch1 ch2");
  config.put("optional.zebra","ch2 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(1,reqCh1.size());
  Assert.assertEquals("ch3",reqCh1.get(0).getName());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertEquals(2,optCh1.size());
  Assert.assertEquals("ch1",optCh1.get(0).getName());
  Assert.assertEquals("ch2",optCh1.get(1).getName());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertEquals(1,reqCh4.size());
  Assert.assertTrue(reqCh4.get(0).getName().equals("ch3"));
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(1,optCh4.size());
  Assert.assertEquals("ch2",optCh4.get(0).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoDefault(){
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("mapping.zebra","ch2");
  config.put("optional.zebra","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertEquals("ch1",reqCh1.get(0).getName());
  Assert.assertEquals("ch2",reqCh1.get(1).getName());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertTrue(optCh1.size() == 1);
  Assert.assertEquals("ch3",optCh1.get(0).getName());
  Event event2=new MockEvent();
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("myheader","bar");
  event2.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(event2);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertEquals("ch2",reqCh2.get(0).getName());
  Assert.assertEquals("ch3",reqCh2.get(1).getName());
  List<Channel> optCh2=selector.getOptionalChannels(event2);
  Assert.assertTrue(optCh2.isEmpty());
  Event event3=new MockEvent();
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","xyz");
  event3.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(event3);
  Assert.assertEquals(3,reqCh3.size());
  Assert.assertEquals("ch1",reqCh3.get(0).getName());
  Assert.assertEquals("ch2",reqCh3.get(1).getName());
  Assert.assertEquals("ch3",reqCh3.get(2).getName());
  List<Channel> optCh3=selector.getOptionalChannels(event3);
  Assert.assertTrue(optCh3.isEmpty());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertEquals(1,reqCh4.size());
  Assert.assertEquals("ch2",reqCh4.get(0).getName());
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(2,optCh4.size());
  Assert.assertEquals("ch1",optCh4.get(0).getName());
  Assert.assertEquals("ch3",optCh4.get(1).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnlyOptional(){
  config.put("optional.foo","ch1 ch2");
  config.put("optional.zebra","ch2 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertTrue(reqCh1.isEmpty());
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertEquals(2,optCh1.size());
  Event event4=new MockEvent();
  Map<String,String> header4=new HashMap<String,String>();
  header4.put("myheader","zebra");
  event4.setHeaders(header4);
  List<Channel> reqCh4=selector.getRequiredChannels(event4);
  Assert.assertTrue(reqCh4.isEmpty());
  List<Channel> optCh4=selector.getOptionalChannels(event4);
  Assert.assertEquals(2,optCh4.size());
  Assert.assertEquals("ch2",optCh4.get(0).getName());
  Assert.assertEquals("ch3",optCh4.get(1).getName());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSelection() throws Exception {
  config.put("mapping.foo","ch1 ch2");
  config.put("mapping.bar","ch2 ch3");
  config.put("mapping.xyz","ch1 ch2 ch3");
  config.put("default","ch1 ch3");
  selector=ChannelSelectorFactory.create(channels,config);
  Assert.assertTrue(selector instanceof MultiplexingChannelSelector);
  Event event1=new MockEvent();
  Map<String,String> header1=new HashMap<String,String>();
  header1.put("myheader","foo");
  event1.setHeaders(header1);
  List<Channel> reqCh1=selector.getRequiredChannels(event1);
  Assert.assertEquals(2,reqCh1.size());
  Assert.assertTrue(reqCh1.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh1.get(1).getName().equals("ch2"));
  List<Channel> optCh1=selector.getOptionalChannels(event1);
  Assert.assertTrue(optCh1.size() == 1);
  Assert.assertTrue(optCh1.get(0).getName().equals("ch3"));
  Event event2=new MockEvent();
  Map<String,String> header2=new HashMap<String,String>();
  header2.put("myheader","bar");
  event2.setHeaders(header2);
  List<Channel> reqCh2=selector.getRequiredChannels(event2);
  Assert.assertEquals(2,reqCh2.size());
  Assert.assertTrue(reqCh2.get(0).getName().equals("ch2"));
  Assert.assertTrue(reqCh2.get(1).getName().equals("ch3"));
  List<Channel> optCh2=selector.getOptionalChannels(event2);
  Assert.assertTrue(optCh2.isEmpty());
  Event event3=new MockEvent();
  Map<String,String> header3=new HashMap<String,String>();
  header3.put("myheader","xyz");
  event3.setHeaders(header3);
  List<Channel> reqCh3=selector.getRequiredChannels(event3);
  Assert.assertEquals(3,reqCh3.size());
  Assert.assertTrue(reqCh3.get(0).getName().equals("ch1"));
  Assert.assertTrue(reqCh3.get(1).getName().equals("ch2"));
  Assert.assertTrue(reqCh3.get(2).getName().equals("ch3"));
  List<Channel> optCh3=selector.getOptionalChannels(event3);
  Assert.assertTrue(optCh3.size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.TestSpillableMemoryChannel </h4><pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testReconfigure(){
  Map<String,String> params=new HashMap<String,String>();
  params.put("memoryCapacity","10");
  params.put("overflowCapacity","0");
  params.put("overflowTimeout","0");
  startChannel(params);
  Assert.assertTrue("overflowTimeout setting did not reconfigure correctly",channel.getOverflowTimeout() == 0);
  Assert.assertTrue("memoryCapacity did not reconfigure correctly",channel.getMemoryCapacity() == 10);
  Assert.assertTrue("overflowCapacity did not reconfigure correctly",channel.isOverflowDisabled());
  transactionalPutN(1,10,channel);
  boolean threw=false;
  try {
    transactionalPutN(11,10,channel);
  }
 catch (  ChannelException e) {
    threw=true;
  }
  Assert.assertTrue("Expected the channel to fill up and throw an exception, " + "but it did not throw",threw);
  params=new HashMap<String,String>();
  params.put("memoryCapacity","20");
  params.put("overflowCapacity","0");
  reconfigureChannel(params);
  Assert.assertTrue("overflowTimeout setting did not reconfigure correctly",channel.getOverflowTimeout() == SpillableMemoryChannel.defaultOverflowTimeout);
  Assert.assertTrue("memoryCapacity did not reconfigure correctly",channel.getMemoryCapacity() == 20);
  Assert.assertTrue("overflowCapacity did not reconfigure correctly",channel.isOverflowDisabled());
  transactionalTakeN(1,10,channel);
  transactionalPutN(11,10,channel);
  transactionalPutN(21,10,channel);
  threw=false;
  try {
    transactionalPutN(31,10,channel);
  }
 catch (  ChannelException e) {
    threw=true;
  }
  Assert.assertTrue("Expected the channel to fill up and throw an exception, " + "but it did not throw",threw);
  transactionalTakeN(11,10,channel);
  transactionalTakeN(21,10,channel);
  params=new HashMap<String,String>();
  reconfigureChannel(params);
  Assert.assertTrue("overflowTimeout setting did not reconfigure correctly",channel.getOverflowTimeout() == SpillableMemoryChannel.defaultOverflowTimeout);
  Assert.assertTrue("memoryCapacity did not reconfigure correctly",channel.getMemoryCapacity() == SpillableMemoryChannel.defaultMemoryCapacity);
  Assert.assertTrue("overflowCapacity did not reconfigure correctly",channel.getOverflowCapacity() == SpillableMemoryChannel.defaultOverflowCapacity);
  Assert.assertFalse("overflowCapacity did not reconfigure correctly",channel.isOverflowDisabled());
  params=new HashMap<String,String>();
  params.put("memoryCapacity","10");
  params.put("overflowCapacity","10");
  params.put("transactionCapacity","5");
  params.put("overflowTimeout","1");
  reconfigureChannel(params);
  transactionalPutN(1,5,channel);
  transactionalPutN(6,5,channel);
  transactionalPutN(11,5,channel);
  transactionalPutN(16,5,channel);
  threw=false;
  try {
    transactionalPutN(21,5,channel);
  }
 catch (  ChannelException e) {
    threw=true;
  }
  Assert.assertTrue("Expected the last insertion to fail, but it didn't.",threw);
  params=new HashMap<String,String>();
  params.put("memoryCapacity","10");
  params.put("overflowCapacity","20");
  params.put("transactionCapacity","10");
  params.put("overflowTimeout","1");
  reconfigureChannel(params);
  transactionalPutN(21,5,channel);
  transactionalTakeN(1,10,channel);
  transactionalTakeN(11,5,channel);
  transactionalTakeN(16,5,channel);
  transactionalTakeN(21,5,channel);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testByteCapacity(){
  Map<String,String> params=new HashMap<String,String>();
  params.put("memoryCapacity","1000");
  params.put("byteCapacity","100");
  params.put("avgEventSize","10");
  params.put("overflowCapacity","20");
  params.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"10");
  params.put("overflowTimeout","1");
  startChannel(params);
  transactionalPutN(1,8,channel);
  transactionalPutN(9,10,channel);
  transactionalPutN(19,10,channel);
  boolean threw=false;
  try {
    transactionalPutN(11,1,channel);
  }
 catch (  ChannelFullException e) {
    threw=true;
  }
  Assert.assertTrue("byteCapacity did not throw as expected",threw);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCapacityWithOverflow(){
  Map<String,String> params=new HashMap<String,String>();
  params.put("memoryCapacity","2");
  params.put("overflowCapacity","4");
  params.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"3");
  params.put("overflowTimeout","0");
  startChannel(params);
  transactionalPutN(1,2,channel);
  transactionalPutN(3,2,channel);
  transactionalPutN(5,2,channel);
  boolean threw=false;
  try {
    transactionalPutN(7,2,channel);
  }
 catch (  ChannelFullException e) {
    threw=true;
  }
  Assert.assertTrue("Expecting ChannelFullException to be thrown",threw);
  transactionalTakeN(1,2,channel);
  transactionalTakeN(3,2,channel);
  transactionalTakeN(5,2,channel);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCounters() throws InterruptedException {
  Map<String,String> params=new HashMap<String,String>();
  params.put("memoryCapacity","5000");
  params.put("overflowCapacity","5000");
  params.put("transactionCapacity","5000");
  params.put("overflowTimeout","0");
  startChannel(params);
  Thread sourceThd=makePutThread("src",1,5000,2500,channel);
  sourceThd.start();
  sourceThd.join();
  Assert.assertEquals(5000,channel.getTotalStored());
  Assert.assertEquals(5000,channel.channelCounter.getChannelSize());
  Assert.assertEquals(5000,channel.channelCounter.getEventPutAttemptCount());
  Assert.assertEquals(5000,channel.channelCounter.getEventPutSuccessCount());
  Thread sinkThd=makeTakeThread("sink",1,5000,1000,channel);
  sinkThd.start();
  sinkThd.join();
  Assert.assertEquals(0,channel.getTotalStored());
  Assert.assertEquals(0,channel.channelCounter.getChannelSize());
  Assert.assertEquals(5000,channel.channelCounter.getEventTakeAttemptCount());
  Assert.assertEquals(5000,channel.channelCounter.getEventTakeSuccessCount());
  sourceThd=makePutThread("src",1,10000,1000,channel);
  sourceThd.start();
  sourceThd.join();
  Assert.assertEquals(10000,channel.getTotalStored());
  Assert.assertEquals(10000,channel.channelCounter.getChannelSize());
  Assert.assertEquals(15000,channel.channelCounter.getEventPutAttemptCount());
  Assert.assertEquals(15000,channel.channelCounter.getEventPutSuccessCount());
  sinkThd=makeTakeThread("sink",1,5000,1000,channel);
  sinkThd.start();
  sinkThd.join();
  Assert.assertEquals(5000,channel.getTotalStored());
  Assert.assertEquals(5000,channel.channelCounter.getChannelSize());
  Assert.assertEquals(10000,channel.channelCounter.getEventTakeAttemptCount());
  Assert.assertEquals(10000,channel.channelCounter.getEventTakeSuccessCount());
  transactionalTakeN(5001,1000,channel);
  transactionalTakeN(6001,1000,channel);
  transactionalTakeN(7001,1000,channel);
  transactionalTakeN(8001,1000,channel);
  transactionalTakeN(9001,1000,channel);
  Assert.assertEquals(0,channel.getTotalStored());
  Assert.assertEquals(0,channel.channelCounter.getChannelSize());
  Assert.assertEquals(15000,channel.channelCounter.getEventTakeAttemptCount());
  Assert.assertEquals(15000,channel.channelCounter.getEventTakeSuccessCount());
  sourceThd=makePutThread("src1",1,5000,1000,channel);
  Thread sourceThd2=makePutThread("src2",1,5000,500,channel);
  sinkThd=makeTakeThread_noCheck("sink1",5000,1000,channel);
  sourceThd.start();
  sourceThd2.start();
  sinkThd.start();
  sourceThd.join();
  sourceThd2.join();
  sinkThd.join();
  Assert.assertEquals(5000,channel.getTotalStored());
  Assert.assertEquals(5000,channel.channelCounter.getChannelSize());
  Thread sinkThd2=makeTakeThread_noCheck("sink2",2500,500,channel);
  Thread sinkThd3=makeTakeThread_noCheck("sink3",2500,1000,channel);
  sinkThd2.start();
  sinkThd3.start();
  sinkThd2.join();
  sinkThd3.join();
  Assert.assertEquals(0,channel.getTotalStored());
  Assert.assertEquals(0,channel.channelCounter.getChannelSize());
  Assert.assertEquals(25000,channel.channelCounter.getEventTakeSuccessCount());
  Assert.assertEquals(25000,channel.channelCounter.getEventPutSuccessCount());
  Assert.assertTrue("TakeAttempt channel counter value larger than expected",25000 <= channel.channelCounter.getEventTakeAttemptCount());
  Assert.assertTrue("PutAttempt channel counter value larger than expected",25000 <= channel.channelCounter.getEventPutAttemptCount());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCapacityDisableOverflow(){
  Map<String,String> params=new HashMap<String,String>();
  params.put("memoryCapacity","2");
  params.put("overflowCapacity","0");
  params.put("overflowTimeout","0");
  startChannel(params);
  transactionalPutN(0,2,channel);
  boolean threw=false;
  try {
    transactionalPutN(2,1,channel);
  }
 catch (  ChannelException e) {
    threw=true;
  }
  Assert.assertTrue("Expecting ChannelFullException to be thrown",threw);
  transactionalTakeN(0,2,channel);
  Transaction tx=channel.getTransaction();
  tx.begin();
  Assert.assertNull(channel.take());
  tx.commit();
  tx.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestCheckpoint </h4><pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws IOException {
  file=File.createTempFile("Checkpoint","");
  inflightPuts=File.createTempFile("inflightPuts","");
  inflightTakes=File.createTempFile("inflightTakes","");
  queueSet=File.createTempFile("queueset","");
  Assert.assertTrue(file.isFile());
  Assert.assertTrue(file.canWrite());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialization() throws Exception {
  EventQueueBackingStore backingStore=new EventQueueBackingStoreFileV2(file,1,"test");
  FlumeEventPointer ptrIn=new FlumeEventPointer(10,20);
  FlumeEventQueue queueIn=new FlumeEventQueue(backingStore,inflightTakes,inflightPuts,queueSet);
  queueIn.addHead(ptrIn);
  FlumeEventQueue queueOut=new FlumeEventQueue(backingStore,inflightTakes,inflightPuts,queueSet);
  Assert.assertEquals(0,queueOut.getLogWriteOrderID());
  queueIn.checkpoint(false);
  FlumeEventQueue queueOut2=new FlumeEventQueue(backingStore,inflightTakes,inflightPuts,queueSet);
  FlumeEventPointer ptrOut=queueOut2.removeHead(0L);
  Assert.assertEquals(ptrIn,ptrOut);
  Assert.assertTrue(queueOut2.getLogWriteOrderID() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestCheckpointRebuilder </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFastReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(50));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(50));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"checkpointBulder");
  channel.stop();
  File checkpointFile=new File(checkpointDir,"checkpoint");
  File metaDataFile=Serialization.getMetaDataFile(checkpointFile);
  File inflightTakesFile=new File(checkpointDir,"inflighttakes");
  File inflightPutsFile=new File(checkpointDir,"inflightputs");
  File queueSetDir=new File(checkpointDir,"queueset");
  Assert.assertTrue(checkpointFile.delete());
  Assert.assertTrue(metaDataFile.delete());
  Assert.assertTrue(inflightTakesFile.delete());
  Assert.assertTrue(inflightPutsFile.delete());
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpointFile,50,"test");
  FlumeEventQueue queue=new FlumeEventQueue(backingStore,inflightTakesFile,inflightPutsFile,queueSetDir);
  CheckpointRebuilder checkpointRebuilder=new CheckpointRebuilder(getAllLogs(dataDirs),queue,true);
  Assert.assertTrue(checkpointRebuilder.rebuild());
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestEventQueueBackingStoreFactory </h4><pre class="type-11 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testDecreaseCapacity() throws Exception {
  Assert.assertTrue(checkpoint.delete());
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  EventQueueBackingStoreFactory.get(checkpoint,9,"test");
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCheckpointVersionNotEqualToMeta2() throws Exception {
  FileOutputStream os=null;
  try {
    EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
    backingStore.close();
    Assert.assertTrue(checkpoint.exists());
    Assert.assertTrue(Serialization.getMetaDataFile(checkpoint).length() != 0);
    FileInputStream is=new FileInputStream(Serialization.getMetaDataFile(checkpoint));
    ProtosFactory.Checkpoint meta=ProtosFactory.Checkpoint.parseDelimitedFrom(is);
    Assert.assertNotNull(meta);
    is.close();
    os=new FileOutputStream(Serialization.getMetaDataFile(checkpoint));
    meta.toBuilder().setVersion(2).build().writeDelimitedTo(os);
    os.flush();
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
  finally {
    os.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InvalidProtocolBufferException.class) public void testCorruptMeta() throws Throwable {
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  Assert.assertTrue(checkpoint.exists());
  File metaFile=Serialization.getMetaDataFile(checkpoint);
  Assert.assertTrue(metaFile.length() != 0);
  RandomAccessFile writer=new RandomAccessFile(metaFile,"rw");
  writer.seek(10);
  writer.writeLong(new Random().nextLong());
  writer.getFD().sync();
  writer.close();
  try {
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
 catch (  BadCheckpointException ex) {
    throw ex.getCause();
  }
}

</code></pre>

<br>
<pre class="type-11 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testIncreaseCapacity() throws Exception {
  Assert.assertTrue(checkpoint.delete());
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  EventQueueBackingStoreFactory.get(checkpoint,11,"test");
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCheckpointOrderIdNotEqualToMeta2() throws Exception {
  FileOutputStream os=null;
  try {
    EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
    backingStore.close();
    Assert.assertTrue(checkpoint.exists());
    Assert.assertTrue(Serialization.getMetaDataFile(checkpoint).length() != 0);
    FileInputStream is=new FileInputStream(Serialization.getMetaDataFile(checkpoint));
    ProtosFactory.Checkpoint meta=ProtosFactory.Checkpoint.parseDelimitedFrom(is);
    Assert.assertNotNull(meta);
    is.close();
    os=new FileOutputStream(Serialization.getMetaDataFile(checkpoint));
    meta.toBuilder().setWriteOrderID(1).build().writeDelimitedTo(os);
    os.flush();
    backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  }
  finally {
    os.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testTruncateMeta() throws Exception {
  EventQueueBackingStore backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
  backingStore.close();
  Assert.assertTrue(checkpoint.exists());
  File metaFile=Serialization.getMetaDataFile(checkpoint);
  Assert.assertTrue(metaFile.length() != 0);
  RandomAccessFile writer=new RandomAccessFile(metaFile,"rw");
  writer.setLength(0);
  writer.getFD().sync();
  writer.close();
  backingStore=EventQueueBackingStoreFactory.get(checkpoint,10,"test");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testNewCheckpoint() throws Exception {
  Assert.assertTrue(checkpoint.delete());
  verify(EventQueueBackingStoreFactory.get(checkpoint,10,"test",false),Serialization.VERSION_3,Collections.<Long>emptyList());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannel </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReconfigure() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=Sets.newHashSet();
  try {
    while (true) {
      in.addAll(putEvents(channel,"reconfig",1,1));
    }
  }
 catch (  ChannelException e) {
    Assert.assertEquals("The channel has reached it's capacity. " + "This might be the result of a sink on the channel having too " + "low of batch size, a downstream system running slower than "+ "normal, or that the channel capacity is just too low. [channel=" + channel.getName() + "]",e.getMessage());
  }
  Configurables.configure(channel,createContext());
  Set<String> out=takeEvents(channel,1,Integer.MAX_VALUE);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testNegativeCapacities(){
  Map<String,String> parms=Maps.newHashMap();
  parms.put(FileChannelConfiguration.CAPACITY,"-3");
  parms.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"-1");
  parms.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"-2");
  FileChannel channel=createFileChannel(parms);
  Assert.assertTrue(field("capacity").ofType(Integer.class).in(channel).get() > 0);
  Assert.assertTrue(field("transactionCapacity").ofType(Integer.class).in(channel).get() > 0);
  Assert.assertTrue(field("checkpointInterval").ofType(Long.class).in(channel).get() > 0);
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPut() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  int found=takeEvents(channel,1,5).size();
  Assert.assertEquals(0,found);
  Set<String> expected=Sets.newHashSet();
  expected.addAll(putEvents(channel,"unbatched",1,5));
  expected.addAll(putEvents(channel,"batched",5,5));
  Set<String> actual=takeEvents(channel,1);
  compareInputAndOut(expected,actual);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPutCheckpointCommitCheckpointReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"10000");
  FileChannel channel=createFileChannel(overrides);
  channel.start();
  Transaction tx=channel.getTransaction();
  Set<String> in=putWithoutCommit(channel,tx,"doubleCheckpoint",1);
  forceCheckpoint(channel);
  tx.commit();
  tx.close();
  forceCheckpoint(channel);
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,5);
  compareInputAndOut(in,out);
  channel.stop();
}

</code></pre>

<br>
<pre class="type-10 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCapacity() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(5));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(5));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  fillChannel(channel,"fillup");
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  Event event=channel.take();
  Assert.assertNotNull(event);
  transaction.rollback();
  transaction.close();
  Assert.assertEquals(0,fillChannel(channel,"capacity").size());
  Assert.assertEquals(5,takeEvents(channel,1,5).size());
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLocking() throws IOException {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  FileChannel fileChannel=createFileChannel();
  fileChannel.start();
  Assert.assertTrue(!fileChannel.isOpen());
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreaded() throws IOException, InterruptedException {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  int numThreads=10;
  final CountDownLatch producerStopLatch=new CountDownLatch(numThreads);
  final CountDownLatch consumerStopLatch=new CountDownLatch(numThreads);
  final List<Exception> errors=Collections.synchronizedList(new ArrayList<Exception>());
  final Set<String> expected=Collections.synchronizedSet(new HashSet<String>());
  final Set<String> actual=Collections.synchronizedSet(new HashSet<String>());
  for (int i=0; i < numThreads; i++) {
    final int id=i;
    Thread t=new Thread(){
      @Override public void run(){
        try {
          if (id % 2 == 0) {
            expected.addAll(putEvents(channel,Integer.toString(id),1,5));
          }
 else {
            expected.addAll(putEvents(channel,Integer.toString(id),5,5));
          }
          LOG.info("Completed some puts " + expected.size());
        }
 catch (        Exception e) {
          LOG.error("Error doing puts",e);
          errors.add(e);
        }
 finally {
          producerStopLatch.countDown();
        }
      }
    }
;
    t.setDaemon(true);
    t.start();
  }
  for (int i=0; i < numThreads; i++) {
    final int id=i;
    Thread t=new Thread(){
      @Override public void run(){
        try {
          while (!producerStopLatch.await(1,TimeUnit.SECONDS) || expected.size() > actual.size()) {
            if (id % 2 == 0) {
              actual.addAll(takeEvents(channel,1,Integer.MAX_VALUE));
            }
 else {
              actual.addAll(takeEvents(channel,5,Integer.MAX_VALUE));
            }
          }
          if (actual.isEmpty()) {
            LOG.error("Found nothing!");
          }
 else {
            LOG.info("Completed some takes " + actual.size());
          }
        }
 catch (        Exception e) {
          LOG.error("Error doing takes",e);
          errors.add(e);
        }
 finally {
          consumerStopLatch.countDown();
        }
      }
    }
;
    t.setDaemon(true);
    t.start();
  }
  Assert.assertTrue("Timed out waiting for producers",producerStopLatch.await(30,TimeUnit.SECONDS));
  Assert.assertTrue("Timed out waiting for consumer",consumerStopLatch.await(30,TimeUnit.SECONDS));
  Assert.assertEquals(Collections.EMPTY_LIST,errors);
  compareInputAndOut(expected,actual);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPutForceCheckpointCommitReplay() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(2));
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"10000");
  FileChannel channel=createFileChannel(overrides);
  channel.start();
  Transaction tx=channel.getTransaction();
  Set<String> in=putWithoutCommit(channel,tx,"putWithoutCommit",1);
  forceCheckpoint(channel);
  tx.commit();
  tx.close();
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,1);
  compareInputAndOut(in,out);
  channel.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is here to make sure we can replay a full queue
 * when we have a PUT with a lower txid than the take which
 * made that PUT possible. Here we fill up the queue so
 * puts will block. Start the put (which assigns a txid)
 * and while it's blocking initiate a take. That will
 * allow the PUT to take place but at a lower txid
 * than the take and additionally with pre-FLUME-1432 with
 * the same timestamp. After FLUME-1432 the PUT will have a
 * lower txid but a higher write order id and we can see
 * which event occurred first.
 */
@Test public void testRaceFoundInFLUME1432() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.KEEP_ALIVE,String.valueOf(10L));
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(10));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(10));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  fillChannel(channel,"fillup");
  Future<String> put=Executors.newSingleThreadExecutor().submit(new Callable<String>(){
    @Override public String call() throws Exception {
      Set<String> result=putEvents(channel,"blocked-put",1,1);
      Assert.assertTrue(result.toString(),result.size() == 1);
      Iterator<String> iter=result.iterator();
      return iter.next();
    }
  }
);
  Thread.sleep(1000L);
  Set<String> result=takeEvents(channel,1,1);
  Assert.assertTrue(result.toString(),result.size() == 1);
  String putmsg=put.get();
  Assert.assertNotNull(putmsg);
  String takemsg=result.iterator().next();
  Assert.assertNotNull(takemsg);
  LOG.info("Got: put " + putmsg + ", take "+ takemsg);
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitAfterNoPutTake() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  transaction.commit();
  transaction.close();
  channel.stop();
  channel=createFileChannel();
  channel.start();
  Assert.assertTrue(channel.isOpen());
  transaction=channel.getTransaction();
  transaction.begin();
  Assert.assertNull(channel.take());
  transaction.commit();
  transaction.close();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRollbackIncompleteTransaction() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,String.valueOf(Integer.MAX_VALUE));
  final FileChannel channel=createFileChannel(overrides);
  channel.start();
  FileBackedTransaction tx=(FileBackedTransaction)channel.getTransaction();
  InflightEventWrapper inflightPuts=field("inflightPuts").ofType(InflightEventWrapper.class).in(field("queue").ofType(FlumeEventQueue.class).in(tx).get()).get();
  tx.begin();
  for (int i=0; i < 100; i++) {
    channel.put(EventBuilder.withBody("TestEvent".getBytes()));
  }
  Assert.assertFalse(inflightPuts.getFileIDs().isEmpty());
  Assert.assertFalse(inflightPuts.getInFlightPointers().isEmpty());
  tx.rollback();
  tx.close();
  Assert.assertTrue(inflightPuts.getFileIDs().isEmpty());
  Assert.assertTrue(inflightPuts.getInFlightPointers().isEmpty());
  Assert.assertTrue(channel.getDepth() == 0);
  Set<String> in=putEvents(channel,"testing-rollbacks",100,100);
  tx=(FileBackedTransaction)channel.getTransaction();
  InflightEventWrapper inflightTakes=field("inflightTakes").ofType(InflightEventWrapper.class).in(field("queue").ofType(FlumeEventQueue.class).in(tx).get()).get();
  tx.begin();
  for (int i=0; i < 100; i++) {
    channel.take();
  }
  Assert.assertFalse(inflightTakes.getFileIDs().isEmpty());
  Assert.assertFalse(inflightTakes.getInFlightPointers().isEmpty());
  tx.rollback();
  tx.close();
  Assert.assertTrue(inflightTakes.getFileIDs().isEmpty());
  Assert.assertTrue(inflightTakes.getInFlightPointers().isEmpty());
  Assert.assertTrue(channel.getDepth() == in.size());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test contributed by Brock Noland during code review.
 * @throws Exception
 */
@Test public void testTakeTransactionCrossingCheckpoint() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"10000");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"restart");
  Set<String> out=Sets.newHashSet();
  Transaction tx=channel.getTransaction();
  out.addAll(takeWithoutCommit(channel,tx,1));
  forceCheckpoint(channel);
  tx.commit();
  tx.close();
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out2=takeEvents(channel,1,Integer.MAX_VALUE);
  channel.stop();
  in.removeAll(out);
  compareInputAndOut(in,out2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelBase </h4><pre class="type-12 type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  baseDir=Files.createTempDir();
  checkpointDir=new File(baseDir,"chkpt");
  backupDir=new File(baseDir,"backup");
  uncompressedBackupCheckpoint=new File(backupDir,"checkpoint");
  compressedBackupCheckpoint=new File(backupDir,"checkpoint.snappy");
  Assert.assertTrue(checkpointDir.mkdirs() || checkpointDir.isDirectory());
  Assert.assertTrue(backupDir.mkdirs() || backupDir.isDirectory());
  dataDirs=new File[3];
  dataDir="";
  for (int i=0; i < dataDirs.length; i++) {
    dataDirs[i]=new File(baseDir,"data" + (i + 1));
    Assert.assertTrue(dataDirs[i].mkdirs() || dataDirs[i].isDirectory());
    dataDir+=dataDirs[i].getAbsolutePath() + ",";
  }
  dataDir=dataDir.substring(0,dataDir.length() - 1);
  channel=createFileChannel();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelFormatRegression </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * This is regression test with files generated by a file channel
 * with the FLUME-1432 patch.
 */
@Test public void testFileFormatV2postFLUME1432() throws Exception {
  TestUtils.copyDecompressed("fileformat-v2-checkpoint.gz",new File(checkpointDir,"checkpoint"));
  for (int i=0; i < dataDirs.length; i++) {
    int fileIndex=i + 1;
    TestUtils.copyDecompressed("fileformat-v2-log-" + fileIndex + ".gz",new File(dataDirs[i],"log-" + fileIndex));
  }
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(10));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(10));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> events=takeEvents(channel,1);
  Set<String> expected=new HashSet<String>();
  expected.addAll(Arrays.asList((new String[]{"2684","2685","2686","2687","2688","2689","2690","2691"})));
  compareInputAndOut(expected,events);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelRestart </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptCheckpointVersionMostSignificant4Bytes() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=putEvents(channel,"restart",10,100);
  Assert.assertEquals(100,in.size());
  forceCheckpoint(channel);
  channel.stop();
  File checkpoint=new File(checkpointDir,"checkpoint");
  RandomAccessFile writer=new RandomAccessFile(checkpoint,"rw");
  writer.seek(EventQueueBackingStoreFile.INDEX_VERSION * Serialization.SIZE_OF_LONG);
  writer.write(new byte[]{(byte)1,(byte)5});
  writer.getFD().sync();
  writer.close();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  Assert.assertTrue(channel.didFullReplayDueToBadCheckpointException());
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWithExtraLogs() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.CAPACITY,"10");
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,"10");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"extralogs");
  for (int i=0; i < dataDirs.length; i++) {
    File file=new File(dataDirs[i],Log.PREFIX + (1000 + i));
    Assert.assertTrue(file.createNewFile());
    Assert.assertTrue(file.length() == 0);
    File metaDataFile=Serialization.getMetaDataFile(file);
    File metaDataTempFile=Serialization.getMetaDataTempFile(metaDataFile);
    Assert.assertTrue(metaDataTempFile.createNewFile());
  }
  channel.stop();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testDataFilesRequiredByBackupNotDeleted() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.USE_DUAL_CHECKPOINTS,"true");
  overrides.put(FileChannelConfiguration.MAX_FILE_SIZE,"1000");
  channel=createFileChannel(overrides);
  channel.start();
  String prefix="abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz";
  Assert.assertTrue(channel.isOpen());
  putEvents(channel,prefix,10,100);
  Set<String> origFiles=Sets.newHashSet();
  for (  File dir : dataDirs) {
    origFiles.addAll(Lists.newArrayList(dir.list()));
  }
  forceCheckpoint(channel);
  takeEvents(channel,10,50);
  long beforeSecondCheckpoint=System.currentTimeMillis();
  forceCheckpoint(channel);
  Set<String> newFiles=Sets.newHashSet();
  int olderThanCheckpoint=0;
  int totalMetaFiles=0;
  for (  File dir : dataDirs) {
    File[] metadataFiles=dir.listFiles(new FilenameFilter(){
      @Override public boolean accept(      File dir,      String name){
        if (name.endsWith(".meta")) {
          return true;
        }
        return false;
      }
    }
);
    totalMetaFiles=metadataFiles.length;
    for (    File metadataFile : metadataFiles) {
      if (metadataFile.lastModified() < beforeSecondCheckpoint) {
        olderThanCheckpoint++;
      }
    }
    newFiles.addAll(Lists.newArrayList(dir.list()));
  }
  Assert.assertTrue(olderThanCheckpoint > 0);
  Assert.assertTrue(totalMetaFiles != olderThanCheckpoint);
  Assert.assertTrue(newFiles.containsAll(origFiles));
  takeEvents(channel,10,50);
  forceCheckpoint(channel);
  newFiles=Sets.newHashSet();
  for (  File dir : dataDirs) {
    newFiles.addAll(Lists.newArrayList(dir.list()));
  }
  Assert.assertTrue(!newFiles.containsAll(origFiles));
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptCheckpointCompleteMarkerMostSignificant4Bytes() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=putEvents(channel,"restart",10,100);
  Assert.assertEquals(100,in.size());
  forceCheckpoint(channel);
  channel.stop();
  File checkpoint=new File(checkpointDir,"checkpoint");
  RandomAccessFile writer=new RandomAccessFile(checkpoint,"rw");
  writer.seek(EventQueueBackingStoreFile.INDEX_CHECKPOINT_MARKER * Serialization.SIZE_OF_LONG);
  writer.write(new byte[]{(byte)1,(byte)5});
  writer.getFD().sync();
  writer.close();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  Assert.assertTrue(channel.didFullReplayDueToBadCheckpointException());
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-10 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IOException.class) public void testSlowBackup() throws Throwable {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.USE_DUAL_CHECKPOINTS,"true");
  overrides.put(FileChannelConfiguration.MAX_FILE_SIZE,"1000");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=putEvents(channel,"restart",10,100);
  Assert.assertEquals(100,in.size());
  slowdownBackup(channel);
  forceCheckpoint(channel);
  in=putEvents(channel,"restart",10,100);
  takeEvents(channel,10,100);
  Assert.assertEquals(100,in.size());
  try {
    forceCheckpoint(channel);
  }
 catch (  ReflectionError ex) {
    throw ex.getCause();
  }
 finally {
    channel.stop();
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCompressBackup() throws Throwable {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put(FileChannelConfiguration.USE_DUAL_CHECKPOINTS,"true");
  overrides.put(FileChannelConfiguration.MAX_FILE_SIZE,"1000");
  overrides.put(FileChannelConfiguration.COMPRESS_BACKUP_CHECKPOINT,"true");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  putEvents(channel,"restart",10,100);
  forceCheckpoint(channel);
  Thread.sleep(2000);
  Assert.assertTrue(compressedBackupCheckpoint.exists());
  Serialization.decompressFile(compressedBackupCheckpoint,uncompressedBackupCheckpoint);
  File checkpoint=new File(checkpointDir,"checkpoint");
  Assert.assertTrue(FileUtils.contentEquals(checkpoint,uncompressedBackupCheckpoint));
  channel.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFileChannelRollback </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollbackSimulatedCrashWithSink() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  int numEvents=100;
  LoggerSink sink=new LoggerSink();
  sink.setChannel(channel);
  CountingSinkRunner runner=new CountingSinkRunner(sink,numEvents - 1);
  runner.start();
  putEvents(channel,"rollback",10,numEvents);
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  byte[] bytes="rolled back".getBytes(Charsets.UTF_8);
  channel.put(EventBuilder.withBody(bytes));
  transaction.rollback();
  transaction.close();
  while (runner.isAlive()) {
    Thread.sleep(10L);
  }
  Assert.assertEquals(numEvents - 1,runner.getCount());
  for (  Exception ex : runner.getErrors()) {
    LOG.warn("Sink had error",ex);
  }
  Assert.assertEquals(Collections.EMPTY_LIST,runner.getErrors());
  channel.stop();
  channel=createFileChannel();
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,1,1);
  Assert.assertEquals(1,out.size());
  String s=out.iterator().next();
  Assert.assertTrue(s,s.startsWith("rollback-90-9"));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollbackAfterNoPutTake() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  transaction.rollback();
  transaction.close();
  channel.stop();
  channel=createFileChannel();
  channel.start();
  Assert.assertTrue(channel.isOpen());
  transaction=channel.getTransaction();
  transaction.begin();
  Assert.assertNull(channel.take());
  transaction.commit();
  transaction.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRollbackSimulatedCrash() throws Exception {
  channel.start();
  Assert.assertTrue(channel.isOpen());
  int numEvents=50;
  Set<String> in=putEvents(channel,"rollback",1,numEvents);
  Transaction transaction;
  transaction=channel.getTransaction();
  transaction.begin();
  channel.put(EventBuilder.withBody("rolled back".getBytes(Charsets.UTF_8)));
  transaction.rollback();
  transaction.close();
  channel.stop();
  channel=createFileChannel();
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=takeEvents(channel,1,numEvents);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFlumeEvent </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasics(){
  Map<String,String> headers=Maps.newHashMap();
  headers.put("key","value");
  byte[] body="flume".getBytes(Charsets.UTF_8);
  FlumeEvent event=new FlumeEvent(headers,body);
  Assert.assertEquals(headers,event.getHeaders());
  Assert.assertTrue(Arrays.equals(body,event.getBody()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialization() throws IOException {
  Map<String,String> headers=Maps.newHashMap();
  headers.put("key","value");
  byte[] body="flume".getBytes(Charsets.UTF_8);
  FlumeEvent in=new FlumeEvent(headers,body);
  FlumeEvent out=FlumeEvent.from(TestUtils.toDataInput(in));
  Assert.assertEquals(headers,out.getHeaders());
  Assert.assertTrue(Arrays.equals(body,out.getBody()));
  in.setHeaders(null);
  in.setBody(null);
  out=FlumeEvent.from(TestUtils.toDataInput(in));
  Assert.assertEquals(Maps.newHashMap(),out.getHeaders());
  Assert.assertNull(out.getBody());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFlumeEventPointer </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  FlumeEventPointer pointerA=new FlumeEventPointer(1,1);
  FlumeEventPointer pointerB=new FlumeEventPointer(1,1);
  Assert.assertEquals(pointerA,pointerB);
  Assert.assertEquals(pointerB,pointerA);
  pointerA=new FlumeEventPointer(1,1);
  pointerB=new FlumeEventPointer(2,2);
  Assert.assertFalse(pointerA.equals(pointerB));
  Assert.assertFalse(pointerB.equals(pointerA));
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashCode(){
  FlumeEventPointer pointerA=new FlumeEventPointer(1,1);
  FlumeEventPointer pointerB=new FlumeEventPointer(1,1);
  Assert.assertEquals(pointerA.hashCode(),pointerB.hashCode());
  pointerA=new FlumeEventPointer(1,1);
  pointerB=new FlumeEventPointer(2,2);
  Assert.assertFalse(pointerA.hashCode() == pointerB.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestFlumeEventQueue </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTail1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCapacity() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,1,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertFalse(queue.addTail(pointer2));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInflightTakes() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
  long txnID2=txnID1 + 1;
  queue.addTail(new FlumeEventPointer(1,1));
  queue.addTail(new FlumeEventPointer(2,1));
  queue.addTail(new FlumeEventPointer(2,2));
  queue.removeHead(txnID1);
  queue.removeHead(txnID2);
  queue.removeHead(txnID2);
  queue.checkpoint(true);
  TimeUnit.SECONDS.sleep(3L);
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightTakes();
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidCapacityNegative() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,-1,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadRemove1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.addHead(pointer1);
  Assert.assertTrue(queue.remove(pointer1));
  Assert.assertNull(queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailRemove1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
  Assert.assertNull(queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHead1() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testInvalidCapacityZero() throws Exception {
  backingStore.close();
  File checkpoint=backingStoreSupplier.getCheckpoint();
  Assert.assertTrue(checkpoint.delete());
  backingStore=new EventQueueBackingStoreFileV2(checkpoint,0,"test");
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnknownPointerDoesNotCauseSearch() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertFalse(queue.remove(pointer3));
  Assert.assertTrue(queue.remove(pointer1));
  Assert.assertTrue(queue.remove(pointer2));
  queue.replayComplete();
  Assert.assertEquals(2,queue.getSearchCount());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCorruptInflightPuts() throws Exception {
  RandomAccessFile inflight=null;
  try {
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
    long txnID2=txnID1 + 1;
    queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
    queue.checkpoint(true);
    TimeUnit.SECONDS.sleep(3L);
    inflight=new RandomAccessFile(backingStoreSupplier.getInflightPuts(),"rw");
    inflight.seek(0);
    inflight.writeInt(new Random().nextInt());
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightPuts();
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
  }
  finally {
    inflight.close();
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailLarge() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  int size=500;
  Set<Integer> fileIDs=Sets.newHashSet();
  for (int i=1; i <= size; i++) {
    Assert.assertTrue(queue.addTail(new FlumeEventPointer(i,i)));
    fileIDs.add(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  for (int i=1; i <= size; i++) {
    Assert.assertEquals(new FlumeEventPointer(i,i),queue.removeHead(0));
    fileIDs.remove(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadRemove2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(pointer2,queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHeadLarge() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.replayComplete();
  int size=500;
  Set<Integer> fileIDs=Sets.newHashSet();
  for (int i=1; i <= size; i++) {
    Assert.assertTrue(queue.addHead(new FlumeEventPointer(i,i)));
    fileIDs.add(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  for (int i=size; i > 0; i--) {
    Assert.assertEquals(new FlumeEventPointer(i,i),queue.removeHead(0));
    fileIDs.remove(i);
    Assert.assertEquals(fileIDs,queue.getFileIDs());
  }
  Assert.assertEquals(Sets.newHashSet(),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTailRemove2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertTrue(queue.addTail(pointer2));
  Assert.assertTrue(queue.remove(pointer1));
  queue.replayComplete();
  Assert.assertEquals(pointer2,queue.removeHead(0));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTail2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  Assert.assertTrue(queue.addTail(pointer1));
  Assert.assertTrue(queue.addTail(pointer2));
  Assert.assertEquals(Sets.newHashSet(1,2),queue.getFileIDs());
  Assert.assertEquals(pointer1,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(2),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BadCheckpointException.class) public void testCorruptInflightTakes() throws Exception {
  RandomAccessFile inflight=null;
  try {
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
    long txnID2=txnID1 + 1;
    queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
    queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
    queue.checkpoint(true);
    TimeUnit.SECONDS.sleep(3L);
    inflight=new RandomAccessFile(backingStoreSupplier.getInflightTakes(),"rw");
    inflight.seek(0);
    inflight.writeInt(new Random().nextInt());
    queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
    SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightTakes();
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
    Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
  }
  finally {
    inflight.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addHead2() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  queue.replayComplete();
  Assert.assertTrue(queue.addHead(pointer1));
  Assert.assertTrue(queue.addHead(pointer2));
  Assert.assertEquals(Sets.newHashSet(1,2),queue.getFileIDs());
  Assert.assertEquals(pointer2,queue.removeHead(0));
  Assert.assertEquals(Sets.newHashSet(1),queue.getFileIDs());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInflightPuts() throws Exception {
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  long txnID1=new Random().nextInt(Integer.MAX_VALUE - 1);
  long txnID2=txnID1 + 1;
  queue.addWithoutCommit(new FlumeEventPointer(1,1),txnID1);
  queue.addWithoutCommit(new FlumeEventPointer(2,1),txnID1);
  queue.addWithoutCommit(new FlumeEventPointer(2,2),txnID2);
  queue.checkpoint(true);
  TimeUnit.SECONDS.sleep(3L);
  queue=new FlumeEventQueue(backingStore,backingStoreSupplier.getInflightTakes(),backingStoreSupplier.getInflightPuts(),backingStoreSupplier.getQueueSetDir());
  SetMultimap<Long,Long> deserializedMap=queue.deserializeInflightPuts();
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(1,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID1).contains(new FlumeEventPointer(2,1).toLong()));
  Assert.assertTrue(deserializedMap.get(txnID2).contains(new FlumeEventPointer(2,2).toLong()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestIntegration </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegration() throws IOException, InterruptedException {
  Context context=new Context();
  context.put(FileChannelConfiguration.CHECKPOINT_DIR,checkpointDir.getAbsolutePath());
  context.put(FileChannelConfiguration.DATA_DIRS,dataDir);
  context.put(FileChannelConfiguration.CAPACITY,String.valueOf(10000));
  context.put(FileChannelConfiguration.CHECKPOINT_INTERVAL,"5000");
  context.put(FileChannelConfiguration.MAX_FILE_SIZE,String.valueOf(1024 * 1024 * 5));
  channel=new FileChannel();
  channel.setName("FileChannel-" + UUID.randomUUID());
  Configurables.configure(channel,context);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  SequenceGeneratorSource source=new SequenceGeneratorSource();
  CountingSourceRunner sourceRunner=new CountingSourceRunner(source,channel);
  source.configure(context);
  source.start();
  NullSink sink=new NullSink();
  sink.setChannel(channel);
  CountingSinkRunner sinkRunner=new CountingSinkRunner(sink);
  sinkRunner.start();
  sourceRunner.start();
  TimeUnit.SECONDS.sleep(30);
  sourceRunner.shutdown();
  while (sourceRunner.isAlive()) {
    Thread.sleep(10L);
  }
  while (channel.getDepth() > 0) {
    Thread.sleep(10L);
  }
  sinkRunner.shutdown();
  TimeUnit.SECONDS.sleep(5);
  List<File> logs=Lists.newArrayList();
  for (int i=0; i < dataDirs.length; i++) {
    logs.addAll(LogUtils.getLogs(dataDirs[i]));
  }
  LOG.info("Total Number of Logs = " + logs.size());
  for (  File logFile : logs) {
    LOG.info("LogFile = " + logFile);
  }
  LOG.info("Source processed " + sinkRunner.getCount());
  LOG.info("Sink processed " + sourceRunner.getCount());
  for (  Exception ex : sourceRunner.getErrors()) {
    LOG.warn("Source had error",ex);
  }
  for (  Exception ex : sinkRunner.getErrors()) {
    LOG.warn("Sink had error",ex);
  }
  Assert.assertEquals(sinkRunner.getCount(),sinkRunner.getCount());
  Assert.assertEquals(Collections.EMPTY_LIST,sinkRunner.getErrors());
  Assert.assertEquals(Collections.EMPTY_LIST,sourceRunner.getErrors());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup(){
  baseDir=Files.createTempDir();
  checkpointDir=new File(baseDir,"chkpt");
  Assert.assertTrue(checkpointDir.mkdirs() || checkpointDir.isDirectory());
  dataDirs=new File[3];
  dataDir="";
  for (int i=0; i < dataDirs.length; i++) {
    dataDirs[i]=new File(baseDir,"data" + (i + 1));
    Assert.assertTrue(dataDirs[i].mkdirs() || dataDirs[i].isDirectory());
    dataDir+=dataDirs[i].getAbsolutePath() + ",";
  }
  dataDir=dataDir.substring(0,dataDir.length() - 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLog </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCheckpointOnClose() throws Exception {
  log.close();
  log=new Log.Builder().setCheckpointInterval(1L).setMaxFileSize(MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setCheckpointOnClose(true).setChannelName("testLog").build();
  log.replay();
  FlumeEvent eventIn=TestUtils.newPersistableEvent();
  log.put(transactionID,eventIn);
  log.commitPut(transactionID);
  File checkPointMetaFile=FileUtils.listFiles(checkpointDir,new String[]{"meta"},false).iterator().next();
  long before=FileUtils.checksumCRC32(checkPointMetaFile);
  log.close();
  long after=FileUtils.checksumCRC32(checkPointMetaFile);
  Assert.assertFalse(before == after);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testReplaySucceedsWithUnusedEmptyLogMetaDataFastReplay() throws IOException, InterruptedException, NoopRecordException, CorruptEventException {
  FlumeEvent eventIn=TestUtils.newPersistableEvent();
  long transactionID=++this.transactionID;
  FlumeEventPointer eventPointer=log.put(transactionID,eventIn);
  log.commitPut(transactionID);
  log.close();
  checkpointDir=Files.createTempDir();
  FileUtils.forceDeleteOnExit(checkpointDir);
  Assert.assertTrue(checkpointDir.isDirectory());
  log=new Log.Builder().setCheckpointInterval(1L).setMaxFileSize(MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setChannelName("testlog").setUseFastReplay(true).build();
  doTestReplaySucceedsWithUnusedEmptyLogMetaData(eventIn,eventPointer);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMinimumRequiredSpaceTooSmallOnStartup() throws IOException, InterruptedException {
  log.close();
  log=new Log.Builder().setCheckpointInterval(Long.MAX_VALUE).setMaxFileSize(FileChannelConfiguration.DEFAULT_MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setChannelName("testlog").setMinimumRequiredSpace(Long.MAX_VALUE).build();
  try {
    log.replay();
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().startsWith("Usable space exhausted"));
  }
}

</code></pre>

<br>
<pre class="type-12 type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws IOException {
  transactionID=0;
  checkpointDir=Files.createTempDir();
  FileUtils.forceDeleteOnExit(checkpointDir);
  Assert.assertTrue(checkpointDir.isDirectory());
  dataDirs=new File[3];
  for (int i=0; i < dataDirs.length; i++) {
    dataDirs[i]=Files.createTempDir();
    Assert.assertTrue(dataDirs[i].isDirectory());
  }
  log=new Log.Builder().setCheckpointInterval(1L).setMaxFileSize(MAX_FILE_SIZE).setQueueSize(CAPACITY).setCheckpointDir(checkpointDir).setLogDirs(dataDirs).setCheckpointOnClose(false).setChannelName("testlog").build();
  log.replay();
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLogs() throws IOException {
  File logDir=dataDirs[0];
  List<File> expected=Lists.newArrayList();
  for (int i=0; i < 10; i++) {
    File log=new File(logDir,Log.PREFIX + i);
    expected.add(log);
    Assert.assertTrue(log.isFile() || log.createNewFile());
    File metaDataFile=Serialization.getMetaDataFile(log);
    File metaDataTempFile=Serialization.getMetaDataTempFile(metaDataFile);
    File logGzip=new File(logDir,Log.PREFIX + i + ".gz");
    Assert.assertTrue(metaDataFile.isFile() || metaDataFile.createNewFile());
    Assert.assertTrue(metaDataTempFile.isFile() || metaDataTempFile.createNewFile());
    Assert.assertTrue(log.isFile() || logGzip.createNewFile());
  }
  List<File> actual=LogUtils.getLogs(logDir);
  LogUtils.sort(actual);
  LogUtils.sort(expected);
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLogFile </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupCommit() throws Exception {
  final FlumeEvent eventIn=TestUtils.newPersistableEvent(250);
  final CyclicBarrier barrier=new CyclicBarrier(20);
  ExecutorService executorService=Executors.newFixedThreadPool(20);
  ExecutorCompletionService<Void> completionService=new ExecutorCompletionService<Void>(executorService);
  final LogFile.Writer writer=logFileWriter;
  final AtomicLong txnId=new AtomicLong(++transactionID);
  for (int i=0; i < 20; i++) {
    completionService.submit(new Callable<Void>(){
      @Override public Void call(){
        try {
          Put put=new Put(txnId.incrementAndGet(),WriteOrderOracle.next(),eventIn);
          ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
          writer.put(bytes);
          writer.commit(TransactionEventRecord.toByteBuffer(new Commit(txnId.get(),WriteOrderOracle.next())));
          barrier.await();
          writer.sync();
        }
 catch (        Exception ex) {
          Throwables.propagate(ex);
        }
        return null;
      }
    }
);
  }
  for (int i=0; i < 20; i++) {
    completionService.take().get();
  }
  Assert.assertTrue(logFileWriter.position() >= 5000);
  Assert.assertEquals(1,writer.getSyncCount());
  Assert.assertTrue(logFileWriter.getLastCommitPosition() == logFileWriter.getLastSyncPosition());
  executorService.shutdown();
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterFailsWithDirectory() throws IOException {
  FileUtils.deleteQuietly(dataFile);
  Assert.assertFalse(dataFile.exists());
  Assert.assertTrue(dataFile.mkdirs());
  try {
    LogFileFactory.getWriter(dataFile,fileID,Integer.MAX_VALUE,null,null,null,Long.MAX_VALUE,true,0);
    Assert.fail();
  }
 catch (  IllegalStateException e) {
    Assert.assertEquals("File already exists " + dataFile.getAbsolutePath(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderTempMetaFile() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  File metadataFile=Serialization.getMetaDataFile(dataFile);
  File tempMetadataFile=Serialization.getMetaDataTempFile(dataFile);
  File oldMetadataFile=Serialization.getOldMetaDataFile(dataFile);
  oldMetadataFile.createNewFile();
  if (!metadataFile.renameTo(tempMetadataFile)) {
    Assert.fail("Renaming to meta.temp failed");
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  Assert.assertTrue(metadataFile.exists());
  Assert.assertFalse(tempMetadataFile.exists());
  Assert.assertFalse(oldMetadataFile.exists());
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws IOException {
  fileID=1;
  transactionID=1L;
  dataDir=Files.createTempDir();
  dataFile=new File(dataDir,String.valueOf(fileID));
  Assert.assertTrue(dataDir.isDirectory());
  logFileWriter=LogFileFactory.getWriter(dataFile,fileID,Integer.MAX_VALUE,null,null,null,Long.MAX_VALUE,true,0);
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-11 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderOldMetaFile() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  File metadataFile=Serialization.getMetaDataFile(dataFile);
  File oldMetadataFile=Serialization.getOldMetaDataFile(dataFile);
  if (!metadataFile.renameTo(oldMetadataFile)) {
    Assert.fail("Renaming to meta.old failed");
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  Assert.assertTrue(metadataFile.exists());
  Assert.assertFalse(oldMetadataFile.exists());
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-12 type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReader() throws InterruptedException, IOException, CorruptEventException {
  Map<Integer,Put> puts=Maps.newHashMap();
  for (int i=0; i < 1000; i++) {
    FlumeEvent eventIn=TestUtils.newPersistableEvent();
    Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    puts.put(ptr.getOffset(),put);
  }
  LogFile.SequentialReader reader=LogFileFactory.getSequentialReader(dataFile,null,true);
  LogRecord entry;
  while ((entry=reader.next()) != null) {
    Integer offset=entry.getOffset();
    TransactionEventRecord record=entry.getEvent();
    Put put=puts.get(offset);
    FlumeEvent eventIn=put.getEvent();
    Assert.assertEquals(put.getTransactionID(),record.getTransactionID());
    Assert.assertTrue(record instanceof Put);
    FlumeEvent eventOut=((Put)record).getEvent();
    Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
    Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutGet() throws InterruptedException, IOException {
  final List<Throwable> errors=Collections.synchronizedList(new ArrayList<Throwable>());
  ExecutorService executorService=Executors.newFixedThreadPool(10);
  CompletionService<Void> completionService=new ExecutorCompletionService<Void>(executorService);
  final LogFile.RandomReader logFileReader=LogFileFactory.getRandomReader(dataFile,null,true);
  for (int i=0; i < 1000; i++) {
synchronized (errors) {
      for (      Throwable throwable : errors) {
        Throwables.propagateIfInstanceOf(throwable,AssertionError.class);
      }
      for (      Throwable throwable : errors) {
        Throwables.propagate(throwable);
      }
    }
    final FlumeEvent eventIn=TestUtils.newPersistableEvent();
    final Put put=new Put(++transactionID,WriteOrderOracle.next(),eventIn);
    ByteBuffer bytes=TransactionEventRecord.toByteBuffer(put);
    FlumeEventPointer ptr=logFileWriter.put(bytes);
    final int offset=ptr.getOffset();
    completionService.submit(new Runnable(){
      @Override public void run(){
        try {
          FlumeEvent eventOut=logFileReader.get(offset);
          Assert.assertEquals(eventIn.getHeaders(),eventOut.getHeaders());
          Assert.assertTrue(Arrays.equals(eventIn.getBody(),eventOut.getBody()));
        }
 catch (        Throwable throwable) {
synchronized (errors) {
            errors.add(throwable);
          }
        }
      }
    }
,null);
  }
  for (int i=0; i < 1000; i++) {
    completionService.take();
  }
  for (  Throwable throwable : errors) {
    Throwables.propagateIfInstanceOf(throwable,AssertionError.class);
  }
  for (  Throwable throwable : errors) {
    Throwables.propagate(throwable);
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteDelimitedTo() throws IOException {
  if (dataFile.isFile()) {
    Assert.assertTrue(dataFile.delete());
  }
  Assert.assertTrue(dataFile.createNewFile());
  ProtosFactory.LogFileMetaData.Builder metaDataBuilder=ProtosFactory.LogFileMetaData.newBuilder();
  metaDataBuilder.setVersion(1);
  metaDataBuilder.setLogFileID(2);
  metaDataBuilder.setCheckpointPosition(3);
  metaDataBuilder.setCheckpointWriteOrderID(4);
  LogFileV3.writeDelimitedTo(metaDataBuilder.build(),dataFile);
  ProtosFactory.LogFileMetaData metaData=ProtosFactory.LogFileMetaData.parseDelimitedFrom(new FileInputStream(dataFile));
  Assert.assertEquals(1,metaData.getVersion());
  Assert.assertEquals(2,metaData.getLogFileID());
  Assert.assertEquals(3,metaData.getCheckpointPosition());
  Assert.assertEquals(4,metaData.getCheckpointWriteOrderID());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterRefusesToOverwriteFile() throws IOException {
  Assert.assertTrue(dataFile.isFile() || dataFile.createNewFile());
  try {
    LogFileFactory.getWriter(dataFile,fileID,Integer.MAX_VALUE,null,null,null,Long.MAX_VALUE,true,0);
    Assert.fail();
  }
 catch (  IllegalStateException e) {
    Assert.assertEquals("File already exists " + dataFile.getAbsolutePath(),e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestLogRecord </h4><pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testConstructor(){
  long now=System.currentTimeMillis();
  Commit commit=new Commit(now,now + 1);
  LogRecord logRecord=new LogRecord(1,2,commit);
  Assert.assertTrue(now == commit.getTransactionID());
  Assert.assertTrue(now + 1 == commit.getLogWriteOrderID());
  Assert.assertTrue(1 == logRecord.getFileID());
  Assert.assertTrue(2 == logRecord.getOffset());
  Assert.assertTrue(commit == logRecord.getEvent());
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSortOrder(){
  long now=System.currentTimeMillis();
  List<LogRecord> records=Lists.newArrayList();
  for (int i=0; i < 3; i++) {
    Commit commit=new Commit((long)i,now - i);
    LogRecord logRecord=new LogRecord(1,i,commit);
    records.add(logRecord);
  }
  LogRecord logRecord;
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),2 == logRecord.getOffset());
  records.remove(logRecord);
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),1 == logRecord.getOffset());
  records.remove(logRecord);
  logRecord=Collections.min(records);
  Assert.assertTrue(String.valueOf(logRecord.getOffset()),0 == logRecord.getOffset());
  records.remove(logRecord);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestTransactionEventRecordV2 </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerialization() throws IOException {
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(new HashMap<String,String>(),new byte[0]));
  Put out=(Put)TransactionEventRecord.fromDataInputV2(toDataInput(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getEvent().getHeaders(),out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestTransactionEventRecordV3 </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerialization() throws IOException, CorruptEventException {
  Map<String,String> headers=new HashMap<String,String>();
  headers.put("key","value");
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(headers,new byte[0]));
  Put out=(Put)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertEquals(in.getEvent().getHeaders(),out.getEvent().getHeaders());
  Assert.assertEquals(headers,in.getEvent().getHeaders());
  Assert.assertEquals(headers,out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutSerializationNullHeader() throws IOException, CorruptEventException {
  Put in=new Put(System.currentTimeMillis(),WriteOrderOracle.next(),new FlumeEvent(null,new byte[0]));
  Put out=(Put)TransactionEventRecord.fromByteArray(toByteArray(in));
  Assert.assertEquals(in.getClass(),out.getClass());
  Assert.assertEquals(in.getRecordType(),out.getRecordType());
  Assert.assertEquals(in.getTransactionID(),out.getTransactionID());
  Assert.assertEquals(in.getLogWriteOrderID(),out.getLogWriteOrderID());
  Assert.assertNull(in.getEvent().getHeaders());
  Assert.assertNotNull(out.getEvent().getHeaders());
  Assert.assertTrue(Arrays.equals(in.getEvent().getBody(),out.getEvent().getBody()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestTransactionIDOracle </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetSeed(){
  long current=TransactionIDOracle.next();
  current+=Integer.MAX_VALUE;
  TransactionIDOracle.setSeed(current);
  Assert.assertTrue(TransactionIDOracle.next() > System.currentTimeMillis());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.TestWriteOrderOracle </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetSeed(){
  long current=WriteOrderOracle.next();
  current+=Integer.MAX_VALUE;
  WriteOrderOracle.setSeed(current);
  Assert.assertTrue(WriteOrderOracle.next() > System.currentTimeMillis());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.encryption.TestFileChannelEncryption </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBasicEncyrptionDecryption() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"restart");
  channel.stop();
  channel=TestUtils.createFileChannel(checkpointDir.getAbsolutePath(),dataDir,overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-13 type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptedChannelWithoutEncryptionConfigFails() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  fillChannel(channel,"will-not-restart");
  channel.stop();
  Map<String,String> noEncryptionOverrides=getOverrides();
  channel=createFileChannel(noEncryptionOverrides);
  channel.start();
  if (channel.isOpen()) {
    try {
      takeEvents(channel,1,1);
      Assert.fail("Channel was opened and take did not throw exception");
    }
 catch (    ChannelException ex) {
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingKeyStoreFile() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(Joiner.on(".").join(EncryptionConfiguration.ENCRYPTION_PREFIX,EncryptionConfiguration.KEY_PROVIDER,EncryptionConfiguration.JCE_FILE_KEY_STORE_FILE),"/path/does/not/exist");
  try {
    channel=createFileChannel(overrides);
    Assert.fail();
  }
 catch (  RuntimeException ex) {
    Assert.assertTrue("Exception message is incorrect: " + ex.getMessage(),ex.getMessage().startsWith("java.io.FileNotFoundException: /path/does/not/exist "));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBadCipherProviderInvalidClass() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(Joiner.on(".").join(EncryptionConfiguration.ENCRYPTION_PREFIX,EncryptionConfiguration.CIPHER_PROVIDER),String.class.getName());
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertFalse(channel.isOpen());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBadCipherProviderInvalidValue() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(Joiner.on(".").join(EncryptionConfiguration.ENCRYPTION_PREFIX,EncryptionConfiguration.CIPHER_PROVIDER),"invalid");
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertFalse(channel.isOpen());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  super.setup();
  keyStorePasswordFile=new File(baseDir,"keyStorePasswordFile");
  Files.write("keyStorePassword",keyStorePasswordFile,Charsets.UTF_8);
  keyStoreFile=new File(baseDir,"keyStoreFile");
  Assert.assertTrue(keyStoreFile.createNewFile());
  keyAliasPassword=Maps.newHashMap();
  keyAliasPassword.putAll(EncryptionTestUtils.configureTestKeyStore(baseDir,keyStoreFile));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBadKeyAlias() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(EncryptionConfiguration.ENCRYPTION_PREFIX + "." + EncryptionConfiguration.ACTIVE_KEY,"invalid");
  channel=TestUtils.createFileChannel(checkpointDir.getAbsolutePath(),dataDir,overrides);
  channel.start();
  Assert.assertFalse(channel.isOpen());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingKeyStorePasswordFile() throws Exception {
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(Joiner.on(".").join(EncryptionConfiguration.ENCRYPTION_PREFIX,EncryptionConfiguration.KEY_PROVIDER,EncryptionConfiguration.JCE_FILE_KEY_STORE_PASSWORD_FILE),"/path/does/not/exist");
  try {
    channel=createFileChannel(overrides);
    Assert.fail();
  }
 catch (  RuntimeException ex) {
    Assert.assertTrue("Exception message is incorrect: " + ex.getMessage(),ex.getMessage().startsWith("java.io.FileNotFoundException: /path/does/not/exist "));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testThreadedProduce() throws Exception {
  int numThreads=20;
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(10000));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(100));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Executor executor=Executors.newFixedThreadPool(numThreads);
  final AtomicBoolean error=new AtomicBoolean(false);
  final CountDownLatch startLatch=new CountDownLatch(numThreads);
  final CountDownLatch stopLatch=new CountDownLatch(numThreads);
  final Set<String> in=Collections.synchronizedSet(new HashSet<String>());
  for (int i=0; i < numThreads; i++) {
    executor.execute(new Runnable(){
      @Override public void run(){
        try {
          startLatch.countDown();
          startLatch.await();
          in.addAll(putEvents(channel,"thread-produce",10,10000,true));
        }
 catch (        Throwable t) {
          error.set(true);
          LOGGER.error("Error in put thread",t);
        }
 finally {
          stopLatch.countDown();
        }
      }
    }
);
  }
  stopLatch.await();
  Set<String> out=consumeChannel(channel);
  Assert.assertFalse(error.get());
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testUnencyrptedAndEncryptedLogs() throws Exception {
  Map<String,String> noEncryptionOverrides=getOverrides();
  channel=createFileChannel(noEncryptionOverrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"unencrypted-and-encrypted");
  int numEventsToRemove=in.size() / 2;
  for (int i=0; i < numEventsToRemove; i++) {
    Assert.assertTrue(in.removeAll(takeEvents(channel,1,1)));
  }
  channel.stop();
  Map<String,String> overrides=getOverridesForEncryption();
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  in.addAll(fillChannel(channel,"unencrypted-and-encrypted"));
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test fails without FLUME-1565
 */
@Test public void testThreadedConsume() throws Exception {
  int numThreads=20;
  Map<String,String> overrides=getOverridesForEncryption();
  overrides.put(FileChannelConfiguration.CAPACITY,String.valueOf(10000));
  overrides.put(FileChannelConfiguration.TRANSACTION_CAPACITY,String.valueOf(100));
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Executor executor=Executors.newFixedThreadPool(numThreads);
  Set<String> in=fillChannel(channel,"threaded-consume");
  final AtomicBoolean error=new AtomicBoolean(false);
  final CountDownLatch startLatch=new CountDownLatch(numThreads);
  final CountDownLatch stopLatch=new CountDownLatch(numThreads);
  final Set<String> out=Collections.synchronizedSet(new HashSet<String>());
  for (int i=0; i < numThreads; i++) {
    executor.execute(new Runnable(){
      @Override public void run(){
        try {
          startLatch.countDown();
          startLatch.await();
          out.addAll(takeEvents(channel,10));
        }
 catch (        Throwable t) {
          error.set(true);
          LOGGER.error("Error in take thread",t);
        }
 finally {
          stopLatch.countDown();
        }
      }
    }
);
  }
  stopLatch.await();
  Assert.assertFalse(error.get());
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testConfiguration() throws Exception {
  Map<String,String> overrides=Maps.newHashMap();
  overrides.put("encryption.activeKey","key-1");
  overrides.put("encryption.cipherProvider","AESCTRNOPADDING");
  overrides.put("encryption.keyProvider","JCEKSFILE");
  overrides.put("encryption.keyProvider.keyStoreFile",keyStoreFile.getAbsolutePath());
  overrides.put("encryption.keyProvider.keyStorePasswordFile",keyStorePasswordFile.getAbsolutePath());
  overrides.put("encryption.keyProvider.keys","key-0 key-1");
  overrides.put("encryption.keyProvider.keys.key-0.passwordFile",keyAliasPassword.get("key-0").getAbsolutePath());
  channel=createFileChannel(overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> in=fillChannel(channel,"restart");
  channel.stop();
  channel=TestUtils.createFileChannel(checkpointDir.getAbsolutePath(),dataDir,overrides);
  channel.start();
  Assert.assertTrue(channel.isOpen());
  Set<String> out=consumeChannel(channel);
  compareInputAndOut(in,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.file.encryption.TestJCEFileKeyProvider </h4><pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  baseDir=Files.createTempDir();
  keyStorePasswordFile=new File(baseDir,"keyStorePasswordFile");
  Files.write("keyStorePassword",keyStorePasswordFile,Charsets.UTF_8);
  keyAliasPassword=Maps.newHashMap();
  keyStoreFile=new File(baseDir,"keyStoreFile");
  Assert.assertTrue(keyStoreFile.createNewFile());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.channel.kafka.TestKafkaChannel </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testNoParsingAsFlumeAgent() throws Exception {
  final KafkaChannel channel=startChannel(false);
  Producer<String,byte[]> producer=new Producer<String,byte[]>(new ProducerConfig(channel.getKafkaConf()));
  List<KeyedMessage<String,byte[]>> original=Lists.newArrayList();
  for (int i=0; i < 50; i++) {
    KeyedMessage<String,byte[]> data=new KeyedMessage<String,byte[]>(topic,null,RandomStringUtils.randomAlphabetic(6),String.valueOf(i).getBytes());
    original.add(data);
  }
  producer.send(original);
  ExecutorCompletionService<Void> submitterSvc=new ExecutorCompletionService<Void>(Executors.newCachedThreadPool());
  List<Event> events=pullEvents(channel,submitterSvc,50,false,false);
  wait(submitterSvc,5);
  Set<Integer> finals=Sets.newHashSet();
  for (int i=0; i < 50; i++) {
    finals.add(Integer.parseInt(new String(events.get(i).getBody())));
  }
  for (int i=0; i < 50; i++) {
    Assert.assertTrue(finals.contains(i));
    finals.remove(i);
  }
  Assert.assertTrue(finals.isEmpty());
  channel.stop();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTimeoutConfig() throws Exception {
  Context context=prepareDefaultContext(true);
  KafkaChannel channel=new KafkaChannel();
  Configurables.configure(channel,context);
  Assert.assertTrue(channel.getKafkaConf().get(CONSUMER_TIMEOUT).equals(DEFAULT_TIMEOUT));
  String timeout="1000";
  context.put("kafka." + CONSUMER_TIMEOUT,timeout);
  channel=new KafkaChannel();
  Configurables.configure(channel,context);
  Assert.assertTrue(channel.getKafkaConf().get(CONSUMER_TIMEOUT).equals(timeout));
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Like the previous test but here we write to the channel like a Flume source would do
 * to verify that the events are written as text and not as an Avro object
 * @throws Exception
 */
@Test public void testWritingToNoParsingAsFlumeAgent() throws Exception {
  final KafkaChannel channel=startChannel(false);
  List<String> msgs=new ArrayList<String>();
  for (int i=0; i < 50; i++) {
    msgs.add(String.valueOf(i));
  }
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < msgs.size(); i++) {
    channel.put(EventBuilder.withBody(msgs.get(i).getBytes()));
  }
  tx.commit();
  ExecutorCompletionService<Void> submitterSvc=new ExecutorCompletionService<Void>(Executors.newCachedThreadPool());
  List<Event> events=pullEvents(channel,submitterSvc,50,false,false);
  wait(submitterSvc,5);
  Set<Integer> finals=Sets.newHashSet();
  for (int i=0; i < 50; i++) {
    finals.add(Integer.parseInt(new String(events.get(i).getBody())));
  }
  for (int i=0; i < 50; i++) {
    Assert.assertTrue(finals.contains(i));
    finals.remove(i);
  }
  Assert.assertTrue(finals.isEmpty());
  channel.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestBufferedLineReader </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsWithinAFile() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  SimpleTextLineEventReader reader=new SimpleTextLineEventReader(new FileReader(f1));
  List<String> out=bodiesAsStrings(reader.readEvents(5));
  assertEquals(5,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsAtFileBoundary() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  SimpleTextLineEventReader reader=new SimpleTextLineEventReader(new FileReader(f1));
  List<String> out=bodiesAsStrings(reader.readEvents(10));
  assertEquals(8,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
  assertTrue(out.contains("file1line6"));
  assertTrue(out.contains("file1line7"));
  assertTrue(out.contains("file1line8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestReliableSpoolingFileEventReader </h4><pre class="type-12 type-9 type-13 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepeatedCallsWithCommitOnSuccess() throws IOException {
  String trackerDirPath=SpoolDirectorySourceConfigurationConstants.DEFAULT_TRACKER_DIR;
  File trackerDir=new File(WORK_DIR,trackerDirPath);
  ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).trackerDirPath(trackerDirPath).build();
  final int expectedLines=0 + 1 + 2+ 3+ 1;
  int seenLines=0;
  for (int i=0; i < 10; i++) {
    List<Event> events=reader.readEvents(10);
    int numEvents=events.size();
    if (numEvents > 0) {
      seenLines+=numEvents;
      reader.commit();
      File[] files=trackerDir.listFiles();
      Assert.assertNotNull(files);
      Assert.assertTrue("Expected tracker files in tracker dir " + trackerDir.getAbsolutePath(),files.length > 0);
    }
  }
  Assert.assertEquals(expectedLines,seenLines);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsumeFileRandomlyNewFile() throws Exception {
  if (SystemUtils.IS_OS_WINDOWS) {
    return;
  }
  final ReliableEventReader reader=new ReliableSpoolingFileEventReader.Builder().spoolDirectory(WORK_DIR).consumeOrder(ConsumeOrder.RANDOM).build();
  File fileName=new File(WORK_DIR,"new-file");
  FileUtils.write(fileName,"New file created in the end. Shoud be read randomly.\n");
  Set<String> expected=Sets.newHashSet();
  int totalFiles=WORK_DIR.listFiles().length;
  final Set<String> actual=Sets.newHashSet();
  ExecutorService executor=Executors.newSingleThreadExecutor();
  final Semaphore semaphore1=new Semaphore(0);
  final Semaphore semaphore2=new Semaphore(0);
  Future<Void> wait=executor.submit(new Callable<Void>(){
    @Override public Void call() throws Exception {
      readEventsForFilesInDir(WORK_DIR,reader,actual,semaphore1,semaphore2);
      return null;
    }
  }
);
  semaphore1.acquire();
  File finalFile=new File(WORK_DIR,"t-file");
  FileUtils.write(finalFile,"Last file");
  semaphore2.release();
  wait.get();
  int listFilesCount=((ReliableSpoolingFileEventReader)reader).getListFilesCount();
  finalFile.delete();
  createExpectedFromFilesInSetup(expected);
  expected.add("");
  expected.add("New file created in the end. Shoud be read randomly.");
  expected.add("Last file");
  Assert.assertTrue(listFilesCount < (totalFiles + 2));
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.client.avro.TestSpoolingFileLineReader </h4><pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBehaviorWithEmptyFile() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file0");
  Files.touch(f1);
  ReliableSpoolingFileEventReader parser=getParser();
  File f2=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f2,Charsets.UTF_8);
  List<String> out=bodiesAsStrings(parser.readEvents(8));
  parser.commit();
  assertEquals(8,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
  assertTrue(out.contains("file1line6"));
  assertTrue(out.contains("file1line7"));
  assertTrue(out.contains("file1line8"));
  assertNull(parser.readEvent());
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue("Outfiles should have file0 & file1: " + outFiles,outFiles.contains(new File(tmpDir + "/file0" + completedSuffix)));
  assertTrue("Outfiles should have file0 & file1: " + outFiles,outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameCorrespondsToLatestRead() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  parser.readEvents(5);
  parser.commit();
  assertNotNull(parser.getLastFileRead());
  assertTrue(parser.getLastFileRead().endsWith("file1"));
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\nfile2line3\nfile2line4\n" + "file2line5\nfile2line6\nfile2line7\nfile2line8\n",f2,Charsets.UTF_8);
  parser.readEvents(5);
  parser.commit();
  assertNotNull(parser.getLastFileRead());
  assertTrue(parser.getLastFileRead().endsWith("file1"));
  parser.readEvents(5);
  parser.commit();
  assertNotNull(parser.getLastFileRead());
  assertTrue(parser.getLastFileRead().endsWith("file2"));
  parser.readEvents(5);
  assertTrue(parser.getLastFileRead().endsWith("file2"));
  parser.readEvents(5);
  assertTrue(parser.getLastFileRead().endsWith("file2"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDestinationExistsAndSameFileWindows() throws IOException {
  System.setProperty("os.name","Some version of Windows");
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  File f1Completed=new File(tmpDir.getAbsolutePath() + "/file1" + completedSuffix);
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.write("file1line1\nfile1line2\n",f1Completed,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out=Lists.newArrayList();
  for (int i=0; i < 2; i++) {
    out.add(bodyAsString(parser.readEvent()));
    parser.commit();
  }
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  for (int i=0; i < 2; i++) {
    out.add(bodyAsString(parser.readEvent()));
    parser.commit();
  }
  assertEquals(4,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file2line1"));
  assertTrue(out.contains("file2line2"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsAcrossFileBoundary() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out1=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\nfile2line3\nfile2line4\n" + "file2line5\nfile2line6\nfile2line7\nfile2line8\n",f2,Charsets.UTF_8);
  List<String> out2=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  assertEquals(5,out1.size());
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  assertEquals(3,out2.size());
  assertTrue(out2.contains("file1line6"));
  assertTrue(out2.contains("file1line7"));
  assertTrue(out2.contains("file1line8"));
  assertEquals(5,out3.size());
  assertTrue(out3.contains("file2line1"));
  assertTrue(out3.contains("file2line2"));
  assertTrue(out3.contains("file2line3"));
  assertTrue(out3.contains("file2line4"));
  assertTrue(out3.contains("file2line5"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicCommitFailure() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n" + "file1line9\nfile1line10\nfile1line11\nfile1line12\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out1=bodiesAsStrings(parser.readEvents(4));
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  List<String> out2=bodiesAsStrings(parser.readEvents(4));
  assertTrue(out2.contains("file1line1"));
  assertTrue(out2.contains("file1line2"));
  assertTrue(out2.contains("file1line3"));
  assertTrue(out2.contains("file1line4"));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(4));
  assertTrue(out3.contains("file1line5"));
  assertTrue(out3.contains("file1line6"));
  assertTrue(out3.contains("file1line7"));
  assertTrue(out3.contains("file1line8"));
  parser.commit();
  List<String> out4=bodiesAsStrings(parser.readEvents(4));
  assertEquals(4,out4.size());
  assertTrue(out4.contains("file1line9"));
  assertTrue(out4.contains("file1line10"));
  assertTrue(out4.contains("file1line11"));
  assertTrue(out4.contains("file1line12"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicSpooling() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  File f3=new File(tmpDir.getAbsolutePath() + "/file3");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  Files.write("file3line1\nfile3line2\n",f3,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out=Lists.newArrayList();
  for (int i=0; i < 6; i++) {
    logger.info("At line {}",i);
    String body=bodyAsString(parser.readEvent());
    logger.debug("Seen event with body: {}",body);
    out.add(body);
    parser.commit();
  }
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file2line1"));
  assertTrue(out.contains("file2line2"));
  assertTrue(out.contains("file3line1"));
  assertTrue(out.contains("file3line2"));
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(3,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file3")));
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasicCommitFailureAndBufferSizeChanges() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n" + "file1line9\nfile1line10\nfile1line11\nfile1line12\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out1=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  List<String> out2=bodiesAsStrings(parser.readEvents(2));
  assertTrue(out2.contains("file1line1"));
  assertTrue(out2.contains("file1line2"));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(2));
  assertTrue(out3.contains("file1line3"));
  assertTrue(out3.contains("file1line4"));
  parser.commit();
  List<String> out4=bodiesAsStrings(parser.readEvents(2));
  assertTrue(out4.contains("file1line5"));
  assertTrue(out4.contains("file1line6"));
  parser.commit();
  List<String> out5=bodiesAsStrings(parser.readEvents(2));
  assertTrue(out5.contains("file1line7"));
  assertTrue(out5.contains("file1line8"));
  parser.commit();
  List<String> out6=bodiesAsStrings(parser.readEvents(15));
  assertTrue(out6.contains("file1line9"));
  assertTrue(out6.contains("file1line10"));
  assertTrue(out6.contains("file1line11"));
  assertTrue(out6.contains("file1line12"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitiallyEmptyDirectory() throws IOException {
  ReliableSpoolingFileEventReader parser=getParser();
  assertNull(parser.readEvent());
  assertEquals(0,parser.readEvents(10).size());
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  List<String> out=bodiesAsStrings(parser.readEvents(2));
  parser.commit();
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  parser.readEvent();
  parser.commit();
  List<File> outFiles=Lists.newArrayList(tmpDir.listFiles(directoryFilter()));
  assertEquals(2,outFiles.size());
  assertTrue(outFiles.contains(new File(tmpDir + "/file1" + completedSuffix)));
  assertTrue(outFiles.contains(new File(tmpDir + "/file2")));
}

</code></pre>

<br>
<pre class="type-10 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void testFileChangesDuringRead() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser1=getParser();
  List<String> out=Lists.newArrayList();
  out.addAll(bodiesAsStrings(parser1.readEvents(2)));
  parser1.commit();
  assertEquals(2,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  Files.append("file1line3\n",f1,Charsets.UTF_8);
  out.add(bodyAsString(parser1.readEvent()));
  parser1.commit();
  out.add(bodyAsString(parser1.readEvent()));
  parser1.commit();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsWithinAFile() throws IOException {
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser();
  List<String> out=bodiesAsStrings(parser.readEvents(5));
  parser.commit();
  assertEquals(5,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
  assertTrue(out.contains("file1line5"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLineExceedsMaxLineLength() throws IOException {
  final int maxLineLength=12;
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n" + "reallyreallyreallyreallyLongLineHerefile1line9\n"+ "file1line10\nfile1line11\nfile1line12\nfile1line13\n",f1,Charsets.UTF_8);
  ReliableSpoolingFileEventReader parser=getParser(maxLineLength);
  List<String> out1=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  parser.commit();
  List<String> out2=bodiesAsStrings(parser.readEvents(4));
  assertTrue(out2.contains("file1line6"));
  assertTrue(out2.contains("file1line7"));
  assertTrue(out2.contains("file1line8"));
  assertTrue(out2.contains("reallyreally"));
  parser.commit();
  List<String> out3=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out3.contains("reallyreally"));
  assertTrue(out3.contains("LongLineHere"));
  assertTrue(out3.contains("file1line9"));
  assertTrue(out3.contains("file1line10"));
  assertTrue(out3.contains("file1line11"));
  parser.commit();
  List<String> out4=bodiesAsStrings(parser.readEvents(5));
  assertTrue(out4.contains("file1line12"));
  assertTrue(out4.contains("file1line13"));
  assertEquals(2,out4.size());
  parser.commit();
  assertEquals(0,parser.readEvents(5).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.clients.log4jappender.TestLoadBalancingLog4jAppender </h4><pre class="type-10 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testLog4jAppenderRandom() throws IOException {
  int numberOfMsgs=1000;
  File TESTFILE=new File(TestLoadBalancingLog4jAppender.class.getClassLoader().getResource("flume-loadbalancing-rnd-log4jtest.properties").getFile());
  startSources(TESTFILE,false,new int[]{25430,25431,25432,25433,25434,25435,25436,25437,25438,25439});
  sendAndAssertMessages(numberOfMsgs);
  int total=0;
  Set<Integer> counts=new HashSet<Integer>();
  for (  CountingAvroSource source : sources) {
    total+=source.appendCount.intValue();
    counts.add(source.appendCount.intValue());
  }
  Assert.assertTrue("Very unusual distribution " + counts.size(),counts.size() > 2);
  Assert.assertTrue("Missing events",total == numberOfMsgs);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomBackoff() throws Exception {
  File TESTFILE=new File(TestLoadBalancingLog4jAppender.class.getClassLoader().getResource("flume-loadbalancing-backoff-log4jtest.properties").getFile());
  startSources(TESTFILE,false,new int[]{25430,25431,25432});
  sources.get(0).setFail();
  sources.get(2).setFail();
  sendAndAssertMessages(50);
  Assert.assertEquals(50,sources.get(1).appendCount.intValue());
  Assert.assertEquals(0,sources.get(0).appendCount.intValue());
  Assert.assertEquals(0,sources.get(2).appendCount.intValue());
  sources.get(0).setOk();
  sources.get(1).setFail();
  try {
    send(1);
    Assert.fail("Expected EventDeliveryException");
  }
 catch (  FlumeException e) {
    Assert.assertTrue(e.getCause() instanceof EventDeliveryException);
  }
  Thread.sleep(2500);
  sendAndAssertMessages(50);
  Assert.assertEquals(50,sources.get(0).appendCount.intValue());
  Assert.assertEquals(50,sources.get(1).appendCount.intValue());
  Assert.assertEquals(0,sources.get(2).appendCount.intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.conf.TestFlumeConfiguration </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test fails without FLUME-1743
 */
@Test public void testFLUME1743() throws Exception {
  Properties properties=new Properties();
  properties.put("agent1.channels","ch0");
  properties.put("agent1.channels.ch0.type","memory");
  properties.put("agent1.sources","src0");
  properties.put("agent1.sources.src0.type","multiport_syslogtcp");
  properties.put("agent1.sources.src0.channels","ch0");
  properties.put("agent1.sources.src0.host","localhost");
  properties.put("agent1.sources.src0.ports","10001 10002 10003");
  properties.put("agent1.sources.src0.portHeader","port");
  properties.put("agent1.sinks","sink0");
  properties.put("agent1.sinks.sink0.type","null");
  properties.put("agent1.sinks.sink0.channel","ch0");
  FlumeConfiguration conf=new FlumeConfiguration(properties);
  AgentConfiguration agentConfiguration=conf.getConfigurationFor("agent1");
  Assert.assertEquals(String.valueOf(agentConfiguration.getSourceSet()),1,agentConfiguration.getSourceSet().size());
  Assert.assertEquals(String.valueOf(agentConfiguration.getChannelSet()),1,agentConfiguration.getChannelSet().size());
  Assert.assertEquals(String.valueOf(agentConfiguration.getSinkSet()),1,agentConfiguration.getSinkSet().size());
  Assert.assertTrue(agentConfiguration.getSourceSet().contains("src0"));
  Assert.assertTrue(agentConfiguration.getChannelSet().contains("ch0"));
  Assert.assertTrue(agentConfiguration.getSinkSet().contains("sink0"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.event.TestEventHelper </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPrintable(){
  SimpleEvent event=new SimpleEvent();
  event.setBody("Some text".getBytes());
  String eventDump=EventHelper.dumpEvent(event);
  System.out.println(eventDump);
  Assert.assertTrue(eventDump,eventDump.contains("Some text"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNonPrintable(){
  SimpleEvent event=new SimpleEvent();
  byte[] body=new byte[5];
  event.setBody(body);
  String eventDump=EventHelper.dumpEvent(event);
  Assert.assertTrue(eventDump,eventDump.contains("....."));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.instrumentation.TestMonitoredCounterGroup </h4><pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testChannelCounter() throws Exception {
  String name=getRandomName();
  ChannelCounter chc=new ChannelCounter(name);
  chc.register();
  ObjectName on=new ObjectName(CHANNEL_OBJ_NAME_PREFIX + name);
  assertChCounterState(on,0L,0L,0L,0L,0L);
  Assert.assertTrue("StartTime",getStartTime(on) == 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  chc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int numChannelSize=random.nextInt(MAX_BOUNDS);
  int numEventPutAttempt=random.nextInt(MAX_BOUNDS);
  int numEventTakeAttempt=random.nextInt(MAX_BOUNDS);
  int numEventPutSuccess=random.nextInt(MAX_BOUNDS);
  int numEventTakeSuccess=random.nextInt(MAX_BOUNDS);
  chc.setChannelSize(numChannelSize);
  for (int i=0; i < numEventPutAttempt; i++) {
    chc.incrementEventPutAttemptCount();
  }
  for (int i=0; i < numEventTakeAttempt; i++) {
    chc.incrementEventTakeAttemptCount();
  }
  chc.addToEventPutSuccessCount(numEventPutSuccess);
  chc.addToEventTakeSuccessCount(numEventTakeSuccess);
  assertChCounterState(on,numChannelSize,numEventPutAttempt,numEventTakeAttempt,numEventPutSuccess,numEventTakeSuccess);
  chc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertChCounterState(on,numChannelSize,numEventPutAttempt,numEventTakeAttempt,numEventPutSuccess,numEventTakeSuccess);
  Thread.sleep(5L);
  chc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertChCounterState(on,0L,0L,0L,0L,0L);
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterTwice() throws Exception {
  String name="re-register-" + getRandomName();
  SourceCounter c1=new SourceCounter(name);
  c1.register();
  ObjectName on=new ObjectName(SOURCE_OBJ_NAME_PREFIX + name);
  Assert.assertEquals("StartTime",0L,getStartTime(on));
  Assert.assertEquals("StopTime",0L,getStopTime(on));
  c1.start();
  c1.stop();
  Assert.assertTrue("StartTime",getStartTime(on) > 0L);
  Assert.assertTrue("StopTime",getStopTime(on) > 0L);
  SourceCounter c2=new SourceCounter(name);
  c2.register();
  Assert.assertEquals("StartTime",0L,getStartTime(on));
  Assert.assertEquals("StopTime",0L,getStopTime(on));
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSourceCounter() throws Exception {
  String name=getRandomName();
  SourceCounter srcc=new SourceCounter(name);
  srcc.register();
  ObjectName on=new ObjectName(SOURCE_OBJ_NAME_PREFIX + name);
  assertSrcCounterState(on,0L,0L,0L,0L,0L,0L);
  Assert.assertTrue("StartTime",getStartTime(on) == 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  srcc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int numEventReceived=random.nextInt(MAX_BOUNDS);
  int numEventAccepted=random.nextInt(MAX_BOUNDS);
  int numAppendReceived=random.nextInt(MAX_BOUNDS);
  int numAppendAccepted=random.nextInt(MAX_BOUNDS);
  int numAppendBatchReceived=random.nextInt(MAX_BOUNDS);
  int numAppendBatchAccepted=random.nextInt(MAX_BOUNDS);
  srcc.addToEventReceivedCount(numEventReceived);
  srcc.addToEventAcceptedCount(numEventAccepted);
  for (int i=0; i < numAppendReceived; i++) {
    srcc.incrementAppendReceivedCount();
  }
  for (int i=0; i < numAppendAccepted; i++) {
    srcc.incrementAppendAcceptedCount();
  }
  for (int i=0; i < numAppendBatchReceived; i++) {
    srcc.incrementAppendBatchReceivedCount();
  }
  for (int i=0; i < numAppendBatchAccepted; i++) {
    srcc.incrementAppendBatchAcceptedCount();
  }
  assertSrcCounterState(on,numEventReceived,numEventAccepted,numAppendReceived,numAppendAccepted,numAppendBatchReceived,numAppendBatchAccepted);
  srcc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertSrcCounterState(on,numEventReceived,numEventAccepted,numAppendReceived,numAppendAccepted,numAppendBatchReceived,numAppendBatchAccepted);
  Thread.sleep(5L);
  srcc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertSrcCounterState(on,0L,0L,0L,0L,0L,0L);
  int numEventReceived2=random.nextInt(MAX_BOUNDS);
  int numEventAccepted2=random.nextInt(MAX_BOUNDS);
  for (int i=0; i < numEventReceived2; i++) {
    srcc.incrementEventReceivedCount();
  }
  for (int i=0; i < numEventAccepted2; i++) {
    srcc.incrementEventAcceptedCount();
  }
  assertSrcCounterState(on,numEventReceived2,numEventAccepted2,0L,0L,0L,0L);
}

</code></pre>

<br>
<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSinkCounter() throws Exception {
  String name=getRandomName();
  SinkCounter skc=new SinkCounter(name);
  skc.register();
  ObjectName on=new ObjectName(SINK_OBJ_NAME_PREFIX + name);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,0L,0L);
  skc.start();
  long start1=getStartTime(on);
  Assert.assertTrue("StartTime",start1 != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  int connCreated=random.nextInt(MAX_BOUNDS);
  int connClosed=random.nextInt(MAX_BOUNDS);
  int connFailed=random.nextInt(MAX_BOUNDS);
  int batchEmpty=random.nextInt(MAX_BOUNDS);
  int batchUnderflow=random.nextInt(MAX_BOUNDS);
  int batchComplete=random.nextInt(MAX_BOUNDS);
  int eventDrainAttempt=random.nextInt(MAX_BOUNDS);
  int eventDrainSuccess=random.nextInt(MAX_BOUNDS);
  for (int i=0; i < connCreated; i++) {
    skc.incrementConnectionCreatedCount();
  }
  for (int i=0; i < connClosed; i++) {
    skc.incrementConnectionClosedCount();
  }
  for (int i=0; i < connFailed; i++) {
    skc.incrementConnectionFailedCount();
  }
  for (int i=0; i < batchEmpty; i++) {
    skc.incrementBatchEmptyCount();
  }
  for (int i=0; i < batchUnderflow; i++) {
    skc.incrementBatchUnderflowCount();
  }
  for (int i=0; i < batchComplete; i++) {
    skc.incrementBatchCompleteCount();
  }
  for (int i=0; i < eventDrainAttempt; i++) {
    skc.incrementEventDrainAttemptCount();
  }
  for (int i=0; i < eventDrainSuccess; i++) {
    skc.incrementEventDrainSuccessCount();
  }
  assertSkCounterState(on,connCreated,connClosed,connFailed,batchEmpty,batchUnderflow,batchComplete,eventDrainAttempt,eventDrainSuccess);
  skc.stop();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StopTime",getStopTime(on) != 0L);
  assertSkCounterState(on,connCreated,connClosed,connFailed,batchEmpty,batchUnderflow,batchComplete,eventDrainAttempt,eventDrainSuccess);
  Thread.sleep(5L);
  skc.start();
  Assert.assertTrue("StartTime",getStartTime(on) != 0L);
  Assert.assertTrue("StartTime",getStartTime(on) > start1);
  Assert.assertTrue("StopTime",getStopTime(on) == 0L);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,0L,0L);
  int eventDrainAttempt2=random.nextInt(MAX_BOUNDS);
  int eventDrainSuccess2=random.nextInt(MAX_BOUNDS);
  skc.addToEventDrainAttemptCount(eventDrainAttempt2);
  skc.addToEventDrainSuccessCount(eventDrainSuccess2);
  assertSkCounterState(on,0L,0L,0L,0L,0L,0L,eventDrainAttempt2,eventDrainSuccess2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.interceptor.TestTimestampInterceptor </h4><pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that the "timestamp" header gets set (to something)
 */
@Test public void testBasic() throws ClassNotFoundException, InstantiationException, IllegalAccessException {
  InterceptorBuilderFactory factory=new InterceptorBuilderFactory();
  Interceptor.Builder builder=InterceptorBuilderFactory.newInstance(InterceptorType.TIMESTAMP.toString());
  Interceptor interceptor=builder.build();
  Event event=EventBuilder.withBody("test event",Charsets.UTF_8);
  Assert.assertNull(event.getHeaders().get(Constants.TIMESTAMP));
  Long now=System.currentTimeMillis();
  event=interceptor.intercept(event);
  String timestampStr=event.getHeaders().get(Constants.TIMESTAMP);
  Assert.assertNotNull(timestampStr);
  Assert.assertTrue(Long.parseLong(timestampStr) >= now);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure timestamp is NOT overwritten when preserveExistingTimestamp == true
 */
@Test public void testPreserve() throws ClassNotFoundException, InstantiationException, IllegalAccessException {
  Context ctx=new Context();
  ctx.put("preserveExisting","true");
  InterceptorBuilderFactory factory=new InterceptorBuilderFactory();
  Interceptor.Builder builder=InterceptorBuilderFactory.newInstance(InterceptorType.TIMESTAMP.toString());
  builder.configure(ctx);
  Interceptor interceptor=builder.build();
  long originalTs=1L;
  Event event=EventBuilder.withBody("test event",Charsets.UTF_8);
  event.getHeaders().put(Constants.TIMESTAMP,Long.toString(originalTs));
  Assert.assertEquals(Long.toString(originalTs),event.getHeaders().get(Constants.TIMESTAMP));
  Long now=System.currentTimeMillis();
  event=interceptor.intercept(event);
  String timestampStr=event.getHeaders().get(Constants.TIMESTAMP);
  Assert.assertNotNull(timestampStr);
  Assert.assertTrue(Long.parseLong(timestampStr) == originalTs);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure timestamp IS overwritten when preserveExistingTimestamp == false
 */
@Test public void testClobber() throws ClassNotFoundException, InstantiationException, IllegalAccessException {
  Context ctx=new Context();
  ctx.put("preserveExisting","false");
  InterceptorBuilderFactory factory=new InterceptorBuilderFactory();
  Interceptor.Builder builder=InterceptorBuilderFactory.newInstance(InterceptorType.TIMESTAMP.toString());
  builder.configure(ctx);
  Interceptor interceptor=builder.build();
  long originalTs=1L;
  Event event=EventBuilder.withBody("test event",Charsets.UTF_8);
  event.getHeaders().put(Constants.TIMESTAMP,Long.toString(originalTs));
  Assert.assertEquals(Long.toString(originalTs),event.getHeaders().get(Constants.TIMESTAMP));
  Long now=System.currentTimeMillis();
  event=interceptor.intercept(event);
  String timestampStr=event.getHeaders().get(Constants.TIMESTAMP);
  Assert.assertNotNull(timestampStr);
  Assert.assertTrue(Long.parseLong(timestampStr) >= now);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.lifecycle.TestLifecycleController </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWaitForState() throws LifecycleException, InterruptedException {
  LifecycleAware delegate=new SleeperLifecycleDelegate();
  Assert.assertTrue(delegate.getLifecycleState().equals(LifecycleState.IDLE));
  delegate.start();
  boolean reached=LifecycleController.waitForState(delegate,LifecycleState.START,2000);
  Assert.assertEquals(true,reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
  delegate.stop();
  reached=LifecycleController.waitForState(delegate,LifecycleState.STOP,2000);
  Assert.assertEquals(true,reached);
  Assert.assertEquals(LifecycleState.STOP,delegate.getLifecycleState());
  delegate.start();
  reached=LifecycleController.waitForState(delegate,LifecycleState.IDLE,500);
  Assert.assertEquals(false,reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWaitForOneOf() throws LifecycleException, InterruptedException {
  LifecycleAware delegate=new SleeperLifecycleDelegate();
  Assert.assertEquals(LifecycleState.IDLE,delegate.getLifecycleState());
  delegate.start();
  boolean reached=LifecycleController.waitForOneOf(delegate,new LifecycleState[]{LifecycleState.STOP,LifecycleState.START},2000);
  Assert.assertTrue("Matched a state change",reached);
  Assert.assertEquals(LifecycleState.START,delegate.getLifecycleState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.node.TestAbstractConfigurationProvider </h4><pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSinkThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType="seq";
  String channelType="memory";
  String sinkType=UnconfigurableSink.class.getName();
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 1);
  Assert.assertTrue(config.getChannels().size() == 1);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testChannelThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType="seq";
  String channelType=UnconfigurableChannel.class.getName();
  String sinkType="null";
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 0);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSourceThrowsExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType=UnconfigurableSource.class.getName();
  String channelType="memory";
  String sinkType="null";
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 1);
  Assert.assertTrue(config.getSinkRunners().size() == 1);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnspecifiedChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,UnspecifiedChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof UnspecifiedChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof UnspecifiedChannel);
  Assert.assertSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusableChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,RecyclableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof RecyclableChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof RecyclableChannel);
  Assert.assertSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDispoableChannel() throws Exception {
  String agentName="agent1";
  Map<String,String> properties=getPropertiesForChannel(agentName,DisposableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof DisposableChannel);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof DisposableChannel);
  Assert.assertNotSame(channel1,channel2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReusableChannelNotReusedLater() throws Exception {
  String agentName="agent1";
  Map<String,String> propertiesReusable=getPropertiesForChannel(agentName,RecyclableChannel.class.getName());
  Map<String,String> propertiesDispoable=getPropertiesForChannel(agentName,DisposableChannel.class.getName());
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,propertiesReusable);
  MaterializedConfiguration config1=provider.getConfiguration();
  Channel channel1=config1.getChannels().values().iterator().next();
  Assert.assertTrue(channel1 instanceof RecyclableChannel);
  provider.setProperties(propertiesDispoable);
  MaterializedConfiguration config2=provider.getConfiguration();
  Channel channel2=config2.getChannels().values().iterator().next();
  Assert.assertTrue(channel2 instanceof DisposableChannel);
  provider.setProperties(propertiesReusable);
  MaterializedConfiguration config3=provider.getConfiguration();
  Channel channel3=config3.getChannels().values().iterator().next();
  Assert.assertTrue(channel3 instanceof RecyclableChannel);
  Assert.assertNotSame(channel1,channel3);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSourceAndSinkThrowExceptionDuringConfiguration() throws Exception {
  String agentName="agent1";
  String sourceType=UnconfigurableSource.class.getName();
  String channelType="memory";
  String sinkType=UnconfigurableSink.class.getName();
  Map<String,String> properties=getProperties(agentName,sourceType,channelType,sinkType);
  MemoryConfigurationProvider provider=new MemoryConfigurationProvider(agentName,properties);
  MaterializedConfiguration config=provider.getConfiguration();
  Assert.assertTrue(config.getSourceRunners().size() == 0);
  Assert.assertTrue(config.getChannels().size() == 0);
  Assert.assertTrue(config.getSinkRunners().size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.node.TestPollingZooKeeperConfigurationProvider </h4><pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPolling() throws Exception {
  es.awaitEvent();
  es.reset();
  FlumeConfiguration fc=cp.getFlumeConfiguration();
  Assert.assertTrue(fc.getConfigurationErrors().isEmpty());
  AgentConfiguration ac=fc.getConfigurationFor(AGENT_NAME);
  Assert.assertNull(ac);
  addData();
  es.awaitEvent();
  es.reset();
  verifyProperties(cp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.serialization.TestDurablePositionTracker </h4><pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGoodTrackerFile() throws IOException, URISyntaxException {
  String fileName="/TestResettableFileInputStream_1.avro";
  File trackerFile=new File(getClass().getResource(fileName).toURI());
  Assert.assertTrue(trackerFile.exists());
  PositionTracker tracker;
  tracker=new DurablePositionTracker(trackerFile,"foo");
  Assert.assertEquals(62,tracker.getPosition());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialTrackerFile() throws IOException, URISyntaxException {
  String fileName="/TestResettableFileInputStream_1.truncated.avro";
  File trackerFile=new File(getClass().getResource(fileName).toURI());
  Assert.assertTrue(trackerFile.exists());
  PositionTracker tracker;
  tracker=new DurablePositionTracker(trackerFile,"foo");
  Assert.assertEquals(25,tracker.getPosition());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.serialization.TestResettableFileInputStream </h4><pre class="type-13 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testUtf8DecodeErrorHandlingReplace() throws IOException {
  ResettableInputStream in=initUtf8DecodeTest(DecodeErrorPolicy.REPLACE);
  int c;
  StringBuilder sb=new StringBuilder();
  while ((c=in.readChar()) != -1) {
    sb.append((char)c);
  }
  String preJdk8ExpectedStr="Latin1: (X)\nLong: (XXX)\nNonUnicode: (X)\n";
  String expectedStr="Latin1: (X)\nLong: (XXX)\nNonUnicode: (XXXXX)\n";
  String javaVersionStr=System.getProperty("java.version");
  double javaVersion=Double.parseDouble(javaVersionStr.substring(0,3));
  if (javaVersion < 1.8) {
    assertTrue(preJdk8ExpectedStr.replaceAll("X","\ufffd").equals(sb.toString()));
  }
 else {
    assertTrue(expectedStr.replaceAll("X","\ufffd").equals(sb.toString()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestAvroSink </h4><pre class="type-13 type-11 type-10 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslSinkWithNonSslServer() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  Server server=createServer(new MockAvroServer());
  server.start();
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("trust-all-certs",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  Configurables.configure(sink,context);
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  boolean failed=false;
  try {
    for (int i=0; i < 5; i++) {
      sink.process();
      failed=true;
    }
  }
 catch (  EventDeliveryException ex) {
    logger.info("Correctly failed to send event",ex);
  }
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
  if (failed) {
    Assert.fail("SSL-enabled sink successfully connected to a non-SSL-enabled server, that's wrong.");
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslWithCompression() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp("deflate",6);
  boolean bound=false;
  AvroSource source;
  Channel sourceChannel;
  int selectedPort;
  source=new AvroSource();
  sourceChannel=new MemoryChannel();
  Configurables.configure(sourceChannel,new Context());
  List<Channel> channels=new ArrayList<Channel>();
  channels.add(sourceChannel);
  ChannelSelector rcs=new ReplicatingChannelSelector();
  rcs.setChannels(channels);
  source.setChannelProcessor(new ChannelProcessor(rcs));
  Context context=new Context();
  context.put("port",port.toString());
  context.put("bind",hostname);
  context.put("threads","50");
  context.put("compression-type","deflate");
  context.put("ssl",String.valueOf(true));
  context.put("keystore","src/test/resources/server.p12");
  context.put("keystore-password","password");
  context.put("keystore-type","PKCS12");
  Configurables.configure(source,context);
  source.start();
  Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
  Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
  Event event=EventBuilder.withBody("Hello avro",Charset.forName("UTF8"));
  context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("trust-all-certs",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  context.put("compression-type","deflate");
  context.put("compression-level",Integer.toString(6));
  Configurables.configure(sink,context);
  sink.start();
  Transaction sickTransaction=channel.getTransaction();
  sickTransaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  sickTransaction.commit();
  sickTransaction.close();
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    logger.debug("Calling Process " + i + " times:"+ status);
    Assert.assertEquals(Sink.Status.READY,status);
  }
  sink.stop();
  Transaction sourceTransaction=sourceChannel.getTransaction();
  sourceTransaction.begin();
  Event sourceEvent=sourceChannel.take();
  Assert.assertNotNull(sourceEvent);
  Assert.assertEquals("Channel contained our event","Hello avro",new String(sourceEvent.getBody()));
  sourceTransaction.commit();
  sourceTransaction.close();
  logger.debug("Round trip event:{}",sourceEvent);
  source.stop();
  Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
  Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslProcess() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  Server server=createSslServer(new MockAvroServer());
  server.start();
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("trust-all-certs",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  Configurables.configure(sink,context);
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    Assert.assertEquals(Sink.Status.READY,status);
  }
  Assert.assertEquals(Sink.Status.BACKOFF,sink.process());
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  Server server=createServer(new MockAvroServer());
  server.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    Assert.assertEquals(Sink.Status.READY,status);
  }
  Assert.assertEquals(Sink.Status.BACKOFF,sink.process());
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslProcessWithTrustStore() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  Server server=createSslServer(new MockAvroServer());
  server.start();
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("truststore","src/test/resources/truststore.jks");
  context.put("truststore-password","password");
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  Configurables.configure(sink,context);
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    Assert.assertEquals(Sink.Status.READY,status);
  }
  Assert.assertEquals(Sink.Status.BACKOFF,sink.process());
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedConnect() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charset.forName("UTF8"));
  Server server=createServer(new MockAvroServer());
  server.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Thread.sleep(500L);
  server.close();
  Thread.sleep(500L);
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  for (int i=0; i < 5; i++) {
    boolean threwException=false;
    try {
      sink.process();
    }
 catch (    EventDeliveryException e) {
      threwException=true;
    }
    Assert.assertTrue("Must throw EventDeliveryException if disconnected",threwException);
  }
  server=createServer(new MockAvroServer());
  server.start();
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    Assert.assertEquals(Sink.Status.READY,status);
  }
  Assert.assertEquals(Sink.Status.BACKOFF,sink.process());
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testReset() throws Exception {
  setUp();
  Server server=createServer(new MockAvroServer());
  server.start();
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  context.put("reset-connection-interval",String.valueOf("5"));
  sink.setChannel(channel);
  Configurables.configure(sink,context);
  sink.start();
  RpcClient firstClient=sink.getUnderlyingClient();
  Thread.sleep(6000);
  Transaction t=channel.getTransaction();
  t.begin();
  channel.put(EventBuilder.withBody("This is a test",Charset.defaultCharset()));
  t.commit();
  t.close();
  sink.process();
  Assert.assertFalse(firstClient == sink.getUnderlyingClient());
  sink.stop();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  context.put("reset-connection-interval",String.valueOf("0"));
  sink.setChannel(channel);
  Configurables.configure(sink,context);
  sink.start();
  firstClient=sink.getUnderlyingClient();
  Thread.sleep(6000);
  Assert.assertTrue(firstClient == sink.getUnderlyingClient());
  sink.stop();
  context.clear();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  sink.setChannel(channel);
  Configurables.configure(sink,context);
  sink.start();
  firstClient=sink.getUnderlyingClient();
  Thread.sleep(6000);
  Assert.assertTrue(firstClient == sink.getUnderlyingClient());
  sink.stop();
  server.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLifecycle() throws InterruptedException, InstantiationException, IllegalAccessException {
  setUp();
  Server server=createServer(new MockAvroServer());
  server.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTimeout() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("foo",Charsets.UTF_8);
  AtomicLong delay=new AtomicLong();
  Server server=createServer(new DelayMockAvroServer(delay));
  server.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 4; i++) {
    channel.put(event);
  }
  txn.commit();
  txn.close();
  delay.set(3000L);
  boolean threw=false;
  try {
    sink.process();
  }
 catch (  EventDeliveryException ex) {
    logger.info("Correctly threw due to connect timeout. Exception follows.",ex);
    threw=true;
  }
  Assert.assertTrue("Must throw due to connect timeout",threw);
  delay.set(0);
  sink.process();
  delay.set(4000L);
  threw=false;
  try {
    sink.process();
  }
 catch (  EventDeliveryException ex) {
    logger.info("Correctly threw due to request timeout. Exception follows.",ex);
    threw=true;
  }
  Assert.assertTrue("Must throw due to request timeout",threw);
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
}

</code></pre>

<br>
<pre class="type-13 type-11 type-10 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslSinkWithNonTrustedCert() throws InterruptedException, EventDeliveryException, InstantiationException, IllegalAccessException {
  setUp();
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  Server server=createSslServer(new MockAvroServer());
  server.start();
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  Configurables.configure(sink,context);
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  boolean failed=false;
  try {
    for (int i=0; i < 5; i++) {
      sink.process();
      failed=true;
    }
  }
 catch (  EventDeliveryException ex) {
    logger.info("Correctly failed to send event",ex);
  }
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  server.close();
  if (failed) {
    Assert.fail("SSL-enabled sink successfully connected to a server with an untrusted certificate when it should have failed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestDefaultSinkFactory </h4><pre class="type-10 type-1 type-14 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCreate(){
  Sink avroSink1=sinkFactory.create("avroSink1","avro");
  Sink avroSink2=sinkFactory.create("avroSink2","avro");
  Assert.assertNotNull(avroSink1);
  Assert.assertNotNull(avroSink2);
  Assert.assertNotSame(avroSink1,avroSink2);
  Assert.assertTrue(avroSink1 instanceof AvroSink);
  Assert.assertTrue(avroSink2 instanceof AvroSink);
  Sink s1=sinkFactory.create("avroSink1","avro");
  Sink s2=sinkFactory.create("avroSink2","avro");
  Assert.assertNotSame(avroSink1,s1);
  Assert.assertNotSame(avroSink2,s2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestLoadBalancingSinkProcessor </h4><pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCustomSelector() throws Exception {
  Channel ch=new MockChannel();
  int n=10;
  int numEvents=n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  s1.setFail(true);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  Context ctx=getContext(FixedOrderSelector.class.getCanonicalName());
  ctx.put("selector." + FixedOrderSelector.SET_ME,"foo");
  LoadBalancingSinkProcessor lbsp=getProcessor(sinks,ctx);
  Sink.Status s=Sink.Status.READY;
  while (s != Sink.Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == 0);
  Assert.assertTrue(s2.getEvents().size() == n);
  Assert.assertTrue(s3.getEvents().size() == 0);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRoundRobinPersistentFailure() throws Exception {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=3 * n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  s2.setFail(true);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("round_robin",sinks,false);
  Status s=Status.READY;
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == n);
  Assert.assertTrue(s2.getEvents().size() == 0);
  Assert.assertTrue(s3.getEvents().size() == 2 * n);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDefaultConfiguration() throws Exception {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=3 * n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor(sinks,new Context());
  Status s=Status.READY;
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == n);
  Assert.assertTrue(s2.getEvents().size() == n);
  Assert.assertTrue(s3.getEvents().size() == n);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRoundRobinOneActiveSink() throws Exception {
  Channel ch=new MockChannel();
  int n=10;
  int numEvents=n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  s1.setFail(true);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  s3.setFail(true);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("round_robin",sinks,false);
  Sink.Status s=Sink.Status.READY;
  while (s != Sink.Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == 0);
  Assert.assertTrue(s2.getEvents().size() == n);
  Assert.assertTrue(s3.getEvents().size() == 0);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRandomPersistentFailure() throws Exception {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=3 * n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  s2.setFail(true);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("random",sinks,false);
  Status s=Status.READY;
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s2.getEvents().size() == 0);
  Assert.assertTrue(s1.getEvents().size() + s3.getEvents().size() == 3 * n);
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomNoFailure() throws Exception {
  Channel ch=new MockChannel();
  int n=10000;
  int numEvents=n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  MockSink s4=new MockSink(4);
  s4.setChannel(ch);
  MockSink s5=new MockSink(5);
  s5.setChannel(ch);
  MockSink s6=new MockSink(6);
  s6.setChannel(ch);
  MockSink s7=new MockSink(7);
  s7.setChannel(ch);
  MockSink s8=new MockSink(8);
  s8.setChannel(ch);
  MockSink s9=new MockSink(9);
  s9.setChannel(ch);
  MockSink s0=new MockSink(0);
  s0.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  sinks.add(s4);
  sinks.add(s5);
  sinks.add(s6);
  sinks.add(s7);
  sinks.add(s8);
  sinks.add(s9);
  sinks.add(s0);
  LoadBalancingSinkProcessor lbsp=getProcessor("random",sinks,false);
  Status s=Status.READY;
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Set<Integer> sizeSet=new HashSet<Integer>();
  int sum=0;
  for (  Sink ms : sinks) {
    int count=((MockSink)ms).getEvents().size();
    sum+=count;
    sizeSet.add(count);
  }
  Assert.assertEquals(n,sum);
  Assert.assertTrue("Miraculous distribution",sizeSet.size() > 1);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRandomOneActiveSink() throws Exception {
  Channel ch=new MockChannel();
  int n=10;
  int numEvents=n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  s1.setFail(true);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  s3.setFail(true);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("random",sinks,false);
  Sink.Status s=Sink.Status.READY;
  while (s != Sink.Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == 0);
  Assert.assertTrue(s2.getEvents().size() == n);
  Assert.assertTrue(s3.getEvents().size() == 0);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRoundRobinNoFailure() throws Exception {
  Channel ch=new MockChannel();
  int n=100;
  int numEvents=3 * n;
  for (int i=0; i < numEvents; i++) {
    ch.put(new MockEvent("test" + i));
  }
  MockSink s1=new MockSink(1);
  s1.setChannel(ch);
  MockSink s2=new MockSink(2);
  s2.setChannel(ch);
  MockSink s3=new MockSink(3);
  s3.setChannel(ch);
  List<Sink> sinks=new ArrayList<Sink>();
  sinks.add(s1);
  sinks.add(s2);
  sinks.add(s3);
  LoadBalancingSinkProcessor lbsp=getProcessor("round_robin",sinks,false);
  Status s=Status.READY;
  while (s != Status.BACKOFF) {
    s=lbsp.process();
  }
  Assert.assertTrue(s1.getEvents().size() == n);
  Assert.assertTrue(s2.getEvents().size() == n);
  Assert.assertTrue(s3.getEvents().size() == n);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.TestThriftSink </h4><pre class="type-13 type-11 type-10 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslSinkWithNonSslServer() throws Exception {
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  src=new ThriftTestingSource(ThriftTestingSource.HandlerType.OK.name(),port,ThriftRpcClient.COMPACT_PROTOCOL);
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  context.put("truststore","src/test/resources/truststorefile.jks");
  context.put("truststore-password","password");
  context.put("trustmanager-type",TrustManagerFactory.getDefaultAlgorithm());
  Configurables.configure(sink,context);
  channel.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 11; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  boolean failed=false;
  try {
    for (int i=0; i < 6; i++) {
      Sink.Status status=sink.process();
      failed=true;
    }
  }
 catch (  EventDeliveryException ex) {
  }
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  if (failed) {
    Assert.fail("SSL-enabled sink successfully connected to a non-SSL-enabled server, that's wrong.");
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedConnect() throws Exception {
  Event event=EventBuilder.withBody("test event 1",Charset.forName("UTF8"));
  sink.start();
  Thread.sleep(500L);
  Thread.sleep(500L);
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 10; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  for (int i=0; i < 5; i++) {
    boolean threwException=false;
    try {
      sink.process();
    }
 catch (    EventDeliveryException e) {
      threwException=true;
    }
    Assert.assertTrue("Must throw EventDeliveryException if disconnected",threwException);
  }
  src=new ThriftTestingSource(ThriftTestingSource.HandlerType.OK.name(),port,ThriftRpcClient.COMPACT_PROTOCOL);
  for (int i=0; i < 5; i++) {
    Sink.Status status=sink.process();
    Assert.assertEquals(Sink.Status.READY,status);
  }
  Assert.assertEquals(Sink.Status.BACKOFF,sink.process());
  sink.stop();
}

</code></pre>

<br>
<pre class="type-13 type-11 type-10 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslSinkWithNonTrustedCert() throws Exception {
  Event event=EventBuilder.withBody("test event 1",Charsets.UTF_8);
  src=new ThriftTestingSource(ThriftTestingSource.HandlerType.OK.name(),port,ThriftRpcClient.COMPACT_PROTOCOL,"src/test/resources/keystorefile.jks","password",KeyManagerFactory.getDefaultAlgorithm(),"JKS");
  Context context=new Context();
  context.put("hostname",hostname);
  context.put("port",String.valueOf(port));
  context.put("ssl",String.valueOf(true));
  context.put("batch-size",String.valueOf(2));
  context.put("connect-timeout",String.valueOf(2000L));
  context.put("request-timeout",String.valueOf(3000L));
  Configurables.configure(sink,context);
  channel.start();
  sink.start();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.START_OR_ERROR,5000));
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  for (int i=0; i < 11; i++) {
    channel.put(event);
  }
  transaction.commit();
  transaction.close();
  boolean failed=false;
  try {
    for (int i=0; i < 6; i++) {
      Sink.Status status=sink.process();
      failed=true;
    }
  }
 catch (  EventDeliveryException ex) {
  }
  sink.stop();
  Assert.assertTrue(LifecycleController.waitForOneOf(sink,LifecycleState.STOP_OR_ERROR,5000));
  if (failed) {
    Assert.fail("SSL-enabled sink successfully connected to a server with an untrusted certificate when it should have failed");
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTimeout() throws Exception {
  AtomicLong delay=new AtomicLong();
  src=new ThriftTestingSource(ThriftTestingSource.HandlerType.ALTERNATE.name(),port,ThriftRpcClient.COMPACT_PROTOCOL);
  src.setDelay(delay);
  delay.set(2500);
  Event event=EventBuilder.withBody("foo",Charsets.UTF_8);
  sink.start();
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 4; i++) {
    channel.put(event);
  }
  txn.commit();
  txn.close();
  boolean threw=false;
  try {
    sink.process();
  }
 catch (  EventDeliveryException ex) {
    threw=true;
  }
  Assert.assertTrue("Must throw due to connect timeout",threw);
  delay.set(0);
  sink.process();
  delay.set(2500L);
  threw=false;
  try {
    sink.process();
  }
 catch (  EventDeliveryException ex) {
    threw=true;
  }
  Assert.assertTrue("Must throw due to request timeout",threw);
  sink.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.TestElasticSearchIndexRequestBuilderFactory </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void shouldConfigureEventSerializer() throws Exception {
  assertFalse(serializer.configuredWithContext);
  factory.configure(new Context());
  assertTrue(serializer.configuredWithContext);
  assertFalse(serializer.configuredWithComponentConfiguration);
  factory.configure(new SinkConfiguration("name"));
  assertTrue(serializer.configuredWithComponentConfiguration);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.TestElasticSearchSink </h4><pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldUseSpecifiedIndexNameBuilder() throws Exception {
  Context context=new Context();
  context.put(ElasticSearchSinkConstants.INDEX_NAME_BUILDER,"org.apache.flume.sink.elasticsearch.FakeIndexNameBuilder");
  assertNull(fixture.getIndexNameBuilder());
  fixture.configure(context);
  assertTrue(fixture.getIndexNameBuilder() instanceof FakeIndexNameBuilder);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldUseSpecifiedSerializer() throws Exception {
  Context context=new Context();
  context.put(SERIALIZER,"org.apache.flume.sink.elasticsearch.FakeEventSerializer");
  assertNull(fixture.getEventSerializer());
  fixture.configure(context);
  assertTrue(fixture.getEventSerializer() instanceof FakeEventSerializer);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldAllowCustomElasticSearchIndexRequestBuilderFactory() throws Exception {
  parameters.put(SERIALIZER,CustomElasticSearchIndexRequestBuilderFactory.class.getName());
  fixture.configure(new Context(parameters));
  Channel channel=bindAndStartChannel(fixture);
  Transaction tx=channel.getTransaction();
  tx.begin();
  String body="{ foo: \"bar\" }";
  Event event=EventBuilder.withBody(body.getBytes());
  channel.put(event);
  tx.commit();
  tx.close();
  fixture.process();
  fixture.stop();
  assertEquals(fixture.getIndexName() + "-05_17_36_789",CustomElasticSearchIndexRequestBuilderFactory.actualIndexName);
  assertEquals(fixture.getIndexType(),CustomElasticSearchIndexRequestBuilderFactory.actualIndexType);
  assertArrayEquals(event.getBody(),CustomElasticSearchIndexRequestBuilderFactory.actualEventBody);
  assertTrue(CustomElasticSearchIndexRequestBuilderFactory.hasContext);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.elasticsearch.client.TestElasticSearchRestClient </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldAddNewEventWithTTL() throws Exception {
  ArgumentCaptor<HttpPost> argument=ArgumentCaptor.forClass(HttpPost.class);
  when(httpStatus.getStatusCode()).thenReturn(HttpStatus.SC_OK);
  when(httpResponse.getStatusLine()).thenReturn(httpStatus);
  when(httpClient.execute(any(HttpUriRequest.class))).thenReturn(httpResponse);
  fixture.addEvent(event,nameBuilder,"bar_type",123);
  fixture.execute();
  verify(httpClient).execute(isA(HttpUriRequest.class));
  verify(httpClient).execute(argument.capture());
  assertEquals("http://host1/_bulk",argument.getValue().getURI().toString());
  assertTrue(verifyJsonEvents("{\"index\":{\"_type\":\"bar_type\",\"_index\":\"foo_index\",\"_ttl\":\"123\"}}\n",MESSAGE_CONTENT,EntityUtils.toString(argument.getValue().getEntity())));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shouldAddNewEventWithoutTTL() throws Exception {
  ArgumentCaptor<HttpPost> argument=ArgumentCaptor.forClass(HttpPost.class);
  when(httpStatus.getStatusCode()).thenReturn(HttpStatus.SC_OK);
  when(httpResponse.getStatusLine()).thenReturn(httpStatus);
  when(httpClient.execute(any(HttpUriRequest.class))).thenReturn(httpResponse);
  fixture.addEvent(event,nameBuilder,"bar_type",-1);
  fixture.execute();
  verify(httpClient).execute(isA(HttpUriRequest.class));
  verify(httpClient).execute(argument.capture());
  assertEquals("http://host1/_bulk",argument.getValue().getURI().toString());
  assertTrue(verifyJsonEvents("{\"index\":{\"_type\":\"bar_type\", \"_index\":\"foo_index\"}}\n",MESSAGE_CONTENT,EntityUtils.toString(argument.getValue().getEntity())));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hbase.TestAsyncHBaseSink </h4><pre class="type-9 type-10 type-1 type-3 type-8 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This test must run last - it shuts down the minicluster :D
 * @throws Exception
 */
@Ignore("For dev builds only:" + "This test takes too long, and this has to be run after all other" + "tests, since it shuts down the minicluster. "+ "Comment out all other tests"+ "and uncomment this annotation to run this test.") @Test(expected=EventDeliveryException.class) public void testHBaseFailure() throws Exception {
  ctx.put("batchSize","2");
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=false;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  Assert.assertFalse(sink.isConfNull());
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  testUtility.shutdownMiniCluster();
  sink.process();
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneEventWithDefaults() throws Exception {
  Map<String,String> ctxMap=new HashMap<String,String>();
  ctxMap.put("table",tableName);
  ctxMap.put("columnFamily",columnFamily);
  ctxMap.put("serializer","org.apache.flume.sink.hbase.SimpleAsyncHbaseEventSerializer");
  ctxMap.put("keep-alive","0");
  ctxMap.put("timeout","10000");
  Context tmpctx=new Context();
  tmpctx.putAll(ctxMap);
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,tmpctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,tmpctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=EventDeliveryException.class) public void testTimeOut() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration(),true,false);
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  channel.start();
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFDLeakOnShutdown() throws Exception {
  if (getOpenFileDescriptorCount() < 0) {
    return;
  }
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration(),true,false);
  ctx.put("maxConsecutiveFails","1");
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  channel.start();
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  long initialFDCount=getOpenFileDescriptorCount();
  for (int i=0; i < 10; i++) {
    try {
      sink.process();
    }
 catch (    EventDeliveryException ex) {
    }
  }
  long increaseInFD=getOpenFileDescriptorCount() - initialFDCount;
  Assert.assertTrue("File Descriptor leak detected. FDs have increased by " + increaseInFD + " from an initial FD count of "+ initialFDCount,increaseInFD < 50);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeEvents() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleBatches() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  ctx.put("batchSize","2");
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  int count=0;
  Status status=Status.READY;
  while (status != Status.BACKOFF) {
    count++;
    status=sink.process();
  }
  Assert.assertFalse(sink.isConfNull());
  sink.stop();
  Assert.assertEquals(2,count);
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneEvent() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  Event e=EventBuilder.withBody(Bytes.toBytes(valBase));
  channel.put(e);
  tx.commit();
  tx.close();
  Assert.assertFalse(sink.isConfNull());
  sink.process();
  sink.stop();
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,1);
  byte[] out=results[0];
  Assert.assertArrayEquals(e.getBody(),out);
  out=results[1];
  Assert.assertArrayEquals(Longs.toByteArray(1),out);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FlumeException.class) public void testMissingTable() throws Exception {
  deleteTable=false;
  ctx.put("batchSize","2");
  AsyncHBaseSink sink=new AsyncHBaseSink(testUtility.getConfiguration());
  Configurables.configure(sink,ctx);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  sink.process();
  Assert.assertFalse(sink.isConfNull());
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,2);
  byte[] out;
  int found=0;
  for (int i=0; i < 2; i++) {
    for (int j=0; j < 2; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(2,found);
  out=results[2];
  Assert.assertArrayEquals(Longs.toByteArray(2),out);
  sink.process();
  sink.stop();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithoutConfigurationObject() throws Exception {
  testUtility.createTable(tableName.getBytes(),columnFamily.getBytes());
  deleteTable=true;
  ctx.put("batchSize","2");
  ctx.put(HBaseSinkConfigurationConstants.ZK_QUORUM,ZKConfig.getZKQuorumServersString(testUtility.getConfiguration()));
  ctx.put(HBaseSinkConfigurationConstants.ZK_ZNODE_PARENT,testUtility.getConfiguration().get(HConstants.ZOOKEEPER_ZNODE_PARENT));
  AsyncHBaseSink sink=new AsyncHBaseSink();
  Configurables.configure(sink,ctx);
  ctx.put(HBaseSinkConfigurationConstants.ZK_QUORUM,null);
  ctx.put(HBaseSinkConfigurationConstants.ZK_ZNODE_PARENT,null);
  ctx.put("batchSize","100");
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,ctx);
  sink.setChannel(channel);
  sink.start();
  Transaction tx=channel.getTransaction();
  tx.begin();
  for (int i=0; i < 3; i++) {
    Event e=EventBuilder.withBody(Bytes.toBytes(valBase + "-" + i));
    channel.put(e);
  }
  tx.commit();
  tx.close();
  int count=0;
  Status status=Status.READY;
  while (status != Status.BACKOFF) {
    count++;
    status=sink.process();
  }
  Assert.assertTrue(sink.isConfNull());
  sink.stop();
  Assert.assertEquals(2,count);
  HTable table=new HTable(testUtility.getConfiguration(),tableName);
  byte[][] results=getResults(table,3);
  byte[] out;
  int found=0;
  for (int i=0; i < 3; i++) {
    for (int j=0; j < 3; j++) {
      if (Arrays.equals(results[j],Bytes.toBytes(valBase + "-" + i))) {
        found++;
        break;
      }
    }
  }
  Assert.assertEquals(3,found);
  out=results[3];
  Assert.assertArrayEquals(Longs.toByteArray(3),out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hbase.TestRegexHbaseEventSerializer </h4><pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApacheRegex() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.REGEX_CONFIG,"([^ ]*) ([^ ]*) ([^ ]*) (-|\\[[^\\]]*\\]) \"([^ ]+) ([^ ]+)" + " ([^\"]+)\" (-|[0-9]*) (-|[0-9]*)(?: ([^ \"]*|\"[^\"]*\")" + " ([^ \"]*|\"[^\"]*\"))?");
  context.put(RegexHbaseEventSerializer.COL_NAME_CONFIG,"host,identity,user,time,method,request,protocol,status,size," + "referer,agent");
  s.configure(context);
  String logMsg="33.22.11.00 - - [20/May/2011:07:01:19 +0000] " + "\"GET /wp-admin/css/install.css HTTP/1.0\" 200 813 " + "\"http://www.cloudera.com/wp-admin/install.php\" \"Mozilla/5.0 (comp"+ "atible; Yahoo! Slurp; http://help.yahoo.com/help/us/ysearch/slurp)\"";
  Event e=EventBuilder.withBody(Bytes.toBytes(logMsg));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertEquals(1,s.getActions().size());
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 11);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertEquals("33.22.11.00",resultMap.get("host"));
  assertEquals("-",resultMap.get("identity"));
  assertEquals("-",resultMap.get("user"));
  assertEquals("[20/May/2011:07:01:19 +0000]",resultMap.get("time"));
  assertEquals("GET",resultMap.get("method"));
  assertEquals("/wp-admin/css/install.css",resultMap.get("request"));
  assertEquals("HTTP/1.0",resultMap.get("protocol"));
  assertEquals("200",resultMap.get("status"));
  assertEquals("813",resultMap.get("size"));
  assertEquals("\"http://www.cloudera.com/wp-admin/install.php\"",resultMap.get("referer"));
  assertEquals("\"Mozilla/5.0 (compatible; Yahoo! Slurp; " + "http://help.yahoo.com/help/us/ysearch/slurp)\"",resultMap.get("agent"));
  List<Increment> increments=s.getIncrements();
  assertEquals(0,increments.size());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowIndexKey() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.REGEX_CONFIG,"^([^\t]+)\t([^\t]+)\t" + "([^\t]+)$");
  context.put(RegexHbaseEventSerializer.COL_NAME_CONFIG,"col1,col2,ROW_KEY");
  context.put("rowKeyIndex","2");
  s.configure(context);
  String body="val1\tval2\trow1";
  Event e=EventBuilder.withBody(Bytes.toBytes(body));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  Put put=(Put)actions.get(0);
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 2);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertEquals("val1",resultMap.get("col1"));
  assertEquals("val2",resultMap.get("col2"));
  assertEquals("row1",Bytes.toString(put.getRow()));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDepositHeaders() throws Exception {
  Charset charset=Charset.forName("KOI8-R");
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  context.put(RegexHbaseEventSerializer.DEPOSIT_HEADERS_CONFIG,"true");
  context.put(RegexHbaseEventSerializer.CHARSET_CONFIG,charset.toString());
  s.configure(context);
  String body="body";
  Map<String,String> headers=Maps.newHashMap();
  headers.put("header1","value1");
  headers.put("2","2");
  Event e=EventBuilder.withBody(Bytes.toBytes(body),headers);
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertEquals(1,s.getActions().size());
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 3);
  Map<String,byte[]> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier(),charset),kv.getValue());
  }
  assertEquals(body,new String(resultMap.get(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT),charset));
  assertEquals("value1",new String(resultMap.get("header1"),charset));
  assertArrayEquals("2".getBytes(charset),resultMap.get("2"));
  assertEquals("2".length(),resultMap.get("2").length);
  List<Increment> increments=s.getIncrements();
  assertEquals(0,increments.size());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-18 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultBehavior() throws Exception {
  RegexHbaseEventSerializer s=new RegexHbaseEventSerializer();
  Context context=new Context();
  s.configure(context);
  String logMsg="The sky is falling!";
  Event e=EventBuilder.withBody(Bytes.toBytes(logMsg));
  s.initialize(e,"CF".getBytes());
  List<Row> actions=s.getActions();
  assertTrue(actions.size() == 1);
  assertTrue(actions.get(0) instanceof Put);
  Put put=(Put)actions.get(0);
  assertTrue(put.getFamilyMap().containsKey(s.cf));
  List<KeyValue> kvPairs=put.getFamilyMap().get(s.cf);
  assertTrue(kvPairs.size() == 1);
  Map<String,String> resultMap=Maps.newHashMap();
  for (  KeyValue kv : kvPairs) {
    resultMap.put(new String(kv.getQualifier()),new String(kv.getValue()));
  }
  assertTrue(resultMap.containsKey(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT));
  assertEquals("The sky is falling!",resultMap.get(RegexHbaseEventSerializer.COLUMN_NAME_DEFAULT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestBucketWriter </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCallbackOnClose() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String SUFFIX="WELCOME_TO_THE_EREBOR";
  final AtomicBoolean callbackCalled=new AtomicBoolean(false);
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",SUFFIX,null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,new HDFSEventSink.WriterCallback(){
    @Override public void run(    String filePath){
      callbackCalled.set(true);
    }
  }
,"blah",30000,Executors.newSingleThreadExecutor(),0,0);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  bucketWriter.close(true);
  Assert.assertTrue(callbackCalled.get());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalRoller() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1;
  final int NUM_EVENTS=10;
  final AtomicBoolean calledBack=new AtomicBoolean(false);
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,new HDFSEventSink.WriterCallback(){
    @Override public void run(    String filePath){
      calledBack.set(true);
    }
  }
,null,30000,Executors.newSingleThreadExecutor(),0,0);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  long startNanos=System.nanoTime();
  for (int i=0; i < NUM_EVENTS - 1; i++) {
    bucketWriter.append(e);
  }
  Thread.sleep(2 * ROLL_INTERVAL * 1000L);
  Assert.assertTrue(bucketWriter.closed);
  Assert.assertTrue(calledBack.get());
  bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  bucketWriter.append(e);
  long elapsedMillis=TimeUnit.MILLISECONDS.convert(System.nanoTime() - startNanos,TimeUnit.NANOSECONDS);
  long elapsedSeconds=elapsedMillis / 1000L;
  logger.info("Time elapsed: {} milliseconds",elapsedMillis);
  logger.info("Number of events written: {}",hdfsWriter.getEventsWritten());
  logger.info("Number of bytes written: {}",hdfsWriter.getBytesWritten());
  logger.info("Number of files opened: {}",hdfsWriter.getFilesOpened());
  logger.info("Number of files closed: {}",hdfsWriter.getFilesClosed());
  Assert.assertEquals("events written",NUM_EVENTS,hdfsWriter.getEventsWritten());
  Assert.assertEquals("bytes written",e.getBody().length * NUM_EVENTS,hdfsWriter.getBytesWritten());
  Assert.assertEquals("files opened",2,hdfsWriter.getFilesOpened());
  Assert.assertEquals("files closed",1,hdfsWriter.getFilesClosed());
  logger.info("Waiting for roll...");
  Thread.sleep(2 * ROLL_INTERVAL * 1000L);
  logger.info("Number of files closed: {}",hdfsWriter.getFilesClosed());
  Assert.assertEquals("files closed",2,hdfsWriter.getFilesClosed());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFileSuffixNotGiven() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String suffix=null;
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",suffix,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  final long testTime=System.currentTimeMillis();
  Clock testClock=new Clock(){
    public long currentTimeMillis(){
      return testTime;
    }
  }
;
  bucketWriter.setClock(testClock);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  Assert.assertTrue("Incorrect suffix",hdfsWriter.getOpenedFilePath().endsWith(Long.toString(testTime + 1) + ".tmp"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInUsePrefix() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String PREFIX="BRNO_IS_CITY_IN_CZECH_REPUBLIC";
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  HDFSTextSerializer formatter=new HDFSTextSerializer();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file",PREFIX,".tmp",null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  Assert.assertTrue("Incorrect in use prefix",hdfsWriter.getOpenedFilePath().contains(PREFIX));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInUseSuffix() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String SUFFIX="WELCOME_TO_THE_HELLMOUNTH";
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  HDFSTextSerializer serializer=new HDFSTextSerializer();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",SUFFIX,null,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  Assert.assertTrue("Incorrect in use suffix",hdfsWriter.getOpenedFilePath().contains(SUFFIX));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFileSuffixCompressed() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String suffix=".foo";
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",suffix,HDFSEventSink.getCodec("gzip"),SequenceFile.CompressionType.BLOCK,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  final long testTime=System.currentTimeMillis();
  Clock testClock=new Clock(){
    public long currentTimeMillis(){
      return testTime;
    }
  }
;
  bucketWriter.setClock(testClock);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  Assert.assertTrue("Incorrect suffix",hdfsWriter.getOpenedFilePath().endsWith(Long.toString(testTime + 1) + suffix + ".tmp"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFileSuffixGiven() throws IOException, InterruptedException {
  final int ROLL_INTERVAL=1000;
  final String suffix=".avro";
  MockHDFSWriter hdfsWriter=new MockHDFSWriter();
  BucketWriter bucketWriter=new BucketWriter(ROLL_INTERVAL,0,0,0,ctx,"/tmp","file","",".tmp",suffix,null,SequenceFile.CompressionType.NONE,hdfsWriter,timedRollerPool,proxy,new SinkCounter("test-bucket-writer-" + System.currentTimeMillis()),0,null,null,30000,Executors.newSingleThreadExecutor(),0,0);
  final long testTime=System.currentTimeMillis();
  Clock testClock=new Clock(){
    public long currentTimeMillis(){
      return testTime;
    }
  }
;
  bucketWriter.setClock(testClock);
  Event e=EventBuilder.withBody("foo",Charsets.UTF_8);
  bucketWriter.append(e);
  Assert.assertTrue("Incorrect suffix",hdfsWriter.getOpenedFilePath().endsWith(Long.toString(testTime + 1) + suffix + ".tmp"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSCompressedDataStream </h4><pre class="type-9 type-10 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testGzipDurabilityWithSerializer() throws Exception {
  Context context=new Context();
  context.put("serializer","AVRO_EVENT");
  HDFSCompressedDataStream writer=new HDFSCompressedDataStream();
  writer.configure(context);
  writer.open(fileURI,factory.getCodec(new Path(fileURI)),SequenceFile.CompressionType.BLOCK);
  String[] bodies={"yarf!","yarfing!"};
  writeBodies(writer,bodies);
  int found=0;
  int expected=bodies.length;
  List<String> expectedBodies=Lists.newArrayList(bodies);
  GZIPInputStream cmpIn=new GZIPInputStream(new FileInputStream(file));
  DatumReader<GenericRecord> reader=new GenericDatumReader<GenericRecord>();
  DataFileStream<GenericRecord> avroStream=new DataFileStream<GenericRecord>(cmpIn,reader);
  GenericRecord record=new GenericData.Record(avroStream.getSchema());
  while (avroStream.hasNext()) {
    avroStream.next(record);
    CharsetDecoder decoder=Charsets.UTF_8.newDecoder();
    String bodyStr=decoder.decode((ByteBuffer)record.get("body")).toString();
    expectedBodies.remove(bodyStr);
    found++;
  }
  avroStream.close();
  cmpIn.close();
  Assert.assertTrue("Found = " + found + ", Expected = "+ expected+ ", Left = "+ expectedBodies.size()+ " "+ expectedBodies,expectedBodies.size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSEventSink </h4><pre class="type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerbFileAccess() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting testKerbFileAccess() ...");
  final String fileName="FlumeData";
  final long rollCount=5;
  final long batchSize=2;
  String newPath=testPath + "/singleBucket";
  String kerbConfPrincipal="user1/localhost@EXAMPLE.COM";
  String kerbKeytab="/usr/lib/flume/nonexistkeytabfile";
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(rollCount));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.kerberosPrincipal",kerbConfPrincipal);
  context.put("hdfs.kerberosKeytab",kerbKeytab);
  try {
    Configurables.configure(sink,context);
    Assert.fail("no exception thrown");
  }
 catch (  IllegalArgumentException expected) {
    Assert.assertTrue(expected.getMessage().contains("Keytab is not a readable file"));
  }
 finally {
    conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"simple");
    UserGroupInformation.setConfiguration(conf);
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseOnIdle() throws IOException, EventDeliveryException, InterruptedException {
  String hdfsPath=testPath + "/idleClose";
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(hdfsPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",hdfsPath);
  context.put("hdfs.rollCount","0");
  context.put("hdfs.rollSize","0");
  context.put("hdfs.rollInterval","0");
  context.put("hdfs.batchSize","2");
  context.put("hdfs.idleTimeout","1");
  Configurables.configure(sink,context);
  Channel channel=new MemoryChannel();
  Configurables.configure(channel,context);
  sink.setChannel(channel);
  sink.start();
  Transaction txn=channel.getTransaction();
  txn.begin();
  for (int i=0; i < 10; i++) {
    Event event=new SimpleEvent();
    event.setBody(("test event " + i).getBytes());
    channel.put(event);
  }
  txn.commit();
  txn.close();
  sink.process();
  sink.process();
  Thread.sleep(1001);
  sink.process();
  sink.process();
  Thread.sleep(500);
  sink.process();
  sink.process();
  sink.stop();
  FileStatus[] dirStat=fs.listStatus(dirPath);
  Path[] fList=FileUtil.stat2Paths(dirStat);
  Assert.assertEquals("Incorrect content of the directory " + StringUtils.join(fList,","),2,fList.length);
  Assert.assertTrue(!fList[0].getName().endsWith(".tmp") && !fList[1].getName().endsWith(".tmp"));
  fs.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test that the old bucket writer is closed at the end of rollInterval and
 * a new one is used for the next set of events.
 */
@Test public void testCloseReopenOnRollTime() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting...");
  final int numBatches=4;
  final String fileName="FlumeData";
  final long batchSize=2;
  String newPath=testPath + "/singleBucket";
  int i=1, j=1;
  HDFSTestWriterFactory badWriterFactory=new HDFSTestWriterFactory();
  sink=new HDFSEventSink(badWriterFactory);
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(newPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(0));
  context.put("hdfs.rollSize",String.valueOf(0));
  context.put("hdfs.rollInterval",String.valueOf(2));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.fileType",HDFSTestWriterFactory.TestSequenceFileType);
  Configurables.configure(sink,context);
  MemoryChannel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  for (i=1; i < numBatches; i++) {
    channel.getTransaction().begin();
    try {
      for (j=1; j <= batchSize; j++) {
        Event event=new SimpleEvent();
        eventDate.clear();
        eventDate.set(2011,i,i,i,0);
        event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
        event.getHeaders().put("hostname","Host" + i);
        String body="Test." + i + "."+ j;
        event.setBody(body.getBytes());
        bodies.add(body);
        event.getHeaders().put("count-check","");
        channel.put(event);
      }
      channel.getTransaction().commit();
    }
  finally {
      channel.getTransaction().close();
    }
    LOG.info("execute sink to process the events: " + sink.process());
    if (i == 1) {
      Thread.sleep(2001);
    }
  }
  LOG.info("clear any events pending due to errors: " + sink.process());
  sink.stop();
  Assert.assertTrue(badWriterFactory.openCount.get() >= 2);
  LOG.info("Total number of bucket writers opened: {}",badWriterFactory.openCount.get());
  verifyOutputSequenceFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test that a close due to roll interval removes the bucketwriter from
 * sfWriters map.
 */
@Test public void testCloseRemovesFromSFWriters() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  LOG.debug("Starting...");
  final String fileName="FlumeData";
  final long batchSize=2;
  String newPath=testPath + "/singleBucket";
  int i=1, j=1;
  HDFSTestWriterFactory badWriterFactory=new HDFSTestWriterFactory();
  sink=new HDFSEventSink(badWriterFactory);
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  Path dirPath=new Path(newPath);
  fs.delete(dirPath,true);
  fs.mkdirs(dirPath);
  Context context=new Context();
  context.put("hdfs.path",newPath);
  context.put("hdfs.filePrefix",fileName);
  context.put("hdfs.rollCount",String.valueOf(0));
  context.put("hdfs.rollSize",String.valueOf(0));
  context.put("hdfs.rollInterval",String.valueOf(1));
  context.put("hdfs.batchSize",String.valueOf(batchSize));
  context.put("hdfs.fileType",HDFSTestWriterFactory.TestSequenceFileType);
  String expectedLookupPath=newPath + "/FlumeData";
  Configurables.configure(sink,context);
  MemoryChannel channel=new MemoryChannel();
  Configurables.configure(channel,new Context());
  sink.setChannel(channel);
  sink.start();
  Calendar eventDate=Calendar.getInstance();
  List<String> bodies=Lists.newArrayList();
  channel.getTransaction().begin();
  try {
    for (j=1; j <= 2 * batchSize; j++) {
      Event event=new SimpleEvent();
      eventDate.clear();
      eventDate.set(2011,i,i,i,0);
      event.getHeaders().put("timestamp",String.valueOf(eventDate.getTimeInMillis()));
      event.getHeaders().put("hostname","Host" + i);
      String body="Test." + i + "."+ j;
      event.setBody(body.getBytes());
      bodies.add(body);
      event.getHeaders().put("count-check","");
      channel.put(event);
    }
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  LOG.info("execute sink to process the events: " + sink.process());
  Assert.assertTrue(sink.getSfWriters().containsKey(expectedLookupPath));
  Thread.sleep(2001);
  Assert.assertFalse(sink.getSfWriters().containsKey(expectedLookupPath));
  LOG.info("execute sink to process the events: " + sink.process());
  Assert.assertTrue(sink.getSfWriters().containsKey(expectedLookupPath));
  sink.stop();
  LOG.info("Total number of bucket writers opened: {}",badWriterFactory.openCount.get());
  verifyOutputSequenceFiles(fs,conf,dirPath.toUri().getPath(),fileName,bodies);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestHDFSEventSinkOnMiniCluster </h4><pre class="type-9 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is a very basic test that writes one event to HDFS and reads it back.
 */
@Test public void underReplicationTest() throws EventDeliveryException, IOException {
  Configuration conf=new Configuration();
  conf.set("dfs.replication",String.valueOf(3));
  cluster=new MiniDFSCluster(conf,3,true,null);
  cluster.waitActive();
  String outputDir="/flume/underReplicationTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.DataStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  channel.getTransaction().begin();
  try {
    channel.put(EventBuilder.withBody("yarg 1",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 2",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 3",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 4",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 5",Charsets.UTF_8));
    channel.put(EventBuilder.withBody("yarg 5",Charsets.UTF_8));
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Same file.");
  sink.process();
  logger.info("Killing datanode #1...");
  cluster.stopDataNode(0);
  logger.info("Running process(). Create new file? (racy)");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Create new file.");
  sink.process();
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertTrue(line.startsWith("yarg"));
  }
  Assert.assertTrue("4 or 5 files expected, found " + statuses.length,statuses.length == 4 || statuses.length == 5);
  System.out.println("There are " + statuses.length + " files.");
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-2 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * This is a very basic test that writes one event to HDFS and reads it back.
 */
@Ignore("This test is flakey and causes tests to fail pretty often.") @Test public void maxUnderReplicationTest() throws EventDeliveryException, IOException {
  Configuration conf=new Configuration();
  conf.set("dfs.replication",String.valueOf(3));
  cluster=new MiniDFSCluster(conf,3,true,null);
  cluster.waitActive();
  String outputDir="/flume/underReplicationTest";
  Path outputDirPath=new Path(outputDir);
  logger.info("Running test with output dir: {}",outputDir);
  FileSystem fs=cluster.getFileSystem();
  if (fs.exists(outputDirPath)) {
    fs.delete(outputDirPath,true);
  }
  String nnURL=getNameNodeURL(cluster);
  logger.info("Namenode address: {}",nnURL);
  Context chanCtx=new Context();
  MemoryChannel channel=new MemoryChannel();
  channel.setName("simpleHDFSTest-mem-chan");
  channel.configure(chanCtx);
  channel.start();
  Context sinkCtx=new Context();
  sinkCtx.put("hdfs.path",nnURL + outputDir);
  sinkCtx.put("hdfs.fileType",HDFSWriterFactory.DataStreamType);
  sinkCtx.put("hdfs.batchSize",Integer.toString(1));
  HDFSEventSink sink=new HDFSEventSink();
  sink.setName("simpleHDFSTest-hdfs-sink");
  sink.configure(sinkCtx);
  sink.setChannel(channel);
  sink.start();
  channel.getTransaction().begin();
  try {
    for (int i=0; i < 50; i++) {
      channel.put(EventBuilder.withBody("yarg " + i,Charsets.UTF_8));
    }
    channel.getTransaction().commit();
  }
  finally {
    channel.getTransaction().close();
  }
  logger.info("Running process(). Create new file.");
  sink.process();
  logger.info("Running process(). Same file.");
  sink.process();
  logger.info("Killing datanode #1...");
  cluster.stopDataNode(0);
  logger.info("Running process(). Create new file? (racy)");
  sink.process();
  for (int i=3; i < 50; i++) {
    logger.info("Running process().");
    sink.process();
  }
  sink.stop();
  channel.stop();
  FileStatus[] statuses=fs.listStatus(outputDirPath);
  Assert.assertNotNull("No files found written to HDFS",statuses);
  for (  FileStatus status : statuses) {
    Path filePath=status.getPath();
    logger.info("Found file on DFS: {}",filePath);
    FSDataInputStream stream=fs.open(filePath);
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream));
    String line=reader.readLine();
    logger.info("First line in file {}: {}",filePath,line);
    Assert.assertTrue(line.startsWith("yarg"));
  }
  System.out.println("There are " + statuses.length + " files.");
  Assert.assertEquals("31 files expected, found " + statuses.length,31,statuses.length);
  if (!KEEP_DATA) {
    fs.delete(outputDirPath,true);
  }
  cluster.shutdown();
  cluster=null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestSequenceFileSerializerFactory </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void getWritableFormatter(){
  SequenceFileSerializer formatter=SequenceFileSerializerFactory.getSerializer("Writable",new Context());
  assertTrue(formatter != null);
  assertTrue(formatter.getClass().getName(),formatter instanceof HDFSWritableSerializer);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void getTextFormatter(){
  SequenceFileSerializer formatter=SequenceFileSerializerFactory.getSerializer("Text",new Context());
  assertTrue(formatter != null);
  assertTrue(formatter.getClass().getName(),formatter instanceof HDFSTextSerializer);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void getCustomFormatter(){
  SequenceFileSerializer formatter=SequenceFileSerializerFactory.getSerializer("org.apache.flume.sink.hdfs.MyCustomSerializer$Builder",new Context());
  assertTrue(formatter != null);
  assertTrue(formatter.getClass().getName(),formatter instanceof MyCustomSerializer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hdfs.TestUseRawLocalFileSystem </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCompressedFile() throws Exception {
  String file=testFile.getCanonicalPath();
  HDFSCompressedDataStream stream=new HDFSCompressedDataStream();
  context.put("hdfs.useRawLocalFileSystem","true");
  stream.configure(context);
  stream.open(file,new GzipCodec(),CompressionType.RECORD);
  stream.append(event);
  stream.sync();
  Assert.assertTrue(testFile.length() > 0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSequenceFile() throws Exception {
  String file=testFile.getCanonicalPath();
  HDFSSequenceFile stream=new HDFSSequenceFile();
  context.put("hdfs.useRawLocalFileSystem","true");
  stream.configure(context);
  stream.open(file);
  stream.append(event);
  stream.sync();
  Assert.assertTrue(testFile.length() > 0);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTestFile() throws Exception {
  String file=testFile.getCanonicalPath();
  HDFSDataStream stream=new HDFSDataStream();
  context.put("hdfs.useRawLocalFileSystem","true");
  stream.configure(context);
  stream.open(file);
  stream.append(event);
  stream.sync();
  Assert.assertTrue(testFile.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.hive.TestHiveWriter </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSerdeSeparatorCharParsing() throws Exception {
  HiveEndPoint endPoint=new HiveEndPoint(metaStoreURI,dbName,tblName,partVals);
  SinkCounter sinkCounter=new SinkCounter(this.getClass().getName());
  int timeout=10000;
  HiveDelimitedTextSerializer serializer1=new HiveDelimitedTextSerializer();
  Context ctx=new Context();
  ctx.put("serializer.fieldnames",COL1 + "," + COL2);
  ctx.put("serializer.serdeSeparator",",");
  serializer1.configure(ctx);
  HiveDelimitedTextSerializer serializer2=new HiveDelimitedTextSerializer();
  ctx=new Context();
  ctx.put("serializer.fieldnames",COL1 + "," + COL2);
  ctx.put("serializer.serdeSeparator","'\t'");
  serializer2.configure(ctx);
  HiveDelimitedTextSerializer serializer3=new HiveDelimitedTextSerializer();
  ctx=new Context();
  ctx.put("serializer.fieldnames",COL1 + "," + COL2);
  ctx.put("serializer.serdeSeparator","ab");
  try {
    serializer3.configure(ctx);
    Assert.assertTrue("Bad serdeSeparator character was accepted",false);
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.solr.morphline.TestMorphlineSolrSink </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAvroRoundTrip() throws Exception {
  String file=RESOURCES_DIR + "/test-documents" + "/sample-statuses-20120906-141433.avro";
  testDocumentTypesInternal(file);
  QueryResponse rsp=query("*:*");
  Iterator<SolrDocument> iter=rsp.getResults().iterator();
  ListMultimap<String,String> expectedFieldValues;
  expectedFieldValues=ImmutableListMultimap.of("id","1234567890","text","sample tweet one","user_screen_name","fake_user1");
  assertEquals(expectedFieldValues,next(iter));
  expectedFieldValues=ImmutableListMultimap.of("id","2345678901","text","sample tweet two","user_screen_name","fake_user2");
  assertEquals(expectedFieldValues,next(iter));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.sink.solr.morphline.TestUUIDInterceptor </h4><pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasic() throws Exception {
  Context context=new Context();
  context.put(UUIDInterceptor.HEADER_NAME,ID);
  context.put(UUIDInterceptor.PRESERVE_EXISTING_NAME,"true");
  Event event=new SimpleEvent();
  assertTrue(build(context).intercept(event).getHeaders().get(ID).length() > 0);
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPrefix() throws Exception {
  Context context=new Context();
  context.put(UUIDInterceptor.HEADER_NAME,ID);
  context.put(UUIDInterceptor.PREFIX_NAME,"bar#");
  Event event=new SimpleEvent();
  assertTrue(build(context).intercept(event).getHeaders().get(ID).startsWith("bar#"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestAvroSource </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws InterruptedException {
  boolean bound=false;
  for (int i=0; i < 100 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("port",String.valueOf(selectedPort=41414 + i));
      context.put("bind","0.0.0.0");
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    ChannelException e) {
    }
  }
  Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
  Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
  source.stop();
  Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
  Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSslRequest() throws InterruptedException, IOException {
  boolean bound=false;
  for (int i=0; i < 10 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("port",String.valueOf(selectedPort=41414 + i));
      context.put("bind","0.0.0.0");
      context.put("ssl","true");
      context.put("keystore","src/test/resources/server.p12");
      context.put("keystore-password","password");
      context.put("keystore-type","PKCS12");
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    ChannelException e) {
      Thread.sleep(100);
    }
  }
  Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
  Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
  AvroSourceProtocol client=SpecificRequestor.getClient(AvroSourceProtocol.class,new NettyTransceiver(new InetSocketAddress(selectedPort),new SSLChannelFactory()));
  AvroFlumeEvent avroEvent=new AvroFlumeEvent();
  avroEvent.setHeaders(new HashMap<CharSequence,CharSequence>());
  avroEvent.setBody(ByteBuffer.wrap("Hello avro ssl".getBytes()));
  Status status=client.append(avroEvent);
  Assert.assertEquals(Status.OK,status);
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  Event event=channel.take();
  Assert.assertNotNull(event);
  Assert.assertEquals("Channel contained our event","Hello avro ssl",new String(event.getBody()));
  transaction.commit();
  transaction.close();
  logger.debug("Round trip event:{}",event);
  source.stop();
  Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
  Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestBasicSourceSemantics </h4><pre class="type-11 type-10 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureCalledWhenStarted() throws Exception {
  source=spyAndConfigure(new DoNothingSource());
  source.start();
  try {
    source.configure(context);
    Assert.fail();
  }
 catch (  IllegalStateException expected) {
  }
  Assert.assertTrue(source.isStarted());
  Assert.assertNull(source.getStartException());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoStartThrowsException() throws Exception {
  source=spyAndConfigure(new DoNothingSource(){
    @Override protected void doStart() throws FlumeException {
      throw new FlumeException("dummy");
    }
  }
);
  source.start();
  Assert.assertFalse(source.isStarted());
  Assert.assertEquals(LifecycleState.ERROR,source.getLifecycleState());
  Assert.assertNotNull(source.getStartException());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoConfigureThrowsException() throws Exception {
  source=spy(new DoNothingSource(){
    @Override protected void doConfigure(    Context context) throws FlumeException {
      throw new FlumeException("dummy");
    }
  }
);
  source.setChannelProcessor(channelProcessor);
  try {
    source.configure(context);
    Assert.fail();
  }
 catch (  FlumeException expected) {
  }
  Assert.assertFalse(source.isStarted());
  Assert.assertEquals(LifecycleState.ERROR,source.getLifecycleState());
  Assert.assertNotNull(source.getStartException());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoStopThrowsException() throws Exception {
  source=spyAndConfigure(new DoNothingSource(){
    @Override protected void doStop() throws FlumeException {
      throw new FlumeException("dummy");
    }
  }
);
  source.start();
  source.stop();
  Assert.assertFalse(source.isStarted());
  Assert.assertEquals(LifecycleState.ERROR,source.getLifecycleState());
  Assert.assertNull(source.getStartException());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestDefaultSourceFactory </h4><pre class="type-10 type-1 type-14 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCreate(){
  Source avroSource1=sourceFactory.create("avroSource1","avro");
  Source avroSource2=sourceFactory.create("avroSource2","avro");
  Assert.assertNotNull(avroSource1);
  Assert.assertNotNull(avroSource2);
  Assert.assertNotSame(avroSource1,avroSource2);
  Assert.assertTrue(avroSource1 instanceof AvroSource);
  Assert.assertTrue(avroSource2 instanceof AvroSource);
  Source s1=sourceFactory.create("avroSource1","avro");
  Source s2=sourceFactory.create("avroSource2","avro");
  Assert.assertNotSame(avroSource1,s1);
  Assert.assertNotSame(avroSource2,s2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestExecSource </h4><pre class="type-12 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestart() throws InterruptedException, LifecycleException, EventDeliveryException, IOException {
  context.put(ExecSourceConfigurationConstants.CONFIG_RESTART_THROTTLE,"10");
  context.put(ExecSourceConfigurationConstants.CONFIG_RESTART,"true");
  context.put("command",SystemUtils.IS_OS_WINDOWS ? "cmd /c echo flume" : "echo flume");
  Configurables.configure(source,context);
  source.start();
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  long start=System.currentTimeMillis();
  for (int i=0; i < 5; i++) {
    Event event=channel.take();
    assertNotNull(event);
    assertNotNull(event.getBody());
    assertEquals("flume",new String(event.getBody(),Charsets.UTF_8));
  }
  assertTrue(System.currentTimeMillis() - start < 10000L);
  transaction.commit();
  transaction.close();
  source.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestMultiportSyslogTCPSource </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the reassembly of a single line across multiple packets.
 */
@Test public void testFragmented() throws CharacterCodingException {
  final int maxLen=100;
  IoBuffer savedBuf=IoBuffer.allocate(maxLen);
  String origMsg="<1>- - blah blam foo\n";
  IoBuffer buf1=IoBuffer.wrap(origMsg.substring(0,11).getBytes(Charsets.UTF_8));
  IoBuffer buf2=IoBuffer.wrap(origMsg.substring(11,16).getBytes(Charsets.UTF_8));
  IoBuffer buf3=IoBuffer.wrap(origMsg.substring(16,21).getBytes(Charsets.UTF_8));
  LineSplitter lineSplitter=new LineSplitter(maxLen);
  ParsedBuffer parsedLine=new ParsedBuffer();
  Assert.assertFalse("Incomplete line should not be parsed",lineSplitter.parseLine(buf1,savedBuf,parsedLine));
  Assert.assertFalse("Incomplete line should not be parsed",lineSplitter.parseLine(buf2,savedBuf,parsedLine));
  Assert.assertTrue("Completed line should be parsed",lineSplitter.parseLine(buf3,savedBuf,parsedLine));
  Assert.assertEquals(origMsg.trim(),parsedLine.buffer.getString(Charsets.UTF_8.newDecoder()));
  parsedLine.buffer.rewind();
  MultiportSyslogTCPSource.MultiportSyslogHandler handler=new MultiportSyslogTCPSource.MultiportSyslogHandler(maxLen,100,null,null,SyslogSourceConfigurationConstants.DEFAULT_PORT_HEADER,new ThreadSafeDecoder(Charsets.UTF_8),new ConcurrentHashMap<Integer,ThreadSafeDecoder>(),null);
  Event event=handler.parseEvent(parsedLine,Charsets.UTF_8.newDecoder());
  String body=new String(event.getBody(),Charsets.UTF_8);
  Assert.assertEquals("Event body incorrect",origMsg.trim().substring(7),body);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestNetcatSource </h4><pre class="type-12 type-9 type-13 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws InterruptedException, LifecycleException, EventDeliveryException {
  ExecutorService executor=Executors.newFixedThreadPool(3);
  boolean bound=false;
  for (int i=0; i < 100 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("bind","0.0.0.0");
      context.put("port","41414");
      context.put("ack-every-event",String.valueOf(ackEveryEvent));
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    FlumeException e) {
    }
  }
  Runnable clientRequestRunnable=new Runnable(){
    @Override public void run(){
      try {
        SocketChannel clientChannel=SocketChannel.open(new InetSocketAddress(41414));
        Writer writer=Channels.newWriter(clientChannel,"utf-8");
        BufferedReader reader=new BufferedReader(Channels.newReader(clientChannel,"utf-8"));
        writer.write("Test message\n");
        writer.flush();
        if (ackEveryEvent) {
          String response=reader.readLine();
          Assert.assertEquals("Server should return OK","OK",response);
        }
 else {
          Assert.assertFalse("Server should not return anything",reader.ready());
        }
        clientChannel.close();
      }
 catch (      IOException e) {
        logger.error("Caught exception: ",e);
      }
    }
  }
;
  ChannelSelector selector=source.getChannelProcessor().getSelector();
  Transaction tx=selector.getAllChannels().get(0).getTransaction();
  tx.begin();
  for (int i=0; i < 100; i++) {
    logger.info("Sending request");
    executor.submit(clientRequestRunnable);
    Event event=channel.take();
    Assert.assertNotNull(event);
    Assert.assertArrayEquals("Test message".getBytes(),event.getBody());
  }
  tx.commit();
  tx.close();
  executor.shutdown();
  while (!executor.isTerminated()) {
    executor.awaitTermination(500,TimeUnit.MILLISECONDS);
  }
  source.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestSequenceGeneratorSource </h4><pre class="type-12 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBatchProcessWithLifeCycle() throws InterruptedException, LifecycleException, EventDeliveryException {
  int batchSize=10;
  Channel channel=new PseudoTxnMemoryChannel();
  Context context=new Context();
  context.put("logicalNode.name","test");
  context.put("batchSize",Integer.toString(batchSize));
  Configurables.configure(source,context);
  Configurables.configure(channel,context);
  List<Channel> channels=new ArrayList<Channel>();
  channels.add(channel);
  ChannelSelector rcs=new ReplicatingChannelSelector();
  rcs.setChannels(channels);
  source.setChannelProcessor(new ChannelProcessor(rcs));
  source.start();
  for (long i=0; i < 100; i++) {
    source.process();
    for (long j=batchSize; j > 0; j--) {
      Event event=channel.take();
      String expectedVal=String.valueOf(((i + 1) * batchSize) - j);
      String resultedVal=new String(event.getBody());
      Assert.assertTrue("Expected " + expectedVal + " is not equals to "+ resultedVal,expectedVal.equals(resultedVal));
    }
  }
  source.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestSpoolDirectorySource </h4><pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReconfigure() throws InterruptedException, IOException {
  final int NUM_RECONFIGS=20;
  for (int i=0; i < NUM_RECONFIGS; i++) {
    Context context=new Context();
    File file=new File(tmpDir.getAbsolutePath() + "/file-" + i);
    Files.write("File " + i,file,Charsets.UTF_8);
    context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
    Configurables.configure(source,context);
    source.start();
    Thread.sleep(TimeUnit.SECONDS.toMillis(1));
    Transaction txn=channel.getTransaction();
    txn.begin();
    try {
      Event event=channel.take();
      String content=new String(event.getBody(),Charsets.UTF_8);
      Assert.assertEquals("File " + i,content);
      txn.commit();
    }
 catch (    Throwable t) {
      txn.rollback();
    }
 finally {
      txn.close();
    }
    source.stop();
    Assert.assertFalse("Fatal error on iteration " + i,source.hasFatalError());
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws IOException, InterruptedException {
  Context context=new Context();
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
  Configurables.configure(source,context);
  for (int i=0; i < 10; i++) {
    source.start();
    Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
    Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
    source.stop();
    Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
    Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
  }
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEndWithZeroByteFiles() throws IOException, InterruptedException {
  Context context=new Context();
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\n",f1,Charsets.UTF_8);
  File f2=new File(tmpDir.getAbsolutePath() + "/file2");
  File f3=new File(tmpDir.getAbsolutePath() + "/file3");
  File f4=new File(tmpDir.getAbsolutePath() + "/file4");
  Files.touch(f2);
  Files.touch(f3);
  Files.touch(f4);
  context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
  Configurables.configure(source,context);
  source.start();
  Thread.sleep(5000);
  Assert.assertFalse("Server did not error",source.hasFatalError());
  Assert.assertEquals("One message was read",1,source.getSourceCounter().getEventAcceptedCount());
  source.stop();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSourceDoesNotDieOnFullChannel() throws Exception {
  Context chContext=new Context();
  chContext.put("capacity","2");
  chContext.put("transactionCapacity","2");
  chContext.put("keep-alive","0");
  channel.stop();
  Configurables.configure(channel,chContext);
  channel.start();
  Context context=new Context();
  File f1=new File(tmpDir.getAbsolutePath() + "/file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  context.put(SpoolDirectorySourceConfigurationConstants.SPOOL_DIRECTORY,tmpDir.getAbsolutePath());
  context.put(SpoolDirectorySourceConfigurationConstants.BATCH_SIZE,"2");
  Configurables.configure(source,context);
  source.setBackOff(false);
  source.start();
  while (!source.hitChannelException()) {
    Thread.sleep(50);
  }
  List<String> dataOut=Lists.newArrayList();
  for (int i=0; i < 8; ) {
    Transaction tx=channel.getTransaction();
    tx.begin();
    Event e=channel.take();
    if (e != null) {
      dataOut.add(new String(e.getBody(),"UTF-8"));
      i++;
    }
    e=channel.take();
    if (e != null) {
      dataOut.add(new String(e.getBody(),"UTF-8"));
      i++;
    }
    tx.commit();
    tx.close();
  }
  Assert.assertTrue("Expected to hit ChannelException, but did not!",source.hitChannelException());
  Assert.assertEquals(8,dataOut.size());
  source.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestStressSource </h4><pre class="type-12 type-9 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBatchEventsWithoutMatTotalEvents() throws InterruptedException, EventDeliveryException {
  StressSource source=new StressSource();
  source.setChannelProcessor(mockProcessor);
  Context context=new Context();
  context.put("batchSize","10");
  source.configure(context);
  source.start();
  for (int i=0; i < 10; i++) {
    Assert.assertFalse("StressSource with no maxTotalEvents should not return " + Status.BACKOFF,source.process() == Status.BACKOFF);
  }
  verify(mockProcessor,times(10)).processEventBatch(getLastProcessedEventList(source));
  long successfulEvents=getCounterGroup(source).get("events.successful");
  TestCase.assertTrue("Number of successful events should be 100 but was " + successfulEvents,successfulEvents == 100);
  long failedEvents=getCounterGroup(source).get("events.failed");
  TestCase.assertTrue("Number of failure events should be 0 but was " + failedEvents,failedEvents == 0);
}

</code></pre>

<br>
<pre class="type-12 type-9 type-13 type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBatchEvents() throws InterruptedException, EventDeliveryException {
  StressSource source=new StressSource();
  source.setChannelProcessor(mockProcessor);
  Context context=new Context();
  context.put("maxTotalEvents","35");
  context.put("batchSize","10");
  source.configure(context);
  source.start();
  for (int i=0; i < 50; i++) {
    if (source.process() == Status.BACKOFF) {
      TestCase.assertTrue("Source should have sent all events in 4 batches",i == 4);
      break;
    }
    if (i < 3) {
      verify(mockProcessor,times(i + 1)).processEventBatch(getLastProcessedEventList(source));
    }
 else {
      verify(mockProcessor,times(1)).processEventBatch(getLastProcessedEventList(source));
    }
  }
  long successfulEvents=getCounterGroup(source).get("events.successful");
  TestCase.assertTrue("Number of successful events should be 35 but was " + successfulEvents,successfulEvents == 35);
  long failedEvents=getCounterGroup(source).get("events.failed");
  TestCase.assertTrue("Number of failure events should be 0 but was " + failedEvents,failedEvents == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestSyslogParser </h4><pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageParsing(){
  SyslogParser parser=new SyslogParser();
  Charset charset=Charsets.UTF_8;
  List<String> messages=Lists.newArrayList();
  messages.add("<34>Oct 11 22:14:15 mymachine su: 'su root' failed for " + "lonvick on /dev/pts/8");
  messages.add("<13>Feb  5 17:32:18 10.0.0.99 Use the BFG!");
  messages.add("<165>Aug 24 05:34:00 CST 1987 mymachine myproc[10]: %% " + "It's time to make the do-nuts.  %%  Ingredients: Mix=OK, Jelly=OK # " + "Devices: Mixer=OK, Jelly_Injector=OK, Frier=OK # Transport: "+ "Conveyer1=OK, Conveyer2=OK # %%");
  messages.add("<0>Oct 22 10:52:12 scapegoat 1990 Oct 22 10:52:01 TZ-6 " + "scapegoat.dmz.example.org 10.1.2.3 sched[0]: That's All Folks!");
  messages.add("<34>1 2003-10-11T22:14:15.003Z mymachine.example.com su - " + "ID47 - BOM'su root' failed for lonvick on /dev/pts/8");
  messages.add("<165>1 2003-08-24T05:14:15.000003-07:00 192.0.2.1 myproc " + "8710 - - %% It's time to make the do-nuts.");
  messages.add("<13>2003-08-24T05:14:15Z localhost snarf?");
  messages.add("<13>2012-08-16T14:34:03-08:00 127.0.0.1 test shnap!");
  for (  String msg : messages) {
    Set<String> keepFields=new HashSet<String>();
    Event event=parser.parseMessage(msg,charset,keepFields);
    Assert.assertNull("Failure to parse known-good syslog message",event.getHeaders().get(SyslogUtils.EVENT_STATUS));
  }
  for (  String msg : messages) {
    Set<String> keepFields=new HashSet<String>();
    keepFields.add(SyslogUtils.KEEP_FIELDS_ALL);
    Event event=parser.parseMessage(msg,charset,keepFields);
    Assert.assertArrayEquals(event.getBody(),msg.getBytes());
    Assert.assertNull("Failure to parse known-good syslog message",event.getHeaders().get(SyslogUtils.EVENT_STATUS));
  }
  for (  String msg : messages) {
    Set<String> keepFields=new HashSet<String>();
    keepFields.add(SyslogSourceConfigurationConstants.CONFIG_KEEP_FIELDS_HOSTNAME);
    Event event=parser.parseMessage(msg,charset,keepFields);
    Assert.assertTrue("Failure to persist hostname",new String(event.getBody()).contains(event.getHeaders().get("host")));
    Assert.assertNull("Failure to parse known-good syslog message",event.getHeaders().get(SyslogUtils.EVENT_STATUS));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.TestThriftSource </h4><pre class="type-12 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendBigBatch() throws Exception {
  client=RpcClientFactory.getThriftInstance(props);
  Context context=new Context();
  context.put("capacity","3000");
  context.put("transactionCapacity","3000");
  channel.configure(context);
  configureSource();
  context.put(ThriftSource.CONFIG_BIND,"0.0.0.0");
  context.put(ThriftSource.CONFIG_PORT,String.valueOf(port));
  Configurables.configure(source,context);
  source.start();
  for (int i=0; i < 5; i++) {
    List<Event> events=Lists.newArrayList();
    for (int j=0; j < 500; j++) {
      Map<String,String> hdrs=Maps.newHashMap();
      hdrs.put("time",String.valueOf(System.currentTimeMillis()));
      events.add(EventBuilder.withBody(String.valueOf(i).getBytes(),hdrs));
    }
    client.appendBatch(events);
  }
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  long after=System.currentTimeMillis();
  List<Integer> events=Lists.newArrayList();
  for (int i=0; i < 2500; i++) {
    Event event=channel.take();
    Assert.assertNotNull(event);
    Assert.assertTrue(Long.valueOf(event.getHeaders().get("time")) < after);
    events.add(Integer.parseInt(new String(event.getBody())));
  }
  transaction.commit();
  transaction.close();
  Collections.sort(events);
  int index=0;
  for (int i=0; i < 5; i++) {
    for (int j=0; j < 500; j++) {
      Assert.assertEquals(i,events.get(index++).intValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppendBatch() throws Exception {
  client=RpcClientFactory.getThriftInstance(props);
  Context context=new Context();
  context.put("capacity","1000");
  context.put("transactionCapacity","1000");
  channel.configure(context);
  configureSource();
  context.put(ThriftSource.CONFIG_BIND,"0.0.0.0");
  context.put(ThriftSource.CONFIG_PORT,String.valueOf(port));
  Configurables.configure(source,context);
  source.start();
  for (int i=0; i < 30; i++) {
    List<Event> events=Lists.newArrayList();
    for (int j=0; j < 10; j++) {
      Map<String,String> hdrs=Maps.newHashMap();
      hdrs.put("time",String.valueOf(System.currentTimeMillis()));
      events.add(EventBuilder.withBody(String.valueOf(i).getBytes(),hdrs));
    }
    client.appendBatch(events);
  }
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  long after=System.currentTimeMillis();
  List<Integer> events=Lists.newArrayList();
  for (int i=0; i < 300; i++) {
    Event event=channel.take();
    Assert.assertNotNull(event);
    Assert.assertTrue(Long.valueOf(event.getHeaders().get("time")) <= after);
    events.add(Integer.parseInt(new String(event.getBody())));
  }
  transaction.commit();
  transaction.close();
  Collections.sort(events);
  int index=0;
  for (int i=0; i < 30; i++) {
    for (int j=0; j < 10; j++) {
      Assert.assertEquals(i,events.get(index++).intValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleClients() throws Exception {
  ExecutorService submitter=Executors.newCachedThreadPool();
  client=RpcClientFactory.getThriftInstance(props);
  Context context=new Context();
  context.put("capacity","1000");
  context.put("transactionCapacity","1000");
  channel.configure(context);
  configureSource();
  context.put(ThriftSource.CONFIG_BIND,"0.0.0.0");
  context.put(ThriftSource.CONFIG_PORT,String.valueOf(port));
  Configurables.configure(source,context);
  source.start();
  ExecutorCompletionService<Void> completionService=new ExecutorCompletionService(submitter);
  for (int i=0; i < 30; i++) {
    completionService.submit(new SubmitHelper(i),null);
  }
  for (int i=0; i < 30; i++) {
    completionService.take();
  }
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  long after=System.currentTimeMillis();
  List<Integer> events=Lists.newArrayList();
  for (int i=0; i < 300; i++) {
    Event event=channel.take();
    Assert.assertNotNull(event);
    Assert.assertTrue(Long.valueOf(event.getHeaders().get("time")) < after);
    events.add(Integer.parseInt(new String(event.getBody())));
  }
  transaction.commit();
  transaction.close();
  Collections.sort(events);
  int index=0;
  for (int i=0; i < 30; i++) {
    for (int j=0; j < 10; j++) {
      Assert.assertEquals(i,events.get(index++).intValue());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.avroLegacy.TestLegacyAvroSource </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws InterruptedException {
  boolean bound=false;
  for (int i=0; i < 100 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("port",String.valueOf(selectedPort=41414 + i));
      context.put("host","0.0.0.0");
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    ChannelException e) {
    }
  }
  Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
  Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
  source.stop();
  Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
  Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequest() throws InterruptedException, IOException {
  boolean bound=false;
  int i;
  for (i=0; i < 100 && !bound; i++) {
    try {
      Context context=new Context();
      context.put("port",String.valueOf(selectedPort=41414 + i));
      context.put("host","0.0.0.0");
      Configurables.configure(source,context);
      source.start();
      bound=true;
    }
 catch (    ChannelException e) {
    }
  }
  Assert.assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
  Assert.assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
  URL url=new URL("http","0.0.0.0",selectedPort,"/");
  Transceiver http=new HttpTransceiver(url);
  FlumeOGEventAvroServer client=SpecificRequestor.getClient(FlumeOGEventAvroServer.class,http);
  AvroFlumeOGEvent avroEvent=AvroFlumeOGEvent.newBuilder().setHost("foo").setPriority(Priority.INFO).setNanos(0).setTimestamp(1).setFields(new HashMap<CharSequence,ByteBuffer>()).setBody(ByteBuffer.wrap("foo".getBytes())).build();
  client.append(avroEvent);
  Transaction transaction=channel.getTransaction();
  transaction.begin();
  Event event=channel.take();
  Assert.assertNotNull(event);
  Assert.assertEquals("Channel contained our event","foo",new String(event.getBody()));
  transaction.commit();
  transaction.close();
  source.stop();
  Assert.assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
  Assert.assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.http.TestHTTPSource </h4><pre class="type-11 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHttpsSourceNonHttpsClient() throws Exception {
  Type listType=new TypeToken<List<JSONEvent>>(){
  }
.getType();
  List<JSONEvent> events=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 10; i++) {
    Map<String,String> input=Maps.newHashMap();
    for (int j=0; j < 10; j++) {
      input.put(String.valueOf(i) + String.valueOf(j),String.valueOf(i));
    }
    input.put("MsgNum",String.valueOf(i));
    JSONEvent e=new JSONEvent();
    e.setHeaders(input);
    e.setBody(String.valueOf(rand.nextGaussian()).getBytes("UTF-8"));
    events.add(e);
  }
  Gson gson=new Gson();
  String json=gson.toJson(events,listType);
  HttpURLConnection httpURLConnection=null;
  try {
    URL url=new URL("http://0.0.0.0:" + sslPort);
    httpURLConnection=(HttpURLConnection)url.openConnection();
    httpURLConnection.setDoInput(true);
    httpURLConnection.setDoOutput(true);
    httpURLConnection.setRequestMethod("POST");
    httpURLConnection.getOutputStream().write(json.getBytes());
    httpURLConnection.getResponseCode();
    Assert.fail("HTTP Client cannot connect to HTTPS source");
  }
 catch (  Exception exception) {
    Assert.assertTrue("Exception expected",true);
  }
 finally {
    httpURLConnection.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.http.TestJSONHandler </h4><pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoBody() throws Exception {
  String json="[{\"headers\" : {\"a\": \"b\"}}," + "{\"headers\" : {\"e\": \"f\"},\"body\": \"random_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertTrue(e.getBody().length == 0);
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("random_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscapedJSON() throws Exception {
  String json="[{\"headers\":{\"a\": \"b\"}}," + "{\"headers\":{\"e\": \"f\"},\"body\": \"rand\\\"om_body2\"}]";
  HttpServletRequest req=new FlumeHttpServletRequestWrapper(json);
  List<Event> deserialized=handler.getEvents(req);
  Event e=deserialized.get(0);
  Assert.assertEquals("b",e.getHeaders().get("a"));
  Assert.assertTrue(e.getBody().length == 0);
  e=deserialized.get(1);
  Assert.assertEquals("f",e.getHeaders().get("e"));
  Assert.assertEquals("rand\"om_body2",new String(e.getBody(),"UTF-8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.jms.TestIntegrationActiveMQ </h4><pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Before public void setup() throws Exception {
  baseDir=Files.createTempDir();
  tmpDir=new File(baseDir,"tmp");
  dataDir=new File(baseDir,"data");
  Assert.assertTrue(tmpDir.mkdir());
  passwordFile=new File(baseDir,"password");
  Files.write(PASSWORD.getBytes(Charsets.UTF_8),passwordFile);
  broker=new BrokerService();
  broker.addConnector(BROKER_BIND_URL);
  broker.setTmpDataDirectory(tmpDir);
  broker.setDataDirectoryFile(dataDir);
  List<AuthenticationUser> users=Lists.newArrayList();
  users.add(new AuthenticationUser(USERNAME,PASSWORD,""));
  SimpleAuthenticationPlugin authentication=new SimpleAuthenticationPlugin(users);
  broker.setPlugins(new BrokerPlugin[]{authentication});
  broker.start();
  context=new Context();
  context.put(JMSSourceConfiguration.INITIAL_CONTEXT_FACTORY,INITIAL_CONTEXT_FACTORY);
  context.put(JMSSourceConfiguration.PROVIDER_URL,BROKER_BIND_URL);
  context.put(JMSSourceConfiguration.DESTINATION_NAME,DESTINATION_NAME);
  context.put(JMSSourceConfiguration.USERNAME,USERNAME);
  context.put(JMSSourceConfiguration.PASSWORD_FILE,passwordFile.getAbsolutePath());
  events=Lists.newArrayList();
  source=new JMSSource();
  source.setName("JMSSource-" + UUID.randomUUID());
  ChannelProcessor channelProcessor=mock(ChannelProcessor.class);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      events.addAll((List<Event>)invocation.getArguments()[0]);
      return null;
    }
  }
).when(channelProcessor).processEventBatch(any(List.class));
  source.setChannelProcessor(channelProcessor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.kafka.TestKafkaSource </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchTime() throws InterruptedException, EventDeliveryException {
  context.put(KafkaSourceConstants.BATCH_DURATION_MS,"250");
  kafkaSource.configure(context);
  kafkaSource.start();
  Thread.sleep(500L);
  for (int i=1; i < 5000; i++) {
    kafkaServer.produce(topicName,"","hello, world " + i);
  }
  Thread.sleep(500L);
  long startTime=System.currentTimeMillis();
  Status status=kafkaSource.process();
  long endTime=System.currentTimeMillis();
  assertEquals(Status.READY,status);
  assertTrue(endTime - startTime < (context.getLong(KafkaSourceConstants.BATCH_DURATION_MS) + context.getLong("kafka.consumer.timeout.ms")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.taildir.TestTaildirEventReader </h4><pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicCommitFailure() throws IOException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n" + "file1line9\nfile1line10\nfile1line11\nfile1line12\n",f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out1=null;
  for (  TailFile tf : reader.getTailFiles().values()) {
    out1=bodiesAsStrings(reader.readEvents(tf,4));
  }
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  List<String> out2=bodiesAsStrings(reader.readEvents(4));
  assertTrue(out2.contains("file1line1"));
  assertTrue(out2.contains("file1line2"));
  assertTrue(out2.contains("file1line3"));
  assertTrue(out2.contains("file1line4"));
  reader.commit();
  List<String> out3=bodiesAsStrings(reader.readEvents(4));
  assertTrue(out3.contains("file1line5"));
  assertTrue(out3.contains("file1line6"));
  assertTrue(out3.contains("file1line7"));
  assertTrue(out3.contains("file1line8"));
  reader.commit();
  List<String> out4=bodiesAsStrings(reader.readEvents(4));
  assertEquals(4,out4.size());
  assertTrue(out4.contains("file1line9"));
  assertTrue(out4.contains("file1line10"));
  assertTrue(out4.contains("file1line11"));
  assertTrue(out4.contains("file1line12"));
}

</code></pre>

<br>
<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasicCommitFailureAndBatchSizeChanges() throws IOException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out1=null;
  for (  TailFile tf : reader.getTailFiles().values()) {
    out1=bodiesAsStrings(reader.readEvents(tf,5));
  }
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  List<String> out2=bodiesAsStrings(reader.readEvents(2));
  assertTrue(out2.contains("file1line1"));
  assertTrue(out2.contains("file1line2"));
  reader.commit();
  List<String> out3=bodiesAsStrings(reader.readEvents(2));
  assertTrue(out3.contains("file1line3"));
  assertTrue(out3.contains("file1line4"));
  reader.commit();
  List<String> out4=bodiesAsStrings(reader.readEvents(15));
  assertTrue(out4.contains("file1line5"));
  assertTrue(out4.contains("file1line6"));
  assertTrue(out4.contains("file1line7"));
  assertTrue(out4.contains("file1line8"));
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewLineBoundaries() throws IOException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\rfile1line2\nfile1line3\r\nfile1line4\n",f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    out.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  assertEquals(4,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2\rfile1line2"));
  assertTrue(out.contains("file1line3"));
  assertTrue(out.contains("file1line4"));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteOffsetHeader() throws IOException {
  File f1=new File(tmpDir,"file1");
  String line1="file1line1\n";
  String line2="file1line2\n";
  String line3="file1line3\n";
  Files.write(line1 + line2 + line3,f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader(true);
  List<String> headers=null;
  for (  TailFile tf : reader.getTailFiles().values()) {
    headers=headersAsStrings(reader.readEvents(tf,5),BYTE_OFFSET_HEADER_KEY);
    reader.commit();
  }
  assertEquals(3,headers.size());
  assertTrue(headers.contains(String.valueOf(0)));
  assertTrue(headers.contains(String.valueOf(line1.length())));
  assertTrue(headers.contains(String.valueOf((line1 + line2).length())));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitiallyEmptyDirAndBehaviorAfterReadingAll() throws IOException {
  ReliableTaildirEventReader reader=getReader();
  List<Long> fileInodes=reader.updateTailFiles();
  assertEquals(0,fileInodes.size());
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  reader.updateTailFiles();
  List<String> out=null;
  for (  TailFile tf : reader.getTailFiles().values()) {
    out=bodiesAsStrings(reader.readEvents(tf,2));
    reader.commit();
  }
  assertEquals(2,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  reader.updateTailFiles();
  List<String> empty=null;
  for (  TailFile tf : reader.getTailFiles().values()) {
    empty=bodiesAsStrings(reader.readEvents(tf,15));
    reader.commit();
  }
  assertEquals(0,empty.size());
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBackoffWithoutNewLine() throws IOException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1",f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    out.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  assertEquals(1,out.size());
  assertTrue(out.contains("file1line1"));
  Files.append("line2\nfile1line3\nfile1line4",f1,Charsets.UTF_8);
  for (  TailFile tf : reader.getTailFiles().values()) {
    out.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  assertEquals(3,out.size());
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file1line3"));
  out.addAll(bodiesAsStrings(reader.readEvents(5,false)));
  reader.commit();
  assertEquals(4,out.size());
  assertTrue(out.contains("file1line4"));
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicReadFiles() throws IOException {
  File f1=new File(tmpDir,"file1");
  File f2=new File(tmpDir,"file2");
  File f3=new File(tmpDir,"file3");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.write("file2line1\nfile2line2\n",f2,Charsets.UTF_8);
  Files.write("file3line1\nfile3line2\n",f3,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    List<String> bodies=bodiesAsStrings(reader.readEvents(tf,2));
    out.addAll(bodies);
    reader.commit();
  }
  assertEquals(6,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertTrue(out.contains("file2line1"));
  assertTrue(out.contains("file2line2"));
  assertTrue(out.contains("file3line1"));
  assertTrue(out.contains("file3line2"));
  Files.append("file3line3\nfile3line4\n",f3,Charsets.UTF_8);
  reader.updateTailFiles();
  for (  TailFile tf : reader.getTailFiles().values()) {
    List<String> bodies=bodiesAsStrings(reader.readEvents(tf,2));
    out.addAll(bodies);
    reader.commit();
  }
  assertEquals(8,out.size());
  assertTrue(out.contains("file3line3"));
  assertTrue(out.contains("file3line4"));
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncludeEmptyFile() throws IOException {
  File f1=new File(tmpDir,"file1");
  File f2=new File(tmpDir,"file2");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Files.touch(f2);
  ReliableTaildirEventReader reader=getReader();
  List<String> out=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    out.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  assertEquals(2,out.size());
  assertTrue(out.contains("file1line1"));
  assertTrue(out.contains("file1line2"));
  assertNull(reader.readEvent());
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchedReadsAcrossFileBoundary() throws IOException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\nfile1line3\nfile1line4\n" + "file1line5\nfile1line6\nfile1line7\nfile1line8\n",f1,Charsets.UTF_8);
  ReliableTaildirEventReader reader=getReader();
  List<String> out1=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    out1.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  File f2=new File(tmpDir,"file2");
  Files.write("file2line1\nfile2line2\nfile2line3\nfile2line4\n" + "file2line5\nfile2line6\nfile2line7\nfile2line8\n",f2,Charsets.UTF_8);
  List<String> out2=bodiesAsStrings(reader.readEvents(5));
  reader.commit();
  reader.updateTailFiles();
  List<String> out3=Lists.newArrayList();
  for (  TailFile tf : reader.getTailFiles().values()) {
    out3.addAll(bodiesAsStrings(reader.readEvents(tf,5)));
    reader.commit();
  }
  assertEquals(5,out1.size());
  assertTrue(out1.contains("file1line1"));
  assertTrue(out1.contains("file1line2"));
  assertTrue(out1.contains("file1line3"));
  assertTrue(out1.contains("file1line4"));
  assertTrue(out1.contains("file1line5"));
  assertEquals(3,out2.size());
  assertTrue(out2.contains("file1line6"));
  assertTrue(out2.contains("file1line7"));
  assertTrue(out2.contains("file1line8"));
  assertEquals(5,out3.size());
  assertTrue(out3.contains("file2line1"));
  assertTrue(out3.contains("file2line2"));
  assertTrue(out3.contains("file2line3"));
  assertTrue(out3.contains("file2line4"));
  assertTrue(out3.contains("file2line5"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.source.taildir.TestTaildirSource </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegexFileNameFiltering() throws IOException {
  File f1=new File(tmpDir,"a.log");
  File f2=new File(tmpDir,"a.log.1");
  File f3=new File(tmpDir,"b.log");
  File f4=new File(tmpDir,"c.log.yyyy-MM-01");
  File f5=new File(tmpDir,"c.log.yyyy-MM-02");
  Files.write("a.log\n",f1,Charsets.UTF_8);
  Files.write("a.log.1\n",f2,Charsets.UTF_8);
  Files.write("b.log\n",f3,Charsets.UTF_8);
  Files.write("c.log.yyyy-MM-01\n",f4,Charsets.UTF_8);
  Files.write("c.log.yyyy-MM-02\n",f5,Charsets.UTF_8);
  Context context=new Context();
  context.put(POSITION_FILE,posFilePath);
  context.put(FILE_GROUPS,"ab c");
  context.put(FILE_GROUPS_PREFIX + "ab",tmpDir.getAbsolutePath() + "/[ab].log");
  context.put(FILE_GROUPS_PREFIX + "c",tmpDir.getAbsolutePath() + "/c.log.*");
  Configurables.configure(source,context);
  source.start();
  source.process();
  Transaction txn=channel.getTransaction();
  txn.begin();
  List<String> out=Lists.newArrayList();
  for (int i=0; i < 5; i++) {
    Event e=channel.take();
    if (e != null) {
      out.add(TestTaildirEventReader.bodyAsString(e));
    }
  }
  txn.commit();
  txn.close();
  assertEquals(4,out.size());
  assertTrue(out.contains("a.log"));
  assertFalse(out.contains("a.log.1"));
  assertTrue(out.contains("b.log"));
  assertTrue(out.contains("c.log.yyyy-MM-01"));
  assertTrue(out.contains("c.log.yyyy-MM-02"));
}

</code></pre>

<br>
<pre class="type-12 type-10 type-1 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLifecycle() throws IOException, InterruptedException {
  File f1=new File(tmpDir,"file1");
  Files.write("file1line1\nfile1line2\n",f1,Charsets.UTF_8);
  Context context=new Context();
  context.put(POSITION_FILE,posFilePath);
  context.put(FILE_GROUPS,"f1");
  context.put(FILE_GROUPS_PREFIX + "f1",tmpDir.getAbsolutePath() + "/file1$");
  Configurables.configure(source,context);
  for (int i=0; i < 3; i++) {
    source.start();
    source.process();
    assertTrue("Reached start or error",LifecycleController.waitForOneOf(source,LifecycleState.START_OR_ERROR));
    assertEquals("Server is started",LifecycleState.START,source.getLifecycleState());
    source.stop();
    assertTrue("Reached stop or error",LifecycleController.waitForOneOf(source,LifecycleState.STOP_OR_ERROR));
    assertEquals("Server is stopped",LifecycleState.STOP,source.getLifecycleState());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.test.agent.TestSpooldirSource </h4><pre class="type-12 type-9 type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  File agentDir=StagedInstall.getInstance().getStageDir();
  LOGGER.debug("Using agent stage dir: {}",agentDir);
  File testDir=new File(agentDir,TestSpooldirSource.class.getName());
  assertTrue(testDir.mkdirs());
  File spoolParentDir=new File(testDir,"spools");
  assertTrue("Unable to create sink output dir: " + spoolParentDir.getPath(),spoolParentDir.mkdir());
  final int NUM_SOURCES=100;
  agentProps=new Properties();
  List<String> spooldirSrcNames=Lists.newArrayList();
  String channelName="mem-01";
  for (int i=0; i < NUM_SOURCES; i++) {
    String srcName=String.format("spooldir-%03d",i);
    File spoolDir=new File(spoolParentDir,srcName);
    assertTrue(spoolDir.mkdir());
    spooldirSrcNames.add(srcName);
    spoolDirs.add(spoolDir);
    agentProps.put(String.format("agent.sources.%s.type",srcName),"SPOOLDIR");
    agentProps.put(String.format("agent.sources.%s.spoolDir",srcName),spoolDir.getPath());
    agentProps.put(String.format("agent.sources.%s.channels",srcName),channelName);
  }
  agentProps.put("agent.channels.mem-01.type","MEMORY");
  agentProps.put("agent.channels.mem-01.capacity",String.valueOf(100000));
  sinkOutputDir=new File(testDir,"out");
  assertTrue("Unable to create sink output dir: " + sinkOutputDir.getPath(),sinkOutputDir.mkdir());
  agentProps.put("agent.sinks.roll-01.channel",channelName);
  agentProps.put("agent.sinks.roll-01.type","FILE_ROLL");
  agentProps.put("agent.sinks.roll-01.sink.directory",sinkOutputDir.getPath());
  agentProps.put("agent.sinks.roll-01.sink.rollInterval","0");
  agentProps.put("agent.sources",Joiner.on(" ").join(spooldirSrcNames));
  agentProps.put("agent.channels",channelName);
  agentProps.put("agent.sinks","roll-01");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.tools.TestFileChannelIntegrityTool </h4><pre class="type-4 type-10 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  checkpointDir=new File(baseDir,"checkpoint");
  dataDir=new File(baseDir,"dataDir");
  Assert.assertTrue(checkpointDir.mkdirs() || checkpointDir.isDirectory());
  Assert.assertTrue(dataDir.mkdirs() || dataDir.isDirectory());
  File[] dataFiles=origDataDir.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      if (name.contains("lock")) {
        return false;
      }
      return true;
    }
  }
);
  for (  File dataFile : dataFiles) {
    Serialization.copyFile(dataFile,new File(dataDir,dataFile.getName()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.flume.tools.TestVersionInfo </h4><pre class="type-10 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that Unknown is expected when no version info
 */
@Test public void testVersionInfoUnknown(){
  logger.debug("Flume " + VersionInfo.getVersion());
  logger.debug("Subversion " + VersionInfo.getUrl() + " -r "+ VersionInfo.getRevision());
  logger.debug("Compiled by " + VersionInfo.getUser() + " on "+ VersionInfo.getDate());
  logger.debug("From source with checksum " + VersionInfo.getSrcChecksum());
  logger.debug("Flume " + VersionInfo.getBuildVersion());
  assertTrue("getVersion returned Unknown",!VersionInfo.getVersion().equals("Unknown"));
  assertTrue("getUser returned Unknown",!VersionInfo.getUser().equals("Unknown"));
  assertTrue("getUrl returned Unknown",!VersionInfo.getUrl().equals("Unknown"));
  assertTrue("getSrcChecksum returned Unknown",!VersionInfo.getSrcChecksum().equals("Unknown"));
  assertTrue("getBuildVersion returned unexpected format",VersionInfo.getBuildVersion().matches(".+from.+by.+on.+source checksum.+"));
  assertNotNull("getRevision returned null",VersionInfo.getRevision());
  assertNotNull("getBranch returned null",VersionInfo.getBranch());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
