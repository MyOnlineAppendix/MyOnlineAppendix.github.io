<h3 style="margin:0px">Class: org.apache.cassandra.cql3.ViewSchemaTest (13 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(8)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTwoTablesOneView() throws Throwable {
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createTable("CREATE TABLE " + keyspace() + ".dummy_table ("+ "j int, "+ "intval int, "+ "PRIMARY KEY (j))");
  createTable("CREATE TABLE " + keyspace() + ".real_base ("+ "k int, "+ "intval int, "+ "PRIMARY KEY (k))");
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM " + keyspace() + ".real_base WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  createView("mv2","CREATE MATERIALIZED VIEW %s AS SELECT * FROM " + keyspace() + ".dummy_table WHERE j IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, j)");
  updateView("INSERT INTO " + keyspace() + ".real_base (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,0));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",0),row(0,0));
  updateView("INSERT INTO " + keyspace() + ".real_base (k, intval) VALUES (?, ?)",0,1);
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
  assertRows(execute("SELECT k, intval FROM " + keyspace() + ".real_base WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
  updateView("INSERT INTO " + keyspace() + ".dummy_table (j, intval) VALUES(?, ?)",0,1);
  assertRows(execute("SELECT j, intval FROM " + keyspace() + ".dummy_table WHERE j = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (b, a)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReuseName() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "intval int, "+ "PRIMARY KEY (k))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,0);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,0));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",0),row(0,0));
  executeNet(protocolVersion,"DROP MATERIALIZED VIEW mv");
  views.remove("mv");
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND intval IS NOT NULL PRIMARY KEY (intval, k)");
  updateView("INSERT INTO %s (k, intval) VALUES (?, ?)",0,1);
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,1));
  assertRows(execute("SELECT k, intval from mv WHERE intval = ?",1),row(0,1));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterReversedTypeBaseTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))"+ "WITH CLUSTERING ORDER BY (b DESC)");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b ASC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<pre class="type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropTableWithMV() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b, c))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView(keyspace() + ".mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, b, c)");
  try {
    executeNet(protocolVersion,"DROP TABLE " + keyspace() + ".mv1");
    Assert.fail();
  }
 catch (  InvalidQueryException e) {
    Assert.assertEquals("Cannot use DROP TABLE on Materialized View",e.getMessage());
  }
}

</code></pre>

<pre class="type-13 type-15 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testAllTypes() throws Throwable {
  String myType=createType("CREATE TYPE %s (a int, b uuid, c set<text>)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "asciival ascii, "+ "bigintval bigint, "+ "blobval blob, "+ "booleanval boolean, "+ "dateval date, "+ "decimalval decimal, "+ "doubleval double, "+ "floatval float, "+ "inetval inet, "+ "intval int, "+ "textval text, "+ "timeval time, "+ "timestampval timestamp, "+ "timeuuidval timeuuid, "+ "uuidval uuid,"+ "varcharval varchar, "+ "varintval varint, "+ "listval list<int>, "+ "frozenlistval frozen<list<int>>, "+ "setval set<uuid>, "+ "frozensetval frozen<set<uuid>>, "+ "mapval map<ascii, int>,"+ "frozenmapval frozen<map<ascii, int>>,"+ "tupleval frozen<tuple<int, ascii, uuid>>,"+ "udtval frozen<" + myType + ">)");
  CFMetaData metadata=currentTableMetadata();
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  for (  ColumnDefinition def : new HashSet<>(metadata.allColumns())) {
    try {
      createView("mv_" + def.name,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL PRIMARY KEY ("+ def.name+ ",k)");
      if (def.type.isMultiCell())       Assert.fail("MV on a multicell should fail " + def);
      if (def.isPartitionKey())       Assert.fail("MV on partition key should fail " + def);
    }
 catch (    InvalidQueryException e) {
      if (!def.type.isMultiCell() && !def.isPartitionKey())       Assert.fail("MV creation failed on " + def);
    }
  }
  assertInvalidMessage("fromJson() cannot be used in the selection clause","SELECT fromJson(asciival) FROM %s",0,0);
  String func1=createFunction(KEYSPACE,"int","CREATE FUNCTION %s (a int) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return a.toString(); $$");
  createFunctionOverload(func1,"int","CREATE FUNCTION %s (a text) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return new String(a); $$");
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii \\\" text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii \" text"));
  assertRows(execute("SELECT asciival FROM %s WHERE k = fromJson(?)","0"),row("ascii \" text"));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii text"));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"),row(0,null));
  updateView("UPDATE %s SET asciival = fromJson(?) WHERE k = fromJson(?)","\"ascii \\\" text\"","0");
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"),row(0,null));
  updateView("DELETE FROM %s WHERE k = fromJson(?)","0");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"));
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii text"),row(0,null));
  updateView("INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, bigintval FROM %s WHERE k = ?",0),row(0,123123123123L));
  assertRows(execute("SELECT k, asciival from mv_bigintval WHERE bigintval = ?",123123123123L),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"0x00000001\"");
  assertRows(execute("SELECT k, blobval FROM %s WHERE k = ?",0),row(0,ByteBufferUtil.bytes(1)));
  assertRows(execute("SELECT k, asciival from mv_blobval WHERE blobval = ?",ByteBufferUtil.bytes(1)),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"true");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,true));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",true),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"false");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,false));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",true));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",false),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, dateval) VALUES (?, fromJson(?))",0,"\"1987-03-23\"");
  assertRows(execute("SELECT k, dateval FROM %s WHERE k = ?",0),row(0,SimpleDateSerializer.dateStringToDays("1987-03-23")));
  assertRows(execute("SELECT k, asciival from mv_dateval WHERE dateval = fromJson(?)","\"1987-03-23\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123.123123"));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"123123.123123\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"-1.23E-12\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("-1.23E-12")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","\"-1.23E-12\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.123123d));
  assertRows(execute("SELECT k, asciival from mv_doubleval WHERE doubleval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.0d));
  assertRows(execute("SELECT k, asciival from mv_doubleval WHERE doubleval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.123123f));
  assertRows(execute("SELECT k, asciival from mv_floatval WHERE floatval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.0f));
  assertRows(execute("SELECT k, asciival from mv_floatval WHERE floatval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"127.0.0.1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("127.0.0.1")));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"127.0.0.1\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"::1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("::1")));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"127.0.0.1\""));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"::1\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,123123));
  assertRows(execute("SELECT k, asciival from mv_intval WHERE intval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"some \\\" text\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"some \" text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"\\u2013\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"\u2013"));
  assertRows(execute("SELECT k, asciival from mv_textval WHERE textval = fromJson(?)","\"\\u2013\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"abcd\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"abcd"));
  assertRows(execute("SELECT k, asciival from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timeval) VALUES (?, fromJson(?))",0,"\"07:35:07.000111222\"");
  assertRows(execute("SELECT k, timeval FROM %s WHERE k = ?",0),row(0,TimeSerializer.timeStringToLong("07:35:07.000111222")));
  assertRows(execute("SELECT k, asciival from mv_timeval WHERE timeval = fromJson(?)","\"07:35:07.000111222\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new Date(123123123123L)));
  assertRows(execute("SELECT k, asciival from mv_timestampval WHERE timestampval = fromJson(?)","123123123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"\"2014-01-01\"");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new SimpleDateFormat("y-M-d").parse("2014-01-01")));
  assertRows(execute("SELECT k, asciival from mv_timestampval WHERE timestampval = fromJson(?)","\"2014-01-01\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  updateView("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertRows(execute("SELECT k, asciival from mv_timeuuidval WHERE timeuuidval = fromJson(?)","\"6BDDC89A-5644-11E4-97FC-56847AFE9799\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  updateView("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertRows(execute("SELECT k, asciival from mv_uuidval WHERE uuidval = fromJson(?)","\"6BDDC89A-5644-11E4-97FC-56847AFE9799\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("123123123123")));
  assertRows(execute("SELECT k, asciival from mv_varintval WHERE varintval = fromJson(?)","123123123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"\"1234567890123456789012345678901234567890\"");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("1234567890123456789012345678901234567890")));
  assertRows(execute("SELECT k, asciival from mv_varintval WHERE varintval = fromJson(?)","\"1234567890123456789012345678901234567890\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2,3)));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[1]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1)));
  updateView("UPDATE %s SET listval = listval + fromJson(?) WHERE k = ?","[2]",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2)));
  updateView("UPDATE %s SET listval = fromJson(?) + listval WHERE k = ?","[0]",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,1,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,1,2)));
  updateView("UPDATE %s SET listval[1] = fromJson(?) WHERE k = ?","10",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,10,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,10,2)));
  updateView("DELETE listval[1] FROM %s WHERE k = ?",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,2)));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[1, 2, 3]"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[3, 2, 1]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list(3,2,1)));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[1, 2, 3]"));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[3, 2, 1]"),row(0,"abcd"));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(3,2,1)));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list()));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list()));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("UPDATE %s SET setval = setval + fromJson(?) WHERE k = ?","[\"6bddc89a-5644-0000-97fc-56847afe9799\"]",0);
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-0000-97fc-56847afe9799"),UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-0000-97fc-56847afe9799"),UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("UPDATE %s SET setval = setval - fromJson(?) WHERE k = ?","[\"6bddc89a-5644-0000-97fc-56847afe9799\"]",0);
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, frozensetval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-0000-11e4-97fc-56847afe9799\", \"6bddc89a-5644-11e4-97fc-56847afe9798\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-0000-11e4-97fc-56847afe9799"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798")))));
  assertRows(execute("SELECT k, frozensetval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-0000-11e4-97fc-56847afe9799"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798")))));
  updateView("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",2)));
  updateView("UPDATE %s SET mapval[?] = ?  WHERE k = ?","c",3,0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",2,"c",3)));
  updateView("UPDATE %s SET mapval[?] = ?  WHERE k = ?","b",10,0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",10,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",10,"c",3)));
  updateView("DELETE mapval[?] FROM %s WHERE k = ?","b",0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"c",3)));
  updateView("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  assertRows(execute("SELECT k, textval FROM mv_frozenmapval WHERE frozenmapval = fromJson(?)","{\"a\": 1, \"b\": 2}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"b\": 2, \"a\": 3}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",3,"b",2)));
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",3,"b",2)));
  updateView("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))),row(0,"abcd"));
  updateView("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, null, \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"a\": 1, \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\"}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),null));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\"}"),row(0,"abcd"));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterReversedTypeViewTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterClusteringViewTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b text,"+ "PRIMARY KEY (a))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  alterTable("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterViewTableValue() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "PRIMARY KEY (a))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (a, b) WITH CLUSTERING ORDER BY (b DESC)");
  assertInvalid("ALTER TABLE %s ALTER b TYPE blob");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void begin(){
  views.clear();
}

</code></pre>

<pre class="type-15 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessAndSchema() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "asciival ascii, "+ "bigintval bigint, "+ "PRIMARY KEY((k, asciival)))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE bigintval IS NOT NULL AND k IS NOT NULL AND asciival IS NOT NULL PRIMARY KEY (bigintval, k, asciival)");
  updateView("INSERT INTO %s(k,asciival,bigintval)VALUES(?,?,?)",0,"foo",1L);
  try {
    updateView("INSERT INTO mv1_test(k,asciival,bigintval) VALUES(?,?,?)",1,"foo",2L);
    Assert.fail("Shouldn't be able to modify a MV directly");
  }
 catch (  Exception e) {
  }
  try {
    executeNet(protocolVersion,"ALTER TABLE mv1_test ADD foo text");
    Assert.fail("Should not be able to use alter table with MV");
  }
 catch (  Exception e) {
  }
  try {
    executeNet(protocolVersion,"ALTER TABLE mv1_test WITH compaction = { 'class' : 'LeveledCompactionStrategy' }");
    Assert.fail("Should not be able to use alter table with MV");
  }
 catch (  Exception e) {
  }
  executeNet(protocolVersion,"ALTER MATERIALIZED VIEW mv1_test WITH compaction = { 'class' : 'LeveledCompactionStrategy' }");
  executeNet(protocolVersion,"ALTER TABLE %s ADD foo text");
  CFMetaData metadata=Schema.instance.getCFMetaData(keyspace(),"mv1_test");
  Assert.assertNotNull(metadata.getColumnDefinition(ByteBufferUtil.bytes("foo")));
  updateView("INSERT INTO %s(k,asciival,bigintval,foo)VALUES(?,?,?,?)",0,"foo",1L,"bar");
  assertRows(execute("SELECT foo from %s"),row("bar"));
  executeNet(protocolVersion,"ALTER TABLE %s RENAME asciival TO bar");
  assertRows(execute("SELECT bar from %s"),row("foo"));
  metadata=Schema.instance.getCFMetaData(keyspace(),"mv1_test");
  Assert.assertNotNull(metadata.getColumnDefinition(ByteBufferUtil.bytes("bar")));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCaseSensitivity() throws Throwable {
  createTable("CREATE TABLE %s (\"theKey\" int, \"theClustering\" int, \"theValue\" int, PRIMARY KEY (\"theKey\", \"theClustering\"))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  execute("INSERT INTO %s (\"theKey\", \"theClustering\", \"theValue\") VALUES (?, ?, ?)",0,0,0);
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s " + "WHERE \"theKey\" IS NOT NULL AND \"theClustering\" IS NOT NULL AND \"theValue\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test"))   Thread.sleep(10);
  createView("mv_test2","CREATE MATERIALIZED VIEW %s AS SELECT \"theKey\", \"theClustering\", \"theValue\" FROM %%s " + "WHERE \"theKey\" IS NOT NULL AND \"theClustering\" IS NOT NULL AND \"theValue\" IS NOT NULL " + "PRIMARY KEY (\"theKey\", \"theClustering\")");
  while (!SystemKeyspace.isViewBuilt(keyspace(),"mv_test2"))   Thread.sleep(10);
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRows(execute("SELECT \"theKey\", \"theClustering\", \"theValue\" FROM " + mvname),row(0,0,0));
  }
  executeNet(protocolVersion,"ALTER TABLE %s RENAME \"theClustering\" TO \"Col\"");
  for (  String mvname : Arrays.asList("mv_test","mv_test2")) {
    assertRows(execute("SELECT \"theKey\", \"Col\", \"theValue\" FROM " + mvname),row(0,0,0));
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void end() throws Throwable {
  for (  String viewName : views)   executeNet(protocolVersion,"DROP MATERIALIZED VIEW " + viewName);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
