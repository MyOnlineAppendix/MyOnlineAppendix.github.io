<h3 style="margin:0px">Class: org.apache.cassandra.db.rows.RowsTest (9 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="18"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('18')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-18"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(5)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
/** 
 * input row has no column data
 */
@Test public void diffEmptyInput(){
}

</code></pre>

<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
@Test public void diff(){
}

</code></pre>

<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
/** 
 * merged row has no column data
 */
@Test public void diffEmptyMerged(){
}

</code></pre>

<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
@Test public void copy(){
}

</code></pre>

<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * If a row's deletion time deletes a row's liveness info, the new row should have it's
 * liveness info set to empty
 */
@Test public void mergeRowDeletionSupercedesLiveness(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,null,null,null);
  int now2=now1 + 1;
  Row.Builder updateBuilder=createBuilder(c1,now2,BB1,BB1,BB1);
  int now3=now2 + 1;
  Row.Deletion expectedDeletion=new Row.Deletion(new DeletionTime(secondToTs(now3),now3),false);
  updateBuilder.addRowDeletion(expectedDeletion);
  RowBuilder builder=new RowBuilder();
  Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now3 + 1);
  Assert.assertEquals(expectedDeletion,builder.deletionTime);
  Assert.assertEquals(LivenessInfo.EMPTY,builder.livenessInfo);
  Assert.assertEquals(Collections.emptyList(),builder.complexDeletions);
  Assert.assertEquals(Collections.emptyList(),builder.cells);
}

</code></pre>

<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
@Test public void collectStats(){
}

</code></pre>

<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void merge(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,BB1,BB1,BB1);
  int now2=now1 + 1;
  long ts2=secondToTs(now2);
  Cell expectedVCell=BufferCell.live(kcvm,v,ts2,BB2);
  Cell expectedMCell=BufferCell.live(kcvm,m,ts2,BB2,CellPath.create(BB1));
  DeletionTime expectedComplexDeletionTime=new DeletionTime(ts2 - 1,now2);
  Row.Builder updateBuilder=createBuilder(c1,now2,null,null,null);
  updateBuilder.addCell(expectedVCell);
  updateBuilder.addComplexDeletion(m,expectedComplexDeletionTime);
  updateBuilder.addCell(expectedMCell);
  RowBuilder builder=new RowBuilder();
  long td=Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now2 + 1);
  Assert.assertEquals(c1,builder.clustering);
  Assert.assertEquals(LivenessInfo.create(kcvm,ts2,now2),builder.livenessInfo);
  Assert.assertEquals(Lists.newArrayList(Pair.create(m,new DeletionTime(ts2 - 1,now2))),builder.complexDeletions);
  Assert.assertEquals(2,builder.cells.size());
  Assert.assertEquals(Lists.newArrayList(expectedVCell,expectedMCell),Lists.newArrayList(builder.cells));
  Assert.assertEquals(ts2 - secondToTs(now1),td);
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyCellIterator(){
  CFMetaData metadata=CFMetaData.Builder.create("dummy_ks","dummy_tbl").addPartitionKey("k",BytesType.instance).addRegularColumn("a",BytesType.instance).addRegularColumn("b",MapType.getInstance(Int32Type.instance,BytesType.instance,true)).addRegularColumn("c",BytesType.instance).addRegularColumn("d",MapType.getInstance(Int32Type.instance,BytesType.instance,true)).addRegularColumn("e",BytesType.instance).build();
  ColumnDefinition a=metadata.getColumnDefinition(new ColumnIdentifier("a",false));
  ColumnDefinition b=metadata.getColumnDefinition(new ColumnIdentifier("b",false));
  ColumnDefinition c=metadata.getColumnDefinition(new ColumnIdentifier("c",false));
  ColumnDefinition d=metadata.getColumnDefinition(new ColumnIdentifier("d",false));
  ColumnDefinition e=metadata.getColumnDefinition(new ColumnIdentifier("e",false));
  Row row;
  row=makeDummyRow(liveCell(a),liveCell(c),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(a),liveCell(c),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(e),liveCell(c),liveCell(a));
  row=makeDummyRow(liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(d,4),liveCell(d,3),liveCell(b,2),liveCell(b,1));
  row=makeDummyRow(liveCell(a),liveCell(c),liveCell(e),liveCell(b,1),liveCell(b,2),liveCell(d,3),liveCell(d,4));
  assertCellOrder(row.cellsInLegacyOrder(metadata,false),liveCell(a),liveCell(b,1),liveCell(b,2),liveCell(c),liveCell(d,3),liveCell(d,4),liveCell(e));
  assertCellOrder(row.cellsInLegacyOrder(metadata,true),liveCell(e),liveCell(d,4),liveCell(d,3),liveCell(c),liveCell(b,2),liveCell(b,1),liveCell(a));
}

</code></pre>

<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void mergeComplexDeletionSupersededByRowDeletion(){
  int now1=FBUtilities.nowInSeconds();
  Row.Builder existingBuilder=createBuilder(c1,now1,null,null,null);
  int now2=now1 + 1;
  Row.Builder updateBuilder=createBuilder(c1,now2,null,BB1,BB1);
  int now3=now2 + 1;
  Row.Deletion expectedDeletion=new Row.Deletion(new DeletionTime(secondToTs(now3),now3),false);
  updateBuilder.addRowDeletion(expectedDeletion);
  RowBuilder builder=new RowBuilder();
  Rows.merge(existingBuilder.build(),updateBuilder.build(),builder,now3 + 1);
  Assert.assertEquals(expectedDeletion,builder.deletionTime);
  Assert.assertEquals(Collections.emptyList(),builder.complexDeletions);
  Assert.assertEquals(Collections.emptyList(),builder.cells);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
