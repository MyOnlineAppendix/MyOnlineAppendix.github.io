<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cassandra.concurrent.DebuggableScheduledThreadPoolExecutorTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testShutdown() throws ExecutionException, InterruptedException, IOException {
  DebuggableScheduledThreadPoolExecutor testPool=new DebuggableScheduledThreadPoolExecutor("testpool");
  final AtomicInteger value=new AtomicInteger(0);
  ScheduledFuture future=testPool.schedule(new Runnable(){
    public void run(){
      value.incrementAndGet();
    }
  }
,1,TimeUnit.SECONDS);
  future.get();
  assert value.get() == 1;
  future=testPool.schedule(new Runnable(){
    public void run(){
      value.incrementAndGet();
    }
  }
,10,TimeUnit.SECONDS);
  StorageService.instance.drain();
  testPool.shutdown();
  future.get();
  assert value.get() == 2;
  future=testPool.schedule(new Runnable(){
    public void run(){
      value.incrementAndGet();
    }
  }
,1,TimeUnit.SECONDS);
  try {
    future.get(2,TimeUnit.SECONDS);
    Assert.fail("Task should be cancelled");
  }
 catch (  CancellationException e) {
  }
catch (  TimeoutException e) {
    Assert.fail("Task should be cancelled");
  }
  assert future.isCancelled();
  assert value.get() == 2;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.PreparedStatementsTest </h4><pre class="type-7 type-15 type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void prepareAndExecuteWithCustomExpressions() throws Throwable {
  session.execute(dropKsStatement);
  session.execute(createKsStatement);
  String table="custom_expr_test";
  String index="custom_index";
  session.execute(String.format("CREATE TABLE IF NOT EXISTS %s.%s (id int PRIMARY KEY, cid int, val text);",KEYSPACE,table));
  session.execute(String.format("CREATE CUSTOM INDEX %s ON %s.%s(val) USING '%s'",index,KEYSPACE,table,StubIndex.class.getName()));
  session.execute(String.format("INSERT INTO %s.%s(id, cid, val) VALUES (0, 0, 'test')",KEYSPACE,table));
  PreparedStatement prepared1=session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(%s, 'foo')",KEYSPACE,table,index));
  assertEquals(1,session.execute(prepared1.bind()).all().size());
  PreparedStatement prepared2=session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(%s, ?)",KEYSPACE,table,index));
  assertEquals(1,session.execute(prepared2.bind("foo bar baz")).all().size());
  try {
    session.prepare(String.format("SELECT * FROM %s.%s WHERE expr(?, 'foo bar baz')",KEYSPACE,table));
    fail("Expected syntax exception, but none was thrown");
  }
 catch (  SyntaxError e) {
    assertEquals("Bind variables cannot be used for index names",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.UDHelperTest </h4><pre class="type-15 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNonEmptyPrimitiveTypes(){
  AbstractType<?>[] types=new AbstractType<?>[]{TimeType.instance,SimpleDateType.instance,ByteType.instance,ShortType.instance};
  for (  AbstractType<?> type : types) {
    try {
      type.getSerializer().validate(ByteBufferUtil.EMPTY_BYTE_BUFFER);
      Assert.fail(type.getClass().getSimpleName());
    }
 catch (    MarshalException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewFilteringTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMVCreationSelectRestrictions() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, e int, PRIMARY KEY((a, b), c, d))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  List<String> badStatements=Arrays.asList("CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL AND d is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND c IS NOT NULL AND d is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND d is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND c is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = ? AND b IS NOT NULL AND c is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = blobAsInt(?) AND b IS NOT NULL AND c is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s PRIMARY KEY (a, b, c, d)");
  for (  String badStatement : badStatements) {
    try {
      createView("mv1_test",badStatement);
      Assert.fail("Create MV statement should have failed due to missing IS NOT NULL restriction: " + badStatement);
    }
 catch (    InvalidQueryException exc) {
    }
  }
  List<String> goodStatements=Arrays.asList("CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND c IS NOT NULL AND d is NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND c = 1 AND d IS NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND c = 1 AND d = 1 PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND c = 1 AND d = 1 PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND c > 1 AND d IS NOT NULL PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND c = 1 AND d IN (1, 2, 3) PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND (c, d) = (1, 1) PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND (c, d) > (1, 1) PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b = 1 AND (c, d) IN ((1, 1), (2, 2)) PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = (int) 1 AND b = 1 AND c = 1 AND d = 1 PRIMARY KEY ((a, b), c, d)","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = blobAsInt(intAsBlob(1)) AND b = 1 AND c = 1 AND d = 1 PRIMARY KEY ((a, b), c, d)");
  for (int i=0; i < goodStatements.size(); i++) {
    try {
      createView("mv" + i + "_test",goodStatements.get(i));
    }
 catch (    Exception e) {
      throw new RuntimeException("MV creation failed: " + goodStatements.get(i),e);
    }
    try {
      executeNet(protocolVersion,"ALTER MATERIALIZED VIEW mv" + i + "_test WITH compaction = { 'class' : 'LeveledCompactionStrategy' }");
    }
 catch (    Exception e) {
      throw new RuntimeException("MV alter failed: " + goodStatements.get(i),e);
    }
  }
  try {
    createView("mv_foo","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a = 1 AND b IS NOT NULL AND c IS NOT NULL AND d is NOT NULL PRIMARY KEY ((a, b), c, d)");
    Assert.fail("Partial partition key restriction should not be allowed");
  }
 catch (  InvalidQueryException exc) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewSchemaTest </h4><pre class="type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropTableWithMV() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b, c))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView(keyspace() + ".mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE b IS NOT NULL AND c IS NOT NULL PRIMARY KEY (a, b, c)");
  try {
    executeNet(protocolVersion,"DROP TABLE " + keyspace() + ".mv1");
    Assert.fail();
  }
 catch (  InvalidQueryException e) {
    Assert.assertEquals("Cannot use DROP TABLE on Materialized View",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-13 type-15 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testAllTypes() throws Throwable {
  String myType=createType("CREATE TYPE %s (a int, b uuid, c set<text>)");
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "asciival ascii, "+ "bigintval bigint, "+ "blobval blob, "+ "booleanval boolean, "+ "dateval date, "+ "decimalval decimal, "+ "doubleval double, "+ "floatval float, "+ "inetval inet, "+ "intval int, "+ "textval text, "+ "timeval time, "+ "timestampval timestamp, "+ "timeuuidval timeuuid, "+ "uuidval uuid,"+ "varcharval varchar, "+ "varintval varint, "+ "listval list<int>, "+ "frozenlistval frozen<list<int>>, "+ "setval set<uuid>, "+ "frozensetval frozen<set<uuid>>, "+ "mapval map<ascii, int>,"+ "frozenmapval frozen<map<ascii, int>>,"+ "tupleval frozen<tuple<int, ascii, uuid>>,"+ "udtval frozen<" + myType + ">)");
  CFMetaData metadata=currentTableMetadata();
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  for (  ColumnDefinition def : new HashSet<>(metadata.allColumns())) {
    try {
      createView("mv_" + def.name,"CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL PRIMARY KEY ("+ def.name+ ",k)");
      if (def.type.isMultiCell())       Assert.fail("MV on a multicell should fail " + def);
      if (def.isPartitionKey())       Assert.fail("MV on partition key should fail " + def);
    }
 catch (    InvalidQueryException e) {
      if (!def.type.isMultiCell() && !def.isPartitionKey())       Assert.fail("MV creation failed on " + def);
    }
  }
  assertInvalidMessage("fromJson() cannot be used in the selection clause","SELECT fromJson(asciival) FROM %s",0,0);
  String func1=createFunction(KEYSPACE,"int","CREATE FUNCTION %s (a int) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return a.toString(); $$");
  createFunctionOverload(func1,"int","CREATE FUNCTION %s (a text) CALLED ON NULL INPUT RETURNS text LANGUAGE java AS $$ return new String(a); $$");
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii \\\" text\"");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0),row(0,"ascii \" text"));
  assertRows(execute("SELECT asciival FROM %s WHERE k = fromJson(?)","0"),row("ascii \" text"));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii text"));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"),row(0,null));
  updateView("UPDATE %s SET asciival = fromJson(?) WHERE k = fromJson(?)","\"ascii \\\" text\"","0");
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"),row(0,null));
  updateView("DELETE FROM %s WHERE k = fromJson(?)","0");
  assertRows(execute("SELECT k, asciival FROM %s WHERE k = ?",0));
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii \" text"));
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT k, udtval from mv_asciival WHERE asciival = ?","ascii text"),row(0,null));
  updateView("INSERT INTO %s (k, bigintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, bigintval FROM %s WHERE k = ?",0),row(0,123123123123L));
  assertRows(execute("SELECT k, asciival from mv_bigintval WHERE bigintval = ?",123123123123L),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, blobval) VALUES (?, fromJson(?))",0,"\"0x00000001\"");
  assertRows(execute("SELECT k, blobval FROM %s WHERE k = ?",0),row(0,ByteBufferUtil.bytes(1)));
  assertRows(execute("SELECT k, asciival from mv_blobval WHERE blobval = ?",ByteBufferUtil.bytes(1)),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"true");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,true));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",true),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, booleanval) VALUES (?, fromJson(?))",0,"false");
  assertRows(execute("SELECT k, booleanval FROM %s WHERE k = ?",0),row(0,false));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",true));
  assertRows(execute("SELECT k, asciival from mv_booleanval WHERE booleanval = ?",false),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, dateval) VALUES (?, fromJson(?))",0,"\"1987-03-23\"");
  assertRows(execute("SELECT k, dateval FROM %s WHERE k = ?",0),row(0,SimpleDateSerializer.dateStringToDays("1987-03-23")));
  assertRows(execute("SELECT k, asciival from mv_dateval WHERE dateval = fromJson(?)","\"1987-03-23\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123.123123"));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"123123.123123\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("123123.123123")));
  updateView("INSERT INTO %s (k, decimalval) VALUES (?, fromJson(?))",0,"\"-1.23E-12\"");
  assertRows(execute("SELECT k, decimalval FROM %s WHERE k = ?",0),row(0,new BigDecimal("-1.23E-12")));
  assertRows(execute("SELECT k, asciival from mv_decimalval WHERE decimalval = fromJson(?)","\"-1.23E-12\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.123123d));
  assertRows(execute("SELECT k, asciival from mv_doubleval WHERE doubleval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, doubleval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, doubleval FROM %s WHERE k = ?",0),row(0,123123.0d));
  assertRows(execute("SELECT k, asciival from mv_doubleval WHERE doubleval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123.123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.123123f));
  assertRows(execute("SELECT k, asciival from mv_floatval WHERE floatval = fromJson(?)","123123.123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, floatval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, floatval FROM %s WHERE k = ?",0),row(0,123123.0f));
  assertRows(execute("SELECT k, asciival from mv_floatval WHERE floatval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"127.0.0.1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("127.0.0.1")));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"127.0.0.1\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, inetval) VALUES (?, fromJson(?))",0,"\"::1\"");
  assertRows(execute("SELECT k, inetval FROM %s WHERE k = ?",0),row(0,InetAddress.getByName("::1")));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"127.0.0.1\""));
  assertRows(execute("SELECT k, asciival from mv_inetval WHERE inetval = fromJson(?)","\"::1\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, intval) VALUES (?, fromJson(?))",0,"123123");
  assertRows(execute("SELECT k, intval FROM %s WHERE k = ?",0),row(0,123123));
  assertRows(execute("SELECT k, asciival from mv_intval WHERE intval = fromJson(?)","123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"some \\\" text\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"some \" text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"\\u2013\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"\u2013"));
  assertRows(execute("SELECT k, asciival from mv_textval WHERE textval = fromJson(?)","\"\\u2013\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, textval) VALUES (?, fromJson(?))",0,"\"abcd\"");
  assertRows(execute("SELECT k, textval FROM %s WHERE k = ?",0),row(0,"abcd"));
  assertRows(execute("SELECT k, asciival from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timeval) VALUES (?, fromJson(?))",0,"\"07:35:07.000111222\"");
  assertRows(execute("SELECT k, timeval FROM %s WHERE k = ?",0),row(0,TimeSerializer.timeStringToLong("07:35:07.000111222")));
  assertRows(execute("SELECT k, asciival from mv_timeval WHERE timeval = fromJson(?)","\"07:35:07.000111222\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new Date(123123123123L)));
  assertRows(execute("SELECT k, asciival from mv_timestampval WHERE timestampval = fromJson(?)","123123123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timestampval) VALUES (?, fromJson(?))",0,"\"2014-01-01\"");
  assertRows(execute("SELECT k, timestampval FROM %s WHERE k = ?",0),row(0,new SimpleDateFormat("y-M-d").parse("2014-01-01")));
  assertRows(execute("SELECT k, asciival from mv_timestampval WHERE timestampval = fromJson(?)","\"2014-01-01\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  updateView("INSERT INTO %s (k, timeuuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, timeuuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertRows(execute("SELECT k, asciival from mv_timeuuidval WHERE timeuuidval = fromJson(?)","\"6BDDC89A-5644-11E4-97FC-56847AFE9799\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6bddc89a-5644-11e4-97fc-56847afe9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  updateView("INSERT INTO %s (k, uuidval) VALUES (?, fromJson(?))",0,"\"6BDDC89A-5644-11E4-97FC-56847AFE9799\"");
  assertRows(execute("SELECT k, uuidval FROM %s WHERE k = ?",0),row(0,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")));
  assertRows(execute("SELECT k, asciival from mv_uuidval WHERE uuidval = fromJson(?)","\"6BDDC89A-5644-11E4-97FC-56847AFE9799\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"123123123123");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("123123123123")));
  assertRows(execute("SELECT k, asciival from mv_varintval WHERE varintval = fromJson(?)","123123123123"),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, varintval) VALUES (?, fromJson(?))",0,"\"1234567890123456789012345678901234567890\"");
  assertRows(execute("SELECT k, varintval FROM %s WHERE k = ?",0),row(0,new BigInteger("1234567890123456789012345678901234567890")));
  assertRows(execute("SELECT k, asciival from mv_varintval WHERE varintval = fromJson(?)","\"1234567890123456789012345678901234567890\""),row(0,"ascii text"));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2,3)));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[1]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1)));
  updateView("UPDATE %s SET listval = listval + fromJson(?) WHERE k = ?","[2]",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(1,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2)));
  updateView("UPDATE %s SET listval = fromJson(?) + listval WHERE k = ?","[0]",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,1,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,1,2)));
  updateView("UPDATE %s SET listval[1] = fromJson(?) WHERE k = ?","10",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,10,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,10,2)));
  updateView("DELETE listval[1] FROM %s WHERE k = ?",0);
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,list(0,2)));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(0,2)));
  updateView("INSERT INTO %s (k, listval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, listval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, listval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[1, 2, 3]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(1,2,3)));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[1, 2, 3]"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[3, 2, 1]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list(3,2,1)));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[1, 2, 3]"));
  assertRows(execute("SELECT k, textval from mv_frozenlistval where frozenlistval = fromJson(?)","[3, 2, 1]"),row(0,"abcd"));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list(3,2,1)));
  updateView("INSERT INTO %s (k, frozenlistval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, frozenlistval FROM %s WHERE k = ?",0),row(0,list()));
  assertRows(execute("SELECT k, frozenlistval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,list()));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("UPDATE %s SET setval = setval + fromJson(?) WHERE k = ?","[\"6bddc89a-5644-0000-97fc-56847afe9799\"]",0);
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-0000-97fc-56847afe9799"),UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-0000-97fc-56847afe9799"),UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("UPDATE %s SET setval = setval - fromJson(?) WHERE k = ?","[\"6bddc89a-5644-0000-97fc-56847afe9799\"]",0);
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, setval) VALUES (?, fromJson(?))",0,"[]");
  assertRows(execute("SELECT k, setval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, setval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-5644-11e4-97fc-56847afe9798\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  assertRows(execute("SELECT k, frozensetval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799")))));
  updateView("INSERT INTO %s (k, frozensetval) VALUES (?, fromJson(?))",0,"[\"6bddc89a-0000-11e4-97fc-56847afe9799\", \"6bddc89a-5644-11e4-97fc-56847afe9798\"]");
  assertRows(execute("SELECT k, frozensetval FROM %s WHERE k = ?",0),row(0,set(UUID.fromString("6bddc89a-0000-11e4-97fc-56847afe9799"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798")))));
  assertRows(execute("SELECT k, frozensetval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,set(UUID.fromString("6bddc89a-0000-11e4-97fc-56847afe9799"),(UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9798")))));
  updateView("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",2)));
  updateView("UPDATE %s SET mapval[?] = ?  WHERE k = ?","c",3,0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",2,"c",3)));
  updateView("UPDATE %s SET mapval[?] = ?  WHERE k = ?","b",10,0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",10,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"b",10,"c",3)));
  updateView("DELETE mapval[?] FROM %s WHERE k = ?","b",0);
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,map("a",1,"c",3)));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,map("a",1,"c",3)));
  updateView("INSERT INTO %s (k, mapval) VALUES (?, fromJson(?))",0,"{}");
  assertRows(execute("SELECT k, mapval FROM %s WHERE k = ?",0),row(0,null));
  assertRows(execute("SELECT k, mapval from mv_textval WHERE textval = fromJson(?)","\"abcd\""),row(0,null));
  updateView("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": 2}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",1,"b",2)));
  assertRows(execute("SELECT k, textval FROM mv_frozenmapval WHERE frozenmapval = fromJson(?)","{\"a\": 1, \"b\": 2}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, frozenmapval) VALUES (?, fromJson(?))",0,"{\"b\": 2, \"a\": 3}");
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",3,"b",2)));
  assertRows(execute("SELECT k, frozenmapval FROM %s WHERE k = ?",0),row(0,map("a",3,"b",2)));
  updateView("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, \"foobar\", \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))),row(0,"abcd"));
  updateView("INSERT INTO %s (k, tupleval) VALUES (?, fromJson(?))",0,"[1, null, \"6bddc89a-5644-11e4-97fc-56847afe9799\"]");
  assertRows(execute("SELECT k, tupleval FROM %s WHERE k = ?",0),row(0,tuple(1,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,"foobar",UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))));
  assertRows(execute("SELECT k, textval FROM mv_tupleval WHERE tupleval = ?",tuple(1,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"))),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"a\": 1, \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,null,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),set("bar","foo")));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"),row(0,"abcd"));
  updateView("INSERT INTO %s (k, udtval) VALUES (?, fromJson(?))",0,"{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\"}");
  assertRows(execute("SELECT k, udtval.a, udtval.b, udtval.c FROM %s WHERE k = ?",0),row(0,1,UUID.fromString("6bddc89a-5644-11e4-97fc-56847afe9799"),null));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": null, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\", \"c\": [\"foo\", \"bar\"]}"));
  assertRows(execute("SELECT k, textval FROM mv_udtval WHERE udtval = fromJson(?)","{\"a\": 1, \"b\": \"6bddc89a-5644-11e4-97fc-56847afe9799\"}"),row(0,"abcd"));
}

</code></pre>

<br>
<pre class="type-15 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessAndSchema() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "asciival ascii, "+ "bigintval bigint, "+ "PRIMARY KEY((k, asciival)))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE bigintval IS NOT NULL AND k IS NOT NULL AND asciival IS NOT NULL PRIMARY KEY (bigintval, k, asciival)");
  updateView("INSERT INTO %s(k,asciival,bigintval)VALUES(?,?,?)",0,"foo",1L);
  try {
    updateView("INSERT INTO mv1_test(k,asciival,bigintval) VALUES(?,?,?)",1,"foo",2L);
    Assert.fail("Shouldn't be able to modify a MV directly");
  }
 catch (  Exception e) {
  }
  try {
    executeNet(protocolVersion,"ALTER TABLE mv1_test ADD foo text");
    Assert.fail("Should not be able to use alter table with MV");
  }
 catch (  Exception e) {
  }
  try {
    executeNet(protocolVersion,"ALTER TABLE mv1_test WITH compaction = { 'class' : 'LeveledCompactionStrategy' }");
    Assert.fail("Should not be able to use alter table with MV");
  }
 catch (  Exception e) {
  }
  executeNet(protocolVersion,"ALTER MATERIALIZED VIEW mv1_test WITH compaction = { 'class' : 'LeveledCompactionStrategy' }");
  executeNet(protocolVersion,"ALTER TABLE %s ADD foo text");
  CFMetaData metadata=Schema.instance.getCFMetaData(keyspace(),"mv1_test");
  Assert.assertNotNull(metadata.getColumnDefinition(ByteBufferUtil.bytes("foo")));
  updateView("INSERT INTO %s(k,asciival,bigintval,foo)VALUES(?,?,?,?)",0,"foo",1L,"bar");
  assertRows(execute("SELECT foo from %s"),row("bar"));
  executeNet(protocolVersion,"ALTER TABLE %s RENAME asciival TO bar");
  assertRows(execute("SELECT bar from %s"),row("foo"));
  metadata=Schema.instance.getCFMetaData(keyspace(),"mv1_test");
  Assert.assertNotNull(metadata.getColumnDefinition(ByteBufferUtil.bytes("bar")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewTest </h4><pre class="type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaticTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "c int, "+ "sval text static, "+ "val text, "+ "PRIMARY KEY(k,c))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  try {
    createView("mv_static","CREATE MATERIALIZED VIEW %%s AS SELECT * FROM %s WHERE sval IS NOT NULL AND k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (sval,k,c)");
    Assert.fail("MV on static should fail");
  }
 catch (  InvalidQueryException e) {
  }
  createView("mv_static","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE val IS NOT NULL AND k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (val,k,c)");
  for (int i=0; i < 100; i++)   updateView("INSERT into %s (k,c,sval,val)VALUES(?,?,?,?)",0,i % 2,"bar" + i,"baz");
  Assert.assertEquals(2,execute("select * from %s").size());
  assertRows(execute("SELECT sval from %s"),row("bar99"),row("bar99"));
  Assert.assertEquals(2,execute("select * from mv_static").size());
  assertInvalid("SELECT sval from mv_static");
}

</code></pre>

<br>
<pre class="type-13 type-15 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCompoundPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "asciival ascii, "+ "bigintval bigint, "+ "PRIMARY KEY((k, asciival)))");
  CFMetaData metadata=currentTableMetadata();
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  for (  ColumnDefinition def : new HashSet<>(metadata.allColumns())) {
    try {
      String query="CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL "+ (def.name.toString().equals("asciival") ? "" : "AND asciival IS NOT NULL ")+ "PRIMARY KEY ("+ def.name+ ", k"+ (def.name.toString().equals("asciival") ? "" : ", asciival")+ ")";
      createView("mv1_" + def.name,query);
      if (def.type.isMultiCell())       Assert.fail("MV on a multicell should fail " + def);
    }
 catch (    InvalidQueryException e) {
      if (!def.type.isMultiCell() && !def.isPartitionKey())       Assert.fail("MV creation failed on " + def);
    }
    try {
      String query="CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL "+ (def.name.toString().equals("asciival") ? "" : "AND asciival IS NOT NULL ")+ " PRIMARY KEY ("+ def.name+ ", asciival"+ (def.name.toString().equals("k") ? "" : ", k")+ ")";
      createView("mv2_" + def.name,query);
      if (def.type.isMultiCell())       Assert.fail("MV on a multicell should fail " + def);
    }
 catch (    InvalidQueryException e) {
      if (!def.type.isMultiCell() && !def.isPartitionKey())       Assert.fail("MV creation failed on " + def);
    }
    try {
      String query="CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL "+ (def.name.toString().equals("asciival") ? "" : "AND asciival IS NOT NULL ")+ "PRIMARY KEY (("+ def.name+ ", k), asciival)";
      createView("mv3_" + def.name,query);
      if (def.type.isMultiCell())       Assert.fail("MV on a multicell should fail " + def);
    }
 catch (    InvalidQueryException e) {
      if (!def.type.isMultiCell() && !def.isPartitionKey())       Assert.fail("MV creation failed on " + def);
    }
    try {
      String query="CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL "+ (def.name.toString().equals("asciival") ? "" : "AND asciival IS NOT NULL ")+ "PRIMARY KEY (("+ def.name+ ", k), asciival)";
      createView("mv3_" + def.name,query);
      Assert.fail("Should fail on duplicate name");
    }
 catch (    Exception e) {
    }
    try {
      String query="CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE " + def.name + " IS NOT NULL AND k IS NOT NULL "+ (def.name.toString().equals("asciival") ? "" : "AND asciival IS NOT NULL ")+ "PRIMARY KEY (("+ def.name+ ", k), nonexistentcolumn)";
      createView("mv3_" + def.name,query);
      Assert.fail("Should fail with unknown base column");
    }
 catch (    InvalidQueryException e) {
    }
  }
  updateView("INSERT INTO %s (k, asciival, bigintval) VALUES (?, ?, fromJson(?))",0,"ascii text","123123123123");
  updateView("INSERT INTO %s (k, asciival) VALUES (?, fromJson(?))",0,"\"ascii text\"");
  assertRows(execute("SELECT bigintval FROM %s WHERE k = ? and asciival = ?",0,"ascii text"),row(123123123123L));
  assertRows(execute("SELECT k, bigintval from mv1_asciival WHERE asciival = ?","ascii text"),row(0,123123123123L));
  assertRows(execute("SELECT k, bigintval from mv2_k WHERE asciival = ? and k = ?","ascii text",0),row(0,123123123123L));
  assertRows(execute("SELECT k from mv1_bigintval WHERE bigintval = ?",123123123123L),row(0));
  assertRows(execute("SELECT asciival from mv3_bigintval where bigintval = ? AND k = ?",123123123123L,0),row("ascii text"));
  updateView("INSERT INTO %s (k, asciival, bigintval) VALUES (?, ?, fromJson(?))",0,"ascii text","1");
  assertRows(execute("SELECT bigintval FROM %s WHERE k = ? and asciival = ?",0,"ascii text"),row(1L));
  assertRows(execute("SELECT k, bigintval from mv1_asciival WHERE asciival = ?","ascii text"),row(0,1L));
  assertRows(execute("SELECT k, bigintval from mv2_k WHERE asciival = ? and k = ?","ascii text",0),row(0,1L));
  assertRows(execute("SELECT k from mv1_bigintval WHERE bigintval = ?",123123123123L));
  assertRows(execute("SELECT asciival from mv3_bigintval where bigintval = ? AND k = ?",123123123123L,0));
  assertRows(execute("SELECT asciival from mv3_bigintval where bigintval = ? AND k = ?",1L,0),row("ascii text"));
  updateView("TRUNCATE %s");
  assertRows(execute("SELECT bigintval FROM %s WHERE k = ? and asciival = ?",0,"ascii text"));
  assertRows(execute("SELECT k, bigintval from mv1_asciival WHERE asciival = ?","ascii text"));
  assertRows(execute("SELECT k, bigintval from mv2_k WHERE asciival = ? and k = ?","ascii text",0));
  assertRows(execute("SELECT asciival from mv3_bigintval where bigintval = ? AND k = ?",1L,0));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPrimaryKeyIsNotNull() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int, " + "asciival ascii, "+ "bigintval bigint, "+ "PRIMARY KEY((k, asciival)))");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  try {
    createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s");
    Assert.fail("Should fail if no primary key is filtered as NOT NULL");
  }
 catch (  Exception e) {
  }
  try {
    createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE bigintval IS NOT NULL AND asciival IS NOT NULL PRIMARY KEY (bigintval, k, asciival)");
    Assert.fail("Should fail if compound primary is not completely filtered as NOT NULL");
  }
 catch (  Exception e) {
  }
  dropTable("DROP TABLE %s");
  createTable("CREATE TABLE %s (" + "k int, " + "asciival ascii, "+ "bigintval bigint, "+ "PRIMARY KEY(k, asciival))");
  try {
    createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s");
    Assert.fail("Should fail if no primary key is filtered as NOT NULL");
  }
 catch (  Exception e) {
  }
  createView("mv_test","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE bigintval IS NOT NULL AND asciival IS NOT NULL PRIMARY KEY (bigintval, k, asciival)");
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCountersTable() throws Throwable {
  createTable("CREATE TABLE %s (" + "k int PRIMARY KEY, " + "count counter)");
  execute("USE " + keyspace());
  executeNet(protocolVersion,"USE " + keyspace());
  try {
    createView("mv_counter","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE count IS NOT NULL AND k IS NOT NULL PRIMARY KEY (count,k)");
    Assert.fail("MV on counter should fail");
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexOnMapEntriesTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldTreatQueriesAgainstFrozenMapIndexesAsInvalid() throws Throwable {
  createTable("CREATE TABLE %s (k TEXT PRIMARY KEY, v FROZEN<MAP<TEXT, TEXT>>)");
  createIndex("CREATE INDEX ON %s(FULL(V))");
  try {
    execute("SELECT * FROM %s WHERE v['somekey'] = 'somevalue'");
    fail("Expected index query to fail");
  }
 catch (  InvalidRequestException e) {
    String expectedMessage="Map-entry equality predicates on frozen map column v are not supported";
    assertTrue("Expected error message to contain '" + expectedMessage + "' but got '"+ e.getMessage()+ "'",e.getMessage().contains(expectedMessage));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexQueriesWithIndexNotReady() throws Throwable {
  createTable("CREATE TABLE %s (pk int, ck int, value int, PRIMARY KEY (pk, ck))");
  for (int i=0; i < 10; i++)   for (int j=0; j < 10; j++)   execute("INSERT INTO %s (pk, ck, value) VALUES (?, ?, ?)",i,j,i + j);
  createIndex("CREATE CUSTOM INDEX testIndex ON %s (value) USING '" + IndexBlockingOnInitialization.class.getName() + "'");
  try {
    execute("SELECT value FROM %s WHERE value = 2");
    fail();
  }
 catch (  IndexNotAvailableException e) {
    assertTrue(true);
  }
 finally {
    execute("DROP index " + KEYSPACE + ".testIndex");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TypeTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReversedAndNonReversed() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b 'org.apache.cassandra.db.marshal.DateType', PRIMARY KEY (a, b))");
  try {
    alterTable("ALTER TABLE %s ALTER b TYPE 'org.apache.cassandra.db.marshal.ReversedType(org.apache.cassandra.db.marshal.DateType)'");
    fail("Expected error for ALTER statement");
  }
 catch (  RuntimeException e) {
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIncompatibleReversedTypes() throws Throwable {
  createTable("CREATE TABLE IF NOT EXISTS %s (a int, b 'org.apache.cassandra.db.marshal.DateType', PRIMARY KEY (a, b)) WITH CLUSTERING ORDER BY (b DESC)");
  try {
    alterTable("ALTER TABLE %s ALTER b TYPE 'org.apache.cassandra.db.marshal.ReversedType(org.apache.cassandra.db.marshal.TimeUUIDType)'");
    fail("Expected error for ALTER statement");
  }
 catch (  RuntimeException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFTest </h4><pre class="type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJavaFunctionInvalidBodies() throws Throwable {
  try {
    execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".jfinv() "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS bigint "+ "LANGUAGE JAVA\n"+ "AS '\n"+ "foobarbaz"+ "\n';");
    Assert.fail();
  }
 catch (  InvalidRequestException e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Java source compilation failed"));
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("insert \";\" to complete BlockStatements"));
  }
  try {
    execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".jfinv() "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS bigint "+ "LANGUAGE JAVA\n"+ "AS '\n"+ "foobarbaz;"+ "\n';");
    Assert.fail();
  }
 catch (  InvalidRequestException e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Java source compilation failed"));
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("foobarbaz cannot be resolved to a type"));
  }
}

</code></pre>

<br>
<pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFunctionExecutionExceptionNet() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'throw new RuntimeException();'");
  for (  int version : PROTOCOL_VERSIONS) {
    try {
      assertRowsNet(version,executeNet(version,"SELECT " + fName + "(dval) FROM %s WHERE key = 1"));
      Assert.fail();
    }
 catch (    com.datastax.driver.core.exceptions.FunctionExecutionException fee) {
      Assert.assertTrue(version >= Server.VERSION_4);
    }
catch (    InvalidQueryException e) {
      Assert.assertTrue(version < Server.VERSION_4);
    }
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSecurityPermissions() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  try {
    String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'System.getProperty(\"foo.bar.baz\"); return 0d;';");
    execute("SELECT " + fName + "(dval) FROM %s WHERE key=1");
    Assert.fail();
  }
 catch (  FunctionExecutionException e) {
    assertAccessControlException("System.getProperty(\"foo.bar.baz\"); return 0d;",e);
  }
  String[][] typesAndSources={{"","try { Class.forName(\"" + UDHelper.class.getName() + "\"); } catch (Exception e) { throw new RuntimeException(e); } return 0d;"},{"sun.misc.Unsafe","sun.misc.Unsafe.getUnsafe(); return 0d;"},{"","try { Class.forName(\"sun.misc.Unsafe\"); } catch (Exception e) { throw new RuntimeException(e); } return 0d;"},{"java.nio.file.FileSystems","try {" + "     java.nio.file.FileSystems.getDefault(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.nio.channels.FileChannel","try {" + "     java.nio.channels.FileChannel.open(java.nio.file.FileSystems.getDefault().getPath(\"/etc/passwd\")).close(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.nio.channels.SocketChannel","try {" + "     java.nio.channels.SocketChannel.open().close(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.io.FileInputStream","try {" + "     new java.io.FileInputStream(\"./foobar\").close(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.lang.Runtime","try {" + "     java.lang.Runtime.getRuntime(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"org.apache.cassandra.service.StorageService","try {" + "     org.apache.cassandra.service.StorageService v = org.apache.cassandra.service.StorageService.instance; v.isInShutdownHook(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.net.ServerSocket","try {" + "     new java.net.ServerSocket().bind(); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.io.FileOutputStream","try {" + "     new java.io.FileOutputStream(\".foo\"); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'},{"java.lang.Runtime","try {" + "     java.lang.Runtime.getRuntime().exec(\"/tmp/foo\"); return 0d;" + "} catch (Exception t) {"+ "     throw new RuntimeException(t);"+ '}'}};
  for (  String[] typeAndSource : typesAndSources) {
    assertInvalidMessage(typeAndSource[0] + " cannot be resolved","CREATE OR REPLACE FUNCTION " + KEYSPACE + ".invalid_class_access(val double) "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS '"+ typeAndSource[1]+ "';");
  }
  try {
    String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript\n"+ "AS 'org.apache.cassandra.service.StorageService.instance.isInShutdownHook(); 0;';");
    execute("SELECT " + fName + "(dval) FROM %s WHERE key=1");
    Assert.fail("Javascript security check failed");
  }
 catch (  FunctionExecutionException e) {
    assertAccessControlException("",e);
  }
  String[] javascript={"java.lang.management.ManagmentFactory.getThreadMXBean(); 0;","new java.io.FileInputStream(\"/tmp/foo\"); 0;","new java.io.FileOutputStream(\"/tmp/foo\"); 0;","java.nio.file.FileSystems.getDefault().createFileExclusively(\"./foo_bar_baz\"); 0;","java.nio.channels.FileChannel.open(java.nio.file.FileSystems.getDefault().getPath(\"/etc/passwd\")); 0;","java.nio.channels.SocketChannel.open(); 0;","new java.net.ServerSocket().bind(null); 0;","var thread = new java.lang.Thread(); thread.start(); 0;","java.lang.System.getProperty(\"foo.bar.baz\"); 0;","java.lang.Class.forName(\"java.lang.System\"); 0;","java.lang.Runtime.getRuntime().exec(\"/tmp/foo\"); 0;","java.lang.Runtime.getRuntime().loadLibrary(\"foobar\"); 0;","java.lang.Runtime.getRuntime().loadLibrary(\"foobar\"); 0;"};
  for (  String script : javascript) {
    try {
      String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE javascript\n"+ "AS '" + script + "';");
      execute("SELECT " + fName + "(dval) FROM %s WHERE key=1");
      Assert.fail("Javascript security check failed: " + script);
    }
 catch (    FunctionExecutionException e) {
      assertAccessControlException(script,e);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.TombstonesTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpiredTombstones() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b)) WITH gc_grace_seconds = 1;");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
    fail("SELECT with tombstones beyond the threshold should have failed, but hasn't");
  }
 catch (  Throwable e) {
    assertTrue(e instanceof TombstoneOverwhelmingException);
  }
  TimeUnit.SECONDS.sleep(2);
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
  }
 catch (  Throwable e) {
    fail("SELECT with expired tombstones beyond the threshold should not have failed, but has: " + e);
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLiveShadowedCellsSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', 'column');");
  execute("DELETE FROM %s WHERE a = 'key'");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
  }
 catch (  Throwable e) {
    fail("SELECT with regular cells shadowed by a partition tombstone should not have failed, but has: " + e);
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBelowThresholdSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
  }
 catch (  Throwable e) {
    fail("SELECT with tombstones below the threshold should not have failed, but has: " + e);
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAllShadowedSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  execute("DELETE FROM %s WHERE a = 'key'");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
  }
 catch (  Throwable e) {
    fail("SELECT with tombstones shadowed by a partition tombstone should not have failed, but has: " + e);
  }
}

</code></pre>

<br>
<pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBeyondThresholdSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
    fail("SELECT with tombstones beyond the threshold should have failed, but hasn't");
  }
 catch (  Throwable e) {
    String error="Expected exception instanceof TombstoneOverwhelmingException instead got " + System.lineSeparator() + Throwables.getStackTraceAsString(e);
    assertTrue(error,e instanceof TombstoneOverwhelmingException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DirectoriesTest </h4><pre class="type-6 type-7 type-13 type-15 type-5 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiskFreeSpace(){
  DataDirectory[] dataDirectories=new DataDirectory[]{new DataDirectory(new File("/nearlyFullDir1")){
    public long getAvailableSpace(){
      return 11L;
    }
  }
,new DataDirectory(new File("/nearlyFullDir2")){
    public long getAvailableSpace(){
      return 10L;
    }
  }
,new DataDirectory(new File("/uniformDir1")){
    public long getAvailableSpace(){
      return 1000L;
    }
  }
,new DataDirectory(new File("/uniformDir2")){
    public long getAvailableSpace(){
      return 999L;
    }
  }
,new DataDirectory(new File("/veryFullDir")){
    public long getAvailableSpace(){
      return 4L;
    }
  }
};
  List<Directories.DataDirectoryCandidate> candidates=getWriteableDirectories(dataDirectories,0L);
  assertSame(dataDirectories[2],candidates.get(0).dataDirectory);
  assertSame(dataDirectories[3],candidates.get(1).dataDirectory);
  assertSame(dataDirectories[0],candidates.get(2).dataDirectory);
  assertSame(dataDirectories[1],candidates.get(3).dataDirectory);
  Map<DataDirectory,DataDirectory> testMap=new IdentityHashMap<>();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,5L);
    assertEquals(4,candidates.size());
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 4);
    if (testMap.size() == 4) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
  testMap.clear();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,11L);
    assertEquals(3,candidates.size());
    for (    Directories.DataDirectoryCandidate candidate : candidates)     assertTrue(candidate.dataDirectory.getAvailableSpace() >= 11L);
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 3);
    if (testMap.size() == 3) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ScrubTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testScrubOutOfOrder() throws Exception {
  IPartitioner oldPartitioner=DatabaseDescriptor.getPartitioner();
  DatabaseDescriptor.setPartitionerUnsafe(new ByteOrderedPartitioner());
  File tempDir=File.createTempFile("ScrubTest.testScrubOutOfOrder","").getParentFile();
  File tempDataDir=new File(tempDir,String.join(File.separator,KEYSPACE,CF3));
  tempDataDir.mkdirs();
  try {
    CompactionManager.instance.disableAutoCompaction();
    Keyspace keyspace=Keyspace.open(KEYSPACE);
    String columnFamily=CF3;
    ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(columnFamily);
    cfs.clearUnsafe();
    List<String> keys=Arrays.asList("t","a","b","z","c","y","d");
    String filename=cfs.getSSTablePath(tempDataDir);
    Descriptor desc=Descriptor.fromFilename(filename);
    LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.WRITE);
    try (SSTableTxnWriter writer=new SSTableTxnWriter(txn,createTestWriter(desc,(long)keys.size(),cfs.metadata,txn))){
      for (      String k : keys) {
        PartitionUpdate update=UpdateBuilder.create(cfs.metadata,Util.dk(k)).newRow("someName").add("val","someValue").build();
        writer.append(update.unfilteredIterator());
      }
      writer.finish(false);
    }
     try {
      SSTableReader.open(desc,cfs.metadata);
      fail("SSTR validation should have caught the out-of-order rows");
    }
 catch (    IllegalStateException ise) {
    }
    Set<Component> components=new HashSet<>();
    if (new File(desc.filenameFor(Component.COMPRESSION_INFO)).exists())     components.add(Component.COMPRESSION_INFO);
    components.add(Component.DATA);
    components.add(Component.PRIMARY_INDEX);
    components.add(Component.FILTER);
    components.add(Component.STATS);
    components.add(Component.SUMMARY);
    components.add(Component.TOC);
    SSTableReader sstable=SSTableReader.openNoValidation(desc,components,cfs);
    if (sstable.last.compareTo(sstable.first) < 0)     sstable.last=sstable.first;
    try (LifecycleTransaction scrubTxn=LifecycleTransaction.offline(OperationType.SCRUB,sstable);Scrubber scrubber=new Scrubber(cfs,scrubTxn,false,true,true)){
      scrubber.scrub();
    }
     LifecycleTransaction.waitForDeletions();
    cfs.loadNewSSTables();
    assertOrderedAll(cfs,7);
  }
  finally {
    FileUtils.deleteRecursive(tempDataDir);
    DatabaseDescriptor.setPartitionerUnsafe(oldPartitioner);
  }
}

</code></pre>

<br>
<pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubCorruptedCounterRow() throws IOException, WriteTimeoutException {
  int numPartitions=1000;
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  cfs.clearUnsafe();
  fillCounterCF(cfs,numPartitions);
  assertOrderedAll(cfs,numPartitions);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,ByteBufferUtil.bytes("0"),ByteBufferUtil.bytes("1"));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,false,false,true)){
    scrubber.scrub();
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  IOError err) {
  }
  Scrubber.ScrubResult scrubResult;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,true,false,true)){
    scrubResult=scrubber.scrubWithResult();
  }
   assertNotNull(scrubResult);
  boolean compression=Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false"));
  if (compression) {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(numPartitions,scrubResult.badRows + scrubResult.goodRows);
    assertTrue(scrubResult.goodRows >= scrubResult.badRows * 2);
  }
 else {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(1,scrubResult.badRows);
    assertEquals(numPartitions - 1,scrubResult.goodRows);
  }
  assertEquals(1,cfs.getLiveSSTables().size());
  assertOrderedAll(cfs,scrubResult.goodRows);
}

</code></pre>

<br>
<pre class="type-7 type-15 type-4 type-19 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubCorruptedRowInSmallFile() throws IOException, WriteTimeoutException {
  assumeTrue(!Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false")));
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  cfs.clearUnsafe();
  fillCounterCF(cfs,2);
  assertOrderedAll(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,ByteBufferUtil.bytes("0"),ByteBufferUtil.bytes("1"));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,false,false,true)){
    scrubber.scrub();
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  IOError err) {
  }
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,true,false,true)){
    scrubber.scrub();
    scrubber.close();
  }
   assertEquals(1,cfs.getLiveSSTables().size());
  assertOrderedAll(cfs,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.VerifyTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyIncorrectDigest() throws IOException, WriteTimeoutException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CORRUPT_CF);
  fillCF(cfs,2);
  Util.getAll(Util.cmd(cfs).build());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  RandomAccessFile file=new RandomAccessFile(sstable.descriptor.filenameFor(sstable.descriptor.digestComponent),"rw");
  Long correctChecksum=Long.parseLong(file.readLine());
  file.close();
  writeChecksum(++correctChecksum,sstable.descriptor.filenameFor(sstable.descriptor.digestComponent));
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(false);
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  CorruptSSTableException err) {
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyCounterCorrectUncompressed() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF3);
  fillCounterCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(false);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExtendedVerifyCorrect() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF2);
  fillCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(true);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExtendedVerifyCounterCorrectUncompressed() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF4);
  fillCounterCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(true);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyCounterCorrect() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  fillCounterCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(false);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExtendedVerifyCorrectUncompressed() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF4);
  fillCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(true);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExtendedVerifyCounterCorrect() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF2);
  fillCounterCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(true);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyCorrect() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  fillCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(false);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyCorrectUncompressed() throws IOException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF3);
  fillCF(cfs,2);
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    verifier.verify(false);
  }
 catch (  CorruptSSTableException err) {
    fail("Unexpected CorruptSSTableException");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVerifyCorruptRowCorrectDigest() throws IOException, WriteTimeoutException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CORRUPT_CF2);
  fillCF(cfs,2);
  Util.getAll(Util.cmd(cfs).build());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  long row0Start=sstable.getPosition(PartitionPosition.ForKey.get(ByteBufferUtil.bytes("0"),cfs.getPartitioner()),SSTableReader.Operator.EQ).position;
  long row1Start=sstable.getPosition(PartitionPosition.ForKey.get(ByteBufferUtil.bytes("1"),cfs.getPartitioner()),SSTableReader.Operator.EQ).position;
  long startPosition=row0Start < row1Start ? row0Start : row1Start;
  long endPosition=row0Start < row1Start ? row1Start : row0Start;
  RandomAccessFile file=new RandomAccessFile(sstable.getFilename(),"rw");
  file.seek(startPosition);
  file.writeBytes(StringUtils.repeat('z',(int)2));
  file.close();
  writeChecksum(simpleFullChecksum(sstable.getFilename()),sstable.descriptor.filenameFor(sstable.descriptor.digestComponent));
  try (Verifier verifier=new Verifier(cfs,sstable,false)){
    try {
      verifier.verify(false);
    }
 catch (    CorruptSSTableException err) {
      fail("Simple verify should have succeeded as digest matched");
    }
    try {
      verifier.verify(true);
    }
 catch (    CorruptSSTableException err) {
      return;
    }
    fail("Expected a CorruptSSTableException to be thrown");
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogDescriptorTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDescriptorInvalidParametersSize() throws IOException {
  Map<String,String> params=new HashMap<>();
  for (int i=0; i < 65535; ++i)   params.put("key" + i,Integer.toString(i,16));
  try {
    CommitLogDescriptor desc=new CommitLogDescriptor(CommitLogDescriptor.VERSION_22,21,new ParameterizedClass("LZ4Compressor",params),neverEnabledEncryption);
    ByteBuffer buf=ByteBuffer.allocate(1024000);
    CommitLogDescriptor.writeHeader(buf,desc);
    Assert.fail("Parameter object too long should fail on writing descriptor.");
  }
 catch (  ConfigurationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogStressTest </h4><pre class="type-10 type-13 type-15 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void cleanDir(){
  File dir=new File(location);
  if (dir.isDirectory()) {
    File[] files=dir.listFiles();
    for (    File f : files)     if (!f.delete())     Assert.fail("Failed to delete " + f);
  }
 else {
    dir.mkdir();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.DateTieredCompactionStrategyTest </h4><pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"30");
  options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"1825");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"0");
    validateOptions(options);
    fail(String.format("%s == 0 should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"1");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"0");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"-1");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"0");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LeveledCompactionStrategyTest </h4><pre class="type-13 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Ensure that the grouping operation preserves the levels of grouped tables
 */
@Test public void testGrouperLevels() throws Exception {
  ByteBuffer value=ByteBuffer.wrap(new byte[100 * 1024]);
  new Random().nextBytes(value.array());
  int rows=40;
  int columns=20;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  waitForLeveling(cfs);
  CompactionStrategyManager strategyManager=cfs.getCompactionStrategyManager();
  int l1Count=strategyManager.getSSTableCountPerLevel()[1];
  int l2Count=strategyManager.getSSTableCountPerLevel()[2];
  if (l1Count == 0 || l2Count == 0) {
    logger.error("L1 or L2 has 0 sstables. Expected > 0 on both.");
    logger.error("L1: " + l1Count);
    logger.error("L2: " + l2Count);
    Assert.fail();
  }
  Collection<Collection<SSTableReader>> groupedSSTables=cfs.getCompactionStrategyManager().groupSSTablesForAntiCompaction(cfs.getLiveSSTables());
  for (  Collection<SSTableReader> sstableGroup : groupedSSTables) {
    int groupLevel=-1;
    Iterator<SSTableReader> it=sstableGroup.iterator();
    while (it.hasNext()) {
      SSTableReader sstable=it.next();
      int tableLevel=sstable.getSSTableLevel();
      if (groupLevel == -1)       groupLevel=tableLevel;
      assert groupLevel == tableLevel;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.SizeTieredCompactionStrategyTest </h4><pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_HIGH_KEY,"1.5");
  options.put(SizeTieredCompactionStrategyOptions.MIN_SSTABLE_SIZE_KEY,"10000");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"1000.0");
    validateOptions(options);
    fail("bucket_low greater than bucket_high should be rejected");
  }
 catch (  ConfigurationException e) {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.LogTransactionTest </h4><pre class="type-15 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetTemporaryFilesThrowsIfCompletingAfterObsoletion() throws Throwable {
  ColumnFamilyStore cfs=MockSchema.newCFS(KEYSPACE);
  File dataFolder=new Directories(cfs.metadata).getDirectoryForNewSSTables();
  SSTableReader sstable=sstable(dataFolder,cfs,0,128);
  LogTransaction logs=new LogTransaction(OperationType.COMPACTION);
  assertNotNull(logs);
  LogTransaction.SSTableTidier tidier=logs.obsoleted(sstable);
  sstable.markObsolete(tidier);
  sstable.selfRef().release();
  LogTransaction.waitForDeletions();
  try {
    LogAwareFileLister.getTemporaryFiles(dataFolder);
    fail("Expected runtime exception");
  }
 catch (  RuntimeException e) {
  }
  logs.finish();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.CompositeTypeTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidate(){
  ByteBuffer key=createCompositeKey("test1",uuids[1],42,false);
  comparator.validate(key);
  key=createCompositeKey("test1",null,-1,false);
  comparator.validate(key);
  key=createCompositeKey("test1",uuids[2],-1,true);
  comparator.validate(key);
  key.get();
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
  }
  key=ByteBuffer.allocate(3 + "test1".length() + 3+ 14);
  key.putShort((short)"test1".length());
  key.put(ByteBufferUtil.bytes("test1"));
  key.put((byte)0);
  key.putShort((short)14);
  key.rewind();
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
    assert e.toString().contains("should be 16 or 0 bytes");
  }
  key=createCompositeKey("test1",UUID.randomUUID(),42,false);
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
    assert e.toString().contains("Invalid version for TimeUUID type");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEmptyParametersNotallowed(){
  try {
    TypeParser.parse("CompositeType");
    fail("Shouldn't work");
  }
 catch (  ConfigurationException e) {
  }
catch (  SyntaxException e) {
  }
  try {
    TypeParser.parse("CompositeType()");
    fail("Shouldn't work");
  }
 catch (  ConfigurationException e) {
  }
catch (  SyntaxException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.DynamicCompositeTypeTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidate(){
  ByteBuffer key=createDynamicCompositeKey("test1",uuids[1],42,false);
  comparator.validate(key);
  key=createDynamicCompositeKey("test1",null,-1,false);
  comparator.validate(key);
  key=createDynamicCompositeKey("test1",uuids[2],-1,true);
  comparator.validate(key);
  key.get();
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
  }
  key=ByteBuffer.allocate(5 + "test1".length() + 5+ 14);
  key.putShort((short)(0x8000 | 'b'));
  key.putShort((short)"test1".length());
  key.put(ByteBufferUtil.bytes("test1"));
  key.put((byte)0);
  key.putShort((short)(0x8000 | 't'));
  key.putShort((short)14);
  key.rewind();
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
    assert e.toString().contains("should be 16 or 0 bytes");
  }
  key=createDynamicCompositeKey("test1",UUID.randomUUID(),42,false);
  try {
    comparator.validate(key);
    fail("Should not validate");
  }
 catch (  MarshalException e) {
    assert e.toString().contains("Invalid version for TimeUUID type");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUncomparableReversedColumns(){
  ByteBuffer uuid=ByteBuffer.allocate(2 + 2 + 16+ 1);
  uuid.putShort((short)(0x8000 | 'T'));
  uuid.putShort((short)16);
  uuid.put(UUIDGen.decompose(uuids[0]));
  uuid.put((byte)0);
  uuid.rewind();
  ByteBuffer bytes=ByteBuffer.allocate(2 + 2 + 4+ 1);
  bytes.putShort((short)(0x8000 | 'B'));
  bytes.putShort((short)4);
  bytes.put(new byte[4]);
  bytes.put((byte)0);
  bytes.rewind();
  try {
    int c=comparator.compare(uuid,bytes);
    assert c == 1 : "Expecting bytes to sort before uuid, but got " + c;
  }
 catch (  Exception e) {
    fail("Shouldn't throw exception");
  }
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUncomparableColumns(){
  ByteBuffer bytes=ByteBuffer.allocate(2 + 2 + 4+ 1);
  bytes.putShort((short)(0x8000 | 'b'));
  bytes.putShort((short)4);
  bytes.put(new byte[4]);
  bytes.put((byte)0);
  bytes.rewind();
  ByteBuffer uuid=ByteBuffer.allocate(2 + 2 + 16+ 1);
  uuid.putShort((short)(0x8000 | 't'));
  uuid.putShort((short)16);
  uuid.put(UUIDGen.decompose(uuids[0]));
  uuid.put((byte)0);
  uuid.rewind();
  try {
    int c=comparator.compare(bytes,uuid);
    assert c == -1 : "Expecting bytes to sort before uuid, but got " + c;
  }
 catch (  Exception e) {
    fail("Shouldn't throw exception");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.TypeParserTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testParseError(){
  try {
    TypeParser.parse("y");
    fail("Should not pass");
  }
 catch (  ConfigurationException e) {
  }
catch (  SyntaxException e) {
  }
  try {
    TypeParser.parse("LongType(reversed@)");
    fail("Should not pass");
  }
 catch (  ConfigurationException e) {
  }
catch (  SyntaxException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.PartitionerTestCase </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDescribeOwnership(){
  StorageService.instance.getKeyspaces();
  try {
    testDescribeOwnershipWith(0);
    fail();
  }
 catch (  RuntimeException e) {
  }
  testDescribeOwnershipWith(1);
  testDescribeOwnershipWith(2);
  testDescribeOwnershipWith(256);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.RangeTest </h4><pre class="type-6 type-7 type-13 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRandomOrderedRangeContainmentChecker(){
  Random r=new Random();
  for (int j=0; j < 1000; j++) {
    int numTokens=r.nextInt(300) + 1;
    List<Range<Token>> ranges=new ArrayList<>(numTokens);
    List<Token> tokens=new ArrayList<>(2 * numTokens);
    for (int i=0; i < 2 * numTokens; i++)     tokens.add(t(r.nextLong()));
    Collections.sort(tokens);
    for (int i=0; i < tokens.size(); i++) {
      ranges.add(new Range<>(tokens.get(i),tokens.get(i + 1)));
      i++;
    }
    List<Token> tokensToTest=new ArrayList<>();
    for (int i=0; i < 10000; i++)     tokensToTest.add(t(r.nextLong()));
    tokensToTest.add(t(Long.MAX_VALUE));
    tokensToTest.add(t(Long.MIN_VALUE));
    tokensToTest.add(t(Long.MAX_VALUE - 1));
    tokensToTest.add(t(Long.MIN_VALUE + 1));
    Collections.sort(tokensToTest);
    Range.OrderedRangeContainmentChecker checker=new Range.OrderedRangeContainmentChecker(ranges);
    for (    Token t : tokensToTest) {
      if (checker.contains(t) != Range.isInRanges(t,ranges))       fail(String.format("This should never flap! If it does, it is a bug (ranges = %s, token = %s)",Joiner.on(",").join(ranges),t));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsBufferTest </h4><pre class="type-15 type-4 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("resource") public void testOverlyLargeAllocation(){
  HintsBuffer buffer=HintsBuffer.create(128);
  try {
    buffer.allocate(65 - HintsBuffer.ENTRY_OVERHEAD_SIZE);
    fail("Allocation of the buffer should have failed but hasn't");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(String.format("Hint of %s bytes is too large - the maximum size is 64",65 - HintsBuffer.ENTRY_OVERHEAD_SIZE),e.getMessage());
  }
  try (HintsBuffer.Allocation allocation=buffer.allocate(64 - HintsBuffer.ENTRY_OVERHEAD_SIZE)){
    assertNotNull(allocation);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.HintsDescriptorTest </h4><pre class="type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptedDeserialize() throws IOException {
  UUID hostId=UUID.randomUUID();
  int version=HintsDescriptor.CURRENT_VERSION;
  long timestamp=System.currentTimeMillis();
  ImmutableMap<String,Object> parameters=ImmutableMap.of();
  HintsDescriptor descriptor=new HintsDescriptor(hostId,version,timestamp,parameters);
  byte[] bytes=serializeDescriptor(descriptor);
  bytes[28]=(byte)0xFF;
  bytes[29]=(byte)0xFF;
  bytes[30]=(byte)0xFF;
  bytes[31]=(byte)0x7F;
  try {
    deserializeDescriptor(bytes);
    fail("Deserializing the descriptor should but didn't");
  }
 catch (  IOException e) {
    assertEquals("Hints Descriptor CRC Mismatch",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.SASIIndexTest </h4><pre class="type-7 type-15 type-4 type-5 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchTimeouts() throws Exception {
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  Map<String,Pair<String,Integer>> data1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",26));
      put("key3",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",27));
    }
  }
;
  ColumnFamilyStore store=loadData(data1,true);
  RowFilter filter=RowFilter.create();
  filter.add(store.metadata.getColumnDefinition(firstName),Operator.EQ,AsciiType.instance.fromString("a"));
  ReadCommand command=new PartitionRangeReadCommand(store.metadata,FBUtilities.nowInSeconds(),ColumnFilter.all(store.metadata),filter,DataLimits.NONE,DataRange.allData(store.metadata.partitioner),Optional.empty());
  try {
    new QueryPlan(store,command,0).execute(ReadExecutionController.empty());
    Assert.fail();
  }
 catch (  TimeQuotaExceededException e) {
  }
catch (  Exception e) {
    Assert.fail();
    e.printStackTrace();
  }
  Set<String> rows=getKeys(new QueryPlan(store,command,DatabaseDescriptor.getRangeRpcTimeout()).execute(ReadExecutionController.empty()));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1","key2","key3","key4"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.TokenTreeTest </h4><pre class="type-6 type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenMerge() throws Exception {
  final long min=0, max=1000;
  TokenTree treeA=generateTree(min,max);
  TokenTree treeB=generateTree(min,max);
  RangeIterator<Long,Token> a=treeA.iterator(new KeyConverter());
  RangeIterator<Long,Token> b=treeB.iterator(new KeyConverter());
  long count=min;
  while (a.hasNext() && b.hasNext()) {
    final Token tokenA=a.next();
    final Token tokenB=b.next();
    tokenA.merge(tokenB);
    tokenA.merge(new TokenWithOffsets(tokenA.get(),convert(count + 1)));
    tokenA.merge(new TokenWithOffsets(tokenA.get(),convert(count)));
    try {
      tokenA.merge(new TokenWithOffsets(tokenA.get() + 1,convert(count)));
      Assert.fail();
    }
 catch (    IllegalArgumentException e) {
    }
    final Set<Long> offsets=new TreeSet<>();
    for (    DecoratedKey key : tokenA)     offsets.add(LongType.instance.compose(key.getKey()));
    Set<Long> expected=new TreeSet<>();
{
      expected.add(count);
      expected.add(count + 1);
    }
    Assert.assertEquals(expected,offsets);
    count++;
  }
  Assert.assertEquals(max,count - 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.plan.OperationTest </h4><pre class="type-6 type-7 type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSatisfiedBy() throws Exception {
  final ColumnDefinition timestamp=getColumn(UTF8Type.instance.decompose("timestamp"));
  final ColumnDefinition age=getColumn(UTF8Type.instance.decompose("age"));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)));
  Operation op=builder.complete();
  Unfiltered row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(6)),new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(10)));
  op=builder.complete();
  Set<Integer> exclusions=Sets.newHashSet(0,1,5,6,11);
  for (int i=0; i <= 11; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(6)));
  op=builder.complete();
  exclusions=Sets.newHashSet(0,1,2,3,4,7,8,9,10);
  for (int i=0; i <= 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(0)));
  builder.add(new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10)));
  builder.add(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(7)));
  op=builder.complete();
  exclusions=Sets.newHashSet(7);
  for (int i=0; i < 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(timestamp,Operator.GTE,LongType.instance.decompose(10L)));
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(22L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(timestamp,Operator.GT,LongType.instance.decompose(10L)));
  builder.setRight(new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(0)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10))));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(20),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(0),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(30)));
  op=builder.complete();
  Assert.assertFalse(op.satisfiedBy(null,false));
  Assert.assertFalse(op.satisfiedBy(row,false));
  long now=System.currentTimeMillis();
  row=OperationTest.buildRow(Row.Deletion.regular(new DeletionTime(now - 10,(int)(now / 1000))),buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(deletedCell(age,System.currentTimeMillis(),FBUtilities.nowInSeconds()));
  Assert.assertFalse(op.satisfiedBy(row,true));
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),false));
  }
 catch (  IllegalStateException e) {
  }
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),true));
  }
 catch (  IllegalStateException e) {
    Assert.fail("IllegalStateException should not be thrown when missing column and allowMissingColumns=true");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.DescriptorTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void badNames(){
  String names[]={"system-schema_keyspaces-k234a-1-CompressionInfo.db","system-schema_keyspaces-ka-aa-Summary.db","system-schema_keyspaces-XXX-ka-1-Data.db","system-schema_keyspaces-k","system-schema_keyspace-ka-1-AAA-Data.db","system-schema-keyspace-ka-1-AAA-Data.db"};
  for (  String name : names) {
    try {
      Descriptor d=Descriptor.fromFilename(name);
      Assert.fail(name);
    }
 catch (    Throwable e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedDataOutputStreamTest </h4><pre class="type-15 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BufferOverflowException.class) public void testDataOutputBufferFixedByteBuffer() throws Exception {
  try (DataOutputBufferFixed dob=new DataOutputBufferFixed()){
    try {
      dob.write(ByteBuffer.allocateDirect(128));
    }
 catch (    BufferOverflowException e) {
      fail("Should not throw BufferOverflowException yet");
    }
    dob.write(ByteBuffer.allocateDirect(1));
  }
 }

</code></pre>

<br>
<pre class="type-15 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=BufferOverflowException.class) public void testDataOutputBufferFixedByes() throws Exception {
  try (DataOutputBufferFixed dob=new DataOutputBufferFixed()){
    try {
      for (int ii=0; ii < 128; ii++)       dob.write(0);
    }
 catch (    BufferOverflowException e) {
      fail("Should not throw BufferOverflowException yet");
    }
    dob.write(0);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MemoryTest </h4><pre class="type-15 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStream() throws IOException {
  byte[] bytes=new byte[4096];
  ThreadLocalRandom.current().nextBytes(bytes);
  final Memory memory=Memory.allocate(bytes.length);
  memory.setBytes(0,bytes,0,bytes.length);
  try (MemoryInputStream stream=new MemoryInputStream(memory,1024)){
    byte[] bb=new byte[bytes.length];
    assertEquals(bytes.length,stream.available());
    stream.readFully(bb);
    assertEquals(0,stream.available());
    assertTrue(Arrays.equals(bytes,bb));
    try {
      stream.readInt();
      fail("Expected EOF exception");
    }
 catch (    EOFException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.SequentialWriterTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the output stream exposed by SequentialWriter behaves as expected
 */
@Test public void outputStream(){
  File tempFile=new File(Files.createTempDir(),"test.txt");
  Assert.assertFalse("temp file shouldn't exist yet",tempFile.exists());
  try (DataOutputStream os=new DataOutputStream(SequentialWriter.open(tempFile).finishOnClose())){
    os.writeUTF("123");
  }
 catch (  IOException e) {
    Assert.fail();
  }
  Assert.assertTrue("temp file should exist",tempFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.RepairSessionTest </h4><pre class="type-15 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConviction() throws Exception {
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  Gossiper.instance.initializeNodeUnsafe(remote,UUID.randomUUID(),1);
  UUID parentSessionId=UUIDGen.getTimeUUID();
  UUID sessionId=UUID.randomUUID();
  IPartitioner p=Murmur3Partitioner.instance;
  Range<Token> repairRange=new Range<>(p.getToken(ByteBufferUtil.bytes(0)),p.getToken(ByteBufferUtil.bytes(100)));
  Set<InetAddress> endpoints=Sets.newHashSet(remote);
  RepairSession session=new RepairSession(parentSessionId,sessionId,Arrays.asList(repairRange),"Keyspace1",RepairParallelism.SEQUENTIAL,endpoints,ActiveRepairService.UNREPAIRED_SSTABLE,"Standard1");
  session.convict(remote,Double.MAX_VALUE);
  try {
    session.get();
    fail();
  }
 catch (  ExecutionException ex) {
    assertEquals(IOException.class,ex.getCause().getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.ValidatorTest </h4><pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidatorFailed() throws Throwable {
  Range<Token> range=new Range<>(partitioner.getMinimumToken(),partitioner.getRandomToken());
  final RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),keyspace,columnFamily,Arrays.asList(range));
  final SimpleCondition lock=new SimpleCondition();
  MessagingService.instance().addMessageSink(new IMessageSink(){
    public boolean allowOutgoingMessage(    MessageOut message,    int id,    InetAddress to){
      try {
        if (message.verb == MessagingService.Verb.REPAIR_MESSAGE) {
          RepairMessage m=(RepairMessage)message.payload;
          assertEquals(RepairMessage.Type.VALIDATION_COMPLETE,m.messageType);
          assertEquals(desc,m.desc);
          assertFalse(((ValidationComplete)m).success());
          assertNull(((ValidationComplete)m).trees);
        }
      }
  finally {
        lock.signalAll();
      }
      return false;
    }
    public boolean allowIncomingMessage(    MessageIn message,    int id){
      return false;
    }
  }
);
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  Validator validator=new Validator(desc,remote,0);
  validator.fail();
  if (!lock.isSignaled())   lock.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamingTransferTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test if empty {@link StreamPlan} returns success with empty result.
 */
@Test public void testEmptyStreamPlan() throws Exception {
  StreamResultFuture futureResult=new StreamPlan("StreamingTransferTest").execute();
  final UUID planId=futureResult.planId;
  Futures.addCallback(futureResult,new FutureCallback<StreamState>(){
    public void onSuccess(    StreamState result){
      assert planId.equals(result.planId);
      assert result.description.equals("StreamingTransferTest");
      assert result.sessions.isEmpty();
    }
    public void onFailure(    Throwable t){
      fail();
    }
  }
);
  futureResult.get(100,TimeUnit.MILLISECONDS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.MessagePayloadTest </h4><pre class="type-15 type-5 type-14 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessagePayloadVersion3() throws Throwable {
  QueryHandler queryHandler=(QueryHandler)cqlQueryHandlerField.get(null);
  cqlQueryHandlerField.set(null,new TestQueryHandler());
  try {
    requireNetwork();
    Assert.assertSame(TestQueryHandler.class,ClientState.getCQLQueryHandler().getClass());
    SimpleClient client=new SimpleClient(nativeAddr.getHostAddress(),nativePort,Server.VERSION_3);
    try {
      client.connect(false);
      Map<String,ByteBuffer> reqMap;
      QueryMessage queryMessage=new QueryMessage("CREATE TABLE " + KEYSPACE + ".atable (pk int PRIMARY KEY, v text)",QueryOptions.DEFAULT);
      PrepareMessage prepareMessage=new PrepareMessage("SELECT * FROM " + KEYSPACE + ".atable");
      reqMap=Collections.singletonMap("foo",bytes(42));
      responsePayload=Collections.singletonMap("bar",bytes(42));
      queryMessage.setCustomPayload(reqMap);
      try {
        client.execute(queryMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      queryMessage.setCustomPayload(null);
      client.execute(queryMessage);
      reqMap=Collections.singletonMap("foo",bytes(43));
      responsePayload=Collections.singletonMap("bar",bytes(43));
      prepareMessage.setCustomPayload(reqMap);
      try {
        client.execute(prepareMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      prepareMessage.setCustomPayload(null);
      ResultMessage.Prepared prepareResponse=(ResultMessage.Prepared)client.execute(prepareMessage);
      ExecuteMessage executeMessage=new ExecuteMessage(prepareResponse.statementId,QueryOptions.DEFAULT);
      reqMap=Collections.singletonMap("foo",bytes(44));
      responsePayload=Collections.singletonMap("bar",bytes(44));
      executeMessage.setCustomPayload(reqMap);
      try {
        client.execute(executeMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      BatchMessage batchMessage=new BatchMessage(BatchStatement.Type.UNLOGGED,Collections.singletonList("INSERT INTO " + KEYSPACE + ".atable (pk,v) VALUES (1, 'foo')"),Collections.singletonList(Collections.<ByteBuffer>emptyList()),QueryOptions.DEFAULT);
      reqMap=Collections.singletonMap("foo",bytes(45));
      responsePayload=Collections.singletonMap("bar",bytes(45));
      batchMessage.setCustomPayload(reqMap);
      try {
        client.execute(batchMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
    }
  finally {
      client.close();
    }
  }
  finally {
    cqlQueryHandlerField.set(null,queryHandler);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.ProtocolErrorTest </h4><pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBodyLengthOverLimit() throws Exception {
  Frame.Decoder dec=new Frame.Decoder(null);
  List results=new ArrayList<>();
  byte[] frame=new byte[]{(byte)REQUEST.addToVersion(Server.CURRENT_VERSION),0x00,0x00,0x01,0x09,0x10,(byte)0x00,(byte)0x00,(byte)0x00};
  byte[] body=new byte[0x10000000];
  ByteBuf buf=Unpooled.wrappedBuffer(frame,body);
  try {
    dec.decode(null,buf,results);
    Assert.fail("Expected protocol error");
  }
 catch (  ErrorMessage.WrappedException e) {
    Assert.assertEquals(1,e.getStreamId());
    Assert.assertTrue(e.getMessage().contains("Request is too big"));
  }
}

</code></pre>

<br>
<pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidDirection() throws Exception {
  Frame.Decoder dec=new Frame.Decoder(null);
  List results=new ArrayList<>();
  byte[] frame=new byte[]{(byte)RESPONSE.addToVersion(Server.CURRENT_VERSION),0x00,0x00,0x01,0x09,0x00,0x00,0x00,0x21,0x00,0x00,0x00,0x1b,0x00,0x1b,0x53,0x45,0x4c,0x45,0x43,0x54,0x20,0x2a,0x20,0x46,0x52,0x4f,0x4d,0x20,0x73,0x79,0x73,0x74,0x65,0x6d,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x3b};
  ByteBuf buf=Unpooled.wrappedBuffer(frame);
  try {
    dec.decode(null,buf,results);
    Assert.fail("Expected protocol error");
  }
 catch (  ErrorMessage.WrappedException e) {
    Assert.assertEquals(1,e.getStreamId());
    Assert.assertTrue(e.getMessage().contains("Wrong protocol direction"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.FBUtilitiesTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCompareByteSubArrays(){
  ByteBuffer bytes=ByteBuffer.allocate(16);
  assert ByteBufferUtil.compareSubArrays(null,0,null,0,0) == 0;
  assert ByteBufferUtil.compareSubArrays(null,0,ByteBufferUtil.bytes(524255231),0,4) == -1;
  assert ByteBufferUtil.compareSubArrays(ByteBufferUtil.bytes(524255231),0,null,0,4) == 1;
  System.arraycopy(Ints.toByteArray(524255231),0,bytes.array(),3,4);
  assert ByteBufferUtil.compareSubArrays(bytes,3,ByteBufferUtil.bytes(524255231),0,4) == 0;
  assert ByteBufferUtil.compareSubArrays(bytes,3,ByteBufferUtil.bytes(524255232),0,4) == -1;
  assert ByteBufferUtil.compareSubArrays(bytes,3,ByteBufferUtil.bytes(524255230),0,4) == 1;
  try {
    assert ByteBufferUtil.compareSubArrays(bytes,3,ByteBufferUtil.bytes(524255231),0,24) == 0;
    fail("Should raise an AssertionError.");
  }
 catch (  AssertionError ae) {
  }
  try {
    assert ByteBufferUtil.compareSubArrays(bytes,3,ByteBufferUtil.bytes(524255231),0,12) == 0;
    fail("Should raise an AssertionError.");
  }
 catch (  AssertionError ae) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreeTest </h4><pre class="type-15 type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  mt.split(tok(4));
  mt.split(tok(6));
  mt.split(tok(7));
  assertEquals(4,mt.size());
  assertEquals(new Range<>(tok(7),tok(-1)),mt.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(4)),mt.get(tok(3)));
  assertEquals(new Range<>(tok(-1),tok(4)),mt.get(tok(4)));
  assertEquals(new Range<>(tok(4),tok(6)),mt.get(tok(6)));
  assertEquals(new Range<>(tok(6),tok(7)),mt.get(tok(7)));
  assertEquals((byte)1,mt.get(tok(4)).depth);
  assertEquals((byte)2,mt.get(tok(6)).depth);
  assertEquals((byte)3,mt.get(tok(7)).depth);
  assertEquals((byte)3,mt.get(tok(-1)).depth);
  try {
    mt.split(tok(-1));
    fail("Shouldn't be able to split outside the initial range.");
  }
 catch (  AssertionError e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreesTest </h4><pre class="type-15 type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  mts.split(tok(4));
  mts.split(tok(6));
  mts.split(tok(7));
  assertEquals(4,mts.size());
  assertEquals(new Range<>(tok(7),tok(-1)),mts.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(4)),mts.get(tok(3)));
  assertEquals(new Range<>(tok(-1),tok(4)),mts.get(tok(4)));
  assertEquals(new Range<>(tok(4),tok(6)),mts.get(tok(6)));
  assertEquals(new Range<>(tok(6),tok(7)),mts.get(tok(7)));
  assertEquals((byte)1,mts.get(tok(4)).depth);
  assertEquals((byte)2,mts.get(tok(6)).depth);
  assertEquals((byte)3,mts.get(tok(7)).depth);
  assertEquals((byte)3,mts.get(tok(-1)).depth);
  try {
    mts.split(tok(-1));
    fail("Shouldn't be able to split outside the initial range.");
  }
 catch (  AssertionError e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.concurrent.AccumulatorTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddMoreThanCapacity(){
  Accumulator<Integer> accu=new Accumulator(4);
  accu.add(1);
  accu.add(2);
  accu.add(3);
  accu.add(4);
  try {
    accu.add(5);
    fail();
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndIterator(){
  Accumulator<String> accu=new Accumulator(4);
  accu.add("3");
  accu.add("2");
  accu.add("4");
  assertEquals("3",accu.get(0));
  assertEquals("2",accu.get(1));
  assertEquals("4",accu.get(2));
  try {
    assertEquals(null,accu.get(3));
    fail();
  }
 catch (  IndexOutOfBoundsException e) {
  }
  accu.add("0");
  assertEquals("0",accu.get(3));
  Iterator<String> iter=accu.iterator();
  assertEquals("3",iter.next());
  assertEquals("2",iter.next());
  assertEquals("4",iter.next());
  assertEquals("0",iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
