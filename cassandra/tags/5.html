<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.cassandra.auth.RoleOptionsTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void emptyByDefault(){
  RoleOptions opts=new RoleOptions();
  assertTrue(opts.isEmpty());
  assertFalse(opts.getLogin().isPresent());
  opts.setOption(IRoleManager.Option.LOGIN,true);
  assertFalse(opts.isEmpty());
  assertTrue(opts.getLogin().isPresent());
  assertTrue(opts.getLogin().get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.batchlog.BatchlogManagerTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void testConversion() throws Exception {
  long initialAllBatches=BatchlogManager.instance.countAllBatches();
  long initialReplayedBatches=BatchlogManager.instance.getTotalBatchesReplayed();
  CFMetaData cfm=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD4);
  for (int i=0; i < 1400; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 700 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    Mutation batchMutation=LegacyBatchlogMigrator.getStoreMutation(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),TimeUnit.MILLISECONDS.toMicros(timestamp),Collections.singleton(mutation)),MessagingService.VERSION_20);
    assertTrue(LegacyBatchlogMigrator.isLegacyBatchlogMutation(batchMutation));
    LegacyBatchlogMigrator.handleLegacyMutation(batchMutation);
  }
  for (int i=1400; i < 1500; i++) {
    Mutation mutation=new RowUpdateBuilder(cfm,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    long timestamp=i < 1450 ? (System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout()) : (System.currentTimeMillis() + BatchlogManager.getBatchlogTimeout());
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),Collections.singleton(mutation)));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  assertEquals(1500,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(0,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  UntypedResultSet result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy",0,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog",1500,result.one().getLong("count"));
  BatchlogManager.instance.performInitialReplay();
  assertEquals(750,BatchlogManager.instance.countAllBatches() - initialAllBatches);
  assertEquals(750,BatchlogManager.instance.getTotalBatchesReplayed() - initialReplayedBatches);
  for (int i=0; i < 1500; i++) {
    result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD4,i));
    assertNotNull(result);
    if (i < 700 || i >= 1400 && i < 1450) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue("Present at " + i,result.isEmpty());
    }
  }
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",KEYSPACE1,CF_STANDARD4));
  assertNotNull(result);
  assertEquals(750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.BATCHES));
  assertNotNull(result);
  assertEquals("Count in blog after initial replay",750,result.one().getLong("count"));
  result=executeInternal(String.format("SELECT count(*) FROM \"%s\".\"%s\"",SystemKeyspace.NAME,SystemKeyspace.LEGACY_BATCHLOG));
  assertNotNull(result);
  assertEquals("Count in blog legacy after initial replay ",0,result.one().getLong("count"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncatedReplay() throws InterruptedException, ExecutionException {
  CFMetaData cf2=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD2);
  CFMetaData cf3=Schema.instance.getCFMetaData(KEYSPACE1,CF_STANDARD3);
  for (int i=0; i < 1000; i++) {
    Mutation mutation1=new RowUpdateBuilder(cf2,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    Mutation mutation2=new RowUpdateBuilder(cf3,FBUtilities.timestampMicros(),ByteBufferUtil.bytes(i)).clustering("name" + i).add("val","val" + i).build();
    List<Mutation> mutations=Lists.newArrayList(mutation1,mutation2);
    long timestamp=System.currentTimeMillis() - BatchlogManager.getBatchlogTimeout();
    if (i == 500)     SystemKeyspace.saveTruncationRecord(Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2),timestamp,ReplayPosition.NONE);
    if (i >= 500)     timestamp++;
 else     timestamp--;
    BatchlogManager.store(Batch.createLocal(UUIDGen.getTimeUUID(timestamp,i),FBUtilities.timestampMicros(),mutations));
  }
  Keyspace.open(SystemKeyspace.NAME).getColumnFamilyStore(SystemKeyspace.BATCHES).forceBlockingFlush();
  BatchlogManager.instance.startBatchlogReplay().get();
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD2,i));
    assertNotNull(result);
    if (i >= 500) {
      assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
      assertEquals("name" + i,result.one().getString("name"));
      assertEquals("val" + i,result.one().getString("val"));
    }
 else {
      assertTrue(result.isEmpty());
    }
  }
  for (int i=0; i < 1000; i++) {
    UntypedResultSet result=executeInternal(String.format("SELECT * FROM \"%s\".\"%s\" WHERE key = intAsBlob(%d)",KEYSPACE1,CF_STANDARD3,i));
    assertNotNull(result);
    assertEquals(ByteBufferUtil.bytes(i),result.one().getBytes("key"));
    assertEquals("name" + i,result.one().getString("name"));
    assertEquals("val" + i,result.one().getString("val"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.concurrent.LongOpOrderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testOrdering() throws InterruptedException {
  errors.set(0);
  Thread.setDefaultUncaughtExceptionHandler(handler);
  final ExecutorService exec=Executors.newCachedThreadPool(new NamedThreadFactory("checker"));
  final ScheduledExecutorService checker=Executors.newScheduledThreadPool(1,new NamedThreadFactory("checker"));
  for (int i=0; i < CONSUMERS; i++)   new TestOrdering(exec,checker);
  exec.shutdown();
  exec.awaitTermination((long)(RUNTIME * 1.1),TimeUnit.MILLISECONDS);
  assertTrue(exec.isShutdown());
  assertTrue(errors.get() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.CFMetaDataTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsNameValidPositive(){
  assertTrue(CFMetaData.isNameValid("abcdefghijklmnopqrstuvwxyz"));
  assertTrue(CFMetaData.isNameValid("ABCDEFGHIJKLMNOPQRSTUVWXYZ"));
  assertTrue(CFMetaData.isNameValid("_01234567890"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsNameValidNegative(){
  assertFalse(CFMetaData.isNameValid(null));
  assertFalse(CFMetaData.isNameValid(""));
  assertFalse(CFMetaData.isNameValid(" "));
  assertFalse(CFMetaData.isNameValid("@"));
  assertFalse(CFMetaData.isNameValid("!"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.config.DatabaseDescriptorTest </h4><pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokensFromString(){
  assertTrue(DatabaseDescriptor.tokensFromString(null).isEmpty());
  Collection<String> tokens=DatabaseDescriptor.tokensFromString(" a,b ,c , d, f,g,h");
  assertEquals(7,tokens.size());
  assertTrue(tokens.containsAll(Arrays.asList(new String[]{"a","b","c","d","f","g","h"})));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ColumnConditionTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleBoundIsSatisfiedByValue() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.EQ);
  ColumnCondition.Bound bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,null,null));
  assertFalse(isSatisfiedBy(bound,ONE,null));
  assertFalse(isSatisfiedBy(bound,null,ONE));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.NEQ);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,null,null));
  assertTrue(isSatisfiedBy(bound,ONE,null));
  assertTrue(isSatisfiedBy(bound,null,ONE));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.LT);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.LTE);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertFalse(isSatisfiedBy(bound,ZERO,ONE));
  assertTrue(isSatisfiedBy(bound,TWO,ONE));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertTrue(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.GT);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertFalse(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertFalse(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
  condition=ColumnCondition.condition(definition,new Constants.Value(ONE),Operator.GTE);
  bound=condition.bind(QueryOptions.DEFAULT);
  assertTrue(isSatisfiedBy(bound,ONE,ONE));
  assertTrue(isSatisfiedBy(bound,ZERO,ONE));
  assertFalse(isSatisfiedBy(bound,TWO,ONE));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE));
  assertFalse(isSatisfiedBy(bound,ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertTrue(isSatisfiedBy(bound,ByteBufferUtil.EMPTY_BYTE_BUFFER,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  assertThrowsIRE(bound,null,ONE);
  assertFalse(isSatisfiedBy(bound,ONE,null));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSetCollectionBoundAppliesTo() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,null,new Sets.Value(set(ONE)),Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Sets.Value(set(ONE)),Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertFalse(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertTrue(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list()));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(setAppliesTo(bound,set(ONE),list(ONE)));
  assertFalse(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list()));
  assertTrue(setAppliesTo(bound,set(ZERO),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ZERO)));
  assertTrue(setAppliesTo(bound,set(ONE),list(ONE,TWO)));
  assertFalse(setAppliesTo(bound,set(ONE,TWO),list(ONE)));
  assertTrue(setAppliesTo(bound,set(),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list()));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(setAppliesTo(bound,set(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(setAppliesTo(bound,set(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMapCollectionBoundIsSatisfiedByValue() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  Map<ByteBuffer,ByteBuffer> placeholderMap=new TreeMap<>();
  placeholderMap.put(ONE,ONE);
  Maps.Value placeholder=new Maps.Value(placeholderMap);
  ColumnCondition condition=ColumnCondition.condition(definition,null,placeholder,Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertFalse(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,placeholder,Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map()));
  assertTrue(mapAppliesTo(bound,map(ZERO,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ZERO,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ZERO),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ZERO)));
  assertTrue(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ONE,TWO,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE,TWO,ONE),map(ONE,ONE)));
  assertTrue(mapAppliesTo(bound,map(),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map()));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ONE)));
  assertFalse(mapAppliesTo(bound,map(ONE,ONE),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(mapAppliesTo(bound,map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE),map(ByteBufferUtil.EMPTY_BYTE_BUFFER,ONE)));
  assertTrue(mapAppliesTo(bound,map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER),map(ONE,ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testListCollectionBoundAppliesTo() throws InvalidRequestException {
  ColumnDefinition definition=ColumnDefinition.regularDef("ks","cf","c",ListType.getInstance(Int32Type.instance,true));
  ColumnCondition condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.EQ);
  ColumnCondition.CollectionBound bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.NEQ);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.LTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertFalse(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertTrue(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list()));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GT);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertFalse(listAppliesTo(bound,list(ONE),list(ONE)));
  assertFalse(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertFalse(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  condition=ColumnCondition.condition(definition,null,new Lists.Value(Arrays.asList(ONE)),Operator.GTE);
  bound=(ColumnCondition.CollectionBound)condition.bind(QueryOptions.DEFAULT);
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list()));
  assertTrue(listAppliesTo(bound,list(ZERO),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ZERO)));
  assertTrue(listAppliesTo(bound,list(ONE),list(ONE,ONE)));
  assertFalse(listAppliesTo(bound,list(ONE,ONE),list(ONE)));
  assertTrue(listAppliesTo(bound,list(),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list()));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ONE)));
  assertFalse(listAppliesTo(bound,list(ONE),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
  assertTrue(listAppliesTo(bound,list(ByteBufferUtil.EMPTY_BYTE_BUFFER),list(ByteBufferUtil.EMPTY_BYTE_BUFFER)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.CqlParserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testAddErrorListener() throws Exception {
  SyntaxErrorCounter firstCounter=new SyntaxErrorCounter();
  SyntaxErrorCounter secondCounter=new SyntaxErrorCounter();
  CharStream stream=new ANTLRStringStream("SELECT * FORM users");
  CqlLexer lexer=new CqlLexer(stream);
  TokenStream tokenStream=new CommonTokenStream(lexer);
  CqlParser parser=new CqlParser(tokenStream);
  parser.addErrorListener(firstCounter);
  parser.addErrorListener(secondCounter);
  parser.query();
  assertTrue(firstCounter.count > 0);
  assertTrue(secondCounter.count > 0);
}

</code></pre>

<br>
<pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveErrorListener() throws Exception {
  SyntaxErrorCounter firstCounter=new SyntaxErrorCounter();
  SyntaxErrorCounter secondCounter=new SyntaxErrorCounter();
  CharStream stream=new ANTLRStringStream("SELECT * FORM test;");
  CqlLexer lexer=new CqlLexer(stream);
  TokenStream tokenStream=new CommonTokenStream(lexer);
  CqlParser parser=new CqlParser(tokenStream);
  parser.addErrorListener(firstCounter);
  parser.addErrorListener(secondCounter);
  parser.removeErrorListener(secondCounter);
  parser.query();
  assertTrue(firstCounter.count > 0);
  assertEquals(0,secondCounter.count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.DeleteTest </h4><pre class="type-6 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void lostDeletesTest(){
  Session session=sessionNet();
  for (int i=0; i < 500; i++) {
    session.execute(pstmtI.bind(1,1,"inhB","valB"));
    ResultSetFuture[] futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertNotNull(futures[2].getUninterruptibly().one());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
    session.execute(pstmtU.bind("inhBu","valBu",1,1));
    futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertNotNull(futures[2].getUninterruptibly().one());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
    session.execute(pstmtD.bind(1,1));
    futures=load();
    Assert.assertTrue(futures[0].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[1].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[2].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[3].getUninterruptibly().isExhausted());
    Assert.assertTrue(futures[4].getUninterruptibly().isExhausted());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.KeyCacheCqlTest </h4><pre class="type-6 type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2iKeyCachePathsSaveKeysForDroppedTable() throws Throwable {
  String table=createTable("CREATE TABLE %s (" + commonColumnsDef + "PRIMARY KEY ((part_key_a, part_key_b),clust_key_a,clust_key_b,clust_key_c))");
  createIndex("CREATE INDEX some_index ON %s (col_int)");
  insertData(table,"some_index",true);
  clearCache();
  CacheMetrics metrics=CacheService.instance.keyCache.getMetrics();
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  long hits=metrics.hits.getCount();
  long requests=metrics.requests.getCount();
  assertEquals(0,hits);
  assertEquals(210,requests);
  for (int i=0; i < 10; i++) {
    UntypedResultSet result=execute("SELECT part_key_a FROM %s WHERE col_int = ?",i);
    assertEquals(500,result.size());
  }
  metrics=CacheService.instance.keyCache.getMetrics();
  hits=metrics.hits.getCount();
  requests=metrics.requests.getCount();
  assertEquals(200,hits);
  assertEquals(420,requests);
  dropTable("DROP TABLE %s");
  CacheService.instance.keyCache.submitWrite(Integer.MAX_VALUE).get();
  CacheService.instance.keyCache.clear();
  Assert.assertEquals(0,CacheService.instance.keyCache.size());
  CacheService.instance.keyCache.loadSaved();
  Iterator<KeyCacheKey> iter=CacheService.instance.keyCache.keyIterator();
  while (iter.hasNext()) {
    KeyCacheKey key=iter.next();
    Assert.assertFalse(key.ksAndCFName.left.equals("KEYSPACE"));
    Assert.assertFalse(key.ksAndCFName.right.startsWith(table));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.NonNativeTimestampTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void setServerTimestampForNonCqlNativeStatements() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, v int)");
  execute("INSERT INTO %s (k, v) values (1, ?)",2);
  UntypedResultSet.Row row=execute("SELECT v, writetime(v) AS wt FROM %s WHERE k = 1").one();
  assertEquals(2,row.getInt("v"));
  long timestamp1=row.getLong("wt");
  assertFalse(timestamp1 == -1l);
  execute("INSERT INTO %s (k, v) values (1, ?)",1);
  row=execute("SELECT v, writetime(v) AS wt FROM %s WHERE k = 1").one();
  assertEquals(1,row.getInt("v"));
  assertTrue(row.getLong("wt") > timestamp1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ThriftCompatibilityTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDropCompactStaticColumn(){
  ColumnDef column1=new ColumnDef();
  column1.setName(bytes(42)).setValidation_class(UTF8Type.instance.toString());
  ColumnDef column2=new ColumnDef();
  column2.setName(bytes(25)).setValidation_class(UTF8Type.instance.toString());
  CfDef cf=new CfDef("thriftks","staticcompact");
  cf.setColumn_type("Standard").setComparator_type(Int32Type.instance.toString()).setDefault_validation_class(UTF8Type.instance.toString()).setKey_validation_class(BytesType.instance.toString()).setColumn_metadata(Arrays.asList(column1,column2));
  SchemaLoader.createKeyspace("thriftks",KeyspaceParams.simple(1),ThriftConversion.fromThrift(cf));
  CFMetaData cfm=Schema.instance.getCFMetaData("thriftks","staticcompact");
  assertTrue(cfm.getColumnMetadata().containsKey(bytes(42)));
  assertTrue(cfm.getColumnMetadata().containsKey(bytes(25)));
  cf.setColumn_metadata(Collections.singletonList(column1));
  MigrationManager.announceColumnFamilyUpdate(ThriftConversion.fromThriftForUpdate(cf,cfm),true);
  assertTrue(cfm.getColumnMetadata().containsKey(bytes(42)));
  assertFalse(cfm.getColumnMetadata().containsKey(bytes(25)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.UDHelperTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmptiableTypes(){
  AbstractType<?>[] types=new AbstractType<?>[]{BooleanType.instance,CounterColumnType.instance,DateType.instance,DecimalType.instance,DoubleType.instance,FloatType.instance,InetAddressType.instance,Int32Type.instance,IntegerType.instance,LongType.instance,TimestampType.instance,TimeUUIDType.instance,UUIDType.instance};
  for (  AbstractType<?> type : types) {
    Assert.assertTrue(type.getClass().getSimpleName(),UDHelper.isNullOrEmpty(type,ByteBufferUtil.EMPTY_BYTE_BUFFER));
    Assert.assertTrue("reversed " + type.getClass().getSimpleName(),UDHelper.isNullOrEmpty(ReversedType.getInstance(type),ByteBufferUtil.EMPTY_BYTE_BUFFER));
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyVariableLengthTypes(){
  AbstractType<?>[] types=new AbstractType<?>[]{AsciiType.instance,BytesType.instance,UTF8Type.instance,new UFTestCustomType()};
  for (  AbstractType<?> type : types) {
    Assert.assertFalse("type " + type.getClass().getName(),UDHelper.isNullOrEmpty(type,ByteBufferUtil.EMPTY_BYTE_BUFFER));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.ViewTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDeleteSingleColumnInViewPartitionKey() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND d IS NOT NULL PRIMARY KEY (d, a, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,0));
  updateView("DELETE c FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,null));
  updateView("DELETE d FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b FROM mv1");
  assertTrue(mvRows.isExhausted());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void ttlTest() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE c IS NOT NULL AND a IS NOT NULL AND b IS NOT NULL PRIMARY KEY (c, a, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?) USING TTL 5",1,1,1,1);
  Thread.sleep(TimeUnit.SECONDS.toMillis(3));
  updateView("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",1,1,2);
  Thread.sleep(TimeUnit.SECONDS.toMillis(3));
  List<Row> results=executeNet(protocolVersion,"SELECT d FROM mv WHERE c = 2 AND a = 1 AND b = 1").all();
  Assert.assertEquals(1,results.size());
  Assert.assertTrue("There should be a null result given back due to ttl expiry",results.get(0).isNull(0));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDeleteSingleColumnInViewClustering() throws Throwable {
  createTable("CREATE TABLE %s (" + "a int," + "b int,"+ "c int,"+ "d int,"+ "PRIMARY KEY (a, b))");
  executeNet(protocolVersion,"USE " + keyspace());
  createView("mv1","CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE a IS NOT NULL AND b IS NOT NULL AND d IS NOT NULL PRIMARY KEY (a, d, b)");
  updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  ResultSet mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,0));
  updateView("DELETE c FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b, c FROM mv1");
  assertRowsNet(protocolVersion,mvRows,row(0,0,0,null));
  updateView("DELETE d FROM %s WHERE a = ? AND b = ?",0,0);
  mvRows=executeNet(protocolVersion,"SELECT a, d, b FROM mv1");
  assertTrue(mvRows.isExhausted());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexOnMapEntriesTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldTreatQueriesAgainstFrozenMapIndexesAsInvalid() throws Throwable {
  createTable("CREATE TABLE %s (k TEXT PRIMARY KEY, v FROZEN<MAP<TEXT, TEXT>>)");
  createIndex("CREATE INDEX ON %s(FULL(V))");
  try {
    execute("SELECT * FROM %s WHERE v['somekey'] = 'somevalue'");
    fail("Expected index query to fail");
  }
 catch (  InvalidRequestException e) {
    String expectedMessage="Map-entry equality predicates on frozen map column v are not supported";
    assertTrue("Expected error message to contain '" + expectedMessage + "' but got '"+ e.getMessage()+ "'",e.getMessage().contains(expectedMessage));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest </h4><pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletions() throws Throwable {
  String indexClassName=StubIndex.class.getName();
  createTable("CREATE TABLE %s (a int, b int, c int, PRIMARY KEY ((a), b))");
  createIndex(String.format("CREATE CUSTOM INDEX c_idx ON %%s(c) USING '%s'",indexClassName));
  ColumnFamilyStore cfs=getCurrentColumnFamilyStore();
  CFMetaData cfm=cfs.metadata;
  StubIndex index1=(StubIndex)cfs.indexManager.getIndex(cfm.getIndexes().get("c_idx").orElseThrow(throwAssert("index not found")));
  execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?) USING TIMESTAMP 1",0,0,0);
  assertEquals(1,index1.rowsInserted.size());
  execute("DELETE FROM %s USING TIMESTAMP 2 WHERE a = ? AND b = ?",0,0);
  assertEquals(1,index1.rowsUpdated.size());
  Pair<Row,Row> update=index1.rowsUpdated.get(0);
  Row existingRow=update.left;
  Row newRow=update.right;
  assertTrue(existingRow.deletion().isLive());
  assertEquals(DeletionTime.LIVE,existingRow.deletion().time());
  assertEquals(1L,existingRow.primaryKeyLivenessInfo().timestamp());
  assertFalse(newRow.deletion().isLive());
  assertEquals(2L,newRow.deletion().time().markedForDeleteAt());
  assertFalse(newRow.cells().iterator().hasNext());
  execute("DELETE FROM %s USING TIMESTAMP 3 WHERE a = ? AND b = ?",0,0);
  assertEquals(2,index1.rowsUpdated.size());
  update=index1.rowsUpdated.get(1);
  existingRow=update.left;
  newRow=update.right;
  assertFalse(existingRow.deletion().isLive());
  assertEquals(2L,existingRow.deletion().time().markedForDeleteAt());
  assertFalse(existingRow.cells().iterator().hasNext());
  assertFalse(newRow.deletion().isLive());
  assertEquals(3L,newRow.deletion().time().markedForDeleteAt());
  assertFalse(newRow.cells().iterator().hasNext());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.indexes_composite_test()
 */
@Test public void testIndexOnComposite() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (blog_id int, timestamp int, author text, content text, PRIMARY KEY (blog_id, timestamp))");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",0,0,"bob","1st post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",0,1,"tom","2nd post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",0,2,"bob","3rd post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",0,3,"tom","4th post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",1,0,"bob","5th post");
  createIndex("CREATE INDEX authoridx ON %s (author)");
  assertTrue(waitForIndex(keyspace(),tableName,"authoridx"));
  assertRows(execute("SELECT blog_id, timestamp FROM %s WHERE author = 'bob'"),row(1,0),row(0,0),row(0,2));
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",1,1,"tom","6th post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",1,2,"tom","7th post");
  execute("INSERT INTO %s (blog_id, timestamp, author, content) VALUES (?, ?, ?, ?)",1,3,"bob","8th post");
  assertRows(execute("SELECT blog_id, timestamp FROM %s WHERE author = 'bob'"),row(1,0),row(1,3),row(0,0),row(0,2));
  execute("DELETE FROM %s WHERE blog_id = 0 AND timestamp = 2");
  assertRows(execute("SELECT blog_id, timestamp FROM %s WHERE author = 'bob'"),row(1,0),row(1,3),row(0,0));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdatesToMemtableData() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v1 int, v2 int, PRIMARY KEY (k,c))");
  createIndex(String.format("CREATE CUSTOM INDEX test_index ON %%s() USING '%s'",StubIndex.class.getName()));
  execute("INSERT INTO %s (k, c, v1, v2) VALUES (0, 0, 0, 0) USING TIMESTAMP 0");
  ColumnDefinition v1=getCurrentColumnFamilyStore().metadata.getColumnDefinition(new ColumnIdentifier("v1",true));
  ColumnDefinition v2=getCurrentColumnFamilyStore().metadata.getColumnDefinition(new ColumnIdentifier("v2",true));
  StubIndex index=(StubIndex)getCurrentColumnFamilyStore().indexManager.getIndexByName("test_index");
  assertEquals(1,index.rowsInserted.size());
  execute("UPDATE %s USING TIMESTAMP 1 SET v1=1 WHERE k=0 AND c=0");
  assertEquals(1,index.rowsUpdated.size());
  Row oldRow=index.rowsUpdated.get(0).left;
  assertEquals(1,oldRow.size());
  validateCell(oldRow.getCell(v1),v1,ByteBufferUtil.bytes(0),0);
  Row newRow=index.rowsUpdated.get(0).right;
  assertEquals(1,newRow.size());
  validateCell(newRow.getCell(v1),v1,ByteBufferUtil.bytes(1),1);
  index.reset();
  execute("UPDATE %s USING TIMESTAMP 2 SET v1=2, v2=2 WHERE k=0 AND c=0");
  assertEquals(1,index.rowsUpdated.size());
  oldRow=index.rowsUpdated.get(0).left;
  assertEquals(2,oldRow.size());
  validateCell(oldRow.getCell(v1),v1,ByteBufferUtil.bytes(1),1);
  validateCell(oldRow.getCell(v2),v2,ByteBufferUtil.bytes(0),0);
  newRow=index.rowsUpdated.get(0).right;
  assertEquals(2,newRow.size());
  validateCell(newRow.getCell(v1),v1,ByteBufferUtil.bytes(2),2);
  validateCell(newRow.getCell(v2),v2,ByteBufferUtil.bytes(2),2);
  index.reset();
  execute("DELETE v1 FROM %s USING TIMESTAMP 3 WHERE k=0 AND c=0");
  assertEquals(1,index.rowsUpdated.size());
  oldRow=index.rowsUpdated.get(0).left;
  assertEquals(1,oldRow.size());
  validateCell(oldRow.getCell(v1),v1,ByteBufferUtil.bytes(2),2);
  newRow=index.rowsUpdated.get(0).right;
  assertEquals(1,newRow.size());
  Cell newCell=newRow.getCell(v1);
  assertTrue(newCell.isTombstone());
  assertEquals(3,newCell.timestamp());
  index.reset();
  execute("INSERT INTO %s(k, c) VALUES (0, 0) USING TIMESTAMP 4");
  assertEquals(1,index.rowsUpdated.size());
  oldRow=index.rowsUpdated.get(0).left;
  assertEquals(0,oldRow.size());
  assertEquals(0,oldRow.primaryKeyLivenessInfo().timestamp());
  newRow=index.rowsUpdated.get(0).right;
  assertEquals(0,newRow.size());
  assertEquals(4,newRow.primaryKeyLivenessInfo().timestamp());
}

</code></pre>

<br>
<pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexQueriesWithIndexNotReady() throws Throwable {
  createTable("CREATE TABLE %s (pk int, ck int, value int, PRIMARY KEY (pk, ck))");
  for (int i=0; i < 10; i++)   for (int j=0; j < 10; j++)   execute("INSERT INTO %s (pk, ck, value) VALUES (?, ?, ?)",i,j,i + j);
  createIndex("CREATE CUSTOM INDEX testIndex ON %s (value) USING '" + IndexBlockingOnInitialization.class.getName() + "'");
  try {
    execute("SELECT value FROM %s WHERE value = 2");
    fail();
  }
 catch (  IndexNotAvailableException e) {
    assertTrue(true);
  }
 finally {
    execute("DROP index " + KEYSPACE + ".testIndex");
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test for CASSANDRA-5732, Can not query secondary index
 * migrated from cql_tests.py:TestCQL.bug_5732_test(),
 * which was executing with a row cache size of 100 MB
 * and restarting the node, here we just cleanup the cache.
 */
@Test public void testCanQuerySecondaryIndex() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (k int PRIMARY KEY, v int,)");
  execute("ALTER TABLE %s WITH CACHING = { 'keys': 'ALL', 'rows_per_partition': 'ALL' }");
  execute("INSERT INTO %s (k,v) VALUES (0,0)");
  execute("INSERT INTO %s (k,v) VALUES (1,1)");
  createIndex("CREATE INDEX testindex on %s (v)");
  assertTrue(waitForIndex(keyspace(),tableName,"testindex"));
  assertRows(execute("SELECT k FROM %s WHERE v = 0"),row(0));
  cleanupCache();
  assertRows(execute("SELECT k FROM %s WHERE v = 0"),row(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.StaticColumnsTest </h4><pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.static_columns_test()
 */
@Test public void testStaticColumns() throws Throwable {
  createTable("CREATE TABLE %s ( k int, p int, s int static, v int, PRIMARY KEY (k, p))");
  execute("INSERT INTO %s(k, s) VALUES (0, 42)");
  assertRows(execute("SELECT * FROM %s"),row(0,null,42,null));
  Object[][] row=getRows(execute("SELECT s, writetime(s) FROM %s WHERE k=0"));
  assertEquals(42,row[0][0]);
  assertTrue((Long)row[0][1] > 0);
  execute("INSERT INTO %s (k, p, s, v) VALUES (0, 0, 12, 0)");
  execute("INSERT INTO %s (k, p, s, v) VALUES (0, 1, 24, 1)");
  assertRows(execute("SELECT * FROM %s"),row(0,0,24,0),row(0,1,24,1));
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND p=0"),row(0,0,24,0));
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND p=1"),row(0,1,24,1));
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND p IN (0, 1)"),row(0,0,24,0),row(0,1,24,1));
  assertRows(execute("SELECT p, v FROM %s WHERE k=0 AND p=1"),row(1,1));
  assertRows(execute("SELECT DISTINCT s FROM %s WHERE k=0"),row(24));
  assertRows(execute("SELECT s FROM %s WHERE k=0"),row(24),row(24));
  assertRows(execute("SELECT s, v FROM %s WHERE k=0"),row(24,0),row(24,1));
  assertRows(execute("SELECT s, v FROM %s WHERE k=0 AND p=1"),row(24,1));
  assertRows(execute("SELECT p, s FROM %s WHERE k=0 AND p=1"),row(1,24));
  assertRows(execute("SELECT k, p, s FROM %s WHERE k=0 AND p=1"),row(0,1,24));
  execute("DELETE FROM %s WHERE k=0 AND p=0");
  assertRows(execute("SELECT * FROM %s"),row(0,1,24,1));
  execute("DELETE s FROM %s WHERE k=0");
  assertRows(execute("SELECT * FROM %s"),row(0,1,null,1));
  execute("ALTER TABLE %s ADD s2 int static");
  assertRows(execute("SELECT * FROM %s"),row(0,1,null,null,1));
  execute("INSERT INTO %s (k, p, s2, v) VALUES(0, 2, 42, 2)");
  assertRows(execute("SELECT * FROM %s"),row(0,1,null,42,1),row(0,2,null,42,2));
  execute("ALTER TABLE %s DROP s2");
  assertRows(execute("SELECT * FROM %s"),row(0,1,null,1),row(0,2,null,2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.TimestampTest </h4><pre class="type-13 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test timestmp and ttl
 * migrated from cql_tests.py:TestCQL.timestamp_and_ttl_test()
 */
@Test public void testTimestampTTL() throws Throwable {
  createTable("CREATE TABLE %s (k int PRIMARY KEY, c text, d text)");
  execute("INSERT INTO %s (k, c) VALUES (1, 'test')");
  execute("INSERT INTO %s (k, c) VALUES (2, 'test') USING TTL 400");
  Object[][] res=getRows(execute("SELECT k, c, writetime(c), ttl(c) FROM %s"));
  Assert.assertEquals(2,res.length);
  for (  Object[] r : res) {
    assertTrue(r[2] instanceof Integer || r[2] instanceof Long);
    if (r[0].equals(1))     assertNull(r[3]);
 else     assertTrue(r[3] instanceof Integer || r[2] instanceof Long);
  }
  res=getRows(execute("SELECT k, c, blobAsBigint(bigintAsBlob(writetime(c))), ttl(c) FROM %s"));
  Assert.assertEquals(2,res.length);
  for (  Object[] r : res) {
    assertTrue(r[2] instanceof Integer || r[2] instanceof Long);
    if (r[0].equals(1))     assertNull(r[3]);
 else     assertTrue(r[3] instanceof Integer || r[2] instanceof Long);
  }
  res=getRows(execute("SELECT k, c, writetime(c), blobAsInt(intAsBlob(ttl(c))) FROM %s"));
  Assert.assertEquals(2,res.length);
  for (  Object[] r : res) {
    assertTrue(r[2] instanceof Integer || r[2] instanceof Long);
    if (r[0].equals(1))     assertNull(r[3]);
 else     assertTrue(r[3] instanceof Integer || r[2] instanceof Long);
  }
  assertInvalid("SELECT k, c, writetime(k) FROM %s");
  assertRows(execute("SELECT k, d, writetime(d) FROM %s WHERE k = 1"),row(1,null,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.entities.UFTest </h4><pre class="type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJavaFunctionInvalidBodies() throws Throwable {
  try {
    execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".jfinv() "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS bigint "+ "LANGUAGE JAVA\n"+ "AS '\n"+ "foobarbaz"+ "\n';");
    Assert.fail();
  }
 catch (  InvalidRequestException e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Java source compilation failed"));
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("insert \";\" to complete BlockStatements"));
  }
  try {
    execute("CREATE OR REPLACE FUNCTION " + KEYSPACE + ".jfinv() "+ "RETURNS NULL ON NULL INPUT "+ "RETURNS bigint "+ "LANGUAGE JAVA\n"+ "AS '\n"+ "foobarbaz;"+ "\n';");
    Assert.fail();
  }
 catch (  InvalidRequestException e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Java source compilation failed"));
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("foobarbaz cannot be resolved to a type"));
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAmokUDF() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  long udfWarnTimeout=DatabaseDescriptor.getUserDefinedFunctionWarnTimeout();
  long udfFailTimeout=DatabaseDescriptor.getUserDefinedFunctionFailTimeout();
  int maxTries=5;
  for (int i=1; i <= maxTries; i++) {
    try {
      DatabaseDescriptor.setUserDefinedFunctionWarnTimeout(10);
      DatabaseDescriptor.setUserDefinedFunctionFailTimeout(250);
      DatabaseDescriptor.setUserFunctionTimeoutPolicy(Config.UserFunctionTimeoutPolicy.ignore);
      ClientWarn.instance.captureWarnings();
      String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'long t=System.currentTimeMillis()+110; while (t>System.currentTimeMillis()) { }; return 0d;'");
      execute("SELECT " + fName + "(dval) FROM %s WHERE key=1");
      List<String> warnings=ClientWarn.instance.getWarnings();
      Assert.assertNotNull(warnings);
      Assert.assertFalse(warnings.isEmpty());
      ClientWarn.instance.resetWarnings();
      fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'long t=System.currentTimeMillis()+500; while (t>System.currentTimeMillis()) { }; return 0d;';");
      assertInvalidMessage("ran longer than 250ms","SELECT " + fName + "(dval) FROM %s WHERE key=1");
      fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVASCRIPT\n"+ "AS 'var t=java.lang.System.currentTimeMillis()+500; while (t>java.lang.System.currentTimeMillis()) { }; 0;';");
      assertInvalidMessage("ran longer than 250ms","SELECT " + fName + "(dval) FROM %s WHERE key=1");
      return;
    }
 catch (    Error|RuntimeException e) {
      if (i == maxTries)       throw e;
    }
 finally {
      DatabaseDescriptor.setUserDefinedFunctionWarnTimeout(udfWarnTimeout);
      DatabaseDescriptor.setUserDefinedFunctionFailTimeout(udfFailTimeout);
    }
  }
}

</code></pre>

<br>
<pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFunctionExecutionExceptionNet() throws Throwable {
  createTable("CREATE TABLE %s (key int primary key, dval double)");
  execute("INSERT INTO %s (key, dval) VALUES (?, ?)",1,1d);
  String fName=createFunction(KEYSPACE_PER_TEST,"double","CREATE OR REPLACE FUNCTION %s(val double) " + "RETURNS NULL ON NULL INPUT " + "RETURNS double "+ "LANGUAGE JAVA\n"+ "AS 'throw new RuntimeException();'");
  for (  int version : PROTOCOL_VERSIONS) {
    try {
      assertRowsNet(version,executeNet(version,"SELECT " + fName + "(dval) FROM %s WHERE key = 1"));
      Assert.fail();
    }
 catch (    com.datastax.driver.core.exceptions.FunctionExecutionException fee) {
      Assert.assertTrue(version >= Server.VERSION_4);
    }
catch (    InvalidQueryException e) {
      Assert.assertTrue(version < Server.VERSION_4);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFunctionWithReservedName() throws Throwable {
  execute("CREATE TABLE " + KEYSPACE_PER_TEST + ".second_tab (key int primary key, val double)");
  String fName=createFunction(KEYSPACE_PER_TEST,"","CREATE OR REPLACE FUNCTION %s() " + "RETURNS NULL ON NULL INPUT " + "RETURNS timestamp "+ "LANGUAGE JAVA "+ "AS 'return null;';");
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",1,1d);
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",2,2d);
  execute("INSERT INTO " + KEYSPACE_PER_TEST + ".second_tab (key, val) VALUES (?, ?)",3,3d);
  UntypedResultSet rows=execute("SELECT key, val, now() FROM " + KEYSPACE_PER_TEST + ".second_tab");
  Assert.assertEquals(3,rows.size());
  UntypedResultSet.Row row=rows.iterator().next();
  Date ts=row.getTimestamp(row.getColumns().get(2).name.toString());
  Assert.assertNotNull(ts);
  rows=execute("SELECT key, val, " + fName + "() FROM "+ KEYSPACE_PER_TEST+ ".second_tab");
  Assert.assertEquals(3,rows.size());
  row=rows.iterator().next();
  Assert.assertFalse(row.has(row.getColumns().get(2).name.toString()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.OverflowTest </h4><pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.nan_infinity_test()
 */
@Test public void testNanInfinityValues() throws Throwable {
  createTable("CREATE TABLE %s (f float PRIMARY KEY)");
  execute("INSERT INTO %s (f) VALUES (NaN)");
  execute("INSERT INTO %s (f) VALUES (-NaN)");
  execute("INSERT INTO %s (f) VALUES (Infinity)");
  execute("INSERT INTO %s (f) VALUES (-Infinity)");
  Object[][] selected=getRows(execute("SELECT * FROM %s"));
  assertEquals(3,selected.length);
  assertEquals(1,selected[0].length);
  assertTrue(Float.isNaN((Float)selected[0][0]));
  assertTrue(Float.isInfinite((Float)selected[1][0]));
  assertTrue(((Float)selected[1][0]) > 0);
  assertTrue(Float.isInfinite((Float)selected[2][0]));
  assertTrue(((Float)selected[2][0]) < 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.miscellaneous.TombstonesTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpiredTombstones() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b)) WITH gc_grace_seconds = 1;");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
    fail("SELECT with tombstones beyond the threshold should have failed, but hasn't");
  }
 catch (  Throwable e) {
    assertTrue(e instanceof TombstoneOverwhelmingException);
  }
  TimeUnit.SECONDS.sleep(2);
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
  }
 catch (  Throwable e) {
    fail("SELECT with expired tombstones beyond the threshold should not have failed, but has: " + e);
  }
}

</code></pre>

<br>
<pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBeyondThresholdSelect() throws Throwable {
  createTable("CREATE TABLE %s (a text, b text, c text, PRIMARY KEY (a, b));");
  for (int i=0; i < THRESHOLD + 1; i++)   execute("INSERT INTO %s (a, b, c) VALUES ('key', 'column" + i + "', null);");
  try {
    execute("SELECT * FROM %s WHERE a = 'key';");
    fail("SELECT with tombstones beyond the threshold should have failed, but hasn't");
  }
 catch (  Throwable e) {
    String error="Expected exception instanceof TombstoneOverwhelmingException instead got " + System.lineSeparator() + Throwables.getStackTraceAsString(e);
    assertTrue(error,e instanceof TombstoneOverwhelmingException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.AggregationTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregateWithWriteTimeOrTTL() throws Throwable {
  createTable("CREATE TABLE %s (a int primary key, b int, c int)");
  assertColumnNames(execute("SELECT count(writetime(b)), min(ttl(b)) as min, writetime(b), ttl(c) as first FROM %s"),"system.count(writetime(b))","min","writetime(b)","first");
  assertRows(execute("SELECT count(writetime(b)), min(ttl(b)) as min, writetime(b), ttl(c) as first FROM %s"),row(0L,null,null,null));
  long today=System.currentTimeMillis() * 1000;
  long yesterday=today - (DateUtils.MILLIS_PER_DAY * 1000);
  final int secondsPerMinute=60;
  execute("INSERT INTO %s (a, b, c) VALUES (1, 2, null) USING TTL " + (20 * secondsPerMinute));
  execute("INSERT INTO %s (a, b, c) VALUES (2, 4, 6) USING TTL " + (10 * secondsPerMinute));
  execute("INSERT INTO %s (a, b, c) VALUES (4, 8, 12) USING TIMESTAMP " + yesterday);
  assertRows(execute("SELECT count(writetime(b)), count(ttl(b)) FROM %s"),row(3L,2L));
  UntypedResultSet resultSet=execute("SELECT min(ttl(b)), ttl(b) FROM %s");
  assertEquals(1,resultSet.size());
  Row row=resultSet.one();
  assertTrue(row.getInt("ttl(b)") > (10 * secondsPerMinute));
  assertTrue(row.getInt("system.min(ttl(b))") <= (10 * secondsPerMinute));
  resultSet=execute("SELECT min(writetime(b)), writetime(b) FROM %s");
  assertEquals(1,resultSet.size());
  row=resultSet.one();
  assertTrue(row.getLong("writetime(b)") >= today);
  assertTrue(row.getLong("system.min(writetime(b))") == yesterday);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.CreateTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCQL3PartitionKeyOnlyTable(){
  createTable("CREATE TABLE %s (id text PRIMARY KEY);");
  assertFalse(currentTableMetadata().isThriftCompatible());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.conditional_ddl_index_test()
 */
@Test public void testDropCreateIndexIfNotExists() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (id text PRIMARY KEY, value1 blob, value2 blob)with comment = 'foo'");
  execute("use " + KEYSPACE);
  schemaChange("DROP INDEX IF EXISTS myindex");
  createIndex("CREATE INDEX IF NOT EXISTS myindex ON %s (value1)");
  assertTrue(waitForIndex(KEYSPACE,tableName,"myindex"));
  execute("CREATE INDEX IF NOT EXISTS myindex ON %s (value1)");
  execute("DROP INDEX IF EXISTS myindex");
  Object[][] rows=getRows(execute("select index_name from system.\"IndexInfo\" where table_name = ?",tableName));
  assertEquals(0,rows.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectOrderByTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test that columns don't need to be selected for ORDER BY when there is a IN (#4911),
 * migrated from cql_tests.py:TestCQL.in_order_by_without_selecting_test()
 */
@Test public void testInOrderByWithoutSelecting() throws Throwable {
  createTable("CREATE TABLE %s (k int, c1 int, c2 int, v int, PRIMARY KEY (k, c1, c2))");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, 0, 0)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, 1, 1)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (0, 0, 2, 2)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (1, 1, 0, 3)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (1, 1, 1, 4)");
  execute("INSERT INTO %s (k, c1, c2, v) VALUES (1, 1, 2, 5)");
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0)"),row(0,0,0,0),row(0,0,2,2));
  assertRows(execute("SELECT * FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0) ORDER BY c1 ASC, c2 ASC"),row(0,0,0,0),row(0,0,2,2));
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0)"),row(0),row(2));
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0) ORDER BY c1 ASC"),row(0),row(2));
  assertRows(execute("SELECT v FROM %s WHERE k=0 AND c1 = 0 AND c2 IN (2, 0) ORDER BY c1 DESC"),row(2),row(0));
  assertRows(execute("SELECT v FROM %s WHERE k IN (1, 0)"),row(0),row(1),row(2),row(3),row(4),row(5));
  assertRows(execute("SELECT v FROM %s WHERE k IN (1, 0) ORDER BY c1 ASC"),row(0),row(1),row(2),row(3),row(4),row(5));
  Object[][] results=getRows(execute("SELECT writetime(v) FROM %s WHERE k IN (1, 0) ORDER BY c1 ASC"));
  assertTrue(isFirstIntSorted(results));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.cql3.validation.operations.SelectTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Migrated from cql_tests.py:TestCQL.select_with_alias_test()
 */
@Test public void testSelectWithAlias() throws Throwable {
  createTable("CREATE TABLE %s (id int PRIMARY KEY, name text)");
  for (int id=0; id < 5; id++)   execute("INSERT INTO %s (id, name) VALUES (?, ?) USING TTL 10 AND TIMESTAMP 0",id,"name" + id);
  UntypedResultSet rs=execute("SELECT count(*) AS user_count FROM %s");
  assertEquals("user_count",rs.metadata().get(0).name.toString());
  assertEquals(5L,rs.one().getLong(rs.metadata().get(0).name.toString()));
  rs=execute("SELECT name AS user_name FROM %s WHERE id = 0");
  assertEquals("user_name",rs.metadata().get(0).name.toString());
  assertEquals("name0",rs.one().getString(rs.metadata().get(0).name.toString()));
  rs=execute("SELECT writeTime(name) AS name_writetime FROM %s WHERE id = 0");
  assertEquals("name_writetime",rs.metadata().get(0).name.toString());
  assertEquals(0,rs.one().getInt(rs.metadata().get(0).name.toString()));
  rs=execute("SELECT ttl(name) AS name_ttl FROM %s WHERE id = 0");
  assertEquals("name_ttl",rs.metadata().get(0).name.toString());
  int ttl=rs.one().getInt(rs.metadata().get(0).name.toString());
  assertTrue(ttl == 9 || ttl == 10);
  rs=execute("SELECT intAsBlob(id) AS id_blob FROM %s WHERE id = 0");
  assertEquals("id_blob",rs.metadata().get(0).name.toString());
  assertEquals(ByteBuffer.wrap(new byte[4]),rs.one().getBlob(rs.metadata().get(0).name.toString()));
  assertInvalidMessage("Aliases aren't allowed in the where clause","SELECT id AS user_id, name AS user_name FROM %s WHERE user_id = 0");
  assertInvalidMessage("Aliases are not allowed in order by clause","SELECT id AS user_id, name AS user_name FROM %s WHERE id IN (0) ORDER BY user_name");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnFamilyStoreTest </h4><pre class="type-7 type-4 type-5 type-19 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearEphemeralSnapshots() throws Throwable {
  Assume.assumeTrue(!FBUtilities.isWindows());
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_INDEX1);
  cfs.clearSnapshot("");
  int numRows=1000;
  long[] colValues=new long[numRows * 2];
  for (int i=0; i < colValues.length; i+=2) {
    colValues[i]=(i % 4 == 0 ? 1L : 2L);
    colValues[i + 1]=3L;
  }
  ScrubTest.fillIndexCF(cfs,false,colValues);
  cfs.snapshot("nonEphemeralSnapshot",null,false,false);
  cfs.snapshot("ephemeralSnapshot",null,true,false);
  Map<String,Pair<Long,Long>> snapshotDetails=cfs.getSnapshotDetails();
  assertEquals(2,snapshotDetails.size());
  assertTrue(snapshotDetails.containsKey("ephemeralSnapshot"));
  assertTrue(snapshotDetails.containsKey("nonEphemeralSnapshot"));
  ColumnFamilyStore.clearEphemeralSnapshots(cfs.getDirectories());
  snapshotDetails=cfs.getSnapshotDetails();
  assertEquals(1,snapshotDetails.size());
  assertTrue(snapshotDetails.containsKey("nonEphemeralSnapshot"));
  cfs.clearSnapshot("");
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBackupAfterFlush() throws Throwable {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE2).getColumnFamilyStore(CF_STANDARD1);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key1")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("key2")).clustering("Column1").add("val","asdf").build().applyUnsafe();
  cfs.forceBlockingFlush();
  for (int version=1; version <= 2; ++version) {
    Descriptor existing=new Descriptor(cfs.getDirectories().getDirectoryForNewSSTables(),KEYSPACE2,CF_STANDARD1,version);
    Descriptor desc=new Descriptor(Directories.getBackupsDirectory(existing),KEYSPACE2,CF_STANDARD1,version);
    for (    Component c : new Component[]{Component.DATA,Component.PRIMARY_INDEX,Component.FILTER,Component.STATS})     assertTrue("Cannot find backed-up file:" + desc.filenameFor(c),new File(desc.filenameFor(c)).exists());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ColumnsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testContainsAllWithLargeNumberOfColumns(){
  List<String> names=new ArrayList<>();
  for (int i=0; i < 50; i++)   names.add("clustering_" + i);
  List<ColumnDefinition> defs=new ArrayList<>();
  addClustering(names,defs);
  Columns columns=Columns.from(new HashSet<>(defs));
  defs=new ArrayList<>();
  addClustering(names.subList(0,8),defs);
  Columns subset=Columns.from(new HashSet<>(defs));
  Assert.assertTrue(columns.containsAll(subset));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.CounterCellTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(COUNTER1);
  long delta=3L;
  Cell cell=createLegacyCounterCell(cfs,ByteBufferUtil.bytes("val"),delta,1);
  assertEquals(delta,CounterContext.instance().total(cell.value()));
  assertEquals(1,cell.value().getShort(0));
  assertEquals(0,cell.value().getShort(2));
  Assert.assertTrue(CounterId.wrap(cell.value(),4).isLocalId());
  assertEquals(1L,cell.value().getLong(4 + idLength));
  assertEquals(delta,cell.value().getLong(4 + idLength + clockLength));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.DirectoriesTest </h4><pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMTSnapshots() throws Exception {
  for (  final CFMetaData cfm : CFM) {
    final Directories directories=new Directories(cfm);
    assertEquals(cfDir(cfm),directories.getDirectoryForNewSSTables());
    final String n=Long.toString(System.nanoTime());
    Callable<File> directoryGetter=new Callable<File>(){
      public File call() throws Exception {
        Descriptor desc=new Descriptor(cfDir(cfm),KS,cfm.cfName,1);
        return Directories.getSnapshotDirectory(desc,n);
      }
    }
;
    List<Future<File>> invoked=Executors.newFixedThreadPool(2).invokeAll(Arrays.asList(directoryGetter,directoryGetter));
    for (    Future<File> fut : invoked) {
      assertTrue(fut.get().exists());
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-15 type-5 type-14 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiskFreeSpace(){
  DataDirectory[] dataDirectories=new DataDirectory[]{new DataDirectory(new File("/nearlyFullDir1")){
    public long getAvailableSpace(){
      return 11L;
    }
  }
,new DataDirectory(new File("/nearlyFullDir2")){
    public long getAvailableSpace(){
      return 10L;
    }
  }
,new DataDirectory(new File("/uniformDir1")){
    public long getAvailableSpace(){
      return 1000L;
    }
  }
,new DataDirectory(new File("/uniformDir2")){
    public long getAvailableSpace(){
      return 999L;
    }
  }
,new DataDirectory(new File("/veryFullDir")){
    public long getAvailableSpace(){
      return 4L;
    }
  }
};
  List<Directories.DataDirectoryCandidate> candidates=getWriteableDirectories(dataDirectories,0L);
  assertSame(dataDirectories[2],candidates.get(0).dataDirectory);
  assertSame(dataDirectories[3],candidates.get(1).dataDirectory);
  assertSame(dataDirectories[0],candidates.get(2).dataDirectory);
  assertSame(dataDirectories[1],candidates.get(3).dataDirectory);
  Map<DataDirectory,DataDirectory> testMap=new IdentityHashMap<>();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,5L);
    assertEquals(4,candidates.size());
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 4);
    if (testMap.size() == 4) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
  testMap.clear();
  for (int i=0; ; i++) {
    candidates=getWriteableDirectories(dataDirectories,11L);
    assertEquals(3,candidates.size());
    for (    Directories.DataDirectoryCandidate candidate : candidates)     assertTrue(candidate.dataDirectory.getAvailableSpace() >= 11L);
    DataDirectory dir=Directories.pickWriteableDirectory(candidates);
    testMap.put(dir,dir);
    assertFalse(testMap.size() > 3);
    if (testMap.size() == 3) {
      if (i >= 100)       break;
    }
    if (i >= 10000000)     fail();
  }
}

</code></pre>

<br>
<pre class="type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testDiskFailurePolicy_best_effort(){
  DiskFailurePolicy origPolicy=DatabaseDescriptor.getDiskFailurePolicy();
  try {
    DatabaseDescriptor.setDiskFailurePolicy(DiskFailurePolicy.best_effort);
    if (Directories.dataDirectories.length > 0) {
      String[] path=new String[]{KS,"bad"};
      File dir=new File(Directories.dataDirectories[0].location,StringUtils.join(path,File.separator));
      FileUtils.handleFSError(new FSWriteError(new IOException("Unable to create directory " + dir),dir));
    }
    for (    DataDirectory dd : Directories.dataDirectories) {
      File file=new File(dd.location,new File(KS,"bad").getPath());
      assertTrue(BlacklistedDirectories.isUnwritable(file));
    }
  }
  finally {
    DatabaseDescriptor.setDiskFailurePolicy(origPolicy);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecondaryIndexDirectories(){
  UUID tableID=CFMetaData.generateLegacyCfId(KS,"cf");
  CFMetaData PARENT_CFM=CFMetaData.Builder.create(KS,"cf").withId(tableID).addPartitionKey("thekey",UTF8Type.instance).addClusteringColumn("col",UTF8Type.instance).build();
  ColumnDefinition col=PARENT_CFM.getColumnDefinition(ByteBufferUtil.bytes("col"));
  IndexMetadata indexDef=IndexMetadata.fromIndexTargets(PARENT_CFM,Collections.singletonList(new IndexTarget(col.name,IndexTarget.Type.VALUES)),"idx",IndexMetadata.Kind.KEYS,Collections.emptyMap());
  PARENT_CFM.indexes(PARENT_CFM.getIndexes().with(indexDef));
  CFMetaData INDEX_CFM=CassandraIndex.indexCfsMetadata(PARENT_CFM,indexDef);
  Directories parentDirectories=new Directories(PARENT_CFM);
  Directories indexDirectories=new Directories(INDEX_CFM);
  for (  File dir : indexDirectories.getCFDirectories()) {
    assertEquals(cfDir(INDEX_CFM),dir);
  }
  Descriptor parentDesc=new Descriptor(parentDirectories.getDirectoryForNewSSTables(),KS,PARENT_CFM.cfName,0);
  Descriptor indexDesc=new Descriptor(indexDirectories.getDirectoryForNewSSTables(),KS,INDEX_CFM.cfName,0);
  File parentSnapshotDirectory=Directories.getSnapshotDirectory(parentDesc,"test");
  File indexSnapshotDirectory=Directories.getSnapshotDirectory(indexDesc,"test");
  assertEquals(parentSnapshotDirectory,indexSnapshotDirectory.getParentFile());
  parentSnapshotDirectory.mkdirs();
  assertTrue(parentDirectories.snapshotExists("test"));
  assertTrue(indexDirectories.snapshotExists("test"));
  assertEquals(parentDirectories.snapshotCreationTime("test"),indexDirectories.snapshotCreationTime("test"));
  Descriptor parentSnapshot=new Descriptor(parentSnapshotDirectory,KS,PARENT_CFM.cfName,0);
  createFile(parentSnapshot.filenameFor(Component.DATA),30);
  Descriptor indexSnapshot=new Descriptor(indexSnapshotDirectory,KS,INDEX_CFM.cfName,0);
  createFile(indexSnapshot.filenameFor(Component.DATA),40);
  assertEquals(30,parentDirectories.trueSnapshotsSize());
  assertEquals(40,indexDirectories.trueSnapshotsSize());
  Map<String,Pair<Long,Long>> parentSnapshotDetail=parentDirectories.getSnapshotDetails();
  assertTrue(parentSnapshotDetail.containsKey("test"));
  assertEquals(30L,parentSnapshotDetail.get("test").right.longValue());
  Map<String,Pair<Long,Long>> indexSnapshotDetail=indexDirectories.getSnapshotDetails();
  assertTrue(indexSnapshotDetail.containsKey("test"));
  assertEquals(40L,indexSnapshotDetail.get("test").right.longValue());
  File parentBackupDirectory=Directories.getBackupsDirectory(parentDesc);
  File indexBackupDirectory=Directories.getBackupsDirectory(indexDesc);
  assertEquals(parentBackupDirectory,indexBackupDirectory.getParentFile());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.LegacyCellNameTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testColumnSameNameAsClusteringKeyCompactStorage() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int PRIMARY KEY, v int)" + " WITH COMPACT STORAGE","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("column1"));
  assertTrue(cellName.column.isRegular());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testColumnSameNameAsPartitionKeyCompactStorage() throws Exception {
  CFMetaData cfm=CFMetaData.compile("CREATE TABLE cs (" + "k int PRIMARY KEY, v int)" + " WITH COMPACT STORAGE","ks");
  LegacyLayout.LegacyCellName cellName=LegacyLayout.decodeCellName(cfm,LegacyLayout.makeLegacyComparator(cfm).fromString("k"));
  assertTrue(cellName.column.isRegular());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.MmapFileTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies that {@link sun.misc.Cleaner} works and that mmap'd files can be deleted.
 */
@Test public void testMmapFile() throws Exception {
  ObjectName bpmName=new ObjectName("java.nio:type=BufferPool,name=mapped");
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  Long mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
  Long mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
  Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
  Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
  File f1=File.createTempFile("MmapFileTest1",".bin");
  File f2=File.createTempFile("MmapFileTest2",".bin");
  File f3=File.createTempFile("MmapFileTest2",".bin");
  try {
    int size=1024 * 1024;
    try (RandomAccessFile raf=new RandomAccessFile(f1,"rw")){
      raf.setLength(size);
    }
     try (RandomAccessFile raf=new RandomAccessFile(f2,"rw")){
      raf.setLength(size);
    }
     try (RandomAccessFile raf=new RandomAccessFile(f3,"rw")){
      raf.setLength(size);
    }
     try (FileChannel channel=FileChannel.open(f1.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    try (FileChannel channel=FileChannel.open(f2.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    try (FileChannel channel=FileChannel.open(f3.toPath(),StandardOpenOption.WRITE,StandardOpenOption.READ)){
      MappedByteBuffer buffer=channel.map(FileChannel.MapMode.READ_WRITE,0,size);
      mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
      mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
      Assert.assertEquals("mapped buffers don't work?",Long.valueOf(1L),mmapCount);
      Assert.assertTrue("mapped buffers don't work?",mmapMemoryUsed >= size);
      Assert.assertTrue(buffer.isDirect());
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      buffer.putInt(42);
      ((DirectBuffer)buffer).cleaner().clean();
    }
     mmapCount=(Long)mbs.getAttribute(bpmName,"Count");
    mmapMemoryUsed=(Long)mbs.getAttribute(bpmName,"MemoryUsed");
    Assert.assertEquals("# of mapped buffers should be 0",Long.valueOf(0L),mmapCount);
    Assert.assertEquals("amount of mapped memory should be 0",Long.valueOf(0L),mmapMemoryUsed);
    Assert.assertTrue(f1.delete());
    Assert.assertTrue(f2.delete());
    Assert.assertTrue(f3.delete());
  }
  finally {
    Runtime.getRuntime().gc();
    f1.delete();
    f2.delete();
    f3.delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.PartitionRangeReadTest </h4><pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testCassandra6778() throws CharacterCodingException {
  String cfname=CF_STANDARDINT;
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  ByteBuffer col=ByteBufferUtil.bytes("val");
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(col);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering(new BigInteger(new byte[]{1})).add("val","val1").build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,"k1").clustering(new BigInteger(new byte[]{0,0,1})).add("val","val2").build().applyUnsafe();
  cfs.forceBlockingFlush();
  Row row=Util.getOnlyRow(Util.cmd(cfs,"k1").includeRow(new BigInteger(new byte[]{1})).build());
  assertTrue(row.getCell(cDef).value().equals(ByteBufferUtil.bytes("val2")));
  row=Util.getOnlyRow(Util.cmd(cfs,"k1").includeRow(new BigInteger(new byte[]{0,0,1})).build());
  assertTrue(row.getCell(cDef).value().equals(ByteBufferUtil.bytes("val2")));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeSliceInclusionExclusion() throws Throwable {
  String keyspaceName=KEYSPACE1;
  String cfName=CF_STANDARD1;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  cfs.clearUnsafe();
  for (int i=0; i < 10; ++i) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,10,String.valueOf(i));
    builder.clustering("c");
    builder.add("val",String.valueOf(i));
    builder.build().applyUnsafe();
  }
  cfs.forceBlockingFlush();
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val"));
  List<FilteredPartition> partitions;
  partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("2").toKeyIncl("7").build());
  assertEquals(6,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("2")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("7")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("2").toKeyExcl("7").build());
  assertEquals(4,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("3")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("6")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("2").toKeyIncl("7").build());
  assertEquals(5,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("3")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("7")));
  partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("2").toKeyExcl("7").build());
  assertEquals(5,partitions.size());
  assertTrue(partitions.get(0).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("2")));
  assertTrue(partitions.get(partitions.size() - 1).iterator().next().getCell(cDef).value().equals(ByteBufferUtil.bytes("6")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.PartitionTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManyColumns() throws IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_TENCOL);
  RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,5,"key1").clustering("c").add("val","val1");
  for (int i=0; i < 10; i++)   builder.add("val" + i,"val" + i);
  PartitionUpdate update=builder.buildUpdate();
  CachedBTreePartition partition=CachedBTreePartition.create(update.unfilteredIterator(),FBUtilities.nowInSeconds());
  DataOutputBuffer bufOut=new DataOutputBuffer();
  CachedPartition.cacheSerializer.serialize(partition,bufOut);
  CachedPartition deserialized=CachedPartition.cacheSerializer.deserialize(new DataInputBuffer(bufOut.getData()));
  assertEquals(partition.columns().regulars.size(),deserialized.columns().regulars.size());
  assertTrue(deserialized.columns().regulars.getSimple(1).equals(partition.columns().regulars.getSimple(1)));
  assertTrue(deserialized.columns().regulars.getSimple(5).equals(partition.columns().regulars.getSimple(5)));
  ColumnDefinition cDef=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("val8"));
  assertTrue(partition.lastRow().getCell(cDef).value().equals(deserialized.lastRow().getCell(cDef).value()));
  assert deserialized.partitionKey().equals(partition.partitionKey());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneListTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addRangeWithEmptyStartAndEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(rt(4,10,3));
  l.add(atMost(12,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(atMost(12,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addIncludedRangeToRangeWithEmptyEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(atLeast(3,3,0));
  l.add(rt(4,10,4));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(rtie(3,4,3),iter.next());
  assertRT(rt(4,10,4),iter.next());
  assertRT(greaterThan(10,3,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addIncludedRangeWithEmptyEndToRangeWithEmptyEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(atLeast(3,3,0));
  l.add(atLeast(5,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(rtie(3,5,3),iter.next());
  assertRT(atLeast(5,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addRangeWithEmptyEndWitchOverlapExistingRange(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(rt(4,10,3));
  l.add(atLeast(6,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(rtie(4,6,3),iter.next());
  assertRT(atLeast(6,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addOverlappingRangeToRangeWithEmptyEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(atLeast(3,3,0));
  l.add(rt(1,10,4));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(rt(1,10,4),iter.next());
  assertRT(greaterThan(10,3,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addRangeWithEmptyEndWitchIncludeExistingRangeWithEmptyEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(atLeast(5,3,0));
  l.add(atLeast(3,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(atLeast(3,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addRangeWithEmptyEndToRangeWithEmptyStartAndEnd(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(new RangeTombstone(Slice.ALL,new DeletionTime(2,0)));
  l.add(atLeast(12,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(lessThan(12,2,0),iter.next());
  assertRT(atLeast(12,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void addRangeWithEmptyEndWitchIncludeExistingRange(){
  RangeTombstoneList l=new RangeTombstoneList(cmp,0);
  l.add(rt(4,10,3));
  l.add(atLeast(3,4,0));
  Iterator<RangeTombstone> iter=l.iterator();
  assertRT(atLeast(3,4,0),iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RangeTombstoneTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void overlappingRangeTest() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k2";
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 20; i++)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,15).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(5,10).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,2,key).addRangeTombstone(5,8).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Partition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  int nowInSec=FBUtilities.nowInSeconds();
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  CompactionManager.instance.performMaximal(cfs,false);
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  for (int i=0; i < 5; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=16; i < 20; i++)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(FBUtilities.nowInSeconds()));
  for (int i=5; i <= 15; i++)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeTombstoneCompaction() throws Exception {
  Keyspace table=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(CFNAME);
  ByteBuffer key=ByteBufferUtil.bytes("k4");
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 10; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,0,key).addRangeTombstone(0,7).build().applyUnsafe();
  cfs.forceBlockingFlush();
  assertEquals(2,cfs.getLiveSSTables().size());
  CompactionManager.instance.performMaximal(cfs,false);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  try (UnfilteredPartitionIterator scanner=sstable.getScanner()){
    try (UnfilteredRowIterator iter=scanner.next()){
      Unfiltered u1=iter.next();
      assertTrue("Expecting open marker, got " + u1.toString(cfs.metadata),u1 instanceof RangeTombstoneMarker);
      Unfiltered u2=iter.next();
      assertTrue("Expecting close marker, got " + u2.toString(cfs.metadata),u2 instanceof RangeTombstoneMarker);
      Unfiltered u3=iter.next();
      assertTrue("Expecting row, got " + u3.toString(cfs.metadata),u3 instanceof Row);
    }
   }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void simpleQueryWithRangeTombstoneTest() throws Exception {
  Keyspace keyspace=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CFNAME);
  String key="k1";
  UpdateBuilder builder;
  builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(0);
  for (int i=0; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(10,22).build().applyUnsafe();
  builder=UpdateBuilder.create(cfs.metadata,key).withTimestamp(2);
  for (int i=1; i < 40; i+=2)   builder.newRow(i).add("val",i);
  builder.applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,3,key).addRangeTombstone(19,27).build().applyUnsafe();
  int[] live=new int[]{4,9,11,17,28};
  int[] dead=new int[]{12,19,21,24,27};
  AbstractReadCommandBuilder.SinglePartitionBuilder cmdBuilder=Util.cmd(cfs,key);
  for (  int i : live)   cmdBuilder.includeRow(i);
  for (  int i : dead)   cmdBuilder.includeRow(i);
  Partition partition=Util.getOnlyPartitionUnfiltered(cmdBuilder.build());
  int nowInSec=FBUtilities.nowInSeconds();
  for (  int i : live)   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (  int i : dead)   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).fromIncl(7).toIncl(30).build());
  for (  int i : new int[]{7,8,9,11,13,15,17,28,29,30})   assertTrue("Row " + i + " should be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
  for (  int i : new int[]{10,12,14,16,18,19,20,21,22,23,24,25,26,27})   assertFalse("Row " + i + " shouldn't be live",partition.getRow(Clustering.make(bb(i))).hasLiveData(nowInSec));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reverseQueryTest() throws Exception {
  Keyspace table=Keyspace.open(KSNAME);
  ColumnFamilyStore cfs=table.getColumnFamilyStore(CFNAME);
  String key="k3";
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(0).newRow(2).add("val",2).applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,1,key).addRangeTombstone(0,10).build().applyUnsafe();
  UpdateBuilder.create(cfs.metadata,key).withTimestamp(2).newRow(1).add("val",1).applyUnsafe();
  cfs.forceBlockingFlush();
  FilteredPartition partition=Util.getOnlyPartition(Util.cmd(cfs,key).build());
  assertTrue(partition.rowCount() > 0);
  int last=i(partition.unfilteredIterator(ColumnFilter.all(cfs.metadata),Slices.ALL,true).next().clustering().get(0));
  assertEquals("Last column should be column 1 since column 2 has been deleted",1,last);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ReadMessageTest </h4><pre class="type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testNoCommitLog() throws Exception {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_FOR_COMMIT_TEST);
  ColumnFamilyStore cfsnocommit=Keyspace.open(KEYSPACENOCOMMIT).getColumnFamilyStore(CF_FOR_COMMIT_TEST);
  new RowUpdateBuilder(cfs.metadata,0,ByteBufferUtil.bytes("row")).clustering("c").add("commit1",ByteBufferUtil.bytes("abcd")).build().apply();
  new RowUpdateBuilder(cfsnocommit.metadata,0,ByteBufferUtil.bytes("row")).clustering("c").add("commit2",ByteBufferUtil.bytes("abcd")).build().apply();
  Checker checker=new Checker(cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("commit1")),cfsnocommit.metadata.getColumnDefinition(ByteBufferUtil.bytes("commit2")));
  CommitLogTestReplayer.examineCommitLog(checker);
  assertTrue(checker.commitLogMessageFound);
  assertFalse(checker.noCommitLogMessageFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerMissingHeaderTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMissingHeader() throws IOException {
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  Keyspace keyspace2=Keyspace.open(KEYSPACE2);
  DecoratedKey dk=Util.dk("keymulti");
  UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
  for (  File file : new File(DatabaseDescriptor.getCommitLogLocation()).listFiles()) {
    if (file.getName().endsWith(".header"))     FileUtils.deleteWithConfirm(file);
  }
  CommitLog.instance.resetUnsafe(false);
  Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
  Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRecoverBlocksOnBytesOutstanding() throws Exception {
  long originalMaxOutstanding=CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES;
  CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES=1;
  CommitLogReplayer.MutationInitiator originalInitiator=CommitLogReplayer.mutationInitiator;
  CommitLogReplayer.mutationInitiator=mockInitiator;
  try {
    CommitLog.instance.resetUnsafe(true);
    Keyspace keyspace1=Keyspace.open(KEYSPACE1);
    Keyspace keyspace2=Keyspace.open(KEYSPACE2);
    UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
    UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col2").add("val","1").build());
    keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
    keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
    DecoratedKey dk=Util.dk("keymulti");
    Assert.assertTrue(Util.getAllUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).isEmpty());
    Assert.assertTrue(Util.getAllUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).isEmpty());
    final AtomicReference<Throwable> err=new AtomicReference<Throwable>();
    Thread t=new Thread(){
      @Override public void run(){
        try {
          CommitLog.instance.resetUnsafe(false);
        }
 catch (        Throwable t) {
          err.set(t);
        }
      }
    }
;
    t.start();
    Assert.assertTrue(blocked.tryAcquire(1,20,TimeUnit.SECONDS));
    Thread.sleep(100);
    Assert.assertTrue(t.isAlive());
    blocker.release(Integer.MAX_VALUE);
    t.join(20 * 1000);
    if (err.get() != null)     throw new RuntimeException(err.get());
    if (t.isAlive()) {
      Throwable toPrint=new Throwable();
      toPrint.setStackTrace(Thread.getAllStackTraces().get(t));
      toPrint.printStackTrace(System.out);
    }
    Assert.assertFalse(t.isAlive());
    Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
    Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
  }
  finally {
    CommitLogReplayer.mutationInitiator=originalInitiator;
    CommitLogReplayer.MAX_OUTSTANDING_REPLAY_BYTES=originalMaxOutstanding;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOne() throws IOException {
  CommitLog.instance.resetUnsafe(true);
  Keyspace keyspace1=Keyspace.open(KEYSPACE1);
  Keyspace keyspace2=Keyspace.open(KEYSPACE2);
  UnfilteredRowIterator upd1=Util.apply(new RowUpdateBuilder(keyspace1.getColumnFamilyStore(CF_STANDARD1).metadata,1L,0,"keymulti").clustering("col1").add("val","1").build());
  UnfilteredRowIterator upd2=Util.apply(new RowUpdateBuilder(keyspace2.getColumnFamilyStore(CF_STANDARD3).metadata,1L,0,"keymulti").clustering("col2").add("val","1").build());
  keyspace1.getColumnFamilyStore("Standard1").clearUnsafe();
  keyspace2.getColumnFamilyStore("Standard3").clearUnsafe();
  CommitLog.instance.resetUnsafe(false);
  DecoratedKey dk=Util.dk("keymulti");
  Assert.assertTrue(Util.equal(upd1,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace1.getColumnFamilyStore(CF_STANDARD1),dk).build()).unfilteredIterator()));
  Assert.assertTrue(Util.equal(upd2,Util.getOnlyPartitionUnfiltered(Util.cmd(keyspace2.getColumnFamilyStore(CF_STANDARD3),dk).build()).unfilteredIterator()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RecoveryManagerTruncateTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTruncate() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore("Standard1");
  new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("cc").add("val","val1").build().applyUnsafe();
  assertTrue(Util.getAll(Util.cmd(cfs).build()).size() > 0);
  cfs.truncateBlocking();
  assert 0 != CommitLog.instance.resetUnsafe(false);
  Util.assertEmptyUnfiltered(Util.cmd(cfs).build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RepairedDataTombstonesTest </h4><pre class="type-6 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readTestPartitionTombstones() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, t2 text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=0; i < 10; i++) {
    execute("delete from %s where id=?",i);
  }
  flush();
  SSTableReader repairedSSTable=getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next();
  repair(getCurrentColumnFamilyStore(),repairedSSTable);
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("delete from %s where id=?",i);
  }
  flush();
  Thread.sleep(1000);
  ReadCommand cmd=Util.cmd(getCurrentColumnFamilyStore()).build();
  int partitionsFound=0;
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator iterator=cmd.executeLocally(executionController)){
    while (iterator.hasNext()) {
      partitionsFound++;
      UnfilteredRowIterator rowIter=iterator.next();
      int val=ByteBufferUtil.toInt(rowIter.partitionKey().getKey());
      assertTrue("val=" + val,val >= 10 && val < 20);
    }
  }
   assertEquals(10,partitionsFound);
}

</code></pre>

<br>
<pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compactionDropExpiredSSTableTest() throws Throwable {
  createTable("create table %s (id int, id2 int, t text, primary key (id, id2)) with gc_grace_seconds=0 and compaction = {'class':'SizeTieredCompactionStrategy', 'only_purge_repaired_tombstones':true}");
  for (int i=0; i < 10; i++) {
    execute("delete from %s where id=? and id2=?",1,i);
  }
  flush();
  SSTableReader repairedSSTable=getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next();
  repair(getCurrentColumnFamilyStore(),repairedSSTable);
  Thread.sleep(2000);
  for (int i=10; i < 20; i++) {
    execute("delete from %s where id=? and id2=?",1,i);
  }
  flush();
  Thread.sleep(1000);
  getCurrentColumnFamilyStore().forceMajorCompaction();
  verify();
  verify2(1);
  assertEquals(1,Iterables.size(getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE)));
  assertFalse(getCurrentColumnFamilyStore().getSSTables(SSTableSet.LIVE).iterator().next().isRepaired());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowCacheTest </h4><pre class="type-6 type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRowCache() throws Exception {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert CacheService.instance.rowCache.size() == i + 1;
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,100,10);
  for (int i=100; i < 110; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    assert cachedStore.containsCachedParition(key);
    CachedPartition cp=cachedStore.getRawCachedPartition(key);
    try (UnfilteredRowIterator ai=cp.unfilteredIterator(ColumnFilter.selection(cp.columns()),Slices.ALL,false)){
      assert ai.hasNext();
      Row r=(Row)ai.next();
      assertFalse(ai.hasNext());
      Iterator<Cell> ci=r.cells().iterator();
      assert (ci.hasNext());
      Cell cell=ci.next();
      assert cell.column().name.bytes.equals(ByteBufferUtil.bytes("val"));
      assert cell.value().equals(ByteBufferUtil.bytes("val" + i));
    }
   }
  int keysLeft=109;
  for (int i=109; i >= 10; i--) {
    cachedStore.invalidateCachedPartition(Util.dk("key" + i));
    assert CacheService.instance.rowCache.size() == keysLeft;
    keysLeft--;
  }
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSSTablesPerReadHistogramWhenRowCache(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE_CACHED);
  ColumnFamilyStore cachedStore=keyspace.getColumnFamilyStore(CF_CACHED);
  CacheService.instance.invalidateRowCache();
  CacheService.instance.setRowCacheCapacityInMB(1);
  SchemaLoader.insertData(KEYSPACE_CACHED,CF_CACHED,0,100);
  cachedStore.forceBlockingFlush();
  ((ClearableHistogram)cachedStore.metric.sstablesPerReadHistogram.cf).clear();
  for (int i=0; i < 100; i++) {
    DecoratedKey key=Util.dk("key" + i);
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_before=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    Util.getAll(Util.cmd(cachedStore,key).build());
    long count_after=cachedStore.metric.sstablesPerReadHistogram.cf.getCount();
    double belowMedian=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getValue(0.49D);
    double mean_after=cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMean();
    assertEquals("SSTablePerReadHistogram should be updated even key found in row cache",count_before + 1,count_after);
    assertTrue("In half of requests we have not touched SSTables, " + "so 49 percentile (" + belowMedian + ") must be strongly less than 0.9",belowMedian < 0.9D);
    assertTrue("In half of requests we have not touched SSTables, " + "so mean value (" + mean_after + ") must be strongly less than 1, but greater than 0",mean_after < 0.999D && mean_after > 0.001D);
  }
  assertEquals("Min value of SSTablesPerRead should be zero",0,cachedStore.metric.sstablesPerReadHistogram.cf.getSnapshot().getMin());
  CacheService.instance.setRowCacheCapacityInMB(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowIndexEntryTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializedSize() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int, b text, c int, PRIMARY KEY(a, b))");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  final RowIndexEntry simple=new RowIndexEntry(123);
  DataOutputBuffer buffer=new DataOutputBuffer();
  SerializationHeader header=new SerializationHeader(true,cfs.metadata,cfs.metadata.partitionColumns(),EncodingStats.NO_STATS);
  RowIndexEntry.Serializer serializer=new RowIndexEntry.Serializer(cfs.metadata,BigFormat.latestVersion,header);
  serializer.serialize(simple,buffer);
  assertEquals(buffer.getLength(),serializer.serializedSize(simple));
  for (int i=0; i <= DatabaseDescriptor.getColumnIndexSize() / 4; i++)   execute("INSERT INTO %s (a, b, c) VALUES (?, ?, ?)",0,"" + i,i);
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build());
  File tempFile=File.createTempFile("row_index_entry_test",null);
  tempFile.deleteOnExit();
  SequentialWriter writer=SequentialWriter.open(tempFile);
  ColumnIndex columnIndex=ColumnIndex.writeAndBuildIndex(partition.unfilteredIterator(),writer,header,Collections.emptySet(),BigFormat.latestVersion);
  RowIndexEntry<IndexHelper.IndexInfo> withIndex=RowIndexEntry.create(0xdeadbeef,DeletionTime.LIVE,columnIndex);
  IndexHelper.IndexInfo.Serializer indexSerializer=new IndexHelper.IndexInfo.Serializer(cfs.metadata,BigFormat.latestVersion,header);
  assertTrue(columnIndex.columnsIndex.size() >= 3);
  buffer=new DataOutputBuffer();
  serializer.serialize(withIndex,buffer);
  assertEquals(buffer.getLength(),serializer.serializedSize(withIndex));
  ByteBuffer bb=buffer.buffer();
  DataInputBuffer input=new DataInputBuffer(bb,false);
  serializationCheck(withIndex,indexSerializer,bb,input);
  buffer=new DataOutputBuffer(){
    public boolean hasPosition(){
      return false;
    }
    public long position(){
      throw new UnsupportedOperationException();
    }
  }
;
  serializer.serialize(withIndex,buffer);
  bb=buffer.buffer();
  input=new DataInputBuffer(bb,false);
  serializationCheck(withIndex,indexSerializer,bb,input);
  bb=buffer.buffer();
  input=new DataInputBuffer(bb,false);
  RowIndexEntry.Serializer.skip(input,BigFormat.latestVersion);
  Assert.assertEquals(0,bb.remaining());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowIterationTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRowIterationDeletion() throws Throwable {
  String tableName=createTable("CREATE TABLE %s (a int PRIMARY KEY, b int)");
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE).getColumnFamilyStore(tableName);
  execute("DELETE FROM %s USING TIMESTAMP ? WHERE a = ?",0L,0);
  cfs.forceBlockingFlush();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs).build()).isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.RowTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve(){
  ColumnDefinition defA=cfm.getColumnDefinition(new ColumnIdentifier("a",true));
  ColumnDefinition defB=cfm.getColumnDefinition(new ColumnIdentifier("b",true));
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSeconds);
  builder.newRow(cfm.comparator.make("c1"));
  writeSimpleCellValue(builder,cfm,defA,"a1",0);
  writeSimpleCellValue(builder,cfm,defA,"a2",1);
  writeSimpleCellValue(builder,cfm,defB,"b1",1);
  Row row=builder.build();
  PartitionUpdate update=PartitionUpdate.singleRowUpdate(cfm,dk,row);
  Unfiltered unfiltered=update.unfilteredIterator().next();
  assertTrue(unfiltered.kind() == Unfiltered.Kind.ROW);
  row=(Row)unfiltered;
  assertEquals("a2",defA.cellValueType().getString(row.getCell(defA).value()));
  assertEquals("b1",defB.cellValueType().getString(row.getCell(defB).value()));
  assertEquals(2,row.columns().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.ScrubTest </h4><pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScrubCorruptedCounterRow() throws IOException, WriteTimeoutException {
  int numPartitions=1000;
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COUNTER_CF);
  cfs.clearUnsafe();
  fillCounterCF(cfs,numPartitions);
  assertOrderedAll(cfs,numPartitions);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  overrideWithGarbage(sstable,ByteBufferUtil.bytes("0"),ByteBufferUtil.bytes("1"));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,false,false,true)){
    scrubber.scrub();
    fail("Expected a CorruptSSTableException to be thrown");
  }
 catch (  IOError err) {
  }
  Scrubber.ScrubResult scrubResult;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(Arrays.asList(sstable),OperationType.SCRUB);Scrubber scrubber=new Scrubber(cfs,txn,true,false,true)){
    scrubResult=scrubber.scrubWithResult();
  }
   assertNotNull(scrubResult);
  boolean compression=Boolean.parseBoolean(System.getProperty("cassandra.test.compression","false"));
  if (compression) {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(numPartitions,scrubResult.badRows + scrubResult.goodRows);
    assertTrue(scrubResult.goodRows >= scrubResult.badRows * 2);
  }
 else {
    assertEquals(0,scrubResult.emptyRows);
    assertEquals(1,scrubResult.badRows);
    assertEquals(numPartitions - 1,scrubResult.goodRows);
  }
  assertEquals(1,cfs.getLiveSSTables().size());
  assertOrderedAll(cfs,scrubResult.goodRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SecondaryIndexTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexScan(){
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(WITH_COMPOSITE_INDEX);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering("c").add("birthdate",1L).add("notbirthdate",1L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k2").clustering("c").add("birthdate",2L).add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k3").clustering("c").add("birthdate",1L).add("notbirthdate",2L).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"k4").clustering("c").add("birthdate",3L).add("notbirthdate",2L).build().applyUnsafe();
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k3").columns("birthdate").build());
  assertEquals(2,partitions.size());
  Util.assertCellValue(2L,cfs,Util.row(partitions.get(0),"c"),"birthdate");
  Util.assertCellValue(1L,cfs,Util.row(partitions.get(1),"c"),"birthdate");
  partitions=Util.getAll(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").build());
  assertEquals(3,partitions.size());
  Row first=Util.row(partitions.get(0),"c");
  Util.assertCellValue(2L,cfs,first,"birthdate");
  Util.assertCellValue(2L,cfs,first,"notbirthdate");
  Row second=Util.row(partitions.get(1),"c");
  Util.assertCellValue(1L,cfs,second,"birthdate");
  Util.assertCellValue(2L,cfs,second,"notbirthdate");
  Row third=Util.row(partitions.get(2),"c");
  Util.assertCellValue(3L,cfs,third,"birthdate");
  Util.assertCellValue(2L,cfs,third,"notbirthdate");
  ReadCommand rc=Util.cmd(cfs).fromKeyIncl("k1").toKeyIncl("k3").columns("birthdate").filterOn("birthdate",Operator.EQ,1L).build();
  Index.Searcher searcher=cfs.indexManager.getBestIndexFor(rc).searcherFor(rc);
  try (ReadExecutionController executionController=rc.executionController();UnfilteredPartitionIterator pi=searcher.search(executionController)){
    assertTrue(pi.hasNext());
    pi.next().close();
  }
   partitions=Util.getAll(Util.cmd(cfs).fromKeyIncl("k1").toKeyIncl("k4aaa").filterOn("birthdate",Operator.GT,1L).build());
  int rowCount=0;
  for (  FilteredPartition partition : partitions) {
    for (    Row row : partition) {
      ++rowCount;
      assert ByteBufferUtil.toLong(Util.cell(cfs,row,"birthdate").value()) > 1L;
    }
  }
  assertEquals(2,rowCount);
  Util.assertEmpty(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").filterOn("notbirthdate",Operator.NEQ,2L).build());
  Util.assertEmpty(Util.cmd(cfs).fromKeyExcl("k1").toKeyIncl("k4aaa").filterOn("birthdate",Operator.EQ,1L).filterOn("notbirthdate",Operator.NEQ,2L).build());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testIndexCreate() throws IOException, InterruptedException, ExecutionException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(COMPOSITE_INDEX_TO_BE_ADDED);
  new RowUpdateBuilder(cfs.metadata,0,"k1").clustering("c").add("birthdate",1L).build().applyUnsafe();
  String indexName="birthdate_index";
  ColumnDefinition old=cfs.metadata.getColumnDefinition(ByteBufferUtil.bytes("birthdate"));
  IndexMetadata indexDef=IndexMetadata.fromIndexTargets(cfs.metadata,Collections.singletonList(new IndexTarget(old.name,IndexTarget.Type.VALUES)),indexName,IndexMetadata.Kind.COMPOSITES,Collections.EMPTY_MAP);
  cfs.metadata.indexes(cfs.metadata.getIndexes().with(indexDef));
  Future<?> future=cfs.indexManager.addIndex(indexDef);
  future.get();
  boolean flushed=false;
  ColumnFamilyStore indexCfs=cfs.indexManager.getIndex(indexDef).getBackingTable().orElseThrow(throwAssert("Index not found"));
  flushed=!indexCfs.getLiveSSTables().isEmpty();
  assertTrue(flushed);
  assertIndexedOne(cfs,ByteBufferUtil.bytes("birthdate"),1L);
  assertTrue(cfs.getBuiltIndexes().contains(indexName));
  cfs.indexManager.removeIndex(indexDef.name);
  assertFalse(cfs.getBuiltIndexes().contains(indexName));
  future=cfs.indexManager.addIndex(indexDef);
  future.get();
  assertIndexedOne(cfs,ByteBufferUtil.bytes("birthdate"),1L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SinglePartitionSliceCommandTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void staticColumnsAreReturned() throws IOException {
  DecoratedKey key=cfm.decorateKey(ByteBufferUtil.bytes("k1"));
  QueryProcessor.executeInternal("INSERT INTO ks.tbl (k, s) VALUES ('k1', 's')");
  Assert.assertFalse(QueryProcessor.executeInternal("SELECT s FROM ks.tbl WHERE k='k1'").isEmpty());
  ColumnFilter columnFilter=ColumnFilter.selection(PartitionColumns.of(s));
  ClusteringIndexSliceFilter sliceFilter=new ClusteringIndexSliceFilter(Slices.NONE,false);
  ReadCommand cmd=new SinglePartitionReadCommand(false,MessagingService.VERSION_30,true,cfm,FBUtilities.nowInSeconds(),columnFilter,RowFilter.NONE,DataLimits.NONE,key,sliceFilter);
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator pi=cmd.executeLocally(executionController)){
    checkForS(pi);
  }
   ReadResponse response;
  DataOutputBuffer out;
  DataInputPlus in;
  ReadResponse dst;
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator pi=cmd.executeLocally(executionController)){
    response=ReadResponse.createDataResponse(pi,cmd);
  }
   out=new DataOutputBuffer((int)ReadResponse.serializer.serializedSize(response,MessagingService.VERSION_30));
  ReadResponse.serializer.serialize(response,out,MessagingService.VERSION_30);
  in=new DataInputBuffer(out.buffer(),true);
  dst=ReadResponse.serializer.deserialize(in,MessagingService.VERSION_30);
  try (UnfilteredPartitionIterator pi=dst.makeIterator(cmd)){
    checkForS(pi);
  }
   Schema.instance.getColumnFamilyStoreInstance(cfm.cfId).forceBlockingFlush();
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator pi=cmd.executeLocally(executionController)){
    response=ReadResponse.createDataResponse(pi,cmd);
  }
   out=new DataOutputBuffer((int)ReadResponse.serializer.serializedSize(response,MessagingService.VERSION_30));
  ReadResponse.serializer.serialize(response,out,MessagingService.VERSION_30);
  in=new DataInputBuffer(out.buffer(),true);
  dst=ReadResponse.serializer.deserialize(in,MessagingService.VERSION_30);
  try (UnfilteredPartitionIterator pi=dst.makeIterator(cmd)){
    checkForS(pi);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.SystemKeyspaceTest </h4><pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMigrateEmptyDataDirs() throws IOException {
  File dataDir=Paths.get(DatabaseDescriptor.getAllDataFileLocations()[0]).toFile();
  if (new File(dataDir,"Emptykeyspace1").exists())   FileUtils.deleteDirectory(new File(dataDir,"Emptykeyspace1"));
  assertTrue(new File(dataDir,"Emptykeyspace1").mkdirs());
  assertEquals(0,numLegacyFiles());
  SystemKeyspace.migrateDataDirs();
  assertEquals(0,numLegacyFiles());
  assertTrue(new File(dataDir,"Emptykeyspace1/table1").mkdirs());
  assertEquals(0,numLegacyFiles());
  SystemKeyspace.migrateDataDirs();
  assertEquals(0,numLegacyFiles());
  assertTrue(new File(dataDir,"Emptykeyspace1/wrong_file").createNewFile());
  assertEquals(0,numLegacyFiles());
  SystemKeyspace.migrateDataDirs();
  assertEquals(0,numLegacyFiles());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogDescriptorTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Shouldn't happen in the real world (should only have either compression or enabledTdeOptions), but the header
 * functionality should be correct
 */
@Test public void writeAndReadHeader_WithCompressionAndEncryption() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,compression,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,enabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertEquals(compression,result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertEquals(enabledEncryption,result.getEncryptionContext());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_WithEncryptionHeader_EncryptionEnabledInYaml() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,enabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that even though enabledTdeOptions is disabled in the yaml, we can still read the commit log header as encrypted.
 */
@Test public void writeAndReadHeader_WithEncryptionHeader_EncryptionDisabledInYaml() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,enabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,previouslyEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertTrue(result.getEncryptionContext().isEnabled());
  Assert.assertArrayEquals(iv,result.getEncryptionContext().getIV());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVersions(){
  Assert.assertTrue(CommitLogDescriptor.isValid("CommitLog-1340512736956320000.log"));
  Assert.assertTrue(CommitLogDescriptor.isValid("CommitLog-2-1340512736956320000.log"));
  Assert.assertFalse(CommitLogDescriptor.isValid("CommitLog--1340512736956320000.log"));
  Assert.assertFalse(CommitLogDescriptor.isValid("CommitLog--2-1340512736956320000.log"));
  Assert.assertFalse(CommitLogDescriptor.isValid("CommitLog-2-1340512736956320000-123.log"));
  Assert.assertEquals(1340512736956320000L,CommitLogDescriptor.fromFileName("CommitLog-2-1340512736956320000.log").id);
  Assert.assertEquals(MessagingService.current_version,new CommitLogDescriptor(1340512736956320000L,null,neverEnabledEncryption).getMessagingVersion());
  String newCLName="CommitLog-" + CommitLogDescriptor.current_version + "-1340512736956320000.log";
  Assert.assertEquals(MessagingService.current_version,CommitLogDescriptor.fromFileName(newCLName).getMessagingVersion());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_OnlyCompression() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,compression,neverEnabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,neverEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertEquals(compression,result.compression);
  Assert.assertFalse(result.getEncryptionContext().isEnabled());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void constructParametersString_WithCompressionAndEncryption(){
  String json=CommitLogDescriptor.constructParametersString(compression,enabledEncryption,Collections.emptyMap());
  Assert.assertTrue(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertTrue(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void constructParametersString_NoCompressionOrEncryption(){
  String json=CommitLogDescriptor.constructParametersString(null,null,Collections.emptyMap());
  Assert.assertFalse(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertFalse(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
  json=CommitLogDescriptor.constructParametersString(null,neverEnabledEncryption,Collections.emptyMap());
  Assert.assertFalse(json.contains(CommitLogDescriptor.COMPRESSION_CLASS_KEY));
  Assert.assertFalse(json.contains(EncryptionContext.ENCRYPTION_CIPHER));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void writeAndReadHeader_NoCompressionOrEncryption() throws IOException {
  CommitLogDescriptor descriptor=new CommitLogDescriptor(CommitLogDescriptor.current_version,1,null,neverEnabledEncryption);
  ByteBuffer buffer=ByteBuffer.allocate(16 * 1024);
  CommitLogDescriptor.writeHeader(buffer,descriptor);
  buffer.flip();
  FileSegmentInputStream dataInput=new FileSegmentInputStream(buffer,null,0);
  CommitLogDescriptor result=CommitLogDescriptor.readHeader(dataInput,neverEnabledEncryption);
  Assert.assertNotNull(result);
  Assert.assertNull(result.compression);
  Assert.assertFalse(result.getEncryptionContext().isEnabled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogFailurePolicyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCommitFailurePolicy_stop() throws ConfigurationException {
  CassandraDaemon daemon=new CassandraDaemon();
  daemon.completeSetup();
  StorageService.instance.registerDaemon(daemon);
  StorageService.instance.initServer();
  Assert.assertTrue(Gossiper.instance.isEnabled());
  Config.CommitFailurePolicy oldPolicy=DatabaseDescriptor.getCommitFailurePolicy();
  try {
    DatabaseDescriptor.setCommitFailurePolicy(Config.CommitFailurePolicy.stop);
    CommitLog.handleCommitError("Test stop error",new Throwable());
    Assert.assertFalse(Gossiper.instance.isEnabled());
  }
  finally {
    DatabaseDescriptor.setCommitFailurePolicy(oldPolicy);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCommitFailurePolicy_ignore_beforeStartup(){
  CassandraDaemon daemon=new CassandraDaemon();
  StorageService.instance.registerDaemon(daemon);
  KillerForTests killerForTests=new KillerForTests();
  JVMStabilityInspector.Killer originalKiller=JVMStabilityInspector.replaceKiller(killerForTests);
  Config.CommitFailurePolicy oldPolicy=DatabaseDescriptor.getCommitFailurePolicy();
  try {
    DatabaseDescriptor.setCommitFailurePolicy(Config.CommitFailurePolicy.ignore);
    CommitLog.handleCommitError("Testing ignore policy",new Throwable());
    Assert.assertTrue(killerForTests.wasKilled());
    Assert.assertTrue(killerForTests.wasKilledQuietly());
  }
  finally {
    DatabaseDescriptor.setCommitFailurePolicy(oldPolicy);
    JVMStabilityInspector.replaceKiller(originalKiller);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCommitFailurePolicy_ignore_afterStartup() throws Exception {
  CassandraDaemon daemon=new CassandraDaemon();
  daemon.completeSetup();
  StorageService.instance.registerDaemon(daemon);
  KillerForTests killerForTests=new KillerForTests();
  JVMStabilityInspector.Killer originalKiller=JVMStabilityInspector.replaceKiller(killerForTests);
  Config.CommitFailurePolicy oldPolicy=DatabaseDescriptor.getCommitFailurePolicy();
  try {
    DatabaseDescriptor.setCommitFailurePolicy(Config.CommitFailurePolicy.ignore);
    CommitLog.handleCommitError("Testing ignore policy",new Throwable());
    Assert.assertFalse(killerForTests.wasKilled());
  }
  finally {
    DatabaseDescriptor.setCommitFailurePolicy(oldPolicy);
    JVMStabilityInspector.replaceKiller(originalKiller);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCommitFailurePolicy_die(){
  CassandraDaemon daemon=new CassandraDaemon();
  daemon.completeSetup();
  StorageService.instance.registerDaemon(daemon);
  KillerForTests killerForTests=new KillerForTests();
  JVMStabilityInspector.Killer originalKiller=JVMStabilityInspector.replaceKiller(killerForTests);
  Config.CommitFailurePolicy oldPolicy=DatabaseDescriptor.getCommitFailurePolicy();
  try {
    DatabaseDescriptor.setCommitFailurePolicy(Config.CommitFailurePolicy.die);
    CommitLog.handleCommitError("Testing die policy",new Throwable());
    Assert.assertTrue(killerForTests.wasKilled());
    Assert.assertFalse(killerForTests.wasKilledQuietly());
  }
  finally {
    DatabaseDescriptor.setCommitFailurePolicy(oldPolicy);
    JVMStabilityInspector.replaceKiller(originalKiller);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.commitlog.CommitLogTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTruncateWithoutSnapshotNonDurable() throws IOException {
  CommitLog.instance.resetUnsafe(true);
  boolean originalState=DatabaseDescriptor.getAutoSnapshot();
  try {
    DatabaseDescriptor.setAutoSnapshot(false);
    Keyspace notDurableKs=Keyspace.open(KEYSPACE2);
    Assert.assertFalse(notDurableKs.getMetadata().params.durableWrites);
    ColumnFamilyStore cfs=notDurableKs.getColumnFamilyStore("Standard1");
    new RowUpdateBuilder(cfs.metadata,0,"key1").clustering("bytes").add("val",bytes("abcd")).build().applyUnsafe();
    assertTrue(Util.getOnlyRow(Util.cmd(cfs).columns("val").build()).cells().iterator().next().value().equals(bytes("abcd")));
    cfs.truncateBlocking();
    Util.assertEmpty(Util.cmd(cfs).columns("val").build());
  }
  finally {
    DatabaseDescriptor.setAutoSnapshot(originalState);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.AntiCompactionTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void antiCompactOne() throws Exception {
  ColumnFamilyStore store=prepareColumnFamilyStore();
  Collection<SSTableReader> sstables=getUnrepairedSSTables(store);
  assertEquals(store.getLiveSSTables().size(),sstables.size());
  Range<Token> range=new Range<Token>(new BytesToken("0".getBytes()),new BytesToken("4".getBytes()));
  List<Range<Token>> ranges=Arrays.asList(range);
  int repairedKeys=0;
  int nonRepairedKeys=0;
  try (LifecycleTransaction txn=store.getTracker().tryModify(sstables,OperationType.ANTICOMPACTION);Refs<SSTableReader> refs=Refs.ref(sstables)){
    if (txn == null)     throw new IllegalStateException();
    long repairedAt=1000;
    CompactionManager.instance.performAnticompaction(store,ranges,refs,txn,repairedAt);
  }
   assertEquals(2,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    try (ISSTableScanner scanner=sstable.getScanner((RateLimiter)null)){
      while (scanner.hasNext()) {
        UnfilteredRowIterator row=scanner.next();
        if (sstable.isRepaired()) {
          assertTrue(range.contains(row.partitionKey().getToken()));
          repairedKeys++;
        }
 else {
          assertFalse(range.contains(row.partitionKey().getToken()));
          nonRepairedKeys++;
        }
      }
    }
   }
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertFalse(sstable.isMarkedCompacted());
    assertEquals(1,sstable.selfRef().globalCount());
  }
  assertEquals(0,store.getTracker().getCompacting().size());
  assertEquals(repairedKeys,4);
  assertEquals(nonRepairedKeys,6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsCQLTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerMinorCompactionDTCS() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY) WITH compaction = {'class':'DateTieredCompactionStrategy', 'min_threshold':2};");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertTrue(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerMinorCompactionLCS() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY) WITH compaction = {'class':'LeveledCompactionStrategy', 'sstable_size_in_mb':1};");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertTrue(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerMinorCompactionSTCSNodetoolEnabled() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2, 'enabled':false};");
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  getCurrentColumnFamilyStore().enableAutoCompaction();
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertTrue(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerNoMinorCompactionSTCSNodetoolDisabled() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2, 'enabled':true};");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  getCurrentColumnFamilyStore().disableAutoCompaction();
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertFalse(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerNoMinorCompactionSTCSDisabled() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2, 'enabled':false};");
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertFalse(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetLocalCompactionStrategyDisable() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)");
  Map<String,String> localOptions=new HashMap<>();
  localOptions.put("class","DateTieredCompactionStrategy");
  localOptions.put("enabled","false");
  getCurrentColumnFamilyStore().setCompactionParameters(localOptions);
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  localOptions.clear();
  localOptions.put("class","DateTieredCompactionStrategy");
  getCurrentColumnFamilyStore().setCompactionParameters(localOptions);
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetLocalCompactionStrategy() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)");
  Map<String,String> localOptions=new HashMap<>();
  localOptions.put("class","DateTieredCompactionStrategy");
  getCurrentColumnFamilyStore().setCompactionParameters(localOptions);
  assertTrue(verifyStrategies(getCurrentColumnFamilyStore().getCompactionStrategyManager(),DateTieredCompactionStrategy.class));
  execute("ALTER TABLE %s WITH gc_grace_seconds = 1000");
  assertTrue(verifyStrategies(getCurrentColumnFamilyStore().getCompactionStrategyManager(),DateTieredCompactionStrategy.class));
  execute("ALTER TABLE %s WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':3}");
  assertTrue(verifyStrategies(getCurrentColumnFamilyStore().getCompactionStrategyManager(),SizeTieredCompactionStrategy.class));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetLocalCompactionStrategyEnable() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)");
  Map<String,String> localOptions=new HashMap<>();
  localOptions.put("class","DateTieredCompactionStrategy");
  getCurrentColumnFamilyStore().disableAutoCompaction();
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  getCurrentColumnFamilyStore().setCompactionParameters(localOptions);
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerMinorCompactionSTCS() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2};");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertTrue(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerNoMinorCompactionSTCSAlterTable() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2, 'enabled':true};");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("ALTER TABLE %s WITH compaction = {'class': 'SizeTieredCompactionStrategy', 'enabled': false}");
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertFalse(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testTriggerMinorCompactionSTCSAlterTable() throws Throwable {
  createTable("CREATE TABLE %s (id text PRIMARY KEY)  WITH compaction = {'class':'SizeTieredCompactionStrategy', 'min_threshold':2, 'enabled':false};");
  assertFalse(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("ALTER TABLE %s WITH compaction = {'class': 'SizeTieredCompactionStrategy', 'min_threshold': 2, 'enabled': true}");
  assertTrue(getCurrentColumnFamilyStore().getCompactionStrategyManager().isEnabled());
  execute("insert into %s (id) values ('1')");
  flush();
  execute("insert into %s (id) values ('1')");
  flush();
  Thread.sleep(SLEEP_TIME);
  assertTrue(minorWasTriggered(KEYSPACE,currentTable()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsPurgeTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionPurgeTombstonedRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  String keyspaceName=KEYSPACE1;
  String cfName="Standard1";
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key3";
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,i,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  Mutation rm=new Mutation(KEYSPACE1,dk(key));
  rm.add(PartitionUpdate.fullPartitionDelete(cfs.metadata,dk(key),4,FBUtilities.nowInSeconds()));
  rm.applyUnsafe();
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  assertFalse(partition.partitionLevelDeletion().isLive());
  cfs.forceBlockingFlush();
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).isEmpty());
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,i,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build());
  assertEquals(10,partition.rowCount());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify that we don't drop tombstones during a minor compaction that might still be relevant
 */
@Test public void testMinTimestampPurge(){
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE2);
  String cfName="Standard1";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key3="key3";
  new RowUpdateBuilder(cfs.metadata,8,key3).clustering("c1").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,8,key3).clustering("c2").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  RowUpdateBuilder.deleteRow(cfs.metadata,10,key3,"c1").applyUnsafe();
  cfs.forceBlockingFlush();
  Collection<SSTableReader> sstablesIncomplete=cfs.getLiveSSTables();
  RowUpdateBuilder.deleteRow(cfs.metadata,9,key3,"c2").applyUnsafe();
  cfs.forceBlockingFlush();
  cfs.getCompactionStrategyManager().getUserDefinedTask(sstablesIncomplete,Integer.MAX_VALUE).execute(null);
  ImmutableBTreePartition partition=Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key3).build());
  assertEquals(2,partition.rowCount());
  for (  Row row : partition)   assertFalse(row.hasLiveData(FBUtilities.nowInSeconds()));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCompactionPurgeCachedRow() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  String keyspaceName=KEYSPACE_CACHED;
  String cfName=CF_CACHED;
  Keyspace keyspace=Keyspace.open(keyspaceName);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key3";
  for (int i=0; i < 10; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  Mutation rm=new Mutation(KEYSPACE_CACHED,dk(key));
  rm.add(PartitionUpdate.fullPartitionDelete(cfs.metadata,dk(key),1,FBUtilities.nowInSeconds()));
  rm.applyUnsafe();
  new RowUpdateBuilder(cfs.metadata,0,"key4").clustering("c").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  assertFalse(Util.getOnlyPartitionUnfiltered(Util.cmd(cfs,key).build()).isEmpty());
  cfs.forceBlockingFlush();
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  Util.assertEmpty(Util.cmd(cfs,key).build());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactionPurgeOneFile() throws ExecutionException, InterruptedException {
  CompactionManager.instance.disableAutoCompaction();
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  String cfName="Standard2";
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfName);
  String key="key1";
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder builder=new RowUpdateBuilder(cfs.metadata,0,key);
    builder.clustering(String.valueOf(i)).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  }
  for (int i=0; i < 5; i++) {
    RowUpdateBuilder.deleteRow(cfs.metadata,1,key,String.valueOf(i)).applyUnsafe();
  }
  cfs.forceBlockingFlush();
  assertEquals(String.valueOf(cfs.getLiveSSTables()),1,cfs.getLiveSSTables().size());
  Util.compactAll(cfs,Integer.MAX_VALUE).get();
  assertTrue(cfs.getLiveSSTables().isEmpty());
  Util.assertEmpty(Util.cmd(cfs,key).build());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.CompactionsTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("making ranges based on the keys, not on the tokens") public void testNeedsCleanup(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("CF_STANDARD1");
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=1; i < 10; i++) {
    insertRowWithKey(i);
    insertRowWithKey(i + 100);
    insertRowWithKey(i + 200);
  }
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,209)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,210)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,200,209)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,109,200,210)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,210)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(1,9,100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,101,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,201,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,8,100,109,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,108,200,209)));
  assertTrue(CompactionManager.needsCleanup(sstable,makeRanges(0,9,100,109,200,208)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,0,0,9,50,51,100,109,150,199,200,209,300,301)));
  assertFalse(CompactionManager.needsCleanup(sstable,makeRanges(0,0,0,9,50,51,100,103,150,199,200,209,300,301)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.DateTieredCompactionStrategyTest </h4><pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"30");
  options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"1825");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"0");
    validateOptions(options);
    fail(String.format("%s == 0 should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.BASE_TIME_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.BASE_TIME_KEY,"1");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"-1337");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_SSTABLE_AGE_KEY,"0");
  }
  try {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"-1");
    validateOptions(options);
    fail(String.format("Negative %s should be rejected",DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY));
  }
 catch (  ConfigurationException e) {
    options.put(DateTieredCompactionStrategyOptions.MAX_WINDOW_SIZE_KEY,"0");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepBucket(){
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF_STANDARD1);
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=3;
  for (int r=0; r < numSSTables; r++) {
    DecoratedKey key=Util.dk(String.valueOf(r));
    new RowUpdateBuilder(cfs.metadata,r,key.getKey()).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstrs=new ArrayList<>(cfs.getLiveSSTables());
  List<SSTableReader> newBucket=newestBucket(Collections.singletonList(sstrs.subList(0,2)),4,32,9,10,Long.MAX_VALUE,new SizeTieredCompactionStrategyOptions());
  assertTrue("incoming bucket should not be accepted when it has below the min threshold SSTables",newBucket.isEmpty());
  newBucket=newestBucket(Collections.singletonList(sstrs.subList(0,2)),4,32,10,10,Long.MAX_VALUE,new SizeTieredCompactionStrategyOptions());
  assertFalse("non-incoming bucket should be accepted when it has at least 2 SSTables",newBucket.isEmpty());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(0).getMinTimestamp(),sstrs.get(0).getMaxTimestamp());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(1).getMinTimestamp(),sstrs.get(1).getMaxTimestamp());
  assertEquals("an sstable with a single value should have equal min/max timestamps",sstrs.get(2).getMinTimestamp(),sstrs.get(2).getMaxTimestamp());
  cfs.truncateBlocking();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.LeveledCompactionStrategyTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testValidationMultipleSSTablePerLevel() throws Exception {
  byte[] b=new byte[100 * 1024];
  new Random().nextBytes(b);
  ByteBuffer value=ByteBuffer.wrap(b);
  int rows=40;
  int columns=20;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  waitForLeveling(cfs);
  CompactionStrategyManager strategyManager=cfs.getCompactionStrategyManager();
  assertTrue(strategyManager.getSSTableCountPerLevel()[1] > 0);
  assertTrue(strategyManager.getSSTableCountPerLevel()[2] > 0);
  Range<Token> range=new Range<>(Util.token(""),Util.token(""));
  int gcBefore=keyspace.getColumnFamilyStore(CF_STANDARDDLEVELED).gcBefore(FBUtilities.nowInSeconds());
  UUID parentRepSession=UUID.randomUUID();
  ActiveRepairService.instance.registerParentRepairSession(parentRepSession,Arrays.asList(cfs),Arrays.asList(range),false,System.currentTimeMillis(),true);
  RepairJobDesc desc=new RepairJobDesc(parentRepSession,UUID.randomUUID(),KEYSPACE1,CF_STANDARDDLEVELED,Arrays.asList(range));
  Validator validator=new Validator(desc,FBUtilities.getBroadcastAddress(),gcBefore);
  CompactionManager.instance.submitValidation(cfs,validator).get();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewRepairedSSTable() throws Exception {
  byte[] b=new byte[100 * 1024];
  new Random().nextBytes(b);
  ByteBuffer value=ByteBuffer.wrap(b);
  int rows=40;
  int columns=20;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  waitForLeveling(cfs);
  cfs.disableAutoCompaction();
  while (CompactionManager.instance.isCompacting(Arrays.asList(cfs)))   Thread.sleep(100);
  CompactionStrategyManager manager=cfs.getCompactionStrategyManager();
  List<List<AbstractCompactionStrategy>> strategies=manager.getStrategies();
  LeveledCompactionStrategy repaired=(LeveledCompactionStrategy)strategies.get(0).get(0);
  LeveledCompactionStrategy unrepaired=(LeveledCompactionStrategy)strategies.get(1).get(0);
  assertEquals(0,repaired.manifest.getLevelCount());
  assertEquals(2,unrepaired.manifest.getLevelCount());
  assertTrue(manager.getSSTableCountPerLevel()[1] > 0);
  assertTrue(manager.getSSTableCountPerLevel()[2] > 0);
  for (  SSTableReader sstable : cfs.getLiveSSTables())   assertFalse(sstable.isRepaired());
  int sstableCount=0;
  for (  List<SSTableReader> level : unrepaired.manifest.generations)   sstableCount+=level.size();
  assertEquals(sstableCount,cfs.getLiveSSTables().size());
  SSTableReader sstable1=unrepaired.manifest.generations[2].get(0);
  SSTableReader sstable2=unrepaired.manifest.generations[1].get(0);
  sstable1.descriptor.getMetadataSerializer().mutateRepairedAt(sstable1.descriptor,System.currentTimeMillis());
  sstable1.reloadSSTableMetadata();
  assertTrue(sstable1.isRepaired());
  manager.handleNotification(new SSTableRepairStatusChanged(Arrays.asList(sstable1)),this);
  int repairedSSTableCount=0;
  for (  List<SSTableReader> level : repaired.manifest.generations)   repairedSSTableCount+=level.size();
  assertEquals(1,repairedSSTableCount);
  assertTrue(repaired.manifest.generations[2].contains(sstable1));
  assertFalse(unrepaired.manifest.generations[2].contains(sstable1));
  unrepaired.removeSSTable(sstable2);
  manager.handleNotification(new SSTableAddedNotification(singleton(sstable2)),this);
  assertTrue(unrepaired.manifest.getLevel(1).contains(sstable2));
  assertFalse(repaired.manifest.getLevel(1).contains(sstable2));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMutateLevel() throws Exception {
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100 * 1024]);
  int rows=40;
  int columns=20;
  for (int r=0; r < rows; r++) {
    UpdateBuilder update=UpdateBuilder.create(cfs.metadata,String.valueOf(r));
    for (int c=0; c < columns; c++)     update.newRow("column" + c).add("val",value);
    update.applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  LeveledCompactionStrategy strategy=(LeveledCompactionStrategy)cfs.getCompactionStrategyManager().getStrategies().get(1).get(0);
  cfs.forceMajorCompaction();
  for (  SSTableReader s : cfs.getLiveSSTables()) {
    assertTrue(s.getSSTableLevel() != 6 && s.getSSTableLevel() > 0);
    strategy.manifest.remove(s);
    s.descriptor.getMetadataSerializer().mutateLevel(s.descriptor,6);
    s.reloadSSTableMetadata();
    strategy.manifest.add(s);
  }
  for (  SSTableReader s : cfs.getLiveSSTables())   assertEquals(6,s.getSSTableLevel());
  int[] levels=strategy.manifest.getAllLevelSize();
  assertEquals(cfs.getLiveSSTables().size(),levels[6]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.SizeTieredCompactionStrategyTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepBucket() throws Exception {
  String ksname=KEYSPACE1;
  String cfname="Standard1";
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=3;
  for (int r=0; r < numSSTables; r++) {
    String key=String.valueOf(r);
    new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  cfs.forceBlockingFlush();
  List<SSTableReader> sstrs=new ArrayList<>(cfs.getLiveSSTables());
  Pair<List<SSTableReader>,Double> bucket;
  List<SSTableReader> interestingBucket=mostInterestingBucket(Collections.singletonList(sstrs.subList(0,2)),4,32);
  assertTrue("nothing should be returned when all buckets are below the min threshold",interestingBucket.isEmpty());
  sstrs.get(0).overrideReadMeter(new RestorableMeter(100.0,100.0));
  sstrs.get(1).overrideReadMeter(new RestorableMeter(200.0,200.0));
  sstrs.get(2).overrideReadMeter(new RestorableMeter(300.0,300.0));
  long estimatedKeys=sstrs.get(0).estimatedKeys();
  bucket=trimToThresholdWithHotness(sstrs,2);
  assertEquals("one bucket should have been dropped",2,bucket.left.size());
  double expectedBucketHotness=(200.0 + 300.0) / estimatedKeys;
  assertEquals(String.format("bucket hotness (%f) should be close to %f",bucket.right,expectedBucketHotness),expectedBucketHotness,bucket.right,1.0);
}

</code></pre>

<br>
<pre class="type-7 type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsValidation() throws ConfigurationException {
  Map<String,String> options=new HashMap<>();
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  options.put(SizeTieredCompactionStrategyOptions.BUCKET_HIGH_KEY,"1.5");
  options.put(SizeTieredCompactionStrategyOptions.MIN_SSTABLE_SIZE_KEY,"10000");
  Map<String,String> unvalidated=validateOptions(options);
  assertTrue(unvalidated.isEmpty());
  try {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"1000.0");
    validateOptions(options);
    fail("bucket_low greater than bucket_high should be rejected");
  }
 catch (  ConfigurationException e) {
    options.put(SizeTieredCompactionStrategyOptions.BUCKET_LOW_KEY,"0.5");
  }
  options.put("bad_option","1.0");
  unvalidated=validateOptions(options);
  assertTrue(unvalidated.containsKey("bad_option"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.compaction.TTLExpiryTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoExpire() throws InterruptedException, IOException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  long timestamp=System.currentTimeMillis();
  String key="ttl";
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col",ByteBufferUtil.EMPTY_BYTE_BUFFER).add("col7",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col2",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  new RowUpdateBuilder(cfs.metadata,timestamp,1,key).add("col3",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  String noTTLKey="nottl";
  new RowUpdateBuilder(cfs.metadata,timestamp,noTTLKey).add("col311",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  Thread.sleep(2000);
  assertEquals(4,cfs.getLiveSSTables().size());
  cfs.enableAutoCompaction(true);
  assertEquals(1,cfs.getLiveSSTables().size());
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  ISSTableScanner scanner=sstable.getScanner(ColumnFilter.all(sstable.metadata),DataRange.allData(cfs.getPartitioner()),false);
  assertTrue(scanner.hasNext());
  while (scanner.hasNext()) {
    UnfilteredRowIterator iter=scanner.next();
    assertEquals(Util.dk(noTTLKey),iter.partitionKey());
  }
  scanner.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckForExpiredSSTableBlockers() throws InterruptedException {
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore("Standard1");
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  cfs.metadata.gcGraceSeconds(0);
  new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),"test").noRowMarker().add("col1",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  cfs.forceBlockingFlush();
  SSTableReader blockingSSTable=cfs.getSSTables(SSTableSet.LIVE).iterator().next();
  for (int i=0; i < 10; i++) {
    new RowUpdateBuilder(cfs.metadata,System.currentTimeMillis(),"test").noRowMarker().delete("col1").build().applyUnsafe();
    cfs.forceBlockingFlush();
  }
  Multimap<SSTableReader,SSTableReader> blockers=SSTableExpiredBlockers.checkForExpiredSSTableBlockers(cfs.getSSTables(SSTableSet.LIVE),(int)(System.currentTimeMillis() / 1000) + 100);
  assertEquals(1,blockers.keySet().size());
  assertTrue(blockers.keySet().contains(blockingSSTable));
  assertEquals(10,blockers.get(blockingSSTable).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.context.CounterContextTest </h4><pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMerge(){
  ContextState left=ContextState.allocate(0,1,3);
  left.writeRemote(CounterId.fromInt(1),1L,1L);
  left.writeRemote(CounterId.fromInt(2),2L,2L);
  left.writeRemote(CounterId.fromInt(4),6L,3L);
  left.writeLocal(CounterId.getLocalId(),7L,3L);
  ContextState right=ContextState.allocate(0,1,2);
  right.writeRemote(CounterId.fromInt(4),4L,4L);
  right.writeRemote(CounterId.fromInt(5),5L,5L);
  right.writeLocal(CounterId.getLocalId(),2L,9L);
  ByteBuffer merged=cc.merge(left.context,right.context);
  int hd=4;
  assertEquals(hd + 5 * stepLength,merged.remaining());
  assertTrue(Util.equalsCounterId(CounterId.getLocalId(),merged,hd + 4 * stepLength));
  assertEquals(9L,merged.getLong(merged.position() + hd + 4 * stepLength + idLength));
  assertEquals(12L,merged.getLong(merged.position() + hd + 4 * stepLength + idLength + clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(4),merged,hd + 2 * stepLength));
  assertEquals(6L,merged.getLong(merged.position() + hd + 2 * stepLength + idLength));
  assertEquals(3L,merged.getLong(merged.position() + hd + 2 * stepLength + idLength + clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(5),merged,hd + 3 * stepLength));
  assertEquals(5L,merged.getLong(merged.position() + hd + 3 * stepLength + idLength));
  assertEquals(5L,merged.getLong(merged.position() + hd + 3 * stepLength + idLength + clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(2),merged,hd + stepLength));
  assertEquals(2L,merged.getLong(merged.position() + hd + stepLength+ idLength));
  assertEquals(2L,merged.getLong(merged.position() + hd + stepLength+ idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),merged,hd));
  assertEquals(1L,merged.getLong(merged.position() + hd + idLength));
  assertEquals(1L,merged.getLong(merged.position() + hd + idLength+ clockLength));
  left=ContextState.allocate(3,0,0);
  left.writeGlobal(CounterId.fromInt(1),1L,1L);
  left.writeGlobal(CounterId.fromInt(2),2L,2L);
  left.writeGlobal(CounterId.fromInt(3),3L,3L);
  right=ContextState.allocate(3,0,0);
  right.writeGlobal(CounterId.fromInt(3),6L,6L);
  right.writeGlobal(CounterId.fromInt(4),4L,4L);
  right.writeGlobal(CounterId.fromInt(5),5L,5L);
  merged=cc.merge(left.context,right.context);
  assertEquals(headerSizeLength + 5 * headerEltLength + 5 * stepLength,merged.remaining());
  assertEquals(18L,cc.total(merged));
  assertEquals(5,merged.getShort(merged.position()));
  int headerLength=headerSizeLength + 5 * headerEltLength;
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),merged,headerLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + idLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(2),merged,headerLength + stepLength));
  assertEquals(2L,merged.getLong(merged.position() + headerLength + stepLength+ idLength));
  assertEquals(2L,merged.getLong(merged.position() + headerLength + stepLength+ idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(3),merged,headerLength + 2 * stepLength));
  assertEquals(6L,merged.getLong(merged.position() + headerLength + 2 * stepLength + idLength));
  assertEquals(6L,merged.getLong(merged.position() + headerLength + 2 * stepLength + idLength + clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(4),merged,headerLength + 3 * stepLength));
  assertEquals(4L,merged.getLong(merged.position() + headerLength + 3 * stepLength + idLength));
  assertEquals(4L,merged.getLong(merged.position() + headerLength + 3 * stepLength + idLength + clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(5),merged,headerLength + 4 * stepLength));
  assertEquals(5L,merged.getLong(merged.position() + headerLength + 4 * stepLength + idLength));
  assertEquals(5L,merged.getLong(merged.position() + headerLength + 4 * stepLength + idLength + clockLength));
  left=ContextState.allocate(1,0,0);
  left.writeGlobal(CounterId.fromInt(1),10L,20L);
  right=ContextState.allocate(1,0,0);
  right.writeGlobal(CounterId.fromInt(1),10L,30L);
  merged=cc.merge(left.context,right.context);
  headerLength=headerSizeLength + headerEltLength;
  assertEquals(headerLength + stepLength,merged.remaining());
  assertEquals(30L,cc.total(merged));
  assertEquals(1,merged.getShort(merged.position()));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),merged,headerLength));
  assertEquals(10L,merged.getLong(merged.position() + headerLength + idLength));
  assertEquals(30L,merged.getLong(merged.position() + headerLength + idLength+ clockLength));
  left=ContextState.allocate(2,0,0);
  left.writeGlobal(CounterId.fromInt(1),1L,1L);
  left.writeGlobal(CounterId.fromInt(2),1L,1L);
  right=ContextState.allocate(0,1,1);
  right.writeLocal(CounterId.fromInt(1),100L,100L);
  right.writeRemote(CounterId.fromInt(2),100L,100L);
  merged=cc.merge(left.context,right.context);
  headerLength=headerSizeLength + 2 * headerEltLength;
  assertEquals(headerLength + 2 * stepLength,merged.remaining());
  assertEquals(2L,cc.total(merged));
  assertEquals(2,merged.getShort(merged.position()));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),merged,headerLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + idLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(2),merged,headerLength + stepLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + stepLength+ idLength));
  assertEquals(1L,merged.getLong(merged.position() + headerLength + stepLength+ idLength+ clockLength));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearLocal(){
  ContextState state;
  ByteBuffer marked;
  ByteBuffer cleared;
  state=ContextState.allocate(0,0,1);
  state.writeRemote(CounterId.fromInt(1),1L,1L);
  assertFalse(cc.shouldClearLocal(state.context));
  marked=cc.markLocalToBeCleared(state.context);
  assertEquals(0,marked.getShort(marked.position()));
  assertSame(state.context,marked);
  cleared=cc.clearAllLocal(marked);
  assertSame(cleared,marked);
  state=ContextState.allocate(0,1,0);
  state.writeLocal(CounterId.fromInt(1),1L,1L);
  assertFalse(cc.shouldClearLocal(state.context));
  marked=cc.markLocalToBeCleared(state.context);
  assertTrue(cc.shouldClearLocal(marked));
  assertEquals(-1,marked.getShort(marked.position()));
  assertNotSame(state.context,marked);
  cleared=cc.clearAllLocal(marked);
  assertFalse(cc.shouldClearLocal(cleared));
  assertEquals(0,cleared.getShort(cleared.position()));
  state=ContextState.allocate(2,1,0);
  state.writeLocal(CounterId.fromInt(1),1L,1L);
  state.writeGlobal(CounterId.fromInt(2),2L,2L);
  state.writeGlobal(CounterId.fromInt(3),3L,3L);
  assertFalse(cc.shouldClearLocal(state.context));
  marked=cc.markLocalToBeCleared(state.context);
  assertTrue(cc.shouldClearLocal(marked));
  assertEquals(-3,marked.getShort(marked.position()));
  assertEquals(0,marked.getShort(marked.position() + headerSizeLength));
  assertEquals(Short.MIN_VALUE + 1,marked.getShort(marked.position() + headerSizeLength + headerEltLength));
  assertEquals(Short.MIN_VALUE + 2,marked.getShort(marked.position() + headerSizeLength + 2 * headerEltLength));
  int headerLength=headerSizeLength + 3 * headerEltLength;
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),marked,headerLength));
  assertEquals(1L,marked.getLong(marked.position() + headerLength + idLength));
  assertEquals(1L,marked.getLong(marked.position() + headerLength + idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(2),marked,headerLength + stepLength));
  assertEquals(2L,marked.getLong(marked.position() + headerLength + stepLength+ idLength));
  assertEquals(2L,marked.getLong(marked.position() + headerLength + stepLength+ idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(3),marked,headerLength + 2 * stepLength));
  assertEquals(3L,marked.getLong(marked.position() + headerLength + 2 * stepLength + idLength));
  assertEquals(3L,marked.getLong(marked.position() + headerLength + 2 * stepLength + idLength + clockLength));
  cleared=cc.clearAllLocal(marked);
  assertFalse(cc.shouldClearLocal(cleared));
  assertEquals(2,cleared.getShort(cleared.position()));
  assertEquals(Short.MIN_VALUE + 1,cleared.getShort(marked.position() + headerEltLength));
  assertEquals(Short.MIN_VALUE + 2,cleared.getShort(marked.position() + headerSizeLength + headerEltLength));
  headerLength=headerSizeLength + 2 * headerEltLength;
  assertTrue(Util.equalsCounterId(CounterId.fromInt(1),cleared,headerLength));
  assertEquals(1L,cleared.getLong(cleared.position() + headerLength + idLength));
  assertEquals(1L,cleared.getLong(cleared.position() + headerLength + idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(2),cleared,headerLength + stepLength));
  assertEquals(2L,cleared.getLong(cleared.position() + headerLength + stepLength+ idLength));
  assertEquals(2L,cleared.getLong(cleared.position() + headerLength + stepLength+ idLength+ clockLength));
  assertTrue(Util.equalsCounterId(CounterId.fromInt(3),cleared,headerLength + 2 * stepLength));
  assertEquals(3L,cleared.getLong(cleared.position() + headerLength + 2 * stepLength + idLength));
  assertEquals(3L,cleared.getLong(cleared.position() + headerLength + 2 * stepLength + idLength + clockLength));
  state=ContextState.allocate(1,0,0);
  state.writeGlobal(CounterId.fromInt(1),1L,1L);
  assertFalse(cc.shouldClearLocal(state.context));
  marked=cc.markLocalToBeCleared(state.context);
  assertEquals(1,marked.getShort(marked.position()));
  assertSame(state.context,marked);
  cleared=cc.clearAllLocal(marked);
  assertSame(cleared,marked);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.filter.SliceTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIntersectsSingleSlice(){
  List<AbstractType<?>> types=new ArrayList<>();
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  ClusteringComparator cc=new ClusteringComparator(types);
  ClusteringPrefix.Kind sk=ClusteringPrefix.Kind.INCL_START_BOUND;
  ClusteringPrefix.Kind ek=ClusteringPrefix.Kind.INCL_END_BOUND;
  Slice slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,1),columnNames(3,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,1,1),columnNames(3,1,1)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek,4,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0,0),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,4,0),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertFalse(slice.intersects(cc,columnNames(0,0,0),columnNames(1,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertFalse(slice.intersects(cc,columnNames(0,0,0),columnNames(1,1,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(0,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,2,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,0,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(1,1,1)));
  slice=Slice.make(makeBound(sk,1,1,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1,2));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,2,0,0),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,2,0,0),makeBound(ek,3));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,1,1));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,2,0,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,0,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,3,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,3,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,2,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,2,0));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2,0),makeBound(ek,1,2));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,2),makeBound(ek,1,2));
  assertFalse(slice.intersects(cc,columnNames(1,0,0),columnNames(2,1,0)));
  slice=Slice.make(makeBound(sk,1,1,2),makeBound(ek,1,1,3));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(2,2,1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames()));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(2)));
  slice=Slice.make(makeBound(sk),makeBound(ek,2));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,2),makeBound(ek,3));
  assertFalse(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,0,0,0));
  assertFalse(slice.intersects(cc,columnNames(2,0,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,0,0),makeBound(ek,0,0,0));
  assertFalse(slice.intersects(cc,columnNames(1,1,0),columnNames(3,0,0)));
  slice=Slice.make(makeBound(sk,1,1,1),makeBound(ek,1,1,0));
  assertTrue(slice.intersects(cc,columnNames(1,0,0),columnNames(2,2,2)));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDifferentMinMaxLengths(){
  List<AbstractType<?>> types=new ArrayList<>();
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  types.add(Int32Type.instance);
  ClusteringComparator cc=new ClusteringComparator(types);
  ClusteringPrefix.Kind sk=ClusteringPrefix.Kind.INCL_START_BOUND;
  ClusteringPrefix.Kind ek=ClusteringPrefix.Kind.INCL_END_BOUND;
  Slice slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(1),columnNames(1,2)));
  slice=Slice.make(makeBound(sk),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1),makeBound(ek,1));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,1,2,3));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,1,2,3),makeBound(ek,2));
  assertTrue(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,2),makeBound(ek,3,4,5));
  assertFalse(slice.intersects(cc,columnNames(),columnNames(1)));
  slice=Slice.make(makeBound(sk,0),makeBound(ek,0,1,2));
  assertFalse(slice.intersects(cc,columnNames(1),columnNames(1,2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.HelpersTest </h4><pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkObsolete(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  LogTransaction txnLogs=new LogTransaction(OperationType.UNKNOWN);
  Iterable<SSTableReader> readers=Lists.newArrayList(MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  List<LogTransaction.Obsoletion> obsoletions=new ArrayList<>();
  Assert.assertNull(Helpers.prepareForObsoletion(readers,txnLogs,obsoletions,null));
  assertNotNull(obsoletions);
  assertEquals(2,obsoletions.size());
  Throwable accumulate=Helpers.markObsolete(obsoletions,null);
  Assert.assertNull(accumulate);
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isMarkedCompacted());
  accumulate=Helpers.markObsolete(obsoletions,null);
  assertNotNull(accumulate);
  txnLogs.finish();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testReplace(){
  boolean failure;
  failure=false;
  try {
    Helpers.replace(abc,a,c);
  }
 catch (  AssertionError e) {
    failure=true;
  }
  Assert.assertTrue(failure);
  failure=false;
  try {
    Helpers.replace(a,abc,c);
  }
 catch (  AssertionError e) {
    failure=true;
  }
  Assert.assertTrue(failure);
  failure=false;
  try {
    Map<Integer,Integer> notIdentity=ImmutableMap.of(1,new Integer(1),2,2,3,3);
    Helpers.replace(notIdentity,a,b);
  }
 catch (  AssertionError e) {
    failure=true;
  }
  Assert.assertTrue(failure);
  check(Helpers.replace(a,a,b),b);
}

</code></pre>

<br>
<pre class="type-7 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetupDeletionNotification(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Iterable<SSTableReader> readers=Lists.newArrayList(MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  Throwable accumulate=Helpers.setReplaced(readers,null);
  Assert.assertNull(accumulate);
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isReplaced());
  accumulate=Helpers.setReplaced(readers,null);
  assertNotNull(accumulate);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.LifecycleTransactionTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdates(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  SSTableReader[] readers=readersArray(0,3,cfs);
  SSTableReader[] readers2=readersArray(0,4,cfs);
  SSTableReader[] readers3=readersArray(0,4,cfs);
  tracker.addInitialSSTables(copyOf(readers));
  LifecycleTransaction txn=tracker.tryModify(copyOf(readers),OperationType.UNKNOWN);
  txn.update(readers2[0],true);
  txn.obsolete(readers[1]);
  Assert.assertTrue(txn.isObsolete(readers[1]));
  Assert.assertFalse(txn.isObsolete(readers[0]));
  testBadUpdate(txn,readers2[0],true);
  testBadUpdate(txn,readers2[1],true);
  testBadUpdate(txn,readers3[0],true);
  testBadUpdate(txn,readers2[2],false);
  testBadUpdate(txn,readers2[3],true);
  testBadObsolete(txn,readers[1]);
  testBadObsolete(txn,readers2[0]);
  txn.update(readers2[3],false);
  Assert.assertEquals(3,tracker.getView().compacting.size());
  txn.checkpoint();
  Assert.assertTrue(txn.isObsolete(readers[1]));
  Assert.assertFalse(txn.isObsolete(readers[0]));
  Assert.assertEquals(4,tracker.getView().compacting.size());
  Assert.assertEquals(3,tracker.getView().sstables.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(of(readers2[0],readers[2],readers2[3]),idIn(tracker.getView().sstablesMap)));
  Assert.assertTrue(all(txn.current(),idIn(tracker.getView().sstablesMap)));
  testBadObsolete(txn,readers[1]);
  testBadObsolete(txn,readers2[2]);
  testBadObsolete(txn,readers2[3]);
  testBadUpdate(txn,readers3[1],true);
  testBadUpdate(txn,readers2[0],true);
  txn.update(readers3[0],true);
  txn.checkpoint();
  Assert.assertEquals(4,tracker.getView().compacting.size());
  Assert.assertEquals(3,tracker.getView().sstables.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(of(readers3[0],readers[2],readers2[3]),idIn(tracker.getView().sstablesMap)));
  Assert.assertTrue(all(txn.current(),idIn(tracker.getView().sstablesMap)));
  testBadObsolete(txn,readers2[0]);
  txn.obsoleteOriginals();
  txn.checkpoint();
  Assert.assertEquals(1,tracker.getView().sstables.size());
  txn.obsoleteOriginals();
  txn.checkpoint();
  Assert.assertEquals(1,tracker.getView().sstables.size());
  Assert.assertEquals(4,tracker.getView().compacting.size());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  List<SSTableReader> readers=readers(0,4,cfs);
  tracker.addInitialSSTables(readers);
  LifecycleTransaction txn=tracker.tryModify(readers,OperationType.UNKNOWN);
  txn.cancel(readers.get(3));
  LifecycleTransaction txn2=txn.split(readers.subList(0,1));
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertTrue(all(readers.subList(1,3),in(txn.originals())));
  Assert.assertEquals(1,txn2.originals().size());
  Assert.assertTrue(all(readers.subList(0,1),in(txn2.originals())));
  txn.update(readers(1,2,cfs).get(0),true);
  boolean failed=false;
  try {
    txn.split(readers.subList(2,3));
  }
 catch (  Throwable t) {
    failed=true;
  }
  Assert.assertTrue(failed);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCancellation(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(null,false);
  List<SSTableReader> readers=readers(0,3,cfs);
  tracker.addInitialSSTables(readers);
  LifecycleTransaction txn=tracker.tryModify(readers,OperationType.UNKNOWN);
  SSTableReader cancel=readers.get(0);
  SSTableReader update=readers(1,2,cfs).get(0);
  SSTableReader fresh=readers(3,4,cfs).get(0);
  SSTableReader notPresent=readers(4,5,cfs).get(0);
  txn.cancel(cancel);
  txn.update(update,true);
  txn.update(fresh,false);
  testBadCancel(txn,cancel);
  testBadCancel(txn,update);
  testBadCancel(txn,fresh);
  testBadCancel(txn,notPresent);
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertEquals(2,tracker.getView().compacting.size());
  Assert.assertTrue(all(readers.subList(1,3),idIn(tracker.getView().compacting)));
  txn.checkpoint();
  testBadCancel(txn,cancel);
  testBadCancel(txn,update);
  testBadCancel(txn,fresh);
  testBadCancel(txn,notPresent);
  Assert.assertEquals(2,txn.originals().size());
  Assert.assertEquals(3,tracker.getView().compacting.size());
  Assert.assertEquals(3,size(txn.current()));
  Assert.assertTrue(all(concat(readers.subList(1,3),of(fresh)),idIn(tracker.getView().compacting)));
  txn.cancel(readers.get(2));
  Assert.assertEquals(1,txn.originals().size());
  Assert.assertEquals(2,tracker.getView().compacting.size());
  Assert.assertEquals(2,size(txn.current()));
  Assert.assertTrue(all(of(readers.get(1),fresh),idIn(tracker.getView().compacting)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.TrackerTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemtableReplacement(){
  boolean backups=DatabaseDescriptor.isIncrementalBackupsEnabled();
  DatabaseDescriptor.setIncrementalBackupsEnabled(false);
  ColumnFamilyStore cfs=MockSchema.newCFS();
  MockListener listener=new MockListener(false);
  Tracker tracker=cfs.getTracker();
  tracker.subscribe(listener);
  Memtable prev1=tracker.switchMemtable(true);
  OpOrder.Group write1=cfs.keyspace.writeOrder.getCurrent();
  OpOrder.Barrier barrier1=cfs.keyspace.writeOrder.newBarrier();
  prev1.setDiscarding(barrier1,new AtomicReference<ReplayPosition>());
  barrier1.issue();
  Memtable prev2=tracker.switchMemtable(false);
  OpOrder.Group write2=cfs.keyspace.writeOrder.getCurrent();
  OpOrder.Barrier barrier2=cfs.keyspace.writeOrder.newBarrier();
  prev2.setDiscarding(barrier2,new AtomicReference<ReplayPosition>());
  barrier2.issue();
  Memtable cur=tracker.getView().getCurrentMemtable();
  OpOrder.Group writecur=cfs.keyspace.writeOrder.getCurrent();
  Assert.assertEquals(prev1,tracker.getMemtableFor(write1,ReplayPosition.NONE));
  Assert.assertEquals(prev2,tracker.getMemtableFor(write2,ReplayPosition.NONE));
  Assert.assertEquals(cur,tracker.getMemtableFor(writecur,ReplayPosition.NONE));
  Assert.assertEquals(1,listener.received.size());
  Assert.assertTrue(listener.received.get(0) instanceof MemtableRenewedNotification);
  listener.received.clear();
  tracker.markFlushing(prev2);
  Assert.assertEquals(1,tracker.getView().flushingMemtables.size());
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev2));
  tracker.markFlushing(prev1);
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev1));
  Assert.assertEquals(2,tracker.getView().flushingMemtables.size());
  tracker.replaceFlushed(prev1,null);
  Assert.assertEquals(1,tracker.getView().flushingMemtables.size());
  Assert.assertTrue(tracker.getView().flushingMemtables.contains(prev2));
  SSTableReader reader=MockSchema.sstable(0,10,false,cfs);
  tracker.replaceFlushed(prev2,singleton(reader));
  Assert.assertEquals(1,tracker.getView().sstables.size());
  Assert.assertEquals(1,listener.received.size());
  Assert.assertEquals(singleton(reader),((SSTableAddedNotification)listener.received.get(0)).added);
  listener.received.clear();
  Assert.assertTrue(reader.isKeyCacheSetup());
  Assert.assertEquals(10,cfs.metric.liveDiskSpaceUsed.getCount());
  cfs=MockSchema.newCFS();
  tracker=cfs.getTracker();
  listener=new MockListener(false);
  tracker.subscribe(listener);
  prev1=tracker.switchMemtable(false);
  tracker.markFlushing(prev1);
  reader=MockSchema.sstable(0,10,true,cfs);
  cfs.invalidate(false);
  tracker.replaceFlushed(prev1,singleton(reader));
  Assert.assertEquals(0,tracker.getView().sstables.size());
  Assert.assertEquals(0,tracker.getView().flushingMemtables.size());
  Assert.assertEquals(0,cfs.metric.liveDiskSpaceUsed.getCount());
  Assert.assertEquals(3,listener.received.size());
  Assert.assertEquals(singleton(reader),((SSTableAddedNotification)listener.received.get(0)).added);
  Assert.assertTrue(listener.received.get(1) instanceof SSTableDeletingNotification);
  Assert.assertEquals(1,((SSTableListChangedNotification)listener.received.get(2)).removed.size());
  DatabaseDescriptor.setIncrementalBackupsEnabled(backups);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddSSTables(){
  boolean backups=DatabaseDescriptor.isIncrementalBackupsEnabled();
  DatabaseDescriptor.setIncrementalBackupsEnabled(false);
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(cfs,false);
  MockListener listener=new MockListener(false);
  tracker.subscribe(listener);
  List<SSTableReader> readers=ImmutableList.of(MockSchema.sstable(0,17,cfs),MockSchema.sstable(1,121,cfs),MockSchema.sstable(2,9,cfs));
  tracker.addSSTables(copyOf(readers));
  Assert.assertEquals(3,tracker.view.get().sstables.size());
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isKeyCacheSetup());
  Assert.assertEquals(17 + 121 + 9,cfs.metric.liveDiskSpaceUsed.getCount());
  Assert.assertEquals(1,listener.senders.size());
  Assert.assertEquals(tracker,listener.senders.get(0));
  Assert.assertTrue(listener.received.get(0) instanceof SSTableAddedNotification);
  DatabaseDescriptor.setIncrementalBackupsEnabled(backups);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTryModify(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(cfs,false);
  List<SSTableReader> readers=ImmutableList.of(MockSchema.sstable(0,true,cfs),MockSchema.sstable(1,cfs),MockSchema.sstable(2,cfs));
  tracker.addInitialSSTables(copyOf(readers));
  Assert.assertNull(tracker.tryModify(ImmutableList.of(MockSchema.sstable(0,cfs)),OperationType.COMPACTION));
  try (LifecycleTransaction txn=tracker.tryModify(readers.get(0),OperationType.COMPACTION)){
    Assert.assertNotNull(txn);
    Assert.assertNull(tracker.tryModify(readers.get(0),OperationType.COMPACTION));
    Assert.assertEquals(1,txn.originals().size());
    Assert.assertTrue(txn.originals().contains(readers.get(0)));
  }
   try (LifecycleTransaction txn=tracker.tryModify(Collections.<SSTableReader>emptyList(),OperationType.COMPACTION)){
    Assert.assertNotNull(txn);
    Assert.assertEquals(0,txn.originals().size());
  }
   readers.get(0).selfRef().release();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddInitialSSTables(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  Tracker tracker=new Tracker(cfs,false);
  List<SSTableReader> readers=ImmutableList.of(MockSchema.sstable(0,17,cfs),MockSchema.sstable(1,121,cfs),MockSchema.sstable(2,9,cfs));
  tracker.addInitialSSTables(copyOf(readers));
  Assert.assertEquals(3,tracker.view.get().sstables.size());
  for (  SSTableReader reader : readers)   Assert.assertTrue(reader.isKeyCacheSetup());
  Assert.assertEquals(17 + 121 + 9,cfs.metric.liveDiskSpaceUsed.getCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.lifecycle.ViewTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushing(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(1,0,cfs);
  View cur=initialView;
  Memtable memtable1=initialView.getCurrentMemtable();
  Memtable memtable2=MockSchema.memtable(cfs);
  cur=View.switchMemtable(memtable2).apply(cur);
  Assert.assertEquals(2,cur.liveMemtables.size());
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable2,cur.getCurrentMemtable());
  Memtable memtable3=MockSchema.memtable(cfs);
  cur=View.switchMemtable(memtable3).apply(cur);
  Assert.assertEquals(3,cur.liveMemtables.size());
  Assert.assertEquals(0,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable2,cur.liveMemtables.get(1));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  testFailure(View.replaceFlushed(memtable2,null),cur);
  cur=View.markFlushing(memtable2).apply(cur);
  Assert.assertTrue(cur.flushingMemtables.contains(memtable2));
  Assert.assertEquals(2,cur.liveMemtables.size());
  Assert.assertEquals(1,cur.flushingMemtables.size());
  Assert.assertEquals(memtable2,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable1,cur.liveMemtables.get(0));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  cur=View.markFlushing(memtable1).apply(cur);
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(2,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable2,cur.flushingMemtables.get(1));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  cur=View.replaceFlushed(memtable2,null).apply(cur);
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(1,cur.flushingMemtables.size());
  Assert.assertEquals(memtable1,cur.flushingMemtables.get(0));
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  SSTableReader sstable=MockSchema.sstable(1,cfs);
  cur=View.replaceFlushed(memtable1,singleton(sstable)).apply(cur);
  Assert.assertEquals(0,cur.flushingMemtables.size());
  Assert.assertEquals(1,cur.liveMemtables.size());
  Assert.assertEquals(memtable3,cur.getCurrentMemtable());
  Assert.assertEquals(1,cur.sstables.size());
  Assert.assertEquals(sstable,cur.sstablesMap.get(sstable));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-14 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompaction(){
  ColumnFamilyStore cfs=MockSchema.newCFS();
  View initialView=fakeView(0,5,cfs);
  View cur=initialView;
  List<SSTableReader> readers=ImmutableList.copyOf(initialView.sstables);
  Assert.assertTrue(View.permitCompacting(readers).apply(cur));
  Assert.assertTrue(View.permitCompacting(ImmutableList.copyOf(concat(readers,readers))).apply(cur));
  testFailure(View.updateCompacting(emptySet(),concat(readers.subList(0,1),readers.subList(0,1))),cur);
  cur=View.updateCompacting(emptySet(),readers.subList(0,2)).apply(cur);
  Assert.assertTrue(View.permitCompacting(readers.subList(2,5)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(0,2)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(0,1)).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(1,2)).apply(cur));
  Assert.assertTrue(readers.subList(2,5).containsAll(copyOf(cur.getUncompacting(readers))));
  Assert.assertEquals(3,copyOf(cur.getUncompacting(readers)).size());
  Assert.assertTrue(ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING)).containsAll(readers.subList(2,5)));
  Assert.assertEquals(3,ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING)).size());
  testFailure(View.updateCompacting(emptySet(),readers.subList(0,1)),cur);
  testFailure(View.updateCompacting(emptySet(),readers.subList(1,2)),cur);
  testFailure(View.updateCompacting(copyOf(readers.subList(0,1)),readers.subList(1,2)),cur);
  SSTableReader r0=MockSchema.sstable(0,cfs), r1=MockSchema.sstable(1,cfs), r2=MockSchema.sstable(2,cfs);
  testFailure(View.updateCompacting(emptySet(),of(r2)),cur);
  cur=View.updateLiveSet(copyOf(readers.subList(1,3)),of(r1,r2)).apply(cur);
  Assert.assertSame(readers.get(0),cur.sstablesMap.get(r0));
  Assert.assertSame(r1,cur.sstablesMap.get(r1));
  Assert.assertSame(r2,cur.sstablesMap.get(r2));
  testFailure(View.updateCompacting(emptySet(),readers.subList(2,3)),cur);
  Assert.assertSame(readers.get(1),Iterables.getFirst(Iterables.filter(cur.compacting,Predicates.equalTo(r1)),null));
  cur=View.updateCompacting(copyOf(readers.subList(0,1)),emptySet()).apply(cur);
  Assert.assertTrue(View.permitCompacting(concat(readers.subList(0,1),of(r2),readers.subList(3,5))).apply(cur));
  Assert.assertFalse(View.permitCompacting(readers.subList(1,2)).apply(cur));
  testFailure(View.updateCompacting(emptySet(),readers.subList(1,2)),cur);
  testFailure(View.updateCompacting(copyOf(readers.subList(0,2)),emptySet()),cur);
  Assert.assertTrue(copyOf(concat(readers.subList(0,1),readers.subList(2,5))).containsAll(copyOf(cur.getUncompacting(readers))));
  Assert.assertEquals(4,copyOf(cur.getUncompacting(readers)).size());
  Set<SSTableReader> nonCompacting=ImmutableSet.copyOf(cur.sstables(SSTableSet.NONCOMPACTING));
  Assert.assertTrue(nonCompacting.containsAll(readers.subList(2,5)));
  Assert.assertTrue(nonCompacting.containsAll(readers.subList(0,1)));
  Assert.assertEquals(4,nonCompacting.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.DecimalTypeTest </h4><pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test3Sort(){
  ByteBuffer zeroBB=DecimalType.instance.decompose(zero);
  ByteBuffer minusBB=DecimalType.instance.decompose(minus);
  ByteBuffer lowBB=DecimalType.instance.decompose(low);
  ByteBuffer highBB=DecimalType.instance.decompose(high);
  ByteBuffer[] array={highBB,minusBB,lowBB,lowBB,zeroBB,minusBB};
  Arrays.sort(array,DecimalType.instance);
  for (int i=1; i < array.length; i++) {
    BigDecimal i0=DecimalType.instance.compose(array[i - 1]);
    BigDecimal i1=DecimalType.instance.compose(array[i]);
    assertTrue("#" + i,i0.compareTo(i1) <= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.marshal.IntegerTypeTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSortingSpecialExtendedVersion(){
  Random rng=new Random(-9078270684023566599L);
  ByteBuffer[] data=new ByteBuffer[10000];
  for (int i=0; i < data.length; i++) {
    data[i]=ByteBuffer.allocate(rng.nextInt(32) + 1);
    rng.nextBytes(data[i].array());
  }
  Arrays.sort(data,comparator);
  for (int i=1; i < data.length; i++) {
    BigInteger i0=new BigInteger(data[i - 1].array());
    BigInteger i1=new BigInteger(data[i].array());
    assertTrue("#" + i,i0.compareTo(i1) <= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.monitoring.MonitoringTaskTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRealScheduling() throws InterruptedException {
  MonitoringTask.instance=MonitoringTask.make(10,-1);
  try {
    Monitorable operation=new TestMonitor("Test report",new ConstructionTime(System.currentTimeMillis()),timeout);
    waitForOperationsToComplete(operation);
    assertTrue(operation.isAborted());
    assertFalse(operation.isCompleted());
    Thread.sleep(ApproximateTime.precision() + 500);
    assertEquals(0,MonitoringTask.instance.getFailedOperations().size());
  }
  finally {
    MonitoringTask.instance=MonitoringTask.make(REPORT_INTERVAL_MS,MAX_TIMEDOUT_OPERATIONS);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReport() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test report",new ConstructionTime(System.currentTimeMillis()),timeout);
  waitForOperationsToComplete(operation);
  assertTrue(operation.isAborted());
  assertFalse(operation.isCompleted());
  MonitoringTask.instance.logFailedOperations(ApproximateTime.currentTimeMillis());
  assertEquals(0,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortIdemPotent() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test abort",new ConstructionTime(System.currentTimeMillis()),timeout);
  waitForOperationsToComplete(operation);
  assertTrue(operation.abort());
  assertTrue(operation.isAborted());
  assertFalse(operation.isCompleted());
  assertEquals(1,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortCrossNode() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test for cross node",new ConstructionTime(System.currentTimeMillis(),true),timeout);
  waitForOperationsToComplete(operation);
  assertTrue(operation.isAborted());
  assertFalse(operation.isCompleted());
  assertEquals(1,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbort() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test abort",new ConstructionTime(System.currentTimeMillis()),timeout);
  waitForOperationsToComplete(operation);
  assertTrue(operation.isAborted());
  assertFalse(operation.isCompleted());
  assertEquals(1,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplete() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test complete",new ConstructionTime(System.currentTimeMillis()),timeout);
  operation.complete();
  waitForOperationsToComplete(operation);
  assertFalse(operation.isAborted());
  assertTrue(operation.isCompleted());
  assertEquals(0,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompleteIdemPotent() throws InterruptedException {
  Monitorable operation=new TestMonitor("Test complete",new ConstructionTime(System.currentTimeMillis()),timeout);
  operation.complete();
  waitForOperationsToComplete(operation);
  assertTrue(operation.complete());
  assertFalse(operation.isAborted());
  assertTrue(operation.isCompleted());
  assertEquals(0,MonitoringTask.instance.getFailedOperations().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.rows.RowAndDeletionMergeIteratorTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithAtMostRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNonShadowingTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,-1L,0));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWithPartitionLevelTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds - 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime),greaterThan(2,timestamp,delTime));
  int partitionDelTime=nowInSeconds + 1;
  long partitionTimestamp=toMillis(partitionDelTime);
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,new DeletionTime(partitionTimestamp,partitionDelTime),false);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithExcludingEndIncludingStartMarker(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(lessThan(2,timestamp,delTime),atLeast(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_END_INCL_START_BOUNDARY,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithAtMostAndGreaterThanRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(0,timestamp,delTime),greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_BOUND,0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithNoRangeTombstones(){
  Iterator<Row> rowIterator=createRowIterator();
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,Collections.emptyIterator(),false);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),3);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),4);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithIncludingEndExcludingStartMarker(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(atMost(2,timestamp,delTime),greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.BOTTOM);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_END_EXCL_START_BOUNDARY,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithOnlyRangeTombstones(){
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(rt(1,false,3,false,timestamp,delTime),atLeast(4,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(Collections.emptyIterator(),rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,1);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_END_BOUND,3);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.INCL_START_BOUND,4);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithGreaterThanRangeTombstone(){
  Iterator<Row> rowIterator=createRowIterator();
  int delTime=nowInSeconds + 1;
  long timestamp=toMillis(delTime);
  Iterator<RangeTombstone> rangeTombstoneIterator=createRangeTombstoneIterator(greaterThan(2,timestamp,delTime));
  UnfilteredRowIterator iterator=createMergeIterator(rowIterator,rangeTombstoneIterator,false);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),0);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),1);
  assertTrue(iterator.hasNext());
  assertRow(iterator.next(),2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),ClusteringPrefix.Kind.EXCL_START_BOUND,2);
  assertTrue(iterator.hasNext());
  assertRtMarker(iterator.next(),Bound.TOP);
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.db.view.ViewUtilsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBaseTokenDoesNotBelongToLocalReplicaShouldReturnEmpty() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> replicationMap=new HashMap<>();
  replicationMap.put(ReplicationParams.CLASS,NetworkTopologyStrategy.class.getName());
  replicationMap.put("DC1","1");
  replicationMap.put("DC2","1");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,replicationMap));
  Schema.instance.setKeyspaceMetadata(meta);
  Optional<InetAddress> naturalEndpoint=ViewUtils.getViewNaturalEndpoint("Keyspace1",new StringToken("AB"),new StringToken("BB"));
  Assert.assertFalse(naturalEndpoint.isPresent());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLocalHostPreference() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> replicationMap=new HashMap<>();
  replicationMap.put(ReplicationParams.CLASS,NetworkTopologyStrategy.class.getName());
  replicationMap.put("DC1","2");
  replicationMap.put("DC2","2");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,replicationMap));
  Schema.instance.setKeyspaceMetadata(meta);
  Optional<InetAddress> naturalEndpoint=ViewUtils.getViewNaturalEndpoint("Keyspace1",new StringToken("CA"),new StringToken("BB"));
  Assert.assertTrue(naturalEndpoint.isPresent());
  Assert.assertEquals(InetAddress.getByName("127.0.0.1"),naturalEndpoint.get());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetIndexNaturalEndpoint() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> replicationMap=new HashMap<>();
  replicationMap.put(ReplicationParams.CLASS,NetworkTopologyStrategy.class.getName());
  replicationMap.put("DC1","1");
  replicationMap.put("DC2","1");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,replicationMap));
  Schema.instance.setKeyspaceMetadata(meta);
  Optional<InetAddress> naturalEndpoint=ViewUtils.getViewNaturalEndpoint("Keyspace1",new StringToken("CA"),new StringToken("BB"));
  Assert.assertTrue(naturalEndpoint.isPresent());
  Assert.assertEquals(InetAddress.getByName("127.0.0.2"),naturalEndpoint.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.BoundsTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNonOverlappingBounds(){
  List<Bounds<Token>> bounds=new LinkedList<>();
  bounds.add(bounds(19,20));
  bounds.add(bounds(0,1));
  bounds.add(bounds(4,10));
  bounds.add(bounds(15,19));
  bounds.add(bounds(0,5));
  bounds.add(bounds(21,22));
  bounds.add(bounds(1,8));
  Set<Bounds<Token>> nonOverlappingBounds=Bounds.getNonOverlappingBounds(bounds);
  assertEquals(3,nonOverlappingBounds.size());
  assertTrue(nonOverlappingBounds.contains(bounds(0,10)));
  assertTrue(nonOverlappingBounds.contains(bounds(15,20)));
  assertTrue(nonOverlappingBounds.contains(bounds(21,22)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.RangeTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBoundariesORCC(){
  List<Range<Token>> ranges=asList(r(Long.MIN_VALUE,Long.MIN_VALUE + 1),r(Long.MAX_VALUE - 1,Long.MAX_VALUE));
  Range.OrderedRangeContainmentChecker checker=new Range.OrderedRangeContainmentChecker(ranges);
  assertFalse(checker.contains(t(Long.MIN_VALUE)));
  assertTrue(checker.contains(t(Long.MIN_VALUE + 1)));
  assertFalse(checker.contains(t(0)));
  assertFalse(checker.contains(t(Long.MAX_VALUE - 1)));
  assertTrue(checker.contains(t(Long.MAX_VALUE)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.dht.StreamStateStoreTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUpdateAndQueryAvailableRanges(){
  IPartitioner p=new Murmur3Partitioner();
  Token.TokenFactory factory=p.getTokenFactory();
  Range<Token> range=new Range<>(factory.fromString("0"),factory.fromString("100"));
  InetAddress local=FBUtilities.getBroadcastAddress();
  StreamSession session=new StreamSession(local,local,new DefaultConnectionFactory(),0,true,false);
  session.addStreamRequest("keyspace1",Collections.singleton(range),Collections.singleton("cf"),0);
  StreamStateStore store=new StreamStateStore();
  store.handleStreamEvent(new StreamEvent.SessionCompleteEvent(session));
  assertFalse(store.isDataAvailable("keyspace1",factory.fromString("50")));
  session.state(StreamSession.State.COMPLETE);
  store.handleStreamEvent(new StreamEvent.SessionCompleteEvent(session));
  assertTrue(store.isDataAvailable("keyspace1",factory.fromString("50")));
  assertFalse(store.isDataAvailable("keyspace1",factory.fromString("0")));
  assertFalse(store.isDataAvailable("keyspace1",factory.fromString("101")));
  assertFalse(store.isDataAvailable("keyspace2",factory.fromString("50")));
  Range<Token> range2=new Range<>(factory.fromString("100"),factory.fromString("200"));
  session=new StreamSession(local,local,new DefaultConnectionFactory(),0,true,false);
  session.addStreamRequest("keyspace1",Collections.singleton(range2),Collections.singleton("cf"),0);
  session.state(StreamSession.State.COMPLETE);
  store.handleStreamEvent(new StreamEvent.SessionCompleteEvent(session));
  assertTrue(store.isDataAvailable("keyspace1",factory.fromString("101")));
  assertTrue(store.isDataAvailable("keyspace1",factory.fromString("50")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.hints.ChecksummedDataInputTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadMethods() throws IOException {
  byte[] b=new byte[RandomAccessReader.DEFAULT_BUFFER_SIZE * 2];
  for (int i=0; i < b.length; i++)   b[i]=(byte)i;
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.write(b);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    out.writeDouble(3.3);
    out.writeFloat(2.2f);
    out.writeInt(42);
    out.writeLong(Long.MAX_VALUE);
    out.writeShort(Short.MIN_VALUE);
    out.writeUTF("utf");
    out.writeVInt(67L);
    out.writeUnsignedVInt(88L);
    out.writeBytes("abcdefghi");
    buffer=out.buffer();
  }
   CRC32 crc=new CRC32();
  FBUtilities.updateChecksum(crc,buffer);
  File file=File.createTempFile("testReadMethods","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.writeInt((int)crc.getValue());
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining() + 4,file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining() + 4);
    assertEquals(127,reader.read());
    byte[] bytes=new byte[b.length];
    reader.readFully(bytes);
    assertTrue(Arrays.equals(bytes,b));
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertEquals(3.3,reader.readDouble());
    assertEquals(2.2f,reader.readFloat());
    assertEquals(42,reader.readInt());
    assertEquals(Long.MAX_VALUE,reader.readLong());
    assertEquals(Short.MIN_VALUE,reader.readShort());
    assertEquals("utf",reader.readUTF());
    assertEquals(67L,reader.readVInt());
    assertEquals(88L,reader.readUnsignedVInt());
    assertEquals("abcdefghi",new String(ByteBufferUtil.read(reader,9).array(),StandardCharsets.UTF_8));
    assertTrue(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
    reader.checkLimit(0);
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedCrc() throws IOException {
  CRC32 crc=new CRC32();
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    buffer=out.buffer();
    FBUtilities.updateChecksum(crc,buffer);
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    buffer=out.buffer();
  }
   File file=File.createTempFile("testFailedCrc","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining(),file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining());
    assertEquals(127,reader.read());
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertFalse(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResetCrc() throws IOException {
  CRC32 crc=new CRC32();
  ByteBuffer buffer;
  try (DataOutputBuffer out=new DataOutputBuffer()){
    out.write(127);
    out.writeBoolean(false);
    out.writeByte(10);
    out.writeChar('t');
    buffer=out.buffer();
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    int bufferPos=out.getLength();
    out.writeDouble(3.3);
    out.writeFloat(2.2f);
    out.writeInt(42);
    buffer=out.buffer();
    buffer.position(bufferPos);
    crc.reset();
    FBUtilities.updateChecksum(crc,buffer);
    out.writeInt((int)crc.getValue());
    buffer=out.buffer();
  }
   File file=File.createTempFile("testResetCrc","1");
  file.deleteOnExit();
  try (SequentialWriter writer=SequentialWriter.open(file)){
    writer.write(buffer);
    writer.finish();
  }
   assertTrue(file.exists());
  assertEquals(buffer.remaining(),file.length());
  try (ChecksummedDataInput reader=ChecksummedDataInput.open(file)){
    reader.limit(buffer.remaining());
    assertEquals(127,reader.read());
    assertEquals(false,reader.readBoolean());
    assertEquals(10,reader.readByte());
    assertEquals('t',reader.readChar());
    assertTrue(reader.checkCrc());
    reader.resetCrc();
    assertEquals(3.3,reader.readDouble());
    assertEquals(2.2f,reader.readFloat());
    assertEquals(42,reader.readInt());
    assertTrue(reader.checkCrc());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.CustomIndexTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void indexControlsIfIncludedInBuildOnNewSSTables() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, PRIMARY KEY (a))");
  String toInclude="include";
  String toExclude="exclude";
  createIndex(String.format("CREATE CUSTOM INDEX %s ON %%s(b) USING '%s'",toInclude,IndexIncludedInBuild.class.getName()));
  createIndex(String.format("CREATE CUSTOM INDEX %s ON %%s(b) USING '%s'",toExclude,IndexExcludedFromBuild.class.getName()));
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",0,0);
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",1,1);
  execute("INSERT INTO %s (a, b) VALUES (?, ?)",2,2);
  flush();
  SecondaryIndexManager indexManager=getCurrentColumnFamilyStore().indexManager;
  IndexIncludedInBuild included=(IndexIncludedInBuild)indexManager.getIndexByName(toInclude);
  included.reset();
  assertTrue(included.rowsInserted.isEmpty());
  IndexExcludedFromBuild excluded=(IndexExcludedFromBuild)indexManager.getIndexByName(toExclude);
  excluded.reset();
  assertTrue(excluded.rowsInserted.isEmpty());
  indexManager.buildAllIndexesBlocking(getCurrentColumnFamilyStore().getLiveSSTables());
  assertEquals(3,included.rowsInserted.size());
  assertTrue(excluded.rowsInserted.isEmpty());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notifyIndexersOfPartitionAndRowRemovalDuringCleanup() throws Throwable {
  createTable("CREATE TABLE %s (k int, c int, v int, PRIMARY KEY (k,c))");
  createIndex(String.format("CREATE CUSTOM INDEX cleanup_index ON %%s() USING '%s'",StubIndex.class.getName()));
  ColumnFamilyStore cfs=getCurrentColumnFamilyStore();
  StubIndex index=(StubIndex)cfs.indexManager.getIndexByName("cleanup_index");
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,0,0);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,1,1);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",0,2,2);
  execute("INSERT INTO %s (k, c, v) VALUES (?, ?, ?)",3,3,3);
  assertEquals(4,index.rowsInserted.size());
  assertEquals(0,index.partitionDeletions.size());
  ReadCommand cmd=Util.cmd(cfs,0).build();
  try (ReadExecutionController executionController=cmd.executionController();UnfilteredPartitionIterator iterator=cmd.executeLocally(executionController)){
    assertTrue(iterator.hasNext());
    cfs.indexManager.deletePartition(iterator.next(),FBUtilities.nowInSeconds());
  }
   assertEquals(1,index.partitionDeletions.size());
  assertEquals(3,index.rowsDeleted.size());
  for (int i=0; i < 3; i++)   assertEquals(index.rowsDeleted.get(i).clustering(),index.rowsInserted.get(i).clustering());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void indexReceivesWriteTimeDeletionsCorrectly() throws Throwable {
  createTable("CREATE TABLE %s (a int, b int, c int, d int, PRIMARY KEY (a, b, c))");
  String indexName="test_index";
  createIndex(String.format("CREATE CUSTOM INDEX %s ON %%s(d) USING '%s'",indexName,StubIndex.class.getName()));
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,0,0);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,1,1);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,0,2,2);
  execute("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?)",0,1,3,3);
  SecondaryIndexManager indexManager=getCurrentColumnFamilyStore().indexManager;
  StubIndex index=(StubIndex)indexManager.getIndexByName(indexName);
  assertEquals(4,index.rowsInserted.size());
  assertTrue(index.partitionDeletions.isEmpty());
  assertTrue(index.rangeTombstones.isEmpty());
  execute("DELETE FROM %s WHERE a=0 AND b=0");
  assertTrue(index.partitionDeletions.isEmpty());
  assertEquals(1,index.rangeTombstones.size());
  execute("DELETE FROM %s WHERE a=0");
  assertEquals(1,index.partitionDeletions.size());
  assertEquals(1,index.rangeTombstones.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.SASIIndexTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPrefixSSTableLookup(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer name=UTF8Type.instance.decompose("first_name_prefix");
  Mutation rm;
  rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,name,UTF8Type.instance.decompose("Pavel"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,name,UTF8Type.instance.decompose("Jordan"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,name,UTF8Type.instance.decompose("Mikhail"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,name,UTF8Type.instance.decompose("Michael"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,name,UTF8Type.instance.decompose("Johnny"),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  rm=new Mutation(KS_NAME,decoratedKey("key6"));
  update(rm,name,UTF8Type.instance.decompose("Jason"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key7"));
  update(rm,name,UTF8Type.instance.decompose("Vijay"),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("J")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key5","key6"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("j")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key5","key6"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("m")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3","key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("v")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key7"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("p")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(name,Operator.EQ,UTF8Type.instance.decompose("j")),buildExpression(name,Operator.NEQ,UTF8Type.instance.decompose("joh")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key6"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnicodeSupport(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,comment,UTF8Type.instance.decompose("ⓈⓅⒺⒸⒾⒶⓁ ⒞⒣⒜⒭⒮ and normal ones"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,comment,UTF8Type.instance.decompose("龍馭鬱"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,comment,UTF8Type.instance.decompose("インディアナ"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,comment,UTF8Type.instance.decompose("レストラン"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,comment,UTF8Type.instance.decompose("ベンジャミン ウエスト"),System.currentTimeMillis());
  rm.apply();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ⓈⓅⒺⒸⒾ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("normal")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("レストラ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("インディ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  store.forceBlockingFlush();
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ⓈⓅⒺⒸⒾ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("normal")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("レストラ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("インディ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミ")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key5"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnicodeSuffixMode(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer comment=UTF8Type.instance.decompose("comment_suffix_split");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,comment,UTF8Type.instance.decompose("龍馭鬱"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,comment,UTF8Type.instance.decompose("インディアナ"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,comment,UTF8Type.instance.decompose("レストラン"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,comment,UTF8Type.instance.decompose("ベンジャミン ウエスト"),System.currentTimeMillis());
  rm.apply();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("トラン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ディア")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3","key4"},rows.toArray(new String[rows.size()])));
  store.forceBlockingFlush();
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("龍馭鬱")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ベンジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("トラン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ディア")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ジャミン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(comment,Operator.EQ,UTF8Type.instance.decompose("ン")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3","key4"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSameKeyInMemtableAndSSTables(){
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  final ByteBuffer age=UTF8Type.instance.decompose("age");
  Map<String,Pair<String,Integer>> data1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",26));
      put("key3",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",27));
    }
  }
;
  ColumnFamilyStore store=loadData(data1,true);
  Map<String,Pair<String,Integer>> data2=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",28));
    }
  }
;
  loadData(data2,true);
  Map<String,Pair<String,Integer>> data3=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",15));
      put("key4",Pair.create("Jason",29));
    }
  }
;
  loadData(data3,false);
  Set<String> rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1","key2","key3","key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(15)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(29)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key4"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,100,buildExpression(firstName,Operator.EQ,UTF8Type.instance.decompose("a")),buildExpression(age,Operator.EQ,Int32Type.instance.decompose(27)));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key2","key3"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-15 type-4 type-5 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchTimeouts() throws Exception {
  final ByteBuffer firstName=UTF8Type.instance.decompose("first_name");
  Map<String,Pair<String,Integer>> data1=new HashMap<String,Pair<String,Integer>>(){
{
      put("key1",Pair.create("Pavel",14));
      put("key2",Pair.create("Pavel",26));
      put("key3",Pair.create("Pavel",27));
      put("key4",Pair.create("Jason",27));
    }
  }
;
  ColumnFamilyStore store=loadData(data1,true);
  RowFilter filter=RowFilter.create();
  filter.add(store.metadata.getColumnDefinition(firstName),Operator.EQ,AsciiType.instance.fromString("a"));
  ReadCommand command=new PartitionRangeReadCommand(store.metadata,FBUtilities.nowInSeconds(),ColumnFilter.all(store.metadata),filter,DataLimits.NONE,DataRange.allData(store.metadata.partitioner),Optional.empty());
  try {
    new QueryPlan(store,command,0).execute(ReadExecutionController.empty());
    Assert.fail();
  }
 catch (  TimeQuotaExceededException e) {
  }
catch (  Exception e) {
    Assert.fail();
    e.printStackTrace();
  }
  Set<String> rows=getKeys(new QueryPlan(store,command,DatabaseDescriptor.getRangeRpcTimeout()).execute(ReadExecutionController.empty()));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1","key2","key3","key4"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testChinesePrefixSearch(){
  ColumnFamilyStore store=Keyspace.open(KS_NAME).getColumnFamilyStore(CF_NAME);
  final ByteBuffer fullName=UTF8Type.instance.decompose("/output/full-name/");
  Mutation rm=new Mutation(KS_NAME,decoratedKey("key1"));
  update(rm,fullName,UTF8Type.instance.decompose("美加 八田"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key2"));
  update(rm,fullName,UTF8Type.instance.decompose("仁美 瀧澤"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key3"));
  update(rm,fullName,UTF8Type.instance.decompose("晃宏 高須"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key4"));
  update(rm,fullName,UTF8Type.instance.decompose("弘孝 大竹"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key5"));
  update(rm,fullName,UTF8Type.instance.decompose("満枝 榎本"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key6"));
  update(rm,fullName,UTF8Type.instance.decompose("飛鳥 上原"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key7"));
  update(rm,fullName,UTF8Type.instance.decompose("大輝 鎌田"),System.currentTimeMillis());
  rm.apply();
  rm=new Mutation(KS_NAME,decoratedKey("key8"));
  update(rm,fullName,UTF8Type.instance.decompose("利久 寺地"),System.currentTimeMillis());
  rm.apply();
  store.forceBlockingFlush();
  Set<String> rows;
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("美加 八田")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("美加")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key1"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("晃宏 高須")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key3"},rows.toArray(new String[rows.size()])));
  rows=getIndexed(store,10,buildExpression(fullName,Operator.EQ,UTF8Type.instance.decompose("大輝")));
  Assert.assertTrue(rows.toString(),Arrays.equals(new String[]{"key7"},rows.toArray(new String[rows.size()])));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.analyzer.NonTokenizingAnalyzerTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void ensureIncompatibleInputSkipped() throws Exception {
  NonTokenizingAnalyzer analyzer=new NonTokenizingAnalyzer();
  NonTokenizingOptions options=NonTokenizingOptions.getDefaultOptions();
  analyzer.init(options,Int32Type.instance);
  ByteBuffer toAnalyze=ByteBufferUtil.bytes(1);
  analyzer.reset(toAnalyze);
  Assert.assertTrue(!analyzer.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void caseInsensitiveAnalizer() throws Exception {
  NonTokenizingAnalyzer analyzer=new NonTokenizingAnalyzer();
  NonTokenizingOptions options=NonTokenizingOptions.getDefaultOptions();
  options.setCaseSensitive(false);
  analyzer.init(options,UTF8Type.instance);
  String testString="Nip it in the bud";
  ByteBuffer toAnalyze=ByteBuffer.wrap(testString.getBytes());
  analyzer.reset(toAnalyze);
  ByteBuffer analyzed=null;
  while (analyzer.hasNext())   analyzed=analyzer.next();
  Assert.assertTrue(testString.toLowerCase().equals(ByteBufferUtil.string(analyzed)));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void caseSensitiveAnalizer() throws Exception {
  NonTokenizingAnalyzer analyzer=new NonTokenizingAnalyzer();
  NonTokenizingOptions options=NonTokenizingOptions.getDefaultOptions();
  analyzer.init(options,UTF8Type.instance);
  String testString="Nip it in the bud";
  ByteBuffer toAnalyze=ByteBuffer.wrap(testString.getBytes());
  analyzer.reset(toAnalyze);
  ByteBuffer analyzed=null;
  while (analyzer.hasNext())   analyzed=analyzer.next();
  Assert.assertFalse(testString.toLowerCase().equals(ByteBufferUtil.string(analyzed)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.OnDiskIndexTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testSuperBlocks() throws Exception {
  Map<ByteBuffer,TokenTreeBuilder> terms=new HashMap<>();
  terms.put(UTF8Type.instance.decompose("1234"),keyBuilder(1L,2L));
  terms.put(UTF8Type.instance.decompose("2345"),keyBuilder(3L,4L));
  terms.put(UTF8Type.instance.decompose("3456"),keyBuilder(5L,6L));
  terms.put(UTF8Type.instance.decompose("4567"),keyBuilder(7L,8L));
  terms.put(UTF8Type.instance.decompose("5678"),keyBuilder(9L,10L));
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,Int32Type.instance,OnDiskIndexBuilder.Mode.SPARSE);
  for (  Map.Entry<ByteBuffer,TokenTreeBuilder> entry : terms.entrySet())   addAll(builder,entry.getKey(),entry.getValue());
  File index=File.createTempFile("on-disk-sa-try-superblocks",".db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,Int32Type.instance,new KeyConverter());
  OnDiskIndex.OnDiskSuperBlock superBlock=onDisk.dataLevel.getSuperBlock(0);
  Iterator<Token> iter=superBlock.iterator();
  Long lastToken=null;
  while (iter.hasNext()) {
    Token token=iter.next();
    if (lastToken != null)     Assert.assertTrue(lastToken.compareTo(token.get()) < 0);
    lastToken=token.get();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparseMode() throws Exception {
  OnDiskIndexBuilder builder=new OnDiskIndexBuilder(UTF8Type.instance,LongType.instance,OnDiskIndexBuilder.Mode.SPARSE);
  final long start=System.currentTimeMillis();
  final int numIterations=100000;
  for (long i=0; i < numIterations; i++)   builder.add(LongType.instance.decompose(start + i),keyAt(i),i);
  File index=File.createTempFile("on-disk-sa-sparse","db");
  index.deleteOnExit();
  builder.finish(index);
  OnDiskIndex onDisk=new OnDiskIndex(index,LongType.instance,new KeyConverter());
  ThreadLocalRandom random=ThreadLocalRandom.current();
  for (long step=start; step < (start + numIterations); step+=1000) {
    boolean lowerInclusive=random.nextBoolean();
    boolean upperInclusive=random.nextBoolean();
    long limit=random.nextLong(step,start + numIterations);
    RangeIterator<Long,Token> rows=onDisk.search(expressionFor(step,lowerInclusive,limit,upperInclusive));
    long lowerKey=step - start;
    long upperKey=lowerKey + (limit - step);
    if (!lowerInclusive)     lowerKey+=1;
    if (upperInclusive)     upperKey+=1;
    Set<DecoratedKey> actual=convert(rows);
    for (long key=lowerKey; key < upperKey; key++)     Assert.assertTrue("key" + key + " wasn't found",actual.contains(keyAt(key)));
    Assert.assertEquals((upperKey - lowerKey),actual.size());
  }
  RangeIterator<Long,Token> rows=onDisk.search(expressionFor(start,true,start + numIterations,true));
  Set<DecoratedKey> actual=convert(rows);
  Assert.assertEquals(numIterations,actual.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.disk.TokenTreeTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildWithMultipleMapsAndIterate() throws Exception {
  final SortedMap<Long,LongSet> merged=new TreeMap<>();
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  builder.add(collidingTokensMap);
  merged.putAll(collidingTokensMap);
  for (  Map.Entry<Long,LongSet> entry : simpleTokenMap.entrySet()) {
    if (merged.containsKey(entry.getKey())) {
      LongSet mergingOffsets=entry.getValue();
      LongSet existingOffsets=merged.get(entry.getKey());
      if (mergingOffsets.equals(existingOffsets))       continue;
      Set<Long> mergeSet=new HashSet<>();
      for (      LongCursor merging : mergingOffsets)       mergeSet.add(merging.value);
      for (      LongCursor existing : existingOffsets)       mergeSet.add(existing.value);
      LongSet mergedResults=new LongOpenHashSet();
      for (      Long result : mergeSet)       mergedResults.add(result);
      merged.put(entry.getKey(),mergedResults);
    }
 else {
      merged.put(entry.getKey(),entry.getValue());
    }
  }
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=merged.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(simpleTokenMap).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test1","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final Iterator<Token> tokenIterator=tokenTree.iterator(KEY_CONVERTER);
  final Iterator<Map.Entry<Long,LongSet>> listIterator=simpleTokenMap.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),treeNext.get());
    Assert.assertEquals(convert(listNext.getValue()),convert(treeNext));
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildAndIterate() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final Iterator<Pair<Long,LongSet>> tokenIterator=builder.iterator();
  final Iterator<Map.Entry<Long,LongSet>> listIterator=tokens.entrySet().iterator();
  while (tokenIterator.hasNext() && listIterator.hasNext()) {
    Pair<Long,LongSet> tokenNext=tokenIterator.next();
    Map.Entry<Long,LongSet> listNext=listIterator.next();
    Assert.assertEquals(listNext.getKey(),tokenNext.left);
    Assert.assertEquals(listNext.getValue(),tokenNext.right);
  }
  Assert.assertFalse("token iterator not finished",tokenIterator.hasNext());
  Assert.assertFalse("list iterator not finished",listIterator.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void buildSerializeIterateAndSkip() throws Exception {
  final TokenTreeBuilder builder=new TokenTreeBuilder(tokens).finish();
  final File treeFile=File.createTempFile("token-tree-iterate-test2","tt");
  treeFile.deleteOnExit();
  try (SequentialWriter writer=new SequentialWriter(treeFile,4096,BufferType.ON_HEAP)){
    builder.write(writer);
    writer.sync();
  }
   final RandomAccessReader reader=RandomAccessReader.open(treeFile);
  final TokenTree tokenTree=new TokenTree(new MappedBuffer(reader));
  final RangeIterator<Long,Token> treeIterator=tokenTree.iterator(KEY_CONVERTER);
  final RangeIterator<Long,TokenWithOffsets> listIterator=new EntrySetSkippableIterator(tokens);
  long lastToken=0L;
  while (treeIterator.hasNext() && lastToken < 12) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(lastToken=treeNext.get()));
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  treeIterator.skipTo(100548L);
  listIterator.skipTo(100548L);
  while (treeIterator.hasNext() && listIterator.hasNext()) {
    Token treeNext=treeIterator.next();
    TokenWithOffsets listNext=listIterator.next();
    Assert.assertEquals(listNext.token,(long)treeNext.get());
    Assert.assertEquals(convert(listNext.offsets),convert(treeNext));
  }
  Assert.assertFalse("Tree iterator not completed",treeIterator.hasNext());
  Assert.assertFalse("List iterator not completed",listIterator.hasNext());
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.plan.OperationTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSatisfiedByWithMultipleTerms(){
  final ColumnDefinition comment=getColumn(UTF8Type.instance.decompose("comment"));
  Unfiltered row=buildRow(buildCell(comment,UTF8Type.instance.decompose("software engineer is working on a project"),System.currentTimeMillis()));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(comment,Operator.EQ,UTF8Type.instance.decompose("eng is a work")));
  Operation op=builder.complete();
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(comment,Operator.EQ,UTF8Type.instance.decompose("soft works fine")));
  op=builder.complete();
  Assert.assertTrue(op.satisfiedBy(row,false));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-15 type-4 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSatisfiedBy() throws Exception {
  final ColumnDefinition timestamp=getColumn(UTF8Type.instance.decompose("timestamp"));
  final ColumnDefinition age=getColumn(UTF8Type.instance.decompose("age"));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)));
  Operation op=builder.complete();
  Unfiltered row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(1)),new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(6)),new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(10)));
  op=builder.complete();
  Set<Integer> exclusions=Sets.newHashSet(0,1,5,6,11);
  for (int i=0; i <= 11; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)),new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(6)));
  op=builder.complete();
  exclusions=Sets.newHashSet(0,1,2,3,4,7,8,9,10);
  for (int i=0; i <= 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(0)));
  builder.add(new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10)));
  builder.add(new SimpleExpression(age,Operator.NEQ,Int32Type.instance.decompose(7)));
  op=builder.complete();
  exclusions=Sets.newHashSet(7);
  for (int i=0; i < 10; i++) {
    row=buildRow(buildCell(age,Int32Type.instance.decompose(i),System.currentTimeMillis()));
    boolean result=op.satisfiedBy(row,false);
    Assert.assertTrue(exclusions.contains(i) != result);
  }
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(timestamp,Operator.GTE,LongType.instance.decompose(10L)));
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(5)));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(22L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.OR,controller,new SimpleExpression(timestamp,Operator.GT,LongType.instance.decompose(10L)));
  builder.setRight(new Operation.Builder(OperationType.AND,controller,new SimpleExpression(age,Operator.GT,Int32Type.instance.decompose(0)),new SimpleExpression(age,Operator.LT,Int32Type.instance.decompose(10))));
  op=builder.complete();
  row=buildRow(buildCell(age,Int32Type.instance.decompose(5),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(20),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(11L),System.currentTimeMillis()));
  Assert.assertTrue(op.satisfiedBy(row,false));
  row=buildRow(buildCell(age,Int32Type.instance.decompose(0),System.currentTimeMillis()),buildCell(timestamp,LongType.instance.decompose(9L),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(30)));
  op=builder.complete();
  Assert.assertFalse(op.satisfiedBy(null,false));
  Assert.assertFalse(op.satisfiedBy(row,false));
  long now=System.currentTimeMillis();
  row=OperationTest.buildRow(Row.Deletion.regular(new DeletionTime(now - 10,(int)(now / 1000))),buildCell(age,Int32Type.instance.decompose(6),System.currentTimeMillis()));
  Assert.assertFalse(op.satisfiedBy(row,false));
  row=buildRow(deletedCell(age,System.currentTimeMillis(),FBUtilities.nowInSeconds()));
  Assert.assertFalse(op.satisfiedBy(row,true));
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),false));
  }
 catch (  IllegalStateException e) {
  }
  try {
    Assert.assertFalse(op.satisfiedBy(buildRow(),true));
  }
 catch (  IllegalStateException e) {
    Assert.fail("IllegalStateException should not be thrown when missing column and allowMissingColumns=true");
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSatisfiedByWithClustering(){
  ColumnDefinition location=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("location"));
  ColumnDefinition age=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("age"));
  ColumnDefinition height=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("height"));
  ColumnDefinition score=getColumn(CLUSTERING_BACKEND,UTF8Type.instance.decompose("score"));
  Unfiltered row=buildRow(Clustering.make(UTF8Type.instance.fromString("US"),Int32Type.instance.decompose(27)),buildCell(height,Int32Type.instance.decompose(182),System.currentTimeMillis()),buildCell(score,DoubleType.instance.decompose(1.0d),System.currentTimeMillis()));
  Operation.Builder builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(27)));
  builder.add(new SimpleExpression(height,Operator.EQ,Int32Type.instance.decompose(182)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(age,Operator.EQ,Int32Type.instance.decompose(28)));
  builder.add(new SimpleExpression(height,Operator.EQ,Int32Type.instance.decompose(182)));
  Assert.assertFalse(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(27)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("BY")));
  builder.add(new SimpleExpression(age,Operator.GTE,Int32Type.instance.decompose(28)));
  Assert.assertFalse(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(age,Operator.LTE,Int32Type.instance.decompose(27)));
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(location,Operator.EQ,UTF8Type.instance.decompose("US")));
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  builder.add(new SimpleExpression(score,Operator.EQ,DoubleType.instance.decompose(1.0d)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
  builder=new Operation.Builder(OperationType.AND,controller);
  builder.add(new SimpleExpression(height,Operator.GTE,Int32Type.instance.decompose(182)));
  builder.add(new SimpleExpression(score,Operator.EQ,DoubleType.instance.decompose(1.0d)));
  Assert.assertTrue(builder.complete().satisfiedBy(row,false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.RangeIntersectionIteratorTest </h4><pre class="type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorPeeking(){
  RangeIterator.Builder<Long,Token> builder=RangeIntersectionIterator.builder();
  builder.add(new LongIterator(new long[]{10L}));
  long[] tokens=new long[150];
  for (int i=0; i < tokens.length; i++)   tokens[i]=i;
  builder.add(new LongIterator(tokens));
  RangeIterator<Long,Token> intersection=builder.build();
  Assert.assertNotNull(intersection);
  Assert.assertEquals(LookupIntersectionIterator.class,intersection.getClass());
  Assert.assertTrue(intersection.hasNext());
  Assert.assertEquals(convert(10L),convert(intersection));
  builder=RangeIntersectionIterator.builder();
  builder.add(new LongIterator(new long[]{1L,3L,5L,7L,9L}));
  builder.add(new LongIterator(new long[]{1L,2L,5L,6L}));
  intersection=builder.build();
  Assert.assertNotNull(intersection);
  Assert.assertEquals(BounceIntersectionIterator.class,intersection.getClass());
  Assert.assertTrue(intersection.hasNext());
  Assert.assertEquals(convert(1L,5L),convert(intersection));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsOverlapping(){
  RangeIterator<Long,Token> rangeA, rangeB;
  rangeA=new LongIterator(new long[]{1L,5L});
  rangeB=new LongIterator(new long[]{5L,9L});
  Assert.assertTrue(RangeIterator.isOverlapping(rangeA,rangeB));
  rangeA=new LongIterator(new long[]{5L,9L});
  rangeB=new LongIterator(new long[]{1L,6L});
  Assert.assertTrue(RangeIterator.isOverlapping(rangeA,rangeB));
  rangeA=new LongIterator(new long[]{5L,9L});
  rangeB=new LongIterator(new long[]{5L,9L});
  Assert.assertTrue(RangeIterator.isOverlapping(rangeA,rangeB));
  rangeA=new LongIterator(new long[]{1L,4L});
  rangeB=new LongIterator(new long[]{5L,9L});
  Assert.assertFalse(RangeIterator.isOverlapping(rangeA,rangeB));
  rangeA=new LongIterator(new long[]{6L,9L});
  rangeB=new LongIterator(new long[]{1L,4L});
  Assert.assertFalse(RangeIterator.isOverlapping(rangeA,rangeB));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.index.sasi.utils.RangeUnionIteratorTest </h4><pre class="type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkipTo(){
  RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
  builder.add(new LongIterator(new long[]{1L,2L,3L}));
  builder.add(new LongIterator(new long[]{4L,5L,6L}));
  builder.add(new LongIterator(new long[]{7L,8L,9L}));
  RangeIterator<Long,Token> tokens=builder.build();
  Assert.assertNotNull(tokens);
  tokens.skipTo(5L);
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(5L,(long)tokens.next().get());
  tokens.skipTo(7L);
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(7L,(long)tokens.next().get());
  tokens.skipTo(10L);
  Assert.assertFalse(tokens.hasNext());
  Assert.assertEquals(1L,(long)tokens.getMinimum());
  Assert.assertEquals(9L,(long)tokens.getMaximum());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeIterator(){
  LongIterator tokens=new LongIterator(new long[]{0L,1L,2L,3L});
  Assert.assertEquals(0L,(long)tokens.getMinimum());
  Assert.assertEquals(3L,(long)tokens.getMaximum());
  for (int i=0; i <= 3; i++) {
    Assert.assertTrue(tokens.hasNext());
    Assert.assertEquals(i,(long)tokens.getCurrent());
    Assert.assertEquals(i,(long)tokens.next().get());
  }
  tokens=new LongIterator(new long[]{0L,1L,3L,5L});
  Assert.assertEquals(3L,(long)tokens.skipTo(2L).get());
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(3L,(long)tokens.getCurrent());
  Assert.assertEquals(3L,(long)tokens.next().get());
  Assert.assertEquals(5L,(long)tokens.skipTo(5L).get());
  Assert.assertTrue(tokens.hasNext());
  Assert.assertEquals(5L,(long)tokens.getCurrent());
  Assert.assertEquals(5L,(long)tokens.next().get());
  LongIterator empty=new LongIterator(new long[0]);
  Assert.assertNull(empty.skipTo(3L));
  Assert.assertFalse(empty.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMinMaxAndCount(){
  RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
  builder.add(new LongIterator(new long[]{1L,2L,3L}));
  builder.add(new LongIterator(new long[]{4L,5L,6L}));
  builder.add(new LongIterator(new long[]{7L,8L,9L}));
  Assert.assertEquals(9L,(long)builder.getMaximum());
  Assert.assertEquals(9L,builder.getTokenCount());
  RangeIterator<Long,Token> tokens=builder.build();
  Assert.assertNotNull(tokens);
  Assert.assertEquals(1L,(long)tokens.getMinimum());
  Assert.assertEquals(9L,(long)tokens.getMaximum());
  Assert.assertEquals(9L,tokens.getCount());
  for (long i=1; i < 10; i++) {
    Assert.assertTrue(tokens.hasNext());
    Assert.assertEquals(i,(long)tokens.next().get());
  }
  Assert.assertFalse(tokens.hasNext());
  Assert.assertEquals(1L,(long)tokens.getMinimum());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuilder(){
  RangeUnionIterator.Builder<Long,Token> builder=RangeUnionIterator.builder();
  Assert.assertNull(builder.getMinimum());
  Assert.assertNull(builder.getMaximum());
  Assert.assertEquals(0L,builder.getTokenCount());
  Assert.assertEquals(0L,builder.rangeCount());
  builder.add(new LongIterator(new long[]{1L,2L,3L}));
  builder.add(new LongIterator(new long[]{4L,5L,6L}));
  builder.add(new LongIterator(new long[]{7L,8L,9L}));
  Assert.assertEquals(1L,(long)builder.getMinimum());
  Assert.assertEquals(9L,(long)builder.getMaximum());
  Assert.assertEquals(9L,builder.getTokenCount());
  Assert.assertEquals(3L,builder.rangeCount());
  Assert.assertFalse(builder.statistics.isDisjoint());
  Assert.assertEquals(1L,(long)builder.ranges.poll().getMinimum());
  Assert.assertEquals(4L,(long)builder.ranges.poll().getMinimum());
  Assert.assertEquals(7L,(long)builder.ranges.poll().getMinimum());
  RangeIterator<Long,Token> tokens=RangeUnionIterator.build(new ArrayList<RangeIterator<Long,Token>>(){
{
      add(new LongIterator(new long[]{1L,2L,4L}));
      add(new LongIterator(new long[]{3L,5L,6L}));
    }
  }
);
  Assert.assertEquals(convert(1L,2L,3L,4L,5L,6L),convert(tokens));
  FileUtils.closeQuietly(tokens);
  RangeIterator emptyTokens=RangeUnionIterator.builder().build();
  Assert.assertNull(emptyTokens);
  builder=RangeUnionIterator.builder();
  Assert.assertEquals(0L,builder.add((RangeIterator<Long,Token>)null).rangeCount());
  Assert.assertEquals(0L,builder.add((List<RangeIterator<Long,Token>>)null).getTokenCount());
  Assert.assertEquals(0L,builder.add(new LongIterator(new long[]{})).rangeCount());
  RangeIterator<Long,Token> single=new LongIterator(new long[]{1L,2L,3L});
  RangeIterator<Long,Token> range=RangeIntersectionIterator.<Long,Token>builder().add(single).build();
  Assert.assertEquals(range,single);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.compress.CompressedRandomAccessReaderTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test6791() throws IOException, ConfigurationException {
  File f=File.createTempFile("compressed6791_","3");
  String filename=f.getAbsolutePath();
  try (ChannelProxy channel=new ChannelProxy(f)){
    MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance));
    try (CompressedSequentialWriter writer=new CompressedSequentialWriter(f,filename + ".metadata",CompressionParams.snappy(32),sstableMetadataCollector)){
      for (int i=0; i < 20; i++)       writer.write("x".getBytes());
      FileMark mark=writer.mark();
      for (int i=0; i < 40; ++i)       writer.write("y".getBytes());
      writer.resetAndTruncate(mark);
      for (int i=0; i < 20; i++)       writer.write("x".getBytes());
      writer.finish();
    }
     try (RandomAccessReader reader=new CompressedRandomAccessReader.Builder(channel,new CompressionMetadata(filename + ".metadata",f.length(),ChecksumType.CRC32)).build()){
      String res=reader.readLine();
      assertEquals(res,"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
      assertEquals(40,res.length());
    }
   }
  finally {
    if (f.exists())     assertTrue(f.delete());
    File metadata=new File(filename + ".metadata");
    if (metadata.exists())     metadata.delete();
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-14 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataCorruptionDetection() throws IOException {
  String CONTENT="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vitae.";
  File file=new File("testDataCorruptionDetection");
  file.deleteOnExit();
  File metadata=new File(file.getPath() + ".meta");
  metadata.deleteOnExit();
  assertTrue(file.createNewFile());
  assertTrue(metadata.createNewFile());
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(file,metadata.getPath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(CONTENT.getBytes());
    writer.finish();
  }
   try (ChannelProxy channel=new ChannelProxy(file)){
    CompressionMetadata meta=new CompressionMetadata(metadata.getPath(),file.length(),ChecksumType.CRC32);
    CompressionMetadata.Chunk chunk=meta.chunkFor(0);
    try (RandomAccessReader reader=new CompressedRandomAccessReader.Builder(channel,meta).build()){
      assertEquals(CONTENT,reader.readLine());
      Random random=new Random();
      RandomAccessFile checksumModifier=null;
      try {
        checksumModifier=new RandomAccessFile(file,"rw");
        byte[] checksum=new byte[4];
        checksumModifier.seek(chunk.length);
        checksumModifier.read(checksum);
        checksumModifier.seek(chunk.length);
        for (int i=0; i < checksum.length; i++) {
          checksumModifier.write(random.nextInt());
          SyncUtil.sync(checksumModifier);
          try (final RandomAccessReader r=new CompressedRandomAccessReader.Builder(channel,meta).build()){
            Throwable exception=null;
            try {
              r.readLine();
            }
 catch (            Throwable t) {
              exception=t;
            }
            assertNotNull(exception);
            assertSame(exception.getClass(),CorruptSSTableException.class);
            assertSame(exception.getCause().getClass(),CorruptBlockException.class);
          }
         }
        updateChecksum(checksumModifier,chunk.length,checksum);
        try (RandomAccessReader cr=new CompressedRandomAccessReader.Builder(channel,meta).build()){
          assertEquals(CONTENT,cr.readLine());
        }
       }
  finally {
        if (checksumModifier != null)         checksumModifier.close();
      }
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.IndexSummaryManagerTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testRedistributeSummaries() throws IOException {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  int numSSTables=4;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  int minSamplingLevel=(BASE_SAMPLING_LEVEL * cfs.metadata.params.minIndexInterval) / cfs.metadata.params.maxIndexInterval;
  List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  long singleSummaryOffHeapSpace=sstables.get(0).getIndexSummaryOffHeapSize();
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * numSSTables));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL,sstable.getIndexSummarySamplingLevel());
  assertEquals(singleSummaryOffHeapSpace * numSSTables,totalOffHeapSize(sstables));
  validateData(cfs,numRows);
  assert sstables.size() == 4;
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 2)));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 2,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 4)));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 4,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * (numSSTables / 2) + 4));
  }
   assert sstables.size() == 4;
  for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL / 2,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * numSSTables));
  }
   for (  SSTableReader sstable : sstables)   assertEquals(BASE_SAMPLING_LEVEL,sstable.getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables.get(0).overrideReadMeter(new RestorableMeter(50.0,50.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(50.0,50.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(1).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  double lowerRate=50.0 * (DOWNSAMPLE_THESHOLD + (DOWNSAMPLE_THESHOLD * 0.10));
  double higherRate=50.0 * (UPSAMPLE_THRESHOLD - (UPSAMPLE_THRESHOLD * 0.10));
  sstables.get(0).overrideReadMeter(new RestorableMeter(lowerRate,lowerRate));
  sstables.get(1).overrideReadMeter(new RestorableMeter(higherRate,higherRate));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL / 2,sstables.get(1).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables=resetSummaries(cfs,sstables,singleSummaryOffHeapSpace);
  sstables.get(0).overrideReadMeter(new RestorableMeter(1.0,1.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(2.0,2.0));
  sstables.get(2).overrideReadMeter(new RestorableMeter(1000.0,1000.0));
  sstables.get(3).overrideReadMeter(new RestorableMeter(1000.0,1000.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(singleSummaryOffHeapSpace * 3) + 50);
  }
   Collections.sort(sstables,hotnessComparator);
  if (sstables.get(0).getIndexSummarySamplingLevel() == minSamplingLevel)   assertEquals(BASE_SAMPLING_LEVEL,sstables.get(1).getIndexSummarySamplingLevel());
 else   assertEquals(BASE_SAMPLING_LEVEL,sstables.get(0).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(2).getIndexSummarySamplingLevel());
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  sstables.get(0).overrideReadMeter(new RestorableMeter(0.0,0.0));
  sstables.get(1).overrideReadMeter(new RestorableMeter(0.0,0.0));
  sstables.get(2).overrideReadMeter(new RestorableMeter(92,92));
  sstables.get(3).overrideReadMeter(new RestorableMeter(128.0,128.0));
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),(long)(singleSummaryOffHeapSpace + (singleSummaryOffHeapSpace * (92.0 / BASE_SAMPLING_LEVEL))));
  }
   Collections.sort(sstables,hotnessComparator);
  assertEquals(1,sstables.get(0).getIndexSummarySize());
  assertEquals(1,sstables.get(0).getIndexSummarySize());
  assertTrue(sstables.get(2).getIndexSummarySamplingLevel() > minSamplingLevel);
  assertTrue(sstables.get(2).getIndexSummarySamplingLevel() < BASE_SAMPLING_LEVEL);
  assertEquals(BASE_SAMPLING_LEVEL,sstables.get(3).getIndexSummarySamplingLevel());
  validateData(cfs,numRows);
  try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
    sstables=redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),10);
  }
   for (  SSTableReader sstable : sstables)   assertEquals(1,sstable.getIndexSummarySize());
  validateData(cfs,numRows);
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJMXFunctions() throws IOException {
  IndexSummaryManager manager=IndexSummaryManager.instance;
  manager.setResizeIntervalInMinutes(-1);
  assertNull(manager.getTimeToNextResize(TimeUnit.MINUTES));
  manager.setResizeIntervalInMinutes(10);
  assertEquals(10,manager.getResizeIntervalInMinutes());
  assertEquals(10,manager.getTimeToNextResize(TimeUnit.MINUTES),1);
  manager.setResizeIntervalInMinutes(15);
  assertEquals(15,manager.getResizeIntervalInMinutes());
  assertEquals(15,manager.getTimeToNextResize(TimeUnit.MINUTES),2);
  assertTrue(manager.getMemoryPoolCapacityInMB() >= 0);
  manager.setMemoryPoolCapacityInMB(10);
  assertEquals(10,manager.getMemoryPoolCapacityInMB());
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  cfs.truncateBlocking();
  cfs.disableAutoCompaction();
  ByteBuffer value=ByteBuffer.wrap(new byte[100]);
  int numSSTables=2;
  int numRows=10;
  for (int sstable=0; sstable < numSSTables; sstable++) {
    for (int row=0; row < numRows; row++) {
      String key=String.format("%3d",row);
      new RowUpdateBuilder(cfs.metadata,0,key).clustering("column").add("val",value).build().applyUnsafe();
    }
    cfs.forceBlockingFlush();
  }
  assertTrue(manager.getAverageIndexInterval() >= cfs.metadata.params.minIndexInterval);
  Map<String,Integer> intervals=manager.getIndexIntervals();
  for (  Map.Entry<String,Integer> entry : intervals.entrySet())   if (entry.getKey().contains(CF_STANDARDLOWiINTERVAL))   assertEquals(cfs.metadata.params.minIndexInterval,entry.getValue(),0.001);
  manager.setMemoryPoolCapacityInMB(0);
  manager.redistributeSummaries();
  assertTrue(manager.getAverageIndexInterval() > cfs.metadata.params.minIndexInterval);
  intervals=manager.getIndexIntervals();
  for (  Map.Entry<String,Integer> entry : intervals.entrySet()) {
    if (entry.getKey().contains(CF_STANDARDLOWiINTERVAL))     assertTrue(entry.getValue() >= cfs.metadata.params.minIndexInterval);
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCancelIndex() throws Exception {
  String ksname=KEYSPACE1;
  String cfname=CF_STANDARDLOWiINTERVAL;
  Keyspace keyspace=Keyspace.open(ksname);
  final ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  final int numSSTables=4;
  int numRows=256;
  createSSTables(ksname,cfname,numSSTables,numRows);
  final List<SSTableReader> sstables=new ArrayList<>(cfs.getLiveSSTables());
  for (  SSTableReader sstable : sstables)   sstable.overrideReadMeter(new RestorableMeter(100.0,100.0));
  final long singleSummaryOffHeapSpace=sstables.get(0).getIndexSummaryOffHeapSize();
  final AtomicReference<CompactionInterruptedException> exception=new AtomicReference<>();
  Thread t=new Thread(new Runnable(){
    public void run(){
      try {
        try (LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN)){
          redistributeSummaries(Collections.EMPTY_LIST,of(cfs.metadata.cfId,txn),singleSummaryOffHeapSpace);
        }
       }
 catch (      CompactionInterruptedException ex) {
        exception.set(ex);
      }
catch (      IOException ignored) {
      }
    }
  }
);
  t.start();
  while (CompactionManager.instance.getActiveCompactions() == 0 && t.isAlive())   Thread.sleep(1);
  CompactionManager.instance.stopCompaction("INDEX_SUMMARY");
  t.join();
  assertNotNull("Expected compaction interrupted exception",exception.get());
  assertTrue("Expected no active compactions",CompactionMetrics.getCompactions().isEmpty());
  Set<SSTableReader> beforeRedistributionSSTables=new HashSet<>(sstables);
  Set<SSTableReader> afterCancelSSTables=new HashSet<>(cfs.getLiveSSTables());
  Set<SSTableReader> disjoint=Sets.symmetricDifference(beforeRedistributionSSTables,afterCancelSSTables);
  assertTrue(String.format("Mismatched files before and after cancelling redistribution: %s",Joiner.on(",").join(disjoint)),disjoint.isEmpty());
  validateData(cfs,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableLoaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadingIncompleteSSTable() throws Exception {
  File dataDir=new File(tmpdir.getAbsolutePath() + File.separator + KEYSPACE1+ File.separator+ CF_STANDARD2);
  assert dataDir.mkdirs();
  assertTrue(dataDir.listFiles().length == 0);
  String schema="CREATE TABLE %s.%s (key ascii, name ascii, val ascii, val1 ascii, PRIMARY KEY (key, name))";
  String query="INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)";
  CQLSSTableWriter writer=CQLSSTableWriter.builder().inDirectory(dataDir).forTable(String.format(schema,KEYSPACE1,CF_STANDARD2)).using(String.format(query,KEYSPACE1,CF_STANDARD2)).withBufferSizeInMB(1).build();
  int NB_PARTITIONS=5000;
  for (int i=0; i < NB_PARTITIONS; i++) {
    for (int j=0; j < 100; j++)     writer.addRow(String.format("key%d",i),String.format("col%d",j),"100");
  }
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2);
  cfs.forceBlockingFlush();
  assertTrue(dataDir.listFiles().length > 0);
  final CountDownLatch latch=new CountDownLatch(2);
  SSTableLoader loader=new SSTableLoader(dataDir,new TestClient(),new OutputHandler.SystemOutput(false,false));
  loader.stream(Collections.emptySet(),completionStreamListener(latch)).get();
  List<FilteredPartition> partitions=Util.getAll(Util.cmd(cfs).build());
  assertTrue(partitions.size() > 0 && partitions.size() < NB_PARTITIONS);
  writer.close();
  loader=new SSTableLoader(dataDir,new TestClient(),new OutputHandler.SystemOutput(false,false));
  loader.stream(Collections.emptySet(),completionStreamListener(latch)).get();
  partitions=Util.getAll(Util.cmd(Keyspace.open(KEYSPACE1).getColumnFamilyStore(CF_STANDARD2)).build());
  assertEquals(NB_PARTITIONS,partitions.size());
  latch.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableMetadataTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * 1. create a row with columns with ttls, 5x100 and 1x1000
 * 2. flush, verify (maxLocalDeletionTime = time+1000)
 * 3. delete column with ttl=1000
 * 4. flush, verify the new sstable (maxLocalDeletionTime = ~now)
 * 5. compact
 * 6. verify resulting sstable has maxLocalDeletionTime = time + 100.
 * @throws ExecutionException
 * @throws InterruptedException
 */
@Test public void testWithDeletes() throws ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard2");
  long timestamp=System.currentTimeMillis();
  DecoratedKey key=Util.dk("deletetest");
  for (int i=0; i < 5; i++)   new RowUpdateBuilder(store.metadata,timestamp,100,"deletetest").clustering("deletecolumn" + i).add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  new RowUpdateBuilder(store.metadata,timestamp,1000,"deletetest").clustering("todelete").add("val",ByteBufferUtil.EMPTY_BYTE_BUFFER).build().applyUnsafe();
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  int ttltimestamp=(int)(System.currentTimeMillis() / 1000);
  int firstMaxDelTime=0;
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    firstMaxDelTime=sstable.getSSTableMetadata().maxLocalDeletionTime;
    assertEquals(ttltimestamp + 1000,firstMaxDelTime,10);
  }
  RowUpdateBuilder.deleteRow(store.metadata,timestamp + 1,"deletetest","todelete").applyUnsafe();
  store.forceBlockingFlush();
  assertEquals(2,store.getLiveSSTables().size());
  boolean foundDelete=false;
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    if (sstable.getSSTableMetadata().maxLocalDeletionTime != firstMaxDelTime) {
      assertEquals(sstable.getSSTableMetadata().maxLocalDeletionTime,ttltimestamp,10);
      foundDelete=true;
    }
  }
  assertTrue(foundDelete);
  Util.compact(store,store.getLiveSSTables());
  assertEquals(1,store.getLiveSSTables().size());
  for (  SSTableReader sstable : store.getLiveSSTables()) {
    assertEquals(ttltimestamp + 100,sstable.getSSTableMetadata().maxLocalDeletionTime,10);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableReaderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * see CASSANDRA-5407 
 */
@Test public void testGetScannerForNoIntersectingRanges() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore("Standard1");
  partitioner=store.getPartitioner();
  new RowUpdateBuilder(store.metadata,0,"k1").clustering("xyz").add("val","abc").build().applyUnsafe();
  store.forceBlockingFlush();
  boolean foundScanner=false;
  for (  SSTableReader s : store.getLiveSSTables()) {
    try (ISSTableScanner scanner=s.getScanner(new Range<Token>(t(0),t(1)),null)){
      scanner.next();
      foundScanner=true;
    }
   }
  assertTrue(foundScanner);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexSummaryReplacement() throws IOException, ExecutionException, InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE1);
  final ColumnFamilyStore store=keyspace.getColumnFamilyStore("StandardLowIndexInterval");
  CompactionManager.instance.disableAutoCompaction();
  final int NUM_PARTITIONS=512;
  for (int j=0; j < NUM_PARTITIONS; j++) {
    new RowUpdateBuilder(store.metadata,j,String.format("%3d",j)).clustering("0").add("val",String.format("%3d",j)).build().applyUnsafe();
  }
  store.forceBlockingFlush();
  CompactionManager.instance.performMaximal(store,false);
  Collection<SSTableReader> sstables=store.getLiveSSTables();
  assert sstables.size() == 1;
  final SSTableReader sstable=sstables.iterator().next();
  ThreadPoolExecutor executor=new ScheduledThreadPoolExecutor(5);
  List<Future> futures=new ArrayList<>(NUM_PARTITIONS * 2);
  for (int i=0; i < NUM_PARTITIONS; i++) {
    final ByteBuffer key=ByteBufferUtil.bytes(String.format("%3d",i));
    final int index=i;
    futures.add(executor.submit(new Runnable(){
      public void run(){
        Row row=Util.getOnlyRowUnfiltered(Util.cmd(store,key).build());
        assertEquals(0,ByteBufferUtil.compare(String.format("%3d",index).getBytes(),row.cells().iterator().next().value()));
      }
    }
));
    futures.add(executor.submit(new Runnable(){
      public void run(){
        Iterable<DecoratedKey> results=store.keySamples(new Range<>(sstable.getPartitioner().getMinimumToken(),sstable.getPartitioner().getToken(key)));
        assertTrue(results.iterator().hasNext());
      }
    }
));
  }
  SSTableReader replacement;
  try (LifecycleTransaction txn=store.getTracker().tryModify(Arrays.asList(sstable),OperationType.UNKNOWN)){
    replacement=sstable.cloneWithNewSummarySamplingLevel(store,1);
    txn.update(replacement,true);
    txn.finish();
  }
   for (  Future future : futures)   future.get();
  assertEquals(sstable.estimatedKeys(),replacement.estimatedKeys(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableRewriterTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * emulates anticompaction - writing from one source sstable to two new sstables
 * @throws IOException
 */
@Test public void testTwoWriters() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,false);SSTableRewriter writer2=new SSTableRewriter(txn,1000,false,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    writer2.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      if (writer.currentWriter().getFilePointer() < 15000000)       writer.append(ci.next());
 else       writer2.append(ci.next());
    }
    for (int i=0; i < 5000; i++)     assertFalse(Util.getOnlyPartition(Util.cmd(cfs,ByteBufferUtil.bytes(i)).build()).isEmpty());
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPositionsTest() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=new HashSet<>(cfs.getLiveSSTables());
  assertEquals(1,sstables.size());
  int nowInSec=FBUtilities.nowInSeconds();
  boolean checked=false;
  try (AbstractCompactionStrategy.ScannerList scanners=cfs.getCompactionStrategyManager().getScanners(sstables);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionController controller=new CompactionController(cfs,sstables,cfs.gcBefore(nowInSec));CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,scanners.scanners,controller,nowInSec,UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      UnfilteredRowIterator row=ci.next();
      writer.append(row);
      if (!checked && writer.currentWriter().getFilePointer() > 1500000) {
        checked=true;
        for (        SSTableReader sstable : cfs.getLiveSSTables()) {
          if (sstable.openReason == SSTableReader.OpenReason.EARLY) {
            SSTableReader c=txn.current(sstables.iterator().next());
            Collection<Range<Token>> r=Arrays.asList(new Range<>(cfs.getPartitioner().getMinimumToken(),cfs.getPartitioner().getMinimumToken()));
            List<Pair<Long,Long>> tmplinkPositions=sstable.getPositionsForRanges(r);
            List<Pair<Long,Long>> compactingPositions=c.getPositionsForRanges(r);
            assertEquals(1,tmplinkPositions.size());
            assertEquals(1,compactingPositions.size());
            assertEquals(0,tmplinkPositions.get(0).left.longValue());
            assertEquals(tmplinkPositions.get(0).right.longValue(),compactingPositions.get(0).left.longValue());
            assertEquals(c.uncompressedLength(),compactingPositions.get(0).right.longValue());
          }
        }
      }
    }
    assertTrue(checked);
    writer.finish();
  }
   LifecycleTransaction.waitForDeletions();
  validateCFS(cfs);
  int filecounts=assertFileCounts(sstables.iterator().next().descriptor.directory.list());
  assertEquals(1,filecounts);
  truncate(cfs);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-13 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCanonicalView() throws Exception {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  SSTableReader s=writeFile(cfs,1000);
  cfs.addSSTable(s);
  Set<SSTableReader> sstables=Sets.newHashSet(s);
  assertEquals(1,sstables.size());
  boolean checked=false;
  try (ISSTableScanner scanner=sstables.iterator().next().getScanner();CompactionController controller=new CompactionController(cfs,sstables,0);LifecycleTransaction txn=cfs.getTracker().tryModify(sstables,OperationType.UNKNOWN);SSTableRewriter writer=new SSTableRewriter(txn,1000,false,10000000,false);CompactionIterator ci=new CompactionIterator(OperationType.COMPACTION,Collections.singletonList(scanner),controller,FBUtilities.nowInSeconds(),UUIDGen.getTimeUUID())){
    writer.switchWriter(getWriter(cfs,sstables.iterator().next().descriptor.directory,txn));
    while (ci.hasNext()) {
      writer.append(ci.next());
      if (!checked && writer.currentWriter().getFilePointer() > 15000000) {
        checked=true;
        ColumnFamilyStore.ViewFragment viewFragment=cfs.select(View.select(SSTableSet.CANONICAL));
        assertEquals(1,viewFragment.sstables.size());
        SSTableReader sstable=viewFragment.sstables.get(0);
        assertEquals(s.descriptor,sstable.descriptor);
        assertTrue("Found early opened SSTable in canonical view: " + sstable.getFilename(),sstable.openReason != SSTableReader.OpenReason.EARLY);
      }
    }
  }
   truncateCF();
  validateCFS(cfs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableScannerTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleRanges() throws IOException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore store=keyspace.getColumnFamilyStore(TABLE);
  store.clearUnsafe();
  store.disableAutoCompaction();
  for (int i=0; i < 3; i++)   for (int j=2; j < 10; j++)   insertRowWithKey(store.metadata,i * 100 + j);
  store.forceBlockingFlush();
  assertEquals(1,store.getLiveSSTables().size());
  SSTableReader sstable=store.getLiveSSTables().iterator().next();
  ISSTableScanner fullScanner=sstable.getScanner(null);
  assertScanContainsRanges(fullScanner,2,9,102,109,202,209);
  ISSTableScanner scanner=sstable.getScanner(makeRanges(1,9,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(101,109,201,209),null);
  assertScanContainsRanges(scanner,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,9,201,209),null);
  assertScanContainsRanges(scanner,2,9,202,209);
  scanner=sstable.getScanner(makeRanges(1,9,101,109),null);
  assertScanContainsRanges(scanner,2,9,102,109);
  scanner=sstable.getScanner(makeRanges(1,5,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,5,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,20,101,109,201,209),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(1,5,6,205,206,209),null);
  assertScanContainsRanges(scanner,2,5,7,9,102,109,202,205,207,209);
  scanner=sstable.getScanner(makeRanges(0,1,2,20,101,109,150,159,201,209,1000,1001),null);
  assertScanContainsRanges(scanner,3,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(201,209,1,20,201,209,101,109,1000,1001,150,159),null);
  assertScanContainsRanges(scanner,2,9,102,109,202,209);
  scanner=sstable.getScanner(makeRanges(0,1,150,159,250,259),null);
  assertFalse(scanner.hasNext());
  scanner=sstable.getScanner(new ArrayList<Range<Token>>(),null);
  assertFalse(scanner.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.SSTableWriterTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTxnWithOpenEarlyShouldRemoveSSTable() throws InterruptedException {
  Keyspace keyspace=Keyspace.open(KEYSPACE);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(CF);
  truncate(cfs);
  File dir=cfs.getDirectories().getDirectoryForNewSSTables();
  LifecycleTransaction txn=LifecycleTransaction.offline(OperationType.WRITE);
  try (SSTableWriter writer=getWriter(cfs,dir,txn)){
    for (int i=0; i < 10000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    SSTableReader s=writer.setMaxDataAge(1000).openEarly();
    assert s != null;
    assertFileCounts(dir.list());
    for (int i=10000; i < 20000; i++) {
      UpdateBuilder builder=UpdateBuilder.create(cfs.metadata,random(i,10)).withTimestamp(1);
      for (int j=0; j < 100; j++)       builder.newRow("" + j).add("val",ByteBuffer.allocate(1000));
      writer.append(builder.build().unfilteredIterator());
    }
    SSTableReader s2=writer.setMaxDataAge(1000).openEarly();
    assertTrue(s.last.compareTo(s2.last) < 0);
    assertFileCounts(dir.list());
    s.selfRef().release();
    s2.selfRef().release();
    int datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,1);
    if (!FBUtilities.isWindows()) {
      LifecycleTransaction.waitForDeletions();
      assertFileCounts(dir.list());
    }
    writer.abort();
    txn.abort();
    LifecycleTransaction.waitForDeletions();
    datafiles=assertFileCounts(dir.list());
    assertEquals(datafiles,0);
    validateCFS(cfs);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.sstable.format.SSTableFlushObserverTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlushObserver(){
  CFMetaData cfm=CFMetaData.Builder.create(KS_NAME,CF_NAME).addPartitionKey("id",UTF8Type.instance).addRegularColumn("first_name",UTF8Type.instance).addRegularColumn("age",Int32Type.instance).addRegularColumn("height",LongType.instance).build();
  LifecycleTransaction transaction=LifecycleTransaction.offline(OperationType.COMPACTION);
  FlushObserver observer=new FlushObserver();
  String sstableDirectory=DatabaseDescriptor.getAllDataFileLocations()[0];
  File directory=new File(sstableDirectory + File.pathSeparator + KS_NAME+ File.pathSeparator+ CF_NAME);
  directory.deleteOnExit();
  if (!directory.exists() && !directory.mkdirs())   throw new FSWriteError(new IOException("failed to create tmp directory"),directory.getAbsolutePath());
  SSTableFormat.Type sstableFormat=DatabaseDescriptor.getSSTableFormat();
  BigTableWriter writer=new BigTableWriter(new Descriptor(sstableFormat.info.getLatestVersion().version,directory,KS_NAME,CF_NAME,0,sstableFormat),10L,0L,cfm,new MetadataCollector(cfm.comparator).sstableLevel(0),new SerializationHeader(true,cfm,cfm.partitionColumns(),EncodingStats.NO_STATS),Collections.singletonList(observer),transaction);
  SSTableReader reader=null;
  Multimap<ByteBuffer,Cell> expected=ArrayListMultimap.create();
  try {
    final long now=System.currentTimeMillis();
    ByteBuffer key=UTF8Type.instance.fromString("key1");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("jack")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(27)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(183L))));
    writer.append(new RowIterator(cfm,key.duplicate(),Collections.singletonList(buildRow(expected.get(key)))));
    key=UTF8Type.instance.fromString("key2");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("jim")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(30)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(180L))));
    writer.append(new RowIterator(cfm,key,Collections.singletonList(buildRow(expected.get(key)))));
    key=UTF8Type.instance.fromString("key3");
    expected.putAll(key,Arrays.asList(BufferCell.live(cfm,getColumn(cfm,"first_name"),now,UTF8Type.instance.fromString("ken")),BufferCell.live(cfm,getColumn(cfm,"age"),now,Int32Type.instance.decompose(30)),BufferCell.live(cfm,getColumn(cfm,"height"),now,LongType.instance.decompose(178L))));
    writer.append(new RowIterator(cfm,key,Collections.singletonList(buildRow(expected.get(key)))));
    reader=writer.finish(true);
  }
  finally {
    FileUtils.closeQuietly(writer);
  }
  Assert.assertTrue(observer.isComplete);
  Assert.assertEquals(expected.size(),observer.rows.size());
  for (  Pair<ByteBuffer,Long> e : observer.rows.keySet()) {
    ByteBuffer key=e.left;
    Long indexPosition=e.right;
    try (FileDataInput index=reader.ifile.createReader(indexPosition)){
      ByteBuffer indexKey=ByteBufferUtil.readWithShortLength(index);
      Assert.assertEquals(0,UTF8Type.instance.compare(key,indexKey));
    }
 catch (    IOException ex) {
      throw new FSReadError(ex,reader.getIndexFilename());
    }
    Assert.assertEquals(expected.get(key),observer.rows.get(e));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.BufferedRandomAccessFileTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAndWrite() throws Exception {
  SequentialWriter w=createTempFile("braf");
  ChannelProxy channel=new ChannelProxy(w.getPath());
  byte[] data="Hello".getBytes();
  w.write(data);
  assertEquals(data.length,w.length());
  assertEquals(data.length,w.position());
  w.sync();
  RandomAccessReader r=RandomAccessReader.open(channel);
  byte[] buffer=new byte[data.length];
  assertEquals(data.length,r.read(buffer));
  assertTrue(Arrays.equals(buffer,data));
  assertEquals(r.read(),-1);
  assert r.bytesRemaining() == 0 && r.isEOF();
  r.close();
  byte[] bigData=new byte[RandomAccessReader.DEFAULT_BUFFER_SIZE + 10];
  for (int i=0; i < bigData.length; i++)   bigData[i]='d';
  long initialPosition=w.position();
  w.write(bigData);
  assertEquals(w.position(),initialPosition + bigData.length);
  assertEquals(w.length(),initialPosition + bigData.length);
  w.sync();
  r=RandomAccessReader.open(channel);
  r.seek(initialPosition);
  data=new byte[bigData.length];
  long sizeRead=0;
  for (int i=0; i < data.length; i++) {
    data[i]=(byte)r.read();
    sizeRead++;
  }
  assertEquals(sizeRead,data.length);
  assertEquals(r.getFilePointer(),initialPosition + data.length);
  assertEquals(r.length(),initialPosition + bigData.length);
  assertTrue(Arrays.equals(bigData,data));
  assertTrue(r.bytesRemaining() == 0 && r.isEOF());
  r.seek(0);
  ByteBuffer fileContent=ByteBufferUtil.read(r,(int)w.length());
  assertEquals(fileContent.limit(),w.length());
  assert ByteBufferUtil.string(fileContent).equals("Hello" + new String(bigData));
  data=new byte[bigData.length];
  r.seek(initialPosition);
  r.readFully(data);
  assert r.bytesRemaining() == 0 && r.isEOF();
  assertTrue(Arrays.equals(bigData,data));
  data=new byte[10];
  assertEquals(r.read(),-1);
  assertEquals(r.read(data),-1);
  assertEquals(r.read(data,0,data.length),-1);
  r.seek(0);
  data=new byte[20];
  assertEquals(15,r.read(data,0,15));
  assertTrue(new String(data).contains("Hellodddddddddd"));
  for (int i=16; i < data.length; i++) {
    assert data[i] == 0;
  }
  w.finish();
  r.close();
  channel.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkAndReset() throws IOException {
  SequentialWriter w=createTempFile("brafTestMark");
  w.write(new byte[30]);
  w.finish();
  ChannelProxy channel=new ChannelProxy(w.getPath());
  RandomAccessReader file=RandomAccessReader.open(channel);
  file.seek(10);
  FileMark mark=file.mark();
  file.seek(file.length());
  assertTrue(file.isEOF());
  file.reset();
  assertEquals(file.bytesRemaining(),20);
  file.seek(file.length());
  assertTrue(file.isEOF());
  file.reset(mark);
  assertEquals(file.bytesRemaining(),20);
  file.seek(file.length());
  assertEquals(file.bytesPastMark(),20);
  assertEquals(file.bytesPastMark(mark),20);
  file.reset(mark);
  assertEquals(file.bytesPastMark(),0);
  file.close();
  channel.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.ChecksummedRandomAccessReaderTest </h4><pre class="type-4 type-5 type-2 type-16 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ChecksummedRandomAccessReader.CorruptFileException.class) public void corruptionDetection() throws IOException {
  final File data=File.createTempFile("corruptionDetection","data");
  final File crc=File.createTempFile("corruptionDetection","crc");
  final byte[] expected=new byte[5 * 1024];
  Arrays.fill(expected,(byte)0);
  SequentialWriter writer=ChecksummedSequentialWriter.open(data,crc);
  writer.write(expected);
  writer.finish();
  assert data.exists();
  try (RandomAccessFile dataFile=new RandomAccessFile(data,"rw")){
    dataFile.seek(1024);
    dataFile.write((byte)5);
  }
   RandomAccessReader reader=new ChecksummedRandomAccessReader.Builder(data,crc).build();
  byte[] b=new byte[expected.length];
  reader.readFully(b);
  assertArrayEquals(expected,b);
  assertTrue(reader.isEOF());
  reader.close();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readFully() throws IOException {
  final File data=File.createTempFile("testReadFully","data");
  final File crc=File.createTempFile("testReadFully","crc");
  final byte[] expected=new byte[70 * 1024];
  ThreadLocalRandom.current().nextBytes(expected);
  SequentialWriter writer=ChecksummedSequentialWriter.open(data,crc);
  writer.write(expected);
  writer.finish();
  assert data.exists();
  RandomAccessReader reader=new ChecksummedRandomAccessReader.Builder(data,crc).build();
  byte[] b=new byte[expected.length];
  reader.readFully(b);
  assertArrayEquals(expected,b);
  assertTrue(reader.isEOF());
  reader.close();
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void seek() throws IOException {
  final File data=File.createTempFile("testSeek","data");
  final File crc=File.createTempFile("testSeek","crc");
  final byte[] dataBytes=new byte[70 * 1024];
  ThreadLocalRandom.current().nextBytes(dataBytes);
  SequentialWriter writer=ChecksummedSequentialWriter.open(data,crc);
  writer.write(dataBytes);
  writer.finish();
  assert data.exists();
  RandomAccessReader reader=new ChecksummedRandomAccessReader.Builder(data,crc).build();
  final int seekPosition=66000;
  reader.seek(seekPosition);
  byte[] b=new byte[dataBytes.length - seekPosition];
  reader.readFully(b);
  byte[] expected=Arrays.copyOfRange(dataBytes,seekPosition,dataBytes.length);
  assertArrayEquals(expected,b);
  assertTrue(reader.isEOF());
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.DataOutputTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testWrappedFileOutputStream() throws IOException {
  File file=FileUtils.createTempFile("dataoutput","test");
  try {
    DataOutputStreamPlus write=new WrappedDataOutputStreamPlus(new FileOutputStream(file));
    DataInput canon=testWrite(write);
    write.close();
    DataInputStream test=new DataInputStream(new FileInputStream(file));
    testRead(test,canon);
    test.close();
  }
  finally {
    Assert.assertTrue(file.delete());
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDataOutputBufferMaxSizeFake() throws IOException {
  try (DataOutputBufferSpy write=new DataOutputBufferSpy()){
    boolean threw=false;
    try {
      while (true)       write.publicFlush();
    }
 catch (    RuntimeException e) {
      if (e.getClass() == RuntimeException.class)       threw=true;
    }
    Assert.assertTrue(threw);
    Assert.assertTrue(write.sizes.peekLast() >= DataOutputBuffer.MAX_ARRAY_SIZE);
  }
 }

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSequentialWriter() throws IOException {
  File file=FileUtils.createTempFile("dataoutput","test");
  final SequentialWriter writer=new SequentialWriter(file,32,BufferType.ON_HEAP);
  DataOutputStreamPlus write=new WrappedDataOutputStreamPlus(writer.finishOnClose());
  DataInput canon=testWrite(write);
  write.flush();
  write.close();
  DataInputStream test=new DataInputStream(new FileInputStream(file));
  testRead(test,canon);
  test.close();
  Assert.assertTrue(file.delete());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFileOutputStream() throws IOException {
  File file=FileUtils.createTempFile("dataoutput","test");
  try {
    DataOutputStreamPlus write=new BufferedDataOutputStreamPlus(new FileOutputStream(file));
    DataInput canon=testWrite(write);
    write.close();
    DataInputStream test=new DataInputStream(new FileInputStream(file));
    testRead(test,canon);
    test.close();
  }
  finally {
    Assert.assertTrue(file.delete());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRandomAccessFile() throws IOException {
  File file=FileUtils.createTempFile("dataoutput","test");
  try {
    @SuppressWarnings("resource") final RandomAccessFile raf=new RandomAccessFile(file,"rw");
    DataOutputStreamPlus write=new BufferedDataOutputStreamPlus(raf.getChannel());
    DataInput canon=testWrite(write);
    write.close();
    DataInputStream test=new DataInputStream(new FileInputStream(file));
    testRead(test,canon);
    test.close();
  }
  finally {
    Assert.assertTrue(file.delete());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.FileSegmentInputStreamTest </h4><pre class="type-4 type-5 type-2 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=UnsupportedOperationException.class) public void testMarkNotSupported() throws Exception {
  FileSegmentInputStream reader=new FileSegmentInputStream(allocateBuffer(1024),"",0);
  assertFalse(reader.markSupported());
  assertEquals(0,reader.bytesPastMark(null));
  reader.mark();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.FileUtilsTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncate() throws IOException {
  File file=FileUtils.createTempFile("testTruncate","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  Files.write(file.toPath(),expected.getBytes());
  assertTrue(file.exists());
  byte[] b=Files.readAllBytes(file.toPath());
  assertEquals(expected,new String(b,Charset.forName("UTF-8")));
  FileUtils.truncate(file.getAbsolutePath(),10);
  b=Files.readAllBytes(file.toPath());
  assertEquals("The quick ",new String(b,Charset.forName("UTF-8")));
  FileUtils.truncate(file.getAbsolutePath(),0);
  b=Files.readAllBytes(file.toPath());
  assertEquals(0,b.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MemoryTest </h4><pre class="type-15 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStream() throws IOException {
  byte[] bytes=new byte[4096];
  ThreadLocalRandom.current().nextBytes(bytes);
  final Memory memory=Memory.allocate(bytes.length);
  memory.setBytes(0,bytes,0,bytes.length);
  try (MemoryInputStream stream=new MemoryInputStream(memory,1024)){
    byte[] bb=new byte[bytes.length];
    assertEquals(bytes.length,stream.available());
    stream.readFully(bb);
    assertEquals(0,stream.available());
    assertTrue(Arrays.equals(bytes,bb));
    try {
      stream.readInt();
      fail("Expected EOF exception");
    }
 catch (    EOFException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.MmappedRegionsTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopy() throws Exception {
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  MmappedRegions snapshot;
  ChannelProxy channelCopy;
  try (ChannelProxy channel=new ChannelProxy(writeFile("testSnapshot",buffer));MmappedRegions regions=MmappedRegions.map(channel,buffer.capacity() / 4)){
    regions.extend(buffer.capacity() / 2);
    regions.extend(3 * buffer.capacity() / 4);
    regions.extend(buffer.capacity());
    snapshot=regions.sharedCopy();
    channelCopy=channel.sharedCopy();
  }
   assertFalse(snapshot.isCleanedUp());
  final int SIZE=buffer.capacity() / 4;
  for (int i=0; i < buffer.capacity(); i++) {
    MmappedRegions.Region region=snapshot.floor(i);
    assertNotNull(region);
    assertEquals(SIZE * (i / SIZE),region.bottom());
    assertEquals(SIZE + (SIZE * (i / SIZE)),region.top());
    assertNotNull(region.buffer.duplicate().getInt());
  }
  assertNull(snapshot.close(null));
  assertNull(channelCopy.close(null));
  assertTrue(snapshot.isCleanedUp());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap3() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap3",buffer));MmappedRegions regions=MmappedRegions.map(channel,null)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEmpty() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testEmpty",buffer));MmappedRegions regions=MmappedRegions.empty(channel)){
    assertTrue(regions.isEmpty());
    assertTrue(regions.isValid(channel));
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapForCompressionMetadata() throws Exception {
  int OLD_MAX_SEGMENT_SIZE=MmappedRegions.MAX_SEGMENT_SIZE;
  MmappedRegions.MAX_SEGMENT_SIZE=1024;
  ByteBuffer buffer=allocateBuffer(128 * 1024);
  File f=File.createTempFile("testMapForCompressionMetadata","1");
  f.deleteOnExit();
  File cf=File.createTempFile(f.getName() + ".metadata","1");
  cf.deleteOnExit();
  MetadataCollector sstableMetadataCollector=new MetadataCollector(new ClusteringComparator(BytesType.instance)).replayPosition(null);
  try (SequentialWriter writer=new CompressedSequentialWriter(f,cf.getAbsolutePath(),CompressionParams.snappy(),sstableMetadataCollector)){
    writer.write(buffer);
    writer.finish();
  }
   CompressionMetadata metadata=new CompressionMetadata(cf.getAbsolutePath(),f.length(),ChecksumType.CRC32);
  try (ChannelProxy channel=new ChannelProxy(f);MmappedRegions regions=MmappedRegions.map(channel,metadata)){
    assertFalse(regions.isEmpty());
    int i=0;
    while (i < buffer.capacity()) {
      CompressionMetadata.Chunk chunk=metadata.chunkFor(i);
      MmappedRegions.Region region=regions.floor(chunk.offset);
      assertNotNull(region);
      ByteBuffer compressedChunk=region.buffer.duplicate();
      assertNotNull(compressedChunk);
      assertEquals(chunk.length + 4,compressedChunk.capacity());
      assertEquals(chunk.offset,region.bottom());
      assertEquals(chunk.offset + chunk.length + 4,region.top());
      i+=metadata.chunkLength();
    }
  }
  finally {
    MmappedRegions.MAX_SEGMENT_SIZE=OLD_MAX_SEGMENT_SIZE;
    metadata.close();
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap1() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap1",buffer));MmappedRegions regions=MmappedRegions.map(channel,0)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<pre class="type-7 type-5 type-16 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testIllegalArgForMap2() throws Exception {
  ByteBuffer buffer=allocateBuffer(1024);
  try (ChannelProxy channel=new ChannelProxy(writeFile("testIllegalArgForMap2",buffer));MmappedRegions regions=MmappedRegions.map(channel,-1L)){
    assertTrue(regions.isEmpty());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.NIODataInputStreamTest </h4><pre class="type-6 type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntSmallBuffer() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    ByteBuffer buf=ByteBuffer.allocate(Math.max(1,ii));
    long value=0;
    if (ii > 0)     value=(1L << 7 * ii) - 1;
    BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
    out.writeUnsignedVInt(value);
    buf.position(0);
    RebufferingInputStream in=new DataInputBuffer(buf,false);
    assertEquals(value,in.readUnsignedVInt());
    boolean threw=false;
    try {
      in.readUnsignedVInt();
    }
 catch (    EOFException e) {
      threw=true;
    }
    assertTrue(threw);
  }
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("resource") @Test public void testReadUnsignedVInt() throws Exception {
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStreamPlus daos=new WrappedDataOutputStreamPlus(baos);
  long values[]=new long[]{0,1,UnsignedLong.MAX_VALUE.longValue(),UnsignedLong.MAX_VALUE.longValue() - 1,UnsignedLong.MAX_VALUE.longValue() + 1,UnsignedInteger.MAX_VALUE.longValue(),UnsignedInteger.MAX_VALUE.longValue() - 1,UnsignedInteger.MAX_VALUE.longValue() + 1,UnsignedBytes.MAX_VALUE,UnsignedBytes.MAX_VALUE - 1,UnsignedBytes.MAX_VALUE + 1,65536,65536 - 1,65536 + 1};
  values=BufferedDataOutputStreamTest.enrich(values);
  for (  long v : values)   daos.writeUnsignedVInt(v);
  daos.flush();
  NIODataInputStream is=new NIODataInputStream(wrap(baos.toByteArray()),9);
  for (  long v : values)   assertEquals(v,is.readUnsignedVInt());
  boolean threw=false;
  try {
    is.readUnsignedVInt();
  }
 catch (  EOFException e) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("resource") @Test public void testReadVInt() throws Exception {
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStreamPlus daos=new WrappedDataOutputStreamPlus(baos);
  long values[]=new long[]{0,1,-1,Long.MIN_VALUE,Long.MIN_VALUE + 1,Long.MAX_VALUE,Long.MAX_VALUE - 1,Integer.MIN_VALUE,Integer.MIN_VALUE + 1,Integer.MAX_VALUE,Integer.MAX_VALUE - 1,Short.MIN_VALUE,Short.MIN_VALUE + 1,Short.MAX_VALUE,Short.MAX_VALUE - 1,Byte.MIN_VALUE,Byte.MIN_VALUE + 1,Byte.MAX_VALUE,Byte.MAX_VALUE - 1};
  values=BufferedDataOutputStreamTest.enrich(values);
  for (  long v : values)   daos.writeVInt(v);
  daos.flush();
  NIODataInputStream is=new NIODataInputStream(wrap(baos.toByteArray()),9);
  for (  long v : values)   assertEquals(v,is.readVInt());
  boolean threw=false;
  try {
    is.readVInt();
  }
 catch (  EOFException e) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test @SuppressWarnings({"resource"}) public void testVIntTruncationEOF() throws Exception {
  for (int ii=0; ii < 10; ii++) {
    ByteBuffer buf=ByteBuffer.allocate(Math.max(1,ii));
    long value=0;
    if (ii > 0)     value=(1L << 7 * ii) - 1;
    BufferedDataOutputStreamPlus out=new DataOutputBufferFixed(buf);
    out.writeUnsignedVInt(value);
    buf.position(0);
    ByteBuffer truncated=ByteBuffer.allocate(buf.capacity() - 1);
    buf.limit(buf.limit() - 1);
    truncated.put(buf);
    truncated.flip();
    RebufferingInputStream in=new DataInputBuffer(truncated,false);
    boolean threw=false;
    try {
      in.readUnsignedVInt();
    }
 catch (    EOFException e) {
      threw=true;
    }
    assertTrue(threw);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testMarkSupported() throws Exception {
  assertFalse(fakeStream.markSupported());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.RandomAccessReaderTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadBytes() throws IOException {
  File f=File.createTempFile("testReadBytes","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  try (SequentialWriter writer=SequentialWriter.open(f)){
    writer.write(expected.getBytes());
    writer.finish();
  }
   assert f.exists();
  try (ChannelProxy channel=new ChannelProxy(f);RandomAccessReader reader=new RandomAccessReader.Builder(channel).build()){
    assertEquals(f.getAbsolutePath(),reader.getPath());
    assertEquals(expected.length(),reader.length());
    ByteBuffer b=ByteBufferUtil.read(reader,expected.length());
    assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    assertTrue(reader.isEOF());
    assertEquals(0,reader.bytesRemaining());
  }
 }

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReset() throws IOException {
  File f=File.createTempFile("testMark","1");
  final String expected="The quick brown fox jumps over the lazy dog";
  final int numIterations=10;
  try (SequentialWriter writer=SequentialWriter.open(f)){
    for (int i=0; i < numIterations; i++)     writer.write(expected.getBytes());
    writer.finish();
  }
   assert f.exists();
  try (ChannelProxy channel=new ChannelProxy(f);RandomAccessReader reader=new RandomAccessReader.Builder(channel).build()){
    assertEquals(expected.length() * numIterations,reader.length());
    ByteBuffer b=ByteBufferUtil.read(reader,expected.length());
    assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    assertFalse(reader.isEOF());
    assertEquals((numIterations - 1) * expected.length(),reader.bytesRemaining());
    FileMark mark=reader.mark();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark());
    assertEquals(expected.length() * (numIterations - 1),reader.bytesPastMark(mark));
    reader.reset(mark);
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    reader.reset();
    assertEquals(0,reader.bytesPastMark());
    assertEquals(0,reader.bytesPastMark(mark));
    assertFalse(reader.isEOF());
    for (int i=0; i < (numIterations - 1); i++) {
      b=ByteBufferUtil.read(reader,expected.length());
      assertEquals(expected,new String(b.array(),Charset.forName("UTF-8")));
    }
    assertTrue(reader.isEOF());
  }
 }

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVeryLarge() throws IOException {
  final long SIZE=1L << 32;
  Parameters params=new Parameters(SIZE,1 << 20);
  try (ChannelProxy channel=new ChannelProxy("abc",new FakeFileChannel(SIZE))){
    RandomAccessReader.Builder builder=new RandomAccessReader.Builder(channel).bufferType(params.bufferType).bufferSize(params.bufferSize);
    try (RandomAccessReader reader=builder.build()){
      assertEquals(channel.size(),reader.length());
      assertEquals(channel.size(),reader.bytesRemaining());
      assertEquals(Integer.MAX_VALUE,reader.available());
      assertEquals(channel.size(),reader.skip(channel.size()));
      assertTrue(reader.isEOF());
      assertEquals(0,reader.bytesRemaining());
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.io.util.SequentialWriterTest </h4><pre class="type-15 type-5 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the output stream exposed by SequentialWriter behaves as expected
 */
@Test public void outputStream(){
  File tempFile=new File(Files.createTempDir(),"test.txt");
  Assert.assertFalse("temp file shouldn't exist yet",tempFile.exists());
  try (DataOutputStream os=new DataOutputStream(SequentialWriter.open(tempFile).finishOnClose())){
    os.writeUTF("123");
  }
 catch (  IOException e) {
    Assert.fail();
  }
  Assert.assertTrue("temp file should exist",tempFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.PendingRangeMapsTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrapAroundRanges() throws UnknownHostException {
  PendingRangeMaps pendingRangeMaps=new PendingRangeMaps();
  pendingRangeMaps.addPendingRange(genRange("5","15"),InetAddress.getByName("127.0.0.1"));
  pendingRangeMaps.addPendingRange(genRange("15","25"),InetAddress.getByName("127.0.0.2"));
  pendingRangeMaps.addPendingRange(genRange("25","35"),InetAddress.getByName("127.0.0.3"));
  pendingRangeMaps.addPendingRange(genRange("35","45"),InetAddress.getByName("127.0.0.4"));
  pendingRangeMaps.addPendingRange(genRange("45","55"),InetAddress.getByName("127.0.0.5"));
  pendingRangeMaps.addPendingRange(genRange("45","65"),InetAddress.getByName("127.0.0.6"));
  pendingRangeMaps.addPendingRange(genRange("65","7"),InetAddress.getByName("127.0.0.7"));
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("0")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("5")).size());
  assertEquals(2,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("7")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("10")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("15")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("20")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("25")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("35")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("45")).size());
  assertEquals(2,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("55")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("65")).size());
  Collection<InetAddress> endpoints=pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("6"));
  assertTrue(endpoints.contains(InetAddress.getByName("127.0.0.1")));
  assertTrue(endpoints.contains(InetAddress.getByName("127.0.0.7")));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPendingEndpoints() throws UnknownHostException {
  PendingRangeMaps pendingRangeMaps=new PendingRangeMaps();
  pendingRangeMaps.addPendingRange(genRange("5","15"),InetAddress.getByName("127.0.0.1"));
  pendingRangeMaps.addPendingRange(genRange("15","25"),InetAddress.getByName("127.0.0.2"));
  pendingRangeMaps.addPendingRange(genRange("25","35"),InetAddress.getByName("127.0.0.3"));
  pendingRangeMaps.addPendingRange(genRange("35","45"),InetAddress.getByName("127.0.0.4"));
  pendingRangeMaps.addPendingRange(genRange("45","55"),InetAddress.getByName("127.0.0.5"));
  pendingRangeMaps.addPendingRange(genRange("45","65"),InetAddress.getByName("127.0.0.6"));
  assertEquals(0,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("0")).size());
  assertEquals(0,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("5")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("10")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("15")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("20")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("25")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("35")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("45")).size());
  assertEquals(2,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("55")).size());
  assertEquals(1,pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("65")).size());
  Collection<InetAddress> endpoints=pendingRangeMaps.pendingEndpointsFor(new BigIntegerToken("15"));
  assertTrue(endpoints.contains(InetAddress.getByName("127.0.0.1")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.SimpleStrategyTest </h4><pre class="type-6 type-7 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetEndpointsDuringBootstrap() throws UnknownHostException {
  final int RING_SIZE=10;
  TokenMetadata tmd=new TokenMetadata();
  TokenMetadata oldTmd=StorageServiceAccessor.setTokenMetadata(tmd);
  Token[] endpointTokens=new Token[RING_SIZE];
  Token[] keyTokens=new Token[RING_SIZE];
  for (int i=0; i < RING_SIZE; i++) {
    endpointTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i));
    keyTokens[i]=new BigIntegerToken(String.valueOf(RING_SIZE * 2 * i + RING_SIZE));
  }
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  for (int i=0; i < endpointTokens.length; i++) {
    InetAddress ep=InetAddress.getByName("127.0.0." + String.valueOf(i + 1));
    tmd.updateNormalToken(endpointTokens[i],ep);
    hosts.add(ep);
  }
  Token bsToken=new BigIntegerToken(String.valueOf(210));
  InetAddress bootstrapEndpoint=InetAddress.getByName("127.0.0.11");
  tmd.addBootstrapToken(bsToken,bootstrapEndpoint);
  AbstractReplicationStrategy strategy=null;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    PendingRangeCalculatorService.calculatePendingRanges(strategy,keyspaceName);
    int replicationFactor=strategy.getReplicationFactor();
    for (int i=0; i < keyTokens.length; i++) {
      Collection<InetAddress> endpoints=tmd.getWriteEndpoints(keyTokens[i],keyspaceName,strategy.getNaturalEndpoints(keyTokens[i]));
      assertTrue(endpoints.size() >= replicationFactor);
      for (int j=0; j < replicationFactor; j++) {
        assertTrue(endpoints.contains(hosts.get((i + j + 1) % hosts.size())));
      }
      if (i < RING_SIZE - replicationFactor)       assertFalse(endpoints.contains(bootstrapEndpoint));
 else       assertTrue(endpoints.contains(bootstrapEndpoint));
    }
  }
  StorageServiceAccessor.setTokenMetadata(oldTmd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.locator.TokenMetadataTest </h4><pre class="type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTopologyUpdate_RackConsolidation() throws UnknownHostException {
  final InetAddress first=InetAddress.getByName("127.0.0.1");
  final InetAddress second=InetAddress.getByName("127.0.0.6");
  final String DATA_CENTER="datacenter1";
  final String RACK1="rack1";
  final String RACK2="rack2";
  DatabaseDescriptor.setEndpointSnitch(new AbstractEndpointSnitch(){
    @Override public String getRack(    InetAddress endpoint){
      return endpoint.equals(first) ? RACK1 : RACK2;
    }
    @Override public String getDatacenter(    InetAddress endpoint){
      return DATA_CENTER;
    }
    @Override public int compareEndpoints(    InetAddress target,    InetAddress a1,    InetAddress a2){
      return 0;
    }
  }
);
  tmd.updateNormalToken(token(ONE),first);
  tmd.updateNormalToken(token(SIX),second);
  TokenMetadata tokenMetadata=tmd.cloneOnlyTokenMap();
  assertNotNull(tokenMetadata);
  TokenMetadata.Topology topology=tokenMetadata.getTopology();
  assertNotNull(topology);
  Multimap<String,InetAddress> allEndpoints=topology.getDatacenterEndpoints();
  assertNotNull(allEndpoints);
  assertTrue(allEndpoints.size() == 2);
  assertTrue(allEndpoints.containsKey(DATA_CENTER));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(first));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(second));
  Map<String,Multimap<String,InetAddress>> racks=topology.getDatacenterRacks();
  assertNotNull(racks);
  assertTrue(racks.size() == 1);
  assertTrue(racks.containsKey(DATA_CENTER));
  assertTrue(racks.get(DATA_CENTER).size() == 2);
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK1));
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK2));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(first));
  assertTrue(racks.get(DATA_CENTER).get(RACK2).contains(second));
  DatabaseDescriptor.setEndpointSnitch(new AbstractEndpointSnitch(){
    @Override public String getRack(    InetAddress endpoint){
      return RACK1;
    }
    @Override public String getDatacenter(    InetAddress endpoint){
      return DATA_CENTER;
    }
    @Override public int compareEndpoints(    InetAddress target,    InetAddress a1,    InetAddress a2){
      return 0;
    }
  }
);
  tokenMetadata.updateTopology(first);
  tokenMetadata.updateTopology(second);
  allEndpoints=topology.getDatacenterEndpoints();
  assertNotNull(allEndpoints);
  assertTrue(allEndpoints.size() == 2);
  assertTrue(allEndpoints.containsKey(DATA_CENTER));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(first));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(second));
  racks=topology.getDatacenterRacks();
  assertNotNull(racks);
  assertTrue(racks.size() == 1);
  assertTrue(racks.containsKey(DATA_CENTER));
  assertTrue(racks.get(DATA_CENTER).size() == 2);
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK1));
  assertFalse(racks.get(DATA_CENTER).containsKey(RACK2));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(first));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(second));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTopologyUpdate_RackExpansion() throws UnknownHostException {
  final InetAddress first=InetAddress.getByName("127.0.0.1");
  final InetAddress second=InetAddress.getByName("127.0.0.6");
  final String DATA_CENTER="datacenter1";
  final String RACK1="rack1";
  final String RACK2="rack2";
  DatabaseDescriptor.setEndpointSnitch(new AbstractEndpointSnitch(){
    @Override public String getRack(    InetAddress endpoint){
      return RACK1;
    }
    @Override public String getDatacenter(    InetAddress endpoint){
      return DATA_CENTER;
    }
    @Override public int compareEndpoints(    InetAddress target,    InetAddress a1,    InetAddress a2){
      return 0;
    }
  }
);
  tmd.updateNormalToken(token(ONE),first);
  tmd.updateNormalToken(token(SIX),second);
  TokenMetadata tokenMetadata=tmd.cloneOnlyTokenMap();
  assertNotNull(tokenMetadata);
  TokenMetadata.Topology topology=tokenMetadata.getTopology();
  assertNotNull(topology);
  Multimap<String,InetAddress> allEndpoints=topology.getDatacenterEndpoints();
  assertNotNull(allEndpoints);
  assertTrue(allEndpoints.size() == 2);
  assertTrue(allEndpoints.containsKey(DATA_CENTER));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(first));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(second));
  Map<String,Multimap<String,InetAddress>> racks=topology.getDatacenterRacks();
  assertNotNull(racks);
  assertTrue(racks.size() == 1);
  assertTrue(racks.containsKey(DATA_CENTER));
  assertTrue(racks.get(DATA_CENTER).size() == 2);
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK1));
  assertFalse(racks.get(DATA_CENTER).containsKey(RACK2));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(first));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(second));
  DatabaseDescriptor.setEndpointSnitch(new AbstractEndpointSnitch(){
    @Override public String getRack(    InetAddress endpoint){
      return endpoint.equals(first) ? RACK1 : RACK2;
    }
    @Override public String getDatacenter(    InetAddress endpoint){
      return DATA_CENTER;
    }
    @Override public int compareEndpoints(    InetAddress target,    InetAddress a1,    InetAddress a2){
      return 0;
    }
  }
);
  tokenMetadata.updateTopology();
  allEndpoints=topology.getDatacenterEndpoints();
  assertNotNull(allEndpoints);
  assertTrue(allEndpoints.size() == 2);
  assertTrue(allEndpoints.containsKey(DATA_CENTER));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(first));
  assertTrue(allEndpoints.get(DATA_CENTER).contains(second));
  racks=topology.getDatacenterRacks();
  assertNotNull(racks);
  assertTrue(racks.size() == 1);
  assertTrue(racks.containsKey(DATA_CENTER));
  assertTrue(racks.get(DATA_CENTER).size() == 2);
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK1));
  assertTrue(racks.get(DATA_CENTER).containsKey(RACK2));
  assertTrue(racks.get(DATA_CENTER).get(RACK1).contains(first));
  assertTrue(racks.get(DATA_CENTER).get(RACK2).contains(second));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.metrics.LatencyMetricsTest </h4><pre class="type-6 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
/** 
 * Test bitsets in a "real-world" environment, i.e., bloom filters
 */
@Test public void testGetRecentLatency(){
  final LatencyMetrics l=new LatencyMetrics("test","test");
  Runnable r=new Runnable(){
    public void run(){
      for (int i=0; i < 10000; i++) {
        l.addNano(1000);
      }
    }
  }
;
  new Thread(r).start();
  for (int i=0; i < 10000; i++) {
    Double recent=l.latency.getOneMinuteRate();
    assertFalse(recent.equals(Double.POSITIVE_INFINITY));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.ValidatorTest </h4><pre class="type-7 type-13 type-15 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidatorFailed() throws Throwable {
  Range<Token> range=new Range<>(partitioner.getMinimumToken(),partitioner.getRandomToken());
  final RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),keyspace,columnFamily,Arrays.asList(range));
  final SimpleCondition lock=new SimpleCondition();
  MessagingService.instance().addMessageSink(new IMessageSink(){
    public boolean allowOutgoingMessage(    MessageOut message,    int id,    InetAddress to){
      try {
        if (message.verb == MessagingService.Verb.REPAIR_MESSAGE) {
          RepairMessage m=(RepairMessage)message.payload;
          assertEquals(RepairMessage.Type.VALIDATION_COMPLETE,m.messageType);
          assertEquals(desc,m.desc);
          assertFalse(((ValidationComplete)m).success());
          assertNull(((ValidationComplete)m).trees);
        }
      }
  finally {
        lock.signalAll();
      }
      return false;
    }
    public boolean allowIncomingMessage(    MessageIn message,    int id){
      return false;
    }
  }
);
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  Validator validator=new Validator(desc,remote,0);
  validator.fail();
  if (!lock.isSignaled())   lock.await();
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidatorComplete() throws Throwable {
  Range<Token> range=new Range<>(partitioner.getMinimumToken(),partitioner.getRandomToken());
  final RepairJobDesc desc=new RepairJobDesc(UUID.randomUUID(),UUID.randomUUID(),keyspace,columnFamily,Arrays.asList(range));
  final SimpleCondition lock=new SimpleCondition();
  MessagingService.instance().addMessageSink(new IMessageSink(){
    public boolean allowOutgoingMessage(    MessageOut message,    int id,    InetAddress to){
      try {
        if (message.verb == MessagingService.Verb.REPAIR_MESSAGE) {
          RepairMessage m=(RepairMessage)message.payload;
          assertEquals(RepairMessage.Type.VALIDATION_COMPLETE,m.messageType);
          assertEquals(desc,m.desc);
          assertTrue(((ValidationComplete)m).success());
          assertNotNull(((ValidationComplete)m).trees);
        }
      }
  finally {
        lock.signalAll();
      }
      return false;
    }
    public boolean allowIncomingMessage(    MessageIn message,    int id){
      return false;
    }
  }
);
  InetAddress remote=InetAddress.getByName("127.0.0.2");
  ColumnFamilyStore cfs=Keyspace.open(keyspace).getColumnFamilyStore(columnFamily);
  Validator validator=new Validator(desc,remote,0);
  MerkleTrees tree=new MerkleTrees(partitioner);
  tree.addMerkleTrees((int)Math.pow(2,15),validator.desc.ranges);
  validator.prepare(cfs,tree);
  assertTrue(tree.size() > 1);
  Token mid=partitioner.midpoint(range.left,range.right);
  validator.add(EmptyIterators.unfilteredRow(cfs.metadata,new BufferDecoratedKey(mid,ByteBufferUtil.bytes("inconceivable!")),false));
  validator.complete();
  Token min=tree.partitioner().getMinimumToken();
  assertNotNull(tree.hash(new Range<>(min,min)));
  if (!lock.isSignaled())   lock.await();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.repair.messages.RepairOptionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIncrementalRepairWithSubrangesIsNotGlobal() throws Exception {
  RepairOption ro=RepairOption.parse(ImmutableMap.of(RepairOption.INCREMENTAL_KEY,"true",RepairOption.RANGES_KEY,"42:42"),Murmur3Partitioner.instance);
  assertFalse(ro.isGlobal());
  ro=RepairOption.parse(ImmutableMap.of(RepairOption.INCREMENTAL_KEY,"true",RepairOption.RANGES_KEY,""),Murmur3Partitioner.instance);
  assertTrue(ro.isGlobal());
}

</code></pre>

<br>
<pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseOptions(){
  IPartitioner partitioner=Murmur3Partitioner.instance;
  Token.TokenFactory tokenFactory=partitioner.getTokenFactory();
  RepairOption option=RepairOption.parse(new HashMap<String,String>(),partitioner);
  if (FBUtilities.isWindows() && (DatabaseDescriptor.getDiskAccessMode() != Config.DiskAccessMode.standard || DatabaseDescriptor.getIndexAccessMode() != Config.DiskAccessMode.standard))   assertTrue(option.getParallelism() == RepairParallelism.PARALLEL);
 else   assertTrue(option.getParallelism() == RepairParallelism.SEQUENTIAL);
  assertFalse(option.isPrimaryRange());
  assertFalse(option.isIncremental());
  Map<String,String> options=new HashMap<>();
  options.put(RepairOption.PARALLELISM_KEY,"parallel");
  options.put(RepairOption.PRIMARY_RANGE_KEY,"false");
  options.put(RepairOption.INCREMENTAL_KEY,"false");
  options.put(RepairOption.RANGES_KEY,"0:10,11:20,21:30");
  options.put(RepairOption.COLUMNFAMILIES_KEY,"cf1,cf2,cf3");
  options.put(RepairOption.DATACENTERS_KEY,"dc1,dc2,dc3");
  options.put(RepairOption.HOSTS_KEY,"127.0.0.1,127.0.0.2,127.0.0.3");
  option=RepairOption.parse(options,partitioner);
  assertTrue(option.getParallelism() == RepairParallelism.PARALLEL);
  assertFalse(option.isPrimaryRange());
  assertFalse(option.isIncremental());
  Set<Range<Token>> expectedRanges=new HashSet<>(3);
  expectedRanges.add(new Range<>(tokenFactory.fromString("0"),tokenFactory.fromString("10")));
  expectedRanges.add(new Range<>(tokenFactory.fromString("11"),tokenFactory.fromString("20")));
  expectedRanges.add(new Range<>(tokenFactory.fromString("21"),tokenFactory.fromString("30")));
  assertEquals(expectedRanges,option.getRanges());
  Set<String> expectedCFs=new HashSet<>(3);
  expectedCFs.add("cf1");
  expectedCFs.add("cf2");
  expectedCFs.add("cf3");
  assertEquals(expectedCFs,option.getColumnFamilies());
  Set<String> expectedDCs=new HashSet<>(3);
  expectedDCs.add("dc1");
  expectedDCs.add("dc2");
  expectedDCs.add("dc3");
  assertEquals(expectedDCs,option.getDataCenters());
  Set<String> expectedHosts=new HashSet<>(3);
  expectedHosts.add("127.0.0.1");
  expectedHosts.add("127.0.0.2");
  expectedHosts.add("127.0.0.3");
  assertEquals(expectedHosts,option.getHosts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.DefsTest </h4><pre class="type-7 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testDropIndex() throws ConfigurationException {
  SchemaKeyspace.makeCreateKeyspaceMutation(Schema.instance.getKSMetaData(KEYSPACE6),FBUtilities.timestampMicros()).applyUnsafe();
  ColumnFamilyStore cfs=Keyspace.open(KEYSPACE6).getColumnFamilyStore(TABLE1i);
  String indexName="birthdate_key_index";
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, c1, birthdate, notbirthdate) VALUES (?, ?, ?, ?)",KEYSPACE6,TABLE1i),"key0","col0",1L,1L);
  cfs.forceBlockingFlush();
  ColumnFamilyStore indexCfs=cfs.indexManager.getIndexByName(indexName).getBackingTable().orElseThrow(throwAssert("Cannot access index cfs"));
  Descriptor desc=indexCfs.getLiveSSTables().iterator().next().descriptor;
  CFMetaData meta=cfs.metadata.copy();
  IndexMetadata existing=cfs.metadata.getIndexes().get(indexName).orElseThrow(throwAssert("Index not found"));
  meta.indexes(meta.getIndexes().without(existing.name));
  MigrationManager.announceColumnFamilyUpdate(meta,false);
  assertTrue(cfs.indexManager.listIndexes().isEmpty());
  LifecycleTransaction.waitForDeletions();
  assertFalse(new File(desc.filenameFor(Component.DATA)).exists());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNewTable() throws ConfigurationException {
  final String ksName=KEYSPACE1;
  final String tableName="anewtable";
  KeyspaceMetadata original=Schema.instance.getKSMetaData(ksName);
  CFMetaData cfm=addTestTable(original.name,tableName,"A New Table");
  assertFalse(Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).isPresent());
  MigrationManager.announceNewColumnFamily(cfm);
  assertTrue(Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).isPresent());
  assertEquals(cfm,Schema.instance.getKSMetaData(ksName).tables.get(cfm.cfName).get());
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, col, val) VALUES (?, ?, ?)",ksName,tableName),"key0","col0","val0");
  ColumnFamilyStore cfs=Keyspace.open(ksName).getColumnFamilyStore(tableName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s",ksName,tableName));
  assertRows(rows,row("key0","col0","val0"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInvalidNames(){
  String[] valid={"1","a","_1","b_","__","1_a"};
  for (  String s : valid)   assertTrue(CFMetaData.isNameValid(s));
  String[] invalid={"b@t","dash-y",""," ","dot.s",".hidden"};
  for (  String s : invalid)   assertFalse(CFMetaData.isNameValid(s));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropKS() throws ConfigurationException {
  final KeyspaceMetadata ks=Schema.instance.getKSMetaData(KEYSPACE1);
  assertNotNull(ks);
  final CFMetaData cfm=ks.tables.getNullable(TABLE2);
  assertNotNull(cfm);
  for (int i=0; i < 100; i++)   QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)",KEYSPACE1,TABLE2),"dropKs","col" + i,"anyvalue");
  ColumnFamilyStore cfs=Keyspace.open(cfm.ksName).getColumnFamilyStore(cfm.cfName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  assertTrue(!cfs.getDirectories().sstableLister(Directories.OnTxnErr.THROW).list().isEmpty());
  MigrationManager.announceKeyspaceDrop(ks.name);
  assertNull(Schema.instance.getKSMetaData(ks.name));
  boolean success=true;
  try {
    QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, name, val) VALUES (?, ?, ?)",KEYSPACE1,TABLE2),"dropKs","col0","anyvalue");
  }
 catch (  Throwable th) {
    success=false;
  }
  assertFalse("This mutation should have failed since the KS no longer exists.",success);
  boolean threw=false;
  try {
    Keyspace.open(ks.name);
  }
 catch (  Throwable th) {
    threw=true;
  }
  assertTrue(threw);
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createEmptyKsAddNewCf() throws ConfigurationException {
  assertNull(Schema.instance.getKSMetaData(EMPTY_KEYSPACE));
  KeyspaceMetadata newKs=KeyspaceMetadata.create(EMPTY_KEYSPACE,KeyspaceParams.simple(5));
  MigrationManager.announceNewKeyspace(newKs);
  assertNotNull(Schema.instance.getKSMetaData(EMPTY_KEYSPACE));
  String tableName="added_later";
  CFMetaData newCf=addTestTable(EMPTY_KEYSPACE,tableName,"A new CF to add to an empty KS");
  assertFalse(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).isPresent());
  MigrationManager.announceNewColumnFamily(newCf);
  assertTrue(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).isPresent());
  assertEquals(Schema.instance.getKSMetaData(newKs.name).tables.get(newCf.cfName).get(),newCf);
  QueryProcessor.executeInternal(String.format("INSERT INTO %s.%s (key, col, val) VALUES (?, ?, ?)",EMPTY_KEYSPACE,tableName),"key0","col0","val0");
  ColumnFamilyStore cfs=Keyspace.open(newKs.name).getColumnFamilyStore(newCf.cfName);
  assertNotNull(cfs);
  cfs.forceBlockingFlush();
  UntypedResultSet rows=QueryProcessor.executeInternal(String.format("SELECT * FROM %s.%s",EMPTY_KEYSPACE,tableName));
  assertRows(rows,row("key0","col0","val0"));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCFMetaDataApply() throws ConfigurationException {
  CFMetaData cfm=CFMetaData.Builder.create(KEYSPACE1,"TestApplyCFM_CF").addPartitionKey("keys",BytesType.instance).addClusteringColumn("col",BytesType.instance).build();
  for (int i=0; i < 5; i++) {
    ByteBuffer name=ByteBuffer.wrap(new byte[]{(byte)i});
    cfm.addColumnDefinition(ColumnDefinition.regularDef(cfm,name,BytesType.instance));
  }
  cfm.comment("No comment").readRepairChance(0.5).gcGraceSeconds(100000).compaction(CompactionParams.scts(ImmutableMap.of("min_threshold","500","max_threshold","500")));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
  CFMetaData cfNew=cfm.copy();
  ColumnDefinition addIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{5}),BytesType.instance);
  cfNew.addColumnDefinition(addIndexDef);
  ColumnDefinition removeIndexDef=ColumnDefinition.regularDef(cfm,ByteBuffer.wrap(new byte[]{0}),BytesType.instance);
  assertTrue(cfNew.removeColumnDefinition(removeIndexDef));
  cfm.apply(cfNew);
  for (int i=1; i < cfm.allColumns().size(); i++)   assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{1})));
  assertNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{0})));
  assertNotNull(cfm.getColumnDefinition(ByteBuffer.wrap(new byte[]{5})));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateKeyspace() throws ConfigurationException {
  CFMetaData cf=addTestTable("UpdatedKeyspace","AddedStandard1","A new cf for a new ks");
  KeyspaceMetadata oldKs=KeyspaceMetadata.create(cf.ksName,KeyspaceParams.simple(5),Tables.of(cf));
  MigrationManager.announceNewKeyspace(oldKs);
  assertNotNull(Schema.instance.getKSMetaData(cf.ksName));
  assertEquals(Schema.instance.getKSMetaData(cf.ksName),oldKs);
  KeyspaceMetadata newBadKs2=KeyspaceMetadata.create(cf.ksName + "trash",KeyspaceParams.simple(4));
  try {
    MigrationManager.announceKeyspaceUpdate(newBadKs2);
    throw new AssertionError("Should not have been able to update a KS with an invalid KS name.");
  }
 catch (  ConfigurationException ex) {
  }
  Map<String,String> replicationMap=new HashMap<>();
  replicationMap.put(ReplicationParams.CLASS,OldNetworkTopologyStrategy.class.getName());
  replicationMap.put("replication_factor","1");
  KeyspaceMetadata newKs=KeyspaceMetadata.create(cf.ksName,KeyspaceParams.create(true,replicationMap));
  MigrationManager.announceKeyspaceUpdate(newKs);
  KeyspaceMetadata newFetchedKs=Schema.instance.getKSMetaData(newKs.name);
  assertEquals(newFetchedKs.params.replication.klass,newKs.params.replication.klass);
  assertFalse(newFetchedKs.params.replication.klass.equals(oldKs.params.replication.klass));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.IndexMetadataTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsNameValidPositive(){
  assertTrue(IndexMetadata.isNameValid("abcdefghijklmnopqrstuvwxyz"));
  assertTrue(IndexMetadata.isNameValid("ABCDEFGHIJKLMNOPQRSTUVWXYZ"));
  assertTrue(IndexMetadata.isNameValid("_01234567890"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIsNameValidNegative(){
  assertFalse(IndexMetadata.isNameValid(null));
  assertFalse(IndexMetadata.isNameValid(""));
  assertFalse(IndexMetadata.isNameValid(" "));
  assertFalse(IndexMetadata.isNameValid("@"));
  assertFalse(IndexMetadata.isNameValid("!"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.schema.SchemaKeyspaceTest </h4><pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtensions() throws IOException {
  String keyspace="SandBox";
  createTable(keyspace,"CREATE TABLE test (a text primary key, b int, c int)");
  CFMetaData metadata=Schema.instance.getCFMetaData(keyspace,"test");
  assertTrue("extensions should be empty",metadata.params.extensions.isEmpty());
  ImmutableMap<String,ByteBuffer> extensions=ImmutableMap.of("From ... with Love",ByteBuffer.wrap(new byte[]{0,0,7}));
  CFMetaData copy=metadata.copy().extensions(extensions);
  updateTable(keyspace,metadata,copy);
  metadata=Schema.instance.getCFMetaData(keyspace,"test");
  assertEquals(extensions,metadata.params.extensions);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.security.CipherFactoryTest </h4><pre class="type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void buildCipher_DifferentIVs() throws Exception {
  Cipher c1=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,nextIV(),Cipher.ENCRYPT_MODE);
  Cipher c2=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,nextIV(),Cipher.DECRYPT_MODE);
  Assert.assertFalse(c1 == c2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void buildCipher_SameParams() throws Exception {
  byte[] iv=nextIV();
  Cipher c1=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,iv,Cipher.ENCRYPT_MODE);
  Cipher c2=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,iv,Cipher.ENCRYPT_MODE);
  Assert.assertTrue(c1 == c2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void buildCipher_DifferentAliases() throws Exception {
  Cipher c1=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,nextIV(),Cipher.ENCRYPT_MODE);
  Cipher c2=cipherFactory.buildCipher(encryptionOptions.cipher,EncryptionContextGenerator.KEY_ALIAS_2,nextIV(),Cipher.DECRYPT_MODE);
  Assert.assertFalse(c1 == c2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void buildCipher_DifferentModes() throws Exception {
  byte[] iv=nextIV();
  Cipher c1=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,iv,Cipher.ENCRYPT_MODE);
  Cipher c2=cipherFactory.buildCipher(encryptionOptions.cipher,encryptionOptions.key_alias,iv,Cipher.DECRYPT_MODE);
  Assert.assertFalse(c1 == c2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.serializers.TimestampSerializerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDateStringToTimestamp(){
  List<String> unparsedDates=new ArrayList<>();
  for (  String date : dates) {
    try {
      long millis=TimestampSerializer.dateStringToTimestamp(date);
    }
 catch (    MarshalException e) {
      unparsedDates.add(date);
    }
  }
  assertTrue("Unable to parse: " + unparsedDates,unparsedDates.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.DataResolverTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveDeletedCollection(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  builder.addComplexDeletion(m,new DeletionTime(ts[0] - 1,nowInSec));
  builder.addCell(mapCell(0,0,ts[0]));
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[1] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  try (PartitionIterator data=resolver.resolve()){
    assertFalse(data.hasNext());
  }
   MessageOut<Mutation> msg;
  msg=getSentMessage(peer1);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Collections.emptySet(),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
  Assert.assertNull(messageRecorder.sent.get(peer2));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveDeleted(){
  DataResolver resolver=new DataResolver(ks,command,ConsistencyLevel.ALL,2);
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(new RowUpdateBuilder(cfm,nowInSec,0L,dk).clustering("1").add("one","A").buildUpdate())));
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,fullPartitionDelete(cfm,dk,1,nowInSec)));
  try (PartitionIterator data=resolver.resolve()){
    assertFalse(data.hasNext());
  }
   assertEquals(1,messageRecorder.sent.size());
  MessageOut msg=getSentMessage(peer1);
  assertRepairMetadata(msg);
  assertRepairContainsDeletions(msg,new DeletionTime(1,nowInSec));
  assertRepairContainsNoColumns(msg);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testResolveWithBothEmpty(){
  DataResolver resolver=new DataResolver(ks,command,ConsistencyLevel.ALL,2);
  resolver.preprocess(readResponseMessage(peer(),EmptyIterators.unfilteredPartition(cfm,false)));
  resolver.preprocess(readResponseMessage(peer(),EmptyIterators.unfilteredPartition(cfm,false)));
  try (PartitionIterator data=resolver.resolve()){
    assertFalse(data.hasNext());
  }
   assertTrue(messageRecorder.sent.isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveDisjointMultipleRowsWithRangeTombstones(){
  DataResolver resolver=new DataResolver(ks,command,ConsistencyLevel.ALL,4);
  RangeTombstone tombstone1=tombstone("1","11",1,nowInSec);
  RangeTombstone tombstone2=tombstone("3","31",1,nowInSec);
  PartitionUpdate update=new RowUpdateBuilder(cfm,nowInSec,1L,dk).addRangeTombstone(tombstone1).addRangeTombstone(tombstone2).buildUpdate();
  InetAddress peer1=peer();
  UnfilteredPartitionIterator iter1=iter(new RowUpdateBuilder(cfm,nowInSec,1L,dk).addRangeTombstone(tombstone1).addRangeTombstone(tombstone2).buildUpdate());
  resolver.preprocess(readResponseMessage(peer1,iter1));
  InetAddress peer2=peer();
  UnfilteredPartitionIterator iter2=iter(new RowUpdateBuilder(cfm,nowInSec,0L,dk).clustering("0").add("c1","v0").buildUpdate());
  resolver.preprocess(readResponseMessage(peer2,iter2));
  InetAddress peer3=peer();
  UnfilteredPartitionIterator iter3=iter(new RowUpdateBuilder(cfm,nowInSec,0L,dk).clustering("10").add("c2","v1").buildUpdate());
  resolver.preprocess(readResponseMessage(peer3,iter3));
  InetAddress peer4=peer();
  UnfilteredPartitionIterator iter4=iter(new RowUpdateBuilder(cfm,nowInSec,2L,dk).clustering("3").add("one","A").buildUpdate());
  resolver.preprocess(readResponseMessage(peer4,iter4));
  try (PartitionIterator data=resolver.resolve()){
    try (RowIterator rows=data.next()){
      Row row=rows.next();
      assertClustering(cfm,row,"0");
      assertColumns(row,"c1");
      assertColumn(cfm,row,"c1","v0",0);
      row=rows.next();
      assertClustering(cfm,row,"3");
      assertColumns(row,"one");
      assertColumn(cfm,row,"one","A",2);
      assertFalse(rows.hasNext());
    }
   }
   assertEquals(4,messageRecorder.sent.size());
  MessageOut msg=getSentMessage(peer1);
  assertRepairMetadata(msg);
  assertRepairContainsNoDeletions(msg);
  assertRepairContainsColumn(msg,"0","c1","v0",0);
  assertRepairContainsColumn(msg,"3","one","A",2);
  msg=getSentMessage(peer2);
  assertRepairMetadata(msg);
  assertRepairContainsDeletions(msg,null,tombstone1,tombstone2);
  assertRepairContainsColumn(msg,"3","one","A",2);
  msg=getSentMessage(peer3);
  assertRepairMetadata(msg);
  assertRepairContainsDeletions(msg,null,tombstone1,tombstone2);
  assertRepairContainsColumn(msg,"0","c1","v0",0);
  assertRepairContainsColumn(msg,"3","one","A",2);
  msg=getSentMessage(peer4);
  assertRepairMetadata(msg);
  assertRepairContainsDeletions(msg,null,tombstone1,tombstone2);
  assertRepairContainsColumn(msg,"0","c1","v0",0);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveDisjointMultipleRows() throws UnknownHostException {
  DataResolver resolver=new DataResolver(ks,command,ConsistencyLevel.ALL,2);
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(new RowUpdateBuilder(cfm,nowInSec,0L,dk).clustering("1").add("c1","v1").buildUpdate())));
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(new RowUpdateBuilder(cfm,nowInSec,1L,dk).clustering("2").add("c2","v2").buildUpdate())));
  try (PartitionIterator data=resolver.resolve()){
    try (RowIterator rows=data.next()){
      Row row=rows.next();
      assertClustering(cfm,row,"1");
      assertColumns(row,"c1");
      assertColumn(cfm,row,"c1","v1",0);
      row=rows.next();
      assertClustering(cfm,row,"2");
      assertColumns(row,"c2");
      assertColumn(cfm,row,"c2","v2",1);
      assertFalse(rows.hasNext());
      assertFalse(data.hasNext());
    }
   }
   assertEquals(2,messageRecorder.sent.size());
  MessageOut msg=getSentMessage(peer1);
  assertRepairMetadata(msg);
  assertRepairContainsNoDeletions(msg);
  assertRepairContainsColumn(msg,"2","c2","v2",1);
  msg=getSentMessage(peer2);
  assertRepairMetadata(msg);
  assertRepairContainsNoDeletions(msg);
  assertRepairContainsColumn(msg,"1","c1","v1",0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveNewCollection(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[0] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  Cell expectedCell=mapCell(0,0,ts[0]);
  builder.addCell(expectedCell);
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.emptyUpdate(cfm2,dk))));
  try (PartitionIterator data=resolver.resolve();RowIterator rows=Iterators.getOnlyElement(data)){
    Row row=Iterators.getOnlyElement(rows);
    assertColumns(row,"m");
    ComplexColumnData cd=row.getComplexColumnData(m);
    assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  }
   Assert.assertNull(messageRecorder.sent.get(peer1));
  MessageOut<Mutation> msg;
  msg=getSentMessage(peer2);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Sets.newHashSet(expectedCell),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveComplexDelete(){
  ReadCommand cmd=Util.cmd(cfs2,dk).withNowInSeconds(nowInSec).build();
  DataResolver resolver=new DataResolver(ks,cmd,ConsistencyLevel.ALL,2);
  long[] ts={100,200};
  Row.Builder builder=BTreeRow.unsortedBuilder(nowInSec);
  builder.newRow(Clustering.EMPTY);
  builder.addComplexDeletion(m,new DeletionTime(ts[0] - 1,nowInSec));
  builder.addCell(mapCell(0,0,ts[0]));
  InetAddress peer1=peer();
  resolver.preprocess(readResponseMessage(peer1,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  builder.newRow(Clustering.EMPTY);
  DeletionTime expectedCmplxDelete=new DeletionTime(ts[1] - 1,nowInSec);
  builder.addComplexDeletion(m,expectedCmplxDelete);
  Cell expectedCell=mapCell(1,1,ts[1]);
  builder.addCell(expectedCell);
  InetAddress peer2=peer();
  resolver.preprocess(readResponseMessage(peer2,iter(PartitionUpdate.singleRowUpdate(cfm2,dk,builder.build())),cmd));
  try (PartitionIterator data=resolver.resolve();RowIterator rows=Iterators.getOnlyElement(data)){
    Row row=Iterators.getOnlyElement(rows);
    assertColumns(row,"m");
    Assert.assertNull(row.getCell(m,CellPath.create(bb(0))));
    Assert.assertNotNull(row.getCell(m,CellPath.create(bb(1))));
  }
   MessageOut<Mutation> msg;
  msg=getSentMessage(peer1);
  Iterator<Row> rowIter=msg.payload.getPartitionUpdate(cfm2.cfId).iterator();
  assertTrue(rowIter.hasNext());
  Row row=rowIter.next();
  assertFalse(rowIter.hasNext());
  ComplexColumnData cd=row.getComplexColumnData(m);
  assertEquals(Collections.singleton(expectedCell),Sets.newHashSet(cd));
  assertEquals(expectedCmplxDelete,cd.complexDeletion());
  Assert.assertNull(messageRecorder.sent.get(peer2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.LeaveAndBootstrapTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateJumpToNormal() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,6);
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(2))));
  assertTrue(tmd.isLeaving(hosts.get(2)));
  assertEquals(endpointTokens.get(2),tmd.getToken(hosts.get(2)));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(2))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(2))));
  assertTrue(tmd.getLeavingEndpoints().isEmpty());
  assertEquals(keyTokens.get(2),tmd.getToken(hosts.get(2)));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(keyTokens.get(2))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.left(Collections.singleton(keyTokens.get(2)),Gossiper.computeExpireTime()));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(4))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(4))));
  assertTrue(tmd.getBootstrapTokens().isEmpty());
  assertTrue(tmd.getLeavingEndpoints().isEmpty());
  assertEquals(keyTokens.get(4),tmd.getToken(hosts.get(2)));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test pending ranges and write endpoints when multiple nodes are on the move
 * simultaneously
 */
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] LEAVING=new int[]{6,8,9};
  for (  int leaving : LEAVING)   ss.onChange(hosts.get(leaving),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(leaving))));
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  Collection<InetAddress> endpoints=null;
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("LeaveAndBootstrapTestKeyspace" + i,getStrategy("LeaveAndBootstrapTestKeyspace" + i,tmd));
  }
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(KEYSPACE1,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE1).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2","127.0.1.1","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.1.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.put(KEYSPACE4,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.2","127.0.0.1","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.1","127.0.0.2","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.2","127.0.0.1","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE4).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.1","127.0.0.2","127.0.0.3"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(7,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(6,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
  ss.onChange(hosts.get(LEAVING[0]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[0])),Gossiper.computeExpireTime()));
  ss.onChange(hosts.get(LEAVING[2]),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(LEAVING[2])),Gossiper.computeExpireTime()));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(5))));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE1).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE2).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("15")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("25")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.2"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.7","127.0.0.10","127.0.0.4"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE3).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("35")).removeAll(makeAddrs("127.0.0.7","127.0.0.8"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("45")).removeAll(makeAddrs("127.0.0.7","127.0.1.2","127.0.0.1"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("55")).removeAll(makeAddrs("127.0.0.2","127.0.0.7"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("65")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("75")).removeAll(makeAddrs("127.0.0.10"));
  expectedEndpoints.get(KEYSPACE4).get(new BigIntegerToken("85")).removeAll(makeAddrs("127.0.0.10"));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (int i=0; i < keyTokens.size(); i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(keyTokens.get(i)).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; ++i) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(boot2));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
    assertTrue(endpoints.contains(hosts.get(2)));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateJumpToLeft() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,7);
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(2)),Gossiper.computeExpireTime()));
  assertFalse(tmd.isMember(hosts.get(2)));
  Gossiper.instance.injectApplicationState(hosts.get(3),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(1))));
  ss.onChange(hosts.get(3),ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(1))));
  assertFalse(tmd.isMember(hosts.get(3)));
  assertEquals(1,tmd.getBootstrapTokens().size());
  assertEquals(hosts.get(3),tmd.getBootstrapTokens().get(keyTokens.get(1)));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(1))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.left(Collections.singleton(keyTokens.get(1)),Gossiper.computeExpireTime()));
  assertTrue(tmd.getBootstrapTokens().size() == 0);
  assertFalse(tmd.isMember(hosts.get(2)));
  assertFalse(tmd.isLeaving(hosts.get(2)));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether write endpoints is correct when the node is leaving. Uses
 * StorageService.onChange and does not manipulate token metadata directly.
 */
@Test public void newTestWriteEndpointsDuringLeave() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=6;
  final int LEAVING_NODE=3;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  Map<Token,List<InetAddress>> expectedEndpoints=new HashMap<Token,List<InetAddress>>();
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    for (    Token token : keyTokens) {
      List<InetAddress> endpoints=new ArrayList<InetAddress>();
      Iterator<Token> tokenIter=TokenMetadata.ringIterator(tmd.sortedTokens(),token,false);
      while (tokenIter.hasNext()) {
        endpoints.add(tmd.getEndpoint(tokenIter.next()));
      }
      expectedEndpoints.put(token,endpoints);
    }
  }
  ss.onChange(hosts.get(LEAVING_NODE),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(LEAVING_NODE))));
  assertTrue(tmd.isLeaving(hosts.get(LEAVING_NODE)));
  Thread.sleep(100);
  PendingRangeCalculatorService.instance.blockUntilFinished();
  AbstractReplicationStrategy strategy;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    for (    Token token : keyTokens) {
      int replicationFactor=strategy.getReplicationFactor();
      HashSet<InetAddress> actual=new HashSet<InetAddress>(tmd.getWriteEndpoints(token,keyspaceName,strategy.calculateNaturalEndpoints(token,tmd.cloneOnlyTokenMap())));
      HashSet<InetAddress> expected=new HashSet<InetAddress>();
      for (int i=0; i < replicationFactor; i++) {
        expected.add(expectedEndpoints.get(token).get(i));
      }
      if (expected.contains(hosts.get(LEAVING_NODE)))       expected.add(expectedEndpoints.get(token).get(replicationFactor));
      assertEquals("mismatched endpoint sets",expected,actual);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateJumpToBootstrap() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,7);
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(endpointTokens.get(2))));
  assertTrue(tmd.isMember(hosts.get(2)));
  assertTrue(tmd.isLeaving(hosts.get(2)));
  assertTrue(tmd.getBootstrapTokens().isEmpty());
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(4))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(4))));
  assertFalse(tmd.isMember(hosts.get(2)));
  assertFalse(tmd.isLeaving(hosts.get(2)));
  assertEquals(hosts.get(2),tmd.getBootstrapTokens().get(keyTokens.get(4)));
  Gossiper.instance.injectApplicationState(hosts.get(3),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(1))));
  ss.onChange(hosts.get(3),ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(1))));
  assertFalse(tmd.isMember(hosts.get(3)));
  assertFalse(tmd.isLeaving(hosts.get(3)));
  assertEquals(hosts.get(2),tmd.getBootstrapTokens().get(keyTokens.get(4)));
  assertEquals(hosts.get(3),tmd.getBootstrapTokens().get(keyTokens.get(1)));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(3))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(3))));
  assertFalse(tmd.isMember(hosts.get(2)));
  assertFalse(tmd.isLeaving(hosts.get(2)));
  assertEquals(hosts.get(2),tmd.getBootstrapTokens().get(keyTokens.get(3)));
  assertNull(tmd.getBootstrapTokens().get(keyTokens.get(4)));
  assertEquals(hosts.get(3),tmd.getBootstrapTokens().get(keyTokens.get(1)));
  Gossiper.instance.injectApplicationState(hosts.get(3),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(2))));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(3))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(3))));
  ss.onChange(hosts.get(3),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(keyTokens.get(2))));
  assertTrue(tmd.isMember(hosts.get(2)));
  assertFalse(tmd.isLeaving(hosts.get(2)));
  assertEquals(keyTokens.get(3),tmd.getToken(hosts.get(2)));
  assertTrue(tmd.isMember(hosts.get(3)));
  assertFalse(tmd.isLeaving(hosts.get(3)));
  assertEquals(keyTokens.get(2),tmd.getToken(hosts.get(3)));
  assertTrue(tmd.getBootstrapTokens().isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the system.peers table is not updated after a node has been removed. (See CASSANDRA-6053)
 */
@Test public void testStateChangeOnRemovedNode() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<>();
  List<InetAddress> hosts=new ArrayList<>();
  Util.createInitialRing(ss,partitioner,endpointTokens,new ArrayList<Token>(),hosts,new ArrayList<UUID>(),2);
  InetAddress toRemove=hosts.get(1);
  SystemKeyspace.updatePeerInfo(toRemove,"data_center","dc42");
  SystemKeyspace.updatePeerInfo(toRemove,"rack","rack42");
  assertEquals("rack42",SystemKeyspace.loadDcRackInfo().get(toRemove).get("rack"));
  Gossiper.instance.injectApplicationState(toRemove,ApplicationState.STATUS,valueFactory.left(Collections.singleton(endpointTokens.get(1)),Gossiper.computeExpireTime()));
  assertTrue(Gossiper.instance.isDeadState(Gossiper.instance.getEndpointStateForEndpoint(hosts.get(1))));
  ss.onChange(hosts.get(1),ApplicationState.RACK,valueFactory.rack("rack9999"));
  assertEquals("rack42",SystemKeyspace.loadDcRackInfo().get(toRemove).get("rack"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateJumpToLeaving() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  TokenMetadata tmd=ss.getTokenMetadata();
  tmd.clearUnsafe();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,6);
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(0))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(keyTokens.get(0))));
  assertEquals(keyTokens.get(0),tmd.getToken(hosts.get(2)));
  assertTrue(tmd.isLeaving(hosts.get(2)));
  assertNull(tmd.getEndpoint(endpointTokens.get(2)));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(1))));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(1))));
  assertFalse(tmd.isLeaving(hosts.get(2)));
  assertEquals(1,tmd.getBootstrapTokens().size());
  assertEquals(hosts.get(2),tmd.getBootstrapTokens().get(keyTokens.get(1)));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.leaving(Collections.singleton(keyTokens.get(1))));
  assertEquals(hosts.get(2),tmd.getEndpoint(keyTokens.get(1)));
  assertTrue(tmd.isLeaving(hosts.get(2)));
  assertTrue(tmd.getBootstrapTokens().isEmpty());
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.left(Collections.singleton(keyTokens.get(1)),Gossiper.computeExpireTime()));
  assertFalse(tmd.isMember(hosts.get(2)));
  assertFalse(tmd.isLeaving(hosts.get(2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.MoveTest </h4><pre class="type-7 type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void newTestWriteEndpointsDuringMove() throws Exception {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  final int MOVING_NODE=3;
  TokenMetadata tmd=ss.getTokenMetadata();
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  Map<Token,List<InetAddress>> expectedEndpoints=new HashMap<Token,List<InetAddress>>();
  for (  Token token : keyTokens) {
    List<InetAddress> endpoints=new ArrayList<InetAddress>();
    Iterator<Token> tokenIter=TokenMetadata.ringIterator(tmd.sortedTokens(),token,false);
    while (tokenIter.hasNext()) {
      endpoints.add(tmd.getEndpoint(tokenIter.next()));
    }
    expectedEndpoints.put(token,endpoints);
  }
  Token newToken=positionToken(MOVING_NODE);
  ss.onChange(hosts.get(MOVING_NODE),ApplicationState.STATUS,valueFactory.moving(newToken));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  assertTrue(tmd.isMoving(hosts.get(MOVING_NODE)));
  AbstractReplicationStrategy strategy;
  for (  String keyspaceName : Schema.instance.getNonSystemKeyspaces()) {
    strategy=getStrategy(keyspaceName,tmd);
    if (strategy instanceof NetworkTopologyStrategy)     continue;
    int numMoved=0;
    for (    Token token : keyTokens) {
      int replicationFactor=strategy.getReplicationFactor();
      HashSet<InetAddress> actual=new HashSet<InetAddress>(tmd.getWriteEndpoints(token,keyspaceName,strategy.calculateNaturalEndpoints(token,tmd.cloneOnlyTokenMap())));
      HashSet<InetAddress> expected=new HashSet<InetAddress>();
      for (int i=0; i < replicationFactor; i++) {
        expected.add(expectedEndpoints.get(token).get(i));
      }
      if (expected.size() == actual.size()) {
        assertEquals("mismatched endpoint sets",expected,actual);
      }
 else {
        expected.add(hosts.get(MOVING_NODE));
        assertEquals("mismatched endpoint sets",expected,actual);
        numMoved++;
      }
    }
    assertEquals("mismatched number of moved token",1,numMoved);
  }
  ss.onChange(hosts.get(MOVING_NODE),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newToken)));
}

</code></pre>

<br>
<pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimultaneousMove() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  final int RING_SIZE=10;
  TokenMetadata tmd=ss.getTokenMetadata();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,RING_SIZE);
  final int[] MOVING=new int[]{6,8,9};
  Map<Integer,Token> newTokens=new HashMap<Integer,Token>();
  for (  int movingIndex : MOVING) {
    Token newToken=positionToken(movingIndex);
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.moving(newToken));
    newTokens.put(movingIndex,newToken);
  }
  Collection<InetAddress> endpoints;
  tmd=tmd.cloneAfterAllSettled();
  ss.setTokenMetadataUnsafe(tmd);
  InetAddress boot1=InetAddress.getByName("127.0.1.1");
  Gossiper.instance.initializeNodeUnsafe(boot1,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot1,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(5))));
  ss.onChange(boot1,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(5))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  InetAddress boot2=InetAddress.getByName("127.0.1.2");
  Gossiper.instance.initializeNodeUnsafe(boot2,UUID.randomUUID(),1);
  Gossiper.instance.injectApplicationState(boot2,ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(keyTokens.get(7))));
  ss.onChange(boot2,ApplicationState.STATUS,valueFactory.bootstrapping(Collections.<Token>singleton(keyTokens.get(7))));
  PendingRangeCalculatorService.instance.blockUntilFinished();
  Map<String,AbstractReplicationStrategy> keyspaceStrategyMap=new HashMap<String,AbstractReplicationStrategy>();
  for (int i=1; i <= 4; i++) {
    keyspaceStrategyMap.put("MoveTestKeyspace" + i,getStrategy("MoveTestKeyspace" + i,tmd));
  }
  Multimap<InetAddress,Range<Token>> keyspace1ranges=keyspaceStrategyMap.get(Simple_RF1_KeyspaceName).getAddressRanges();
  Collection<Range<Token>> ranges1=keyspace1ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(1,collectionSize(ranges1));
  assertEquals(generateRange(97,0),ranges1.iterator().next());
  Collection<Range<Token>> ranges2=keyspace1ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(1,collectionSize(ranges2));
  assertEquals(generateRange(0,10),ranges2.iterator().next());
  Collection<Range<Token>> ranges3=keyspace1ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(1,collectionSize(ranges3));
  assertEquals(generateRange(10,20),ranges3.iterator().next());
  Collection<Range<Token>> ranges4=keyspace1ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(1,collectionSize(ranges4));
  assertEquals(generateRange(20,30),ranges4.iterator().next());
  Collection<Range<Token>> ranges5=keyspace1ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(1,collectionSize(ranges5));
  assertEquals(generateRange(30,40),ranges5.iterator().next());
  Collection<Range<Token>> ranges6=keyspace1ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(1,collectionSize(ranges6));
  assertEquals(generateRange(40,50),ranges6.iterator().next());
  Collection<Range<Token>> ranges7=keyspace1ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(1,collectionSize(ranges7));
  assertEquals(generateRange(50,67),ranges7.iterator().next());
  Collection<Range<Token>> ranges8=keyspace1ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(1,collectionSize(ranges8));
  assertEquals(generateRange(67,70),ranges8.iterator().next());
  Collection<Range<Token>> ranges9=keyspace1ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(1,collectionSize(ranges9));
  assertEquals(generateRange(70,87),ranges9.iterator().next());
  Collection<Range<Token>> ranges10=keyspace1ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(1,collectionSize(ranges10));
  assertEquals(generateRange(87,97),ranges10.iterator().next());
  Multimap<InetAddress,Range<Token>> keyspace3ranges=keyspaceStrategyMap.get(KEYSPACE3).getAddressRanges();
  ranges1=keyspace3ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),5);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,50,67,87,97,67,70)));
  ranges2=keyspace3ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),5);
  assertTrue(ranges2.equals(generateRanges(97,0,70,87,87,97,0,10,67,70)));
  ranges3=keyspace3ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),5);
  assertTrue(ranges3.equals(generateRanges(97,0,70,87,87,97,0,10,10,20)));
  ranges4=keyspace3ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),5);
  assertTrue(ranges4.equals(generateRanges(97,0,20,30,87,97,0,10,10,20)));
  ranges5=keyspace3ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),5);
  assertTrue(ranges5.equals(generateRanges(97,0,30,40,20,30,0,10,10,20)));
  ranges6=keyspace3ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),5);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30,0,10,10,20)));
  ranges7=keyspace3ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),5);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67,20,30,10,20)));
  ranges8=keyspace3ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),5);
  assertTrue(ranges8.equals(generateRanges(40,50,30,40,50,67,20,30,67,70)));
  ranges9=keyspace3ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),5);
  assertTrue(ranges9.equals(generateRanges(40,50,70,87,30,40,50,67,67,70)));
  ranges10=keyspace3ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),5);
  assertTrue(ranges10.equals(generateRanges(40,50,70,87,50,67,87,97,67,70)));
  Multimap<InetAddress,Range<Token>> keyspace4ranges=keyspaceStrategyMap.get(Simple_RF3_KeyspaceName).getAddressRanges();
  ranges1=keyspace4ranges.get(InetAddress.getByName("127.0.0.1"));
  assertEquals(collectionSize(ranges1),3);
  assertTrue(ranges1.equals(generateRanges(97,0,70,87,87,97)));
  ranges2=keyspace4ranges.get(InetAddress.getByName("127.0.0.2"));
  assertEquals(collectionSize(ranges2),3);
  assertTrue(ranges2.equals(generateRanges(97,0,87,97,0,10)));
  ranges3=keyspace4ranges.get(InetAddress.getByName("127.0.0.3"));
  assertEquals(collectionSize(ranges3),3);
  assertTrue(ranges3.equals(generateRanges(97,0,0,10,10,20)));
  ranges4=keyspace4ranges.get(InetAddress.getByName("127.0.0.4"));
  assertEquals(collectionSize(ranges4),3);
  assertTrue(ranges4.equals(generateRanges(20,30,0,10,10,20)));
  ranges5=keyspace4ranges.get(InetAddress.getByName("127.0.0.5"));
  assertEquals(collectionSize(ranges5),3);
  assertTrue(ranges5.equals(generateRanges(30,40,20,30,10,20)));
  ranges6=keyspace4ranges.get(InetAddress.getByName("127.0.0.6"));
  assertEquals(collectionSize(ranges6),3);
  assertTrue(ranges6.equals(generateRanges(40,50,30,40,20,30)));
  ranges7=keyspace4ranges.get(InetAddress.getByName("127.0.0.7"));
  assertEquals(collectionSize(ranges7),3);
  assertTrue(ranges7.equals(generateRanges(40,50,30,40,50,67)));
  ranges8=keyspace4ranges.get(InetAddress.getByName("127.0.0.8"));
  assertEquals(collectionSize(ranges8),3);
  assertTrue(ranges8.equals(generateRanges(40,50,50,67,67,70)));
  ranges9=keyspace4ranges.get(InetAddress.getByName("127.0.0.9"));
  assertEquals(collectionSize(ranges9),3);
  assertTrue(ranges9.equals(generateRanges(70,87,50,67,67,70)));
  ranges10=keyspace4ranges.get(InetAddress.getByName("127.0.0.10"));
  assertEquals(collectionSize(ranges10),3);
  assertTrue(ranges10.equals(generateRanges(70,87,87,97,67,70)));
  Map<String,Multimap<Token,InetAddress>> expectedEndpoints=new HashMap<String,Multimap<Token,InetAddress>>();
  expectedEndpoints.put(Simple_RF1_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(Simple_RF1_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE2,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9"));
  expectedEndpoints.get(KEYSPACE2).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10"));
  expectedEndpoints.put(KEYSPACE3,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.1.2"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3"));
  expectedEndpoints.get(KEYSPACE3).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.put(Simple_RF3_KeyspaceName,HashMultimap.<Token,InetAddress>create());
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("5"),makeAddrs("127.0.0.2","127.0.0.3","127.0.0.4"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("15"),makeAddrs("127.0.0.3","127.0.0.4","127.0.0.5"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("25"),makeAddrs("127.0.0.4","127.0.0.5","127.0.0.6"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("35"),makeAddrs("127.0.0.5","127.0.0.6","127.0.0.7","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("45"),makeAddrs("127.0.0.6","127.0.0.7","127.0.0.8","127.0.1.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("55"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("65"),makeAddrs("127.0.0.7","127.0.0.8","127.0.0.9","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("75"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1","127.0.1.2"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("85"),makeAddrs("127.0.0.9","127.0.0.10","127.0.0.1"));
  expectedEndpoints.get(Simple_RF3_KeyspaceName).putAll(new BigIntegerToken("95"),makeAddrs("127.0.0.10","127.0.0.1","127.0.0.2"));
  for (  Map.Entry<String,AbstractReplicationStrategy> keyspaceStrategy : keyspaceStrategyMap.entrySet()) {
    String keyspaceName=keyspaceStrategy.getKey();
    AbstractReplicationStrategy strategy=keyspaceStrategy.getValue();
    for (    Token token : keyTokens) {
      endpoints=tmd.getWriteEndpoints(token,keyspaceName,strategy.getNaturalEndpoints(token));
      assertEquals(expectedEndpoints.get(keyspaceName).get(token).size(),endpoints.size());
      assertTrue(expectedEndpoints.get(keyspaceName).get(token).containsAll(endpoints));
    }
    if (strategy.getReplicationFactor() != 3)     continue;
    for (int i=0; i < 3; i++) {
      endpoints=tmd.getWriteEndpoints(keyTokens.get(i),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(i)));
      assertEquals(3,endpoints.size());
      assertTrue(endpoints.contains(hosts.get(i + 1)));
      assertTrue(endpoints.contains(hosts.get(i + 2)));
      assertTrue(endpoints.contains(hosts.get(i + 3)));
    }
    endpoints=tmd.getWriteEndpoints(keyTokens.get(3),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(3)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(4)));
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(4),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(4)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(5)));
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(boot1));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(5),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(5)));
    assertEquals(5,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot1));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(6),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(6)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(6)));
    assertTrue(endpoints.contains(hosts.get(7)));
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(7),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(7)));
    assertEquals(4,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(boot2));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(8),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(8)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(8)));
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    endpoints=tmd.getWriteEndpoints(keyTokens.get(9),keyspaceName,strategy.getNaturalEndpoints(keyTokens.get(9)));
    assertEquals(3,endpoints.size());
    assertTrue(endpoints.contains(hosts.get(9)));
    assertTrue(endpoints.contains(hosts.get(0)));
    assertTrue(endpoints.contains(hosts.get(1)));
  }
  for (  Integer movingIndex : MOVING) {
    ss.onChange(hosts.get(movingIndex),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newTokens.get(movingIndex))));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStateJumpToNormal() throws UnknownHostException {
  StorageService ss=StorageService.instance;
  TokenMetadata tmd=ss.getTokenMetadata();
  IPartitioner partitioner=RandomPartitioner.instance;
  VersionedValue.VersionedValueFactory valueFactory=new VersionedValue.VersionedValueFactory(partitioner);
  ArrayList<Token> endpointTokens=new ArrayList<Token>();
  ArrayList<Token> keyTokens=new ArrayList<Token>();
  List<InetAddress> hosts=new ArrayList<InetAddress>();
  List<UUID> hostIds=new ArrayList<UUID>();
  Util.createInitialRing(ss,partitioner,endpointTokens,keyTokens,hosts,hostIds,6);
  Token newToken=positionToken(7);
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.moving(newToken));
  assertTrue(tmd.isMoving(hosts.get(2)));
  assertEquals(endpointTokens.get(2),tmd.getToken(hosts.get(2)));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(newToken)));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newToken)));
  assertTrue(tmd.getMovingEndpoints().isEmpty());
  assertEquals(newToken,tmd.getToken(hosts.get(2)));
  newToken=positionToken(8);
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.moving(newToken));
  Gossiper.instance.injectApplicationState(hosts.get(2),ApplicationState.TOKENS,valueFactory.tokens(Collections.singleton(newToken)));
  ss.onChange(hosts.get(2),ApplicationState.STATUS,valueFactory.normal(Collections.singleton(newToken)));
  assertTrue(tmd.getBootstrapTokens().isEmpty());
  assertTrue(tmd.getMovingEndpoints().isEmpty());
  assertEquals(newToken,tmd.getToken(hosts.get(2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.QueryPagerTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void namesQueryTest() throws Exception {
  QueryPager pager=namesQuery("k0","c1","c5","c7","c8").getPager(null,Server.CURRENT_VERSION);
  assertFalse(pager.isExhausted());
  List<FilteredPartition> partition=query(pager,5,4);
  assertRow(partition.get(0),"k0","c1","c5","c7","c8");
  assertTrue(pager.isExhausted());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.RemoveTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveHostId() throws InterruptedException {
  final AtomicBoolean success=new AtomicBoolean(false);
  Thread remover=new Thread(){
    public void run(){
      try {
        ss.removeNode(removalId.toString());
      }
 catch (      Exception e) {
        System.err.println(e);
        e.printStackTrace();
        return;
      }
      success.set(true);
    }
  }
;
  remover.start();
  Thread.sleep(1000);
  assertTrue(tmd.isLeaving(removalhost));
  assertEquals(1,tmd.getLeavingEndpoints().size());
  for (  InetAddress host : hosts) {
    MessageOut msg=new MessageOut(host,MessagingService.Verb.REPLICATION_FINISHED,null,null,Collections.<String,byte[]>emptyMap());
    MessagingService.instance().sendRR(msg,FBUtilities.getBroadcastAddress());
  }
  remover.join();
  assertTrue(success.get());
  assertTrue(tmd.getLeavingEndpoints().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StartupChecksTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void compatibilityCheckIgnoresNonDbFiles() throws Exception {
  startupChecks=startupChecks.withTest(StartupChecks.checkSSTablesFormat);
  copyLegacyNonSSTableFiles(sstableDir);
  assertFalse(sstableDir.toFile().listFiles().length == 0);
  startupChecks.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.StorageServiceServerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRegularMode() throws ConfigurationException {
  SchemaLoader.mkdirs();
  SchemaLoader.cleanup();
  StorageService.instance.initServer(0);
  for (  String path : DatabaseDescriptor.getAllDataFileLocations()) {
    assertTrue(new File(path).exists());
  }
  StorageService.instance.stopClient();
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithVnodes() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  Multimap<InetAddress,Token> dc1=HashMultimap.create();
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("A"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("E"));
  dc1.put(InetAddress.getByName("127.0.0.1"),new StringToken("H"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("C"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("I"));
  dc1.put(InetAddress.getByName("127.0.0.2"),new StringToken("J"));
  metadata.updateNormalTokens(dc1);
  Multimap<InetAddress,Token> dc2=HashMultimap.create();
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("B"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("G"));
  dc2.put(InetAddress.getByName("127.0.0.4"),new StringToken("L"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("D"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("F"));
  dc2.put(InetAddress.getByName("127.0.0.5"),new StringToken("K"));
  metadata.updateNormalTokens(dc2);
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC1","1");
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertEquals(8,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("J"),new StringToken("K"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("K"),new StringToken("L"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("L"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("E"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("E"),new StringToken("F"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("F"),new StringToken("G"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("G"),new StringToken("H"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertEquals(4,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("H"),new StringToken("I"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("I"),new StringToken("J"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertEquals(4,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("F"),new StringToken("G"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("K"),new StringToken("L"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("L"),new StringToken("A"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertTrue(primaryRanges.size() == 8);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("E"),new StringToken("F"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("J"),new StringToken("K"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("E"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("G"),new StringToken("H"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("H"),new StringToken("I"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("I"),new StringToken("J"))));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithNetworkTopologyStrategy() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC1","1");
  configOptions.put("DC2","1");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertEquals(2,primaryRanges.size());
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testPrimaryRangeForEndpointWithinDCWithNetworkTopologyStrategyOneDCOnly() throws Exception {
  TokenMetadata metadata=StorageService.instance.getTokenMetadata();
  metadata.clearUnsafe();
  metadata.updateNormalToken(new StringToken("A"),InetAddress.getByName("127.0.0.1"));
  metadata.updateNormalToken(new StringToken("C"),InetAddress.getByName("127.0.0.2"));
  metadata.updateNormalToken(new StringToken("B"),InetAddress.getByName("127.0.0.4"));
  metadata.updateNormalToken(new StringToken("D"),InetAddress.getByName("127.0.0.5"));
  Map<String,String> configOptions=new HashMap<>();
  configOptions.put("DC2","2");
  configOptions.put(ReplicationParams.CLASS,"NetworkTopologyStrategy");
  Keyspace.clear("Keyspace1");
  KeyspaceMetadata meta=KeyspaceMetadata.create("Keyspace1",KeyspaceParams.create(false,configOptions));
  Schema.instance.setKeyspaceMetadata(meta);
  Collection<Range<Token>> primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.1"));
  assertTrue(primaryRanges.isEmpty());
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.2"));
  assertTrue(primaryRanges.isEmpty());
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.4"));
  assertTrue(primaryRanges.size() == 2);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("D"),new StringToken("A"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("A"),new StringToken("B"))));
  primaryRanges=StorageService.instance.getPrimaryRangeForEndpointWithinDC(meta.name,InetAddress.getByName("127.0.0.5"));
  assertTrue(primaryRanges.size() == 2);
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("C"),new StringToken("D"))));
  assertTrue(primaryRanges.contains(new Range<Token>(new StringToken("B"),new StringToken("C"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.service.pager.PagingStateTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSerializationBackwardCompatibility(){
  PagingState state=makeSomePagingState(Server.VERSION_3);
  String serializedState=ByteBufferUtil.bytesToHex(state.serialize(Server.VERSION_3));
  assertTrue(serializedState.startsWith("0007736f6d654b65790014000263310000040000002a0000056d79636f6c000000000a"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamTransferTaskTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScheduleTimeout() throws Exception {
  String ks=KEYSPACE1;
  String cf="Standard1";
  InetAddress peer=FBUtilities.getBroadcastAddress();
  StreamSession session=new StreamSession(peer,peer,null,0,true,false);
  ColumnFamilyStore cfs=Keyspace.open(ks).getColumnFamilyStore(cf);
  for (int i=0; i < 2; i++) {
    SchemaLoader.insertData(ks,cf,i,1);
    cfs.forceBlockingFlush();
  }
  StreamTransferTask task=new StreamTransferTask(session,cfs.metadata.cfId);
  for (  SSTableReader sstable : cfs.getLiveSSTables()) {
    List<Range<Token>> ranges=new ArrayList<>();
    ranges.add(new Range<>(sstable.first.getToken(),sstable.last.getToken()));
    task.addTransferFile(sstable.selfRef(),1,sstable.getPositionsForRanges(ranges),0);
  }
  assertEquals(2,task.getTotalNumberOfFiles());
  Future f=task.scheduleTimeout(0,0,TimeUnit.NANOSECONDS);
  f.get();
  f=task.scheduleTimeout(1,10,TimeUnit.MILLISECONDS);
  task.complete(1);
  try {
    f.get();
    Assert.assertTrue(false);
  }
 catch (  CancellationException ex) {
  }
  assertEquals(StreamSession.State.WAIT_COMPLETE,session.state());
  assertNull(task.scheduleTimeout(1,1,TimeUnit.SECONDS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.streaming.StreamingTransferTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to make sure RangeTombstones at column index boundary transferred correctly.
 */
@Test public void testTransferRangeTombstones() throws Exception {
  String ks=KEYSPACE1;
  String cfname="StandardInteger1";
  Keyspace keyspace=Keyspace.open(ks);
  ColumnFamilyStore cfs=keyspace.getColumnFamilyStore(cfname);
  ClusteringComparator comparator=cfs.getComparator();
  String key="key1";
  RowUpdateBuilder updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros(),key);
  updates.clustering(1).add("val",ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize() - 64])).build().apply();
  updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros(),key);
  updates.clustering(6).add("val",ByteBuffer.wrap(new byte[DatabaseDescriptor.getColumnIndexSize()])).build().apply();
  updates=new RowUpdateBuilder(cfs.metadata,FBUtilities.timestampMicros() + 1,key);
  updates.addRangeTombstone(Slice.make(comparator.make(5),comparator.make(7))).build().apply();
  cfs.forceBlockingFlush();
  SSTableReader sstable=cfs.getLiveSSTables().iterator().next();
  cfs.clearUnsafe();
  transferSSTables(sstable);
  assertEquals(1,cfs.getLiveSSTables().size());
  Row r=Util.getOnlyRow(Util.cmd(cfs).build());
  Assert.assertFalse(r.isEmpty());
  Assert.assertTrue(1 == Int32Type.instance.compose(r.clustering().get(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.MessagePayloadTest </h4><pre class="type-15 type-5 type-14 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessagePayloadVersion3() throws Throwable {
  QueryHandler queryHandler=(QueryHandler)cqlQueryHandlerField.get(null);
  cqlQueryHandlerField.set(null,new TestQueryHandler());
  try {
    requireNetwork();
    Assert.assertSame(TestQueryHandler.class,ClientState.getCQLQueryHandler().getClass());
    SimpleClient client=new SimpleClient(nativeAddr.getHostAddress(),nativePort,Server.VERSION_3);
    try {
      client.connect(false);
      Map<String,ByteBuffer> reqMap;
      QueryMessage queryMessage=new QueryMessage("CREATE TABLE " + KEYSPACE + ".atable (pk int PRIMARY KEY, v text)",QueryOptions.DEFAULT);
      PrepareMessage prepareMessage=new PrepareMessage("SELECT * FROM " + KEYSPACE + ".atable");
      reqMap=Collections.singletonMap("foo",bytes(42));
      responsePayload=Collections.singletonMap("bar",bytes(42));
      queryMessage.setCustomPayload(reqMap);
      try {
        client.execute(queryMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      queryMessage.setCustomPayload(null);
      client.execute(queryMessage);
      reqMap=Collections.singletonMap("foo",bytes(43));
      responsePayload=Collections.singletonMap("bar",bytes(43));
      prepareMessage.setCustomPayload(reqMap);
      try {
        client.execute(prepareMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      prepareMessage.setCustomPayload(null);
      ResultMessage.Prepared prepareResponse=(ResultMessage.Prepared)client.execute(prepareMessage);
      ExecuteMessage executeMessage=new ExecuteMessage(prepareResponse.statementId,QueryOptions.DEFAULT);
      reqMap=Collections.singletonMap("foo",bytes(44));
      responsePayload=Collections.singletonMap("bar",bytes(44));
      executeMessage.setCustomPayload(reqMap);
      try {
        client.execute(executeMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
      BatchMessage batchMessage=new BatchMessage(BatchStatement.Type.UNLOGGED,Collections.singletonList("INSERT INTO " + KEYSPACE + ".atable (pk,v) VALUES (1, 'foo')"),Collections.singletonList(Collections.<ByteBuffer>emptyList()),QueryOptions.DEFAULT);
      reqMap=Collections.singletonMap("foo",bytes(45));
      responsePayload=Collections.singletonMap("bar",bytes(45));
      batchMessage.setCustomPayload(reqMap);
      try {
        client.execute(batchMessage);
        Assert.fail();
      }
 catch (      RuntimeException e) {
        Assert.assertTrue(e.getCause() instanceof ProtocolException);
      }
    }
  finally {
      client.close();
    }
  }
  finally {
    cqlQueryHandlerField.set(null,queryHandler);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.transport.ProtocolErrorTest </h4><pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBodyLengthOverLimit() throws Exception {
  Frame.Decoder dec=new Frame.Decoder(null);
  List results=new ArrayList<>();
  byte[] frame=new byte[]{(byte)REQUEST.addToVersion(Server.CURRENT_VERSION),0x00,0x00,0x01,0x09,0x10,(byte)0x00,(byte)0x00,(byte)0x00};
  byte[] body=new byte[0x10000000];
  ByteBuf buf=Unpooled.wrappedBuffer(frame,body);
  try {
    dec.decode(null,buf,results);
    Assert.fail("Expected protocol error");
  }
 catch (  ErrorMessage.WrappedException e) {
    Assert.assertEquals(1,e.getStreamId());
    Assert.assertTrue(e.getMessage().contains("Request is too big"));
  }
}

</code></pre>

<br>
<pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidDirection() throws Exception {
  Frame.Decoder dec=new Frame.Decoder(null);
  List results=new ArrayList<>();
  byte[] frame=new byte[]{(byte)RESPONSE.addToVersion(Server.CURRENT_VERSION),0x00,0x00,0x01,0x09,0x00,0x00,0x00,0x21,0x00,0x00,0x00,0x1b,0x00,0x1b,0x53,0x45,0x4c,0x45,0x43,0x54,0x20,0x2a,0x20,0x46,0x52,0x4f,0x4d,0x20,0x73,0x79,0x73,0x74,0x65,0x6d,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x3b};
  ByteBuf buf=Unpooled.wrappedBuffer(frame);
  try {
    dec.decode(null,buf,results);
    Assert.fail("Expected protocol error");
  }
 catch (  ErrorMessage.WrappedException e) {
    Assert.assertEquals(1,e.getStreamId());
    Assert.assertTrue(e.getMessage().contains("Wrong protocol direction"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggerExecutorTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sameKeySameCfColumnFamilies() throws ConfigurationException, InvalidRequestException {
  CFMetaData metadata=makeCfMetaData("ks1","cf1",TriggerMetadata.create("test",SameKeySameCfTrigger.class.getName()));
  PartitionUpdate mutated=TriggerExecutor.instance.execute(makeCf(metadata,"k1","v1",null));
  RowIterator rowIterator=UnfilteredRowIterators.filter(mutated.unfilteredIterator(),FBUtilities.nowInSeconds());
  Iterator<Cell> cells=rowIterator.next().cells().iterator();
  assertEquals(bytes("trigger"),cells.next().value());
  assertTrue(!rowIterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.triggers.TriggersSchemaTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addTriggerToCf() throws Exception {
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName).copy();
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  cfm2.triggers(cfm2.getTriggers().with(td));
  MigrationManager.announceColumnFamilyUpdate(cfm2,false);
  CFMetaData cfm3=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm3.getTriggers().isEmpty());
  assertEquals(1,cfm3.getTriggers().size());
  assertEquals(td,cfm3.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNewCfWithTriggerToKs() throws Exception {
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  cfm1.triggers(cfm1.getTriggers().with(td));
  MigrationManager.announceNewColumnFamily(cfm1);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm2.getTriggers().isEmpty());
  assertEquals(1,cfm2.getTriggers().size());
  assertEquals(td,cfm2.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void removeTriggerFromCf() throws Exception {
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  cfm1.triggers(cfm1.getTriggers().with(td));
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName).copy();
  cfm2.triggers(cfm2.getTriggers().without(triggerName));
  MigrationManager.announceColumnFamilyUpdate(cfm2,false);
  CFMetaData cfm3=Schema.instance.getCFMetaData(ksName,cfName).copy();
  assertTrue(cfm3.getTriggers().isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void newKsContainsCfWithTrigger() throws Exception {
  TriggerMetadata td=TriggerMetadata.create(triggerName,triggerClass);
  CFMetaData cfm1=CFMetaData.compile(String.format("CREATE TABLE %s (k int PRIMARY KEY, v int)",cfName),ksName);
  cfm1.triggers(cfm1.getTriggers().with(td));
  KeyspaceMetadata ksm=KeyspaceMetadata.create(ksName,KeyspaceParams.simple(1),Tables.of(cfm1));
  MigrationManager.announceNewKeyspace(ksm);
  CFMetaData cfm2=Schema.instance.getCFMetaData(ksName,cfName);
  assertFalse(cfm2.getTriggers().isEmpty());
  assertEquals(1,cfm2.getTriggers().size());
  assertEquals(td,cfm2.getTriggers().get(triggerName).get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BTreeTest </h4><pre class="type-7 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearOnAbort(){
  Object[] btree=BTree.build(seq(2),noOp);
  Object[] copy=Arrays.copyOf(btree,btree.length);
  BTree.update(btree,CMP,seq(94),new AbortAfterX(90));
  assertArrayEquals(copy,btree);
  btree=BTree.update(btree,CMP,seq(94),noOp);
  assertTrue(BTree.isWellFormed(btree,CMP));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.BytesReadTrackerTest </h4><pre class="type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesRead() throws Exception {
  byte[] testData;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  try {
    out.writeBoolean(true);
    out.writeByte(0x1);
    out.writeChar('a');
    out.writeShort(1);
    out.writeInt(1);
    out.writeLong(1L);
    out.writeFloat(1.0f);
    out.writeDouble(1.0d);
    out.writeUTF("abc");
    testData=baos.toByteArray();
  }
  finally {
    out.close();
  }
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(testData));
  BytesReadTracker tracker=new BytesReadTracker(in);
  try {
    boolean bool=tracker.readBoolean();
    assertTrue(bool);
    assertEquals(1,tracker.getBytesRead());
    byte b=tracker.readByte();
    assertEquals(b,0x1);
    assertEquals(2,tracker.getBytesRead());
    char c=tracker.readChar();
    assertEquals('a',c);
    assertEquals(4,tracker.getBytesRead());
    short s=tracker.readShort();
    assertEquals(1,s);
    assertEquals((short)6,tracker.getBytesRead());
    int i=tracker.readInt();
    assertEquals(1,i);
    assertEquals(10,tracker.getBytesRead());
    long l=tracker.readLong();
    assertEquals(1L,l);
    assertEquals(18,tracker.getBytesRead());
    float f=tracker.readFloat();
    assertEquals(1.0f,f,0);
    assertEquals(22,tracker.getBytesRead());
    double d=tracker.readDouble();
    assertEquals(1.0d,d,0);
    assertEquals(30,tracker.getBytesRead());
    String str=tracker.readUTF();
    assertEquals("abc",str);
    assertEquals(35,tracker.getBytesRead());
    assertEquals(testData.length,tracker.getBytesRead());
  }
  finally {
    in.close();
  }
  tracker.reset(0);
  assertEquals(0,tracker.getBytesRead());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.CassandraVersionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testParsing(){
  CassandraVersion version;
  version=new CassandraVersion("1.2.3");
  assertTrue(version.major == 1 && version.minor == 2 && version.patch == 3);
  version=new CassandraVersion("1.2.3-foo.2+Bar");
  assertTrue(version.major == 1 && version.minor == 2 && version.patch == 3);
  version=new CassandraVersion("1.2.3.456");
  assertTrue(version.major == 1 && version.minor == 2 && version.patch == 3);
  version=new CassandraVersion("3.2");
  assertTrue(version.major == 3 && version.minor == 2 && version.patch == 0);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSnapshot(){
  CassandraVersion prev, next;
  prev=new CassandraVersion("2.1.5");
  next=new CassandraVersion("2.1.5.123");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("2.2.0-beta1-SNAPSHOT");
  assertTrue(prev.compareTo(next) < 0);
  prev=new CassandraVersion("2.2.0-beta1");
  next=new CassandraVersion("2.2.0-rc1-SNAPSHOT");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("2.2.0");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("3.1");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("3.1.1");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("3.2-rc1-SNAPSHOT");
  assertTrue(prev.compareTo(next) < 0);
  prev=next;
  next=new CassandraVersion("3.2");
  assertTrue(prev.compareTo(next) < 0);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testComparison(){
  CassandraVersion v1, v2;
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.4");
  assertTrue(v1.compareTo(v2) == -1);
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.3");
  assertTrue(v1.compareTo(v2) == 0);
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("2.0.0");
  assertTrue(v1.compareTo(v2) == -1);
  assertTrue(v2.compareTo(v1) == 1);
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.3-alpha");
  assertTrue(v1.compareTo(v2) == 1);
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.3+foo");
  assertTrue(v1.compareTo(v2) == -1);
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.3-alpha+foo");
  assertTrue(v1.compareTo(v2) == 1);
  v1=new CassandraVersion("1.2.3-alpha+1");
  v2=new CassandraVersion("1.2.3-alpha+2");
  assertTrue(v1.compareTo(v2) == -1);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsSupportedBy(){
  CassandraVersion v1, v2;
  v1=new CassandraVersion("3.0.2");
  assertTrue(v1.isSupportedBy(v1));
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.2.4");
  assertTrue(v1.isSupportedBy(v2));
  assertTrue(!v2.isSupportedBy(v1));
  v1=new CassandraVersion("1.2.3");
  v2=new CassandraVersion("1.3.3");
  assertTrue(v1.isSupportedBy(v2));
  assertTrue(!v2.isSupportedBy(v1));
  v1=new CassandraVersion("2.2.3");
  v2=new CassandraVersion("1.3.3");
  assertTrue(!v1.isSupportedBy(v2));
  assertTrue(!v2.isSupportedBy(v1));
  v1=new CassandraVersion("3.1.0");
  v2=new CassandraVersion("3.0.1");
  assertTrue(!v1.isSupportedBy(v2));
  assertTrue(v2.isSupportedBy(v1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.CoalescingStrategiesTest </h4><pre class="type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMovingAverageCoalescingStrategy() throws Exception {
  cs=newStrategy("org.apache.cassandra.utils.CoalescingStrategies$MovingAverageCoalescingStrategy",200);
  add(201);
  add(401);
  cs.coalesce(input,output,128);
  assertEquals(2,output.size());
  assertNull(parker.parks.poll());
  clear();
  runBlocker(queueParked);
  add(601);
  add(801);
  release();
  assertEquals(2,output.size());
  assertNull(parker.parks.poll());
  clear();
  runBlocker(queueParked);
  add(0);
  release();
  assertEquals(1,output.size());
  assertNull(parker.parks.poll());
  clear();
  add(0);
  cs.coalesce(input,output,128);
  assertEquals(1,output.size());
  assertNull(parker.parks.poll());
  clear();
  for (long ii=0; ii < 128; ii++)   add(ii * 1000);
  cs.coalesce(input,output,128);
  assertEquals(output.size(),128);
  assertTrue(parker.parks.isEmpty());
  clear();
  runBlocker(queueParked);
  add(129 * 1000);
  release();
  assertTrue(parker.parks.isEmpty());
  clear();
  cs=newStrategy("MOVINGAVERAGE",200);
  for (long ii=0; ii < 128; ii++)   add(ii * 99);
  cs.coalesce(input,output,128);
  assertEquals(output.size(),128);
  assertTrue(parker.parks.isEmpty());
  clear();
  runBlocker(queueParked);
  add(128 * 99);
  add(129 * 99);
  release();
  assertEquals(2,output.size());
  assertEquals(toNanos(198),parker.parks.poll().longValue());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void parkLoop() throws Exception {
  final Thread current=Thread.currentThread();
  final Semaphore helperReady=new Semaphore(0);
  final Semaphore helperGo=new Semaphore(0);
  new Thread(){
    @Override public void run(){
      try {
        helperReady.release();
        helperGo.acquire();
        Thread.sleep(50);
        LockSupport.unpark(current);
      }
 catch (      Exception e) {
        e.printStackTrace();
        logger.error("Error",e);
        System.exit(-1);
      }
    }
  }
.start();
  long start=System.nanoTime();
  helperGo.release();
  long parkNanos=TimeUnit.MILLISECONDS.toNanos(500);
  CoalescingStrategies.parkLoop(parkNanos);
  long delta=System.nanoTime() - start;
  assertTrue(delta >= (parkNanos - (parkNanos / 16)));
}

</code></pre>

<br>
<pre class="type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeHorizonStrategy() throws Exception {
  cs=newStrategy("TIMEHORIZON",200);
  add(201);
  add(401);
  cs.coalesce(input,output,128);
  assertEquals(2,output.size());
  assertNull(parker.parks.poll());
  clear();
  runBlocker(queueParked);
  add(601);
  add(801);
  release();
  assertEquals(2,output.size());
  assertNull(parker.parks.poll());
  clear();
  runBlocker(queueParked);
  add(0);
  release();
  assertEquals(1,output.size());
  assertNull(parker.parks.poll());
  clear();
  add(0);
  cs.coalesce(input,output,128);
  assertEquals(1,output.size());
  assertNull(parker.parks.poll());
  clear();
  for (long ii=0; ii < 128; ii++)   add(ii * 1000);
  cs.coalesce(input,output,128);
  assertEquals(output.size(),128);
  assertTrue(parker.parks.isEmpty());
  clear();
  runBlocker(queueParked);
  add(129 * 1000);
  release();
  assertTrue(parker.parks.isEmpty());
  clear();
  cs=newStrategy("TIMEHORIZON",200);
  primeTimeHorizonAverage(99);
  clear();
  runBlocker(queueParked);
  add(100000 * 99);
  queueRelease.release();
  parker.parked.acquire();
  add(100001 * 99);
  parker.permits.release();
  fut.get();
  assertEquals(2,output.size());
  assertEquals(toNanos(198),parker.parks.poll().longValue());
  clear();
  add(Integer.MAX_VALUE);
  cs.coalesce(input,output,128);
  assertEquals(1,output.size());
  assertTrue(parker.parks.isEmpty());
  clear();
  add(0);
  cs.coalesce(input,output,128);
  assertEquals(1,output.size());
  assertTrue(parker.parks.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.JVMStabilityInspectorTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void fileHandleTest(){
  KillerForTests killerForTests=new KillerForTests();
  JVMStabilityInspector.Killer originalKiller=JVMStabilityInspector.replaceKiller(killerForTests);
  try {
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new SocketException("Should not fail"));
    assertFalse(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new FileNotFoundException("Also should not fail"));
    assertFalse(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new SocketException("Too many open files"));
    assertTrue(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectCommitLogThrowable(new FileNotFoundException("Too many open files"));
    assertTrue(killerForTests.wasKilled());
  }
  finally {
    JVMStabilityInspector.replaceKiller(originalKiller);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testKill() throws Exception {
  KillerForTests killerForTests=new KillerForTests();
  JVMStabilityInspector.Killer originalKiller=JVMStabilityInspector.replaceKiller(killerForTests);
  Config.DiskFailurePolicy oldPolicy=DatabaseDescriptor.getDiskFailurePolicy();
  Config.CommitFailurePolicy oldCommitPolicy=DatabaseDescriptor.getCommitFailurePolicy();
  try {
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new IOException());
    assertFalse(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new OutOfMemoryError());
    assertTrue(killerForTests.wasKilled());
    DatabaseDescriptor.setDiskFailurePolicy(Config.DiskFailurePolicy.die);
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new FSReadError(new IOException(),"blah"));
    assertTrue(killerForTests.wasKilled());
    DatabaseDescriptor.setCommitFailurePolicy(Config.CommitFailurePolicy.die);
    killerForTests.reset();
    JVMStabilityInspector.inspectCommitLogThrowable(new Throwable());
    assertTrue(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new Exception(new IOException()));
    assertFalse(killerForTests.wasKilled());
    killerForTests.reset();
    JVMStabilityInspector.inspectThrowable(new Exception(new OutOfMemoryError()));
    assertTrue(killerForTests.wasKilled());
  }
  finally {
    JVMStabilityInspector.replaceKiller(originalKiller);
    DatabaseDescriptor.setDiskFailurePolicy(oldPolicy);
    DatabaseDescriptor.setCommitFailurePolicy(oldCommitPolicy);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.LongBTreeTest </h4><pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * TEST MUTATION 
 */
@Test public void testOversizedMiddleInsert(){
  TreeSet<Integer> canon=new TreeSet<>();
  for (int i=0; i < 10000000; i++)   canon.add(i);
  Object[] btree=BTree.build(Arrays.asList(Integer.MIN_VALUE,Integer.MAX_VALUE),UpdateFunction.noOp());
  btree=BTree.update(btree,naturalOrder(),canon,UpdateFunction.<Integer>noOp());
  canon.add(Integer.MIN_VALUE);
  canon.add(Integer.MAX_VALUE);
  assertTrue(BTree.isWellFormed(btree,naturalOrder()));
  testEqual("Oversize",BTree.iterator(btree),canon.iterator());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreeTest </h4><pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifference(){
  int maxsize=16;
  mt.maxsize(maxsize);
  MerkleTree mt2=new MerkleTree(partitioner,fullRange(),RECOMMENDED_DEPTH,maxsize);
  mt.init();
  mt2.init();
  for (  TreeRange range : mt.invalids())   range.addAll(new HIterator(range.right));
  for (  TreeRange range : mt2.invalids())   range.addAll(new HIterator(range.right));
  TreeRange leftmost=null;
  TreeRange middle=null;
  mt.maxsize(maxsize + 2);
  Iterator<TreeRange> ranges=mt.invalids();
  leftmost=ranges.next();
  mt.split(leftmost.right);
  middle=mt.get(leftmost.right);
  middle.hash("arbitrary!".getBytes());
  mt.get(partitioner.midpoint(leftmost.left,leftmost.right)).hash("even more arbitrary!".getBytes());
  List<TreeRange> diffs=MerkleTree.difference(mt,mt2);
  assertEquals(diffs + " contains wrong number of differences:",1,diffs.size());
  assertTrue(diffs.contains(new Range<>(leftmost.left,middle.right)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitLimitDepth(){
  mt=new MerkleTree(partitioner,fullRange(),(byte)2,Integer.MAX_VALUE);
  assertTrue(mt.split(tok(4)));
  assertTrue(mt.split(tok(2)));
  assertEquals(3,mt.size());
  assertFalse(mt.split(tok(1)));
  assertEquals(3,mt.size());
  assertEquals(new Range<>(tok(4),tok(-1)),mt.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(2)),mt.get(tok(2)));
  assertEquals(new Range<>(tok(2),tok(4)),mt.get(tok(4)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitLimitSize(){
  mt=new MerkleTree(partitioner,fullRange(),RECOMMENDED_DEPTH,2);
  assertTrue(mt.split(tok(4)));
  assertEquals(2,mt.size());
  assertFalse(mt.split(tok(2)));
  assertEquals(2,mt.size());
  assertEquals(new Range<>(tok(4),tok(-1)),mt.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(4)),mt.get(tok(4)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalids(){
  Iterator<TreeRange> ranges;
  ranges=mt.invalids();
  assertEquals(new Range<>(tok(-1),tok(-1)),ranges.next());
  assertFalse(ranges.hasNext());
  mt.split(tok(4));
  mt.split(tok(2));
  mt.split(tok(6));
  mt.split(tok(3));
  mt.split(tok(5));
  ranges=mt.invalids();
  assertEquals(new Range<>(tok(6),tok(-1)),ranges.next());
  assertEquals(new Range<>(tok(-1),tok(2)),ranges.next());
  assertEquals(new Range<>(tok(2),tok(3)),ranges.next());
  assertEquals(new Range<>(tok(3),tok(4)),ranges.next());
  assertEquals(new Range<>(tok(4),tok(5)),ranges.next());
  assertEquals(new Range<>(tok(5),tok(6)),ranges.next());
  assertEquals(new Range<>(tok(6),tok(-1)),ranges.next());
  assertFalse(ranges.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.MerkleTreesTest </h4><pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalids(){
  Iterator<TreeRange> ranges;
  ranges=mts.invalids();
  assertEquals(new Range<>(tok(-1),tok(-1)),ranges.next());
  assertFalse(ranges.hasNext());
  mts.split(tok(4));
  mts.split(tok(2));
  mts.split(tok(6));
  mts.split(tok(3));
  mts.split(tok(5));
  ranges=mts.invalids();
  assertEquals(new Range<>(tok(6),tok(-1)),ranges.next());
  assertEquals(new Range<>(tok(-1),tok(2)),ranges.next());
  assertEquals(new Range<>(tok(2),tok(3)),ranges.next());
  assertEquals(new Range<>(tok(3),tok(4)),ranges.next());
  assertEquals(new Range<>(tok(4),tok(5)),ranges.next());
  assertEquals(new Range<>(tok(5),tok(6)),ranges.next());
  assertEquals(new Range<>(tok(6),tok(-1)),ranges.next());
  assertFalse(ranges.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-2 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifference(){
  int maxsize=16;
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTree(32,fullRange());
  MerkleTrees mts2=new MerkleTrees(partitioner);
  mts2.addMerkleTree(32,fullRange());
  mts.init();
  mts2.init();
  for (  TreeRange range : mts.invalids())   range.addAll(new HIterator(range.right));
  for (  TreeRange range : mts2.invalids())   range.addAll(new HIterator(range.right));
  TreeRange leftmost=null;
  TreeRange middle=null;
  mts.maxsize(fullRange(),maxsize + 2);
  Iterator<TreeRange> ranges=mts.invalids();
  leftmost=ranges.next();
  mts.split(leftmost.right);
  middle=mts.get(leftmost.right);
  middle.hash("arbitrary!".getBytes());
  mts.get(partitioner.midpoint(leftmost.left,leftmost.right)).hash("even more arbitrary!".getBytes());
  List<Range<Token>> diffs=MerkleTrees.difference(mts,mts2);
  assertEquals(diffs + " contains wrong number of differences:",1,diffs.size());
  assertTrue(diffs.contains(new Range<>(leftmost.left,middle.right)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitLimitDepth(){
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTree(Integer.MAX_VALUE,(byte)2,fullRange());
  assertTrue(mts.split(tok(4)));
  assertTrue(mts.split(tok(2)));
  assertEquals(3,mts.size());
  assertFalse(mts.split(tok(1)));
  assertEquals(3,mts.size());
  assertEquals(new Range<>(tok(4),tok(-1)),mts.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(2)),mts.get(tok(2)));
  assertEquals(new Range<>(tok(2),tok(4)),mts.get(tok(4)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitLimitSize(){
  mts=new MerkleTrees(partitioner);
  mts.addMerkleTree(2,fullRange());
  assertTrue(mts.split(tok(4)));
  assertEquals(2,mts.size());
  assertFalse(mts.split(tok(2)));
  assertEquals(2,mts.size());
  assertEquals(new Range<>(tok(4),tok(-1)),mts.get(tok(-1)));
  assertEquals(new Range<>(tok(-1),tok(4)),mts.get(tok(4)));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIntersectingRanges(){
  mts=new MerkleTrees(partitioner);
  boolean failure=true;
  mts.addMerkleTree(1,new Range<>(tok(1),tok(3)));
  try {
    mts.addMerkleTree(1,new Range<>(tok(2),tok(4)));
  }
 catch (  AssertionError e) {
    failure=false;
  }
  assertFalse(failure);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NanoTimeToCurrentTimeMillisTest </h4><pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testTimestampOrdering() throws Exception {
  long nowNanos=System.nanoTime();
  long now=System.currentTimeMillis();
  long lastConverted=0;
  for (long ii=0; ii < 10000000; ii++) {
    now=Math.max(now,System.currentTimeMillis());
    if (ii % 10000 == 0) {
      NanoTimeToCurrentTimeMillis.updateNow();
      Thread.sleep(1);
    }
    nowNanos=Math.max(nowNanos,System.nanoTime());
    long convertedNow=NanoTimeToCurrentTimeMillis.convert(nowNanos);
    int maxDiff=FBUtilities.isWindows() ? 15 : 1;
    assertTrue("convertedNow = " + convertedNow + " lastConverted = "+ lastConverted+ " in iteration "+ ii,convertedNow >= (lastConverted - maxDiff));
    maxDiff=FBUtilities.isWindows() ? 25 : 2;
    assertTrue("now = " + now + " convertedNow = "+ convertedNow+ " in iteration "+ ii,(maxDiff - 2) <= convertedNow);
    lastConverted=convertedNow;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.NoSpamLoggerTest </h4><pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLoggedResult() throws Exception {
  now=5;
  assertTrue(NoSpamLogger.log(mock,Level.INFO,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.INFO);
  now=10;
  assertTrue(NoSpamLogger.log(mock,Level.WARN,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.WARN);
  now=15;
  assertTrue(NoSpamLogger.log(mock,Level.ERROR,5,TimeUnit.NANOSECONDS,statement,param));
  checkMock(Level.ERROR);
  now=20;
  NoSpamLogger logger=NoSpamLogger.getLogger(mock,5,TimeUnit.NANOSECONDS);
  assertTrue(logger.info(statement,param));
  checkMock(Level.INFO);
  now=25;
  assertTrue(logger.warn(statement,param));
  checkMock(Level.WARN);
  now=30;
  assertTrue(logger.error(statement,param));
  checkMock(Level.ERROR);
  NoSpamLogger.NoSpamLogStatement nospamStatement=logger.getStatement(statement);
  now=35;
  assertTrue(nospamStatement.info(param));
  checkMock(Level.INFO);
  now=40;
  assertTrue(nospamStatement.warn(param));
  checkMock(Level.WARN);
  now=45;
  assertTrue(nospamStatement.error(param));
  checkMock(Level.ERROR);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNoSpamLoggerDirect() throws Exception {
  now=5;
  NoSpamLogger logger=NoSpamLogger.getLogger(mock,5,TimeUnit.NANOSECONDS);
  assertTrue(logger.info(statement,param));
  assertFalse(logger.info(statement,param));
  assertFalse(logger.warn(statement,param));
  assertFalse(logger.error(statement,param));
  assertLoggedSizes(1,0,0);
  NoSpamLogStatement statement=logger.getStatement("swizzle2{}",10,TimeUnit.NANOSECONDS);
  assertFalse(statement.warn(param));
  assertLoggedSizes(1,0,0);
  now=10;
  assertTrue(statement.warn(param));
  assertLoggedSizes(1,1,0);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNoSpamLoggerStatementDirect() throws Exception {
  NoSpamLogger.NoSpamLogStatement nospam=NoSpamLogger.getStatement(mock,statement,5,TimeUnit.NANOSECONDS);
  now=5;
  assertTrue(nospam.info(statement,param));
  assertFalse(nospam.info(statement,param));
  assertFalse(nospam.warn(statement,param));
  assertFalse(nospam.error(statement,param));
  assertLoggedSizes(1,0,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.SerializationsTest </h4><pre class="type-6 type-7 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomFilterRead1000() throws IOException {
  if (EXECUTE_WRITES) {
    testBloomFilterWrite1000(true,false);
    testBloomFilterWrite1000(true,true);
  }
  try (DataInputStream in=getInput("3.0","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,true)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertTrue(present);
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      Assert.assertFalse(present);
    }
  }
   int falsePositive=0;
  int falseNegative=0;
  try (DataInputStream in=getInput("2.1","utils.BloomFilter1000.bin");IFilter filter=FilterFactory.deserialize(in,true,false)){
    boolean present;
    for (int i=0; i < 1000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (!present)       falseNegative++;
    }
    for (int i=1000; i < 2000; i++) {
      present=filter.isPresent(Util.dk(Int32Type.instance.decompose(i)));
      if (present)       falsePositive++;
    }
  }
   Assert.assertEquals(1000,falseNegative);
  Assert.assertEquals(0,falsePositive);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.btree.BTreeRemovalTest </h4><pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveFromRootWhichIsALeaf(){
  for (int size=1; size < 9; ++size) {
    final Object[] btree=new Object[(size & 1) == 1 ? size : size + 1];
    for (int i=0; i < size; ++i)     btree[i]=i + 1;
    for (int i=0; i < size; ++i) {
      final Object[] result=remove(btree,CMP,i + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      for (int j=0; j < i; ++j)       assertEquals("size " + size + "elem "+ j,btree[j],result[j]);
      for (int j=i; j < size - 1; ++j)       assertEquals("size " + size + "elem "+ j,btree[j + 1],result[j]);
      for (int j=size - 1; j < result.length; ++j)       assertNull("size " + size + "elem "+ j,result[j]);
    }
{
      final Object[] result=remove(btree,CMP,0);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
{
      final Object[] result=remove(btree,CMP,size + 1);
      assertTrue("size " + size,BTree.isWellFormed(result,CMP));
      assertBTree(btree,result);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void randomizedTest(){
  Random rand=new Random(2);
  SortedSet<Integer> data=new TreeSet<>();
  for (int i=0; i < 1000; ++i)   data.add(rand.nextInt());
  Object[] btree=BTree.build(data,UpdateFunction.<Integer>noOp());
  assertTrue(BTree.isWellFormed(btree,CMP));
  assertTrue(Iterables.elementsEqual(data,BTree.iterable(btree)));
  while (btree != BTree.empty()) {
    int idx=rand.nextInt(BTree.size(btree));
    Integer val=BTree.findByIndex(btree,idx);
    assertTrue(data.remove(val));
    btree=assertRemove(btree,val);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.concurrent.AbstractTransactionalTest </h4><pre class="type-13 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThrowableReturn() throws Exception {
  TestableTransaction txn;
  txn=newTest();
  Throwable t=new RuntimeException();
  txn.testing.prepareToCommit();
  if (txn.commitCanThrow()) {
    try {
      txn.testing.commit(t);
    }
 catch (    Throwable tt) {
      Assert.assertEquals(t,tt);
    }
    Assert.assertEquals(t,txn.testing.abort(t));
    Assert.assertEquals(0,t.getSuppressed().length);
  }
 else {
    Assert.assertEquals(t,txn.testing.commit(t));
    Assert.assertEquals(t,txn.testing.abort(t));
    Assert.assertTrue(t.getSuppressed()[0] instanceof IllegalStateException);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadCommit() throws Exception {
  TestableTransaction txn;
  txn=newTest();
  try {
    txn.testing.commit(null);
    Assert.assertTrue(false);
  }
 catch (  IllegalStateException t) {
  }
  txn.assertInProgress();
  Assert.assertNull(txn.testing.abort(null));
  txn.assertAborted();
  try {
    txn.testing.commit(null);
    Assert.assertTrue(false);
  }
 catch (  IllegalStateException t) {
  }
  txn.assertAborted();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-12 type-8 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommit() throws Exception {
  TestableTransaction txn=newTest();
  txn.assertInProgress();
  txn.testing.prepareToCommit();
  txn.assertPrepared();
  Assert.assertNull(txn.testing.commit(null));
  txn.assertCommitted();
  txn.testing.close();
  txn.assertCommitted();
  Throwable t=txn.testing.abort(null);
  Assert.assertTrue(t instanceof IllegalStateException);
  txn.assertCommitted();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.concurrent.AccumulatorTest </h4><pre class="type-15 type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndIterator(){
  Accumulator<String> accu=new Accumulator(4);
  accu.add("3");
  accu.add("2");
  accu.add("4");
  assertEquals("3",accu.get(0));
  assertEquals("2",accu.get(1));
  assertEquals("4",accu.get(2));
  try {
    assertEquals(null,accu.get(3));
    fail();
  }
 catch (  IndexOutOfBoundsException e) {
  }
  accu.add("0");
  assertEquals("0",accu.get(3));
  Iterator<String> iter=accu.iterator();
  assertEquals("3",iter.next());
  assertEquals("2",iter.next());
  assertEquals("4",iter.next());
  assertEquals("0",iter.next());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsEmptyAndSize(){
  Accumulator<Integer> accu=new Accumulator(4);
  assertTrue(accu.isEmpty());
  assertEquals(0,accu.size());
  accu.add(1);
  accu.add(2);
  assertTrue(!accu.isEmpty());
  assertEquals(2,accu.size());
  accu.add(3);
  accu.add(4);
  assertTrue(!accu.isEmpty());
  assertEquals(4,accu.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.concurrent.RefCountedTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLinkedList(){
  final List iterable=new LinkedList();
  Pair<Object,Object> p=Pair.create(iterable,iterable);
  RefCounted.Tidy tidier=new RefCounted.Tidy(){
    Object ref=iterable;
    @Override public void tidy() throws Exception {
    }
    @Override public String name(){
      return "42";
    }
  }
;
  Ref ref=new Ref(new AtomicReference<List>(iterable),tidier);
  for (int i=0; i < entryCount; i++) {
    iterable.add(p);
  }
  Visitor visitor=new Visitor();
  visitor.run();
  ref.close();
  System.out.println("LinkedList visited " + visitor.lastVisitedCount + " iterations "+ visitor.iterations);
  Assert.assertTrue(visitor.lastVisitedCount > entryCount && visitor.lastVisitedCount < entryCount + fudgeFactor);
  Assert.assertTrue(visitor.iterations > (entryCount * 3) && visitor.iterations < (entryCount * 3) + fudgeFactor);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBlockingQueue(){
  final BlockingQueue iterable=new LinkedBlockingQueue();
  Pair<Object,Object> p=Pair.create(iterable,iterable);
  RefCounted.Tidy tidier=new RefCounted.Tidy(){
    Object ref=iterable;
    @Override public void tidy() throws Exception {
    }
    @Override public String name(){
      return "42";
    }
  }
;
  Ref ref=new Ref(new AtomicReference<BlockingQueue>(iterable),tidier);
  for (int i=0; i < entryCount; i++) {
    iterable.add(p);
  }
  Visitor visitor=new Visitor();
  visitor.run();
  ref.close();
  System.out.println("BlockingQueue visited " + visitor.lastVisitedCount + " iterations "+ visitor.iterations);
  Assert.assertTrue(visitor.lastVisitedCount < 10);
  Assert.assertTrue(visitor.iterations > entryCount && visitor.iterations < entryCount + fudgeFactor);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDoubleRelease() throws InterruptedException {
  Tidier tidier=null;
  try {
    tidier=new Tidier();
    Ref<?> obj=new Ref(null,tidier);
    obj.release();
    obj.release();
    Assert.assertTrue(false);
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSeriousLeak() throws InterruptedException {
  Tidier tidier=new Tidier();
  new Ref(null,tidier);
  System.gc();
  System.gc();
  System.gc();
  System.gc();
  Thread.sleep(1000);
  Assert.assertTrue(tidier.tidied);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testArray() throws Exception {
  final Object objects[]=new Object[entryCount];
  for (int i=0; i < entryCount; i+=2)   objects[i]=new Object();
  File f=File.createTempFile("foo","bar");
  RefCounted.Tidy tidier=new RefCounted.Tidy(){
    Object ref=objects;
    File fileRef=f;
    @Override public void tidy() throws Exception {
    }
    @Override public String name(){
      return "42";
    }
  }
;
  Ref ref=new Ref(new AtomicReference<Object[]>(objects),tidier);
  Visitor visitor=new Visitor();
  visitor.run();
  ref.close();
  System.out.println("Array visited " + visitor.lastVisitedCount + " iterations "+ visitor.iterations);
  Assert.assertTrue(visitor.lastVisitedCount > (entryCount / 2) && visitor.lastVisitedCount < (entryCount / 2) + fudgeFactor);
  Assert.assertTrue(visitor.iterations > (entryCount / 2) && visitor.iterations < (entryCount / 2) + fudgeFactor);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testLeak() throws InterruptedException {
  Tidier tidier=new Tidier();
  Ref<?> obj=new Ref(null,tidier);
  obj.tryRef();
  obj.release();
  System.gc();
  System.gc();
  Thread.sleep(1000);
  Assert.assertTrue(tidier.tidied);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHashMap(){
  final Map<Object,Object> map=new HashMap<Object,Object>();
  RefCounted.Tidy tidier=new RefCounted.Tidy(){
    Object ref=map;
    @Override public void tidy() throws Exception {
    }
    @Override public String name(){
      return "42";
    }
  }
;
  Ref ref=new Ref(new AtomicReference<Map<Object,Object>>(map),tidier);
  Object o=new Object();
  for (int i=0; i < entryCount; i++) {
    map.put(new Object(),o);
  }
  Visitor visitor=new Visitor();
  visitor.run();
  ref.close();
  System.out.println("HashMap visited " + visitor.lastVisitedCount + " iterations "+ visitor.iterations);
  Assert.assertTrue(visitor.lastVisitedCount > (entryCount * 2) && visitor.lastVisitedCount < (entryCount * 2) + fudgeFactor);
  Assert.assertTrue(visitor.iterations > (entryCount * 3) && visitor.iterations < (entryCount * 3) + fudgeFactor);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testConcurrentMap(){
  final Map<Object,Object> map=new ConcurrentHashMap<Object,Object>();
  RefCounted.Tidy tidier=new RefCounted.Tidy(){
    Object ref=map;
    @Override public void tidy() throws Exception {
    }
    @Override public String name(){
      return "42";
    }
  }
;
  Ref ref=new Ref(new AtomicReference<Map<Object,Object>>(map),tidier);
  Object o=new Object();
  for (int i=0; i < entryCount; i++) {
    map.put(new Object(),o);
  }
  Visitor visitor=new Visitor();
  visitor.run();
  ref.close();
  System.out.println("ConcurrentHashMap visited " + visitor.lastVisitedCount + " iterations "+ visitor.iterations);
  Assert.assertTrue(visitor.lastVisitedCount > entryCount && visitor.lastVisitedCount < entryCount + fudgeFactor);
  Assert.assertTrue(visitor.iterations > entryCount * 2 && visitor.iterations < entryCount * 2 + fudgeFactor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.BufferPoolTest </h4><pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactIfOutOfCapacity(){
  final int size=4096;
  final int numBuffersInChunk=BufferPool.GlobalPool.MACRO_CHUNK_SIZE / size;
  List<ByteBuffer> buffers=new ArrayList<>(numBuffersInChunk);
  Set<Long> addresses=new HashSet<>(numBuffersInChunk);
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    buffers.add(buffer);
    addresses.add(MemoryUtil.getAddress(buffer));
  }
  for (int i=numBuffersInChunk - 1; i >= 0; i--)   BufferPool.put(buffers.get(i));
  buffers.clear();
  for (int i=0; i < numBuffersInChunk; i++) {
    ByteBuffer buffer=BufferPool.get(size);
    assertNotNull(buffer);
    assertEquals(size,buffer.capacity());
    addresses.remove(MemoryUtil.getAddress(buffer));
    buffers.add(buffer);
  }
  assertTrue(addresses.isEmpty());
  for (  ByteBuffer buffer : buffers)   BufferPool.put(buffer);
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDifferentSizeBuffersOnOneChunk(){
  int[] sizes=new int[]{5,1024,4096,8,16000,78,512,256,63,55,89,90,255,32,2048,128};
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=BufferPool.currentChunk().roundUp(buffer.capacity());
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  Random rnd=new Random();
  rnd.setSeed(298347529L);
  while (!buffers.isEmpty()) {
    int index=rnd.nextInt(buffers.size());
    ByteBuffer buffer=buffers.remove(index);
    BufferPool.put(buffer);
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeapBuffer(){
  ByteBuffer buffer=BufferPool.get(1024,BufferType.ON_HEAP);
  assertNotNull(buffer);
  assertEquals(1024,buffer.capacity());
  assertFalse(buffer.isDirect());
  assertNotNull(buffer.array());
  BufferPool.put(buffer);
}

</code></pre>

<br>
<pre class="type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBufferPoolDisabled(){
  BufferPool.DISABLED=true;
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=true;
  ByteBuffer buffer=BufferPool.get(1024);
  assertEquals(0,BufferPool.numChunks());
  assertNotNull(buffer);
  assertEquals(1024,buffer.capacity());
  assertFalse(buffer.isDirect());
  assertNotNull(buffer.array());
  BufferPool.put(buffer);
  assertEquals(0,BufferPool.numChunks());
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=false;
  buffer=BufferPool.get(1024);
  assertEquals(0,BufferPool.numChunks());
  assertNotNull(buffer);
  assertEquals(1024,buffer.capacity());
  assertTrue(buffer.isDirect());
  BufferPool.put(buffer);
  assertEquals(0,BufferPool.numChunks());
  BufferPool.DISABLED=false;
  BufferPool.ALLOCATE_ON_HEAP_WHEN_EXAHUSTED=true;
}

</code></pre>

<br>
<pre class="type-6 type-7 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChunkExhausted(){
  final int size=BufferPool.CHUNK_SIZE / 64;
  int[] sizes=new int[128];
  Arrays.fill(sizes,size);
  int sum=0;
  List<ByteBuffer> buffers=new ArrayList<>(sizes.length);
  for (int i=0; i < sizes.length; i++) {
    ByteBuffer buffer=BufferPool.get(sizes[i]);
    assertNotNull(buffer);
    assertTrue(buffer.capacity() >= sizes[i]);
    buffers.add(buffer);
    sum+=buffer.capacity();
  }
  assertTrue(sum <= BufferPool.GlobalPool.MACRO_CHUNK_SIZE);
  BufferPool.Chunk chunk=BufferPool.currentChunk();
  assertNotNull(chunk);
  for (int i=0; i < sizes.length; i++) {
    BufferPool.put(buffers.get(i));
  }
  assertEquals(null,BufferPool.currentChunk());
  assertEquals(0,chunk.free());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.cassandra.utils.memory.NativeAllocatorTest </h4><pre class="type-7 type-4 type-5 type-2 type-12 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBookKeeping() throws ExecutionException, InterruptedException {
{
    final ScheduledExecutorService exec=Executors.newScheduledThreadPool(2);
    final OpOrder order=new OpOrder();
    final OpOrder.Group group=order.start();
    final CountDownLatch canClean=new CountDownLatch(1);
    final CountDownLatch isClean=new CountDownLatch(1);
    final AtomicReference<NativeAllocator> allocatorRef=new AtomicReference<>();
    final AtomicReference<OpOrder.Barrier> barrier=new AtomicReference<>();
    final NativeAllocator allocator=new NativeAllocator(new NativePool(1,100,0.75f,new Runnable(){
      public void run(){
        try {
          canClean.await();
        }
 catch (        InterruptedException e) {
          throw new AssertionError();
        }
        if (isClean.getCount() > 0) {
          allocatorRef.get().offHeap().released(80);
          isClean.countDown();
        }
      }
    }
));
    allocatorRef.set(allocator);
    final Runnable markBlocking=new Runnable(){
      public void run(){
        barrier.set(order.newBarrier());
        barrier.get().issue();
        barrier.get().markBlocking();
      }
    }
;
    final Runnable run=new Runnable(){
      public void run(){
        allocator.allocate(10,group);
        Assert.assertEquals(10,allocator.offHeap().owns());
        allocator.offHeap().adjust(-10,group);
        Assert.assertEquals(0,allocator.offHeap().owns());
        allocator.offHeap().adjust(10,group);
        Assert.assertEquals(10,allocator.offHeap().owns());
        boolean success=false;
        try {
          allocator.offHeap().allocate(-10,group);
        }
 catch (        AssertionError e) {
          success=true;
        }
        Assert.assertTrue(success);
        Uninterruptibles.sleepUninterruptibly(10L,TimeUnit.MILLISECONDS);
        Assert.assertEquals(1,isClean.getCount());
        allocator.allocate(70,group);
        Assert.assertEquals(80,allocator.offHeap().owns());
        canClean.countDown();
        try {
          isClean.await(10L,TimeUnit.MILLISECONDS);
        }
 catch (        InterruptedException e) {
          throw new AssertionError();
        }
        Assert.assertEquals(0,isClean.getCount());
        Assert.assertEquals(0,allocator.offHeap().owns());
        exec.schedule(markBlocking,10L,TimeUnit.MILLISECONDS);
        allocator.allocate(110,group);
        Assert.assertNotNull(barrier.get());
        Assert.assertEquals(110,allocator.offHeap().owns());
      }
    }
;
    exec.submit(run).get();
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
